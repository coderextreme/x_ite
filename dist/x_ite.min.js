/* X_ITE X3D v6.1.0-1158
 * See LICENSE.txt for a detailed listing of used licences. */
!function(t,e){"object"==typeof module&&"function"==typeof require?e(module,require):e()}(0,(function(__global_module__,__global_require__){var module,exports,process,requirejs,require,define,factory;
/** vim: et:ts=4:sw=4:sts=4
 * @license RequireJS 2.3.6 Copyright jQuery Foundation and other contributors.
 * Released under MIT license, https://github.com/requirejs/requirejs/blob/master/LICENSE
 */(function(global,setTimeout){var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.3.6",commentRegExp=/\/\*[\s\S]*?\*\/|([^:"'=]|^)\/\/.*$/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,isBrowser=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=!1;function commentReplace(t,e){return e||""}function isFunction(t){return"[object Function]"===ostring.call(t)}function isArray(t){return"[object Array]"===ostring.call(t)}function each(t,e){var i;if(t)for(i=0;i<t.length&&(!t[i]||!e(t[i],i,t));i+=1);}function eachReverse(t,e){var i;if(t)for(i=t.length-1;i>-1&&(!t[i]||!e(t[i],i,t));i-=1);}function hasProp(t,e){return hasOwn.call(t,e)}function getOwn(t,e){return hasProp(t,e)&&t[e]}function eachProp(t,e){var i;for(i in t)if(hasProp(t,i)&&e(t[i],i))break}function mixin(t,e,i,n){return e&&eachProp(e,(function(e,r){!i&&hasProp(t,r)||(!n||"object"!=typeof e||!e||isArray(e)||isFunction(e)||e instanceof RegExp?t[r]=e:(t[r]||(t[r]={}),mixin(t[r],e,i,n)))})),t}function bind(t,e){return function(){return e.apply(t,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(t){throw t}function getGlobal(t){if(!t)return t;var e=global;return each(t.split("."),(function(t){e=e[t]})),e}function makeError(t,e,i,n){var r=new Error(e+"\nhttps://requirejs.org/docs/errors.html#"+t);return r.requireType=t,r.requireModules=n,i&&(r.originalError=i),r}if(void 0===define){if(void 0!==requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}void 0===require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(t,e,i,n){var r,s,o=defContextName;return isArray(t)||"string"==typeof t||(s=t,isArray(e)?(t=e,e=i,i=n):t=[]),s&&s.context&&(o=s.context),(r=getOwn(contexts,o))||(r=contexts[o]=req.s.newContext(o)),s&&r.configure(s),r.require(t,e,i)},req.config=function(t){return req(t)},req.nextTick=void 0!==setTimeout?function(t){setTimeout(t,4)}:function(t){t()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],(function(t){req[t]=function(){var e=contexts[defContextName];return e.require[t].apply(e,arguments)}})),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.createNode=function(t,e,i){var n=t.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return n.type=t.scriptType||"text/javascript",n.charset="utf-8",n.async=!0,n},req.load=function(t,e,i){var n,r=t&&t.config||{};if(isBrowser)return(n=req.createNode(r,e,i)).setAttribute("data-requirecontext",t.contextName),n.setAttribute("data-requiremodule",e),!n.attachEvent||n.attachEvent.toString&&n.attachEvent.toString().indexOf("[native code")<0||isOpera?(n.addEventListener("load",t.onScriptLoad,!1),n.addEventListener("error",t.onScriptError,!1)):(useInteractive=!0,n.attachEvent("onreadystatechange",t.onScriptLoad)),n.src=i,r.onNodeCreated&&r.onNodeCreated(n,r,e,i),currentlyAddingScript=n,baseElement?head.insertBefore(n,baseElement):head.appendChild(n),currentlyAddingScript=null,n;if(isWebWorker)try{setTimeout((function(){}),0),importScripts(i),t.completeLoad(e)}catch(n){t.onError(makeError("importscripts","importScripts failed for "+e+" at "+i,n,[e]))}},isBrowser&&!cfg.skipDataMain&&eachReverse(scripts(),(function(t){if(head||(head=t.parentNode),dataMain=t.getAttribute("data-main"))return mainScript=dataMain,cfg.baseUrl||-1!==mainScript.indexOf("!")||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0})),define=function(t,e,i){var n,r;"string"!=typeof t&&(i=e,e=t,t=null),isArray(e)||(i=e,e=null),!e&&isFunction(i)&&(e=[],i.length&&(i.toString().replace(commentRegExp,commentReplace).replace(cjsRequireRegExp,(function(t,i){e.push(i)})),e=(1===i.length?["require"]:["require","exports","module"]).concat(e))),useInteractive&&(n=currentlyAddingScript||getInteractiveScript())&&(t||(t=n.getAttribute("data-requiremodule")),r=contexts[n.getAttribute("data-requirecontext")]),r?(r.defQueue.push([t,e,i]),r.defQueueMap[t]=!0):globalDefQueue.push([t,e,i])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}function newContext(t){var e,i,n,r,s,o={waitSeconds:7,baseUrl:"./",paths:{},bundles:{},pkgs:{},shim:{},config:{}},a={},u={},l={},c=[],h={},d={},p={},f=1,g=1;function m(t,e,i){var n,r,s,a,u,l,c,h,d,p,f=e&&e.split("/"),g=o.map,m=g&&g["*"];if(t&&(l=(t=t.split("/")).length-1,o.nodeIdCompat&&jsSuffixRegExp.test(t[l])&&(t[l]=t[l].replace(jsSuffixRegExp,"")),"."===t[0].charAt(0)&&f&&(t=f.slice(0,f.length-1).concat(t)),function(t){var e,i;for(e=0;e<t.length;e++)if("."===(i=t[e]))t.splice(e,1),e-=1;else if(".."===i){if(0===e||1===e&&".."===t[2]||".."===t[e-1])continue;e>0&&(t.splice(e-1,2),e-=2)}}(t),t=t.join("/")),i&&g&&(f||m)){t:for(s=(r=t.split("/")).length;s>0;s-=1){if(u=r.slice(0,s).join("/"),f)for(a=f.length;a>0;a-=1)if((n=getOwn(g,f.slice(0,a).join("/")))&&(n=getOwn(n,u))){c=n,h=s;break t}!d&&m&&getOwn(m,u)&&(d=getOwn(m,u),p=s)}!c&&d&&(c=d,h=p),c&&(r.splice(0,h,c),t=r.join("/"))}return getOwn(o.pkgs,t)||t}function _(t){isBrowser&&each(scripts(),(function(e){if(e.getAttribute("data-requiremodule")===t&&e.getAttribute("data-requirecontext")===n.contextName)return e.parentNode.removeChild(e),!0}))}function y(t){var e=getOwn(o.paths,t);if(e&&isArray(e)&&e.length>1)return e.shift(),n.require.undef(t),n.makeRequire(null,{skipMap:!0})([t]),!0}function x(t){var e,i=t?t.indexOf("!"):-1;return i>-1&&(e=t.substring(0,i),t=t.substring(i+1,t.length)),[e,t]}function w(t,e,i,r){var s,o,a,u,l=null,c=e?e.name:null,d=t,p=!0,_="";return t||(p=!1,t="_@r"+(f+=1)),l=(u=x(t))[0],t=u[1],l&&(l=m(l,c,r),o=getOwn(h,l)),t&&(l?_=i?t:o&&o.normalize?o.normalize(t,(function(t){return m(t,c,r)})):-1===t.indexOf("!")?m(t,c,r):t:(l=(u=x(_=m(t,c,r)))[0],_=u[1],i=!0,s=n.nameToUrl(_))),{prefix:l,name:_,parentMap:e,unnormalized:!!(a=!l||o||i?"":"_unnormalized"+(g+=1)),url:s,originalName:d,isDefine:p,id:(l?l+"!"+_:_)+a}}function b(t){var e=t.id,i=getOwn(a,e);return i||(i=a[e]=new n.Module(t)),i}function v(t,e,i){var n=t.id,r=getOwn(a,n);!hasProp(h,n)||r&&!r.defineEmitComplete?(r=b(t)).error&&"error"===e?i(r.error):r.on(e,i):"defined"===e&&i(h[n])}function S(t,e){var i=t.requireModules,n=!1;e?e(t):(each(i,(function(e){var i=getOwn(a,e);i&&(i.error=t,i.events.error&&(n=!0,i.emit("error",t)))})),n||req.onError(t))}function T(){globalDefQueue.length&&(each(globalDefQueue,(function(t){var e=t[0];"string"==typeof e&&(n.defQueueMap[e]=!0),c.push(t)})),globalDefQueue=[])}function C(t){delete a[t],delete u[t]}function O(t,e,i){var n=t.map.id;t.error?t.emit("error",t.error):(e[n]=!0,each(t.depMaps,(function(n,r){var s=n.id,o=getOwn(a,s);!o||t.depMatched[r]||i[s]||(getOwn(e,s)?(t.defineDep(r,h[s]),t.check()):O(o,e,i))})),i[n]=!0)}function N(){var t,i,r=1e3*o.waitSeconds,a=r&&n.startTime+r<(new Date).getTime(),l=[],c=[],h=!1,d=!0;if(!e){if(e=!0,eachProp(u,(function(t){var e=t.map,n=e.id;if(t.enabled&&(e.isDefine||c.push(t),!t.error))if(!t.inited&&a)y(n)?(i=!0,h=!0):(l.push(n),_(n));else if(!t.inited&&t.fetched&&e.isDefine&&(h=!0,!e.prefix))return d=!1})),a&&l.length)return(t=makeError("timeout","Load timeout for modules: "+l,null,l)).contextName=n.contextName,S(t);d&&each(c,(function(t){O(t,{},{})})),a&&!i||!h||!isBrowser&&!isWebWorker||s||(s=setTimeout((function(){s=0,N()}),50)),e=!1}}function F(t){hasProp(h,t[0])||b(w(t[0],null,!0)).init(t[1],t[2])}function E(t,e,i,n){t.detachEvent&&!isOpera?n&&t.detachEvent(n,e):t.removeEventListener(i,e,!1)}function D(t){var e=t.currentTarget||t.srcElement;return E(e,n.onScriptLoad,"load","onreadystatechange"),E(e,n.onScriptError,"error"),{node:e,id:e&&e.getAttribute("data-requiremodule")}}function M(){var t;for(T();c.length;){if(null===(t=c.shift())[0])return S(makeError("mismatch","Mismatched anonymous define() module: "+t[t.length-1]));F(t)}n.defQueueMap={}}return r={require:function(t){return t.require?t.require:t.require=n.makeRequire(t.map)},exports:function(t){if(t.usingExports=!0,t.map.isDefine)return t.exports?h[t.map.id]=t.exports:t.exports=h[t.map.id]={}},module:function(t){return t.module?t.module:t.module={id:t.map.id,uri:t.map.url,config:function(){return getOwn(o.config,t.map.id)||{}},exports:t.exports||(t.exports={})}}},(i=function(t){this.events=getOwn(l,t.id)||{},this.map=t,this.shim=getOwn(o.shim,t.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0}).prototype={init:function(t,e,i,n){n=n||{},this.inited||(this.factory=e,i?this.on("error",i):this.events.error&&(i=bind(this,(function(t){this.emit("error",t)}))),this.depMaps=t&&t.slice(0),this.errback=i,this.inited=!0,this.ignore=n.ignore,n.enabled||this.enabled?this.enable():this.check())},defineDep:function(t,e){this.depMatched[t]||(this.depMatched[t]=!0,this.depCount-=1,this.depExports[t]=e)},fetch:function(){if(!this.fetched){this.fetched=!0,n.startTime=(new Date).getTime();var t=this.map;if(!this.shim)return t.prefix?this.callPlugin():this.load();n.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,(function(){return t.prefix?this.callPlugin():this.load()})))}},load:function(){var t=this.map.url;d[t]||(d[t]=!0,n.load(this.map.id,t))},check:function(){if(this.enabled&&!this.enabling){var t,e,i=this.map.id,r=this.depExports,s=this.exports,o=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(o)){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)try{s=n.execCb(i,o,r,s)}catch(e){t=e}else s=n.execCb(i,o,r,s);if(this.map.isDefine&&void 0===s&&((e=this.module)?s=e.exports:this.usingExports&&(s=this.exports)),t)return t.requireMap=this.map,t.requireModules=this.map.isDefine?[this.map.id]:null,t.requireType=this.map.isDefine?"define":"require",S(this.error=t)}else s=o;if(this.exports=s,this.map.isDefine&&!this.ignore&&(h[i]=s,req.onResourceLoad)){var a=[];each(this.depMaps,(function(t){a.push(t.normalizedMap||t)})),req.onResourceLoad(n,this.map,a)}C(i),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else hasProp(n.defQueueMap,i)||this.fetch()}},callPlugin:function(){var t=this.map,e=t.id,i=w(t.prefix);this.depMaps.push(i),v(i,"defined",bind(this,(function(i){var r,s,u,l=getOwn(p,this.map.id),c=this.map.name,h=this.map.parentMap?this.map.parentMap.name:null,d=n.makeRequire(t.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(i.normalize&&(c=i.normalize(c,(function(t){return m(t,h,!0)}))||""),v(s=w(t.prefix+"!"+c,this.map.parentMap,!0),"defined",bind(this,(function(t){this.map.normalizedMap=s,this.init([],(function(){return t}),null,{enabled:!0,ignore:!0})}))),void((u=getOwn(a,s.id))&&(this.depMaps.push(s),this.events.error&&u.on("error",bind(this,(function(t){this.emit("error",t)}))),u.enable()))):l?(this.map.url=n.nameToUrl(l),void this.load()):((r=bind(this,(function(t){this.init([],(function(){return t}),null,{enabled:!0})}))).error=bind(this,(function(t){this.inited=!0,this.error=t,t.requireModules=[e],eachProp(a,(function(t){0===t.map.id.indexOf(e+"_unnormalized")&&C(t.map.id)})),S(t)})),r.fromText=bind(this,(function(i,s){var a=t.name,u=w(a),l=useInteractive;s&&(i=s),l&&(useInteractive=!1),b(u),hasProp(o.config,e)&&(o.config[a]=o.config[e]);try{req.exec(i)}catch(t){return S(makeError("fromtexteval","fromText eval for "+e+" failed: "+t,t,[e]))}l&&(useInteractive=!0),this.depMaps.push(u),n.completeLoad(a),d([a],r)})),void i.load(t.name,d,r,o))}))),n.enable(i,this),this.pluginMaps[i.id]=i},enable:function(){u[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,(function(t,e){var i,s,o;if("string"==typeof t){if(t=w(t,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[e]=t,o=getOwn(r,t.id))return void(this.depExports[e]=o(this));this.depCount+=1,v(t,"defined",bind(this,(function(t){this.undefed||(this.defineDep(e,t),this.check())}))),this.errback?v(t,"error",bind(this,this.errback)):this.events.error&&v(t,"error",bind(this,(function(t){this.emit("error",t)})))}i=t.id,s=a[i],hasProp(r,i)||!s||s.enabled||n.enable(t,this)}))),eachProp(this.pluginMaps,bind(this,(function(t){var e=getOwn(a,t.id);e&&!e.enabled&&n.enable(t,this)}))),this.enabling=!1,this.check()},on:function(t,e){var i=this.events[t];i||(i=this.events[t]=[]),i.push(e)},emit:function(t,e){each(this.events[t],(function(t){t(e)})),"error"===t&&delete this.events[t]}},n={config:o,contextName:t,registry:a,defined:h,urlFetched:d,defQueue:c,defQueueMap:{},Module:i,makeModuleMap:w,nextTick:req.nextTick,onError:S,configure:function(t){if(t.baseUrl&&"/"!==t.baseUrl.charAt(t.baseUrl.length-1)&&(t.baseUrl+="/"),"string"==typeof t.urlArgs){var e=t.urlArgs;t.urlArgs=function(t,i){return(-1===i.indexOf("?")?"?":"&")+e}}var i=o.shim,r={paths:!0,bundles:!0,config:!0,map:!0};eachProp(t,(function(t,e){r[e]?(o[e]||(o[e]={}),mixin(o[e],t,!0,!0)):o[e]=t})),t.bundles&&eachProp(t.bundles,(function(t,e){each(t,(function(t){t!==e&&(p[t]=e)}))})),t.shim&&(eachProp(t.shim,(function(t,e){isArray(t)&&(t={deps:t}),!t.exports&&!t.init||t.exportsFn||(t.exportsFn=n.makeShimExports(t)),i[e]=t})),o.shim=i),t.packages&&each(t.packages,(function(t){var e;e=(t="string"==typeof t?{name:t}:t).name,t.location&&(o.paths[e]=t.location),o.pkgs[e]=t.name+"/"+(t.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")})),eachProp(a,(function(t,e){t.inited||t.map.unnormalized||(t.map=w(e,null,!0))})),(t.deps||t.callback)&&n.require(t.deps||[],t.callback)},makeShimExports:function(t){return function(){var e;return t.init&&(e=t.init.apply(global,arguments)),e||t.exports&&getGlobal(t.exports)}},makeRequire:function(e,i){function s(o,u,l){var c,d;return i.enableBuildCallback&&u&&isFunction(u)&&(u.__requireJsBuild=!0),"string"==typeof o?isFunction(u)?S(makeError("requireargs","Invalid require call"),l):e&&hasProp(r,o)?r[o](a[e.id]):req.get?req.get(n,o,e,s):(c=w(o,e,!1,!0).id,hasProp(h,c)?h[c]:S(makeError("notloaded",'Module name "'+c+'" has not been loaded yet for context: '+t+(e?"":". Use require([])")))):(M(),n.nextTick((function(){M(),(d=b(w(null,e))).skipMap=i.skipMap,d.init(o,u,l,{enabled:!0}),N()})),s)}return i=i||{},mixin(s,{isBrowser:isBrowser,toUrl:function(t){var i,r=t.lastIndexOf("."),s=t.split("/")[0];return-1!==r&&(!("."===s||".."===s)||r>1)&&(i=t.substring(r,t.length),t=t.substring(0,r)),n.nameToUrl(m(t,e&&e.id,!0),i,!0)},defined:function(t){return hasProp(h,w(t,e,!1,!0).id)},specified:function(t){return t=w(t,e,!1,!0).id,hasProp(h,t)||hasProp(a,t)}}),e||(s.undef=function(t){T();var i=w(t,e,!0),r=getOwn(a,t);r.undefed=!0,_(t),delete h[t],delete d[i.url],delete l[t],eachReverse(c,(function(e,i){e[0]===t&&c.splice(i,1)})),delete n.defQueueMap[t],r&&(r.events.defined&&(l[t]=r.events),C(t))}),s},enable:function(t){getOwn(a,t.id)&&b(t).enable()},completeLoad:function(t){var e,i,r,s=getOwn(o.shim,t)||{},u=s.exports;for(T();c.length;){if(null===(i=c.shift())[0]){if(i[0]=t,e)break;e=!0}else i[0]===t&&(e=!0);F(i)}if(n.defQueueMap={},r=getOwn(a,t),!e&&!hasProp(h,t)&&r&&!r.inited){if(!(!o.enforceDefine||u&&getGlobal(u)))return y(t)?void 0:S(makeError("nodefine","No define call for "+t,null,[t]));F([t,s.deps||[],s.exportsFn])}N()},nameToUrl:function(t,e,i){var r,s,a,u,l,c,h=getOwn(o.pkgs,t);if(h&&(t=h),c=getOwn(p,t))return n.nameToUrl(c,e,i);if(req.jsExtRegExp.test(t))u=t+(e||"");else{for(r=o.paths,a=(s=t.split("/")).length;a>0;a-=1)if(l=getOwn(r,s.slice(0,a).join("/"))){isArray(l)&&(l=l[0]),s.splice(0,a,l);break}u=s.join("/"),u=("/"===(u+=e||(/^data\:|^blob\:|\?/.test(u)||i?"":".js")).charAt(0)||u.match(/^[\w\+\.\-]+:/)?"":o.baseUrl)+u}return o.urlArgs&&!/^blob\:/.test(u)?u+o.urlArgs(t,u):u},load:function(t,e){req.load(n,t,e)},execCb:function(t,e,i,n){return e.apply(n,i)},onScriptLoad:function(t){if("load"===t.type||readyRegExp.test((t.currentTarget||t.srcElement).readyState)){interactiveScript=null;var e=D(t);n.completeLoad(e.id)}},onScriptError:function(t){var e=D(t);if(!y(e.id)){var i=[];return eachProp(a,(function(t,n){0!==n.indexOf("_@r")&&each(t.depMaps,(function(t){if(t.id===e.id)return i.push(n),!0}))})),S(makeError("scripterror",'Script error for "'+e.id+(i.length?'", needed by: '+i.join(", "):'"'),t,[e.id]))}}},n.require=n.makeRequire(),n}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState||eachReverse(scripts(),(function(t){if("interactive"===t.readyState)return interactiveScript=t})),interactiveScript}})(this,"undefined"==typeof setTimeout?void 0:setTimeout),define("../node_modules/requirejs/require.js",(function(){})),
/*!
 * jQuery JavaScript Library v3.6.0
 * https://jquery.com/
 *
 * Includes Sizzle.js
 * https://sizzlejs.com/
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2021-03-02T17:08Z
 */
function(t,e){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=t.document?e(t,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return e(t)}:e(t)}("undefined"!=typeof window?window:this,(function(t,e){var i=[],n=Object.getPrototypeOf,r=i.slice,s=i.flat?function(t){return i.flat.call(t)}:function(t){return i.concat.apply([],t)},o=i.push,a=i.indexOf,u={},l=u.toString,c=u.hasOwnProperty,h=c.toString,d=h.call(Object),p={},f=function(t){return"function"==typeof t&&"number"!=typeof t.nodeType&&"function"!=typeof t.item},g=function(t){return null!=t&&t===t.window},m=t.document,_={type:!0,src:!0,nonce:!0,noModule:!0};function y(t,e,i){var n,r,s=(i=i||m).createElement("script");if(s.text=t,e)for(n in _)(r=e[n]||e.getAttribute&&e.getAttribute(n))&&s.setAttribute(n,r);i.head.appendChild(s).parentNode.removeChild(s)}function x(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?u[l.call(t)]||"object":typeof t}var w="3.6.0",b=function(t,e){return new b.fn.init(t,e)};function v(t){var e=!!t&&"length"in t&&t.length,i=x(t);return!f(t)&&!g(t)&&("array"===i||0===e||"number"==typeof e&&e>0&&e-1 in t)}b.fn=b.prototype={jquery:w,constructor:b,length:0,toArray:function(){return r.call(this)},get:function(t){return null==t?r.call(this):t<0?this[t+this.length]:this[t]},pushStack:function(t){var e=b.merge(this.constructor(),t);return e.prevObject=this,e},each:function(t){return b.each(this,t)},map:function(t){return this.pushStack(b.map(this,(function(e,i){return t.call(e,i,e)})))},slice:function(){return this.pushStack(r.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(b.grep(this,(function(t,e){return(e+1)%2})))},odd:function(){return this.pushStack(b.grep(this,(function(t,e){return e%2})))},eq:function(t){var e=this.length,i=+t+(t<0?e:0);return this.pushStack(i>=0&&i<e?[this[i]]:[])},end:function(){return this.prevObject||this.constructor()},push:o,sort:i.sort,splice:i.splice},b.extend=b.fn.extend=function(){var t,e,i,n,r,s,o=arguments[0]||{},a=1,u=arguments.length,l=!1;for("boolean"==typeof o&&(l=o,o=arguments[a]||{},a++),"object"==typeof o||f(o)||(o={}),a===u&&(o=this,a--);a<u;a++)if(null!=(t=arguments[a]))for(e in t)n=t[e],"__proto__"!==e&&o!==n&&(l&&n&&(b.isPlainObject(n)||(r=Array.isArray(n)))?(i=o[e],s=r&&!Array.isArray(i)?[]:r||b.isPlainObject(i)?i:{},r=!1,o[e]=b.extend(l,s,n)):void 0!==n&&(o[e]=n));return o},b.extend({expando:"jQuery"+(w+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isPlainObject:function(t){var e,i;return!(!t||"[object Object]"!==l.call(t))&&(!(e=n(t))||"function"==typeof(i=c.call(e,"constructor")&&e.constructor)&&h.call(i)===d)},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},globalEval:function(t,e,i){y(t,{nonce:e&&e.nonce},i)},each:function(t,e){var i,n=0;if(v(t))for(i=t.length;n<i&&!1!==e.call(t[n],n,t[n]);n++);else for(n in t)if(!1===e.call(t[n],n,t[n]))break;return t},makeArray:function(t,e){var i=e||[];return null!=t&&(v(Object(t))?b.merge(i,"string"==typeof t?[t]:t):o.call(i,t)),i},inArray:function(t,e,i){return null==e?-1:a.call(e,t,i)},merge:function(t,e){for(var i=+e.length,n=0,r=t.length;n<i;n++)t[r++]=e[n];return t.length=r,t},grep:function(t,e,i){for(var n=[],r=0,s=t.length,o=!i;r<s;r++)!e(t[r],r)!==o&&n.push(t[r]);return n},map:function(t,e,i){var n,r,o=0,a=[];if(v(t))for(n=t.length;o<n;o++)null!=(r=e(t[o],o,i))&&a.push(r);else for(o in t)null!=(r=e(t[o],o,i))&&a.push(r);return s(a)},guid:1,support:p}),"function"==typeof Symbol&&(b.fn[Symbol.iterator]=i[Symbol.iterator]),b.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(t,e){u["[object "+e+"]"]=e.toLowerCase()}));var S=
/*!
 * Sizzle CSS Selector Engine v2.3.6
 * https://sizzlejs.com/
 *
 * Copyright JS Foundation and other contributors
 * Released under the MIT license
 * https://js.foundation/
 *
 * Date: 2021-02-16
 */
function(t){var e,i,n,r,s,o,a,u,l,c,h,d,p,f,g,m,_,y,x,w="sizzle"+1*new Date,b=t.document,v=0,S=0,T=ut(),C=ut(),O=ut(),N=ut(),F=function(t,e){return t===e&&(h=!0),0},E={}.hasOwnProperty,D=[],M=D.pop,I=D.push,V=D.push,B=D.slice,A=function(t,e){for(var i=0,n=t.length;i<n;i++)if(t[i]===e)return i;return-1},R="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",P="[\\x20\\t\\r\\n\\f]",L="(?:\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",U="\\[[\\x20\\t\\r\\n\\f]*("+L+")(?:"+P+"*([*^$|!~]?=)"+P+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+L+"))|)"+P+"*\\]",k=":("+L+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+U+")*)|.*)\\)|)",X=new RegExp(P+"+","g"),z=new RegExp("^[\\x20\\t\\r\\n\\f]+|((?:^|[^\\\\])(?:\\\\.)*)[\\x20\\t\\r\\n\\f]+$","g"),j=new RegExp("^[\\x20\\t\\r\\n\\f]*,[\\x20\\t\\r\\n\\f]*"),G=new RegExp("^[\\x20\\t\\r\\n\\f]*([>+~]|[\\x20\\t\\r\\n\\f])[\\x20\\t\\r\\n\\f]*"),q=new RegExp(P+"|>"),H=new RegExp(k),W=new RegExp("^"+L+"$"),Y={ID:new RegExp("^#("+L+")"),CLASS:new RegExp("^\\.("+L+")"),TAG:new RegExp("^("+L+"|[*])"),ATTR:new RegExp("^"+U),PSEUDO:new RegExp("^"+k),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\([\\x20\\t\\r\\n\\f]*(even|odd|(([+-]|)(\\d*)n|)[\\x20\\t\\r\\n\\f]*(?:([+-]|)[\\x20\\t\\r\\n\\f]*(\\d+)|))[\\x20\\t\\r\\n\\f]*\\)|)","i"),bool:new RegExp("^(?:"+R+")$","i"),needsContext:new RegExp("^[\\x20\\t\\r\\n\\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\([\\x20\\t\\r\\n\\f]*((?:-\\d)?\\d*)[\\x20\\t\\r\\n\\f]*\\)|)(?=[^-]|$)","i")},Z=/HTML$/i,K=/^(?:input|select|textarea|button)$/i,Q=/^h\d$/i,$=/^[^{]+\{\s*\[native \w/,J=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,tt=/[+~]/,et=new RegExp("\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\([^\\r\\n\\f])","g"),it=function(t,e){var i="0x"+t.slice(1)-65536;return e||(i<0?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320))},nt=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,rt=function(t,e){return e?"\0"===t?"�":t.slice(0,-1)+"\\"+t.charCodeAt(t.length-1).toString(16)+" ":"\\"+t},st=function(){d()},ot=wt((function(t){return!0===t.disabled&&"fieldset"===t.nodeName.toLowerCase()}),{dir:"parentNode",next:"legend"});try{V.apply(D=B.call(b.childNodes),b.childNodes),D[b.childNodes.length].nodeType}catch(t){V={apply:D.length?function(t,e){I.apply(t,B.call(e))}:function(t,e){for(var i=t.length,n=0;t[i++]=e[n++];);t.length=i-1}}}function at(t,e,n,r){var s,a,l,c,h,f,_,y=e&&e.ownerDocument,b=e?e.nodeType:9;if(n=n||[],"string"!=typeof t||!t||1!==b&&9!==b&&11!==b)return n;if(!r&&(d(e),e=e||p,g)){if(11!==b&&(h=J.exec(t)))if(s=h[1]){if(9===b){if(!(l=e.getElementById(s)))return n;if(l.id===s)return n.push(l),n}else if(y&&(l=y.getElementById(s))&&x(e,l)&&l.id===s)return n.push(l),n}else{if(h[2])return V.apply(n,e.getElementsByTagName(t)),n;if((s=h[3])&&i.getElementsByClassName&&e.getElementsByClassName)return V.apply(n,e.getElementsByClassName(s)),n}if(i.qsa&&!N[t+" "]&&(!m||!m.test(t))&&(1!==b||"object"!==e.nodeName.toLowerCase())){if(_=t,y=e,1===b&&(q.test(t)||G.test(t))){for((y=tt.test(t)&&_t(e.parentNode)||e)===e&&i.scope||((c=e.getAttribute("id"))?c=c.replace(nt,rt):e.setAttribute("id",c=w)),a=(f=o(t)).length;a--;)f[a]=(c?"#"+c:":scope")+" "+xt(f[a]);_=f.join(",")}try{return V.apply(n,y.querySelectorAll(_)),n}catch(e){N(t,!0)}finally{c===w&&e.removeAttribute("id")}}}return u(t.replace(z,"$1"),e,n,r)}function ut(){var t=[];return function e(i,r){return t.push(i+" ")>n.cacheLength&&delete e[t.shift()],e[i+" "]=r}}function lt(t){return t[w]=!0,t}function ct(t){var e=p.createElement("fieldset");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function ht(t,e){for(var i=t.split("|"),r=i.length;r--;)n.attrHandle[i[r]]=e}function dt(t,e){var i=e&&t,n=i&&1===t.nodeType&&1===e.nodeType&&t.sourceIndex-e.sourceIndex;if(n)return n;if(i)for(;i=i.nextSibling;)if(i===e)return-1;return t?1:-1}function pt(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function ft(t){return function(e){var i=e.nodeName.toLowerCase();return("input"===i||"button"===i)&&e.type===t}}function gt(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&ot(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function mt(t){return lt((function(e){return e=+e,lt((function(i,n){for(var r,s=t([],i.length,e),o=s.length;o--;)i[r=s[o]]&&(i[r]=!(n[r]=i[r]))}))}))}function _t(t){return t&&void 0!==t.getElementsByTagName&&t}for(e in i=at.support={},s=at.isXML=function(t){var e=t&&t.namespaceURI,i=t&&(t.ownerDocument||t).documentElement;return!Z.test(e||i&&i.nodeName||"HTML")},d=at.setDocument=function(t){var e,r,o=t?t.ownerDocument||t:b;return o!=p&&9===o.nodeType&&o.documentElement?(f=(p=o).documentElement,g=!s(p),b!=p&&(r=p.defaultView)&&r.top!==r&&(r.addEventListener?r.addEventListener("unload",st,!1):r.attachEvent&&r.attachEvent("onunload",st)),i.scope=ct((function(t){return f.appendChild(t).appendChild(p.createElement("div")),void 0!==t.querySelectorAll&&!t.querySelectorAll(":scope fieldset div").length})),i.attributes=ct((function(t){return t.className="i",!t.getAttribute("className")})),i.getElementsByTagName=ct((function(t){return t.appendChild(p.createComment("")),!t.getElementsByTagName("*").length})),i.getElementsByClassName=$.test(p.getElementsByClassName),i.getById=ct((function(t){return f.appendChild(t).id=w,!p.getElementsByName||!p.getElementsByName(w).length})),i.getById?(n.filter.ID=function(t){var e=t.replace(et,it);return function(t){return t.getAttribute("id")===e}},n.find.ID=function(t,e){if(void 0!==e.getElementById&&g){var i=e.getElementById(t);return i?[i]:[]}}):(n.filter.ID=function(t){var e=t.replace(et,it);return function(t){var i=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return i&&i.value===e}},n.find.ID=function(t,e){if(void 0!==e.getElementById&&g){var i,n,r,s=e.getElementById(t);if(s){if((i=s.getAttributeNode("id"))&&i.value===t)return[s];for(r=e.getElementsByName(t),n=0;s=r[n++];)if((i=s.getAttributeNode("id"))&&i.value===t)return[s]}return[]}}),n.find.TAG=i.getElementsByTagName?function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):i.qsa?e.querySelectorAll(t):void 0}:function(t,e){var i,n=[],r=0,s=e.getElementsByTagName(t);if("*"===t){for(;i=s[r++];)1===i.nodeType&&n.push(i);return n}return s},n.find.CLASS=i.getElementsByClassName&&function(t,e){if(void 0!==e.getElementsByClassName&&g)return e.getElementsByClassName(t)},_=[],m=[],(i.qsa=$.test(p.querySelectorAll))&&(ct((function(t){var e;f.appendChild(t).innerHTML="<a id='"+w+"'></a><select id='"+w+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&m.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:''|\"\")"),t.querySelectorAll("[selected]").length||m.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|"+R+")"),t.querySelectorAll("[id~="+w+"-]").length||m.push("~="),(e=p.createElement("input")).setAttribute("name",""),t.appendChild(e),t.querySelectorAll("[name='']").length||m.push("\\[[\\x20\\t\\r\\n\\f]*name[\\x20\\t\\r\\n\\f]*=[\\x20\\t\\r\\n\\f]*(?:''|\"\")"),t.querySelectorAll(":checked").length||m.push(":checked"),t.querySelectorAll("a#"+w+"+*").length||m.push(".#.+[+~]"),t.querySelectorAll("\\\f"),m.push("[\\r\\n\\f]")})),ct((function(t){t.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var e=p.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&m.push("name[\\x20\\t\\r\\n\\f]*[*^$|!~]?="),2!==t.querySelectorAll(":enabled").length&&m.push(":enabled",":disabled"),f.appendChild(t).disabled=!0,2!==t.querySelectorAll(":disabled").length&&m.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),m.push(",.*:")}))),(i.matchesSelector=$.test(y=f.matches||f.webkitMatchesSelector||f.mozMatchesSelector||f.oMatchesSelector||f.msMatchesSelector))&&ct((function(t){i.disconnectedMatch=y.call(t,"*"),y.call(t,"[s!='']:x"),_.push("!=",k)})),m=m.length&&new RegExp(m.join("|")),_=_.length&&new RegExp(_.join("|")),e=$.test(f.compareDocumentPosition),x=e||$.test(f.contains)?function(t,e){var i=9===t.nodeType?t.documentElement:t,n=e&&e.parentNode;return t===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):t.compareDocumentPosition&&16&t.compareDocumentPosition(n)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},F=e?function(t,e){if(t===e)return h=!0,0;var n=!t.compareDocumentPosition-!e.compareDocumentPosition;return n||(1&(n=(t.ownerDocument||t)==(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!i.sortDetached&&e.compareDocumentPosition(t)===n?t==p||t.ownerDocument==b&&x(b,t)?-1:e==p||e.ownerDocument==b&&x(b,e)?1:c?A(c,t)-A(c,e):0:4&n?-1:1)}:function(t,e){if(t===e)return h=!0,0;var i,n=0,r=t.parentNode,s=e.parentNode,o=[t],a=[e];if(!r||!s)return t==p?-1:e==p?1:r?-1:s?1:c?A(c,t)-A(c,e):0;if(r===s)return dt(t,e);for(i=t;i=i.parentNode;)o.unshift(i);for(i=e;i=i.parentNode;)a.unshift(i);for(;o[n]===a[n];)n++;return n?dt(o[n],a[n]):o[n]==b?-1:a[n]==b?1:0},p):p},at.matches=function(t,e){return at(t,null,null,e)},at.matchesSelector=function(t,e){if(d(t),i.matchesSelector&&g&&!N[e+" "]&&(!_||!_.test(e))&&(!m||!m.test(e)))try{var n=y.call(t,e);if(n||i.disconnectedMatch||t.document&&11!==t.document.nodeType)return n}catch(t){N(e,!0)}return at(e,p,null,[t]).length>0},at.contains=function(t,e){return(t.ownerDocument||t)!=p&&d(t),x(t,e)},at.attr=function(t,e){(t.ownerDocument||t)!=p&&d(t);var r=n.attrHandle[e.toLowerCase()],s=r&&E.call(n.attrHandle,e.toLowerCase())?r(t,e,!g):void 0;return void 0!==s?s:i.attributes||!g?t.getAttribute(e):(s=t.getAttributeNode(e))&&s.specified?s.value:null},at.escape=function(t){return(t+"").replace(nt,rt)},at.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},at.uniqueSort=function(t){var e,n=[],r=0,s=0;if(h=!i.detectDuplicates,c=!i.sortStable&&t.slice(0),t.sort(F),h){for(;e=t[s++];)e===t[s]&&(r=n.push(s));for(;r--;)t.splice(n[r],1)}return c=null,t},r=at.getText=function(t){var e,i="",n=0,s=t.nodeType;if(s){if(1===s||9===s||11===s){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)i+=r(t)}else if(3===s||4===s)return t.nodeValue}else for(;e=t[n++];)i+=r(e);return i},n=at.selectors={cacheLength:50,createPseudo:lt,match:Y,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(et,it),t[3]=(t[3]||t[4]||t[5]||"").replace(et,it),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||at.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&at.error(t[0]),t},PSEUDO:function(t){var e,i=!t[6]&&t[2];return Y.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":i&&H.test(i)&&(e=o(i,!0))&&(e=i.indexOf(")",i.length-e)-i.length)&&(t[0]=t[0].slice(0,e),t[2]=i.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(et,it).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=T[t+" "];return e||(e=new RegExp("(^|[\\x20\\t\\r\\n\\f])"+t+"("+P+"|$)"))&&T(t,(function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")}))},ATTR:function(t,e,i){return function(n){var r=at.attr(n,t);return null==r?"!="===e:!e||(r+="","="===e?r===i:"!="===e?r!==i:"^="===e?i&&0===r.indexOf(i):"*="===e?i&&r.indexOf(i)>-1:"$="===e?i&&r.slice(-i.length)===i:"~="===e?(" "+r.replace(X," ")+" ").indexOf(i)>-1:"|="===e&&(r===i||r.slice(0,i.length+1)===i+"-"))}},CHILD:function(t,e,i,n,r){var s="nth"!==t.slice(0,3),o="last"!==t.slice(-4),a="of-type"===e;return 1===n&&0===r?function(t){return!!t.parentNode}:function(e,i,u){var l,c,h,d,p,f,g=s!==o?"nextSibling":"previousSibling",m=e.parentNode,_=a&&e.nodeName.toLowerCase(),y=!u&&!a,x=!1;if(m){if(s){for(;g;){for(d=e;d=d[g];)if(a?d.nodeName.toLowerCase()===_:1===d.nodeType)return!1;f=g="only"===t&&!f&&"nextSibling"}return!0}if(f=[o?m.firstChild:m.lastChild],o&&y){for(x=(p=(l=(c=(h=(d=m)[w]||(d[w]={}))[d.uniqueID]||(h[d.uniqueID]={}))[t]||[])[0]===v&&l[1])&&l[2],d=p&&m.childNodes[p];d=++p&&d&&d[g]||(x=p=0)||f.pop();)if(1===d.nodeType&&++x&&d===e){c[t]=[v,p,x];break}}else if(y&&(x=p=(l=(c=(h=(d=e)[w]||(d[w]={}))[d.uniqueID]||(h[d.uniqueID]={}))[t]||[])[0]===v&&l[1]),!1===x)for(;(d=++p&&d&&d[g]||(x=p=0)||f.pop())&&((a?d.nodeName.toLowerCase()!==_:1!==d.nodeType)||!++x||(y&&((c=(h=d[w]||(d[w]={}))[d.uniqueID]||(h[d.uniqueID]={}))[t]=[v,x]),d!==e)););return(x-=r)===n||x%n==0&&x/n>=0}}},PSEUDO:function(t,e){var i,r=n.pseudos[t]||n.setFilters[t.toLowerCase()]||at.error("unsupported pseudo: "+t);return r[w]?r(e):r.length>1?(i=[t,t,"",e],n.setFilters.hasOwnProperty(t.toLowerCase())?lt((function(t,i){for(var n,s=r(t,e),o=s.length;o--;)t[n=A(t,s[o])]=!(i[n]=s[o])})):function(t){return r(t,0,i)}):r}},pseudos:{not:lt((function(t){var e=[],i=[],n=a(t.replace(z,"$1"));return n[w]?lt((function(t,e,i,r){for(var s,o=n(t,null,r,[]),a=t.length;a--;)(s=o[a])&&(t[a]=!(e[a]=s))})):function(t,r,s){return e[0]=t,n(e,null,s,i),e[0]=null,!i.pop()}})),has:lt((function(t){return function(e){return at(t,e).length>0}})),contains:lt((function(t){return t=t.replace(et,it),function(e){return(e.textContent||r(e)).indexOf(t)>-1}})),lang:lt((function(t){return W.test(t||"")||at.error("unsupported lang: "+t),t=t.replace(et,it).toLowerCase(),function(e){var i;do{if(i=g?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(i=i.toLowerCase())===t||0===i.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}})),target:function(e){var i=t.location&&t.location.hash;return i&&i.slice(1)===e.id},root:function(t){return t===f},focus:function(t){return t===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:gt(!1),disabled:gt(!0),checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!n.pseudos.empty(t)},header:function(t){return Q.test(t.nodeName)},input:function(t){return K.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:mt((function(){return[0]})),last:mt((function(t,e){return[e-1]})),eq:mt((function(t,e,i){return[i<0?i+e:i]})),even:mt((function(t,e){for(var i=0;i<e;i+=2)t.push(i);return t})),odd:mt((function(t,e){for(var i=1;i<e;i+=2)t.push(i);return t})),lt:mt((function(t,e,i){for(var n=i<0?i+e:i>e?e:i;--n>=0;)t.push(n);return t})),gt:mt((function(t,e,i){for(var n=i<0?i+e:i;++n<e;)t.push(n);return t}))}},n.pseudos.nth=n.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})n.pseudos[e]=pt(e);for(e in{submit:!0,reset:!0})n.pseudos[e]=ft(e);function yt(){}function xt(t){for(var e=0,i=t.length,n="";e<i;e++)n+=t[e].value;return n}function wt(t,e,i){var n=e.dir,r=e.next,s=r||n,o=i&&"parentNode"===s,a=S++;return e.first?function(e,i,r){for(;e=e[n];)if(1===e.nodeType||o)return t(e,i,r);return!1}:function(e,i,u){var l,c,h,d=[v,a];if(u){for(;e=e[n];)if((1===e.nodeType||o)&&t(e,i,u))return!0}else for(;e=e[n];)if(1===e.nodeType||o)if(c=(h=e[w]||(e[w]={}))[e.uniqueID]||(h[e.uniqueID]={}),r&&r===e.nodeName.toLowerCase())e=e[n]||e;else{if((l=c[s])&&l[0]===v&&l[1]===a)return d[2]=l[2];if(c[s]=d,d[2]=t(e,i,u))return!0}return!1}}function bt(t){return t.length>1?function(e,i,n){for(var r=t.length;r--;)if(!t[r](e,i,n))return!1;return!0}:t[0]}function vt(t,e,i,n,r){for(var s,o=[],a=0,u=t.length,l=null!=e;a<u;a++)(s=t[a])&&(i&&!i(s,n,r)||(o.push(s),l&&e.push(a)));return o}function St(t,e,i,n,r,s){return n&&!n[w]&&(n=St(n)),r&&!r[w]&&(r=St(r,s)),lt((function(s,o,a,u){var l,c,h,d=[],p=[],f=o.length,g=s||function(t,e,i){for(var n=0,r=e.length;n<r;n++)at(t,e[n],i);return i}(e||"*",a.nodeType?[a]:a,[]),m=!t||!s&&e?g:vt(g,d,t,a,u),_=i?r||(s?t:f||n)?[]:o:m;if(i&&i(m,_,a,u),n)for(l=vt(_,p),n(l,[],a,u),c=l.length;c--;)(h=l[c])&&(_[p[c]]=!(m[p[c]]=h));if(s){if(r||t){if(r){for(l=[],c=_.length;c--;)(h=_[c])&&l.push(m[c]=h);r(null,_=[],l,u)}for(c=_.length;c--;)(h=_[c])&&(l=r?A(s,h):d[c])>-1&&(s[l]=!(o[l]=h))}}else _=vt(_===o?_.splice(f,_.length):_),r?r(null,o,_,u):V.apply(o,_)}))}function Tt(t){for(var e,i,r,s=t.length,o=n.relative[t[0].type],a=o||n.relative[" "],u=o?1:0,c=wt((function(t){return t===e}),a,!0),h=wt((function(t){return A(e,t)>-1}),a,!0),d=[function(t,i,n){var r=!o&&(n||i!==l)||((e=i).nodeType?c(t,i,n):h(t,i,n));return e=null,r}];u<s;u++)if(i=n.relative[t[u].type])d=[wt(bt(d),i)];else{if((i=n.filter[t[u].type].apply(null,t[u].matches))[w]){for(r=++u;r<s&&!n.relative[t[r].type];r++);return St(u>1&&bt(d),u>1&&xt(t.slice(0,u-1).concat({value:" "===t[u-2].type?"*":""})).replace(z,"$1"),i,u<r&&Tt(t.slice(u,r)),r<s&&Tt(t=t.slice(r)),r<s&&xt(t))}d.push(i)}return bt(d)}return yt.prototype=n.filters=n.pseudos,n.setFilters=new yt,o=at.tokenize=function(t,e){var i,r,s,o,a,u,l,c=C[t+" "];if(c)return e?0:c.slice(0);for(a=t,u=[],l=n.preFilter;a;){for(o in i&&!(r=j.exec(a))||(r&&(a=a.slice(r[0].length)||a),u.push(s=[])),i=!1,(r=G.exec(a))&&(i=r.shift(),s.push({value:i,type:r[0].replace(z," ")}),a=a.slice(i.length)),n.filter)!(r=Y[o].exec(a))||l[o]&&!(r=l[o](r))||(i=r.shift(),s.push({value:i,type:o,matches:r}),a=a.slice(i.length));if(!i)break}return e?a.length:a?at.error(t):C(t,u).slice(0)},a=at.compile=function(t,e){var i,r=[],s=[],a=O[t+" "];if(!a){for(e||(e=o(t)),i=e.length;i--;)(a=Tt(e[i]))[w]?r.push(a):s.push(a);a=O(t,function(t,e){var i=e.length>0,r=t.length>0,s=function(s,o,a,u,c){var h,f,m,_=0,y="0",x=s&&[],w=[],b=l,S=s||r&&n.find.TAG("*",c),T=v+=null==b?1:Math.random()||.1,C=S.length;for(c&&(l=o==p||o||c);y!==C&&null!=(h=S[y]);y++){if(r&&h){for(f=0,o||h.ownerDocument==p||(d(h),a=!g);m=t[f++];)if(m(h,o||p,a)){u.push(h);break}c&&(v=T)}i&&((h=!m&&h)&&_--,s&&x.push(h))}if(_+=y,i&&y!==_){for(f=0;m=e[f++];)m(x,w,o,a);if(s){if(_>0)for(;y--;)x[y]||w[y]||(w[y]=M.call(u));w=vt(w)}V.apply(u,w),c&&!s&&w.length>0&&_+e.length>1&&at.uniqueSort(u)}return c&&(v=T,l=b),x};return i?lt(s):s}(s,r)),a.selector=t}return a},u=at.select=function(t,e,i,r){var s,u,l,c,h,d="function"==typeof t&&t,p=!r&&o(t=d.selector||t);if(i=i||[],1===p.length){if((u=p[0]=p[0].slice(0)).length>2&&"ID"===(l=u[0]).type&&9===e.nodeType&&g&&n.relative[u[1].type]){if(!(e=(n.find.ID(l.matches[0].replace(et,it),e)||[])[0]))return i;d&&(e=e.parentNode),t=t.slice(u.shift().value.length)}for(s=Y.needsContext.test(t)?0:u.length;s--&&(l=u[s],!n.relative[c=l.type]);)if((h=n.find[c])&&(r=h(l.matches[0].replace(et,it),tt.test(u[0].type)&&_t(e.parentNode)||e))){if(u.splice(s,1),!(t=r.length&&xt(u)))return V.apply(i,r),i;break}}return(d||a(t,p))(r,e,!g,i,!e||tt.test(t)&&_t(e.parentNode)||e),i},i.sortStable=w.split("").sort(F).join("")===w,i.detectDuplicates=!!h,d(),i.sortDetached=ct((function(t){return 1&t.compareDocumentPosition(p.createElement("fieldset"))})),ct((function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")}))||ht("type|href|height|width",(function(t,e,i){if(!i)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)})),i.attributes&&ct((function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")}))||ht("value",(function(t,e,i){if(!i&&"input"===t.nodeName.toLowerCase())return t.defaultValue})),ct((function(t){return null==t.getAttribute("disabled")}))||ht(R,(function(t,e,i){var n;if(!i)return!0===t[e]?e.toLowerCase():(n=t.getAttributeNode(e))&&n.specified?n.value:null})),at}(t);b.find=S,b.expr=S.selectors,b.expr[":"]=b.expr.pseudos,b.uniqueSort=b.unique=S.uniqueSort,b.text=S.getText,b.isXMLDoc=S.isXML,b.contains=S.contains,b.escapeSelector=S.escape;var T=function(t,e,i){for(var n=[],r=void 0!==i;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(r&&b(t).is(i))break;n.push(t)}return n},C=function(t,e){for(var i=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&i.push(t);return i},O=b.expr.match.needsContext;function N(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()}var F=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function E(t,e,i){return f(e)?b.grep(t,(function(t,n){return!!e.call(t,n,t)!==i})):e.nodeType?b.grep(t,(function(t){return t===e!==i})):"string"!=typeof e?b.grep(t,(function(t){return a.call(e,t)>-1!==i})):b.filter(e,t,i)}b.filter=function(t,e,i){var n=e[0];return i&&(t=":not("+t+")"),1===e.length&&1===n.nodeType?b.find.matchesSelector(n,t)?[n]:[]:b.find.matches(t,b.grep(e,(function(t){return 1===t.nodeType})))},b.fn.extend({find:function(t){var e,i,n=this.length,r=this;if("string"!=typeof t)return this.pushStack(b(t).filter((function(){for(e=0;e<n;e++)if(b.contains(r[e],this))return!0})));for(i=this.pushStack([]),e=0;e<n;e++)b.find(t,r[e],i);return n>1?b.uniqueSort(i):i},filter:function(t){return this.pushStack(E(this,t||[],!1))},not:function(t){return this.pushStack(E(this,t||[],!0))},is:function(t){return!!E(this,"string"==typeof t&&O.test(t)?b(t):t||[],!1).length}});var D,M=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(b.fn.init=function(t,e,i){var n,r;if(!t)return this;if(i=i||D,"string"==typeof t){if(!(n="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:M.exec(t))||!n[1]&&e)return!e||e.jquery?(e||i).find(t):this.constructor(e).find(t);if(n[1]){if(e=e instanceof b?e[0]:e,b.merge(this,b.parseHTML(n[1],e&&e.nodeType?e.ownerDocument||e:m,!0)),F.test(n[1])&&b.isPlainObject(e))for(n in e)f(this[n])?this[n](e[n]):this.attr(n,e[n]);return this}return(r=m.getElementById(n[2]))&&(this[0]=r,this.length=1),this}return t.nodeType?(this[0]=t,this.length=1,this):f(t)?void 0!==i.ready?i.ready(t):t(b):b.makeArray(t,this)}).prototype=b.fn,D=b(m);var I=/^(?:parents|prev(?:Until|All))/,V={children:!0,contents:!0,next:!0,prev:!0};function B(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}b.fn.extend({has:function(t){var e=b(t,this),i=e.length;return this.filter((function(){for(var t=0;t<i;t++)if(b.contains(this,e[t]))return!0}))},closest:function(t,e){var i,n=0,r=this.length,s=[],o="string"!=typeof t&&b(t);if(!O.test(t))for(;n<r;n++)for(i=this[n];i&&i!==e;i=i.parentNode)if(i.nodeType<11&&(o?o.index(i)>-1:1===i.nodeType&&b.find.matchesSelector(i,t))){s.push(i);break}return this.pushStack(s.length>1?b.uniqueSort(s):s)},index:function(t){return t?"string"==typeof t?a.call(b(t),this[0]):a.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(b.uniqueSort(b.merge(this.get(),b(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),b.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return T(t,"parentNode")},parentsUntil:function(t,e,i){return T(t,"parentNode",i)},next:function(t){return B(t,"nextSibling")},prev:function(t){return B(t,"previousSibling")},nextAll:function(t){return T(t,"nextSibling")},prevAll:function(t){return T(t,"previousSibling")},nextUntil:function(t,e,i){return T(t,"nextSibling",i)},prevUntil:function(t,e,i){return T(t,"previousSibling",i)},siblings:function(t){return C((t.parentNode||{}).firstChild,t)},children:function(t){return C(t.firstChild)},contents:function(t){return null!=t.contentDocument&&n(t.contentDocument)?t.contentDocument:(N(t,"template")&&(t=t.content||t),b.merge([],t.childNodes))}},(function(t,e){b.fn[t]=function(i,n){var r=b.map(this,e,i);return"Until"!==t.slice(-5)&&(n=i),n&&"string"==typeof n&&(r=b.filter(n,r)),this.length>1&&(V[t]||b.uniqueSort(r),I.test(t)&&r.reverse()),this.pushStack(r)}}));var A=/[^\x20\t\r\n\f]+/g;function R(t){return t}function P(t){throw t}function L(t,e,i,n){var r;try{t&&f(r=t.promise)?r.call(t).done(e).fail(i):t&&f(r=t.then)?r.call(t,e,i):e.apply(void 0,[t].slice(n))}catch(t){i.apply(void 0,[t])}}b.Callbacks=function(t){t="string"==typeof t?function(t){var e={};return b.each(t.match(A)||[],(function(t,i){e[i]=!0})),e}(t):b.extend({},t);var e,i,n,r,s=[],o=[],a=-1,u=function(){for(r=r||t.once,n=e=!0;o.length;a=-1)for(i=o.shift();++a<s.length;)!1===s[a].apply(i[0],i[1])&&t.stopOnFalse&&(a=s.length,i=!1);t.memory||(i=!1),e=!1,r&&(s=i?[]:"")},l={add:function(){return s&&(i&&!e&&(a=s.length-1,o.push(i)),function e(i){b.each(i,(function(i,n){f(n)?t.unique&&l.has(n)||s.push(n):n&&n.length&&"string"!==x(n)&&e(n)}))}(arguments),i&&!e&&u()),this},remove:function(){return b.each(arguments,(function(t,e){for(var i;(i=b.inArray(e,s,i))>-1;)s.splice(i,1),i<=a&&a--})),this},has:function(t){return t?b.inArray(t,s)>-1:s.length>0},empty:function(){return s&&(s=[]),this},disable:function(){return r=o=[],s=i="",this},disabled:function(){return!s},lock:function(){return r=o=[],i||e||(s=i=""),this},locked:function(){return!!r},fireWith:function(t,i){return r||(i=[t,(i=i||[]).slice?i.slice():i],o.push(i),e||u()),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!n}};return l},b.extend({Deferred:function(e){var i=[["notify","progress",b.Callbacks("memory"),b.Callbacks("memory"),2],["resolve","done",b.Callbacks("once memory"),b.Callbacks("once memory"),0,"resolved"],["reject","fail",b.Callbacks("once memory"),b.Callbacks("once memory"),1,"rejected"]],n="pending",r={state:function(){return n},always:function(){return s.done(arguments).fail(arguments),this},catch:function(t){return r.then(null,t)},pipe:function(){var t=arguments;return b.Deferred((function(e){b.each(i,(function(i,n){var r=f(t[n[4]])&&t[n[4]];s[n[1]]((function(){var t=r&&r.apply(this,arguments);t&&f(t.promise)?t.promise().progress(e.notify).done(e.resolve).fail(e.reject):e[n[0]+"With"](this,r?[t]:arguments)}))})),t=null})).promise()},then:function(e,n,r){var s=0;function o(e,i,n,r){return function(){var a=this,u=arguments,l=function(){var t,l;if(!(e<s)){if((t=n.apply(a,u))===i.promise())throw new TypeError("Thenable self-resolution");l=t&&("object"==typeof t||"function"==typeof t)&&t.then,f(l)?r?l.call(t,o(s,i,R,r),o(s,i,P,r)):(s++,l.call(t,o(s,i,R,r),o(s,i,P,r),o(s,i,R,i.notifyWith))):(n!==R&&(a=void 0,u=[t]),(r||i.resolveWith)(a,u))}},c=r?l:function(){try{l()}catch(t){b.Deferred.exceptionHook&&b.Deferred.exceptionHook(t,c.stackTrace),e+1>=s&&(n!==P&&(a=void 0,u=[t]),i.rejectWith(a,u))}};e?c():(b.Deferred.getStackHook&&(c.stackTrace=b.Deferred.getStackHook()),t.setTimeout(c))}}return b.Deferred((function(t){i[0][3].add(o(0,t,f(r)?r:R,t.notifyWith)),i[1][3].add(o(0,t,f(e)?e:R)),i[2][3].add(o(0,t,f(n)?n:P))})).promise()},promise:function(t){return null!=t?b.extend(t,r):r}},s={};return b.each(i,(function(t,e){var o=e[2],a=e[5];r[e[1]]=o.add,a&&o.add((function(){n=a}),i[3-t][2].disable,i[3-t][3].disable,i[0][2].lock,i[0][3].lock),o.add(e[3].fire),s[e[0]]=function(){return s[e[0]+"With"](this===s?void 0:this,arguments),this},s[e[0]+"With"]=o.fireWith})),r.promise(s),e&&e.call(s,s),s},when:function(t){var e=arguments.length,i=e,n=Array(i),s=r.call(arguments),o=b.Deferred(),a=function(t){return function(i){n[t]=this,s[t]=arguments.length>1?r.call(arguments):i,--e||o.resolveWith(n,s)}};if(e<=1&&(L(t,o.done(a(i)).resolve,o.reject,!e),"pending"===o.state()||f(s[i]&&s[i].then)))return o.then();for(;i--;)L(s[i],a(i),o.reject);return o.promise()}});var U=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;b.Deferred.exceptionHook=function(e,i){t.console&&t.console.warn&&e&&U.test(e.name)&&t.console.warn("jQuery.Deferred exception: "+e.message,e.stack,i)},b.readyException=function(e){t.setTimeout((function(){throw e}))};var k=b.Deferred();function X(){m.removeEventListener("DOMContentLoaded",X),t.removeEventListener("load",X),b.ready()}b.fn.ready=function(t){return k.then(t).catch((function(t){b.readyException(t)})),this},b.extend({isReady:!1,readyWait:1,ready:function(t){(!0===t?--b.readyWait:b.isReady)||(b.isReady=!0,!0!==t&&--b.readyWait>0||k.resolveWith(m,[b]))}}),b.ready.then=k.then,"complete"===m.readyState||"loading"!==m.readyState&&!m.documentElement.doScroll?t.setTimeout(b.ready):(m.addEventListener("DOMContentLoaded",X),t.addEventListener("load",X));var z=function(t,e,i,n,r,s,o){var a=0,u=t.length,l=null==i;if("object"===x(i))for(a in r=!0,i)z(t,e,a,i[a],!0,s,o);else if(void 0!==n&&(r=!0,f(n)||(o=!0),l&&(o?(e.call(t,n),e=null):(l=e,e=function(t,e,i){return l.call(b(t),i)})),e))for(;a<u;a++)e(t[a],i,o?n:n.call(t[a],a,e(t[a],i)));return r?t:l?e.call(t):u?e(t[0],i):s},j=/^-ms-/,G=/-([a-z])/g;function q(t,e){return e.toUpperCase()}function H(t){return t.replace(j,"ms-").replace(G,q)}var W=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType};function Y(){this.expando=b.expando+Y.uid++}Y.uid=1,Y.prototype={cache:function(t){var e=t[this.expando];return e||(e={},W(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,i){var n,r=this.cache(t);if("string"==typeof e)r[H(e)]=i;else for(n in e)r[H(n)]=e[n];return r},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][H(e)]},access:function(t,e,i){return void 0===e||e&&"string"==typeof e&&void 0===i?this.get(t,e):(this.set(t,e,i),void 0!==i?i:e)},remove:function(t,e){var i,n=t[this.expando];if(void 0!==n){if(void 0!==e){i=(e=Array.isArray(e)?e.map(H):(e=H(e))in n?[e]:e.match(A)||[]).length;for(;i--;)delete n[e[i]]}(void 0===e||b.isEmptyObject(n))&&(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return void 0!==e&&!b.isEmptyObject(e)}};var Z=new Y,K=new Y,Q=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,$=/[A-Z]/g;function J(t,e,i){var n;if(void 0===i&&1===t.nodeType)if(n="data-"+e.replace($,"-$&").toLowerCase(),"string"==typeof(i=t.getAttribute(n))){try{i=function(t){return"true"===t||"false"!==t&&("null"===t?null:t===+t+""?+t:Q.test(t)?JSON.parse(t):t)}(i)}catch(t){}K.set(t,e,i)}else i=void 0;return i}b.extend({hasData:function(t){return K.hasData(t)||Z.hasData(t)},data:function(t,e,i){return K.access(t,e,i)},removeData:function(t,e){K.remove(t,e)},_data:function(t,e,i){return Z.access(t,e,i)},_removeData:function(t,e){Z.remove(t,e)}}),b.fn.extend({data:function(t,e){var i,n,r,s=this[0],o=s&&s.attributes;if(void 0===t){if(this.length&&(r=K.get(s),1===s.nodeType&&!Z.get(s,"hasDataAttrs"))){for(i=o.length;i--;)o[i]&&0===(n=o[i].name).indexOf("data-")&&(n=H(n.slice(5)),J(s,n,r[n]));Z.set(s,"hasDataAttrs",!0)}return r}return"object"==typeof t?this.each((function(){K.set(this,t)})):z(this,(function(e){var i;if(s&&void 0===e)return void 0!==(i=K.get(s,t))||void 0!==(i=J(s,t))?i:void 0;this.each((function(){K.set(this,t,e)}))}),null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each((function(){K.remove(this,t)}))}}),b.extend({queue:function(t,e,i){var n;if(t)return e=(e||"fx")+"queue",n=Z.get(t,e),i&&(!n||Array.isArray(i)?n=Z.access(t,e,b.makeArray(i)):n.push(i)),n||[]},dequeue:function(t,e){e=e||"fx";var i=b.queue(t,e),n=i.length,r=i.shift(),s=b._queueHooks(t,e);"inprogress"===r&&(r=i.shift(),n--),r&&("fx"===e&&i.unshift("inprogress"),delete s.stop,r.call(t,(function(){b.dequeue(t,e)}),s)),!n&&s&&s.empty.fire()},_queueHooks:function(t,e){var i=e+"queueHooks";return Z.get(t,i)||Z.access(t,i,{empty:b.Callbacks("once memory").add((function(){Z.remove(t,[e+"queue",i])}))})}}),b.fn.extend({queue:function(t,e){var i=2;return"string"!=typeof t&&(e=t,t="fx",i--),arguments.length<i?b.queue(this[0],t):void 0===e?this:this.each((function(){var i=b.queue(this,t,e);b._queueHooks(this,t),"fx"===t&&"inprogress"!==i[0]&&b.dequeue(this,t)}))},dequeue:function(t){return this.each((function(){b.dequeue(this,t)}))},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var i,n=1,r=b.Deferred(),s=this,o=this.length,a=function(){--n||r.resolveWith(s,[s])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";o--;)(i=Z.get(s[o],t+"queueHooks"))&&i.empty&&(n++,i.empty.add(a));return a(),r.promise(e)}});var tt=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,et=new RegExp("^(?:([+-])=|)("+tt+")([a-z%]*)$","i"),it=["Top","Right","Bottom","Left"],nt=m.documentElement,rt=function(t){return b.contains(t.ownerDocument,t)},st={composed:!0};nt.getRootNode&&(rt=function(t){return b.contains(t.ownerDocument,t)||t.getRootNode(st)===t.ownerDocument});var ot=function(t,e){return"none"===(t=e||t).style.display||""===t.style.display&&rt(t)&&"none"===b.css(t,"display")};function at(t,e,i,n){var r,s,o=20,a=n?function(){return n.cur()}:function(){return b.css(t,e,"")},u=a(),l=i&&i[3]||(b.cssNumber[e]?"":"px"),c=t.nodeType&&(b.cssNumber[e]||"px"!==l&&+u)&&et.exec(b.css(t,e));if(c&&c[3]!==l){for(u/=2,l=l||c[3],c=+u||1;o--;)b.style(t,e,c+l),(1-s)*(1-(s=a()/u||.5))<=0&&(o=0),c/=s;c*=2,b.style(t,e,c+l),i=i||[]}return i&&(c=+c||+u||0,r=i[1]?c+(i[1]+1)*i[2]:+i[2],n&&(n.unit=l,n.start=c,n.end=r)),r}var ut={};function lt(t){var e,i=t.ownerDocument,n=t.nodeName,r=ut[n];return r||(e=i.body.appendChild(i.createElement(n)),r=b.css(e,"display"),e.parentNode.removeChild(e),"none"===r&&(r="block"),ut[n]=r,r)}function ct(t,e){for(var i,n,r=[],s=0,o=t.length;s<o;s++)(n=t[s]).style&&(i=n.style.display,e?("none"===i&&(r[s]=Z.get(n,"display")||null,r[s]||(n.style.display="")),""===n.style.display&&ot(n)&&(r[s]=lt(n))):"none"!==i&&(r[s]="none",Z.set(n,"display",i)));for(s=0;s<o;s++)null!=r[s]&&(t[s].style.display=r[s]);return t}b.fn.extend({show:function(){return ct(this,!0)},hide:function(){return ct(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each((function(){ot(this)?b(this).show():b(this).hide()}))}});var ht,dt,pt=/^(?:checkbox|radio)$/i,ft=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,gt=/^$|^module$|\/(?:java|ecma)script/i;ht=m.createDocumentFragment().appendChild(m.createElement("div")),(dt=m.createElement("input")).setAttribute("type","radio"),dt.setAttribute("checked","checked"),dt.setAttribute("name","t"),ht.appendChild(dt),p.checkClone=ht.cloneNode(!0).cloneNode(!0).lastChild.checked,ht.innerHTML="<textarea>x</textarea>",p.noCloneChecked=!!ht.cloneNode(!0).lastChild.defaultValue,ht.innerHTML="<option></option>",p.option=!!ht.lastChild;var mt={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function _t(t,e){var i;return i=void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):[],void 0===e||e&&N(t,e)?b.merge([t],i):i}function yt(t,e){for(var i=0,n=t.length;i<n;i++)Z.set(t[i],"globalEval",!e||Z.get(e[i],"globalEval"))}mt.tbody=mt.tfoot=mt.colgroup=mt.caption=mt.thead,mt.th=mt.td,p.option||(mt.optgroup=mt.option=[1,"<select multiple='multiple'>","</select>"]);var xt=/<|&#?\w+;/;function wt(t,e,i,n,r){for(var s,o,a,u,l,c,h=e.createDocumentFragment(),d=[],p=0,f=t.length;p<f;p++)if((s=t[p])||0===s)if("object"===x(s))b.merge(d,s.nodeType?[s]:s);else if(xt.test(s)){for(o=o||h.appendChild(e.createElement("div")),a=(ft.exec(s)||["",""])[1].toLowerCase(),u=mt[a]||mt._default,o.innerHTML=u[1]+b.htmlPrefilter(s)+u[2],c=u[0];c--;)o=o.lastChild;b.merge(d,o.childNodes),(o=h.firstChild).textContent=""}else d.push(e.createTextNode(s));for(h.textContent="",p=0;s=d[p++];)if(n&&b.inArray(s,n)>-1)r&&r.push(s);else if(l=rt(s),o=_t(h.appendChild(s),"script"),l&&yt(o),i)for(c=0;s=o[c++];)gt.test(s.type||"")&&i.push(s);return h}var bt=/^([^.]*)(?:\.(.+)|)/;function vt(){return!0}function St(){return!1}function Tt(t,e){return t===function(){try{return m.activeElement}catch(t){}}()==("focus"===e)}function Ct(t,e,i,n,r,s){var o,a;if("object"==typeof e){for(a in"string"!=typeof i&&(n=n||i,i=void 0),e)Ct(t,a,i,n,e[a],s);return t}if(null==n&&null==r?(r=i,n=i=void 0):null==r&&("string"==typeof i?(r=n,n=void 0):(r=n,n=i,i=void 0)),!1===r)r=St;else if(!r)return t;return 1===s&&(o=r,r=function(t){return b().off(t),o.apply(this,arguments)},r.guid=o.guid||(o.guid=b.guid++)),t.each((function(){b.event.add(this,e,r,n,i)}))}function Ot(t,e,i){i?(Z.set(t,e,!1),b.event.add(t,e,{namespace:!1,handler:function(t){var n,s,o=Z.get(this,e);if(1&t.isTrigger&&this[e]){if(o.length)(b.event.special[e]||{}).delegateType&&t.stopPropagation();else if(o=r.call(arguments),Z.set(this,e,o),n=i(this,e),this[e](),o!==(s=Z.get(this,e))||n?Z.set(this,e,!1):s={},o!==s)return t.stopImmediatePropagation(),t.preventDefault(),s&&s.value}else o.length&&(Z.set(this,e,{value:b.event.trigger(b.extend(o[0],b.Event.prototype),o.slice(1),this)}),t.stopImmediatePropagation())}})):void 0===Z.get(t,e)&&b.event.add(t,e,vt)}b.event={global:{},add:function(t,e,i,n,r){var s,o,a,u,l,c,h,d,p,f,g,m=Z.get(t);if(W(t))for(i.handler&&(i=(s=i).handler,r=s.selector),r&&b.find.matchesSelector(nt,r),i.guid||(i.guid=b.guid++),(u=m.events)||(u=m.events=Object.create(null)),(o=m.handle)||(o=m.handle=function(e){return void 0!==b&&b.event.triggered!==e.type?b.event.dispatch.apply(t,arguments):void 0}),l=(e=(e||"").match(A)||[""]).length;l--;)p=g=(a=bt.exec(e[l])||[])[1],f=(a[2]||"").split(".").sort(),p&&(h=b.event.special[p]||{},p=(r?h.delegateType:h.bindType)||p,h=b.event.special[p]||{},c=b.extend({type:p,origType:g,data:n,handler:i,guid:i.guid,selector:r,needsContext:r&&b.expr.match.needsContext.test(r),namespace:f.join(".")},s),(d=u[p])||((d=u[p]=[]).delegateCount=0,h.setup&&!1!==h.setup.call(t,n,f,o)||t.addEventListener&&t.addEventListener(p,o)),h.add&&(h.add.call(t,c),c.handler.guid||(c.handler.guid=i.guid)),r?d.splice(d.delegateCount++,0,c):d.push(c),b.event.global[p]=!0)},remove:function(t,e,i,n,r){var s,o,a,u,l,c,h,d,p,f,g,m=Z.hasData(t)&&Z.get(t);if(m&&(u=m.events)){for(l=(e=(e||"").match(A)||[""]).length;l--;)if(p=g=(a=bt.exec(e[l])||[])[1],f=(a[2]||"").split(".").sort(),p){for(h=b.event.special[p]||{},d=u[p=(n?h.delegateType:h.bindType)||p]||[],a=a[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),o=s=d.length;s--;)c=d[s],!r&&g!==c.origType||i&&i.guid!==c.guid||a&&!a.test(c.namespace)||n&&n!==c.selector&&("**"!==n||!c.selector)||(d.splice(s,1),c.selector&&d.delegateCount--,h.remove&&h.remove.call(t,c));o&&!d.length&&(h.teardown&&!1!==h.teardown.call(t,f,m.handle)||b.removeEvent(t,p,m.handle),delete u[p])}else for(p in u)b.event.remove(t,p+e[l],i,n,!0);b.isEmptyObject(u)&&Z.remove(t,"handle events")}},dispatch:function(t){var e,i,n,r,s,o,a=new Array(arguments.length),u=b.event.fix(t),l=(Z.get(this,"events")||Object.create(null))[u.type]||[],c=b.event.special[u.type]||{};for(a[0]=u,e=1;e<arguments.length;e++)a[e]=arguments[e];if(u.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,u)){for(o=b.event.handlers.call(this,u,l),e=0;(r=o[e++])&&!u.isPropagationStopped();)for(u.currentTarget=r.elem,i=0;(s=r.handlers[i++])&&!u.isImmediatePropagationStopped();)u.rnamespace&&!1!==s.namespace&&!u.rnamespace.test(s.namespace)||(u.handleObj=s,u.data=s.data,void 0!==(n=((b.event.special[s.origType]||{}).handle||s.handler).apply(r.elem,a))&&!1===(u.result=n)&&(u.preventDefault(),u.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,u),u.result}},handlers:function(t,e){var i,n,r,s,o,a=[],u=e.delegateCount,l=t.target;if(u&&l.nodeType&&!("click"===t.type&&t.button>=1))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==t.type||!0!==l.disabled)){for(s=[],o={},i=0;i<u;i++)void 0===o[r=(n=e[i]).selector+" "]&&(o[r]=n.needsContext?b(r,this).index(l)>-1:b.find(r,this,null,[l]).length),o[r]&&s.push(n);s.length&&a.push({elem:l,handlers:s})}return l=this,u<e.length&&a.push({elem:l,handlers:e.slice(u)}),a},addProp:function(t,e){Object.defineProperty(b.Event.prototype,t,{enumerable:!0,configurable:!0,get:f(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(t){return t[b.expando]?t:new b.Event(t)},special:{load:{noBubble:!0},click:{setup:function(t){var e=this||t;return pt.test(e.type)&&e.click&&N(e,"input")&&Ot(e,"click",vt),!1},trigger:function(t){var e=this||t;return pt.test(e.type)&&e.click&&N(e,"input")&&Ot(e,"click"),!0},_default:function(t){var e=t.target;return pt.test(e.type)&&e.click&&N(e,"input")&&Z.get(e,"click")||N(e,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},b.removeEvent=function(t,e,i){t.removeEventListener&&t.removeEventListener(e,i)},b.Event=function(t,e){if(!(this instanceof b.Event))return new b.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?vt:St,this.target=t.target&&3===t.target.nodeType?t.target.parentNode:t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget):this.type=t,e&&b.extend(this,e),this.timeStamp=t&&t.timeStamp||Date.now(),this[b.expando]=!0},b.Event.prototype={constructor:b.Event,isDefaultPrevented:St,isPropagationStopped:St,isImmediatePropagationStopped:St,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=vt,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=vt,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=vt,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},b.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},b.event.addProp),b.each({focus:"focusin",blur:"focusout"},(function(t,e){b.event.special[t]={setup:function(){return Ot(this,t,Tt),!1},trigger:function(){return Ot(this,t),!0},_default:function(){return!0},delegateType:e}})),b.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(t,e){b.event.special[t]={delegateType:e,bindType:e,handle:function(t){var i,n=this,r=t.relatedTarget,s=t.handleObj;return r&&(r===n||b.contains(n,r))||(t.type=s.origType,i=s.handler.apply(this,arguments),t.type=e),i}}})),b.fn.extend({on:function(t,e,i,n){return Ct(this,t,e,i,n)},one:function(t,e,i,n){return Ct(this,t,e,i,n,1)},off:function(t,e,i){var n,r;if(t&&t.preventDefault&&t.handleObj)return n=t.handleObj,b(t.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof t){for(r in t)this.off(r,e,t[r]);return this}return!1!==e&&"function"!=typeof e||(i=e,e=void 0),!1===i&&(i=St),this.each((function(){b.event.remove(this,t,i,e)}))}});var Nt=/<script|<style|<link/i,Ft=/checked\s*(?:[^=]|=\s*.checked.)/i,Et=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Dt(t,e){return N(t,"table")&&N(11!==e.nodeType?e:e.firstChild,"tr")&&b(t).children("tbody")[0]||t}function Mt(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function It(t){return"true/"===(t.type||"").slice(0,5)?t.type=t.type.slice(5):t.removeAttribute("type"),t}function Vt(t,e){var i,n,r,s,o,a;if(1===e.nodeType){if(Z.hasData(t)&&(a=Z.get(t).events))for(r in Z.remove(e,"handle events"),a)for(i=0,n=a[r].length;i<n;i++)b.event.add(e,r,a[r][i]);K.hasData(t)&&(s=K.access(t),o=b.extend({},s),K.set(e,o))}}function Bt(t,e){var i=e.nodeName.toLowerCase();"input"===i&&pt.test(t.type)?e.checked=t.checked:"input"!==i&&"textarea"!==i||(e.defaultValue=t.defaultValue)}function At(t,e,i,n){e=s(e);var r,o,a,u,l,c,h=0,d=t.length,g=d-1,m=e[0],_=f(m);if(_||d>1&&"string"==typeof m&&!p.checkClone&&Ft.test(m))return t.each((function(r){var s=t.eq(r);_&&(e[0]=m.call(this,r,s.html())),At(s,e,i,n)}));if(d&&(o=(r=wt(e,t[0].ownerDocument,!1,t,n)).firstChild,1===r.childNodes.length&&(r=o),o||n)){for(u=(a=b.map(_t(r,"script"),Mt)).length;h<d;h++)l=r,h!==g&&(l=b.clone(l,!0,!0),u&&b.merge(a,_t(l,"script"))),i.call(t[h],l,h);if(u)for(c=a[a.length-1].ownerDocument,b.map(a,It),h=0;h<u;h++)l=a[h],gt.test(l.type||"")&&!Z.access(l,"globalEval")&&b.contains(c,l)&&(l.src&&"module"!==(l.type||"").toLowerCase()?b._evalUrl&&!l.noModule&&b._evalUrl(l.src,{nonce:l.nonce||l.getAttribute("nonce")},c):y(l.textContent.replace(Et,""),l,c))}return t}function Rt(t,e,i){for(var n,r=e?b.filter(e,t):t,s=0;null!=(n=r[s]);s++)i||1!==n.nodeType||b.cleanData(_t(n)),n.parentNode&&(i&&rt(n)&&yt(_t(n,"script")),n.parentNode.removeChild(n));return t}b.extend({htmlPrefilter:function(t){return t},clone:function(t,e,i){var n,r,s,o,a=t.cloneNode(!0),u=rt(t);if(!(p.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||b.isXMLDoc(t)))for(o=_t(a),n=0,r=(s=_t(t)).length;n<r;n++)Bt(s[n],o[n]);if(e)if(i)for(s=s||_t(t),o=o||_t(a),n=0,r=s.length;n<r;n++)Vt(s[n],o[n]);else Vt(t,a);return(o=_t(a,"script")).length>0&&yt(o,!u&&_t(t,"script")),a},cleanData:function(t){for(var e,i,n,r=b.event.special,s=0;void 0!==(i=t[s]);s++)if(W(i)){if(e=i[Z.expando]){if(e.events)for(n in e.events)r[n]?b.event.remove(i,n):b.removeEvent(i,n,e.handle);i[Z.expando]=void 0}i[K.expando]&&(i[K.expando]=void 0)}}}),b.fn.extend({detach:function(t){return Rt(this,t,!0)},remove:function(t){return Rt(this,t)},text:function(t){return z(this,(function(t){return void 0===t?b.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)}))}),null,t,arguments.length)},append:function(){return At(this,arguments,(function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Dt(this,t).appendChild(t)}))},prepend:function(){return At(this,arguments,(function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=Dt(this,t);e.insertBefore(t,e.firstChild)}}))},before:function(){return At(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this)}))},after:function(){return At(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)}))},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(b.cleanData(_t(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map((function(){return b.clone(this,t,e)}))},html:function(t){return z(this,(function(t){var e=this[0]||{},i=0,n=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!Nt.test(t)&&!mt[(ft.exec(t)||["",""])[1].toLowerCase()]){t=b.htmlPrefilter(t);try{for(;i<n;i++)1===(e=this[i]||{}).nodeType&&(b.cleanData(_t(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)}),null,t,arguments.length)},replaceWith:function(){var t=[];return At(this,arguments,(function(e){var i=this.parentNode;b.inArray(this,t)<0&&(b.cleanData(_t(this)),i&&i.replaceChild(e,this))}),t)}}),b.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(t,e){b.fn[t]=function(t){for(var i,n=[],r=b(t),s=r.length-1,a=0;a<=s;a++)i=a===s?this:this.clone(!0),b(r[a])[e](i),o.apply(n,i.get());return this.pushStack(n)}}));var Pt=new RegExp("^("+tt+")(?!px)[a-z%]+$","i"),Lt=function(e){var i=e.ownerDocument.defaultView;return i&&i.opener||(i=t),i.getComputedStyle(e)},Ut=function(t,e,i){var n,r,s={};for(r in e)s[r]=t.style[r],t.style[r]=e[r];for(r in n=i.call(t),e)t.style[r]=s[r];return n},kt=new RegExp(it.join("|"),"i");function Xt(t,e,i){var n,r,s,o,a=t.style;return(i=i||Lt(t))&&(""!==(o=i.getPropertyValue(e)||i[e])||rt(t)||(o=b.style(t,e)),!p.pixelBoxStyles()&&Pt.test(o)&&kt.test(e)&&(n=a.width,r=a.minWidth,s=a.maxWidth,a.minWidth=a.maxWidth=a.width=o,o=i.width,a.width=n,a.minWidth=r,a.maxWidth=s)),void 0!==o?o+"":o}function zt(t,e){return{get:function(){if(!t())return(this.get=e).apply(this,arguments);delete this.get}}}!function(){function e(){if(c){l.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",c.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",nt.appendChild(l).appendChild(c);var e=t.getComputedStyle(c);n="1%"!==e.top,u=12===i(e.marginLeft),c.style.right="60%",o=36===i(e.right),r=36===i(e.width),c.style.position="absolute",s=12===i(c.offsetWidth/3),nt.removeChild(l),c=null}}function i(t){return Math.round(parseFloat(t))}var n,r,s,o,a,u,l=m.createElement("div"),c=m.createElement("div");c.style&&(c.style.backgroundClip="content-box",c.cloneNode(!0).style.backgroundClip="",p.clearCloneStyle="content-box"===c.style.backgroundClip,b.extend(p,{boxSizingReliable:function(){return e(),r},pixelBoxStyles:function(){return e(),o},pixelPosition:function(){return e(),n},reliableMarginLeft:function(){return e(),u},scrollboxSize:function(){return e(),s},reliableTrDimensions:function(){var e,i,n,r;return null==a&&(e=m.createElement("table"),i=m.createElement("tr"),n=m.createElement("div"),e.style.cssText="position:absolute;left:-11111px;border-collapse:separate",i.style.cssText="border:1px solid",i.style.height="1px",n.style.height="9px",n.style.display="block",nt.appendChild(e).appendChild(i).appendChild(n),r=t.getComputedStyle(i),a=parseInt(r.height,10)+parseInt(r.borderTopWidth,10)+parseInt(r.borderBottomWidth,10)===i.offsetHeight,nt.removeChild(e)),a}}))}();var jt=["Webkit","Moz","ms"],Gt=m.createElement("div").style,qt={};function Ht(t){var e=b.cssProps[t]||qt[t];return e||(t in Gt?t:qt[t]=function(t){for(var e=t[0].toUpperCase()+t.slice(1),i=jt.length;i--;)if((t=jt[i]+e)in Gt)return t}(t)||t)}var Wt=/^(none|table(?!-c[ea]).+)/,Yt=/^--/,Zt={position:"absolute",visibility:"hidden",display:"block"},Kt={letterSpacing:"0",fontWeight:"400"};function Qt(t,e,i){var n=et.exec(e);return n?Math.max(0,n[2]-(i||0))+(n[3]||"px"):e}function $t(t,e,i,n,r,s){var o="width"===e?1:0,a=0,u=0;if(i===(n?"border":"content"))return 0;for(;o<4;o+=2)"margin"===i&&(u+=b.css(t,i+it[o],!0,r)),n?("content"===i&&(u-=b.css(t,"padding"+it[o],!0,r)),"margin"!==i&&(u-=b.css(t,"border"+it[o]+"Width",!0,r))):(u+=b.css(t,"padding"+it[o],!0,r),"padding"!==i?u+=b.css(t,"border"+it[o]+"Width",!0,r):a+=b.css(t,"border"+it[o]+"Width",!0,r));return!n&&s>=0&&(u+=Math.max(0,Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-s-u-a-.5))||0),u}function Jt(t,e,i){var n=Lt(t),r=(!p.boxSizingReliable()||i)&&"border-box"===b.css(t,"boxSizing",!1,n),s=r,o=Xt(t,e,n),a="offset"+e[0].toUpperCase()+e.slice(1);if(Pt.test(o)){if(!i)return o;o="auto"}return(!p.boxSizingReliable()&&r||!p.reliableTrDimensions()&&N(t,"tr")||"auto"===o||!parseFloat(o)&&"inline"===b.css(t,"display",!1,n))&&t.getClientRects().length&&(r="border-box"===b.css(t,"boxSizing",!1,n),(s=a in t)&&(o=t[a])),(o=parseFloat(o)||0)+$t(t,e,i||(r?"border":"content"),s,n,o)+"px"}function te(t,e,i,n,r){return new te.prototype.init(t,e,i,n,r)}b.extend({cssHooks:{opacity:{get:function(t,e){if(e){var i=Xt(t,"opacity");return""===i?"1":i}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(t,e,i,n){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var r,s,o,a=H(e),u=Yt.test(e),l=t.style;if(u||(e=Ht(a)),o=b.cssHooks[e]||b.cssHooks[a],void 0===i)return o&&"get"in o&&void 0!==(r=o.get(t,!1,n))?r:l[e];"string"===(s=typeof i)&&(r=et.exec(i))&&r[1]&&(i=at(t,e,r),s="number"),null!=i&&i==i&&("number"!==s||u||(i+=r&&r[3]||(b.cssNumber[a]?"":"px")),p.clearCloneStyle||""!==i||0!==e.indexOf("background")||(l[e]="inherit"),o&&"set"in o&&void 0===(i=o.set(t,i,n))||(u?l.setProperty(e,i):l[e]=i))}},css:function(t,e,i,n){var r,s,o,a=H(e);return Yt.test(e)||(e=Ht(a)),(o=b.cssHooks[e]||b.cssHooks[a])&&"get"in o&&(r=o.get(t,!0,i)),void 0===r&&(r=Xt(t,e,n)),"normal"===r&&e in Kt&&(r=Kt[e]),""===i||i?(s=parseFloat(r),!0===i||isFinite(s)?s||0:r):r}}),b.each(["height","width"],(function(t,e){b.cssHooks[e]={get:function(t,i,n){if(i)return!Wt.test(b.css(t,"display"))||t.getClientRects().length&&t.getBoundingClientRect().width?Jt(t,e,n):Ut(t,Zt,(function(){return Jt(t,e,n)}))},set:function(t,i,n){var r,s=Lt(t),o=!p.scrollboxSize()&&"absolute"===s.position,a=(o||n)&&"border-box"===b.css(t,"boxSizing",!1,s),u=n?$t(t,e,n,a,s):0;return a&&o&&(u-=Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-parseFloat(s[e])-$t(t,e,"border",!1,s)-.5)),u&&(r=et.exec(i))&&"px"!==(r[3]||"px")&&(t.style[e]=i,i=b.css(t,e)),Qt(0,i,u)}}})),b.cssHooks.marginLeft=zt(p.reliableMarginLeft,(function(t,e){if(e)return(parseFloat(Xt(t,"marginLeft"))||t.getBoundingClientRect().left-Ut(t,{marginLeft:0},(function(){return t.getBoundingClientRect().left})))+"px"})),b.each({margin:"",padding:"",border:"Width"},(function(t,e){b.cssHooks[t+e]={expand:function(i){for(var n=0,r={},s="string"==typeof i?i.split(" "):[i];n<4;n++)r[t+it[n]+e]=s[n]||s[n-2]||s[0];return r}},"margin"!==t&&(b.cssHooks[t+e].set=Qt)})),b.fn.extend({css:function(t,e){return z(this,(function(t,e,i){var n,r,s={},o=0;if(Array.isArray(e)){for(n=Lt(t),r=e.length;o<r;o++)s[e[o]]=b.css(t,e[o],!1,n);return s}return void 0!==i?b.style(t,e,i):b.css(t,e)}),t,e,arguments.length>1)}}),b.Tween=te,te.prototype={constructor:te,init:function(t,e,i,n,r,s){this.elem=t,this.prop=i,this.easing=r||b.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=n,this.unit=s||(b.cssNumber[i]?"":"px")},cur:function(){var t=te.propHooks[this.prop];return t&&t.get?t.get(this):te.propHooks._default.get(this)},run:function(t){var e,i=te.propHooks[this.prop];return this.options.duration?this.pos=e=b.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):te.propHooks._default.set(this),this}},te.prototype.init.prototype=te.prototype,te.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=b.css(t.elem,t.prop,""))&&"auto"!==e?e:0},set:function(t){b.fx.step[t.prop]?b.fx.step[t.prop](t):1!==t.elem.nodeType||!b.cssHooks[t.prop]&&null==t.elem.style[Ht(t.prop)]?t.elem[t.prop]=t.now:b.style(t.elem,t.prop,t.now+t.unit)}}},te.propHooks.scrollTop=te.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},b.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},b.fx=te.prototype.init,b.fx.step={};var ee,ie,ne=/^(?:toggle|show|hide)$/,re=/queueHooks$/;function se(){ie&&(!1===m.hidden&&t.requestAnimationFrame?t.requestAnimationFrame(se):t.setTimeout(se,b.fx.interval),b.fx.tick())}function oe(){return t.setTimeout((function(){ee=void 0})),ee=Date.now()}function ae(t,e){var i,n=0,r={height:t};for(e=e?1:0;n<4;n+=2-e)r["margin"+(i=it[n])]=r["padding"+i]=t;return e&&(r.opacity=r.width=t),r}function ue(t,e,i){for(var n,r=(le.tweeners[e]||[]).concat(le.tweeners["*"]),s=0,o=r.length;s<o;s++)if(n=r[s].call(i,e,t))return n}function le(t,e,i){var n,r,s=0,o=le.prefilters.length,a=b.Deferred().always((function(){delete u.elem})),u=function(){if(r)return!1;for(var e=ee||oe(),i=Math.max(0,l.startTime+l.duration-e),n=1-(i/l.duration||0),s=0,o=l.tweens.length;s<o;s++)l.tweens[s].run(n);return a.notifyWith(t,[l,n,i]),n<1&&o?i:(o||a.notifyWith(t,[l,1,0]),a.resolveWith(t,[l]),!1)},l=a.promise({elem:t,props:b.extend({},e),opts:b.extend(!0,{specialEasing:{},easing:b.easing._default},i),originalProperties:e,originalOptions:i,startTime:ee||oe(),duration:i.duration,tweens:[],createTween:function(e,i){var n=b.Tween(t,l.opts,e,i,l.opts.specialEasing[e]||l.opts.easing);return l.tweens.push(n),n},stop:function(e){var i=0,n=e?l.tweens.length:0;if(r)return this;for(r=!0;i<n;i++)l.tweens[i].run(1);return e?(a.notifyWith(t,[l,1,0]),a.resolveWith(t,[l,e])):a.rejectWith(t,[l,e]),this}}),c=l.props;for(!function(t,e){var i,n,r,s,o;for(i in t)if(r=e[n=H(i)],s=t[i],Array.isArray(s)&&(r=s[1],s=t[i]=s[0]),i!==n&&(t[n]=s,delete t[i]),(o=b.cssHooks[n])&&"expand"in o)for(i in s=o.expand(s),delete t[n],s)i in t||(t[i]=s[i],e[i]=r);else e[n]=r}(c,l.opts.specialEasing);s<o;s++)if(n=le.prefilters[s].call(l,t,c,l.opts))return f(n.stop)&&(b._queueHooks(l.elem,l.opts.queue).stop=n.stop.bind(n)),n;return b.map(c,ue,l),f(l.opts.start)&&l.opts.start.call(t,l),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always),b.fx.timer(b.extend(u,{elem:t,anim:l,queue:l.opts.queue})),l}b.Animation=b.extend(le,{tweeners:{"*":[function(t,e){var i=this.createTween(t,e);return at(i.elem,t,et.exec(e),i),i}]},tweener:function(t,e){f(t)?(e=t,t=["*"]):t=t.match(A);for(var i,n=0,r=t.length;n<r;n++)i=t[n],le.tweeners[i]=le.tweeners[i]||[],le.tweeners[i].unshift(e)},prefilters:[function(t,e,i){var n,r,s,o,a,u,l,c,h="width"in e||"height"in e,d=this,p={},f=t.style,g=t.nodeType&&ot(t),m=Z.get(t,"fxshow");for(n in i.queue||(null==(o=b._queueHooks(t,"fx")).unqueued&&(o.unqueued=0,a=o.empty.fire,o.empty.fire=function(){o.unqueued||a()}),o.unqueued++,d.always((function(){d.always((function(){o.unqueued--,b.queue(t,"fx").length||o.empty.fire()}))}))),e)if(r=e[n],ne.test(r)){if(delete e[n],s=s||"toggle"===r,r===(g?"hide":"show")){if("show"!==r||!m||void 0===m[n])continue;g=!0}p[n]=m&&m[n]||b.style(t,n)}if((u=!b.isEmptyObject(e))||!b.isEmptyObject(p))for(n in h&&1===t.nodeType&&(i.overflow=[f.overflow,f.overflowX,f.overflowY],null==(l=m&&m.display)&&(l=Z.get(t,"display")),"none"===(c=b.css(t,"display"))&&(l?c=l:(ct([t],!0),l=t.style.display||l,c=b.css(t,"display"),ct([t]))),("inline"===c||"inline-block"===c&&null!=l)&&"none"===b.css(t,"float")&&(u||(d.done((function(){f.display=l})),null==l&&(c=f.display,l="none"===c?"":c)),f.display="inline-block")),i.overflow&&(f.overflow="hidden",d.always((function(){f.overflow=i.overflow[0],f.overflowX=i.overflow[1],f.overflowY=i.overflow[2]}))),u=!1,p)u||(m?"hidden"in m&&(g=m.hidden):m=Z.access(t,"fxshow",{display:l}),s&&(m.hidden=!g),g&&ct([t],!0),d.done((function(){for(n in g||ct([t]),Z.remove(t,"fxshow"),p)b.style(t,n,p[n])}))),u=ue(g?m[n]:0,n,d),n in m||(m[n]=u.start,g&&(u.end=u.start,u.start=0))}],prefilter:function(t,e){e?le.prefilters.unshift(t):le.prefilters.push(t)}}),b.speed=function(t,e,i){var n=t&&"object"==typeof t?b.extend({},t):{complete:i||!i&&e||f(t)&&t,duration:t,easing:i&&e||e&&!f(e)&&e};return b.fx.off?n.duration=0:"number"!=typeof n.duration&&(n.duration in b.fx.speeds?n.duration=b.fx.speeds[n.duration]:n.duration=b.fx.speeds._default),null!=n.queue&&!0!==n.queue||(n.queue="fx"),n.old=n.complete,n.complete=function(){f(n.old)&&n.old.call(this),n.queue&&b.dequeue(this,n.queue)},n},b.fn.extend({fadeTo:function(t,e,i,n){return this.filter(ot).css("opacity",0).show().end().animate({opacity:e},t,i,n)},animate:function(t,e,i,n){var r=b.isEmptyObject(t),s=b.speed(e,i,n),o=function(){var e=le(this,b.extend({},t),s);(r||Z.get(this,"finish"))&&e.stop(!0)};return o.finish=o,r||!1===s.queue?this.each(o):this.queue(s.queue,o)},stop:function(t,e,i){var n=function(t){var e=t.stop;delete t.stop,e(i)};return"string"!=typeof t&&(i=e,e=t,t=void 0),e&&this.queue(t||"fx",[]),this.each((function(){var e=!0,r=null!=t&&t+"queueHooks",s=b.timers,o=Z.get(this);if(r)o[r]&&o[r].stop&&n(o[r]);else for(r in o)o[r]&&o[r].stop&&re.test(r)&&n(o[r]);for(r=s.length;r--;)s[r].elem!==this||null!=t&&s[r].queue!==t||(s[r].anim.stop(i),e=!1,s.splice(r,1));!e&&i||b.dequeue(this,t)}))},finish:function(t){return!1!==t&&(t=t||"fx"),this.each((function(){var e,i=Z.get(this),n=i[t+"queue"],r=i[t+"queueHooks"],s=b.timers,o=n?n.length:0;for(i.finish=!0,b.queue(this,t,[]),r&&r.stop&&r.stop.call(this,!0),e=s.length;e--;)s[e].elem===this&&s[e].queue===t&&(s[e].anim.stop(!0),s.splice(e,1));for(e=0;e<o;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete i.finish}))}}),b.each(["toggle","show","hide"],(function(t,e){var i=b.fn[e];b.fn[e]=function(t,n,r){return null==t||"boolean"==typeof t?i.apply(this,arguments):this.animate(ae(e,!0),t,n,r)}})),b.each({slideDown:ae("show"),slideUp:ae("hide"),slideToggle:ae("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(t,e){b.fn[t]=function(t,i,n){return this.animate(e,t,i,n)}})),b.timers=[],b.fx.tick=function(){var t,e=0,i=b.timers;for(ee=Date.now();e<i.length;e++)(t=i[e])()||i[e]!==t||i.splice(e--,1);i.length||b.fx.stop(),ee=void 0},b.fx.timer=function(t){b.timers.push(t),b.fx.start()},b.fx.interval=13,b.fx.start=function(){ie||(ie=!0,se())},b.fx.stop=function(){ie=null},b.fx.speeds={slow:600,fast:200,_default:400},b.fn.delay=function(e,i){return e=b.fx&&b.fx.speeds[e]||e,i=i||"fx",this.queue(i,(function(i,n){var r=t.setTimeout(i,e);n.stop=function(){t.clearTimeout(r)}}))},function(){var t=m.createElement("input"),e=m.createElement("select").appendChild(m.createElement("option"));t.type="checkbox",p.checkOn=""!==t.value,p.optSelected=e.selected,(t=m.createElement("input")).value="t",t.type="radio",p.radioValue="t"===t.value}();var ce,he=b.expr.attrHandle;b.fn.extend({attr:function(t,e){return z(this,b.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each((function(){b.removeAttr(this,t)}))}}),b.extend({attr:function(t,e,i){var n,r,s=t.nodeType;if(3!==s&&8!==s&&2!==s)return void 0===t.getAttribute?b.prop(t,e,i):(1===s&&b.isXMLDoc(t)||(r=b.attrHooks[e.toLowerCase()]||(b.expr.match.bool.test(e)?ce:void 0)),void 0!==i?null===i?void b.removeAttr(t,e):r&&"set"in r&&void 0!==(n=r.set(t,i,e))?n:(t.setAttribute(e,i+""),i):r&&"get"in r&&null!==(n=r.get(t,e))?n:null==(n=b.find.attr(t,e))?void 0:n)},attrHooks:{type:{set:function(t,e){if(!p.radioValue&&"radio"===e&&N(t,"input")){var i=t.value;return t.setAttribute("type",e),i&&(t.value=i),e}}}},removeAttr:function(t,e){var i,n=0,r=e&&e.match(A);if(r&&1===t.nodeType)for(;i=r[n++];)t.removeAttribute(i)}}),ce={set:function(t,e,i){return!1===e?b.removeAttr(t,i):t.setAttribute(i,i),i}},b.each(b.expr.match.bool.source.match(/\w+/g),(function(t,e){var i=he[e]||b.find.attr;he[e]=function(t,e,n){var r,s,o=e.toLowerCase();return n||(s=he[o],he[o]=r,r=null!=i(t,e,n)?o:null,he[o]=s),r}}));var de=/^(?:input|select|textarea|button)$/i,pe=/^(?:a|area)$/i;function fe(t){return(t.match(A)||[]).join(" ")}function ge(t){return t.getAttribute&&t.getAttribute("class")||""}function me(t){return Array.isArray(t)?t:"string"==typeof t&&t.match(A)||[]}b.fn.extend({prop:function(t,e){return z(this,b.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each((function(){delete this[b.propFix[t]||t]}))}}),b.extend({prop:function(t,e,i){var n,r,s=t.nodeType;if(3!==s&&8!==s&&2!==s)return 1===s&&b.isXMLDoc(t)||(e=b.propFix[e]||e,r=b.propHooks[e]),void 0!==i?r&&"set"in r&&void 0!==(n=r.set(t,i,e))?n:t[e]=i:r&&"get"in r&&null!==(n=r.get(t,e))?n:t[e]},propHooks:{tabIndex:{get:function(t){var e=b.find.attr(t,"tabindex");return e?parseInt(e,10):de.test(t.nodeName)||pe.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),p.optSelected||(b.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set:function(t){var e=t.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}}),b.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){b.propFix[this.toLowerCase()]=this})),b.fn.extend({addClass:function(t){var e,i,n,r,s,o,a,u=0;if(f(t))return this.each((function(e){b(this).addClass(t.call(this,e,ge(this)))}));if((e=me(t)).length)for(;i=this[u++];)if(r=ge(i),n=1===i.nodeType&&" "+fe(r)+" "){for(o=0;s=e[o++];)n.indexOf(" "+s+" ")<0&&(n+=s+" ");r!==(a=fe(n))&&i.setAttribute("class",a)}return this},removeClass:function(t){var e,i,n,r,s,o,a,u=0;if(f(t))return this.each((function(e){b(this).removeClass(t.call(this,e,ge(this)))}));if(!arguments.length)return this.attr("class","");if((e=me(t)).length)for(;i=this[u++];)if(r=ge(i),n=1===i.nodeType&&" "+fe(r)+" "){for(o=0;s=e[o++];)for(;n.indexOf(" "+s+" ")>-1;)n=n.replace(" "+s+" "," ");r!==(a=fe(n))&&i.setAttribute("class",a)}return this},toggleClass:function(t,e){var i=typeof t,n="string"===i||Array.isArray(t);return"boolean"==typeof e&&n?e?this.addClass(t):this.removeClass(t):f(t)?this.each((function(i){b(this).toggleClass(t.call(this,i,ge(this),e),e)})):this.each((function(){var e,r,s,o;if(n)for(r=0,s=b(this),o=me(t);e=o[r++];)s.hasClass(e)?s.removeClass(e):s.addClass(e);else void 0!==t&&"boolean"!==i||((e=ge(this))&&Z.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",e||!1===t?"":Z.get(this,"__className__")||""))}))},hasClass:function(t){var e,i,n=0;for(e=" "+t+" ";i=this[n++];)if(1===i.nodeType&&(" "+fe(ge(i))+" ").indexOf(e)>-1)return!0;return!1}});var _e=/\r/g;b.fn.extend({val:function(t){var e,i,n,r=this[0];return arguments.length?(n=f(t),this.each((function(i){var r;1===this.nodeType&&(null==(r=n?t.call(this,i,b(this).val()):t)?r="":"number"==typeof r?r+="":Array.isArray(r)&&(r=b.map(r,(function(t){return null==t?"":t+""}))),(e=b.valHooks[this.type]||b.valHooks[this.nodeName.toLowerCase()])&&"set"in e&&void 0!==e.set(this,r,"value")||(this.value=r))}))):r?(e=b.valHooks[r.type]||b.valHooks[r.nodeName.toLowerCase()])&&"get"in e&&void 0!==(i=e.get(r,"value"))?i:"string"==typeof(i=r.value)?i.replace(_e,""):null==i?"":i:void 0}}),b.extend({valHooks:{option:{get:function(t){var e=b.find.attr(t,"value");return null!=e?e:fe(b.text(t))}},select:{get:function(t){var e,i,n,r=t.options,s=t.selectedIndex,o="select-one"===t.type,a=o?null:[],u=o?s+1:r.length;for(n=s<0?u:o?s:0;n<u;n++)if(((i=r[n]).selected||n===s)&&!i.disabled&&(!i.parentNode.disabled||!N(i.parentNode,"optgroup"))){if(e=b(i).val(),o)return e;a.push(e)}return a},set:function(t,e){for(var i,n,r=t.options,s=b.makeArray(e),o=r.length;o--;)((n=r[o]).selected=b.inArray(b.valHooks.option.get(n),s)>-1)&&(i=!0);return i||(t.selectedIndex=-1),s}}}}),b.each(["radio","checkbox"],(function(){b.valHooks[this]={set:function(t,e){if(Array.isArray(e))return t.checked=b.inArray(b(t).val(),e)>-1}},p.checkOn||(b.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})})),p.focusin="onfocusin"in t;var ye=/^(?:focusinfocus|focusoutblur)$/,xe=function(t){t.stopPropagation()};b.extend(b.event,{trigger:function(e,i,n,r){var s,o,a,u,l,h,d,p,_=[n||m],y=c.call(e,"type")?e.type:e,x=c.call(e,"namespace")?e.namespace.split("."):[];if(o=p=a=n=n||m,3!==n.nodeType&&8!==n.nodeType&&!ye.test(y+b.event.triggered)&&(y.indexOf(".")>-1&&(x=y.split("."),y=x.shift(),x.sort()),l=y.indexOf(":")<0&&"on"+y,(e=e[b.expando]?e:new b.Event(y,"object"==typeof e&&e)).isTrigger=r?2:3,e.namespace=x.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+x.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),i=null==i?[e]:b.makeArray(i,[e]),d=b.event.special[y]||{},r||!d.trigger||!1!==d.trigger.apply(n,i))){if(!r&&!d.noBubble&&!g(n)){for(u=d.delegateType||y,ye.test(u+y)||(o=o.parentNode);o;o=o.parentNode)_.push(o),a=o;a===(n.ownerDocument||m)&&_.push(a.defaultView||a.parentWindow||t)}for(s=0;(o=_[s++])&&!e.isPropagationStopped();)p=o,e.type=s>1?u:d.bindType||y,(h=(Z.get(o,"events")||Object.create(null))[e.type]&&Z.get(o,"handle"))&&h.apply(o,i),(h=l&&o[l])&&h.apply&&W(o)&&(e.result=h.apply(o,i),!1===e.result&&e.preventDefault());return e.type=y,r||e.isDefaultPrevented()||d._default&&!1!==d._default.apply(_.pop(),i)||!W(n)||l&&f(n[y])&&!g(n)&&((a=n[l])&&(n[l]=null),b.event.triggered=y,e.isPropagationStopped()&&p.addEventListener(y,xe),n[y](),e.isPropagationStopped()&&p.removeEventListener(y,xe),b.event.triggered=void 0,a&&(n[l]=a)),e.result}},simulate:function(t,e,i){var n=b.extend(new b.Event,i,{type:t,isSimulated:!0});b.event.trigger(n,null,e)}}),b.fn.extend({trigger:function(t,e){return this.each((function(){b.event.trigger(t,e,this)}))},triggerHandler:function(t,e){var i=this[0];if(i)return b.event.trigger(t,e,i,!0)}}),p.focusin||b.each({focus:"focusin",blur:"focusout"},(function(t,e){var i=function(t){b.event.simulate(e,t.target,b.event.fix(t))};b.event.special[e]={setup:function(){var n=this.ownerDocument||this.document||this,r=Z.access(n,e);r||n.addEventListener(t,i,!0),Z.access(n,e,(r||0)+1)},teardown:function(){var n=this.ownerDocument||this.document||this,r=Z.access(n,e)-1;r?Z.access(n,e,r):(n.removeEventListener(t,i,!0),Z.remove(n,e))}}}));var we=t.location,be={guid:Date.now()},ve=/\?/;b.parseXML=function(e){var i,n;if(!e||"string"!=typeof e)return null;try{i=(new t.DOMParser).parseFromString(e,"text/xml")}catch(t){}return n=i&&i.getElementsByTagName("parsererror")[0],i&&!n||b.error("Invalid XML: "+(n?b.map(n.childNodes,(function(t){return t.textContent})).join("\n"):e)),i};var Se=/\[\]$/,Te=/\r?\n/g,Ce=/^(?:submit|button|image|reset|file)$/i,Oe=/^(?:input|select|textarea|keygen)/i;function Ne(t,e,i,n){var r;if(Array.isArray(e))b.each(e,(function(e,r){i||Se.test(t)?n(t,r):Ne(t+"["+("object"==typeof r&&null!=r?e:"")+"]",r,i,n)}));else if(i||"object"!==x(e))n(t,e);else for(r in e)Ne(t+"["+r+"]",e[r],i,n)}b.param=function(t,e){var i,n=[],r=function(t,e){var i=f(e)?e():e;n[n.length]=encodeURIComponent(t)+"="+encodeURIComponent(null==i?"":i)};if(null==t)return"";if(Array.isArray(t)||t.jquery&&!b.isPlainObject(t))b.each(t,(function(){r(this.name,this.value)}));else for(i in t)Ne(i,t[i],e,r);return n.join("&")},b.fn.extend({serialize:function(){return b.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var t=b.prop(this,"elements");return t?b.makeArray(t):this})).filter((function(){var t=this.type;return this.name&&!b(this).is(":disabled")&&Oe.test(this.nodeName)&&!Ce.test(t)&&(this.checked||!pt.test(t))})).map((function(t,e){var i=b(this).val();return null==i?null:Array.isArray(i)?b.map(i,(function(t){return{name:e.name,value:t.replace(Te,"\r\n")}})):{name:e.name,value:i.replace(Te,"\r\n")}})).get()}});var Fe=/%20/g,Ee=/#.*$/,De=/([?&])_=[^&]*/,Me=/^(.*?):[ \t]*([^\r\n]*)$/gm,Ie=/^(?:GET|HEAD)$/,Ve=/^\/\//,Be={},Ae={},Re="*/".concat("*"),Pe=m.createElement("a");function Le(t){return function(e,i){"string"!=typeof e&&(i=e,e="*");var n,r=0,s=e.toLowerCase().match(A)||[];if(f(i))for(;n=s[r++];)"+"===n[0]?(n=n.slice(1)||"*",(t[n]=t[n]||[]).unshift(i)):(t[n]=t[n]||[]).push(i)}}function Ue(t,e,i,n){var r={},s=t===Ae;function o(a){var u;return r[a]=!0,b.each(t[a]||[],(function(t,a){var l=a(e,i,n);return"string"!=typeof l||s||r[l]?s?!(u=l):void 0:(e.dataTypes.unshift(l),o(l),!1)})),u}return o(e.dataTypes[0])||!r["*"]&&o("*")}function ke(t,e){var i,n,r=b.ajaxSettings.flatOptions||{};for(i in e)void 0!==e[i]&&((r[i]?t:n||(n={}))[i]=e[i]);return n&&b.extend(!0,t,n),t}Pe.href=we.href,b.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:we.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(we.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Re,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":b.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?ke(ke(t,b.ajaxSettings),e):ke(b.ajaxSettings,t)},ajaxPrefilter:Le(Be),ajaxTransport:Le(Ae),ajax:function(e,i){"object"==typeof e&&(i=e,e=void 0),i=i||{};var n,r,s,o,a,u,l,c,h,d,p=b.ajaxSetup({},i),f=p.context||p,g=p.context&&(f.nodeType||f.jquery)?b(f):b.event,_=b.Deferred(),y=b.Callbacks("once memory"),x=p.statusCode||{},w={},v={},S="canceled",T={readyState:0,getResponseHeader:function(t){var e;if(l){if(!o)for(o={};e=Me.exec(s);)o[e[1].toLowerCase()+" "]=(o[e[1].toLowerCase()+" "]||[]).concat(e[2]);e=o[t.toLowerCase()+" "]}return null==e?null:e.join(", ")},getAllResponseHeaders:function(){return l?s:null},setRequestHeader:function(t,e){return null==l&&(t=v[t.toLowerCase()]=v[t.toLowerCase()]||t,w[t]=e),this},overrideMimeType:function(t){return null==l&&(p.mimeType=t),this},statusCode:function(t){var e;if(t)if(l)T.always(t[T.status]);else for(e in t)x[e]=[x[e],t[e]];return this},abort:function(t){var e=t||S;return n&&n.abort(e),C(0,e),this}};if(_.promise(T),p.url=((e||p.url||we.href)+"").replace(Ve,we.protocol+"//"),p.type=i.method||i.type||p.method||p.type,p.dataTypes=(p.dataType||"*").toLowerCase().match(A)||[""],null==p.crossDomain){u=m.createElement("a");try{u.href=p.url,u.href=u.href,p.crossDomain=Pe.protocol+"//"+Pe.host!=u.protocol+"//"+u.host}catch(t){p.crossDomain=!0}}if(p.data&&p.processData&&"string"!=typeof p.data&&(p.data=b.param(p.data,p.traditional)),Ue(Be,p,i,T),l)return T;for(h in(c=b.event&&p.global)&&0==b.active++&&b.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!Ie.test(p.type),r=p.url.replace(Ee,""),p.hasContent?p.data&&p.processData&&0===(p.contentType||"").indexOf("application/x-www-form-urlencoded")&&(p.data=p.data.replace(Fe,"+")):(d=p.url.slice(r.length),p.data&&(p.processData||"string"==typeof p.data)&&(r+=(ve.test(r)?"&":"?")+p.data,delete p.data),!1===p.cache&&(r=r.replace(De,"$1"),d=(ve.test(r)?"&":"?")+"_="+be.guid+++d),p.url=r+d),p.ifModified&&(b.lastModified[r]&&T.setRequestHeader("If-Modified-Since",b.lastModified[r]),b.etag[r]&&T.setRequestHeader("If-None-Match",b.etag[r])),(p.data&&p.hasContent&&!1!==p.contentType||i.contentType)&&T.setRequestHeader("Content-Type",p.contentType),T.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+Re+"; q=0.01":""):p.accepts["*"]),p.headers)T.setRequestHeader(h,p.headers[h]);if(p.beforeSend&&(!1===p.beforeSend.call(f,T,p)||l))return T.abort();if(S="abort",y.add(p.complete),T.done(p.success),T.fail(p.error),n=Ue(Ae,p,i,T)){if(T.readyState=1,c&&g.trigger("ajaxSend",[T,p]),l)return T;p.async&&p.timeout>0&&(a=t.setTimeout((function(){T.abort("timeout")}),p.timeout));try{l=!1,n.send(w,C)}catch(t){if(l)throw t;C(-1,t)}}else C(-1,"No Transport");function C(e,i,o,u){var h,d,m,w,v,S=i;l||(l=!0,a&&t.clearTimeout(a),n=void 0,s=u||"",T.readyState=e>0?4:0,h=e>=200&&e<300||304===e,o&&(w=function(t,e,i){for(var n,r,s,o,a=t.contents,u=t.dataTypes;"*"===u[0];)u.shift(),void 0===n&&(n=t.mimeType||e.getResponseHeader("Content-Type"));if(n)for(r in a)if(a[r]&&a[r].test(n)){u.unshift(r);break}if(u[0]in i)s=u[0];else{for(r in i){if(!u[0]||t.converters[r+" "+u[0]]){s=r;break}o||(o=r)}s=s||o}if(s)return s!==u[0]&&u.unshift(s),i[s]}(p,T,o)),!h&&b.inArray("script",p.dataTypes)>-1&&b.inArray("json",p.dataTypes)<0&&(p.converters["text script"]=function(){}),w=function(t,e,i,n){var r,s,o,a,u,l={},c=t.dataTypes.slice();if(c[1])for(o in t.converters)l[o.toLowerCase()]=t.converters[o];for(s=c.shift();s;)if(t.responseFields[s]&&(i[t.responseFields[s]]=e),!u&&n&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),u=s,s=c.shift())if("*"===s)s=u;else if("*"!==u&&u!==s){if(!(o=l[u+" "+s]||l["* "+s]))for(r in l)if((a=r.split(" "))[1]===s&&(o=l[u+" "+a[0]]||l["* "+a[0]])){!0===o?o=l[r]:!0!==l[r]&&(s=a[0],c.unshift(a[1]));break}if(!0!==o)if(o&&t.throws)e=o(e);else try{e=o(e)}catch(t){return{state:"parsererror",error:o?t:"No conversion from "+u+" to "+s}}}return{state:"success",data:e}}(p,w,T,h),h?(p.ifModified&&((v=T.getResponseHeader("Last-Modified"))&&(b.lastModified[r]=v),(v=T.getResponseHeader("etag"))&&(b.etag[r]=v)),204===e||"HEAD"===p.type?S="nocontent":304===e?S="notmodified":(S=w.state,d=w.data,h=!(m=w.error))):(m=S,!e&&S||(S="error",e<0&&(e=0))),T.status=e,T.statusText=(i||S)+"",h?_.resolveWith(f,[d,S,T]):_.rejectWith(f,[T,S,m]),T.statusCode(x),x=void 0,c&&g.trigger(h?"ajaxSuccess":"ajaxError",[T,p,h?d:m]),y.fireWith(f,[T,S]),c&&(g.trigger("ajaxComplete",[T,p]),--b.active||b.event.trigger("ajaxStop")))}return T},getJSON:function(t,e,i){return b.get(t,e,i,"json")},getScript:function(t,e){return b.get(t,void 0,e,"script")}}),b.each(["get","post"],(function(t,e){b[e]=function(t,i,n,r){return f(i)&&(r=r||n,n=i,i=void 0),b.ajax(b.extend({url:t,type:e,dataType:r,data:i,success:n},b.isPlainObject(t)&&t))}})),b.ajaxPrefilter((function(t){var e;for(e in t.headers)"content-type"===e.toLowerCase()&&(t.contentType=t.headers[e]||"")})),b._evalUrl=function(t,e,i){return b.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(t){b.globalEval(t,e,i)}})},b.fn.extend({wrapAll:function(t){var e;return this[0]&&(f(t)&&(t=t.call(this[0])),e=b(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map((function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t})).append(this)),this},wrapInner:function(t){return f(t)?this.each((function(e){b(this).wrapInner(t.call(this,e))})):this.each((function(){var e=b(this),i=e.contents();i.length?i.wrapAll(t):e.append(t)}))},wrap:function(t){var e=f(t);return this.each((function(i){b(this).wrapAll(e?t.call(this,i):t)}))},unwrap:function(t){return this.parent(t).not("body").each((function(){b(this).replaceWith(this.childNodes)})),this}}),b.expr.pseudos.hidden=function(t){return!b.expr.pseudos.visible(t)},b.expr.pseudos.visible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},b.ajaxSettings.xhr=function(){try{return new t.XMLHttpRequest}catch(t){}};var Xe={0:200,1223:204},ze=b.ajaxSettings.xhr();p.cors=!!ze&&"withCredentials"in ze,p.ajax=ze=!!ze,b.ajaxTransport((function(e){var i,n;if(p.cors||ze&&!e.crossDomain)return{send:function(r,s){var o,a=e.xhr();if(a.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(o in e.xhrFields)a[o]=e.xhrFields[o];for(o in e.mimeType&&a.overrideMimeType&&a.overrideMimeType(e.mimeType),e.crossDomain||r["X-Requested-With"]||(r["X-Requested-With"]="XMLHttpRequest"),r)a.setRequestHeader(o,r[o]);i=function(t){return function(){i&&(i=n=a.onload=a.onerror=a.onabort=a.ontimeout=a.onreadystatechange=null,"abort"===t?a.abort():"error"===t?"number"!=typeof a.status?s(0,"error"):s(a.status,a.statusText):s(Xe[a.status]||a.status,a.statusText,"text"!==(a.responseType||"text")||"string"!=typeof a.responseText?{binary:a.response}:{text:a.responseText},a.getAllResponseHeaders()))}},a.onload=i(),n=a.onerror=a.ontimeout=i("error"),void 0!==a.onabort?a.onabort=n:a.onreadystatechange=function(){4===a.readyState&&t.setTimeout((function(){i&&n()}))},i=i("abort");try{a.send(e.hasContent&&e.data||null)}catch(t){if(i)throw t}},abort:function(){i&&i()}}})),b.ajaxPrefilter((function(t){t.crossDomain&&(t.contents.script=!1)})),b.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return b.globalEval(t),t}}}),b.ajaxPrefilter("script",(function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")})),b.ajaxTransport("script",(function(t){var e,i;if(t.crossDomain||t.scriptAttrs)return{send:function(n,r){e=b("<script>").attr(t.scriptAttrs||{}).prop({charset:t.scriptCharset,src:t.url}).on("load error",i=function(t){e.remove(),i=null,t&&r("error"===t.type?404:200,t.type)}),m.head.appendChild(e[0])},abort:function(){i&&i()}}}));var je,Ge=[],qe=/(=)\?(?=&|$)|\?\?/;b.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Ge.pop()||b.expando+"_"+be.guid++;return this[t]=!0,t}}),b.ajaxPrefilter("json jsonp",(function(e,i,n){var r,s,o,a=!1!==e.jsonp&&(qe.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&qe.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return r=e.jsonpCallback=f(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(qe,"$1"+r):!1!==e.jsonp&&(e.url+=(ve.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return o||b.error(r+" was not called"),o[0]},e.dataTypes[0]="json",s=t[r],t[r]=function(){o=arguments},n.always((function(){void 0===s?b(t).removeProp(r):t[r]=s,e[r]&&(e.jsonpCallback=i.jsonpCallback,Ge.push(r)),o&&f(s)&&s(o[0]),o=s=void 0})),"script"})),p.createHTMLDocument=((je=m.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===je.childNodes.length),b.parseHTML=function(t,e,i){return"string"!=typeof t?[]:("boolean"==typeof e&&(i=e,e=!1),e||(p.createHTMLDocument?((n=(e=m.implementation.createHTMLDocument("")).createElement("base")).href=m.location.href,e.head.appendChild(n)):e=m),s=!i&&[],(r=F.exec(t))?[e.createElement(r[1])]:(r=wt([t],e,s),s&&s.length&&b(s).remove(),b.merge([],r.childNodes)));var n,r,s},b.fn.load=function(t,e,i){var n,r,s,o=this,a=t.indexOf(" ");return a>-1&&(n=fe(t.slice(a)),t=t.slice(0,a)),f(e)?(i=e,e=void 0):e&&"object"==typeof e&&(r="POST"),o.length>0&&b.ajax({url:t,type:r||"GET",dataType:"html",data:e}).done((function(t){s=arguments,o.html(n?b("<div>").append(b.parseHTML(t)).find(n):t)})).always(i&&function(t,e){o.each((function(){i.apply(this,s||[t.responseText,e,t])}))}),this},b.expr.pseudos.animated=function(t){return b.grep(b.timers,(function(e){return t===e.elem})).length},b.offset={setOffset:function(t,e,i){var n,r,s,o,a,u,l=b.css(t,"position"),c=b(t),h={};"static"===l&&(t.style.position="relative"),a=c.offset(),s=b.css(t,"top"),u=b.css(t,"left"),("absolute"===l||"fixed"===l)&&(s+u).indexOf("auto")>-1?(o=(n=c.position()).top,r=n.left):(o=parseFloat(s)||0,r=parseFloat(u)||0),f(e)&&(e=e.call(t,i,b.extend({},a))),null!=e.top&&(h.top=e.top-a.top+o),null!=e.left&&(h.left=e.left-a.left+r),"using"in e?e.using.call(t,h):c.css(h)}},b.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each((function(e){b.offset.setOffset(this,t,e)}));var e,i,n=this[0];return n?n.getClientRects().length?(e=n.getBoundingClientRect(),i=n.ownerDocument.defaultView,{top:e.top+i.pageYOffset,left:e.left+i.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var t,e,i,n=this[0],r={top:0,left:0};if("fixed"===b.css(n,"position"))e=n.getBoundingClientRect();else{for(e=this.offset(),i=n.ownerDocument,t=n.offsetParent||i.documentElement;t&&(t===i.body||t===i.documentElement)&&"static"===b.css(t,"position");)t=t.parentNode;t&&t!==n&&1===t.nodeType&&((r=b(t).offset()).top+=b.css(t,"borderTopWidth",!0),r.left+=b.css(t,"borderLeftWidth",!0))}return{top:e.top-r.top-b.css(n,"marginTop",!0),left:e.left-r.left-b.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var t=this.offsetParent;t&&"static"===b.css(t,"position");)t=t.offsetParent;return t||nt}))}}),b.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(t,e){var i="pageYOffset"===e;b.fn[t]=function(n){return z(this,(function(t,n,r){var s;if(g(t)?s=t:9===t.nodeType&&(s=t.defaultView),void 0===r)return s?s[e]:t[n];s?s.scrollTo(i?s.pageXOffset:r,i?r:s.pageYOffset):t[n]=r}),t,n,arguments.length)}})),b.each(["top","left"],(function(t,e){b.cssHooks[e]=zt(p.pixelPosition,(function(t,i){if(i)return i=Xt(t,e),Pt.test(i)?b(t).position()[e]+"px":i}))})),b.each({Height:"height",Width:"width"},(function(t,e){b.each({padding:"inner"+t,content:e,"":"outer"+t},(function(i,n){b.fn[n]=function(r,s){var o=arguments.length&&(i||"boolean"!=typeof r),a=i||(!0===r||!0===s?"margin":"border");return z(this,(function(e,i,r){var s;return g(e)?0===n.indexOf("outer")?e["inner"+t]:e.document.documentElement["client"+t]:9===e.nodeType?(s=e.documentElement,Math.max(e.body["scroll"+t],s["scroll"+t],e.body["offset"+t],s["offset"+t],s["client"+t])):void 0===r?b.css(e,i,a):b.style(e,i,r,a)}),e,o?r:void 0,o)}}))})),b.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(t,e){b.fn[e]=function(t){return this.on(e,t)}})),b.fn.extend({bind:function(t,e,i){return this.on(t,null,e,i)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,i,n){return this.on(e,t,i,n)},undelegate:function(t,e,i){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",i)},hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),b.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),(function(t,e){b.fn[e]=function(t,i){return arguments.length>0?this.on(e,null,t,i):this.trigger(e)}}));var He=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;b.proxy=function(t,e){var i,n,s;if("string"==typeof e&&(i=t[e],e=t,t=i),f(t))return n=r.call(arguments,2),s=function(){return t.apply(e||this,n.concat(r.call(arguments)))},s.guid=t.guid=t.guid||b.guid++,s},b.holdReady=function(t){t?b.readyWait++:b.ready(!0)},b.isArray=Array.isArray,b.parseJSON=JSON.parse,b.nodeName=N,b.isFunction=f,b.isWindow=g,b.camelCase=H,b.type=x,b.now=Date.now,b.isNumeric=function(t){var e=b.type(t);return("number"===e||"string"===e)&&!isNaN(t-parseFloat(t))},b.trim=function(t){return null==t?"":(t+"").replace(He,"")},"function"==typeof define&&define.amd&&define("jquery",[],(function(){return b}));var We=t.jQuery,Ye=t.$;return b.noConflict=function(e){return t.$===b&&(t.$=Ye),e&&t.jQuery===b&&(t.jQuery=We),b},void 0===e&&(t.jQuery=t.$=b),b})),define("jquery/dist/jquery",(function(){})),define("x_ite/Base/X3DConstants",[],(function(){"use strict";let t=0,e=0,i=0;return{CONNECTION_ERROR:t++,BROWSER_EVENT:t++,INITIALIZED_EVENT:t++,SHUTDOWN_EVENT:t++,INITIALIZED_ERROR:t++,NOT_STARTED_STATE:e++,IN_PROGRESS_STATE:e++,COMPLETE_STATE:e++,FAILED_STATE:e++,initializeOnly:1,inputOnly:2,outputOnly:4,inputOutput:7,SFBool:i++,SFColor:i++,SFColorRGBA:i++,SFDouble:i++,SFFloat:i++,SFImage:i++,SFInt32:i++,SFMatrix3d:i++,SFMatrix3f:i++,SFMatrix4d:i++,SFMatrix4f:i++,SFNode:i++,SFRotation:i++,SFString:i++,SFTime:i++,SFVec2d:i++,SFVec2f:i++,SFVec3d:i++,SFVec3f:i++,SFVec4d:i++,SFVec4f:i++,VrmlMatrix:i++,MFBool:i++,MFColor:i++,MFColorRGBA:i++,MFDouble:i++,MFFloat:i++,MFImage:i++,MFInt32:i++,MFMatrix3d:i++,MFMatrix3f:i++,MFMatrix4d:i++,MFMatrix4f:i++,MFNode:i++,MFRotation:i++,MFString:i++,MFTime:i++,MFVec2d:i++,MFVec2f:i++,MFVec3d:i++,MFVec3f:i++,MFVec4d:i++,MFVec4f:i++,X3DBaseNode:0}})),define("x_ite/InputOutput/Generator",["x_ite/Base/X3DConstants"],(function(t){"use strict";function e(){this.indent="",this.indentChar="  ",this.precision=6,this.doublePrecision=14,this.removeTrailingZeros=/\.?0*(?=$|[eE])/,this.executionContextStack=[null],this.importedNodesIndex=new Map,this.exportedNodesIndex=new Map,this.nodes=new Set,this.names=new Map,this.namesByNode=new Map,this.importedNames=new Map,this.routeNodes=new Set,this.level=0,this.newName=0,this.containerFields=[],this.units=!0,this.unitCategories=[],this.names.set(null,new Map)}e.prototype={constructor:e,Indent:function(){return this.indent},IncIndent:function(){this.indent+=this.indentChar},DecIndent:function(){this.indent=this.indent.substr(0,this.indent.length-this.indentChar.length)},PadRight:function(t,e){for(let i=0,n=e-t.length;i<n;++i)t+=" ";return t},Precision:function(t){return Math.fround(t).toPrecision(this.precision).replace(this.removeTrailingZeros,"")},DoublePrecision:function(t){return t.toPrecision(this.doublePrecision).replace(this.removeTrailingZeros,"")},PushExecutionContext:function(t){this.executionContextStack.push(t),this.names.has(t)||this.names.set(t,new Map),this.importedNodesIndex.has(t)||this.importedNodesIndex.set(t,new Set),this.exportedNodesIndex.has(t)||this.exportedNodesIndex.set(t,new Set)},PopExecutionContext:function(){this.executionContextStack.pop(),this.ExecutionContext()||(this.importedNodesIndex.clear(),this.exportedNodesIndex.clear())},ExecutionContext:function(){return this.executionContextStack.at(-1)},EnterScope:function(){0===this.level&&(this.newName=0),++this.level},LeaveScope:function(){--this.level,0===this.level&&(this.nodes.clear(),this.namesByNode.clear(),this.importedNames.clear())},ExportedNodes:function(t){const e=this.exportedNodesIndex.get(this.ExecutionContext());t.forEach((function(t){try{e.add(t.getLocalNode())}catch(t){}}))},ImportedNodes:function(t){const e=this.importedNodesIndex.get(this.ExecutionContext());t.forEach((function(t){try{e.add(t.getInlineNode())}catch(t){}}))},AddImportedNode:function(t,e){this.importedNames.set(t,e)},AddRouteNode:function(t){this.routeNodes.add(t)},ExistsRouteNode:function(t){return this.routeNodes.has(t)},IsSharedNode:function(t){return this.ExecutionContext()!==t.getExecutionContext()},AddNode:function(t){this.nodes.add(t),this.AddRouteNode(t)},ExistsNode:function(t){return this.nodes.has(t)},Name:function(){const t=/_\d+$/;return function(e){const i=this.namesByNode.get(e);if(void 0!==i)return i;{const i=this.names.get(this.ExecutionContext());if(0===e.getName().length){if(this.NeedsName(e)){const t=this.UniqueName();return i.set(t,e),this.namesByNode.set(e,t),t}return e.getName()}let n=e.getName();const r=null!==n.match(t);if(n=n.replace(t,""),0===n.length){if(!this.NeedsName(e))return"";n=this.UniqueName()}else{let t=0,e=r?n+"_"+ ++t:n;for(;i.has(e);)e=n+"_"+ ++t;n=e}return i.set(n,e),this.namesByNode.set(e,n),n}}}(),NeedsName:function(t){if(t.getCloneCount()>1)return!0;if(t.hasRoutes())return!0;const e=t.getExecutionContext(),i=this.importedNodesIndex.get(e);if(!i){const i=this.exportedNodesIndex.get(e);return!(!i||!i.has(t))}return!!i.has(t)||void 0},UniqueName:function(){const t=this.names.get(this.ExecutionContext());for(;;){const e="_"+ ++this.newName;if(!t.has(e))return e}},LocalName:function(t){const e=this.importedNames.get(t);if(void 0!==e)return e;if(this.ExistsNode(t))return this.Name(t);throw new Error("Couldn't get local name for node '"+t.getTypeName()+"'.")},PushContainerField:function(t){this.containerFields.push(t)},PopContainerField:function(){this.containerFields.pop()},ContainerField:function(){return this.containerFields.length?this.containerFields[this.containerFields.length-1]:null},AccessType:function(e){switch(e){case t.initializeOnly:return"initializeOnly";case t.inputOnly:return"inputOnly";case t.outputOnly:return"outputOnly";case t.inputOutput:return"inputOutput"}},SetUnits:function(t){this.units=t},GetUnits:function(){return this.units},PushUnitCategory:function(t){this.unitCategories.push(t)},PopUnitCategory:function(){this.unitCategories.pop()},Unit:function(t){return 0==this.unitCategories.length?t:this.unitCategories.at(-1)},ToUnit:function(t,e){if(this.units){const i=this.ExecutionContext();if(i)return i.toUnit(t,e)}return e},XMLEncode:function(t){return t.replace(/&/g,"&amp;").replace(/\\/g,"&#92;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;").replace(/"/g,'\\"')},escapeCDATA:function(t){return t.replace(/\]\]\>/g,"\\]\\]\\>")}};for(const t of Reflect.ownKeys(e.prototype))Object.defineProperty(e.prototype,t,{enumerable:!1});return e.Get=function(t){return t.generator||(t.generator=new e),t.generator},e})),define("standard/Utility/MapUtilities",["require"],(function(t){"use strict";return{assign:function(t,e){return t.clear(),e.forEach((function(e,i){t.set(i,e)})),t},values:function(t,e){let i=0;return e.forEach((function(e){t[i++]=e})),t.length=e.size,t}}})),define("x_ite/Base/X3DObject",["x_ite/InputOutput/Generator","standard/Utility/MapUtilities"],(function(t,e){"use strict";const i=Symbol(),n=Symbol(),r=Symbol();function s(){}s.prototype={constructor:s,[i]:"",[n]:new Map,[r]:[],getId:function(){return s.getId(this)},getTypeName:function(){return"X3DObject"},setName:function(t){this[i]=t},getName:function(){return this[i]},getDisplayName:function(){return this[i]},getInterestId:function(t,e){return s.getId(e)+"."+String(t)},hasInterest:function(t,e){return this[n].has(this.getInterestId(t,e))},addInterest:function(t,e){this[n]===s.prototype[n]&&(this[n]=new Map,this[r]=[]);const i=this.getInterestId(t,e),o=e[t];if(arguments.length>2){const t=Array.prototype.slice.call(arguments,2);t.unshift(e),t.push(this),this[n].set(i,Function.prototype.bind.apply(o,t))}else this[n].set(i,o.bind(e,this))},removeInterest:function(t,e){this[n].delete(this.getInterestId(t,e))},getInterests:function(){return this[n]},processInterests:function(){if(this[n].size)for(const t of e.values(this[r],this[n]))t()},toString:function(e){const i={string:""};return e&&t.Get(i).PushExecutionContext(e),this.toStream(i),i.string},toVRMLString:function(){const t={string:""};return this.toVRMLStream(t),t.string},toXMLString:function(){const t={string:""};return this.toXMLStream(t),t.string},toJSONString:function(){const t={string:""};return this.toVRMLStream(t),t.string},toStream:function(t){t.string="[object "+this.getTypeName()+"]"},dispose:function(){}};for(const t of Reflect.ownKeys(s.prototype))Object.defineProperty(s.prototype,t,{enumerable:!1});return s.getId=function(){const t=new WeakMap;let e=0;return function(i){const n=t.get(i);return void 0!==n?n:(t.set(i,++e),e)}}(),s})),define("x_ite/Base/X3DChildObject",["x_ite/Base/X3DObject"],(function(t){"use strict";const e=Symbol(),i=Symbol(),n=Symbol();function r(){t.call(this)}r.prototype=Object.assign(Object.create(t.prototype),{constructor:r,[e]:0,[i]:!1,[n]:new Set,setModificationTime:function(t){this[e]=t},getModificationTime:function(){return this[e]},setTainted:function(t){this[i]=t},isTainted:function(){return this[i]},addEvent:function(){this.setModificationTime(performance.now());for(const t of this[n])t.addEvent(this)},addEventObject:function(t,e){this.setModificationTime(performance.now());for(const t of this[n])t.addEventObject(this,e)},addParent:function(t){this[n]===r.prototype[n]&&(this[n]=new Set),this[n].add(t)},removeParent:function(t){this[n].delete(t)},getParents:function(){return this[n]},dispose:function(){this[n].clear(),t.prototype.dispose.call(this)}});for(const t of Reflect.ownKeys(r.prototype))Object.defineProperty(r.prototype,t,{enumerable:!1});return r})),define("x_ite/Base/Events",[],(function(){"use strict";const t=Symbol();function e(){this[t]=[]}e.prototype={create:function(e){if(this[t].length){const i=this[t].pop();return i.field=e,i.clear(),i}const i=new Set;return i.field=e,i},copy:function(e){if(this[t].length){const i=this[t].pop();i.field=e.field,i.clear();for(const t of e)i.add(t);return i}const i=new Set(e);return i.field=e.field,i},push:function(e){this[t].push(e)},clear:function(){this[t].length=0}};for(const t of Reflect.ownKeys(e.prototype))Object.defineProperty(e.prototype,t,{enumerable:!1});return new e})),define("x_ite/Base/X3DEventObject",["x_ite/Base/X3DChildObject","x_ite/Base/Events"],(function(t,e){"use strict";const i=Symbol.for("X3DEventObject.browser");function n(e){t.call(this),this[i]=e}n.prototype=Object.assign(Object.create(t.prototype),{constructor:n,getBrowser:function(){return this[i]},getExtendedEventHandling:function(){return!0},addEvent:function(t){t.isTainted()||(t.setTainted(!0),this.addEventObject(t,e.create(t)))},addEventObject:function(t,e){const i=this.getBrowser();i.addBrowserEvent(),i.addTaintedField(t,e),this.isTainted()||(t.isInput()||this.getExtendedEventHandling()&&!t.isOutput())&&this.addNodeEvent()},addNodeEvent:function(){if(this.isTainted())return;const t=this.getBrowser();this.setTainted(!0),t.addTaintedNode(this),t.addBrowserEvent()},processEvents:function(){this.setTainted(!1),this.processInterests()}});for(const t of Reflect.ownKeys(n.prototype))Object.defineProperty(n.prototype,t,{enumerable:!1});return n})),define("x_ite/Base/X3DFieldDefinition",["x_ite/Base/X3DObject"],(function(t){"use strict";function e(t,e,i){this.accessType=t,this.dataType=i.getType(),this.name=e,this.value=i}e.prototype=Object.assign(Object.create(t.prototype),{constructor:e,getTypeName:function(){return"X3DFieldDefinition"}});for(const t of Reflect.ownKeys(e.prototype))Object.defineProperty(e.prototype,t,{enumerable:!1});return e})),define("x_ite/Base/X3DInfoArray",["x_ite/Base/X3DBaseNode"],(function(){"use strict";const t=Symbol(),e=Symbol(),i={get:function(e,i){const n=e[i];if(void 0!==n)return n;if("string"==typeof i){const n=+i;return Number.isInteger(n)?e[t][n]:void 0}},set:function(t,e,i){return void 0!==t[e]&&(t[e]=i,!0)},has:function(e,i){return Number.isInteger(+i)?i<e[t].length:i in e},ownKeys:function(e){return Object.keys(e[t])},getOwnPropertyDescriptor:function(e,i){if("string"!=typeof i)return;const n=+i;if(Number.isInteger(n)&&n<e[t].length){const n=Object.getOwnPropertyDescriptor(e[t],i);return n&&(n.writable=!1),n}}};function n(n){if(this[t]=[],this[e]=new Map,this[Symbol.iterator]=this[t][Symbol.iterator],n)for(const t of n)this.add(t.name,t);return new Proxy(this,i)}n.prototype={constructor:n,equals:function(e){const i=this[t],n=e[t]||e,r=i.length;if(i===n)return!0;if(r!==n.length)return!1;for(let t=0;t<r;++t)if(i[t]!==n[t])return!1;return!0},has:function(t){return this[e].has(t)},get:function(t){return this[e].get(t)},add:function(i,n){this[t].push(n),this[e].set(i,n)},addAlias:function(t,i){this[e].set(t,this[e].get(i))},update:function(i,n,r){const s=this[e].get(i);if(i!==n&&this.remove(n),this[e].delete(i),this[e].set(n,r),void 0!==s){const e=this[t].indexOf(s);e>-1&&(this[t][e]=r)}else this[t].push(r)},remove:function(i){const n=this[e].get(i);if(void 0===n)return;const r=this[t].indexOf(n);this[e].delete(i),r>-1&&this[t].splice(r,1)},at:Array.prototype.at,concat:Array.prototype.concat,every:Array.prototype.every,fill:Array.prototype.fill,filter:Array.prototype.filter,find:Array.prototype.find,findIndex:Array.prototype.findIndex,forEach:Array.prototype.forEach,includes:Array.prototype.includes,indexOf:Array.prototype.indexOf,join:Array.prototype.join,keys:function(){return Array(this.length).keys()},lastIndexOf:Array.prototype.lastIndexOf,map:Array.prototype.map,reduce:Array.prototype.reduce,reduceRight:Array.prototype.reduceRight,slice:Array.prototype.slice,some:Array.prototype.some,values:function(){return this[Symbol.iterator]},toString:function(t){const e={string:""};return t&&Generator.Get(e).PushExecutionContext(t),this.toStream(e),e.string},toVRMLStream:function(e){const i=require("x_ite/Base/X3DBaseNode");for(const n of this[t])try{n.toVRMLStream(e),e.string+="\n",n instanceof i&&(e.string+="\n")}catch(t){console.error(t)}},toXMLStream:function(e){for(const i of this[t])try{i.toXMLStream(e),e.string+="\n"}catch(t){console.error(t)}},toStream:function(t){t.string="[object "+this.getTypeName()+"]"}};for(const t of Reflect.ownKeys(n.prototype))Object.defineProperty(n.prototype,t,{enumerable:!1});return Object.defineProperty(n.prototype,"length",{get:function(){return this[t].length},enumerable:!1,configurable:!1}),n})),define("x_ite/Base/FieldDefinitionArray",["x_ite/Base/X3DInfoArray"],(function(t){"use strict";function e(e){return t.call(this,e)}e.prototype=Object.assign(Object.create(t.prototype),{constructor:e,getTypeName:function(){return"FieldDefinitionArray"}});for(const t of Reflect.ownKeys(e.prototype))Object.defineProperty(e.prototype,t,{enumerable:!1});return e})),define("x_ite/Base/FieldArray",["x_ite/Base/X3DInfoArray"],(function(t){"use strict";function e(){return t.call(this)}e.prototype=Object.assign(Object.create(t.prototype),{constructor:e,getTypeName:function(){return"FieldArray"}});for(const t of Reflect.ownKeys(e.prototype))Object.defineProperty(e.prototype,t,{enumerable:!1});return e})),define("x_ite/Base/X3DField",["jquery","x_ite/Base/X3DChildObject","x_ite/Base/X3DConstants","x_ite/Base/Events","standard/Utility/MapUtilities"],(function(t,e,i,n,r){"use strict";const s=Symbol(),o=Symbol(),a=Symbol(),u=Symbol(),l=Symbol(),c=Symbol(),h=Symbol(),d=Symbol(),p=Symbol(),f=Symbol(),g=Symbol.for("X3DField.uniformLocation");function m(t){return e.call(this),this[s]=t,this}m.prototype=Object.assign(Object.create(e.prototype),{constructor:m,[s]:null,[o]:i.initializeOnly,[a]:null,[g]:null,[u]:new Set,[l]:new Map,[c]:new Set,[h]:new Map,[d]:new Set,[p]:new Set,[f]:new Map,create:function(){return new this.constructor},equals:function(t){return this[s]===t.valueOf()},assign:function(t){this.set(t.getValue()),this.addEvent()},set:function(t){this[s]=t},setValue:function(t){this.set(t instanceof this.constructor?t.getValue():t),this.addEvent()},getValue:function(){return this[s]},setAccessType:function(t){this[o]=t},getAccessType:function(){return this[o]},isInitializable:function(){return this[o]&i.initializeOnly},isInput:function(){return this[o]&i.inputOnly},isOutput:function(){return this[o]&i.outputOnly},isReadable:function(){return this[o]!==i.inputOnly},isWritable:function(){return this[o]!==i.initializeOnly},setUnit:function(t){this[a]=t},getUnit:function(){return this[a]},hasReferences:function(){return 0!==this[u].size},isReference:function(t){return t===this[o]||t===i.inputOutput},addReference:function(t){const e=this.getReferences();if(!e.has(t)){switch(e.add(t),this.getAccessType()&t.getAccessType()){case i.initializeOnly:t.addFieldInterest(this),this.assign(t);break;case i.inputOnly:t.addFieldInterest(this);break;case i.outputOnly:this.addFieldInterest(t);break;case i.inputOutput:t.addFieldInterest(this),this.addFieldInterest(t),this.assign(t)}this.processReferencesCallbacks()}},removeReference:function(t){switch(this.getReferences().delete(t),this.getAccessType()&t.getAccessType()){case i.initializeOnly:case i.inputOnly:t.removeFieldInterest(this);break;case i.outputOnly:this.removeFieldInterest(t);break;case i.inputOutput:t.removeFieldInterest(this),this.removeFieldInterest(t)}this.processReferencesCallbacks()},getReferences:function(){return this[u]===m.prototype[u]&&(this[u]=new Set),this[u]},addReferencesCallback:function(t,e){this[l]===m.prototype[l]&&(this[l]=new Map),this[l].set(t,e)},removeReferencesCallback:function(t){this[l].delete(t)},getReferencesCallbacks:function(){return this[l]},processReferencesCallbacks:function(){const t=[];return function(){if(this[l].size)for(const e of r.values(t,this[l]))e()}}(),addFieldInterest:function(t){this[c]===m.prototype[c]&&(this[c]=new Set),this[c].add(t)},removeFieldInterest:function(t){this[c].delete(t)},getFieldInterests:function(){return this[c]},addFieldCallback:function(t,e){this[h]===m.prototype[h]&&(this[h]=new Map),this[h].set(t,e)},removeFieldCallback:function(t){this[h].delete(t)},getFieldCallbacks:function(){return this[h]},addInputRoute:function(t){this[d]===m.prototype[d]&&(this[d]=new Set),this[d].add(t),this.processRouteCallbacks()},removeInputRoute:function(t){this[d].delete(t),this.processRouteCallbacks()},getInputRoutes:function(){return this[d]},addOutputRoute:function(t){this[p]===m.prototype[p]&&(this[p]=new Set),this[p].add(t),this.processRouteCallbacks()},removeOutputRoute:function(t){this[p].delete(t),this.processRouteCallbacks()},getOutputRoutes:function(){return this[p]},addRouteCallback:function(t,e){this[f]===m.prototype[f]&&(this[f]=new Map),this[f].set(t,e)},removeRouteCallback:function(t){this[f].delete(t)},getRouteCallbacks:function(){return this[f]},processRouteCallbacks:function(){const t=[];return function(){if(this[f].size)for(const e of r.values(t,this[f]))e()}}(),processEvent:function(){const t=[];return function(e=n.create(this)){if(e.has(this))return;e.add(this),this.setTainted(!1);const i=e.field;i!==this&&this.set(i.getValue(),i.length),this.processInterests();let s=!0;if(this[c].size)for(const t of this[c].values())s?(s=!1,t.addEventObject(this,e)):t.addEventObject(this,n.copy(e));if(s&&n.push(e),this[h].size)for(const e of r.values(t,this[h]))e(this.valueOf())}}(),addCloneCount:Function.prototype,removeCloneCount:Function.prototype,valueOf:function(){return this},fromString:function(t,e){const i=new(require("x_ite/Parser/VRMLParser"))(e);if(i.setUnits(!!e),i.setInput(t),!i.fieldValue(this))throw new Error("Couldn't read value for field '"+this.getName()+"'.")},dispose:function(){for(const t of new Set(this[d]))t.dispose();for(const t of new Set(this[p]))t.dispose();e.prototype.dispose.call(this)}});for(const t of Reflect.ownKeys(m.prototype))Object.defineProperty(m.prototype,t,{enumerable:!1});return m})),define("x_ite/Fields/SFBool",["x_ite/Base/X3DField","x_ite/Base/X3DConstants"],(function(t,e){"use strict";function i(e){return t.call(this,!!e)}i.prototype=Object.assign(Object.create(t.prototype),{constructor:i,copy:function(){return new i(this.getValue())},isDefaultValue:function(){return!1===this.getValue()},set:function(e){t.prototype.set.call(this,!!e)},getTypeName:function(){return"SFBool"},getType:function(){return e.SFBool},valueOf:function(){return this.getValue()},toStream:function(t){t.string+=this.getValue()?"TRUE":"FALSE"},toVRMLStream:function(t){this.toStream(t)},toXMLStream:function(t){t.string+=this.getValue()?"true":"false"}});for(const t of Reflect.ownKeys(i.prototype))Object.defineProperty(i.prototype,t,{enumerable:!1});return i})),define("standard/Math/Algorithm",[],(function(){"use strict";function t(){}return t.prototype={constructor:t,radians:function(t){return t*(Math.PI/180)},degrees:function(t){return t*(180/Math.PI)},random:function(t,e){return t+Math.random()*(e-t)},fract:function(t){return t%1},clamp:function(t,e,i){return Math.min(Math.max(t,e),i)},interval:function(t,e,i){return t>=i?(t-e)%(i-e)+e:t<e?(t-i)%(i-e)+i:t},lerp:function(t,e,i){return t+i*(e-t)},slerp:function(t,e,i){let n=t.dot(e);if(n>=1)return t;n<0&&(n=-n,e.negate());const r=Math.acos(n),s=Math.sin(r),o=Math.sin((1-i)*r)/s,a=Math.sin(i*r)/s;return t.x=t.x*o+e.x*a,t.y=t.y*o+e.y*a,t.z=t.z*o+e.z*a,t.w=t.w*o+e.w*a,t},simpleSlerp:function(t,e,i){const n=t.dot(e);if(n>=1)return t;const r=Math.acos(n),s=Math.sin(r),o=Math.sin((1-i)*r)/s,a=Math.sin(i*r)/s;return t.x=t.x*o+e.x*a,t.y=t.y*o+e.y*a,t.z=t.z*o+e.z*a,t.w=t.w*o+e.w*a,t},isPowerOfTwo:function(t){return 0==(t-1&t)},nextPowerOfTwo:function(t){return this.isPowerOfTwo(t)?t:1<<32-Math.clz32(t)},cmp:function(t,e){return t>e?1:t<e?-1:0},less:function(t,e){return t<e},greater:function(t,e){return t>e},lowerBound:function(t,e,i,n,r=this.less){let s=0,o=0,a=i-e;for(;a>0;)o=a>>>1,s=e+o,r(t[s],n)?(e=++s,a-=o+1):a=o;return e},upperBound:function(t,e,i,n,r=this.less){let s=0,o=0,a=i-e;for(;a>0;)o=a>>>1,s=e+o,r(n,t[s])?a=o:(e=++s,a-=o+1);return e},set_difference:function(t,e,i){for(const n of t)e.has(n)||i.add(n);return i}},new t})),define("standard/Math/Numbers/Color3",["standard/Math/Algorithm"],(function(t){"use strict";const e=t.clamp,i=Symbol.for("X_ITE.Color3.r"),n=Symbol.for("X_ITE.Color3.g"),r=Symbol.for("X_ITE.Color3.b");function s(t,s,o){arguments.length?(this[i]=e(t,0,1),this[n]=e(s,0,1),this[r]=e(o,0,1)):(this[i]=0,this[n]=0,this[r]=0)}s.prototype={constructor:s,length:3,[Symbol.iterator]:function*(){yield this[i],yield this[n],yield this[r]},copy:function(){const t=Object.create(s.prototype);return t[i]=this[i],t[n]=this[n],t[r]=this[r],t},assign:function(t){this[i]=t[i],this[n]=t[n],this[r]=t[r]},set:function(t,s,o){this[i]=e(t,0,1),this[n]=e(s,0,1),this[r]=e(o,0,1)},equals:function(t){return this[i]===t[i]&&this[n]===t[n]&&this[r]===t[r]},getHSV:function(t){let e,s,o;const a=Math.min(this[i],this[n],this[r]),u=Math.max(this[i],this[n],this[r]);o=u;const l=u-a;return 0!==u&&0!==l?(s=l/u,e=this[i]===u?(this[n]-this[r])/l:this[n]===u?2+(this[r]-this[i])/l:4+(this[i]-this[n])/l,e*=Math.PI/3,e<0&&(e+=2*Math.PI)):s=e=0,t[0]=e,t[1]=s,t[2]=o,t},setHSV:function(s,o,a){if(o=e(o,0,1),a=e(a,0,1),0===o)this[i]=this[n]=this[r]=a;else{const e=t.degrees(t.interval(s,0,2*Math.PI))/60,u=Math.floor(e),l=e-u,c=a*(1-o),h=a*(1-o*l),d=a*(1-o*(1-l));switch(u%6){case 0:this[i]=a,this[n]=d,this[r]=c;break;case 1:this[i]=h,this[n]=a,this[r]=c;break;case 2:this[i]=c,this[n]=a,this[r]=d;break;case 3:this[i]=c,this[n]=h,this[r]=a;break;case 4:this[i]=d,this[n]=c,this[r]=a;break;default:this[i]=a,this[n]=c,this[r]=h}}},toString:function(){return this[i]+" "+this[n]+" "+this[r]}};const o={get:function(){return this[i]},set:function(t){this[i]=e(t,0,1)},enumerable:!0,configurable:!1},a={get:function(){return this[n]},set:function(t){this[n]=e(t,0,1)},enumerable:!0,configurable:!1},u={get:function(){return this[r]},set:function(t){this[r]=e(t,0,1)},enumerable:!0,configurable:!1};return Object.defineProperty(s.prototype,"r",o),Object.defineProperty(s.prototype,"g",a),Object.defineProperty(s.prototype,"b",u),o.enumerable=!1,a.enumerable=!1,u.enumerable=!1,Object.defineProperty(s.prototype,"0",o),Object.defineProperty(s.prototype,"1",a),Object.defineProperty(s.prototype,"2",u),Object.assign(s,{HSV:function(t,e,i){const n=Object.create(this.prototype);return n.setHSV(t,e,i),n},lerp:function(t,e,i,n){let r=t[0],s=e[0];const o=t[1],a=e[1],u=t[2],l=e[2];0===o&&(r=s),0===a&&(s=r);const c=Math.abs(s-r);if(c<=Math.PI)return n[0]=r+i*(s-r),n[1]=o+i*(a-o),n[2]=u+i*(l-u),n;const h=2*Math.PI,d=(h-c)*i;let p=r<s?r-d:r+d;return p<0?p+=h:p>h&&(p-=h),n[0]=p,n[1]=o+i*(a-o),n[2]=u+i*(l-u),n}}),s})),define("x_ite/Fields/SFColor",["standard/Math/Numbers/Color3","x_ite/Base/X3DField","x_ite/Base/X3DConstants","x_ite/InputOutput/Generator"],(function(t,e,i,n){"use strict";function r(i,n,r){switch(arguments.length){case 0:return e.call(this,new t);case 1:return e.call(this,arguments[0]);case 3:return e.call(this,new t(+i,+n,+r))}throw new Error("Invalid arguments.")}r.prototype=Object.assign(Object.create(e.prototype),{constructor:r,[Symbol.iterator]:function*(){yield*this.getValue()},copy:function(){return new r(this.getValue().copy())},getTypeName:function(){return"SFColor"},getType:function(){return i.SFColor},equals:function(t){return this.getValue().equals(t.getValue())},isDefaultValue:function(){return 0===this.getValue().r&&0===this.getValue().g&&0===this.getValue().b},set:function(t){this.getValue().assign(t)},getHSV:function(){return this.getValue().getHSV([])},setHSV:function(t,e,i){this.getValue().setHSV(t,e,i),this.addEvent()},lerp:function(){const e=[],i=[],n=[];return function(s,o){const a=new r;return this.getValue().getHSV(e),s.getValue().getHSV(i),t.lerp(e,i,o,n),a.setHSV(n[0],n[1],n[2],n[3]),a}}(),toStream:function(t){const e=n.Get(t),i=this.getValue(),r=i.length-1;for(let n=0;n<r;++n)t.string+=e.Precision(i[n]),t.string+=" ";t.string+=e.Precision(i[r])},toVRMLStream:function(t){this.toStream(t)},toXMLStream:function(t){this.toStream(t)}});for(const t of Reflect.ownKeys(r.prototype))Object.defineProperty(r.prototype,t,{enumerable:!1});const s={get:function(){return this.getValue().r},set:function(t){this.getValue().r=+t,this.addEvent()},enumerable:!0,configurable:!1},o={get:function(){return this.getValue().g},set:function(t){this.getValue().g=+t,this.addEvent()},enumerable:!0,configurable:!1},a={get:function(){return this.getValue().b},set:function(t){this.getValue().b=+t,this.addEvent()},enumerable:!0,configurable:!1};return Object.defineProperty(r.prototype,"r",s),Object.defineProperty(r.prototype,"g",o),Object.defineProperty(r.prototype,"b",a),s.enumerable=!1,o.enumerable=!1,a.enumerable=!1,Object.defineProperty(r.prototype,"0",s),Object.defineProperty(r.prototype,"1",o),Object.defineProperty(r.prototype,"2",a),r})),define("standard/Math/Numbers/Color4",["standard/Math/Numbers/Color3","standard/Math/Algorithm"],(function(t,e){"use strict";const i=e.clamp,n=Symbol.for("X_ITE.Color3.r"),r=Symbol.for("X_ITE.Color3.g"),s=Symbol.for("X_ITE.Color3.b"),o=Symbol();function a(t,e,a,u){arguments.length?(this[n]=i(t,0,1),this[r]=i(e,0,1),this[s]=i(a,0,1),this[o]=i(u,0,1)):(this[n]=0,this[r]=0,this[s]=0,this[o]=0)}a.prototype={constructor:a,length:4,[Symbol.iterator]:function*(){yield this[n],yield this[r],yield this[s],yield this[o]},copy:function(){const t=Object.create(a.prototype);return t[n]=this[n],t[r]=this[r],t[s]=this[s],t[o]=this[o],t},assign:function(t){this[n]=t[n],this[r]=t[r],this[s]=t[s],this[o]=t[o]},set:function(t,e,a,u){this[n]=i(t,0,1),this[r]=i(e,0,1),this[s]=i(a,0,1),this[o]=i(u,0,1)},equals:function(t){return this[n]===t[n]&&this[r]===t[r]&&this[s]===t[s]&&this[o]===t[o]},getHSVA:function(e){return t.prototype.getHSV.call(this,e),e[3]=this[o],e},setHSVA:function(e,n,r,s){t.prototype.setHSV.call(this,e,n,r),this[o]=i(s,0,1)},toString:function(){return this[n]+" "+this[r]+" "+this[s]+" "+this[o]}};const u={get:function(){return this[n]},set:function(t){this[n]=i(t,0,1)},enumerable:!0,configurable:!1},l={get:function(){return this[r]},set:function(t){this[r]=i(t,0,1)},enumerable:!0,configurable:!1},c={get:function(){return this[s]},set:function(t){this[s]=i(t,0,1)},enumerable:!0,configurable:!1},h={get:function(){return this[o]},set:function(t){this[o]=i(t,0,1)},enumerable:!0,configurable:!1};return Object.defineProperty(a.prototype,"r",u),Object.defineProperty(a.prototype,"g",l),Object.defineProperty(a.prototype,"b",c),Object.defineProperty(a.prototype,"a",h),u.enumerable=!1,l.enumerable=!1,c.enumerable=!1,h.enumerable=!1,Object.defineProperty(a.prototype,"0",u),Object.defineProperty(a.prototype,"1",l),Object.defineProperty(a.prototype,"2",c),Object.defineProperty(a.prototype,"3",h),Object.assign(a,{HSVA:function(t,e,i,n){const r=Object.create(this.prototype);return r.setHSVA(t,e,i,n),r},lerp:function(e,i,n,r){const s=e[3];return t.lerp(e,i,n,r),r[3]=s+n*(i[3]-s),r}}),a})),define("x_ite/Fields/SFColorRGBA",["x_ite/Base/X3DField","x_ite/Fields/SFColor","x_ite/Base/X3DConstants","standard/Math/Numbers/Color4"],(function(t,e,i,n){"use strict";function r(e,i,r,s){switch(arguments.length){case 0:return t.call(this,new n);case 1:return t.call(this,arguments[0]);case 4:return t.call(this,new n(+e,+i,+r,+s))}throw new Error("Invalid arguments.")}r.prototype=Object.assign(Object.create(t.prototype),{constructor:r,[Symbol.iterator]:function*(){yield*this.getValue()},copy:function(){return new r(this.getValue().copy())},getTypeName:function(){return"SFColorRGBA"},getType:function(){return i.SFColorRGBA},equals:e.prototype.equals,isDefaultValue:function(){return 0===this.getValue().r&&0===this.getValue().g&&0===this.getValue().b&&0===this.getValue().a},set:e.prototype.set,getHSVA:function(){return this.getValue().getHSVA([])},setHSVA:function(t,e,i,n){this.getValue().setHSVA(t,e,i,n),this.addEvent()},lerp:function(){const t=[],e=[],i=[];return function(s,o){const a=new r;return this.getValue().getHSVA(t),s.getValue().getHSVA(e),n.lerp(t,e,o,i),a.setHSVA(i[0],i[1],i[2],i[3]),a}}(),toStream:e.prototype.toStream,toVRMLStream:e.prototype.toVRMLStream,toXMLStream:e.prototype.toXMLStream});for(const t of Reflect.ownKeys(r.prototype))Object.defineProperty(r.prototype,t,{enumerable:!1});const s={get:function(){return this.getValue().r},set:function(t){this.getValue().r=+t,this.addEvent()},enumerable:!0,configurable:!1},o={get:function(){return this.getValue().g},set:function(t){this.getValue().g=+t,this.addEvent()},enumerable:!0,configurable:!1},a={get:function(){return this.getValue().b},set:function(t){this.getValue().b=+t,this.addEvent()},enumerable:!0,configurable:!1},u={get:function(){return this.getValue().a},set:function(t){this.getValue().a=+t,this.addEvent()},enumerable:!0,configurable:!1};return Object.defineProperty(r.prototype,"r",s),Object.defineProperty(r.prototype,"g",o),Object.defineProperty(r.prototype,"b",a),Object.defineProperty(r.prototype,"a",u),s.enumerable=!1,o.enumerable=!1,a.enumerable=!1,u.enumerable=!1,Object.defineProperty(r.prototype,"0",s),Object.defineProperty(r.prototype,"1",o),Object.defineProperty(r.prototype,"2",a),Object.defineProperty(r.prototype,"3",u),r})),define("x_ite/Fields/SFDouble",["x_ite/Base/X3DField","x_ite/Base/X3DConstants","x_ite/InputOutput/Generator"],(function(t,e,i){"use strict";function n(e){return t.call(this,arguments.length?+e:0)}n.prototype=Object.assign(Object.create(t.prototype),{constructor:n,copy:function(){return new n(this.getValue())},getTypeName:function(){return"SFDouble"},getType:function(){return e.SFDouble},isDefaultValue:function(){return 0===this.getValue()},set:function(e){t.prototype.set.call(this,+e)},valueOf:t.prototype.getValue,toStream:function(t){const e=i.Get(t),n=e.Unit(this.getUnit());t.string+=e.DoublePrecision(e.ToUnit(n,this.getValue()))},toVRMLStream:function(t){this.toStream(t)},toXMLStream:function(t){this.toStream(t)}});for(const t of Reflect.ownKeys(n.prototype))Object.defineProperty(n.prototype,t,{enumerable:!1});return n})),define("x_ite/Fields/SFFloat",["x_ite/Base/X3DField","x_ite/Base/X3DConstants","x_ite/InputOutput/Generator"],(function(t,e,i){"use strict";function n(e){return t.call(this,arguments.length?+e:0)}n.prototype=Object.assign(Object.create(t.prototype),{constructor:n,copy:function(){return new n(this.getValue())},getTypeName:function(){return"SFFloat"},getType:function(){return e.SFFloat},isDefaultValue:function(){return 0===this.getValue()},set:function(e){t.prototype.set.call(this,+e)},valueOf:t.prototype.getValue,toStream:function(t){const e=i.Get(t),n=e.Unit(this.getUnit());t.string+=e.Precision(e.ToUnit(n,this.getValue()))},toVRMLStream:function(t){this.toStream(t)},toXMLStream:function(t){this.toStream(t)}});for(const t of Reflect.ownKeys(n.prototype))Object.defineProperty(n.prototype,t,{enumerable:!1});return n})),define("x_ite/Fields/SFInt32",["x_ite/Base/X3DField","x_ite/Base/X3DConstants"],(function(t,e){"use strict";function i(e){return t.call(this,~~e)}i.prototype=Object.assign(Object.create(t.prototype),{constructor:i,copy:function(){return new i(this.getValue())},getTypeName:function(){return"SFInt32"},getType:function(){return e.SFInt32},isDefaultValue:function(){return 0===this.getValue()},set:function(e){t.prototype.set.call(this,~~e)},valueOf:t.prototype.getValue,toStream:function(t,e){t.string+=this.getValue().toString(e)},toVRMLStream:function(t){this.toStream(t)},toXMLStream:function(t){t.string+=this.getValue().toString()}});for(const t of Reflect.ownKeys(i.prototype))Object.defineProperty(i.prototype,t,{enumerable:!1});return i})),define("x_ite/Fields/SFImage",["x_ite/Base/X3DField","x_ite/Fields/SFInt32","x_ite/Base/X3DConstants"],(function(t,e,i){"use strict";function n(t,e,i,n){const r=require("x_ite/Fields/ArrayFields").MFInt32;this.width=~~t,this.height=~~e,this.comp=~~i,this.array=new r,this.array.setValue(n),this.array.length=this.width*this.height}function r(e,i,r,s){const o=require("x_ite/Fields/ArrayFields").MFInt32;return arguments[0]instanceof n?t.call(this,arguments[0]):4===arguments.length?t.call(this,new n(e,i,r,s)):t.call(this,new n(0,0,0,new o)),this.getValue().getArray().addParent(this),this.addInterest("set_size__",this),this}n.prototype={constructor:n,copy:function(){return new n(this.width,this.height,this.comp,this.array)},equals:function(t){return this.width===t.width&&this.height===t.height&&this.comp===t.comp&&this.array.equals(t.array)},assign:function(t){this.width=t.width,this.height=t.height,this.comp=t.comp,this.array.assign(t.array)},set:function(t,e,i,n){this.width=~~t,this.height=~~e,this.comp=~~i,this.array.assign(n)},setWidth:function(t){this.width=~~t,this.array.length=this.width*this.height},getWidth:function(){return this.width},setHeight:function(t){this.height=~~t,this.array.length=this.width*this.height},getHeight:function(){return this.height},setComp:function(t){this.comp=~~t},getComp:function(){return this.comp},setArray:function(t){this.array.assign(t),this.array.length=this.width*this.height},getArray:function(){return this.array}},r.prototype=Object.assign(Object.create(t.prototype),{constructor:r,set_size__:function(){this.getValue().getArray().length=this.width*this.height},copy:function(){return new r(this.getValue().copy())},equals:function(t){return this.getValue().equals(t.getValue())},isDefaultValue:function(){return 0===this.width&&0===this.height&&0===this.comp},set:function(t){this.getValue().assign(t)},getTypeName:function(){return"SFImage"},getType:function(){return i.SFImage},toStream:function(t){t.string+=this.width+" "+this.height+" "+this.comp;for(const e of this.array)t.string+=" 0x"+e.toString(16)},toVRMLStream:function(t){this.toStream(t)},toXMLStream:function(t){this.toStream(t)}});for(const t of Reflect.ownKeys(r.prototype))Object.defineProperty(r.prototype,t,{enumerable:!1});const s={get:function(){return this.getValue().getWidth()},set:function(t){this.getValue().setWidth(t),this.addEvent()},enumerable:!0,configurable:!1},o={get:function(){return this.getValue().getHeight()},set:function(t){this.getValue().setHeight(t),this.addEvent()},enumerable:!0,configurable:!1};return Object.defineProperty(r.prototype,"width",s),Object.defineProperty(r.prototype,"height",o),Object.defineProperty(r.prototype,"comp",{get:function(){return this.getValue().getComp()},set:function(t){this.getValue().setComp(t),this.addEvent()},enumerable:!0,configurable:!1}),Object.defineProperty(r.prototype,"array",{get:function(){return this.getValue().getArray()},set:function(t){this.getValue().setArray(t),this.addEvent()},enumerable:!0,configurable:!1}),s.enumerable=!1,o.enumerable=!1,Object.defineProperty(r.prototype,"x",s),Object.defineProperty(r.prototype,"y",o),r})),define("x_ite/Fields/SFMatrixPrototypeTemplate",["x_ite/Base/X3DField"],(function(t){"use strict";return function(e,i,n){return Object.assign(Object.create(t.prototype),{[Symbol.iterator]:function*(){yield*this.getValue()},copy:function(){return new this.constructor(this.getValue().copy())},equals:function(t){return this.getValue().equals(t.getValue())},isDefaultValue:function(){return this.getValue().equals(e.Identity)},set:function(t){this.getValue().assign(t)},setTransform:function(t,e,i,n,r){t=t?t.getValue():null,e=e?e.getValue():null,i=i?i.getValue():null,n=n?n.getValue():null,r=r?r.getValue():null,this.getValue().set(t,e,i,n,r)},getTransform:function(t,e,i,n,r){t=t?t.getValue():null,e=e?e.getValue():null,i=i?i.getValue():null,n=n?n.getValue():null,r=r?r.getValue():null,this.getValue().get(t,e,i,n,r)},determinant:function(){return this.getValue().determinant()},transpose:function(){return new this.constructor(e.transpose(this.getValue()))},inverse:function(){return new this.constructor(e.inverse(this.getValue()))},multLeft:function(t){return new this.constructor(e.multLeft(this.getValue(),t.getValue()))},multRight:function(t){return new this.constructor(e.multRight(this.getValue(),t.getValue()))},multVecMatrix:function(t){return new i(this.getValue().multVecMatrix(t.getValue().copy()))},multMatrixVec:function(t){return new i(this.getValue().multMatrixVec(t.getValue().copy()))},multDirMatrix:function(t){return new i(this.getValue().multDirMatrix(t.getValue().copy()))},multMatrixDir:function(t){return new i(this.getValue().multMatrixDir(t.getValue().copy()))},toStream:function(t){const e=Generator.Get(t),i=this.getValue(),r=i.length-1;for(let s=0;s<r;++s)t.string+=n?e.DoublePrecision(i[s]):e.Precision(i[s]),t.string+=" ";t.string+=n?e.DoublePrecision(i[r]):e.Precision(i[r])},toVRMLStream:function(t){this.toStream(t)},toXMLStream:function(t){this.toStream(t)}})}})),define("x_ite/Fields/SFVecPrototypeTemplate",["x_ite/Base/X3DField","x_ite/InputOutput/Generator"],(function(t,e){"use strict";return function(i,n){return Object.assign(Object.create(t.prototype),{[Symbol.iterator]:function*(){yield*this.getValue()},copy:function(){return new this.constructor(this.getValue().copy())},equals:function(t){return this.getValue().equals(t.getValue())},isDefaultValue:function(){return this.getValue().equals(i.Zero)},set:function(t){this.getValue().assign(t)},abs:function(){return new this.constructor(i.abs(this.getValue()))},add:function(t){return new this.constructor(i.add(this.getValue(),t.getValue()))},distance:function(t){return this.getValue().distance(t.getValue())},divide:function(t){return new this.constructor(i.divide(this.getValue(),t))},divVec:function(t){return new this.constructor(i.divVec(this.getValue(),t.getValue()))},dot:function(t){return this.getValue().dot(t.getValue())},inverse:function(){return new this.constructor(i.inverse(this.getValue()))},length:function(){return this.getValue().magnitude()},lerp:function(t,e){return new this.constructor(i.lerp(this.getValue(),t,e))},max:function(t){return new this.constructor(i.max(this.getValue(),t.getValue()))},min:function(t){return new this.constructor(i.min(this.getValue(),t.getValue()))},multiply:function(t){return new this.constructor(i.multiply(this.getValue(),t))},multVec:function(t){return new this.constructor(i.multVec(this.getValue(),t.getValue()))},negate:function(){return new this.constructor(i.negate(this.getValue()))},normalize:function(t){return new this.constructor(i.normalize(this.getValue()))},subtract:function(t){return new this.constructor(i.subtract(this.getValue(),t.getValue()))},toStream:function(t){const i=e.Get(t),r=this.getValue(),s=i.Unit(this.getUnit()),o=r.length-1;for(let e=0;e<o;++e)t.string+=n?i.DoublePrecision(i.ToUnit(s,r[e])):i.Precision(i.ToUnit(s,r[e])),t.string+=" ";t.string+=n?i.DoublePrecision(i.ToUnit(s,r[o])):i.Precision(i.ToUnit(s,r[o]))},toVRMLStream:function(t){this.toStream(t)},toXMLStream:function(t){this.toStream(t)}})}})),define("standard/Math/Numbers/Vector2",["standard/Math/Algorithm"],(function(t){"use strict";function e(t,e){this.x=t,this.y=e}return e.prototype={constructor:e,length:2,[Symbol.iterator]:function*(){yield this.x,yield this.y},copy:function(){const t=Object.create(e.prototype);return t.x=this.x,t.y=this.y,t},assign:function(t){return this.x=t.x,this.y=t.y,this},set:function(t,e){return this.x=t,this.y=e,this},equals:function(t){return this.x===t.x&&this.y===t.y},negate:function(){return this.x=-this.x,this.y=-this.y,this},inverse:function(){return this.x=1/this.x,this.y=1/this.y,this},add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this},multiply:function(t){return this.x*=t,this.y*=t,this},multVec:function(t){return this.x*=t.x,this.y*=t.y,this},divide:function(t){return this.x/=t,this.y/=t,this},divVec:function(t){return this.x/=t.x,this.y/=t.y,this},normalize:function(){const t=Math.hypot(this.x,this.y);return t&&(this.x/=t,this.y/=t),this},dot:function(t){return this.x*t.x+this.y*t.y},norm:function(){const t=this.x,e=this.y;return t*t+e*e},magnitude:function(){return Math.hypot(this.x,this.y)},distance:function(t){return Math.hypot(this.x-t.x,this.y-t.y)},lerp:function(t,e){const i=this.x,n=this.y;return this.x=i+e*(t.x-i),this.y=n+e*(t.y-n),this},abs:function(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this},min:function(t){let e=this.x,i=this.y;for(const t of arguments)e=Math.min(e,t.x),i=Math.min(i,t.y);return this.x=e,this.y=i,this},max:function(t){let e=this.x,i=this.y;for(const t of arguments)e=Math.max(e,t.x),i=Math.max(i,t.y);return this.x=e,this.y=i,this},toString:function(){return this.x+" "+this.y}},Object.defineProperty(e.prototype,"0",{get:function(){return this.x},set:function(t){this.x=t},enumerable:!1,configurable:!1}),Object.defineProperty(e.prototype,"1",{get:function(){return this.y},set:function(t){this.y=t},enumerable:!1,configurable:!1}),Object.assign(e,{Zero:new e(0,0),One:new e(1,1),xAxis:new e(1,0),yAxis:new e(0,1),negate:function(t){return t.copy().negate()},inverse:function(t){return t.copy().inverse()},add:function(t,e){return t.copy().add(e)},subtract:function(t,e){return t.copy().subtract(e)},multiply:function(t,e){return t.copy().multiply(e)},multVec:function(t,e){return t.copy().multVec(e)},divide:function(t,e){return t.copy().divide(e)},divVec:function(t,e){return t.copy().divVec(e)},normalize:function(t){return t.copy().normalize()},dot:function(t,e){return t.dot(e)},magnitude:function(t){return t.magnitude()},distance:function(t,e){return t.distance(e)},lerp:function(t,e,i){return t.copy().lerp(e,i)},abs:function(t){return t.copy().abs()},min:function(t,e){return this.prototype.min.apply(t.copy(),arguments)},max:function(t,e){return this.prototype.max.apply(t.copy(),arguments)}}),e})),define("x_ite/Fields/SFVec2",["x_ite/Base/X3DField","x_ite/Fields/SFVecPrototypeTemplate","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector2"],(function(t,e,i,n){"use strict";function r(i,r,s){function o(e,i){switch(arguments.length){case 0:return t.call(this,new n(0,0));case 1:return t.call(this,arguments[0]);case 2:return t.call(this,new n(+e,+i))}throw new Error("Invalid arguments.")}o.prototype=Object.assign(Object.create(t.prototype),e(n,s),{constructor:o,getTypeName:function(){return i},getType:function(){return r}});for(const t of Reflect.ownKeys(o.prototype))Object.defineProperty(o.prototype,t,{enumerable:!1});const a={get:function(){return this.getValue().x},set:function(t){this.getValue().x=+t,this.addEvent()},enumerable:!0,configurable:!1},u={get:function(){return this.getValue().y},set:function(t){this.getValue().y=+t,this.addEvent()},enumerable:!0,configurable:!1};return Object.defineProperty(o.prototype,"x",a),Object.defineProperty(o.prototype,"y",u),a.enumerable=!1,u.enumerable=!1,Object.defineProperty(o.prototype,"0",a),Object.defineProperty(o.prototype,"1",u),o}return{SFVec2d:r("SFVec2d",i.SFVec2d,!0),SFVec2f:r("SFVec2f",i.SFVec2f,!1)}})),define("standard/Math/Numbers/Vector3",["standard/Math/Algorithm"],(function(t){"use strict";function e(t,e,i){this.x=t,this.y=e,this.z=i}return e.prototype={constructor:e,length:3,[Symbol.iterator]:function*(){yield this.x,yield this.y,yield this.z},copy:function(){const t=Object.create(e.prototype);return t.x=this.x,t.y=this.y,t.z=this.z,t},assign:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},set:function(t,e,i){return this.x=t,this.y=e,this.z=i,this},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},inverse:function(){return this.x=1/this.x,this.y=1/this.y,this.z=1/this.z,this},add:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},multiply:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multVec:function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this},divide:function(t){return this.x/=t,this.y/=t,this.z/=t,this},divVec:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},cross:function(t){const e=this.x,i=this.y,n=this.z,r=t.x,s=t.y,o=t.z;return this.x=i*o-n*s,this.y=n*r-e*o,this.z=e*s-i*r,this},normalize:function(){const t=Math.hypot(this.x,this.y,this.z);return t&&(this.x/=t,this.y/=t,this.z/=t),this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},norm:function(){let t=this.x,e=this.y,i=this.z;return t*t+e*e+i*i},magnitude:function(){return Math.hypot(this.x,this.y,this.z)},distance:function(t){return Math.hypot(this.x-t.x,this.y-t.y,this.z-t.z)},lerp:function(t,e){const i=this.x,n=this.y,r=this.z;return this.x=i+e*(t.x-i),this.y=n+e*(t.y-n),this.z=r+e*(t.z-r),this},slerp:function(){const i=new e(0,0,0);return function(e,n){return t.simpleSlerp(this,i.assign(e),n)}}(),abs:function(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this.z=Math.abs(this.z),this},min:function(t){let e=this.x,i=this.y,n=this.z;for(const t of arguments)e=Math.min(e,t.x),i=Math.min(i,t.y),n=Math.min(n,t.z);return this.x=e,this.y=i,this.z=n,this},max:function(t){let e=this.x,i=this.y,n=this.z;for(const t of arguments)e=Math.max(e,t.x),i=Math.max(i,t.y),n=Math.max(n,t.z);return this.x=e,this.y=i,this.z=n,this},toString:function(){return this.x+" "+this.y+" "+this.z}},Object.defineProperty(e.prototype,"0",{get:function(){return this.x},set:function(t){this.x=t},enumerable:!1,configurable:!1}),Object.defineProperty(e.prototype,"1",{get:function(){return this.y},set:function(t){this.y=t},enumerable:!1,configurable:!1}),Object.defineProperty(e.prototype,"2",{get:function(){return this.z},set:function(t){this.z=t},enumerable:!1,configurable:!1}),Object.assign(e,{Zero:new e(0,0,0),One:new e(1,1,1),xAxis:new e(1,0,0),yAxis:new e(0,1,0),zAxis:new e(0,0,1),negate:function(t){return t.copy().negate()},inverse:function(t){return t.copy().inverse()},add:function(t,e){return t.copy().add(e)},subtract:function(t,e){return t.copy().subtract(e)},multiply:function(t,e){return t.copy().multiply(e)},multVec:function(t,e){return t.copy().multVec(e)},divide:function(t,e){return t.copy().divide(e)},divVec:function(t,e){return t.copy().divVec(e)},cross:function(t,e){return t.copy().cross(e)},normalize:function(t){return t.copy().normalize()},dot:function(t,e){return t.dot(e)},magnitude:function(t){return t.magnitude()},distance:function(t,e){return t.distance(e)},lerp:function(t,e,i){return t.copy().lerp(e,i)},slerp:function(t,e,i){return t.copy().slerp(e,i)},abs:function(t){return t.copy().abs()},min:function(t,e){return this.prototype.min.apply(t.copy(),arguments)},max:function(t,e){return this.prototype.max.apply(t.copy(),arguments)}}),e})),define("standard/Math/Numbers/Matrix2",["standard/Math/Numbers/Vector2","standard/Math/Algorithm"],(function(t,e){"use strict";function i(){arguments.length?(this[0]=arguments[0],this[1]=arguments[1],this[2]=arguments[2],this[3]=arguments[3]):this.identity()}return i.prototype={constructor:i,order:2,length:4,[Symbol.iterator]:function*(){const t=this.length;for(let e=0;e<t;++e)yield this[e]},copy:function(){const t=Object.create(i.prototype);return t[0]=this[0],t[1]=this[1],t[2]=this[2],t[3]=this[3],t},assign:function(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this},equals:function(t){return this[0]===t[0]&&this[1]===t[1]&&this[2]===t[2]&&this[3]===t[3]},set1:function(t,e,i){this[t*this.order+e]=i},get1:function(t,e){return this[t*this.order+e]},set:function(){switch(arguments.length){case 0:this.identity();break;case 4:this[0]=arguments[0],this[1]=arguments[1],this[2]=arguments[2],this[3]=arguments[3]}return this},determinant1:function(){return this[0]},determinant:function(){return this[0]*this[3]-this[1]*this[2]},transpose:function(){const t=this[1];return this[1]=this[2],this[2]=t,this},inverse:function(){const t=this[0],e=this[1],i=this[2],n=this[3],r=t*n-e*i;return this[0]=n/r,this[1]=-e/r,this[2]=-i/r,this[3]=t/r,this},multLeft:function(t){const e=this[0],i=this[1],n=this[2],r=this[3],s=t[0],o=t[1],a=t[2],u=t[3];return this[0]=e*s+n*o,this[1]=i*s+r*o,this[2]=e*a+n*u,this[3]=i*a+r*u,this},multRight:function(t){const e=this[0],i=this[1],n=this[2],r=this[3],s=t[0],o=t[1],a=t[2],u=t[3];return this[0]=s*e+a*i,this[1]=o*e+u*i,this[2]=s*n+a*r,this[3]=o*n+u*r,this},multVecMatrix:function(t){if("number"==typeof t){const e=t,i=e*this[2]+this[3];return(e*this[0]+this[1])/i}const e=t.x,i=t.y;return t.x=e*this[0]+i*this[2],t.y=e*this[1]+i*this[3],t},multMatrixVec:function(t){if("number"==typeof t){const e=t,i=e*this[2]+this[3];return(e*this[0]+this[1])/i}const e=t.x,i=t.y;return t.x=e*this[0]+i*this[1],t.y=e*this[2]+i*this[3],t},identity:function(){this[0]=1,this[1]=0,this[2]=0,this[3]=1},toString:function(){return this[0]+" "+this[1]+" "+this[2]+" "+this[3]}},Object.defineProperty(i.prototype,"x",{get:function(){const e=new t(0,0);return function(){return e.set(this[0],this[1])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(i.prototype,"y",{get:function(){const e=new t(0,0);return function(){return e.set(this[2],this[3])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(i.prototype,"xAxis",{get:function(){return this[0]},enumerable:!1,configurable:!1}),Object.defineProperty(i.prototype,"origin",{get:function(){return this[2]},enumerable:!1,configurable:!1}),Object.defineProperty(i.prototype,"submatrix",{get:function(){return this[0]},enumerable:!1,configurable:!1}),Object.assign(i,{Identity:new i}),i})),define("standard/Math/Algorithms/eigendecomposition",[],(function(){"use strict";const t=[],e=[],i=[];return function(n,r){const s=n.order,o=r.values,a=r.vectors;let u,l,c,h,d,p,f,g,m,_,y,x,w,b=n.length;for(x=0;x<s;++x)for(t[x]=t[x]||new Array(s),e[x]=o[x]=n.get1(x,x),i[x]=0,w=0;w<s;++w)a[x][w]=x===w?1:0,t[x][w]=n.get1(w,x);for(x=0;x<50;++x){for(u=0,_=0;_<s-1;++_)for(y=_+1;y<s;++y)u+=Math.abs(t[_][y]);if(0===u)break;for(m=x<3?.2*u/b:0,_=0;_<s-1;++_)for(y=_+1;y<s;++y)if(g=100*Math.abs(t[_][y]),x>3&&Math.abs(o[_])+g===Math.abs(o[_])&&Math.abs(o[y])+g===Math.abs(o[y]))t[_][y]=0;else if(Math.abs(t[_][y])>m){for(f=o[y]-o[_],Math.abs(f)+g===Math.abs(f)?d=t[_][y]/f:(l=.5*f/t[_][y],d=1/(Math.abs(l)+Math.sqrt(1+l*l)),l<0&&(d=-d)),c=1/Math.sqrt(1+d*d),h=d*c,p=h/(1+c),f=d*t[_][y],i[_]-=f,i[y]+=f,o[_]-=f,o[y]+=f,t[_][y]=0,w=0;w<_;++w)g=t[w][_],f=t[w][y],t[w][_]=g-h*(f+g*p),t[w][y]=f+h*(g-f*p);for(w=_+1;w<y;++w)g=t[_][w],f=t[w][y],t[_][w]=g-h*(f+g*p),t[w][y]=f+h*(g-f*p);for(w=y+1;w<s;++w)g=t[_][w],f=t[y][w],t[_][w]=g-h*(f+g*p),t[y][w]=f+h*(g-f*p);for(w=0;w<s;++w)g=a[w][_],f=a[w][y],a[w][_]=g-h*(f+g*p),a[w][y]=f+h*(g-f*p)}for(_=0;_<s;++_)o[_]=e[_]+=i[_],i[_]=0}return r}})),define("standard/Math/Numbers/Matrix3",["standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix2","standard/Math/Algorithms/eigendecomposition"],(function(t,e,i,n){"use strict";function r(){arguments.length?(this[0]=arguments[0],this[1]=arguments[1],this[2]=arguments[2],this[3]=arguments[3],this[4]=arguments[4],this[5]=arguments[5],this[6]=arguments[6],this[7]=arguments[7],this[8]=arguments[8]):this.identity()}r.prototype={constructor:r,order:3,length:9,[Symbol.iterator]:function*(){const t=this.length;for(let e=0;e<t;++e)yield this[e]},copy:function(){const t=Object.create(r.prototype);return t[0]=this[0],t[1]=this[1],t[2]=this[2],t[3]=this[3],t[4]=this[4],t[5]=this[5],t[6]=this[6],t[7]=this[7],t[8]=this[8],t},assign:function(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this},equals:function(t){return this[0]===t[0]&&this[1]===t[1]&&this[2]===t[2]&&this[3]===t[3]&&this[4]===t[4]&&this[5]===t[5]&&this[6]===t[6]&&this[7]===t[7]&&this[8]===t[8]},rotation:function(){return math.atan2(this[1],this[0])},set1:function(t,e,i){return this[t*this.order+e]=i,this},get1:function(t,e){return this[t*this.order+e]},set:function(){const e=new t(0,0);return function(i,n,r,s,o){switch(arguments.length){case 0:this.identity();break;case 1:null===i&&(i=t.Zero),this.identity(),this.translate(i);break;case 2:null===i&&(i=t.Zero),null===n&&(n=0),this.identity(),this.translate(i),0!==n&&this.rotate(n);break;case 3:null===i&&(i=t.Zero),null===n&&(n=0),null===r&&(r=t.One),this.identity(),this.translate(i),0!==n&&this.rotate(n),r.equals(t.One)||this.scale(r);break;case 4:if(null===i&&(i=t.Zero),null===n&&(n=0),null===r&&(r=t.One),null===s&&(s=0),this.identity(),this.translate(i),0!==n&&this.rotate(n),!r.equals(t.One)){0!==s?(this.rotate(s),this.scale(r),this.rotate(-s)):this.scale(r)}break;case 5:{null===i&&(i=t.Zero),null===n&&(n=0),null===r&&(r=t.One),null===s&&(s=0),null===o&&(o=t.Zero),this.identity(),this.translate(i);const a=!o.equals(t.Zero);a&&this.translate(o),0!==n&&this.rotate(n),r.equals(t.One)||(0!==s?(this.rotate(s),this.scale(r),this.rotate(-s)):this.scale(r)),a&&this.translate(e.assign(o).negate());break}case 9:this[0]=arguments[0],this[1]=arguments[1],this[2]=arguments[2],this[3]=arguments[3],this[4]=arguments[4],this[5]=arguments[5],this[6]=arguments[6],this[7]=arguments[7],this[8]=arguments[8]}return this}}(),get:function(){const n=new t(0,0),r=new e(0,0,0),o=new t(0,0),a=new e(0,0,0),u=new t(0,0),l=new i,c=new i,h=new t(0,0);return function(t,e,i,d,p){switch(null===t&&(t=n),null===e&&(e=r),null===i&&(i=o),null===d&&(d=a),null===p&&(p=u),arguments.length){case 1:t.set(this[6],this[7]);break;case 2:this.factor(t,l,o,c),e[0]=l[0],e[1]=l[1],e[2]=Math.atan2(l[1],l[0]);break;case 3:this.factor(t,l,i,c),e[0]=l[0],e[1]=l[1],e[2]=Math.atan2(l[1],l[0]);break;case 4:this.factor(t,l,i,c),e[0]=l[0],e[1]=l[1],e[2]=Math.atan2(l[1],l[0]),d[0]=c[0],d[1]=c[1],d[2]=Math.atan2(c[1],c[0]);break;case 5:s.set(h.assign(p).negate()),s.multLeft(this),s.translate(p),s.get(t,e,i,d)}}}(),factor:function(){const t=new i,e=new i,r=new i,s={values:[],vectors:[[],[]]};return function(i,o,a,u){i.set(this[6],this[7]);const l=this.submatrix,c=l.determinant()<0?-1:1;r.assign(l).transpose().multLeft(l);const h=n(r,s);u.set(h.vectors[0][0],h.vectors[1][0],h.vectors[0][1],h.vectors[1][1]),a.x=c*Math.sqrt(h.values[0]),a.y=c*Math.sqrt(h.values[1]),t[0]=1/a.x,t[3]=1/a.y,o.assign(e.assign(u).transpose().multRight(t).multRight(u).multRight(l))}}(),determinant2:function(){return this[0]*this[4]-this[1]*this[3]},determinant:function(){const t=this[0],e=this[1],i=this[2],n=this[3],r=this[4],s=this[5],o=this[6],a=this[7],u=this[8];return t*(r*u-s*a)-e*(n*u-s*o)+i*(n*a-r*o)},transpose:function(){let t;return t=this[1],this[1]=this[3],this[3]=t,t=this[2],this[2]=this[6],this[6]=t,t=this[5],this[5]=this[7],this[7]=t,this},inverse:function(){const t=this[0],e=this[1],i=this[2],n=this[3],r=this[4],s=this[5],o=this[6],a=this[7],u=this[8],l=t*r,c=t*a,h=n*e,d=n*a,p=o*e,f=o*r;let g=l*u-c*s-h*u+d*i+p*s-f*i;g=1/g;const m=(r*u-a*s)*g,_=-(e*u-a*i)*g,y=(e*s-r*i)*g,x=-(n*u-o*s)*g,w=(t*u-o*i)*g,b=-(t*s-n*i)*g;return this[0]=m,this[1]=_,this[2]=y,this[3]=x,this[4]=w,this[5]=b,this[6]=(d-f)*g,this[7]=-(c-p)*g,this[8]=(l-h)*g,this},multLeft:function(t){const e=this[0],i=this[1],n=this[2],r=this[3],s=this[4],o=this[5],a=this[6],u=this[7],l=this[8],c=t[0],h=t[1],d=t[2],p=t[3],f=t[4],g=t[5],m=t[6],_=t[7],y=t[8];return this[0]=e*c+r*h+a*d,this[1]=i*c+s*h+u*d,this[2]=n*c+o*h+l*d,this[3]=e*p+r*f+a*g,this[4]=i*p+s*f+u*g,this[5]=n*p+o*f+l*g,this[6]=e*m+r*_+a*y,this[7]=i*m+s*_+u*y,this[8]=n*m+o*_+l*y,this},multRight:function(t){const e=this[0],i=this[1],n=this[2],r=this[3],s=this[4],o=this[5],a=this[6],u=this[7],l=this[8],c=t[0],h=t[1],d=t[2],p=t[3],f=t[4],g=t[5],m=t[6],_=t[7],y=t[8];return this[0]=e*c+i*p+n*m,this[1]=e*h+i*f+n*_,this[2]=e*d+i*g+n*y,this[3]=r*c+s*p+o*m,this[4]=r*h+s*f+o*_,this[5]=r*d+s*g+o*y,this[6]=a*c+u*p+l*m,this[7]=a*h+u*f+l*_,this[8]=a*d+u*g+l*y,this},multVecMatrix:function(t){if(2===t.length){const e=t.x,i=t.y,n=e*this[2]+i*this[5]+this[8];return t.x=(e*this[0]+i*this[3]+this[6])/n,t.y=(e*this[1]+i*this[4]+this[7])/n,t}const e=t.x,i=t.y,n=t.z;return t.x=e*this[0]+i*this[3]+n*this[6],t.y=e*this[1]+i*this[4]+n*this[7],t.z=e*this[2]+i*this[5]+n*this[8],t},multMatrixVec:function(t){if(2===t.length){const e=t.x,i=t.y,n=e*this[6]+i*this[7]+this[8];return t.x=(e*this[0]+i*this[1]+this[2])/n,t.y=(e*this[3]+i*this[4]+this[5])/n,t}const e=t.x,i=t.y,n=t.z;return t.x=e*this[0]+i*this[1]+n*this[2],t.y=e*this[3]+i*this[4]+n*this[5],t.z=e*this[6]+i*this[7]+n*this[8],t},multDirMatrix:function(t){const e=t.x,i=t.y;return t.x=e*this[0]+i*this[3],t.y=e*this[1]+i*this[4],t},multMatrixDir:function(t){const e=t.x,i=t.y;return t.x=e*this[0]+i*this[1],t.y=e*this[3]+i*this[4],t},identity:function(){this[0]=1,this[1]=0,this[2]=0,this[3]=0,this[4]=1,this[5]=0,this[6]=0,this[7]=0,this[8]=1},translate:function(t){const e=t.x,i=t.y;return this[6]+=this[0]*e+this[3]*i,this[7]+=this[1]*e+this[4]*i,this},rotate:function(t){return this.multLeft(r.Rotation(t)),this},scale:function(t){const e=t.x,i=t.y;return this[0]*=e,this[3]*=i,this[1]*=e,this[4]*=i,this},toString:function(){return this[0]+" "+this[1]+" "+this[2]+" "+this[3]+" "+this[4]+" "+this[5]+" "+this[6]+" "+this[7]+" "+this[8]}},Object.defineProperty(r.prototype,"x",{get:function(){const t=new e(0,0,0);return function(){return t.set(this[0],this[1],this[2])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(r.prototype,"y",{get:function(){const t=new e(0,0,0);return function(){return t.set(this[3],this[4],this[5])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(r.prototype,"z",{get:function(){const t=new e(0,0,0);return function(){return t.set(this[6],this[7],this[8])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(r.prototype,"xAxis",{get:function(){const e=new t(0,0);return function(){return e.set(this[0],this[1])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(r.prototype,"yAxis",{get:function(){const e=new t(0,0);return function(){return e.set(this[3],this[4])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(r.prototype,"origin",{get:function(){const e=new t(0,0);return function(){return e.set(this[6],this[7])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(r.prototype,"submatrix",{get:function(){const t=new i;return function(){return t[0]=this[0],t[1]=this[1],t[2]=this[3],t[3]=this[4],t}}(),enumerable:!1,configurable:!1}),Object.assign(r,{Identity:new r,Rotation:function(t){const e=Math.sin(t),i=Math.cos(t);return new r(i,e,0,-e,i,0,0,0,1)},Matrix2:function(t){return new r(t[0],t[1],0,t[2],t[3],0,0,0,1)},transpose:function(t){return t.copy().transpose()},inverse:function(t){return t.copy().inverse()},multLeft:function(t,e){return t.copy().multLeft(e)},multRight:function(t,e){return t.copy().multRight(e)}});const s=new r;return r})),define("x_ite/Fields/SFMatrix3",["x_ite/Base/X3DField","x_ite/Fields/SFMatrixPrototypeTemplate","x_ite/Fields/SFVec2","x_ite/Base/X3DConstants","standard/Math/Numbers/Matrix3"],(function(t,e,i,n,r){"use strict";function s(i,n,s,o){function a(e,i,n,s,o,a,u,l,c){switch(arguments.length){case 0:return t.call(this,new r);case 1:return t.call(this,arguments[0]);case 9:return t.call(this,new r(+e,+i,+n,+s,+o,+a,+u,+l,+c))}throw new Error("Invalid arguments.")}a.prototype=Object.assign(Object.create(t.prototype),e(r,s,o),{constructor:a,getTypeName:function(){return i},getType:function(){return n},setTransform:function(t,e,i,n,r){t=t?t.getValue():null,e=e||0,i=i?i.getValue():null,n=n||0,r=r?r.getValue():null,this.getValue().set(t,e,i,n,r)}});for(const t of Reflect.ownKeys(a.prototype))Object.defineProperty(a.prototype,t,{enumerable:!1});function u(t){Object.defineProperty(a.prototype,t,{get:function(){return this.getValue()[t]},set:function(e){this.getValue()[t]=+e,this.addEvent()},enumerable:!0,configurable:!1})}for(let t=0,e=r.prototype.length;t<e;++t)u(t);return a}return{SFMatrix3d:s("SFMatrix3d",n.SFMatrix3d,i.SFVec2d,!0),SFMatrix3f:s("SFMatrix3f",n.SFMatrix3f,i.SFVec2f,!1)}})),define("x_ite/Fields/SFVec3",["x_ite/Base/X3DField","x_ite/Fields/SFVecPrototypeTemplate","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3"],(function(t,e,i,n){"use strict";function r(i,r,s){function o(e,i,r){switch(arguments.length){case 0:return t.call(this,new n(0,0,0));case 1:return t.call(this,arguments[0]);case 3:return t.call(this,new n(+e,+i,+r))}throw new Error("Invalid arguments.")}o.prototype=Object.assign(Object.create(t.prototype),e(n,s),{constructor:o,getTypeName:function(){return i},getType:function(){return r},cross:function(t){return new this.constructor(n.cross(this.getValue(),t.getValue()))}});for(const t of Reflect.ownKeys(o.prototype))Object.defineProperty(o.prototype,t,{enumerable:!1});const a={get:function(){return this.getValue().x},set:function(t){this.getValue().x=+t,this.addEvent()},enumerable:!0,configurable:!1},u={get:function(){return this.getValue().y},set:function(t){this.getValue().y=+t,this.addEvent()},enumerable:!0,configurable:!1},l={get:function(){return this.getValue().z},set:function(t){this.getValue().z=+t,this.addEvent()},enumerable:!0,configurable:!1};return Object.defineProperty(o.prototype,"x",a),Object.defineProperty(o.prototype,"y",u),Object.defineProperty(o.prototype,"z",l),a.enumerable=!1,u.enumerable=!1,l.enumerable=!1,Object.defineProperty(o.prototype,"0",a),Object.defineProperty(o.prototype,"1",u),Object.defineProperty(o.prototype,"2",l),o}return{SFVec3d:r("SFVec3d",i.SFVec3d,!0),SFVec3f:r("SFVec3f",i.SFVec3f,!1)}})),define("standard/Math/Numbers/Vector4",["standard/Math/Algorithm"],(function(t){"use strict";function e(t,e,i,n){this.x=t,this.y=e,this.z=i,this.w=n}return e.prototype={constructor:e,length:4,[Symbol.iterator]:function*(){yield this.x,yield this.y,yield this.z,yield this.w},copy:function(){const t=Object.create(e.prototype);return t.x=this.x,t.y=this.y,t.z=this.z,t.w=this.w,t},assign:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this},set:function(t,e,i,n){return this.x=t,this.y=e,this.z=i,this.w=n,this},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w},getReal:function(t){t.x=this.x/this.w,t.y=this.y/this.w,t.z=this.z/this.w},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},inverse:function(){return this.x=1/this.x,this.y=1/this.y,this.z=1/this.z,this.w=1/this.w,this},add:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this},multiply:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},multVec:function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this},divide:function(t){return this.x/=t,this.y/=t,this.z/=t,this.w/=t,this},divVec:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this.w/=t.w,this},normalize:function(){const t=Math.hypot(this.x,this.y,this.z,this.w);return t&&(this.x/=t,this.y/=t,this.z/=t,this.w/=t),this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},norm:function(){const t=this.x,e=this.y,i=this.z,n=this.w;return t*t+e*e+i*i+n*n},magnitude:function(){return Math.hypot(this.x,this.y,this.z,this.w)},distance:function(t){return Math.hypot(this.x-t.x,this.y-t.y,this.z-t.z,this.w-t.w)},lerp:function(t,e){const i=this.x,n=this.y,r=this.z,s=this.w;return this.x=i+e*(t.x-i),this.y=n+e*(t.y-n),this.z=r+e*(t.z-r),this.w=s+e*(t.w-s),this},abs:function(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this.z=Math.abs(this.z),this.w=Math.abs(this.w),this},min:function(t){let e=this.x,i=this.y,n=this.z,r=this.w;for(const t of arguments)e=Math.min(e,t.x),i=Math.min(i,t.y),n=Math.min(n,t.z),r=Math.min(r,t.w);return this.x=e,this.y=i,this.z=n,this.w=r,this},max:function(t){let e=this.x,i=this.y,n=this.z,r=this.w;for(const t of arguments)e=Math.max(e,t.x),i=Math.max(i,t.y),n=Math.max(n,t.z),r=Math.max(r,t.w);return this.x=e,this.y=i,this.z=n,this.w=r,this},toString:function(){return this.x+" "+this.y+" "+this.z+" "+this.w}},Object.defineProperty(e.prototype,"0",{get:function(){return this.x},set:function(t){this.x=t},enumerable:!1,configurable:!1}),Object.defineProperty(e.prototype,"1",{get:function(){return this.y},set:function(t){this.y=t},enumerable:!1,configurable:!1}),Object.defineProperty(e.prototype,"2",{get:function(){return this.z},set:function(t){this.z=t},enumerable:!1,configurable:!1}),Object.defineProperty(e.prototype,"3",{get:function(){return this.w},set:function(t){this.w=t},enumerable:!1,configurable:!1}),Object.assign(e,{Zero:new e(0,0,0,0),One:new e(1,1,1,1),xAxis:new e(1,0,0,0),yAxis:new e(0,1,0,0),zAxis:new e(0,0,1,0),wAxis:new e(0,0,0,1),negate:function(t){return t.copy().negate()},inverse:function(t){return t.copy().inverse()},add:function(t,e){return t.copy().add(e)},subtract:function(t,e){return t.copy().subtract(e)},multiply:function(t,e){return t.copy().multiply(e)},multVec:function(t,e){return t.copy().multVec(e)},divide:function(t,e){return t.copy().divide(e)},divVec:function(t,e){return t.copy().divVec(e)},normalize:function(t){return t.copy().normalize()},dot:function(t,e){return t.dot(e)},magnitude:function(t){return t.magnitude()},distance:function(t,e){return t.distance(e)},lerp:function(t,e,i){return t.copy().lerp(e,i)},abs:function(t){return t.copy().abs()},min:function(t,e){return this.prototype.min.apply(t.copy(),arguments)},max:function(t,e){return this.prototype.max.apply(t.copy(),arguments)}}),e})),define("standard/Math/Numbers/Quaternion",["standard/Math/Numbers/Vector3","standard/Math/Algorithm"],(function(t,i){"use strict";function n(t,e,i,n){this.x=t,this.y=e,this.z=i,this.w=n}n.prototype={constructor:n,length:4,[Symbol.iterator]:function*(){yield this.x,yield this.y,yield this.z,yield this.w},copy:function(){const t=Object.create(n.prototype);return t.x=this.x,t.y=this.y,t.z=this.z,t.w=this.w,t},assign:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this},set:function(t,e,i,n){return this.x=t,this.y=e,this.z=i,this.w=n,this},setMatrix:function(t){let e;e=t[0]>t[4]?t[0]>t[8]?0:2:t[4]>t[8]?1:2;const i=t[0]+t[4]+t[8];if(i>t[3*e+e]){this[3]=Math.sqrt(i+1)/2;const e=4*this[3];this[0]=(t[5]-t[7])/e,this[1]=(t[6]-t[2])/e,this[2]=(t[1]-t[3])/e}else{const i=(e+1)%3,n=(e+2)%3;this[e]=Math.sqrt(t[3*e+e]-t[3*i+i]-t[3*n+n]+1)/2;const r=4*this[e];this[i]=(t[3*e+i]+t[3*i+e])/r,this[n]=(t[3*e+n]+t[3*n+e])/r,this[3]=(t[3*i+n]-t[3*n+i])/r}return this},getMatrix:function(t){const e=this.x,i=this.y,n=this.z,r=this.w,s=e*e,o=e*i,a=i*i,u=i*n,l=n*e,c=n*n,h=r*e,d=r*i,p=r*n;return t[0]=1-2*(a+c),t[1]=2*(o+p),t[2]=2*(l-d),t[3]=2*(o-p),t[4]=1-2*(c+s),t[5]=2*(u+h),t[6]=2*(l+d),t[7]=2*(u-h),t[8]=1-2*(a+s),t},isReal:function(){return!(this.x||this.y||this.z)},isImag:function(){return!this.w},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},inverse:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},add:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this},multiply:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},multLeft:function(t){const e=this.x,i=this.y,n=this.z,r=this.w,s=t.x,o=t.y,a=t.z,u=t.w;return this.x=r*s+e*u+i*a-n*o,this.y=r*o+i*u+n*s-e*a,this.z=r*a+n*u+e*o-i*s,this.w=r*u-e*s-i*o-n*a,this},multRight:function(t){const e=this.x,i=this.y,n=this.z,r=this.w,s=t.x,o=t.y,a=t.z,u=t.w;return this.x=u*e+s*r+o*n-a*i,this.y=u*i+o*r+a*e-s*n,this.z=u*n+a*r+s*i-o*e,this.w=u*r-s*e-o*i-a*n,this},divide:function(t){return this.x/=t,this.y/=t,this.z/=t,this.w/=t,this},multVecQuat:function(t){const e=this.x,i=this.y,n=this.z,r=this.w,s=t.x,o=t.y,a=t.z,u=r*r-e*e-i*i-n*n,l=2*(s*e+o*i+a*n),c=2*r;return t.x=u*s+l*e+c*(i*a-n*o),t.y=u*o+l*i+c*(n*s-e*a),t.z=u*a+l*n+c*(e*o-i*s),t},multQuatVec:function(t){const e=this.x,i=this.y,n=this.z,r=this.w,s=t.x,o=t.y,a=t.z,u=r*r-e*e-i*i-n*n,l=2*(s*e+o*i+a*n),c=2*r;return t.x=u*s+l*e-c*(i*a-n*o),t.y=u*o+l*i-c*(n*s-e*a),t.z=u*a+l*n-c*(e*o-i*s),t},normalize:function(){let t=Math.hypot(this.x,this.y,this.z,this.w);return t&&(t=1/t,this.x*=t,this.y*=t,this.z*=t,this.w*=t),this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},norm:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},magnitude:function(){return Math.hypot(this.x,this.y,this.z,this.w)},pow:function(t){if(t instanceof n)return this.assign(e.assign(t).multRight(this.log()).exp());if(this.isReal())return this.set(0,0,0,Math.pow(this.w,t));const i=this.magnitude(),r=Math.acos(this.w/i),s=this.imag.magnitude(),o=Math.pow(i,t),a=t*r,u=o/s*Math.sin(a);return this.x*=u,this.y*=u,this.z*=u,this.w=o*Math.cos(a),this},log:function(){if(this.isReal())return this.w>0?this.set(0,0,0,Math.log(this.w)):this.set(Math.PI,0,0,Math.log(-this.w));const t=this.magnitude(),e=this.imag.normalize().multiply(Math.acos(this.w/t)),i=Math.log(t);return this.x=e.x,this.y=e.y,this.z=e.z,this.w=i,this},exp:function(){if(this.isReal())return this.set(0,0,0,Math.exp(this.w));const t=this.imag,e=t.magnitude(),i=Math.exp(this.w),n=i*Math.cos(e),r=t.multiply(i*Math.sin(e)/e);return this.x=r.x,this.y=r.y,this.z=r.z,this.w=n,this},slerp:function(t,e){return i.slerp(this,r.assign(t),e)},squad:function(t,e,n,a){return i.slerp(i.slerp(this,r.assign(n),a),i.slerp(s.assign(t),o.assign(e),a),2*a*(1-a))},toString:function(){return this.x+" "+this.y+" "+this.z+" "+this.w}},Object.defineProperty(n.prototype,"0",{get:function(){return this.x},set:function(t){this.x=t},enumerable:!1,configurable:!1}),Object.defineProperty(n.prototype,"1",{get:function(){return this.y},set:function(t){this.y=t},enumerable:!1,configurable:!1}),Object.defineProperty(n.prototype,"2",{get:function(){return this.z},set:function(t){this.z=t},enumerable:!1,configurable:!1}),Object.defineProperty(n.prototype,"3",{get:function(){return this.w},set:function(t){this.w=t},enumerable:!1,configurable:!1}),Object.defineProperty(n.prototype,"real",{get:function(){return this.w},enumerable:!1,configurable:!1}),Object.defineProperty(n.prototype,"imag",{get:function(){const e=new t(0,0,0);return function(){return e.set(this.x,this.y,this.z)}}(),enumerable:!1,configurable:!1}),Object.assign(n,{negate:function(t){return t.copy().negate()},inverse:function(t){return t.copy().inverse()},add:function(t,e){return t.copy().add(e)},subtract:function(t,e){return t.copy().subtract(e)},multiply:function(t,e){return t.copy().multiply(e)},multLeft:function(t,e){return t.copy().multLeft(e)},multRight:function(t,e){return t.copy().multRight(e)},divide:function(t,e){return t.copy().divide(e)},normalize:function(t){return t.copy().normalize()},slerp:function(t,e,i){return t.copy().slerp(e,i)},squad:function(t,e,i,n,r){return t.copy().squad(e,i,n,r)},spline:function(t,e,i){return a.assign(t),u.assign(e),l.assign(i),a.dot(u)<0&&a.negate(),l.dot(u)<0&&l.negate(),c.assign(u).inverse(),u.multRight(r.assign(c).multRight(a).log().add(s.assign(c).multRight(l).log()).divide(-4).exp()).normalize().copy()}});const r=new n(0,0,0,1),s=new n(0,0,0,1),o=new n(0,0,0,1),a=new n(0,0,0,1),u=new n(0,0,0,1),l=new n(0,0,0,1),c=new n(0,0,0,1);return n})),define("standard/Math/Numbers/Rotation4",["standard/Math/Numbers/Quaternion","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Algorithm"],(function(t,e,i,n){"use strict";const r=Symbol(),s=Symbol(),o=Symbol(),a=Symbol();function u(i,n,u,l){switch(this[r]=0,this[s]=0,this[o]=1,this[a]=0,arguments.length){case 0:return void(this.value=new t(0,0,0,1));case 1:return this.value=arguments[0],void this.update();case 2:{const i=arguments[0],n=arguments[1];return this.value=new t(0,0,0,1),n instanceof e?this.setFromToVec(i,n):void this.set(i.x,i.y,i.z,n)}case 4:return this.value=new t(0,0,0,1),void this.set(i,n,u,l)}}u.prototype={constructor:u,length:4,[Symbol.iterator]:function*(){yield this[r],yield this[s],yield this[o],yield this[a]},update:function(){const t=this.get();return this[r]=t.x,this[s]=t.y,this[o]=t.z,this[a]=t.w,this},copy:function(){const t=Object.create(u.prototype);return t[r]=this[r],t[s]=this[s],t[o]=this[o],t[a]=this[a],t.value=this.value.copy(),t},assign:function(t){return this[r]=t[r],this[s]=t[s],this[o]=t[o],this[a]=t[a],this.value.assign(t.value),this},set:function(t,e,i,u){this[r]=t,this[s]=e,this[o]=i,this[a]=u;const l=Math.hypot(t,e,i);if(0===l)return this.value.set(0,0,0,1),this;const c=n.interval(u/2,0,Math.PI),h=Math.sin(c)/l;return this.value.set(t*h,e*h,i*h,Math.cos(c)),this},get:function(){const t=new i(0,0,0,0);return function(){const e=this.value;if(Math.abs(e.w)>1)return i.zAxis;{const n=2*Math.acos(e.w),r=Math.sin(n/2);if(0===r)return i.zAxis;{const i=e.imag.divide(r);return t.set(i.x,i.y,i.z,n)}}}}(),setAxisAngle:function(t,e){return this.set(t.x,t.y,t.z,e)},setFromToVec:function(){const t=new e(0,0,0),i=new e(0,0,0),r=new e(0,0,0),s=new e(0,0,0);return function(o,a){t.assign(o).normalize(),i.assign(a).normalize();const u=n.clamp(t.dot(i),-1,1),l=r.assign(t).cross(i).normalize();return 0===l.magnitude()?u>0?this.value.set(0,0,0,1):(s.assign(t).cross(e.xAxis),0===s.norm()&&s.assign(t).cross(e.yAxis),s.normalize(),this.value.set(s.x,s.y,s.z,0)):(l.multiply(Math.sqrt(Math.abs(1-u)/2)),this.value.set(l.x,l.y,l.z,Math.sqrt(Math.abs(1+u)/2))),this.update(),this}}(),setAxis:function(t){this.set(t.x,t.y,t.z,this[a])},getAxis:function(){const t=new e(0,0,0);return function(){return t.set(this[r],this[s],this[o])}}(),setMatrix:function(t){return this.value.setMatrix(t).normalize(),this.update(),this},getMatrix:function(t){return this.value.getMatrix(t)},equals:function(t){return this.value.equals(t.value)},inverse:function(){return this.value.inverse(),this.update(),this},multLeft:function(t){return this.value.multLeft(t.value).normalize(),this.update(),this},multRight:function(t){return this.value.multRight(t.value).normalize(),this.update(),this},multVecRot:function(t){return this.value.multVecQuat(t)},multRotVec:function(t){return this.value.multQuatVec(t)},normalize:function(){return this.value.normalize(),this.update(),this},pow:function(t){return this.value.pow(t),this.update(),this},slerp:function(t,e){return this.value.slerp(t.value,e),this.update(),this},squad:function(t,e,i,n){return this.value.squad(t.value,e.value,i.value,n),this.update(),this},toString:function(){return this[r]+" "+this[s]+" "+this[o]+" "+this[a]}};const l={get:function(){return this[r]},set:function(t){this[r]=t,this.set(t,this[s],this[o],this[a])},enumerable:!0,configurable:!1},c={get:function(){return this[s]},set:function(t){this[s]=t,this.set(this[r],t,this[o],this[a])},enumerable:!0,configurable:!1},h={get:function(){return this[o]},set:function(t){this[o]=t,this.set(this[r],this[s],t,this[a])},enumerable:!0,configurable:!1},d={get:function(){return this[a]},set:function(t){this[a]=t,this.set(this[r],this[s],this[o],t)},enumerable:!0,configurable:!1};return Object.defineProperty(u.prototype,"x",l),Object.defineProperty(u.prototype,"y",c),Object.defineProperty(u.prototype,"z",h),Object.defineProperty(u.prototype,"angle",d),l.enumerable=!1,c.enumerable=!1,h.enumerable=!1,d.enumerable=!1,Object.defineProperty(u.prototype,"0",l),Object.defineProperty(u.prototype,"1",c),Object.defineProperty(u.prototype,"2",h),Object.defineProperty(u.prototype,"3",d),Object.assign(u,{Identity:new u,inverse:function(t){return t.copy().inverse()},multRight:function(t,e){return t.copy().multRight(e)},normalize:function(t){return t.copy().normalize()},slerp:function(t,e,i){return t.copy().slerp(e,i)},squad:function(t,e,i,n,r){return t.copy().squad(e,i,n,r)},spline:function(e,i,n){const r=Object.create(this.prototype);return r.value=t.spline(e.value,i.value,n.value),r.update(),r}}),u})),define("standard/Math/Numbers/Matrix4",["standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix3","standard/Math/Algorithms/eigendecomposition"],(function(t,e,i,n,r){"use strict";function s(){arguments.length?(this[0]=arguments[0],this[1]=arguments[1],this[2]=arguments[2],this[3]=arguments[3],this[4]=arguments[4],this[5]=arguments[5],this[6]=arguments[6],this[7]=arguments[7],this[8]=arguments[8],this[9]=arguments[9],this[10]=arguments[10],this[11]=arguments[11],this[12]=arguments[12],this[13]=arguments[13],this[14]=arguments[14],this[15]=arguments[15]):this.identity()}s.prototype={constructor:s,order:4,length:16,[Symbol.iterator]:function*(){const t=this.length;for(let e=0;e<t;++e)yield this[e]},copy:function(){const t=Object.create(s.prototype);return t[0]=this[0],t[1]=this[1],t[2]=this[2],t[3]=this[3],t[4]=this[4],t[5]=this[5],t[6]=this[6],t[7]=this[7],t[8]=this[8],t[9]=this[9],t[10]=this[10],t[11]=this[11],t[12]=this[12],t[13]=this[13],t[14]=this[14],t[15]=this[15],t},assign:function(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this},equals:function(t){return this[0]===t[0]&&this[1]===t[1]&&this[2]===t[2]&&this[3]===t[3]&&this[4]===t[4]&&this[5]===t[5]&&this[6]===t[6]&&this[7]===t[7]&&this[8]===t[8]&&this[9]===t[9]&&this[10]===t[10]&&this[11]===t[11]&&this[12]===t[12]&&this[13]===t[13]&&this[14]===t[14]&&this[15]===t[15]},set1:function(t,e,i){return this[t*this.order+e]=i,this},get1:function(t,e){return this[t*this.order+e]},set:function(){const e=new i,n=new t(0,0,0);return function(r,s,o,a,u){switch(arguments.length){case 0:this.identity();break;case 1:null===r&&(r=t.Zero),this.identity(),this.translate(r);break;case 2:null===r&&(r=t.Zero),null===s&&(s=i.Identity),this.identity(),this.translate(r),s.equals(i.Identity)||this.rotate(s);break;case 3:null===r&&(r=t.Zero),null===s&&(s=i.Identity),null===o&&(o=t.One),this.identity(),this.translate(r),s.equals(i.Identity)||this.rotate(s),o.equals(t.One)||this.scale(o);break;case 4:if(null===r&&(r=t.Zero),null===s&&(s=i.Identity),null===o&&(o=t.One),null===a&&(a=i.Identity),this.identity(),this.translate(r),s.equals(i.Identity)||this.rotate(s),!o.equals(t.One)){!a.equals(i.Identity)?(this.rotate(a),this.scale(o),this.rotate(e.assign(a).inverse())):this.scale(o)}break;case 5:{null===r&&(r=t.Zero),null===s&&(s=i.Identity),null===o&&(o=t.One),null===a&&(a=i.Identity),null===u&&(u=t.Zero),this.identity(),this.translate(r);const l=!u.equals(t.Zero);l&&this.translate(u),s.equals(i.Identity)||this.rotate(s),o.equals(t.One)||(a.equals(i.Identity)?this.scale(o):(this.rotate(a),this.scale(o),this.rotate(e.assign(a).inverse()))),l&&this.translate(n.assign(u).negate());break}case 16:this[0]=arguments[0],this[1]=arguments[1],this[2]=arguments[2],this[3]=arguments[3],this[4]=arguments[4],this[5]=arguments[5],this[6]=arguments[6],this[7]=arguments[7],this[8]=arguments[8],this[9]=arguments[9],this[10]=arguments[10],this[11]=arguments[11],this[12]=arguments[12],this[13]=arguments[13],this[14]=arguments[14],this[15]=arguments[15]}return this}}(),get:function(){const e=new t(0,0,0),r=new i,s=new t(0,0,0),a=new i,u=new t(0,0,0),l=new n,c=new n,h=new t(0,0,0);return function(t,i,n,d,p){switch(null===t&&(t=e),null===i&&(i=r),null===n&&(n=s),null===d&&(d=a),null===p&&(p=u),arguments.length){case 1:t.set(this[12],this[13],this[14]);break;case 2:this.factor(t,l,s,c),i.setMatrix(l);break;case 3:this.factor(t,l,n,c),i.setMatrix(l);break;case 4:this.factor(t,l,n,c),i.setMatrix(l),d.setMatrix(c);break;case 5:o.set(h.assign(p).negate()),o.multLeft(this),o.translate(p),o.get(t,i,n,d)}}}(),setRotation:function(t){return this.setQuaternion(t.value)},setQuaternion:function(t){const e=t.x,i=t.y,n=t.z,r=t.w,s=i*i,o=n*n,a=e*i,u=n*r,l=n*e,c=i*r,h=e*e,d=i*n,p=e*r;return this[0]=1-2*(s+o),this[1]=2*(a+u),this[2]=2*(l-c),this[3]=0,this[4]=2*(a-u),this[5]=1-2*(o+h),this[6]=2*(d+p),this[7]=0,this[8]=2*(l+c),this[9]=2*(d-p),this[10]=1-2*(s+h),this[11]=0,this[12]=0,this[13]=0,this[14]=0,this[15]=1,this},factor:function(){const t=new n,e=new n,i=new n,s={values:[],vectors:[[],[],[]]};return function(n,o,a,u){n.set(this[12],this[13],this[14]);const l=this.submatrix,c=l.determinant()<0?-1:1;i.assign(l).transpose().multLeft(l);const h=r(i,s);u.set(h.vectors[0][0],h.vectors[1][0],h.vectors[2][0],h.vectors[0][1],h.vectors[1][1],h.vectors[2][1],h.vectors[0][2],h.vectors[1][2],h.vectors[2][2]),a.x=c*Math.sqrt(h.values[0]),a.y=c*Math.sqrt(h.values[1]),a.z=c*Math.sqrt(h.values[2]),t[0]=1/a.x,t[4]=1/a.y,t[8]=1/a.z,o.assign(e.assign(u).transpose().multRight(t).multRight(u).multRight(l))}}(),determinant3:function(){const t=this[0],e=this[1],i=this[2],n=this[4],r=this[5],s=this[6],o=this[8],a=this[9],u=this[10];return t*(r*u-s*a)-e*(n*u-s*o)+i*(n*a-r*o)},determinant:function(){const t=this[0],e=this[1],i=this[2],n=this[3],r=this[4],s=this[5],o=this[6],a=this[7],u=this[8],l=this[9],c=this[10],h=this[11],d=this[12],p=this[13],f=this[14],g=this[15],m=c*g,_=f*h,y=o*g,x=f*a,w=o*h,b=c*a,v=i*g,S=f*n,T=i*h,C=c*n,O=i*a,N=o*n;return t*(m*s+x*l+w*p-_*s-y*l-b*p)+r*(_*e+v*l+C*p-m*e-S*l-T*p)+u*(y*e+S*s+O*p-x*e-v*s-N*p)+d*(b*e+T*s+N*l-w*e-C*s-O*l)},transpose:function(){let t;return t=this[1],this[1]=this[4],this[4]=t,t=this[2],this[2]=this[8],this[8]=t,t=this[3],this[3]=this[12],this[12]=t,t=this[6],this[6]=this[9],this[9]=t,t=this[7],this[7]=this[13],this[13]=t,t=this[11],this[11]=this[14],this[14]=t,this},inverse:function(){const t=this[0],e=this[1],i=this[2],n=this[3],r=this[4],s=this[5],o=this[6],a=this[7],u=this[8],l=this[9],c=this[10],h=this[11],d=this[12],p=this[13],f=this[14],g=this[15],m=c*g,_=f*h,y=o*g,x=f*a,w=o*h,b=c*a,v=i*g,S=f*n,T=i*h,C=c*n,O=i*a,N=o*n,F=u*p,E=d*l,D=r*p,M=d*s,I=r*l,V=u*s,B=t*p,A=d*e,R=t*l,P=u*e,L=t*s,U=r*e,k=m*s+x*l+w*p-(_*s+y*l+b*p),X=_*e+v*l+C*p-(m*e+S*l+T*p),z=y*e+S*s+O*p-(x*e+v*s+N*p),j=b*e+T*s+N*l-(w*e+C*s+O*l);let G=t*k+r*X+u*z+d*j;return G=1/G,this[0]=G*k,this[1]=G*X,this[2]=G*z,this[3]=G*j,this[4]=G*(_*r+y*u+b*d-m*r-x*u-w*d),this[5]=G*(m*t+S*u+T*d-_*t-v*u-C*d),this[6]=G*(x*t+v*r+N*d-y*t-S*r-O*d),this[7]=G*(w*t+C*r+O*u-b*t-T*r-N*u),this[8]=G*(F*a+M*h+I*g-E*a-D*h-V*g),this[9]=G*(E*n+B*h+P*g-F*n-A*h-R*g),this[10]=G*(D*n+A*a+L*g-M*n-B*a-U*g),this[11]=G*(V*n+R*a+U*h-I*n-P*a-L*h),this[12]=G*(D*c+V*f+E*o-I*f-F*o-M*c),this[13]=G*(R*f+F*i+A*c-B*c-P*f-E*i),this[14]=G*(B*o+U*f+M*i-L*f-D*i-A*o),this[15]=G*(L*c+I*i+P*o-R*o-U*c-V*i),this},multLeft:function(t){const e=this[0],i=this[1],n=this[2],r=this[3],s=this[4],o=this[5],a=this[6],u=this[7],l=this[8],c=this[9],h=this[10],d=this[11],p=this[12],f=this[13],g=this[14],m=this[15],_=t[0],y=t[1],x=t[2],w=t[3],b=t[4],v=t[5],S=t[6],T=t[7],C=t[8],O=t[9],N=t[10],F=t[11],E=t[12],D=t[13],M=t[14],I=t[15];return this[0]=e*_+s*y+l*x+p*w,this[1]=i*_+o*y+c*x+f*w,this[2]=n*_+a*y+h*x+g*w,this[3]=r*_+u*y+d*x+m*w,this[4]=e*b+s*v+l*S+p*T,this[5]=i*b+o*v+c*S+f*T,this[6]=n*b+a*v+h*S+g*T,this[7]=r*b+u*v+d*S+m*T,this[8]=e*C+s*O+l*N+p*F,this[9]=i*C+o*O+c*N+f*F,this[10]=n*C+a*O+h*N+g*F,this[11]=r*C+u*O+d*N+m*F,this[12]=e*E+s*D+l*M+p*I,this[13]=i*E+o*D+c*M+f*I,this[14]=n*E+a*D+h*M+g*I,this[15]=r*E+u*D+d*M+m*I,this},multRight:function(t){const e=this[0],i=this[1],n=this[2],r=this[3],s=this[4],o=this[5],a=this[6],u=this[7],l=this[8],c=this[9],h=this[10],d=this[11],p=this[12],f=this[13],g=this[14],m=this[15],_=t[0],y=t[1],x=t[2],w=t[3],b=t[4],v=t[5],S=t[6],T=t[7],C=t[8],O=t[9],N=t[10],F=t[11],E=t[12],D=t[13],M=t[14],I=t[15];return this[0]=e*_+i*b+n*C+r*E,this[1]=e*y+i*v+n*O+r*D,this[2]=e*x+i*S+n*N+r*M,this[3]=e*w+i*T+n*F+r*I,this[4]=s*_+o*b+a*C+u*E,this[5]=s*y+o*v+a*O+u*D,this[6]=s*x+o*S+a*N+u*M,this[7]=s*w+o*T+a*F+u*I,this[8]=l*_+c*b+h*C+d*E,this[9]=l*y+c*v+h*O+d*D,this[10]=l*x+c*S+h*N+d*M,this[11]=l*w+c*T+h*F+d*I,this[12]=p*_+f*b+g*C+m*E,this[13]=p*y+f*v+g*O+m*D,this[14]=p*x+f*S+g*N+m*M,this[15]=p*w+f*T+g*F+m*I,this},multVecMatrix:function(t){if(3===t.length){const e=t.x,i=t.y,n=t.z,r=1/(e*this[3]+i*this[7]+n*this[11]+this[15]);return t.x=(e*this[0]+i*this[4]+n*this[8]+this[12])*r,t.y=(e*this[1]+i*this[5]+n*this[9]+this[13])*r,t.z=(e*this[2]+i*this[6]+n*this[10]+this[14])*r,t}const e=t.x,i=t.y,n=t.z,r=t.w;return t.x=e*this[0]+i*this[4]+n*this[8]+r*this[12],t.y=e*this[1]+i*this[5]+n*this[9]+r*this[13],t.z=e*this[2]+i*this[6]+n*this[10]+r*this[14],t.w=e*this[3]+i*this[7]+n*this[11]+r*this[15],t},multMatrixVec:function(t){if(3===t.length){const e=t.x,i=t.y,n=t.z,r=1/(e*this[12]+i*this[13]+n*this[14]+this[15]);return t.x=(e*this[0]+i*this[1]+n*this[2]+this[3])*r,t.y=(e*this[4]+i*this[5]+n*this[6]+this[7])*r,t.z=(e*this[8]+i*this[9]+n*this[10]+this[11])*r,t}const e=t.x,i=t.y,n=t.z,r=t.w;return t.x=e*this[0]+i*this[1]+n*this[2]+r*this[3],t.y=e*this[4]+i*this[5]+n*this[6]+r*this[7],t.z=e*this[8]+i*this[9]+n*this[10]+r*this[11],t.w=e*this[12]+i*this[13]+n*this[14]+r*this[15],t},multDirMatrix:function(t){const e=t.x,i=t.y,n=t.z;return t.x=e*this[0]+i*this[4]+n*this[8],t.y=e*this[1]+i*this[5]+n*this[9],t.z=e*this[2]+i*this[6]+n*this[10],t},multMatrixDir:function(t){const e=t.x,i=t.y,n=t.z;return t.x=e*this[0]+i*this[1]+n*this[2],t.y=e*this[4]+i*this[5]+n*this[6],t.z=e*this[8]+i*this[9]+n*this[10],t},identity:function(){this[0]=1,this[1]=0,this[2]=0,this[3]=0,this[4]=0,this[5]=1,this[6]=0,this[7]=0,this[8]=0,this[9]=0,this[10]=1,this[11]=0,this[12]=0,this[13]=0,this[14]=0,this[15]=1},translate:function(t){const e=t.x,i=t.y,n=t.z;return this[12]+=this[0]*e+this[4]*i+this[8]*n,this[13]+=this[1]*e+this[5]*i+this[9]*n,this[14]+=this[2]*e+this[6]*i+this[10]*n,this},rotate:function(t){return this.multLeft(o.setQuaternion(t.value)),this},scale:function(t){const e=t.x,i=t.y,n=t.z;return this[0]*=e,this[4]*=i,this[8]*=n,this[1]*=e,this[5]*=i,this[9]*=n,this[2]*=e,this[6]*=i,this[10]*=n,this},getDepth:function(t){const e=t.x,i=t.y,n=t.z,r=1/(e*this[3]+i*this[7]+n*this[11]+this[15]);return(e*this[2]+i*this[6]+n*this[10]+this[14])*r},toString:function(){return this[0]+" "+this[1]+" "+this[2]+" "+this[3]+" "+this[4]+" "+this[5]+" "+this[6]+" "+this[7]+" "+this[8]+" "+this[9]+" "+this[10]+" "+this[11]+" "+this[12]+" "+this[13]+" "+this[14]+" "+this[15]}},Object.defineProperty(s.prototype,"x",{get:function(){const t=new e(0,0,0,0);return function(){return t.set(this[0],this[1],this[2],this[3])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(s.prototype,"y",{get:function(){const t=new e(0,0,0,0);return function(){return t.set(this[4],this[5],this[6],this[7])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(s.prototype,"z",{get:function(){const t=new e(0,0,0,0);return function(){return t.set(this[8],this[9],this[10],this[11])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(s.prototype,"w",{get:function(){const t=new e(0,0,0,0);return function(){return t.set(this[12],this[13],this[14],this[15])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(s.prototype,"xAxis",{get:function(){const e=new t(0,0,0);return function(){return e.set(this[0],this[1],this[2])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(s.prototype,"yAxis",{get:function(){const e=new t(0,0,0);return function(){return e.set(this[4],this[5],this[6])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(s.prototype,"zAxis",{get:function(){const e=new t(0,0,0);return function(){return e.set(this[8],this[9],this[10])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(s.prototype,"origin",{get:function(){const e=new t(0,0,0);return function(){return e.set(this[12],this[13],this[14])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(s.prototype,"submatrix",{get:function(){const t=new n;return function(){return t[0]=this[0],t[1]=this[1],t[2]=this[2],t[3]=this[4],t[4]=this[5],t[5]=this[6],t[6]=this[8],t[7]=this[9],t[8]=this[10],t}}(),enumerable:!1,configurable:!1}),Object.assign(s,{Identity:new s,Rotation:function(t){return Object.create(this.prototype).setQuaternion(t.value)},Quaternion:function(t){return Object.create(this.prototype).setQuaternion(t)},Matrix3:function(t){return new s(t[0],t[1],t[2],0,t[3],t[4],t[5],0,t[6],t[7],t[8],0,0,0,0,1)},transpose:function(t){return t.copy().transpose()},inverse:function(t){return t.copy().inverse()},multLeft:function(t,e){return t.copy().multLeft(e)},multRight:function(t,e){return t.copy().multRight(e)}});const o=new s;return s})),define("x_ite/Fields/SFMatrix4",["x_ite/Base/X3DField","x_ite/Fields/SFMatrixPrototypeTemplate","x_ite/Fields/SFVec3","x_ite/Base/X3DConstants","standard/Math/Numbers/Matrix4"],(function(t,e,i,n,r){"use strict";function s(i,n,s,o){function a(e,i,n,s,o,a,u,l,c,h,d,p,f,g,m,_){switch(arguments.length){case 0:return t.call(this,new r);case 1:return t.call(this,arguments[0]);case 16:return t.call(this,new r(+e,+i,+n,+s,+o,+a,+u,+l,+c,+h,+d,+p,+f,+g,+m,+_))}throw new Error("Invalid arguments.")}a.prototype=Object.assign(Object.create(t.prototype),e(r,s,o),{constructor:a,getTypeName:function(){return i},getType:function(){return n}});for(const t of Reflect.ownKeys(a.prototype))Object.defineProperty(a.prototype,t,{enumerable:!1});function u(t){Object.defineProperty(a.prototype,t,{get:function(){return this.getValue()[t]},set:function(e){this.getValue()[t]=e,this.addEvent()},enumerable:!0,configurable:!1})}for(let t=0,e=r.prototype.length;t<e;++t)u(t);return a}return{SFMatrix4d:s("SFMatrix4d",n.SFMatrix4d,i.SFVec3d,!0),SFMatrix4f:s("SFMatrix4f",n.SFMatrix4f,i.SFVec3f,!1),VrmlMatrix:s("VrmlMatrix",n.VrmlMatrix,i.SFVec3f,!1)}})),define("x_ite/Fields/SFNodeCache",["x_ite/Fields/SFNode"],(function(){"use strict";const t=new WeakMap;function e(){}return e.prototype={get:function(e){const i=t.get(e);if(i)return i;{const i=new(require("x_ite/Fields/SFNode"))(e);return t.set(e,i),i}}},new e})),define("x_ite/Fields/SFNode",["x_ite/Base/X3DField","x_ite/Base/X3DConstants","x_ite/InputOutput/Generator","x_ite/Fields/SFNodeCache"],(function(t,e,i,n){"use strict";const r=Symbol(),s=Symbol(),o=Symbol(),a={get:function(t,i){try{const n=t[i];if(void 0!==n)return n;const r=t.getValue().getField(i);if(r.getAccessType()===e.inputOnly)return;return r.valueOf()}catch(t){return}},set:function(t,i,n){if(i in t)return t[i]=n,!0;try{const r=t.getValue().getField(i);return r.getAccessType()!==e.outputOnly&&r.setValue(n),!0}catch(e){return console.error(t,i,e),!1}},has:function(t,e){try{return Boolean(t.getValue().getField(e))}catch(i){return e in t}},ownKeys:function(t){const e=t.getValue(),i=[];if(e)for(const t of e.getFieldDefinitions())i.push(t.name);return i},getOwnPropertyDescriptor:function(t,i){const n=t.getValue();if(n){const r=n.getFieldDefinitions().get(i);if(r)return{value:this.get(t,i),writable:r.accessType!==e.outputOnly,enumerable:!0,configurable:!0}}}};function u(e){const i=new Proxy(this,a);return this[r]=this,this[s]=i,e?(e.addParent(i),t.call(this,e)):t.call(this,null),i}u.prototype=Object.assign(Object.create(t.prototype),{constructor:u,[r]:null,[s]:null,[o]:0,copy:function(t){const e=this[r].getValue();return e?new u(t?e.copy(t):e):new u},getTypeName:function(){return"SFNode"},getType:function(){return e.SFNode},equals:function(t){const e=this[r];return t?e.getValue()===t.getValue():null===e.getValue()},isDefaultValue:function(){return null===this[r].getValue()},set:function(e){const i=this[r],n=i.getValue();n&&(n.removeCloneCount(i[o]),n.removeParent(i[s])),e?(e.addParent(i[s]),e.addCloneCount(i[o]),t.prototype.set.call(i,e)):t.prototype.set.call(i,null)},getNodeTypeName:function(){const t=this[r].getValue();if(t)return t.getTypeName();throw new Error("SFNode.getNodeTypeName: node is null.")},getNodeName:function(){const t=this[r].getValue();if(t)return t.getName();throw new Error("SFNode.getNodeName: node is null.")},getNodeDisplayName:function(){const t=this[r].getValue();if(t)return t.getDisplayName();throw new Error("SFNode.getNodeDisplayName: node is null.")},getNodeType:function(){const t=this[r].getValue();if(t)return t.getType().slice();throw new Error("SFNode.getNodeType: node is null.")},getFieldDefinitions:function(){const t=this[r].getValue();if(t)return t.getFieldDefinitions();throw new Error("SFNode.getFieldDefinitions: node is null.")},addFieldCallback:function(e,i,n){const s=this[r];switch(arguments.length){case 2:return t.prototype.addFieldCallback.apply(s,arguments);case 3:{const t=s.getValue();if(t)return t.getField(e).addFieldCallback(i,n);throw new Error("SFNode.addFieldCallback: node is null.")}}},removeFieldCallback:function(e,i){const n=this[r];switch(arguments.length){case 1:return t.prototype.removeFieldCallback.apply(n,arguments);case 2:{const t=n.getValue();if(t)return t.getField(e).removeFieldCallback(i);throw new Error("SFNode.removeFieldCallback: node is null.")}}},addCloneCount:function(t){const e=this[r],i=e.getValue();e[o]+=t,i&&i.addCloneCount(t)},removeCloneCount:function(t){const e=this[r],i=e.getValue();e[o]-=t,i&&i.removeCloneCount(t)},valueOf:function(){const t=this[r].getValue();return t?n.get(t):null},toStream:function(t){const e=this[r].getValue();e?e.toStream(t):t.string+="NULL"},toVRMLStream:function(t){const e=this[r].getValue();e?e.toVRMLStream(t):t.string+="NULL"},toXMLString:function(){const t=this[r],e={string:""},n=i.Get(e),s=t.getValue();return n.PushExecutionContext(s.getExecutionContext()),t.toXMLStream(e),n.PopExecutionContext(),e.string},toXMLStream:function(t){const e=this[r].getValue();e?e.toXMLStream(t):t.string+="\x3c!-- NULL --\x3e"},dispose:function(){const e=this[r],i=e.getValue();i&&i.dispose(),t.prototype.dispose.call(e)}});for(const t of Reflect.ownKeys(u.prototype))Object.defineProperty(u.prototype,t,{enumerable:!1});return u})),define("x_ite/Fields/SFRotation",["x_ite/Fields/SFVec3","x_ite/Base/X3DField","x_ite/Base/X3DConstants","x_ite/InputOutput/Generator","standard/Math/Numbers/Rotation4"],(function(t,e,i,n,r){"use strict";const s=t.SFVec3f;function o(t,i,n,o){switch(arguments.length){case 0:return e.call(this,new r);case 1:return e.call(this,arguments[0]);case 2:return arguments[1]instanceof s?e.call(this,new r(arguments[0].getValue(),arguments[1].getValue())):e.call(this,new r(arguments[0].getValue(),+arguments[1]));case 4:return e.call(this,new r(+t,+i,+n,+o))}throw new Error("Invalid arguments.")}o.prototype=Object.assign(Object.create(e.prototype),{constructor:o,[Symbol.iterator]:function*(){yield*this.getValue()},copy:function(){return new o(this.getValue().copy())},equals:function(t){return this.getValue().equals(t.getValue())},isDefaultValue:function(){return this.getValue().equals(r.Identity)},getTypeName:function(){return"SFRotation"},getType:function(){return i.SFRotation},set:function(t){this.getValue().assign(t)},setAxis:function(t){this.getValue().setAxis(t.getValue()),this.addEvent()},getAxis:function(){return new s(this.getValue().getAxis().copy())},inverse:function(){return new o(r.inverse(this.getValue()))},multiply:function(t){return new o(r.multRight(this.getValue(),t.getValue()))},multVec:function(t){return new s(this.getValue().multVecRot(t.getValue().copy()))},slerp:function(t,e){return new o(r.slerp(this.getValue(),t.getValue(),e))},toStream:function(t){const e=n.Get(t),i=this.getValue();t.string+=e.DoublePrecision(i.x)+" "+e.DoublePrecision(i.y)+" "+e.DoublePrecision(i.z)+" "+e.DoublePrecision(e.ToUnit("angle",i.angle))},toVRMLStream:function(t){this.toStream(t)},toXMLStream:function(t){this.toStream(t)}});for(const t of Reflect.ownKeys(o.prototype))Object.defineProperty(o.prototype,t,{enumerable:!1});const a={get:function(){return this.getValue().x},set:function(t){this.getValue().x=+t,this.addEvent()},enumerable:!0,configurable:!1},u={get:function(){return this.getValue().y},set:function(t){this.getValue().y=+t,this.addEvent()},enumerable:!0,configurable:!1},l={get:function(){return this.getValue().z},set:function(t){this.getValue().z=+t,this.addEvent()},enumerable:!0,configurable:!1},c={get:function(){return this.getValue().angle},set:function(t){this.getValue().angle=+t,this.addEvent()},enumerable:!0,configurable:!1};return Object.defineProperty(o.prototype,"x",a),Object.defineProperty(o.prototype,"y",u),Object.defineProperty(o.prototype,"z",l),Object.defineProperty(o.prototype,"angle",c),a.enumerable=!1,u.enumerable=!1,l.enumerable=!1,c.enumerable=!1,Object.defineProperty(o.prototype,"0",a),Object.defineProperty(o.prototype,"1",u),Object.defineProperty(o.prototype,"2",l),Object.defineProperty(o.prototype,"3",c),o})),define("x_ite/Fields/SFString",["x_ite/Base/X3DField","x_ite/Base/X3DConstants","x_ite/InputOutput/Generator"],(function(t,e,i){"use strict";const n=/\\(.)/g,r=/([\\"])/g;function s(e){return t.call(this,arguments.length?""+e:"")}Object.assign(s,{unescape:function(t){return t.replace(n,"$1")},escape:function(t){return t.replace(r,"\\$1")}}),s.prototype=Object.assign(Object.create(t.prototype),{constructor:s,[Symbol.iterator]:function*(){yield*this.getValue()},copy:function(){return new s(this.getValue())},getTypeName:function(){return"SFString"},getType:function(){return e.SFString},isDefaultValue:function(){return""===this.getValue()},set:function(e){t.prototype.set.call(this,""+e)},valueOf:t.prototype.getValue,toStream:function(t){t.string+='"'+s.escape(this.getValue())+'"'},toVRMLStream:function(t){this.toStream(t)},toXMLStream:function(t){t.string+=i.Get(t).XMLEncode(this.getValue())}});for(const t of Reflect.ownKeys(s.prototype))Object.defineProperty(s.prototype,t,{enumerable:!1});return Object.defineProperty(s.prototype,"length",{get:function(){return this.getValue().length},enumerable:!0,configurable:!1}),s})),define("x_ite/Fields/SFTime",["x_ite/Base/X3DField","x_ite/Base/X3DConstants"],(function(t,e){"use strict";function i(e){return t.call(this,arguments.length?+e:0)}i.prototype=Object.assign(Object.create(t.prototype),{constructor:i,copy:function(){return new i(this.getValue())},getTypeName:function(){return"SFTime"},getType:function(){return e.SFTime},isDefaultValue:function(){return 0===this.getValue()},set:function(e){t.prototype.set.call(this,+e)},valueOf:t.prototype.getValue,toStream:function(t){t.string+=this.getValue()},toVRMLStream:function(t){this.toStream(t)},toXMLStream:function(t){this.toStream(t)}});for(const t of Reflect.ownKeys(i.prototype))Object.defineProperty(i.prototype,t,{enumerable:!1});return i})),define("x_ite/Fields/SFVec4",["x_ite/Base/X3DField","x_ite/Fields/SFVecPrototypeTemplate","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector4"],(function(t,e,i,n){"use strict";function r(i,r,s){function o(e,i,r,s){switch(arguments.length){case 0:return t.call(this,new n(0,0,0,0));case 1:return t.call(this,arguments[0]);case 4:return t.call(this,new n(+e,+i,+r,+s))}throw new Error("Invalid arguments.")}o.prototype=Object.assign(Object.create(t.prototype),e(n,s),{constructor:o,getTypeName:function(){return i},getType:function(){return r}});for(const t of Reflect.ownKeys(o.prototype))Object.defineProperty(o.prototype,t,{enumerable:!1});const a={get:function(){return this.getValue().x},set:function(t){this.getValue().x=+t,this.addEvent()},enumerable:!0,configurable:!1},u={get:function(){return this.getValue().y},set:function(t){this.getValue().y=+t,this.addEvent()},enumerable:!0,configurable:!1},l={get:function(){return this.getValue().z},set:function(t){this.getValue().z=+t,this.addEvent()},enumerable:!0,configurable:!1},c={get:function(){return this.getValue().w},set:function(t){this.getValue().w=+t,this.addEvent()},enumerable:!0,configurable:!1};return Object.defineProperty(o.prototype,"x",a),Object.defineProperty(o.prototype,"y",u),Object.defineProperty(o.prototype,"z",l),Object.defineProperty(o.prototype,"w",c),a.enumerable=!1,u.enumerable=!1,l.enumerable=!1,c.enumerable=!1,Object.defineProperty(o.prototype,"0",a),Object.defineProperty(o.prototype,"1",u),Object.defineProperty(o.prototype,"2",l),Object.defineProperty(o.prototype,"3",c),o}return{SFVec4d:r("SFVec4d",i.SFVec4d,!0),SFVec4f:r("SFVec4f",i.SFVec4f,!1)}})),define("x_ite/Base/X3DArrayField",["x_ite/Base/X3DField"],(function(t){"use strict";function e(e){t.call(this,e)}e.prototype=Object.assign(Object.create(t.prototype),{constructor:e,at:Array.prototype.at,concat:Array.prototype.concat,every:Array.prototype.every,fill:Array.prototype.fill,filter:Array.prototype.filter,find:Array.prototype.find,findIndex:Array.prototype.findIndex,forEach:Array.prototype.forEach,includes:Array.prototype.includes,indexOf:Array.prototype.indexOf,join:Array.prototype.join,keys:function(){return Array(this.length).keys()},lastIndexOf:Array.prototype.lastIndexOf,map:Array.prototype.map,reduce:Array.prototype.reduce,reduceRight:Array.prototype.reduceRight,slice:Array.prototype.slice,some:Array.prototype.some,values:function(){return this[Symbol.iterator]}});for(const t of Reflect.ownKeys(e.prototype))Object.defineProperty(e.prototype,t,{enumerable:!1});return e})),define("x_ite/Base/X3DObjectArrayField",["jquery","x_ite/Base/X3DField","x_ite/Base/X3DArrayField","x_ite/InputOutput/Generator"],(function(t,e,i,n){"use strict";const r=Symbol(),s=Symbol(),o={get:function(t,e){const i=t[e];if(void 0!==i)return i;if("string"==typeof e){const i=t.getValue(),n=+e;return Number.isInteger(n)?(n>=i.length&&t.resize(n+1),i[n].valueOf()):t[e]}},set:function(t,e,i){if(e in t)return t[e]=i,!0;const n=t.getValue(),r=+e;return r>=n.length&&t.resize(r+1),n[r].setValue(i),!0},has:function(t,e){return Number.isInteger(+e)?e<t.getValue().length:e in t},ownKeys:function(t){return Object.keys(t.getValue())},getOwnPropertyDescriptor:function(t,e){if("string"!=typeof e)return;const i=+e;return Number.isInteger(i)&&i<t.getValue().length?Object.getOwnPropertyDescriptor(t.getValue(),e):void 0}};function a(t){const e=new Proxy(this,o);return i.call(this,[]),this[r]=this,this[s]=e,t[0]instanceof Array&&(t=t[0]),a.prototype.push.apply(this,t),e}a.prototype=Object.assign(Object.create(i.prototype),{constructor:a,[r]:null,[s]:null,[Symbol.iterator]:function*(){const t=this[r].getValue();for(const e of t)yield e.valueOf()},getTarget:function(){return this[r]},copy:function(){const t=this[r],e=t.create(),i=t.getValue();return a.prototype.push.apply(e,i),e.setModificationTime(0),e},equals:function(t){const e=this[r].getValue(),i=t.getValue(),n=e.length;if(e===i)return!0;if(n!==i.length)return!1;for(let t=0;t<n;++t)if(!e[t].equals(i[t]))return!1;return!0},set:function(t){const i=this[r];i.resize(t.length,void 0,!0);const n=i.getValue();for(let i=0,r=t.length;i<r;++i)n[i].set(t[i]instanceof e?t[i].getValue():t[i])},isDefaultValue:function(){return 0===this.length},setValue:function(t){const e=this[r];e.set(t instanceof a?t.getValue():t),e.addEvent()},unshift:function(t){const e=this[r],i=e.getValue();for(let t=arguments.length-1;t>=0;--t){const n=new(e.getSingleType());n.setValue(arguments[t]),e.addChildObject(n),i.unshift(n)}return e.addEvent(),i.length},shift:function(){const t=this[r],e=t.getValue();if(e.length){const i=e.shift();return t.removeChildObject(i),t.addEvent(),i.valueOf()}},push:function(t){const e=this[r],i=e.getValue();for(const t of arguments){const n=new(e.getSingleType());n.setValue(t),e.addChildObject(n),i.push(n)}return e.addEvent(),i.length},pop:function(){const t=this[r],e=t.getValue();if(e.length){const i=e.pop();return t.removeChildObject(i),t.addEvent(),i.valueOf()}},splice:function(t,e){const i=this[r],n=i.getValue();t>n.length&&(t=n.length),t+e>n.length&&(e=n.length-t);const s=i.erase(t,t+e);return arguments.length>2&&i.insert(t,arguments,2,arguments.length),s},insert:function(t,e,i,n){const s=this[r],o=[t,0];for(let t=i;t<n;++t){const i=new(s.getSingleType());i.setValue(e[t]),s.addChildObject(i),o.push(i)}Array.prototype.splice.apply(s.getValue(),o),s.addEvent()},find:function(e,i,n){const s=this[r].getValue();if(t.isFunction(n)){for(let t=e;t<i;++t)if(n(s[t].valueOf()))return t;return i}for(let t=e;t<i;++t)if(s[t].equals(n))return t;return i},remove:function(e,i,n){const s=this[r],o=s.getValue();if(t.isFunction(n)){if((e=s.find(e,i,n))!==i)for(let t=e;++t<i;){const i=o[t];if(!n(i.valueOf())){const n=o[e];o[e++]=i,o[t]=n}}return e!==i&&s.addEvent(),e}if((e=s.find(e,i,n))!==i)for(let t=e;++t<i;){const i=o[t];if(!i.equals(n)){const n=o[e];o[e++]=i,o[t]=n}}return e!==i&&s.addEvent(),e},erase:function(t,e){const i=this[r],n=i.getValue().splice(t,e-t);for(const t of n)i.removeChildObject(t);return i.addEvent(),n.map((function(t){return t.valueOf()}))},resize:function(t,e,i){const n=this[r],s=n.getValue();if(t<s.length){for(let e=t,i=s.length;e<i;++e)n.removeChildObject(s[e]);s.length=t,i||n.addEvent()}else if(t>s.length){for(let i=s.length;i<t;++i){const t=new(n.getSingleType());void 0!==e&&t.setValue(e),n.addChildObject(t),s.push(t)}i||n.addEvent()}},addChildObject:function(t){t.addParent(this[s])},removeChildObject:function(t){t.removeParent(this[s])},toStream:function(t){const e=this[r],i=e.getValue(),s=n.Get(t);switch(i.length){case 0:t.string+="[ ]";break;case 1:s.PushUnitCategory(e.getUnit()),i[0].toStream(t),s.PopUnitCategory();break;default:s.PushUnitCategory(e.getUnit()),t.string+="[\n",s.IncIndent();for(let e=0,n=i.length-1;e<n;++e)t.string+=s.Indent(),i[e].toStream(t),t.string+=",\n";t.string+=s.Indent(),i.at(-1).toStream(t),t.string+="\n",s.DecIndent(),t.string+=s.Indent(),t.string+="]",s.PopUnitCategory()}},toVRMLStream:function(t){this.toStream(t)},toXMLStream:function(t){const e=this[r];if(e.length){const i=n.Get(t),r=e.getValue();i.PushUnitCategory(e.getUnit());for(const e of r)e.toXMLStream(t),t.string+=", ";r.at(-1).toXMLStream(t),i.PopUnitCategory()}},dispose:function(){const t=this[r],e=t.getValue();for(const i of e)t.removeChildObject(i);e.length=0,i.prototype.dispose.call(t)}});for(const t of Reflect.ownKeys(a.prototype))Object.defineProperty(a.prototype,t,{enumerable:!1});return Object.defineProperty(a.prototype,"length",{get:function(){return this[r].getValue().length},set:function(t){this[r].resize(t)},enumerable:!1,configurable:!1}),a})),define("x_ite/Base/X3DTypedArrayField",["x_ite/Base/X3DArrayField","x_ite/Base/X3DConstants","x_ite/InputOutput/Generator","standard/Math/Algorithm"],(function(t,e,i,n){"use strict";const r=Symbol(),s=Symbol(),o=Symbol(),a={get:function(t,e){const i=t[e];if(void 0!==i)return i;if("string"==typeof e){const i=+e;if(Number.isInteger(i)){const e=t.getComponents(),n=t.getValueType();let r=t.getValue();if(i>=t[o]&&(r=t.resize(i+1)),1===e)return n(r[i]);{const r=new n,s=r.getValue(),o=i*e;return r.addEvent=c.bind(t,o,s,e),r.getValue=l.bind(t,o,s,e),r}}return t[e]}},set:function(t,e,i){if(e in t)return t[e]=i,!0;const n=t.getComponents();let r=+e,s=t.getValue();if(r>=t[o]&&(s=t.resize(r+1)),1===n)s[r]=i;else{r*=n;for(let t=0;t<n;++t,++r)s[r]=i[t]}return t.addEvent(),!0},has:function(t,e){return Number.isInteger(+e)?e<t[o]:e in t},ownKeys:function(t){const e=[];for(let i=0,n=t[o];i<n;++i)e.push(String(i));return e},getOwnPropertyDescriptor:function(t,e){if("string"!=typeof e)return;const i=+e;return Number.isInteger(i)&&i<t[o]?Object.getOwnPropertyDescriptor(t.getValue(),e):void 0}};function u(e){return t.call(this,new(this.getArrayType())(2)),this[r]=this,this[s]=[],e[0]instanceof Array&&(e=e[0]),u.prototype.push.apply(this,e),new Proxy(this,a)}u.prototype=Object.assign(Object.create(t.prototype),{constructor:u,[r]:null,[s]:null,[o]:0,[Symbol.iterator]:function*(){const t=this[r],e=t.getValue(),i=t.getComponents(),n=t.getValueType(),s=t[o];if(1===i)for(let t=0;t<s;++t)yield n(e[t]);else for(let e=0;e<s;++e){const r=new n,s=r.getValue(),o=e*i;r.addEvent=c.bind(t,o,s,i),r.getValue=l.bind(t,o,s,i),yield r}},getTarget:function(){return this[r]},copy:function(){const e=this[r],i=e.getValue(),n=e.create(),s=new(e.getArrayType())(i);return n[o]=e[o],t.prototype.set.call(n,s,e[o]),n.setModificationTime(0),n},equals:function(t){if(this===t)return!0;const e=this[r],i=e[o];if(i!==t[o])return!1;const n=e.getValue(),s=t.getValue();for(let t=0,r=i*e.getComponents();t<r;++t)if(n[t]!==s[t])return!1;return!0},assign:function(t){const e=this[r];e.set(t.getValue(),t.length),e.addEvent()},set:function(t,e){const i=this[r],n=i.getComponents(),s=i[o];let a=i.getValue(),u=void 0!==e?e*n:t.length;const l=u%n;l&&(u-=l,console.warn("Array length must be multiple of components size, which is "+n+".")),u/=n,a.length<t.length?(a=i.grow(t.length),a.set(t),l&&a.fill(0,u*n,u*n+l)):(a.set(t),u<s&&a.fill(0,u*n,s*n)),i[o]=u},isDefaultValue:function(){return 0===this[o]},setValue:function(t){const e=this[r];t instanceof e.constructor?e.assign(t):(e.set(t),e.addEvent())},unshift:function(t){const e=this[r],i=e.getComponents(),n=e[o],s=arguments.length,a=e.grow((n+s)*i);if(a.copyWithin(s*i,0,n*i),1===i)a.set(arguments,0);else for(let t=0,e=0;e<s;++e){const n=arguments[e];for(let e=0;e<i;++e,++t)a[t]=n[e]}return e[o]+=s,e.addEvent(),a.length},shift:function(){const t=this[r],e=t[o];if(e){const n=t.getValue(),r=t.getComponents(),a=t.getValueType(),u=e-1;if(1===r)var i=a(n[0]);else{const e=t[s];for(let t=0;t<r;++t)e[t]=n[t];i=Object.create(a.prototype);a.apply(i,e)}return n.copyWithin(0,r,e*r),n.fill(0,r*u,e*r),t[o]=u,t.addEvent(),i}},push:function(t){const e=this[r],i=e.getComponents(),n=e[o],s=arguments.length,a=e.grow((n+s)*i);if(1===i)a.set(arguments,n);else for(let t=n*i,e=0;e<s;++e){const n=arguments[e];for(let e=0;e<i;++e,++t)a[t]=n[e]}return e[o]+=s,e.addEvent(),e[o]},pop:function(){const t=this[r],e=t[o];if(e){const n=t.getValue(),r=t.getComponents(),a=t.getValueType(),u=e-1;if(1===r)var i=a(n[e-1]);else{const e=t[s];for(let t=0,i=u*r;t<r;++t,++i)e[t]=n[i];i=Object.create(a.prototype);a.apply(i,e)}return n.fill(0,u*r,e*r),t[o]=u,t.addEvent(),i}},splice:function(t,e){const i=this[r],n=i[o];t>n&&(t=n),t+e>n&&(e=n-t);const s=i.erase(t,t+e);return arguments.length>2&&i.spliceInsert(t,Array.prototype.splice.call(arguments,2)),i.addEvent(),s},spliceInsert:function(t,e){const i=this[r],n=i.getComponents(),s=i[o],a=e.length,u=i.grow((s+a)*n);if(t*=n,u.copyWithin(t+a*n,t,s*n),1===n)u.set(e,t);else for(let i=0,r=t;i<a;++i){const t=e[i];for(let e=0;e<n;++e,++r)u[r]=t[e]}i[o]+=a},insert:function(t,e,i,n){const s=this[r],a=s[o],u=e.getValue(),l=s.getComponents(),c=n-i,h=s.grow((a+c)*l);for(t*=l,i*=l,n*=l,h.copyWithin(t+c*l,t,a*l);i<n;++t,++i)h[t]=u[i];s[o]+=c,s.addEvent()},erase:function(t,e){const i=this[r],n=i.getValue(),s=i.getComponents(),a=e-t,u=i[o],l=u-a,c=i.create(),h=c.grow(a*s);e*=s;for(let i=0,r=t*=s;r<e;++i,++r)h[i]=n[r];return n.copyWithin(t,e,u*s),n.fill(0,l*s,u*s),i[o]=l,c[o]=a,i.addEvent(),c.slice()},resize:function(t,e,i){const n=this[r],s=n[o],a=n.getComponents();let u=n.getValue();if(t<s)u.fill(0,t*a,s*a),i||n.addEvent();else if(t>s){if(u=n.grow(t*a),void 0!==e)if(1===a)u.fill(e,s*a,t*a);else for(let i=s*a,n=t*a;i<n;)for(let t=0;t<a;++t,++i)u[i]=e[t];i||n.addEvent()}return n[o]=t,u},grow:function(e){const i=this[r],s=i.getValue();if(e<s.length)return s;const o=n.nextPowerOfTwo(e),a=new(i.getArrayType())(o);return a.set(s),t.prototype.set.call(i,a),a},shrinkToFit:function(){const e=this[r],i=e.getValue(),n=e[o]*e.getComponents();if(i.length==n)return i;const s=i.subarray(0,n);return t.prototype.set.call(e,s),s},toStream:function(t){const e=this[r],n=i.Get(t),s=e.getValue(),a=e[o],u=e.getComponents(),l=new(e.getSingleType());switch(a){case 0:t.string+="[ ]";break;case 1:if(n.PushUnitCategory(e.getUnit()),1===u)l.set(s[0]),l.toStream(t);else{for(let t=0,e=0;t<u;++t,++e)l[t]=s[e];l.toStream(t)}n.PopUnitCategory();break;default:if(n.PushUnitCategory(e.getUnit()),t.string+="[\n",n.IncIndent(),1===u){for(let e=0,i=a-1;e<i;++e)t.string+=n.Indent(),l.set(s[e*u]),l.toStream(t),t.string+=",\n";t.string+=n.Indent(),l.set(s[(a-1)*u]),l.toStream(t),t.string+="\n"}else{for(let e=0,i=a-1;e<i;++e){t.string+=n.Indent();for(let t=0,i=e*u;t<u;++t,++i)l[t]=s[i];l.toStream(t),t.string+=",\n"}t.string+=n.Indent();for(let t=0,e=(a-1)*u;t<u;++t,++e)l[t]=s[e];l.toStream(t),t.string+="\n"}n.DecIndent(),t.string+=n.Indent(),t.string+="]",n.PopUnitCategory()}},toVRMLStream:function(t){this.toStream(t)},toXMLStream:function(t){const e=this[r],n=e[o];if(n){const r=i.Get(t),s=e.getValue(),o=e.getComponents(),a=new(e.getSingleType());if(r.PushUnitCategory(e.getUnit()),1===o){for(let e=0,i=n-1;e<i;++e)a.set(s[e*o]),a.toXMLStream(t),t.string+=", ";a.set(s[(n-1)*o]),a.toXMLStream(t)}else{for(let e=0,i=n-1;e<i;++e){for(let t=0,i=e*o;t<o;++t,++i)a[t]=s[i];a.toXMLStream(t),t.string+=", "}for(let t=0,e=(n-1)*o;t<o;++t,++e)a[t]=s[e];a.toXMLStream(t)}r.PopUnitCategory()}},dispose:function(){t.prototype.dispose.call(this[r])}});for(const t of Reflect.ownKeys(u.prototype))Object.defineProperty(u.prototype,t,{enumerable:!1});function l(t,e,i){const n=this.getValue(),r=this[s];for(let e=0;e<i;++e,++t)r[e]=n[t];return e.set.apply(e,r),e}function c(t,e,i){const n=this.getValue();for(let r=0;r<i;++r,++t)n[t]=e[r];this.addEvent()}return Object.defineProperty(u.prototype,"length",{get:function(){return this[o]},set:function(t){this[r].resize(t)},enumerable:!1,configurable:!1}),u})),define("x_ite/Fields/ArrayFields",["x_ite/Fields/SFBool","x_ite/Fields/SFColor","x_ite/Fields/SFColorRGBA","x_ite/Fields/SFDouble","x_ite/Fields/SFFloat","x_ite/Fields/SFImage","x_ite/Fields/SFInt32","x_ite/Fields/SFMatrix3","x_ite/Fields/SFMatrix4","x_ite/Fields/SFNode","x_ite/Fields/SFRotation","x_ite/Fields/SFString","x_ite/Fields/SFTime","x_ite/Fields/SFVec2","x_ite/Fields/SFVec3","x_ite/Fields/SFVec4","x_ite/Base/X3DObjectArrayField","x_ite/Base/X3DTypedArrayField","x_ite/Base/X3DConstants","x_ite/InputOutput/Generator"],(function(t,e,i,n,r,s,o,a,u,l,c,h,d,p,f,g,m,_,y,x){"use strict";const w=a.SFMatrix3d,b=a.SFMatrix3f,v=u.SFMatrix4d,S=u.SFMatrix4f,T=p.SFVec2d,C=p.SFVec2f,O=f.SFVec3d,N=f.SFVec3f,F=g.SFVec4d,E=g.SFVec4f,D=Symbol();function M(t){return m.call(this,arguments)}M.prototype=Object.assign(Object.create(m.prototype),{constructor:M,[D]:0,getSingleType:function(){return l},getValueType:function(){return l},getArrayType:function(){return Array},getComponents:function(){return 1},getTypeName:function(){return"MFNode"},getType:function(){return y.MFNode},copy:function(t){if(t){const e=new M;for(const i of this.getValue())e.push(i.copy(t));return e.setModificationTime(0),e}return m.prototype.copy.call(this)},addCloneCount:function(t){this[D]+=t;for(const e of this.getValue())e.addCloneCount(t)},removeCloneCount:function(t){this[D]-=t;for(const e of this.getValue())e.removeCloneCount(t)},addChildObject:function(t){m.prototype.addChildObject.call(this,t),t.addCloneCount(this[D])},removeChildObject:function(t){m.prototype.removeChildObject.call(this,t),t.removeCloneCount(this[D])},toStream:function(t){const e=this.getTarget(),i=e.getValue(),n=x.Get(t);switch(i.length){case 0:t.string+="[ ]";break;case 1:n.PushUnitCategory(e.getUnit()),i[0].toStream(t),n.PopUnitCategory();break;default:n.PushUnitCategory(e.getUnit()),t.string+="[\n",n.IncIndent();for(let e=0,r=i.length;e<r;++e)t.string+=n.Indent(),i[e].toStream(t),t.string+="\n";n.DecIndent(),t.string+=n.Indent(),t.string+="]",n.PopUnitCategory()}},toVRMLString:function(){this.addCloneCount(1);const t=m.prototype.toVRMLString.call(this);return this.removeCloneCount(1),t},toVRMLStream:function(t){const e=this.getTarget().getValue(),i=x.Get(t);switch(e.length){case 0:t.string+="[ ]";break;case 1:i.EnterScope(),e[0].toVRMLStream(t),i.LeaveScope();break;default:i.EnterScope(),t.string+="[\n",i.IncIndent();for(const n of e)t.string+=i.Indent(),n.toVRMLStream(t),t.string+="\n";i.DecIndent(),t.string+=i.Indent(),t.string+="]",i.LeaveScope()}},toXMLString:function(){this.addCloneCount(1);const t=m.prototype.toXMLString.call(this);return this.removeCloneCount(1),t},toXMLStream:function(t){const e=x.Get(t),i=this.length;if(i){e.EnterScope();const n=this.getValue();for(let r=0,s=i-1;r<s;++r){const i=n[r].getValue();if(i)i.toXMLStream(t),t.string+="\n";else{t.string+=e.Indent(),t.string+="<",t.string+="NULL";const i=e.ContainerField();i&&(t.string+=" ",t.string+="containerField='",t.string+=e.XMLEncode(i.getName()),t.string+="'"),t.string+="/>"}}const r=n.at(-1).getValue();if(r)r.toXMLStream(t);else{t.string+=e.Indent(),t.string+="<",t.string+="NULL";const i=e.ContainerField();i&&(t.string+=" ",t.string+="containerField='",t.string+=e.XMLEncode(i.getName()),t.string+="'")}e.LeaveScope()}},dispose:function(){this.resize(0),m.prototype.dispose.call(this)}});for(const t of Reflect.ownKeys(M.prototype))Object.defineProperty(M.prototype,t,{enumerable:!1});function I(t){return m.call(this,arguments)}I.prototype=Object.assign(Object.create(m.prototype),{constructor:I,getValueType:function(){return String},getSingleType:function(){return h},getArrayType:function(){return Array},getComponents:function(){return 1},getTypeName:function(){return"MFString"},getType:function(){return y.MFString},toXMLStream:function(t){const e=this.length;if(e){const i=this.getValue();for(let n=0,r=e-1;n<r;++n)t.string+='"',i[n].toXMLStream(t),t.string+='"',t.string+=", ";t.string+='"',i.at(-1).toXMLStream(t),t.string+='"'}}});for(const t of Reflect.ownKeys(I.prototype))Object.defineProperty(I.prototype,t,{enumerable:!1});function V(t,e,i,n,r,s){function o(t){return _.call(this,arguments)}o.prototype=Object.assign(Object.create(_.prototype),{constructor:o,getSingleType:function(){return i},getValueType:function(){return n},getArrayType:function(){return r},getComponents:function(){return s},getTypeName:function(){return t},getType:function(){return e}});for(const t of Reflect.ownKeys(o.prototype))Object.defineProperty(o.prototype,t,{enumerable:!1});return o}function B(t){return t}const A={MFBool:V("MFBool",y.MFBool,t,Boolean,Uint8Array,1),MFColor:V("MFColor",y.MFColor,e,e,Float32Array,3),MFColorRGBA:V("MFColorRGBA",y.MFColorRGBA,i,i,Float32Array,4),MFDouble:V("MFDouble",y.MFDouble,n,B,Float64Array,1),MFFloat:V("MFFloat",y.MFFloat,r,B,Float32Array,1),MFImage:function(t,e,i,n,r,s){function o(t){return m.call(this,arguments)}o.prototype=Object.assign(Object.create(m.prototype),{constructor:o,getSingleType:function(){return i},getValueType:function(){return n},getArrayType:function(){return r},getComponents:function(){return s},getTypeName:function(){return t},getType:function(){return e}});for(const t of Reflect.ownKeys(o.prototype))Object.defineProperty(o.prototype,t,{enumerable:!1});return o}("MFImage",y.MFImage,s,s,Array,1),MFInt32:V("MFInt32",y.MFInt32,o,B,Int32Array,1),MFMatrix3d:V("MFMatrix3d",y.MFMatrix3d,w,w,Float64Array,9),MFMatrix3f:V("MFMatrix3f",y.MFMatrix3f,b,b,Float32Array,9),MFMatrix4d:V("MFMatrix4d",y.MFMatrix4d,v,v,Float64Array,16),MFMatrix4f:V("MFMatrix4f",y.MFMatrix4f,S,S,Float32Array,16),MFNode:M,MFRotation:V("MFRotation",y.MFRotation,c,c,Float64Array,4),MFString:I,MFTime:V("MFTime",y.MFTime,d,B,Float64Array,1),MFVec2d:V("MFVec2d",y.MFVec2d,T,T,Float64Array,2),MFVec2f:V("MFVec2f",y.MFVec2f,C,C,Float32Array,2),MFVec3d:V("MFVec3d",y.MFVec3d,O,O,Float64Array,3),MFVec3f:V("MFVec3f",y.MFVec3f,N,N,Float32Array,3),MFVec4d:V("MFVec4d",y.MFVec4d,F,F,Float64Array,4),MFVec4f:V("MFVec4f",y.MFVec4f,E,E,Float32Array,4)};return A})),define("x_ite/Fields",["x_ite/Fields/SFBool","x_ite/Fields/SFColor","x_ite/Fields/SFColorRGBA","x_ite/Fields/SFDouble","x_ite/Fields/SFFloat","x_ite/Fields/SFImage","x_ite/Fields/SFInt32","x_ite/Fields/SFMatrix3","x_ite/Fields/SFMatrix4","x_ite/Fields/SFNode","x_ite/Fields/SFRotation","x_ite/Fields/SFString","x_ite/Fields/SFTime","x_ite/Fields/SFVec2","x_ite/Fields/SFVec3","x_ite/Fields/SFVec4","x_ite/Fields/ArrayFields"],(function(t,e,i,n,r,s,o,a,u,l,c,h,d,p,f,g,m){"use strict";return Object.assign({SFBool:t,SFColor:e,SFColorRGBA:i,SFDouble:n,SFFloat:r,SFImage:s,SFInt32:o,SFMatrix3d:a.SFMatrix3d,SFMatrix3f:a.SFMatrix3f,SFMatrix4d:u.SFMatrix4d,SFMatrix4f:u.SFMatrix4f,SFNode:l,SFRotation:c,SFString:h,SFTime:d,SFVec2d:p.SFVec2d,SFVec2f:p.SFVec2f,SFVec3d:f.SFVec3d,SFVec3f:f.SFVec3f,SFVec4d:g.SFVec4d,SFVec4f:g.SFVec4f,VrmlMatrix:u.VrmlMatrix},m)})),define("x_ite/Base/X3DBaseNode",["x_ite/Base/X3DEventObject","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Base/FieldArray","x_ite/Fields","x_ite/Base/X3DConstants"],(function(t,e,i,n,r,s){"use strict";const o=Symbol(),a=Symbol(),u=Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions"),l=Symbol(),c=Symbol(),h=Symbol(),d=Symbol(),p=Symbol(),f=Symbol(),g=Symbol("X3DBaseNode.set_live__"),m=Symbol(),_=Symbol();function y(e){if(!this[o]){t.call(this,e.getBrowser()),this[o]=e,this[a]=[s.X3DBaseNode],this[l]=new n,this[c]=new n,this[h]=new Map,this[d]=new n,this[f]=!0,this[p]=!1,this[m]=!1,this[_]=0,this.canUserDefinedFields()&&(this[u]=new i(this[u]));for(const t of this[u])this.addField(t);this.addChildObjects("name_changed",new r.SFTime,"typeName_changed",new r.SFTime,"fields_changed",new r.SFTime,"cloneCount_changed",new r.SFTime)}}y.prototype=Object.assign(Object.create(t.prototype),{constructor:y,[u]:new i([]),setName:function(e){t.prototype.setName.call(this,e),this[p]&&(this._name_changed=this.getBrowser().getCurrentTime())},getMainScene:function(){let t=this[o].getScene();for(;!t.isMainScene();)t=t.getScene();return t},getScene:function(){let t=this[o];for(;!t.isScene();)t=t.getExecutionContext();return t},getExecutionContext:function(){return this[o]},setExecutionContext:function(t){this[o]=t},addType:function(t){this[a].push(t)},getType:function(){return this[a]},getInnerNode:function(){return this},isLive:function(){function t(){return this._isLive}return function(){return Object.defineProperty(this,"isLive",{value:t,enumerable:!1,configurable:!0}),this.addChildObjects("isLive",new r.SFBool(this.getLiveState())),this._isLive.removeParent(this),this.getOuterNode&&this.getOuterNode()?this.getOuterNode().isLive().addInterest(g,this):this[o]!==this&&this[o].isLive().addInterest(g,this),this.isLive()}}(),setLive:function(t){this[f]=t.valueOf(),this[g]()},getLive:function(){return this[f]},getLiveState:function(){return this.getOuterNode&&this.getOuterNode()?this.getLive()&&this.getOuterNode().isLive().getValue():this!==this[o]?this.getLive()&&this[o].isLive().getValue():this.getLive()},[g]:function(){const t=this.getLiveState(),e=this.isLive();if(t){if(e.getValue())return;e.set(!0),e.processEvent()}else e.getValue()&&(e.set(!1),e.processEvent())},create:function(t){return new this.constructor(t||this[o])},copy:function(t){const e=this.create(t);if(this.canUserDefinedFields())for(const t of this[u])e.getFields().has(t.name)||e.addUserDefinedField(t.accessType,t.name,t.value.copy());for(const t of this[l])e.getFields().get(t.getName()).assign(t);return e.setup(),e},setup:function(){if(!this[p]){this[p]=!0;for(const t of this[l])t.setTainted(!1);this.initialize()}},isInitialized:function(){return this[p]},initialize:function(){},addChildObjects:function(t,e){for(let t=0,e=arguments.length;t<e;t+=2)this.addChildObject(arguments[t],arguments[t+1])},addChildObject:function(t,e){e.addParent(this),e.setName(t),Object.defineProperty(this,"_"+t,{get:function(){return e},set:function(t){e.setValue(t)},enumerable:!1,configurable:!1})},getFieldDefinitions:function(){return this[u]},getFieldsAreEnumerable:function(){return!1},addField:function(t){const e=t.accessType,i=t.name,n=t.value.copy();n.setTainted(!this[p]),n.addParent(this),n.setName(i),n.setAccessType(e),this[l].add(i,n),this[c].add(i,n),Object.defineProperty(this,"_"+i,{get:function(){return n},set:function(t){n.setValue(t)},enumerable:this.getFieldsAreEnumerable(),configurable:!0}),this.getPrivate()||n.addCloneCount(1),this[p]&&(this._fields_changed=this.getBrowser().getCurrentTime())},getField:function(){const t=/^set_(.*?)$/,e=/^(.*?)_changed$/;return function(i){const n=this[l].get(i)||this[h].get(i);if(n)return n;const r=i.match(t);if(r){const t=this[l].get(r[1])||this[h].get(r[1]);if(t&&t.getAccessType()===s.inputOutput)return t}else{const t=i.match(e);if(t){const e=this[l].get(t[1])||this[h].get(t[1]);if(e&&e.getAccessType()===s.inputOutput)return e}}throw new Error("Unknown field '"+i+"' in node class "+this.getTypeName()+".")}}(),addAlias:function(t,e){this[h].set(t,e),Object.defineProperty(this,"_"+t,{get:function(){return e},set:function(t){e.setValue(t)},enumerable:!0,configurable:!1})},removeField:function(t){const e=this[c].get(t);e&&(e.removeParent(this),this[l].remove(t),this[c].remove(t),delete this["_"+e.getName()],this.getPrivate()||e.removeCloneCount(1),this[p]&&(this._fields_changed=this.getBrowser().getCurrentTime()))},canUserDefinedFields:function(){return!1},addUserDefinedField:function(t,i,n){this[d].has(i)&&this.removeUserDefinedField(i),n.setTainted(!this[p]),n.addParent(this),n.setName(i),n.setAccessType(t),this[u].add(i,new e(t,i,n)),this[l].add(i,n),this[d].add(i,n),this.getPrivate()||n.addCloneCount(1),this[p]&&(this._fields_changed=this.getBrowser().getCurrentTime())},removeUserDefinedField:function(t){const e=this[d].get(t);e&&(e.removeParent(this),this[l].remove(t),this[d].remove(t),this[u].remove(t),this.getPrivate()||e.removeCloneCount(1),this[p]&&(this._fields_changed=this.getBrowser().getCurrentTime()))},getUserDefinedFields:function(){return this[d]},getPredefinedFields:function(){return this[c]},getChangedFields:function(t){const e=[];if(t)for(const t of this[d])e.push(t);for(const i of this[c])if(t&&(i.getInputRoutes().size||i.getOutputRoutes().size))e.push(i);else{if(0===i.getReferences().size){if(!i.isInitializable())continue;if(this.isDefaultValue(i))continue}e.push(i)}return e},isDefaultValue:function(t){const e=this.getFieldDefinitions().get(t.getName());return e?e.value.equals(t):!t.getModificationTime()},getFields:function(){return this[l]},getSourceText:function(){return null},hasRoutes:function(){for(const t of this[l]){if(t.getInputRoutes().size)return!0;if(t.getOutputRoutes().size)return!0}return!1},getPrivate:function(){return this[m]},setPrivate:function(t){if(this[m]=t,t)for(const t of this[l])t.removeCloneCount(1);else for(const t of this[l])t.addCloneCount(1)},getCloneCount:function(){return this[_]},addCloneCount:function(t){if(0===t)return;const e=this.getBrowser().getCurrentTime();this[_]+=t,this[o]._sceneGraph_changed=e,this[p]&&(this._cloneCount_changed=e)},removeCloneCount:function(t){if(0===t)return;const e=this.getBrowser().getCurrentTime();this[_]-=t,this[o]._sceneGraph_changed=e,this[p]&&(this._cloneCount_changed=e)},getEnum:function(t,e,i){return t.hasOwnProperty(e)?t[e]:i},dispose:function(){for(const t of this.getFields())t.dispose();t.prototype.dispose.call(this)}});for(const t of Reflect.ownKeys(y.prototype))Object.defineProperty(y.prototype,t,{enumerable:!1});return y})),define("x_ite/Browser/VERSION",[],(function(){return"6.1.0"})),define("x_ite/DEBUG",[],(function(){"use strict";return!1})),define("x_ite/Browser/Core/Context",["x_ite/DEBUG"],(function(t){"use strict";const e=["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_frag_depth","EXT_shader_texture_lod","EXT_texture_filter_anisotropic","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_compressed_texture_s3tc","WEBGL_debug_shaders","WEBGL_depth_texture","WEBGL_draw_buffers","WEBGL_lose_context","EXT_color_buffer_float","EXT_color_buffer_half_float","EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2","EXT_sRGB","WEBGL_color_buffer_float","WEBGL_compressed_texture_astc","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","EXT_float_blend","OES_fbo_render_mipmap","WEBGL_get_buffer_sub_data_async","WEBGL_multiview","WEBGL_security_sensitive_resources","WEBGL_shared_resources","EXT_clip_cull_distance","WEBGL_debug","WEBGL_dynamic_texture","WEBGL_subarray_uploads","WEBGL_texture_multisample","WEBGL_texture_source_iframe","WEBGL_video_texture","EXT_texture_storage","OES_depth24","WEBGL_debug_shader_precision","WEBGL_draw_elements_no_range_check","WEBGL_subscribe_uniform","WEBGL_texture_from_depth_video"];return{create:function(i,n,r){const s={preserveDrawingBuffer:r};let o=null;if(n>=2&&!o&&(o=i.getContext("webgl2",s),o&&(o.getVersion=function(){return 2})),n>=1&&!o&&(o=i.getContext("webgl",s)||i.getContext("experimental-webgl",s),o)){o.getVersion=function(){return 1};{const t=o.getExtension("OES_vertex_array_object");o.bindVertexArray=t.bindVertexArrayOES.bind(t),o.createVertexArray=t.createVertexArrayOES.bind(t),o.deleteVertexArray=t.deleteVertexArrayOES.bind(t),o.isVertexArray=t.isVertexArrayOES.bind(t)}}if(!o)throw new Error("Couldn't create WebGL context.");const a=o.getParameter(o.ALIASED_LINE_WIDTH_RANGE);1===a[0]&&1===a[1]?(o.lineWidth=Function.prototype,o.MUST_TRANSFORM_LINES=o.getVersion()>=2,t&&console.info("Lines are transformed if necessary to obtain thick lines.")):o.MUST_TRANSFORM_LINES=!1;for(const t of e)o.getExtension(t);return o}}})),
/**
 * @license text 2.0.16 Copyright jQuery Foundation and other contributors.
 * Released under MIT license, http://github.com/requirejs/text/LICENSE
 */
define("text/text",["module"],(function(t){"use strict";var e,i,n,r,s,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],a=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,u=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,l="undefined"!=typeof location&&location.href,c=l&&location.protocol&&location.protocol.replace(/\:/,""),h=l&&location.hostname,d=l&&(location.port||void 0),p={},f=t.config&&t.config()||{};function g(t,e){return void 0===t||""===t?e:t}return e={version:"2.0.16",strip:function(t){if(t){var e=(t=t.replace(a,"")).match(u);e&&(t=e[1])}else t="";return t},jsEscape:function(t){return t.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:f.createXhr||function(){var t,e,i;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(e=0;e<3;e+=1){i=o[e];try{t=new ActiveXObject(i)}catch(t){}if(t){o=[i];break}}return t},parseName:function(t){var e,i,n,r=!1,s=t.lastIndexOf("."),o=0===t.indexOf("./")||0===t.indexOf("../");return-1!==s&&(!o||s>1)?(e=t.substring(0,s),i=t.substring(s+1)):e=t,-1!==(s=(n=i||e).indexOf("!"))&&(r="strip"===n.substring(s+1),n=n.substring(0,s),i?i=n:e=n),{moduleName:e,ext:i,strip:r}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(t,i,n,r){var s,o,a,u=e.xdRegExp.exec(t);return!u||(s=u[2],a=(o=(o=u[3]).split(":"))[1],o=o[0],(!s||s===i)&&(!o||o.toLowerCase()===n.toLowerCase())&&(!a&&!o||function(t,e,i,n){if(e===n)return!0;if(t===i){if("http"===t)return g(e,"80")===g(n,"80");if("https"===t)return g(e,"443")===g(n,"443")}return!1}(s,a,i,r)))},finishLoad:function(t,i,n,r){n=i?e.strip(n):n,f.isBuild&&(p[t]=n),r(n)},load:function(t,i,n,r){if(r&&r.isBuild&&!r.inlineText)n();else{f.isBuild=r&&r.isBuild;var s=e.parseName(t),o=s.moduleName+(s.ext?"."+s.ext:""),a=i.toUrl(o),u=f.useXhr||e.useXhr;0!==a.indexOf("empty:")?!l||u(a,c,h,d)?e.get(a,(function(i){e.finishLoad(t,s.strip,i,n)}),(function(t){n.error&&n.error(t)})):
//!strip part to avoid file system issues.
i([o],(function(t){e.finishLoad(s.moduleName+"."+s.ext,s.strip,t,n)}),(function(t){n.error&&n.error(t)})):n()}},write:function(t,i,n,r){if(p.hasOwnProperty(i)){var s=e.jsEscape(p[i]);n.asModule(t+"!"+i,"define(function () { return '"+s+"';});\n")}},writeFile:function(t,i,n,r,s){var o=e.parseName(i),a=o.ext?"."+o.ext:"",u=o.moduleName+a,l=n.toUrl(o.moduleName+a)+".js";e.load(u,n,(function(i){var n=function(t){return r(l,t)};n.asModule=function(t,e){return r.asModule(t,l,e)},e.write(t,u,n,s)}),s)}},"node"===f.env||!f.env&&void 0!==process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]&&!process.versions["atom-shell"]?(i=require.nodeRequire("fs"),e.get=function(t,e,n){try{var r=i.readFileSync(t,"utf8");"\ufeff"===r[0]&&(r=r.substring(1)),e(r)}catch(t){n&&n(t)}}):"xhr"===f.env||!f.env&&e.createXhr()?e.get=function(t,i,n,r){var s,o=e.createXhr();if(o.open("GET",t,!0),r)for(s in r)r.hasOwnProperty(s)&&o.setRequestHeader(s.toLowerCase(),r[s]);f.onXhr&&f.onXhr(o,t),o.onreadystatechange=function(e){var r,s;4===o.readyState&&((r=o.status||0)>399&&r<600?((s=new Error(t+" HTTP status: "+r)).xhr=o,n&&n(s)):i(o.responseText),f.onXhrComplete&&f.onXhrComplete(o,t))},o.send(null)}:"rhino"===f.env||!f.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?e.get=function(t,e){var i,n,r=new java.io.File(t),s=java.lang.System.getProperty("line.separator"),o=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(r),"utf-8")),a="";try{for(i=new java.lang.StringBuffer,(n=o.readLine())&&n.length()&&65279===n.charAt(0)&&(n=n.substring(1)),null!==n&&i.append(n);null!==(n=o.readLine());)i.append(s),i.append(n);a=String(i.toString())}finally{o.close()}e(a)}:("xpconnect"===f.env||!f.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(n=Components.classes,r=Components.interfaces,Components.utils.import("resource://gre/modules/FileUtils.jsm"),s="@mozilla.org/windows-registry-key;1"in n,e.get=function(t,e){var i,o,a,u={};s&&(t=t.replace(/\//g,"\\")),a=new FileUtils.File(t);try{(i=n["@mozilla.org/network/file-input-stream;1"].createInstance(r.nsIFileInputStream)).init(a,1,0,!1),(o=n["@mozilla.org/intl/converter-input-stream;1"].createInstance(r.nsIConverterInputStream)).init(i,"utf-8",i.available(),r.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),o.readString(i.available(),u),o.close(),i.close(),e(u.value)}catch(t){throw new Error((a&&a.path||"")+": "+t)}}),e})),define("text",["text/text"],(function(t){return t})),define("text!locale/de.po",[],(function(){return'msgid ""\nmsgstr ""\n"Project-Id-Version: X_ITE\\n"\n"POT-Creation-Date: 2015-12-23 04:56+0100\\n"\n"PO-Revision-Date: 2015-12-23 04:57+0100\\n"\n"Last-Translator: Holger Seelig <holger.seelig@yahoo.de>\\n"\n"Language-Team: \\n"\n"Language: de\\n"\n"MIME-Version: 1.0\\n"\n"Content-Type: text/plain; charset=UTF-8\\n"\n"Content-Transfer-Encoding: 8bit\\n"\n"X-Generator: Poedit 1.8.4\\n"\n"X-Poedit-Basepath: ../x_ite\\n"\n"Plural-Forms: nplurals=2; plural=(n != 1);\\n"\n"X-Poedit-SourceCharset: UTF-8\\n"\n"X-Poedit-SearchPath-0: .\\n"\n\nmsgid "Less Properties"\nmsgstr "Weniger Eigenschaften"\n\nmsgid "More Properties"\nmsgstr "Mehr Eigenschaften"\n\nmsgid "Frame rate"\nmsgstr "Bildrate"\n\nmsgid "fps"\nmsgstr "BpS"\n\nmsgid "Speed"\nmsgstr "Geschwindigkeit"\n\nmsgid "m/s"\nmsgstr ""\n\nmsgid "km/h"\nmsgstr ""\n\nmsgid "Browser"\nmsgstr ""\n\nmsgid "ms"\nmsgstr ""\n\nmsgid "X3D total"\nmsgstr "X3D gesamt"\n\nmsgid "Event Processing"\nmsgstr "Ereignisverarbeitung"\n\nmsgid "Pointer"\nmsgstr "Zeigegerät"\n\nmsgid "Camera"\nmsgstr "Kamera"\n\nmsgid "Collision Detection"\nmsgstr "Kollisionserkennung"\n\nmsgid "Rendering"\nmsgstr "Rendering"\n\nmsgid "Number of Shapes"\nmsgstr "Anzahl der Formen"\n\nmsgid "Number of Sensors"\nmsgstr "Anzahl der Sensoren"\n\nmsgid "Browser Timings"\nmsgstr "Zeitberechnung"\n\nmsgid "X_ITE Browser"\nmsgstr ""\n\nmsgid "Viewpoints"\nmsgstr "Ansichtspunkte"\n\nmsgid "Available Viewers"\nmsgstr "Verfügbare Betrachter"\n\nmsgid "Straighten Horizon"\nmsgstr "Horizont gerade richten"\n\nmsgid "Primitive Quality"\nmsgstr "Qualität der Grundobjekte"\n\nmsgid "High"\nmsgstr "Hoch"\n\nmsgid "high"\nmsgstr "hoch"\n\nmsgid "Medium"\nmsgstr "Mittel"\n\nmsgid "medium"\nmsgstr "mittel"\n\nmsgid "Low"\nmsgstr "Niedrig"\n\nmsgid "low"\nmsgstr "niedrig"\n\nmsgid "Texture Quality"\nmsgstr "Textur Qualität"\n\nmsgid "Display Rubberband"\nmsgstr "Gummiband anzeigen"\n\nmsgid "Rubberband"\nmsgstr "Gummiband"\n\nmsgid "on"\nmsgstr "an"\n\nmsgid "off"\nmsgstr "aus"\n\nmsgid "Mute Browser"\nmsgstr "Browser stumm schalten"\n\nmsgid "Browser muted"\nmsgstr "Browser stumm geschalten"\n\nmsgid "Browser unmuted"\nmsgstr "Browser Ton an"\n\nmsgid "Leave Fullscreen"\nmsgstr "Vollbild verlassen"\n\nmsgid "Fullscreen"\nmsgstr "Vollbild"\n\nmsgid "About X_ITE"\nmsgstr "Über X_ITE"\n\nmsgid "Examine Viewer"\nmsgstr "Untersuchen"\n\nmsgid "Walk Viewer"\nmsgstr "Laufen"\n\nmsgid "Fly Viewer"\nmsgstr "Fliegen"\n\nmsgid "Plane Viewer"\nmsgstr "Ebenen Betrachter"\n\nmsgid "Look At Viewer"\nmsgstr "Auf Objekte zielen"\n\nmsgid "None Viewer"\nmsgstr "Kein Betrachter"\n\nmsgid "Loading %1 file"\nmsgstr "Lade %1 Datei"\n\nmsgid "Loading %1 files"\nmsgstr "Lade %1 Dateien"\n\nmsgid "Loading done"\nmsgstr "Fertig mit Laden"\n\nmsgid "Failed loading world."\nmsgstr "Laden der Dateien fehlgeschlagen."\n\nmsgid "Show World Info"\nmsgstr "World Info anzeigen"\n\nmsgid "Viewpoint is copied to clipboard."\nmsgstr "Ansichtspunkt wurde in die Zwischenablage kopiert."\n'})),define("text!locale/fr.po",[],(function(){return'msgid ""\nmsgstr ""\n"Project-Id-Version: X_ITE\\n"\n"POT-Creation-Date: 2015-12-23 04:58+0100\\n"\n"PO-Revision-Date: 2015-12-23 05:07+0100\\n"\n"Last-Translator: Holger Seelig <holger.seelig@yahoo.de>\\n"\n"Language-Team: \\n"\n"Language: fr\\n"\n"MIME-Version: 1.0\\n"\n"Content-Type: text/plain; charset=UTF-8\\n"\n"Content-Transfer-Encoding: 8bit\\n"\n"X-Generator: Poedit 1.8.4\\n"\n"X-Poedit-Basepath: ../x_ite\\n"\n"Plural-Forms: nplurals=2; plural=(n != 1);\\n"\n"X-Poedit-SourceCharset: UTF-8\\n"\n"X-Poedit-SearchPath-0: .\\n"\n\nmsgid "Less Properties"\nmsgstr "Moins de propriétés"\n\nmsgid "More Properties"\nmsgstr "Plus de propriétés"\n\nmsgid "Frame rate"\nmsgstr "Fréquence"\n\nmsgid "fps"\nmsgstr "fps"\n\nmsgid "Speed"\nmsgstr "Vélocité"\n\nmsgid "m/s"\nmsgstr ""\n\nmsgid "km/h"\nmsgstr ""\n\nmsgid "Browser"\nmsgstr "X_ITE Navigateur"\n\nmsgid "ms"\nmsgstr ""\n\nmsgid "X3D total"\nmsgstr "X3D total"\n\nmsgid "Traitement des événements"\nmsgstr "Routes"\n\nmsgid "Pointer"\nmsgstr "Pointeur"\n\nmsgid "Camera"\nmsgstr "Caméra"\n\nmsgid "Collision Detection"\nmsgstr "Détection des collisions"\n\nmsgid "Rendering"\nmsgstr "Rendement"\n\nmsgid "Number of Shapes"\nmsgstr "Nombre de formes"\n\nmsgid "Number of Sensors"\nmsgstr "Nombre de senseurs"\n\nmsgid "Browser Timings"\nmsgstr "Calcul du temps"\n\nmsgid "X_ITE Browser"\nmsgstr "X_ITE Navigateur"\n\nmsgid "Viewpoints"\nmsgstr "Points de vue"\n\nmsgid "Available Viewers"\nmsgstr "Visionneurs disponibles"\n\nmsgid "Straighten Horizon"\nmsgstr "Redresser l\'horizon"\n\nmsgid "Primitive Quality"\nmsgstr "Qualité des objets simples"\n\nmsgid "High"\nmsgstr "Haut"\n\nmsgid "high"\nmsgstr "haut"\n\nmsgid "Medium"\nmsgstr "Moyenne"\n\nmsgid "medium"\nmsgstr "moyenne"\n\nmsgid "Low"\nmsgstr "Faible"\n\nmsgid "low"\nmsgstr "faible"\n\nmsgid "Texture Quality"\nmsgstr "Qualité des textures"\n\nmsgid "Display Rubberband"\nmsgstr "Présenter le bande élastique"\n\nmsgid "Rubberband"\nmsgstr "Bande élastique"\n\nmsgid "on"\nmsgstr "marche"\n\nmsgid "off"\nmsgstr "arrêt"\n\nmsgid "Mute Browser"\nmsgstr "Rendre navigateur muet"\n\nmsgid "Browser muted"\nmsgstr "Navigateur muet"\n\nmsgid "Browser unmuted"\nmsgstr "Son de navigateur réactivé"\n\nmsgid "Leave Fullscreen"\nmsgstr "Sortie en plein écran"\n\nmsgid "Fullscreen"\nmsgstr "Plein écran"\n\nmsgid "About X_ITE"\nmsgstr "À propos de X_ITE"\n\nmsgid "Examine Viewer"\nmsgstr "Examiner"\n\nmsgid "Walk Viewer"\nmsgstr "Aller"\n\nmsgid "Fly Viewer"\nmsgstr "Voler"\n\nmsgid "Plane Viewer"\nmsgstr "Visionneur de la plaine"\n\nmsgid "Look At Viewer"\nmsgstr "Regarder un objet de près"\n\nmsgid "None Viewer"\nmsgstr "Pas de visionneur"\n\nmsgid "Loading %1 file"\nmsgstr "Télécharger %1 fichier"\n\nmsgid "Loading %1 files"\nmsgstr "Télécharger %1 fichiers"\n\nmsgid "Loading done"\nmsgstr "Téléchargement fini"\n\nmsgid "Failed loading world."\nmsgstr "Le chargement des fichiers a échoué."\n\nmsgid "Show World Info"\nmsgstr "Afficher World Info"\n\nmsgid "Viewpoint is copied to clipboard."\nmsgstr "Le point de vue est copié dans le presse-papiers."\n'})),define("locale/gettext",["text!locale/de.po","text!locale/fr.po"],(function(t,e){"use strict";var i={en:"C",de:t,fr:e},n=/msgid\s+"(.*?)"\nmsgstr\s+"(.*?)"\n/g,r=function(){for(var t=0;t<navigator.languages;++t){var e=navigator.languages[t].split("-")[0];if(i[e])return e}return(navigator.language||navigator.userLanguage).split("-")[0]}();return function(t){if(i[t])for(var e=function(t,e){for(var i=null,n=[];i=t.exec(e);)n.push(i);return n}(n,i[t]),r=i[t]={},s=0,o=e.length;s<o;++s)e[s][2].length&&(r[e[s][1]]=e[s][2])}(r),function(t){var e=i[r];if(void 0===e)return t;var n=e[t];return void 0===n?t:n}})),define("x_ite/Browser/Core/BrowserTimings",["jquery","x_ite/Base/X3DBaseNode","locale/gettext"],(function(t,e,i){"use strict";function n(t){return t.toFixed(2)}function r(t){e.call(this,t),this.localStorage=this.getBrowser().getLocalStorage().addNameSpace("BrowserTimings."),this.enabled=!1}return r.prototype=Object.assign(Object.create(e.prototype),{constructor:r,getTypeName:function(){return"BrowserTimings"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"browserTimings"},initialize:function(){e.prototype.initialize.call(this),this.localStorage.addDefaultValues({type:"LESS"}),this.localeOptions={minimumFractionDigits:2,maximumFractionDigits:2},this.startTime=0,this.frames=0,this.element=t("<div></div>").hide().addClass("x_ite-private-browser-timings").appendTo(this.getBrowser().getSurface()),this.table=t("<table></table>").appendTo(this.element),this.header=t("<thead></thead>").append(t("<tr></tr>").append(t("<th colspan='2'></th>"))).appendTo(this.table),this.body=t("<tbody></tbody>").appendTo(this.table),this.footer=t("<tfoot></tfoot>").append(t("<tr></tr>").append(t("<td colspan='2'></td>"))).appendTo(this.table),this.button=t("<button></button>").attr("type","button").appendTo(this.footer.find("td")),this.rows=[],this.button.on("click touchend",this.set_type__.bind(this)),this.set_button__()},getEnabled:function(){return this.enabled},setEnabled:function(t){this.enabled!==t&&(this.enabled=t,t?(this.element.stop(!0,!0).fadeIn(),this.getBrowser().prepareEvents().addInterest("update",this),this.update()):(this.element.stop(!0,!0).fadeOut(),this.getBrowser().prepareEvents().removeInterest("update",this)))},set_type__:function(){"MORE"===this.localStorage.type?this.localStorage.type="LESS":this.localStorage.type="MORE",this.set_button__(),this.build()},set_button__:function(){"MORE"===this.localStorage.type?this.button.text(i("Less Properties")):this.button.text(i("More Properties"))},update:function(){const t=this.getBrowser().getCurrentTime();t-this.startTime>1?(this.build(),this.frames=0,this.startTime=t):++this.frames},build:function(){const e=this.getBrowser(),r=e.getCurrentTime(),s=navigator.language||navigator.userLanguage,o=this.localeOptions,a=this.rows;let u=0;if(a[u++]=t("<tr></tr>").append(t("<td></td>").text(i("Frame rate")+":")).append(t("<td></td>").text(n(this.frames/(r-this.startTime)).toLocaleString(s,o)+" "+i("fps"))),a[u++]=t("<tr></tr>").append(t("<td></td>").text(i("Speed")+":")).append(t("<td></td>").text(n(this.getSpeed(e.currentSpeed)).toLocaleString(s,o)+" "+this.getSpeedUnit(e.currentSpeed))),"MORE"===this.localStorage.type){const r=e.getWorld().getLayerSet().getLayers(),l=e.getActiveLayer(),c=e.getSystemTime(),h=l&&e.getCollisionCount()?l.collisionTime:0,d=e.getCollisionTime()+h,p=e.getBrowserTime()-(e.getCameraTime()+e.getCollisionTime()+e.getDisplayTime()+h),f=e.prepareEvents().getInterests().size-1,g=e.sensorEvents().getInterests().size;let m=0,_=0;for(const t of r)m+=t.numOpaqueShapes,_+=t.numTransparentShapes;a[1].addClass("x_ite-private-more"),a[u++]=t("<tr></tr>").append(t("<td></td>").text(i("Browser")+":")).append(t("<td></td>").text(n(c).toLocaleString(s,o)+" "+i("ms"))),a[u++]=t("<tr></tr>").append(t("<td></td>").text(i("X3D total")+":")).append(t("<td></td>").text(n(e.getBrowserTime()).toLocaleString(s,o)+" "+i("ms"))),a[u++]=t("<tr></tr>").append(t("<td></td>").text(i("Event Processing")+":")).append(t("<td></td>").text(n(p).toLocaleString(s,o)+" "+i("ms"))),a[u++]=t("<tr></tr>").append(t("<td></td>").text(i("Pointer")+":")).append(t("<td></td>").text(n(e.getPointerTime()).toLocaleString(s,o)+" "+i("ms"))),a[u++]=t("<tr></tr>").append(t("<td></td>").text(i("Camera")+":")).append(t("<td></td>").text(n(e.getCameraTime()).toLocaleString(s,o)+" "+i("ms"))),a[u++]=t("<tr></tr>").append(t("<td></td>").text(i("Picking")+":")).append(t("<td></td>").text(n(e.getPickingTime()).toLocaleString(s,o)+" "+i("ms"))),a[u++]=t("<tr></tr>").append(t("<td></td>").text(i("Collision Detection")+":")).append(t("<td></td>").text(n(d).toLocaleString(s,o)+" "+i("ms"))),a[u++]=t("<tr></tr>").append(t("<td></td>").text(i("Rendering")+":")).append(t("<td></td>").text(n(e.getDisplayTime()).toLocaleString(s,o)+" "+i("ms"))),a[u++]=t("<tr></tr>").append(t("<td></td>").text(i("Number of Shapes")+":")).append(t("<td></td>").text(m+" + "+_)),a[u++]=t("<tr></tr>").append(t("<td></td>").text(i("Number of Sensors")+":")).append(t("<td></td>").text(f+g))}a.length=u,this.header.find("th").text(i("Browser Timings")),this.body.empty(),this.body.append(a)},getSpeed:function(t){return t<15?t:3.6*t},getSpeedUnit:function(t){return i(t<15?"m/s":"km/h")}}),r})),define("x_ite/Browser/Core/PrimitiveQuality",[],(function(){"use strict";let t=0;return{LOW:t++,MEDIUM:t++,HIGH:t++}})),define("x_ite/Browser/Core/Shading",[],(function(){"use strict";let t=0;return{POINT:t++,WIREFRAME:t++,FLAT:t++,GOURAUD:t++,PHONG:t++}})),define("x_ite/Browser/Core/TextureQuality",[],(function(){"use strict";let t=0;return{LOW:t++,MEDIUM:t++,HIGH:t++}})),define("x_ite/Browser/Core/BrowserOptions",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Base/X3DBaseNode","x_ite/Base/X3DConstants","x_ite/Browser/Core/PrimitiveQuality","x_ite/Browser/Core/Shading","x_ite/Browser/Core/TextureQuality"],(function(t,e,i,n,r,s,o,a){"use strict";function u(t){n.call(this,t),this.addAlias("AntiAliased",this._Antialiased);const e=this.getBrowser();this.localStorage=e.getLocalStorage().addNameSpace("BrowserOptions."),this.textureQuality=a.MEDIUM,this.primitiveQuality=s.MEDIUM,this.shading=o.GOURAUD,this.setAttributeSplashScreen()}function l(t,e){return"TRUE"===(t=String(t).toUpperCase())||"FALSE"!==t&&e}return u.prototype=Object.assign(Object.create(n.prototype),{constructor:u,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"SplashScreen",new t.SFBool(!0)),new e(r.inputOutput,"Dashboard",new t.SFBool(!0)),new e(r.inputOutput,"Rubberband",new t.SFBool(!0)),new e(r.inputOutput,"EnableInlineViewpoints",new t.SFBool(!0)),new e(r.inputOutput,"Antialiased",new t.SFBool(!0)),new e(r.inputOutput,"TextureQuality",new t.SFString("MEDIUM")),new e(r.inputOutput,"PrimitiveQuality",new t.SFString("MEDIUM")),new e(r.inputOutput,"QualityWhenMoving",new t.SFString("MEDIUM")),new e(r.inputOutput,"Shading",new t.SFString("GOURAUD")),new e(r.inputOutput,"MotionBlur",new t.SFBool),new e(r.inputOutput,"Gravity",new t.SFFloat(9.80665)),new e(r.inputOutput,"StraightenHorizon",new t.SFBool(!0)),new e(r.inputOutput,"LogarithmicDepthBuffer",new t.SFBool(!1)),new e(r.inputOutput,"Timings",new t.SFBool(!1))]),getTypeName:function(){return"BrowserOptions"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"browserOptions"},initialize:function(){n.prototype.initialize.call(this),this.localStorage.addDefaultValues({Rubberband:this._Rubberband.getValue(),PrimitiveQuality:this._PrimitiveQuality.getValue(),TextureQuality:this._TextureQuality.getValue(),StraightenHorizon:this._StraightenHorizon.getValue(),Timings:this._Timings.getValue()}),this._SplashScreen.addInterest("set_splashScreen__",this),this._Rubberband.addInterest("set_rubberband__",this),this._PrimitiveQuality.addInterest("set_primitiveQuality__",this),this._TextureQuality.addInterest("set_textureQuality__",this),this._Shading.addInterest("set_shading__",this),this._StraightenHorizon.addInterest("set_straightenHorizon__",this),this._LogarithmicDepthBuffer.addInterest("set_logarithmicDepthBuffer__",this),this._Timings.addInterest("set_timings__",this),this.configure()},configure:function(){if(!this.isInitialized())return;const t=this.localStorage;for(const e of this.getFieldDefinitions()){const i=this.getField(e.name);void 0===t[e.name]&&(i.equals(e.value)||i.assign(e.value))}const e=t.Rubberband,i=t.PrimitiveQuality,n=t.TextureQuality,r=t.StraightenHorizon,s=t.Timings;this.setAttributeSplashScreen(),e!==this._Rubberband.getValue()&&(this._Rubberband=e),i!==this._PrimitiveQuality.getValue()&&(this._PrimitiveQuality=i),n!==this._TextureQuality.getValue()&&(this._TextureQuality=n),r!==this._StraightenHorizon.getValue()&&(this._StraightenHorizon=r),s!==this._Timings.getValue()&&(this._Timings=s)},setAttributeSplashScreen:function(){this._SplashScreen.set(this.getSplashScreen())},getCache:function(){return l(this.getBrowser().getElement().attr("cache"),!0)},getContextMenu:function(){return l(this.getBrowser().getElement().attr("contextMenu"),!0)},getDebug:function(){return l(this.getBrowser().getElement().attr("debug"),!1)},getNotifications:function(){return l(this.getBrowser().getElement().attr("notifications"),!0)},getSplashScreen:function(){return l(this.getBrowser().getElement().attr("splashScreen"),!0)},getPrimitiveQuality:function(){return this.primitiveQuality},getShading:function(){return this.shading},getTextureQuality:function(){return this.textureQuality},set_splashScreen__:function(t){this.getBrowser().getElement().attr("splashScreen",t.getValue()?"true":"false")},set_rubberband__:function(t){this.localStorage.Rubberband=t.getValue(),this.getBrowser().getViewer().loadShaders()},set_primitiveQuality__:function(t){const e=this.getBrowser(),i=t.getValue().toUpperCase();this.localStorage.PrimitiveQuality=i,this.primitiveQuality=this.getEnum(s,i,s.MEDIUM),"function"==typeof e.setPrimitiveQuality2D&&e.setPrimitiveQuality2D(this.primitiveQuality),"function"==typeof e.setPrimitiveQuality3D&&e.setPrimitiveQuality3D(this.primitiveQuality)},set_textureQuality__:function(t){const e=this.getBrowser(),i=t.getValue().toUpperCase();this.localStorage.TextureQuality=i,this.textureQuality=this.getEnum(a,i,a.MEDIUM),"function"==typeof e.setTextureQuality&&e.setTextureQuality(this.textureQuality)},set_shading__:function(t){const e=t.getValue().toUpperCase().replace("POINTSET","POINT");this.shading=this.getEnum(o,e,o.GOURAUD),this.getBrowser().setShading(this.shading)},set_straightenHorizon__:function(t){this.localStorage.StraightenHorizon=t.getValue()},set_logarithmicDepthBuffer__:function(t){const e=this.getBrowser(),i=e.getContext();e.getRenderingProperties()._LogarithmicDepthBuffer=!(!t.getValue()||!(i.getVersion()>=2||i.getExtension("EXT_frag_depth")))},set_timings__:function(t){this.localStorage.Timings=t.getValue(),this.getBrowser().getBrowserTimings().setEnabled(t.getValue())}}),u})),define("x_ite/Browser/Core/BrowserProperties",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Base/X3DBaseNode","x_ite/Base/X3DConstants"],(function(t,e,i,n,r){"use strict";function s(t){n.call(this,t)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.initializeOnly,"ABSTRACT_NODES",new t.SFBool(!0)),new e(r.initializeOnly,"CONCRETE_NODES",new t.SFBool(!0)),new e(r.initializeOnly,"EXTERNAL_INTERACTIONS",new t.SFBool(!0)),new e(r.initializeOnly,"PROTOTYPE_CREATE",new t.SFBool(!0)),new e(r.initializeOnly,"DOM_IMPORT",new t.SFBool(!0)),new e(r.initializeOnly,"XML_ENCODING",new t.SFBool(!0)),new e(r.initializeOnly,"CLASSIC_VRML_ENCODING",new t.SFBool(!0)),new e(r.initializeOnly,"BINARY_ENCODING",new t.SFBool)]),getTypeName:function(){return"BrowserProperties"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"browserProperties"}}),s})),define("x_ite/Browser/Core/RenderingProperties",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Base/X3DBaseNode","x_ite/Base/X3DConstants"],(function(t,e,i,n,r){"use strict";function s(t){n.call(this,t),this.addAlias("AntiAliased",this._Antialiased)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.outputOnly,"Shading",new t.SFString),new e(r.outputOnly,"MaxTextureSize",new t.SFInt32),new e(r.outputOnly,"TextureUnits",new t.SFInt32),new e(r.outputOnly,"MaxLights",new t.SFInt32),new e(r.outputOnly,"Antialiased",new t.SFBool(!0)),new e(r.outputOnly,"ColorDepth",new t.SFInt32),new e(r.outputOnly,"TextureMemory",new t.SFDouble),new e(r.outputOnly,"LogarithmicDepthBuffer",new t.SFBool(!1))]),getTypeName:function(){return"RenderingProperties"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"renderingProperties"},initialize:function(){n.prototype.initialize.call(this);const t=this.getBrowser();this._MaxTextureSize=t.getMaxTextureSize(),this._TextureUnits=t.getMaxCombinedTextureUnits(),this._MaxLights=t.getMaxLights(),this._ColorDepth=t.getColorDepth(),this._TextureMemory=t.getTextureMemory(),t.getBrowserOptions()._Shading.addInterest("set_shading__",this),this.set_shading__(t.getBrowserOptions()._Shading)},set_shading__:function(t){this._Shading=t}}),s})),define("x_ite/Browser/Core/Notification",["jquery","x_ite/Fields/SFString","x_ite/Base/X3DBaseNode"],(function(t,e,i){"use strict";function n(t){i.call(this,t),this.addChildObjects("string",new e)}return t.fn.textWidth=function(e){const i=t(this).children(),n="<span>"+t(this).html()+"</span>";t(this).html(n);const r=t(this).find("span:first").width();return t(this).empty(),t(this).append(i),r},n.prototype=Object.assign(Object.create(i.prototype),{constructor:n,getTypeName:function(){return"Notification"},getComponentName:function(){return"X_ITE"},initialize:function(){i.prototype.initialize.call(this),this.element=t("<div></div>").hide().addClass("x_ite-private-notification").appendTo(this.getBrowser().getSurface()).animate({width:0}),t("<span></span>").appendTo(this.element),this._string.addInterest("set_string__",this)},set_string__:function(){this.getBrowser().getBrowserOptions().getNotifications()&&0!==this._string.length&&(this.element.children().text(this._string.getValue()),this.element.stop(!0,!0).fadeIn(0).animate({width:this.element.textWidth()}).animate({delay:1},5e3).animate({width:0}).fadeOut(0))}}),n})),define("x_ite/Components/Core/X3DNode",["x_ite/Fields","x_ite/Base/X3DBaseNode","x_ite/Base/X3DConstants","x_ite/InputOutput/Generator"],(function(t,e,i,n){"use strict";function r(t){e.call(this,t),this.addType(i.X3DNode)}return r.prototype=Object.assign(Object.create(e.prototype),{constructor:r,copy:function(t){if(!t||t.getType().includes(i.X3DExecutionContext))return e.prototype.copy.call(this,t);{const e=t.getBody();if(this.getName().length){const t=e.getNamedNodes().get(this.getName());if(t)return t}const n=this.create(e);this.getNeedsName()&&this.getExecutionContext().updateNamedNode(this.getExecutionContext().getUniqueName(),this),this.getName().length&&e.updateNamedNode(this.getName(),n);for(const e of this.getPredefinedFields())try{const r=n.getField(e.getName());if(e.hasReferences())for(const i of e.getReferences())try{r.addReference(t.getField(i.getName()))}catch(t){console.error(t.message)}else if(e.getAccessType()&i.initializeOnly)switch(e.getType()){case i.SFNode:case i.MFNode:r.assign(e.copy(t));break;default:r.assign(e)}r.setModificationTime(e.getModificationTime())}catch(t){console.log(t.message)}for(const e of this.getUserDefinedFields()){const i=e.copy(t);if(n.addUserDefinedField(e.getAccessType(),e.getName(),i),e.hasReferences())for(const n of e.getReferences())try{i.addReference(t.getField(n.getName()))}catch(e){console.error("No reference '"+n.getName()+"' inside execution context "+t.getTypeName()+" '"+t.getName()+"'.")}i.setModificationTime(e.getModificationTime())}return n.setup(),n}},getDisplayName:function(){const t=/_\d+$/;return function(){return this.getName().replace(t,"")}}(),getNeedsName:function(){if(this.getName().length)return!1;if(this.getCloneCount()>1)return!0;if(this.hasRoutes())return!0;const t=this.getExecutionContext();for(const e of t.getImportedNodes())if(e.getInlineNode()===this)return!0;if(t.isScene())for(const e of t.getExportedNodes())if(e.getLocalNode()===this)return!0;return!1},getFieldsAreEnumerable:function(){return!0},traverse:function(){},toStream:function(t){t.string+=this.getTypeName()+" { }"},toVRMLStream:function(t){const e=n.Get(t);e.EnterScope();const i=e.Name(this);if(i.length&&e.ExistsNode(this))return t.string+="USE",t.string+=" ",t.string+=i,void e.LeaveScope();i.length&&(e.AddNode(this),t.string+="DEF",t.string+=" ",t.string+=i,t.string+=" "),t.string+=this.getTypeName(),t.string+=" ",t.string+="{";const r=this.getChangedFields(),s=this.getUserDefinedFields();let o=0,a=0;if(this.canUserDefinedFields()){for(const t of s)o=Math.max(o,t.getTypeName().length),a=Math.max(a,e.AccessType(t.getAccessType()).length);if(s.length){t.string+="\n",e.IncIndent();for(const e of s)this.toVRMLStreamUserDefinedField(t,e,o,a),t.string+="\n";e.DecIndent(),0!==r.length&&(t.string+="\n")}}0===r.length?s.length?t.string+=e.Indent():t.string+=" ":(0===s.length&&(t.string+="\n"),e.IncIndent(),r.forEach((function(e){this.toVRMLStreamField(t,e,o,a),t.string+="\n"}),this),e.DecIndent(),t.string+=e.Indent()),t.string+="}",e.LeaveScope()},toVRMLStreamField:function(t,e,r,s){const o=n.Get(t),a=o.IsSharedNode(this);if(0===e.getReferences().size||!o.ExecutionContext()||a)e.isInitializable()&&(t.string+=o.Indent(),t.string+=e.getName(),t.string+=" ",e.toVRMLStream(t));else{let n=0,r=!1;e.getReferences().forEach((function(i){r=r||i.isInitializable(),t.string+=o.Indent(),t.string+=e.getName(),t.string+=" ",t.string+="IS",t.string+=" ",t.string+=i.getName(),++n,n!==e.getReferences().size&&(t.string+="\n")})),e.getAccessType()!==i.inputOutput||r||this.isDefaultValue(e)||(t.string+="\n",t.string+=o.Indent(),t.string+=e.getName(),t.string+=" ",e.toVRMLStream(t))}},toVRMLStreamUserDefinedField:function(t,e,r,s){const o=n.Get(t),a=o.IsSharedNode(this);if(0===e.getReferences().size||!o.ExecutionContext()||a)t.string+=o.Indent(),t.string+=o.PadRight(o.AccessType(e.getAccessType()),s),t.string+=" ",t.string+=o.PadRight(e.getTypeName(),r),t.string+=" ",t.string+=e.getName(),e.isInitializable()&&(t.string+=" ",e.toVRMLStream(t));else{let n=0,a=!1;e.getReferences().forEach((function(i){a=a||i.isInitializable(),t.string+=o.Indent(),t.string+=o.PadRight(o.AccessType(e.getAccessType()),s),t.string+=" ",t.string+=o.PadRight(e.getTypeName(),r),t.string+=" ",t.string+=e.getName(),t.string+=" ",t.string+="IS",t.string+=" ",t.string+=i.getName(),++n,n!==e.getReferences().size&&(t.string+="\n")})),e.getAccessType()!==i.inputOutput||a||e.isDefaultValue()||(t.string+="\n",t.string+=o.Indent(),t.string+=o.PadRight(o.AccessType(e.getAccessType()),s),t.string+=" ",t.string+=o.PadRight(e.getTypeName(),r),t.string+=" ",t.string+=e.getName(),e.isInitializable()&&(t.string+=" ",e.toVRMLStream(t)))}},toXMLStream:function(t){const e=n.Get(t),r=e.IsSharedNode(this);e.EnterScope();const s=e.Name(this);if(s.length&&e.ExistsNode(this)){t.string+=e.Indent(),t.string+="<",t.string+=this.getTypeName(),t.string+=" ",t.string+="USE='",t.string+=e.XMLEncode(s),t.string+="'";const i=e.ContainerField();return i&&i.getName()!==this.getContainerField()&&(t.string+=" ",t.string+="containerField='",t.string+=e.XMLEncode(i.getName()),t.string+="'"),t.string+="/>",void e.LeaveScope()}t.string+=e.Indent(),t.string+="<",t.string+=this.getTypeName(),s.length&&(e.AddNode(this),t.string+=" ",t.string+="DEF='",t.string+=e.XMLEncode(s),t.string+="'");const o=e.ContainerField();o&&o.getName()!==this.getContainerField()&&(t.string+=" ",t.string+="containerField='",t.string+=e.XMLEncode(o.getName()),t.string+="'");const a=this.getChangedFields(),u=this.getUserDefinedFields(),l=[],c=[];let h=this.getSourceText();h&&0===h.length&&(h=null),e.IncIndent(),e.IncIndent();for(const n of a){let s=!1;if(e.ExecutionContext()&&n.getAccessType()===i.inputOutput&&0!==n.getReferences().size){let t=!1;n.getReferences().forEach((function(e){t=t||e.isInitializable()})),t||(s=!this.isDefaultValue(n))}if(0===n.getReferences().size||!e.ExecutionContext()||r||s){if(s&&l.push(n),n.isInitializable())switch(n.getType()){case i.SFNode:case i.MFNode:c.push(n);break;default:if(n===h)break;t.string+="\n",t.string+=e.Indent(),t.string+=n.getName(),t.string+="='",n.toXMLStream(t),t.string+="'"}}else l.push(n)}if(e.DecIndent(),e.DecIndent(),this.canUserDefinedFields()&&u.length||l.length&&!r||c.length||h){if(t.string+=">\n",e.IncIndent(),this.canUserDefinedFields())for(const n of u){t.string+=e.Indent(),t.string+="<field",t.string+=" ",t.string+="accessType='",t.string+=e.AccessType(n.getAccessType()),t.string+="'",t.string+=" ",t.string+="type='",t.string+=n.getTypeName(),t.string+="'",t.string+=" ",t.string+="name='",t.string+=e.XMLEncode(n.getName()),t.string+="'";let s=!1;if(n.getAccessType()===i.inputOutput&&0!==n.getReferences().size){let t=!1;n.getReferences().forEach((function(e){t=t||e.isInitializable()})),t||(s=!0)}if(0===n.getReferences().size||!e.ExecutionContext()||r||s)if(s&&e.ExecutionContext()&&l.push(n),!n.isInitializable()||n.isDefaultValue())t.string+="/>\n";else switch(n.getType()){case i.SFNode:case i.MFNode:e.PushContainerField(n),t.string+=">\n",e.IncIndent(),n.toXMLStream(t),t.string+="\n",e.DecIndent(),t.string+=e.Indent(),t.string+="</field>\n",e.PopContainerField();break;default:t.string+=" ",t.string+="value='",n.toXMLStream(t),t.string+="'",t.string+="/>\n"}else e.ExecutionContext()&&l.push(n),t.string+="/>\n"}if(l.length&&!r){t.string+=e.Indent(),t.string+="<IS>",t.string+="\n",e.IncIndent();for(const i of l){i.getReferences().forEach((function(n){t.string+=e.Indent(),t.string+="<connect",t.string+=" ",t.string+="nodeField='",t.string+=e.XMLEncode(i.getName()),t.string+="'",t.string+=" ",t.string+="protoField='",t.string+=e.XMLEncode(n.getName()),t.string+="'",t.string+="/>\n"}))}e.DecIndent(),t.string+=e.Indent(),t.string+="</IS>\n"}for(const i of c)e.PushContainerField(i),i.toXMLStream(t),t.string+="\n",e.PopContainerField();if(h)for(const i of h)t.string+="<![CDATA[",t.string+=e.escapeCDATA(i),t.string+="]]>\n";e.DecIndent(),t.string+=e.Indent(),t.string+="</",t.string+=this.getTypeName(),t.string+=">"}else t.string+="/>";e.LeaveScope()},dispose:function(){const i=this.getExecutionContext();if(this.getName()&&i.removeNamedNode(this.getName()),!i.isMainScene()){const t=i.getExecutionContext();for(const e of t.getImportedNodes())try{e.getExportedNode()===this&&t.removeImportedNode(e.getImportedName())}catch(t){}}if(i.isScene())for(const t of i.getExportedNodes())t.getLocalNode()===this&&i.removeExportedNode(t.getExportedName());for(const t of this.getFields())t.dispose();for(const e of new Set(this.getParents()))if(e instanceof t.SFNode){for(const i of new Set(e.getParents()))if(i instanceof t.MFNode){const t=i.length;i.erase(i.remove(0,t,e),t)}e.setValue(null)}e.prototype.dispose.call(this)}}),r})),define("x_ite/Components/Core/X3DChildNode",["x_ite/Fields","x_ite/Components/Core/X3DNode","x_ite/Base/X3DConstants"],(function(t,e,i){"use strict";function n(n){this.getExecutionContext()||(e.call(this,n),this.addType(i.X3DChildNode),this.addChildObjects("isCameraObject",new t.SFBool),this.addChildObjects("isPickableObject",new t.SFBool),this._isCameraObject.setAccessType(i.outputOnly),this._isPickableObject.setAccessType(i.outputOnly))}return n.prototype=Object.assign(Object.create(e.prototype),{constructor:n,setCameraObject:function(t){t!==this._isCameraObject.getValue()&&(this._isCameraObject=t)},getCameraObject:function(){return this._isCameraObject.getValue()},setPickableObject:function(t){t!==this._isPickableObject.getValue()&&(this._isPickableObject=t)},getPickableObject:function(){return this._isPickableObject.getValue()}}),n})),define("x_ite/Components/Core/X3DBindableNode",["x_ite/Fields","x_ite/Components/Core/X3DChildNode","x_ite/Base/X3DConstants"],(function(t,e,i){"use strict";function n(n){e.call(this,n),this.addType(i.X3DBindableNode),this.addChildObjects("transitionActive",new t.SFBool)}return n.prototype=Object.assign(Object.create(e.prototype),{constructor:n,getCameraObject:function(){return!0},transitionStart:function(){}}),n})),define("x_ite/Components/Core/X3DSensorNode",["x_ite/Components/Core/X3DChildNode","x_ite/Base/X3DConstants"],(function(t,e){"use strict";function i(i){t.call(this,i),this.addType(e.X3DSensorNode)}return i.prototype=Object.assign(Object.create(t.prototype),{constructor:i}),i})),define("x_ite/Components/Time/X3DTimeDependentNode",["x_ite/Fields","x_ite/Components/Core/X3DChildNode","x_ite/Base/X3DConstants"],(function(t,e,i){"use strict";function n(e){this.addType(i.X3DTimeDependentNode),this.addChildObjects("initialized",new t.SFTime,"isEvenLive",new t.SFBool),this.startTimeValue=0,this.pauseTimeValue=0,this.resumeTimeValue=0,this.stopTimeValue=0,this.start=0,this.pause=0,this.pauseInterval=0,this.startTimeout=null,this.pauseTimeout=null,this.resumeTimeout=null,this.stopTimeout=null,this.disabled=!1}return n.prototype=Object.assign(Object.create(e.prototype),{constructor:n,initialize:function(){this.isLive().addInterest("set_live__",this),this._isEvenLive.addInterest("set_live__",this),this._initialized.addInterest("set_loop__",this),this._enabled.addInterest("set_enabled__",this),this._loop.addInterest("set_loop__",this),this._startTime.addInterest("set_startTime__",this),this._pauseTime.addInterest("set_pauseTime__",this),this._resumeTime.addInterest("set_resumeTime__",this),this._stopTime.addInterest("set_stopTime__",this),this.startTimeValue=this._startTime.getValue(),this.pauseTimeValue=this._pauseTime.getValue(),this.resumeTimeValue=this._resumeTime.getValue(),this.stopTimeValue=this._stopTime.getValue(),this._initialized=this.getBrowser().getCurrentTime()},getDisabled:function(){return this.disabled},getLiveState:function(){return this.getLive()&&(this.getExecutionContext().isLive().getValue()||this._isEvenLive.getValue())},getElapsedTime:function(){return this.getBrowser().getCurrentTime()-this.start-this.pauseInterval},resetElapsedTime:function(){this.start=this.getBrowser().getCurrentTime(),this.pause=this.getBrowser().getCurrentTime(),this.pauseInterval=0},set_live__:function(){this.isLive().getValue()||this._isEvenLive.getValue()?this.disabled&&(this.disabled=!1,this._isActive.getValue()&&!this._isPaused.getValue()&&this.real_resume()):this.disabled||!this._isActive.getValue()||this._isPaused.getValue()||(this.disabled=!0,this.real_pause())},set_enabled__:function(){this._enabled.getValue()?this.set_loop__():this.stop()},set_loop__:function(){this._enabled.getValue()&&this._loop.getValue()&&this.stopTimeValue<=this.startTimeValue&&this.startTimeValue<=this.getBrowser().getCurrentTime()&&this.do_start()},set_startTime__:function(){this.startTimeValue=this._startTime.getValue(),this._enabled.getValue()&&(this.removeTimeout("startTimeout"),this.startTimeValue<=this.getBrowser().getCurrentTime()?this.do_start():this.addTimeout("startTimeout","do_start",this.startTimeValue))},set_pauseTime__:function(){if(this.pauseTimeValue=this._pauseTime.getValue(),this._enabled.getValue()){if(this.removeTimeout("pauseTimeout"),this.pauseTimeValue<=this.resumeTimeValue)return;this.pauseTimeValue<=this.getBrowser().getCurrentTime()?this.do_pause():this.addTimeout("pauseTimeout","do_pause",this.pauseTimeValue)}},set_resumeTime__:function(){if(this.resumeTimeValue=this._resumeTime.getValue(),this._enabled.getValue()){if(this.removeTimeout("resumeTimeout"),this.resumeTimeValue<=this.pauseTimeValue)return;this.resumeTimeValue<=this.getBrowser().getCurrentTime()?this.do_resume():this.addTimeout("resumeTimeout","do_resume",this.resumeTimeValue)}},set_stopTime__:function(){if(this.stopTimeValue=this._stopTime.getValue(),this._enabled.getValue()){if(this.removeTimeout("stopTimeout"),this.stopTimeValue<=this.startTimeValue)return;this.stopTimeValue<=this.getBrowser().getCurrentTime()?this.do_stop():this.addTimeout("stopTimeout","do_stop",this.stopTimeValue)}},do_start:function(){this._isActive.getValue()||(this.resetElapsedTime(),this._isActive=!0,this.set_start(),this.isLive().getValue()?this.getBrowser().timeEvents().addInterest("set_time",this):(this.disabled=!0,this.real_pause()),this._elapsedTime=0)},do_pause:function(){this._isActive.getValue()&&!this._isPaused.getValue()&&(this._isPaused=!0,this.pauseTimeValue!==this.getBrowser().getCurrentTime()&&(this.pauseTimeValue=this.getBrowser().getCurrentTime()),this.isLive().getValue()&&this.real_pause())},real_pause:function(){this.pause=performance.now(),this.set_pause(),this.getBrowser().timeEvents().removeInterest("set_time",this)},do_resume:function(){this._isActive.getValue()&&this._isPaused.getValue()&&(this._isPaused=!1,this.resumeTimeValue!==this.getBrowser().getCurrentTime()&&(this.resumeTimeValue=this.getBrowser().getCurrentTime()),this.isLive().getValue()&&this.real_resume())},real_resume:function(){const t=(performance.now()-this.pause)/1e3;this.pauseInterval+=t,this.set_resume(t),this.getBrowser().timeEvents().addInterest("set_time",this),this.getBrowser().addBrowserEvent()},do_stop:function(){this.stop()},stop:function(){this._isActive.getValue()&&(this.set_stop(),this._elapsedTime=this.getElapsedTime(),this._isPaused.getValue()&&(this._isPaused=!1),this._isActive=!1,this.getBrowser().timeEvents().removeInterest("set_time",this))},timeout:function(t){this._enabled.getValue()&&(this.getBrowser().advanceTime(performance.now()),this[t]())},addTimeout:function(t,e,i){this.removeTimeout(t),this[t]=setTimeout(this.timeout.bind(this,e),1e3*(i-this.getBrowser().getCurrentTime()))},removeTimeout:function(t){clearTimeout(this[t]),this[t]=null},set_start:function(){},set_pause:function(){},set_resume:function(){},set_stop:function(){},set_time:function(){}}),n})),define("x_ite/Components/Time/TimeSensor",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Core/X3DSensorNode","x_ite/Components/Time/X3DTimeDependentNode","x_ite/Base/X3DConstants","standard/Math/Algorithm"],(function(t,e,i,n,r,s,o){"use strict";function a(e){n.call(this,e),r.call(this,e),this.addType(s.TimeSensor),this.addChildObjects("range",new t.MFFloat(0,0,1)),this.cycle=0,this.interval=0,this.fraction=0,this.first=0,this.last=1,this.scale=1}return a.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:a,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.inputOutput,"enabled",new t.SFBool(!0)),new e(s.inputOutput,"cycleInterval",new t.SFTime(1)),new e(s.inputOutput,"loop",new t.SFBool),new e(s.inputOutput,"startTime",new t.SFTime),new e(s.inputOutput,"resumeTime",new t.SFTime),new e(s.inputOutput,"pauseTime",new t.SFTime),new e(s.inputOutput,"stopTime",new t.SFTime),new e(s.outputOnly,"isPaused",new t.SFBool),new e(s.outputOnly,"isActive",new t.SFBool),new e(s.outputOnly,"cycleTime",new t.SFTime),new e(s.outputOnly,"elapsedTime",new t.SFTime),new e(s.outputOnly,"fraction_changed",new t.SFFloat),new e(s.outputOnly,"time",new t.SFTime)]),getTypeName:function(){return"TimeSensor"},getComponentName:function(){return"Time"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),r.prototype.initialize.call(this),this._cycleInterval.addInterest("set_cycleInterval__",this),this._range.addInterest("set_range__",this)},setRange:function(t,e,i){const n=this.getBrowser().getCurrentTime(),r=this._startTime.getValue(),s=this._cycleInterval.getValue();this.first=e,this.last=i,this.scale=this.last-this.first,this.interval=s*this.scale,this.fraction=o.fract((t>=1?0:t)+(this.interval?(n-r)/this.interval:0)),this.cycle=n-(this.fraction-this.first)*s},set_cycleInterval__:function(){this._isActive.getValue()&&this.setRange(this.fraction,this._range[1],this._range[2])},set_range__:function(){this._isActive.getValue()&&(this.setRange(this._range[0],this._range[1],this._range[2]),this._isPaused.getValue()||this.set_fraction(this.getBrowser().getCurrentTime()))},set_start:function(){this.setRange(this._range[0],this._range[1],this._range[2]),this.isLive().getValue()&&(this._fraction_changed=this.fraction,this._time=this.getBrowser().getCurrentTime())},set_resume:function(t){const e=this.getBrowser().getCurrentTime(),i=this._startTime.getValue();this.setRange(this.interval?o.fract(this.fraction-(e-i)/this.interval):0,this._range[1],this._range[2])},set_fraction:function(t){this._fraction_changed=this.fraction=this.first+(this.interval?o.fract((t-this.cycle)/this.interval):0)*this.scale},set_time:function(){const t=this.getBrowser().getCurrentTime();t-this.cycle>=this.interval?this._loop.getValue()?this.interval&&(this.cycle+=this.interval*Math.floor((t-this.cycle)/this.interval),this._elapsedTime=this.getElapsedTime(),this._cycleTime=t,this.set_fraction(t)):(this._fraction_changed=this.fraction=this.last,this.stop()):(this._elapsedTime=this.getElapsedTime(),this.set_fraction(t)),this._time=t}}),a})),define("x_ite/Components/Interpolation/X3DInterpolatorNode",["x_ite/Components/Core/X3DChildNode","x_ite/Base/X3DConstants","standard/Math/Algorithm"],(function(t,e,i){"use strict";function n(i){t.call(this,i),this.addType(e.X3DInterpolatorNode)}return n.prototype=Object.assign(Object.create(t.prototype),{constructor:n,setup:function(){this.set_key__(),this._key.length&&this.interpolate(0,0,0),t.prototype.setup.call(this)},initialize:function(){t.prototype.initialize.call(this),this._set_fraction.addInterest("set_fraction__",this),this._key.addInterest("set_key__",this)},set_fraction__:function(){const t=this._key,e=t.length,n=this._set_fraction.getValue();switch(e){case 0:return;case 1:return this.interpolate(0,0,0);default:{if(n<=t[0])return this.interpolate(0,1,0);const r=i.upperBound(t,0,e,n);if(r!==e){const e=r-1,s=(n-t[e])/(t[r]-t[e]);this.interpolate(e,r,i.clamp(s,0,1))}else this.interpolate(e-2,e-1,1)}}},set_key__:function(){this.set_keyValue__()},set_keyValue__:function(){},interpolate:function(){}}),n})),define("x_ite/Components/Interpolation/EaseInEaseOut",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Base/X3DConstants"],(function(t,e,i,n,r){"use strict";function s(t){n.call(this,t),this.addType(r.EaseInEaseOut)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOnly,"set_fraction",new t.SFFloat),new e(r.inputOutput,"key",new t.MFFloat),new e(r.inputOutput,"easeInEaseOut",new t.MFVec2f),new e(r.outputOnly,"modifiedFraction_changed",new t.SFFloat)]),getTypeName:function(){return"EaseInEaseOut"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this._easeInEaseOut.addInterest("set_keyValue__",this)},set_keyValue__:function(){this._easeInEaseOut.length<this._key.length&&this._easeInEaseOut.resize(this._key.length,this._easeInEaseOut.length?this._easeInEaseOut[this._easeInEaseOut.length-1]:new t.SFVec2f)},interpolate:function(t,e,i){let n=this._easeInEaseOut[t].y,r=this._easeInEaseOut[e].x;const s=n+r;if(s<0)this._modifiedFraction_changed=i;else{s>1&&(r/=s,n/=s);const t=1/(2-n-r);if(i<n)this._modifiedFraction_changed=t/n*i*i;else if(i<=1-r)this._modifiedFraction_changed=t*(2*i-n);else{const e=1-i;this._modifiedFraction_changed=1-t*e*e/r}}}}),s})),define("x_ite/Components/Interpolation/PositionInterpolator",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3"],(function(t,e,i,n,r,s){"use strict";function o(t){n.call(this,t),this.addType(r.PositionInterpolator)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOnly,"set_fraction",new t.SFFloat),new e(r.inputOutput,"key",new t.MFFloat),new e(r.inputOutput,"keyValue",new t.MFVec3f),new e(r.outputOnly,"value_changed",new t.SFVec3f)]),getTypeName:function(){return"PositionInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this._keyValue.addInterest("set_keyValue__",this)},set_keyValue__:function(){const e=this._key,i=this._keyValue;i.length<e.length&&i.resize(e.length,i.length?i[i.length-1]:new t.SFVec3f)},interpolate:function(){const t=new s(0,0,0);return function(e,i,n){this._value_changed=t.assign(this._keyValue[e].getValue()).lerp(this._keyValue[i].getValue(),n)}}()}),o})),define("x_ite/Components/Interpolation/OrientationInterpolator",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Rotation4"],(function(t,e,i,n,r,s){"use strict";function o(t){n.call(this,t),this.addType(r.OrientationInterpolator),this._keyValue.setUnit("angle"),this._value_changed.setUnit("angle")}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOnly,"set_fraction",new t.SFFloat),new e(r.inputOutput,"key",new t.MFFloat),new e(r.inputOutput,"keyValue",new t.MFRotation),new e(r.outputOnly,"value_changed",new t.SFRotation)]),getTypeName:function(){return"OrientationInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this._keyValue.addInterest("set_keyValue__",this)},set_keyValue__:function(){const e=this._key,i=this._keyValue;i.length<e.length&&i.resize(e.length,i.length?i[i.length-1]:new t.SFRotation)},interpolate:function(){const t=new s(0,0,1,0),e=new s(0,0,1,0);return function(i,n,r){t.assign(this._keyValue[i].getValue()),e.assign(this._keyValue[n].getValue()),this._value_changed=t.slerp(e,r)}}()}),o})),define("x_ite/Rendering/TraverseType",[],(function(){"use strict";let t=0;return{POINTER:t++,CAMERA:t++,PICKING:t++,COLLISION:t++,SHADOW:t++,DISPLAY:t++}})),define("x_ite/Components/Navigation/X3DViewpointNode",["x_ite/Fields","x_ite/Components/Core/X3DBindableNode","x_ite/Components/Time/TimeSensor","x_ite/Components/Interpolation/EaseInEaseOut","x_ite/Components/Interpolation/PositionInterpolator","x_ite/Components/Interpolation/OrientationInterpolator","x_ite/Rendering/TraverseType","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4"],(function(t,e,i,n,r,s,o,a,u,l,c){"use strict";function h(o){e.call(this,o),this.addType(a.X3DViewpointNode),this.addChildObjects("positionOffset",new t.SFVec3f,"orientationOffset",new t.SFRotation,"scaleOffset",new t.SFVec3f(1,1,1),"scaleOrientationOffset",new t.SFRotation,"centerOfRotationOffset",new t.SFVec3f,"fieldOfViewScale",new t.SFFloat(1)),this.userPosition=new u(0,1,0),this.userOrientation=new l(0,0,1,0),this.userCenterOfRotation=new u(0,0,0),this.modelMatrix=new c,this.cameraSpaceMatrix=new c(1,0,0,0,0,1,0,0,0,0,1,0,0,0,10,1),this.viewMatrix=new c(1,0,0,0,0,1,0,0,0,0,1,0,0,0,-10,1);const h=this.getBrowser();this.timeSensor=new i(h.getPrivateScene()),this.easeInEaseOut=new n(h.getPrivateScene()),this.positionInterpolator=new r(h.getPrivateScene()),this.orientationInterpolator=new s(h.getPrivateScene()),this.scaleInterpolator=new r(h.getPrivateScene()),this.scaleOrientationInterpolator=new s(h.getPrivateScene())}return h.prototype=Object.assign(Object.create(e.prototype),{constructor:h,initialize:function(){e.prototype.initialize.call(this),this.timeSensor._stopTime=1,this.timeSensor.setup(),this.easeInEaseOut._key=new t.MFFloat(0,1),this.easeInEaseOut._easeInEaseOut=new t.MFVec2f(new t.SFVec2f(0,0),new t.SFVec2f(0,0)),this.easeInEaseOut.setup(),this.positionInterpolator._key=new t.MFFloat(0,1),this.orientationInterpolator._key=new t.MFFloat(0,1),this.scaleInterpolator._key=new t.MFFloat(0,1),this.scaleOrientationInterpolator._key=new t.MFFloat(0,1),this.positionInterpolator.setup(),this.orientationInterpolator.setup(),this.scaleInterpolator.setup(),this.scaleOrientationInterpolator.setup(),this.timeSensor._isActive.addFieldInterest(this._transitionActive),this.timeSensor._fraction_changed.addFieldInterest(this.easeInEaseOut._set_fraction),this.easeInEaseOut._modifiedFraction_changed.addFieldInterest(this.positionInterpolator._set_fraction),this.easeInEaseOut._modifiedFraction_changed.addFieldInterest(this.orientationInterpolator._set_fraction),this.easeInEaseOut._modifiedFraction_changed.addFieldInterest(this.scaleInterpolator._set_fraction),this.easeInEaseOut._modifiedFraction_changed.addFieldInterest(this.scaleOrientationInterpolator._set_fraction),this.positionInterpolator._value_changed.addFieldInterest(this._positionOffset),this.orientationInterpolator._value_changed.addFieldInterest(this._orientationOffset),this.scaleInterpolator._value_changed.addFieldInterest(this._scaleOffset),this.scaleOrientationInterpolator._value_changed.addFieldInterest(this._scaleOrientationOffset),this._isBound.addInterest("set_bound__",this)},getEaseInEaseOut:function(){return this.easeInEaseOut},setInterpolators:function(){},getPosition:function(){return this._position.getValue()},getUserPosition:function(){return this.userPosition.assign(this.getPosition()).add(this._positionOffset.getValue())},getOrientation:function(){return this._orientation.getValue()},getUserOrientation:function(){return this.userOrientation.assign(this.getOrientation()).multRight(this._orientationOffset.getValue())},getCenterOfRotation:function(){return this._centerOfRotation.getValue()},getUserCenterOfRotation:function(){return this.userCenterOfRotation.assign(this.getCenterOfRotation()).add(this._centerOfRotationOffset.getValue())},getProjectionMatrix:function(t){const e=t.getNavigationInfo();return this.getProjectionMatrixWithLimits(e.getNearValue(),e.getFarValue(this),t.getLayer().getViewport().getRectangle(this.getBrowser()))},getCameraSpaceMatrix:function(){return this.cameraSpaceMatrix},getViewMatrix:function(){return this.viewMatrix},getModelMatrix:function(){return this.modelMatrix},getMaxFarValue:function(){return this.getBrowser().getRenderingProperty("LogarithmicDepthBuffer")?1e10:1e5},getUpVector:function(){return u.yAxis},getSpeedFactor:function(){return 1},setVRMLTransition:function(t){this.VRMLTransition=t},getVRMLTransition:function(){return this.VRMLTransition},transitionStart:function(){const e=new u(0,0,0),i=new l(0,0,1,0),n=new u(0,0,0),r=new l(0,0,1,0);return function(s,o,a){if(this.to=a,a._jump.getValue()){if(a._retainUserOffsets.getValue()||a.resetUserOffsets(),this!==a)for(const t of a.getFields())this.getField(t.getName()).assign(t);const u=s.getNavigationInfo(),l=u._transitionTime.getValue();let c=u.getTransitionType();switch("2.0"==this.getExecutionContext().getSpecificationVersion()&&(c=a.getVRMLTransition()?"LINEAR":"TELEPORT"),a.setVRMLTransition(!1),l<=0&&(c="TELEPORT"),c){case"TELEPORT":return void(u._transitionComplete=!0);case"ANIMATE":this.easeInEaseOut._easeInEaseOut=new t.MFVec2f(new t.SFVec2f(0,1),new t.SFVec2f(1,0));break;default:this.easeInEaseOut._easeInEaseOut=new t.MFVec2f(new t.SFVec2f(0,0),new t.SFVec2f(0,0))}this.timeSensor._cycleInterval=l,this.timeSensor._stopTime=this.getBrowser().getCurrentTime(),this.timeSensor._startTime=this.getBrowser().getCurrentTime(),this.timeSensor._isActive.addInterest("set_active__",this,u),a.getRelativeTransformation(o,e,i,n,r),this.positionInterpolator._keyValue=new t.MFVec3f(e,a._positionOffset),this.orientationInterpolator._keyValue=new t.MFRotation(i,a._orientationOffset),this.scaleInterpolator._keyValue=new t.MFVec3f(n,a._scaleOffset),this.scaleOrientationInterpolator._keyValue=new t.MFRotation(r,a._scaleOrientationOffset),this._positionOffset=e,this._orientationOffset=i,this._scaleOffset=n,this._scaleOrientationOffset=r,this.setInterpolators(o,a),this._transitionActive=!0}else a.getRelativeTransformation(o,e,i,n,r),a._positionOffset=e,a._orientationOffset=i,a._scaleOffset=n,a._scaleOrientationOffset=r,a.setInterpolators(o,a)}}(),transitionStop:function(){this.timeSensor._stopTime=this.getBrowser().getCurrentTime(),this.timeSensor._isActive.removeInterest("set_active__",this)},resetUserOffsets:function(){this._positionOffset=u.Zero,this._orientationOffset=l.Identity,this._scaleOffset=u.One,this._scaleOrientationOffset=l.Identity,this._centerOfRotationOffset=u.Zero,this._fieldOfViewScale=1},getRelativeTransformation:function(t,e,i,n,r){this.modelMatrix.copy().multRight(t.getViewMatrix()).inverse().get(e,i,n,r),e.subtract(this.getPosition()),i.assign(this.getOrientation().copy().inverse().multRight(i))},lookAtPoint:function(t,e,i,n){this.getCameraSpaceMatrix().multVecMatrix(e),c.inverse(this.getModelMatrix()).multVecMatrix(e);const r=2*t.getNavigationInfo().getNearValue();this.lookAt(t,e,r,i,n)},lookAtBBox:function(t,e,i,n){e=e.copy().multRight(c.inverse(this.getModelMatrix()));const r=2*t.getNavigationInfo().getNearValue();this.lookAt(t,e.center,r,i,n)},lookAt:function(e,i,n,r,s){const o=i.copy().add(this.getUserOrientation().multVecRot(new u(0,0,n))).subtract(this.getPosition());e.getNavigationInfo()._transitionStart=!0,this.timeSensor._cycleInterval=.2,this.timeSensor._stopTime=this.getBrowser().getCurrentTime(),this.timeSensor._startTime=this.getBrowser().getCurrentTime(),this.timeSensor._isActive.addInterest("set_active__",this,e.getNavigationInfo()),this.easeInEaseOut._easeInEaseOut=new t.MFVec2f(new t.SFVec2f(0,1),new t.SFVec2f(1,0));const a=u.lerp(this._positionOffset.getValue(),o,r),c=u.add(this.getPosition(),a).subtract(i);let h=l.multRight(this._orientationOffset.getValue(),new l(this.getUserOrientation().multVecRot(new u(0,0,1)),c));s&&(h=l.inverse(this.getOrientation()).multRight(this.straightenHorizon(l.multRight(this.getOrientation(),h)))),this.positionInterpolator._keyValue=new t.MFVec3f(this._positionOffset,a),this.orientationInterpolator._keyValue=new t.MFRotation(this._orientationOffset,h),this.scaleInterpolator._keyValue=new t.MFVec3f(this._scaleOffset,this._scaleOffset),this.scaleOrientationInterpolator._keyValue=new t.MFRotation(this._scaleOrientationOffset,this._scaleOrientationOffset),this.setInterpolators(this,this),this._centerOfRotationOffset=u.subtract(i,this.getCenterOfRotation()),this._set_bind=!0},straighten:function(e,i){e.getNavigationInfo()._transitionStart=!0,this.timeSensor._cycleInterval=.4,this.timeSensor._stopTime=this.getBrowser().getCurrentTime(),this.timeSensor._startTime=this.getBrowser().getCurrentTime(),this.timeSensor._isActive.addInterest("set_active__",this,e.getNavigationInfo()),this.easeInEaseOut._easeInEaseOut=new t.MFVec2f(new t.SFVec2f(0,1),new t.SFVec2f(1,0));const n=l.multRight(l.inverse(this.getOrientation()),this.straightenHorizon(this.getUserOrientation()));this.positionInterpolator._keyValue=new t.MFVec3f(this._positionOffset,this._positionOffset),this.orientationInterpolator._keyValue=new t.MFRotation(this._orientationOffset,n),this.scaleInterpolator._keyValue=new t.MFVec3f(this._scaleOffset,this._scaleOffset),this.scaleOrientationInterpolator._keyValue=new t.MFRotation(this._scaleOrientationOffset,this._scaleOrientationOffset),this.setInterpolators(this,this),this._set_bind=!0},straightenHorizon:function(){const t=new u(0,0,0),e=new u(0,0,0),i=new l(0,0,1,0);return function(n){n.multVecRot(t.assign(u.xAxis).negate()),n.multVecRot(e.assign(u.zAxis));const r=this.getUpVector(),s=e.cross(r);return Math.abs(e.dot(r))>=1||Math.abs(s.dot(t))>=1?n:(i.setFromToVec(t,s),n.multRight(i))}}(),set_active__:function(t,e){this._isBound.getValue()&&!e.getValue()&&1===this.timeSensor._fraction_changed.getValue()&&(t._transitionComplete=!0)},set_bound__:function(){this._isBound.getValue()?this.getBrowser().getNotification()._string=this._description:this.timeSensor._stopTime=this.getBrowser().getCurrentTime()},traverse:function(t,e){t===o.CAMERA&&(e.getLayer().getViewpoints().push(this),this.modelMatrix.assign(e.getModelViewMatrix().get()))},update:function(){this.cameraSpaceMatrix.set(this.getUserPosition(),this.getUserOrientation(),this._scaleOffset.getValue(),this._scaleOrientationOffset.getValue()),this.cameraSpaceMatrix.multRight((this.to||this).modelMatrix),this.viewMatrix.assign(this.cameraSpaceMatrix).inverse()}}),h})),define("standard/Math/Geometry/Spheroid3",[],(function(){"use strict";function t(t,e){switch(arguments.length){case 0:this.semiMajorAxis=0,this.semiMinorAxis=0;break;case 2:this.semiMajorAxis=t,this.semiMinorAxis=e;break;case 3:const i=arguments[1];this.semiMajorAxis=t,this.semiMinorAxis=t*(1-1/i)}}return t.prototype={constructor:t,getSemiMajorAxis:function(){return this.semiMajorAxis},getSemiMinorAxis:function(){return this.semiMinorAxis},toString:function(){return this.semiMajorAxis+" "+this.semiMinorAxis}},t})),define("standard/Geospatial/ReferenceEllipsoids",["standard/Math/Geometry/Spheroid3"],(function(t){"use strict";return{AA:new t(6377563.396,299.3249646,!0),AM:new t(6377340.189,299.3249646,!0),AN:new t(6378160,298.25,!0),BN:new t(6377483.865,299.1528128,!0),BR:new t(6377397.155,299.1528128,!0),CC:new t(6378206.4,294.9786982,!0),CD:new t(6378249.145,293.465,!0),EA:new t(6377276.345,300.8017,!0),EB:new t(6377298.556,300.8017,!0),EC:new t(6377301.243,300.8017,!0),ED:new t(6377295.664,300.8017,!0),EE:new t(6377304.063,300.8017,!0),EF:new t(6377309.613,300.8017,!0),FA:new t(6378155,298.3,!0),HE:new t(6378200,298.3,!0),HO:new t(6378270,297,!0),ID:new t(6378160,298.247,!0),IN:new t(6378388,297,!0),KA:new t(6378245,298.3,!0),RF:new t(6378137,298.257222101,!0),SA:new t(6378160,298.25,!0),WD:new t(6378135,298.26,!0),WE:new t(6378137,298.257223563,!0),SUN:new t(696342e3,1/9e-6,!0),MERCURY:new t(2439700,2439700),VENUS:new t(6051800,6051800),MOON:new t(1738140,1735970),MARS:new t(3395428,3377678),JUPITER:new t(71492e3,66854e3),SATURN:new t(60268e3,54364e3),URANUS:new t(2555e3,24973e3),NEPTUNE:new t(24764e3,24341e3),PLUTO:new t(1153e3,1153e3)}})),define("standard/Geospatial/Geodetic",["standard/Math/Numbers/Vector3","standard/Math/Algorithm"],(function(t,e){"use strict";function i(t,e,i){this.longitudeFirst=!e,this.degrees=!i,this.a=t.getSemiMajorAxis(),this.c=t.getSemiMinorAxis(),this.c2a2=Math.pow(t.getSemiMinorAxis()/this.a,2),this.ecc2=1-this.c2a2}return i.prototype={constructor:i,convert:function(t,e){const i=t.z;if(this.longitudeFirst)var n=t.y,r=t.x;else n=t.x,r=t.y;return this.degrees&&(n*=Math.PI/180,r*=Math.PI/180),this.convertRadians(n,r,i,e)},convertRadians:function(t,e,i,n){const r=Math.sin(t),s=Math.pow(r,2),o=Math.cos(t),a=this.a/Math.sqrt(1-this.ecc2*s),u=(a+i)*o;return n.set(u*Math.cos(e),u*Math.sin(e),(a*this.c2a2+i)*r)},apply:function(t,e){if(this.applyRadians(t,e),this.degrees&&(e.x*=180/Math.PI,e.y*=180/Math.PI),this.longitudeFirst){const t=e.x;e.x=e.y,e.y=t}return e},applyRadians:function(t,e){const i=t.x,n=t.y,r=t.z,s=Math.sqrt(i*i+n*n);if(0==s)return e.set(Math.PI,0,r-this.c);let o=0,a=Math.atan2(n,i),u=0,l=this.a,c=l,h=this.ecc2;for(let t=0;t<30;++t){const t=u,e=o;o=Math.atan(r/s/(1-h*c/(c+u)));const i=Math.sin(o);if(c=l/Math.sqrt(1-h*i*i),u=s/Math.cos(o)-c,Math.abs(u-t)<.001&&Math.abs(o-e)<1e-10)break}return e.set(o,a,u)},normal:function(t,e){const i=this.applyRadians(t,e),n=i.x,r=i.y,s=Math.cos(n),o=Math.cos(r)*s,a=Math.sin(r)*s,u=Math.sin(n);return e.set(o,a,u)}},i})),define("standard/Geospatial/UniversalTransverseMercator",["standard/Geospatial/Geodetic","standard/Math/Numbers/Vector3","standard/Math/Algorithm"],(function(t,e,i){"use strict";const n=1e7,r=5e5,s=.9996;function o(e,n,r,o){const a=e.getSemiMajorAxis(),u=1-Math.pow(e.getSemiMinorAxis()/a,2),l=u/(1-u),c=(1-Math.sqrt(1-u))/(1+Math.sqrt(1-u));this.southernHemisphere=!r,this.eastingFirst=!o,this.a=a,this.ecc2=u,this.EE=l,this.E8=8*l,this.E9=9*l,this.E252=252*l,this.e1=c,this.A=s*(a*(1-u/4-3*u*u/64-5*u*u*u/256)),this.B=3*c/2-7*c*c*c/32,this.C=21*c*c/16-55*c*c*c*c/32,this.D=151*c*c*c/96,this.E=a*(1-u),this.W=1-u/4-3*u*u/64-5*u*u*u/256,this.X=3*u/8+3*u*u/32+45*u*u*u/1024,this.Y=15*u*u/256+45*u*u*u/1024,this.Z=35*u*u*u/3072,this.longitude0=i.radians(6*n-183),this.geodeticConverter=new t(e,!0,!0)}return o.prototype={constructor:o,convert:function(t,e){if(this.eastingFirst)var i=t.y,o=t.x;else i=t.x,o=t.y;let a=this.southernHemisphere;i<0&&(a=!this.southernHemisphere,i=-i),a&&(i-=n),o-=r;const u=i/this.A,l=u+this.B*Math.sin(2*u)+this.C*Math.sin(4*u)+this.D*Math.sin(6*u),c=Math.pow(Math.sin(l),2),h=Math.cos(l),d=Math.tan(l),p=this.a/Math.sqrt(1-this.ecc2*c),f=Math.pow(d,2),g=Math.pow(d,8),m=this.EE*f,_=m*m,y=this.E/Math.pow(1-this.ecc2*c,1.5),x=o/(p*s),w=(5+3*f+10*m-4*_-this.E9)*Math.pow(x,4)/24,b=(61+90*f+298*m+45*g-this.E252-3*_)*Math.pow(x,6)/720,v=(5-2*m+28*f-3*_+this.E8+24*g)*Math.pow(x,5)/120,S=l-p*d/y*(x*x/2-w+b),T=this.longitude0+(x-(1+2*f+m)*Math.pow(x,3)/6+v)/h;return this.geodeticConverter.convertRadians(S,T,t.z,e)},apply:function(t,e){const i=this.geodeticConverter.applyRadians(t,e),o=i.x,a=i.y,u=Math.tan(o),l=Math.cos(o),c=this.EE,h=this.a/Math.sqrt(1-this.ecc2*Math.pow(Math.sin(o),2)),d=u*u,p=d*d*d,f=c*l*l,g=l*(a-this.longitude0),m=this.a*(this.W*o-this.X*Math.sin(2*o)+this.Y*Math.sin(4*o)-this.Z*Math.sin(6*o)),_=s*h*(g+(1-d+f)*Math.pow(g,3)/6+(5-18*p+72*f-58*c)*Math.pow(g,5)/120)+r;let y=s*(m+h*u*(g*g/2+(5-d+9*f+4*f*f)*Math.pow(g,4)/24+(61-58*p+600*f-330*c)*Math.pow(g,6)/720));return o<0?(y+=n,this.southernHemisphere||(y=-y)):this.southernHemisphere&&(y=-y),this.eastingFirst?e.set(_,y,i.z):e.set(y,_,i.z)}},o})),define("x_ite/Browser/Geospatial/Geocentric",["standard/Math/Numbers/Vector3","standard/Math/Algorithm"],(function(t,e){"use strict";function i(){}return i.prototype={constructor:i,convert:function(t,e){return e.assign(t)},apply:function(t,e){return e.assign(t)},slerp:function(t,i,n){const r=t.magnitude(),s=i.magnitude();return t.normalize(),i.normalize(),e.simpleSlerp(t,i,n).multiply(e.lerp(r,s,n))}},i})),define("x_ite/Browser/Geospatial/Geospatial",["standard/Geospatial/ReferenceEllipsoids","standard/Geospatial/Geodetic","standard/Geospatial/UniversalTransverseMercator","x_ite/Browser/Geospatial/Geocentric"],(function(t,e,i,n){"use strict";let r=0;const s=r++,o=r++,a=r++,u={GD:s,GDC:s,UTM:o,GC:a,GCC:a,GS:a},l=/^Z(\d+)$/;return{GD:s,UTM:o,GC:a,getReferenceFrame:function(r,u){switch(this.getCoordinateSystem(r)){case s:return new e(this.getEllipsoid(r),this.getLatitudeFirst(r),u);case o:return new i(this.getEllipsoid(r),this.getZone(r),this.getNorthernHemisphere(r),this.getNorthingFirst(r));case a:return new n}return new e(t.WE,!0,u)},getElevationFrame:function(t,i){return new e(this.getEllipsoid(t),!0,i)},getCoordinateSystem:function(t){for(const e of t){const t=u[e];if(void 0!==t)return t}return s},getEllipsoid:function(e){for(const i of e){const e=t[i];if(void 0!==e)return e}return t.WE},getEllipsoidString:function(e){for(const i of e){if(void 0!==t[i])return i}return"WE"},isStandardOrder:function(t){switch(this.getCoordinateSystem(t)){case s:return this.getLatitudeFirst(t);case o:return this.getNorthingFirst(t);case a:return!0}return this.getLatitudeFirst(t)},getLatitudeFirst:function(t){for(const e of t)if("longitude_first"===e)return!1;return!0},getNorthingFirst:function(t){for(const e of t)if("easting_first"===e)return!1;return!0},getZone:function(t){for(const e of t){const t=e.match(l);if(t)return parseInt(t[1])}return 1},getNorthernHemisphere:function(t){for(const e of t)if("S"===e)return!1;return!0}}})),define("x_ite/Base/X3DCast",["x_ite/Fields"],(function(t){"use strict";return function(e,i,n=!0){try{if(i&&(i instanceof t.SFNode&&(i=i.getValue()),i&&(n&&(i=i.getInnerNode()),-1!==i.getType().indexOf(e))))return i}catch(t){}return null}})),define("x_ite/Components/Geospatial/X3DGeospatialObject",["x_ite/Base/X3DConstants","x_ite/Browser/Geospatial/Geospatial","x_ite/Base/X3DCast","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4"],(function(t,e,i,n,r){"use strict";var s=new n(0,0,0),o=new n(0,0,0),a=new n(0,0,0),u=new n(0,0,0),l=new n(0,0,0),c=new n(0,0,0);function h(e){this.addType(t.X3DGeospatialObject),this.radians=!1,this.origin=new n(0,0,0),this.originMatrix=new r,this.invOriginMatrix=new r}function d(t,e){return this.invOriginMatrix.multVecMatrix(this.referenceFrame.convert(t,e))}function p(t,e){return this.referenceFrame.apply(this.originMatrix.multVecMatrix(s.assign(t)),e)}function f(t,e){return this.invOriginMatrix.multDirMatrix(this.elevationFrame.normal(this.originMatrix.multVecMatrix(s.assign(t)),e))}function g(t,e){return m.call(this,t,e).multRight(this.invOriginMatrix)}function m(t,e){return this.referenceFrame.convert(t,a),this.elevationFrame.normal(a,l),u.set(0,0,1).cross(l),u.equals(n.Zero)&&u.set(1,0,0),c.assign(u).cross(l),u.normalize(),c.normalize(),e.set(u.x,u.y,u.z,0,l.x,l.y,l.z,0,c.x,c.y,c.z,0,a.x,a.y,a.z,1)}return h.prototype={constructor:h,initialize:function(){this._geoSystem.addInterest("set_geoSystem__",this),this._geoOrigin.addInterest("set_geoOrigin__",this),this.set_geoSystem__(),this.set_geoOrigin__()},set_geoSystem__:function(){this.coordinateSystem=e.getCoordinateSystem(this._geoSystem),this.referenceFrame=e.getReferenceFrame(this._geoSystem,this.radians),this.elevationFrame=e.getElevationFrame(this._geoSystem,this.radians),this.standardOrder=e.isStandardOrder(this._geoSystem)},set_geoOrigin__:function(){this.geoOriginNode&&(this.geoOriginNode.removeInterest("set_origin__",this),this.geoOriginNode.removeInterest("set_rotateYUp__",this),this.geoOriginNode.removeInterest("addNodeEvent",this)),this.geoOriginNode=i(t.GeoOrigin,this._geoOrigin),this.geoOriginNode&&(this.geoOriginNode.addInterest("set_origin__",this),this.geoOriginNode.addInterest("set_rotateYUp__",this),this.geoOriginNode.addInterest("addNodeEvent",this)),this.set_origin__(),this.set_rotateYUp__()},set_origin__:function(){this.geoOriginNode?this.geoOriginNode.getOrigin(this.origin):this.origin.set(0,0,0),this.set_originMatrix__()},set_originMatrix__:function(){if(this.geoOriginNode){var t=this.origin;this.elevationFrame.normal(t,l),u.set(0,0,1).cross(l),u.equals(n.Zero)&&u.set(1,0,0),c.assign(u).cross(l),u.normalize(),c.normalize(),this.originMatrix.set(u.x,u.y,u.z,0,l.x,l.y,l.z,0,c.x,c.y,c.z,0,t.x,t.y,t.z,1),this.invOriginMatrix.assign(this.originMatrix).inverse()}},set_rotateYUp__:function(){this.geoOriginNode&&this.geoOriginNode._rotateYUp.getValue()?(this.getCoord=d,this.getGeoCoord=p,this.getGeoUpVector=f,this.getLocationMatrix=g):(delete this.getCoord,delete this.getGeoCoord,delete this.getGeoUpVector,delete this.getLocationMatrix)},getReferenceFrame:function(){return this.referenceFrame},getStandardOrder:function(){return this.standardOrder},getCoord:function(t,e){return this.referenceFrame.convert(t,e).subtract(this.origin)},getGeoCoord:function(t,e){return this.referenceFrame.apply(s.assign(t).add(this.origin),e)},getGeoElevation:function(t){return this.getGeoCoord(t,o).z},getGeoUpVector:function(t,e){return this.elevationFrame.normal(s.assign(t).add(this.origin),e)},getLocationMatrix:function(t,e){var i=this.origin,n=m.call(this,t,e);return n[12]-=i.x,n[13]-=i.y,n[14]-=i.z,n}},h})),define("x_ite/Components/Interpolation/ScalarInterpolator",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Base/X3DConstants","standard/Math/Algorithm"],(function(t,e,i,n,r,s){"use strict";function o(t){n.call(this,t),this.addType(r.ScalarInterpolator)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOnly,"set_fraction",new t.SFFloat),new e(r.inputOutput,"key",new t.MFFloat),new e(r.inputOutput,"keyValue",new t.MFFloat),new e(r.outputOnly,"value_changed",new t.SFFloat)]),getTypeName:function(){return"ScalarInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this._keyValue.addInterest("set_keyValue__",this)},set_keyValue__:function(){const t=this._key,e=this._keyValue;e.length<t.length&&e.resize(t.length,e.length?e[e.length-1]:0)},interpolate:function(t,e,i){this._value_changed=s.lerp(this._keyValue[t],this._keyValue[e],i)}}),o})),define("x_ite/Components/Navigation/NavigationInfo",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Core/X3DBindableNode","x_ite/Rendering/TraverseType","x_ite/Base/X3DConstants"],(function(t,e,i,n,r,s){"use strict";const o={TELEPORT:!0,LINEAR:!0,ANIMATE:!0};function a(e){n.call(this,e),this.addType(s.NavigationInfo),this.addChildObjects("transitionStart",new t.SFBool,"availableViewers",new t.MFString,"viewer",new t.SFString("EXAMINE")),this._avatarSize.setUnit("length"),this._speed.setUnit("speed"),this._visibilityLimit.setUnit("speed")}return a.prototype=Object.assign(Object.create(n.prototype),{constructor:a,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.inputOnly,"set_bind",new t.SFBool),new e(s.inputOutput,"type",new t.MFString("EXAMINE","ANY")),new e(s.inputOutput,"avatarSize",new t.MFFloat(.25,1.6,.75)),new e(s.inputOutput,"speed",new t.SFFloat(1)),new e(s.inputOutput,"headlight",new t.SFBool(!0)),new e(s.inputOutput,"visibilityLimit",new t.SFFloat),new e(s.inputOutput,"transitionType",new t.MFString("LINEAR")),new e(s.inputOutput,"transitionTime",new t.SFTime(1)),new e(s.outputOnly,"transitionComplete",new t.SFBool),new e(s.outputOnly,"isBound",new t.SFBool),new e(s.outputOnly,"bindTime",new t.SFTime)]),getTypeName:function(){return"NavigationInfo"},getComponentName:function(){return"Navigation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this._type.addInterest("set_type__",this),this._headlight.addInterest("set_headlight__",this),this._transitionStart.addInterest("set_transitionStart__",this),this._transitionComplete.addInterest("set_transitionComplete__",this),this._isBound.addInterest("set_isBound__",this),this.set_type__(),this.set_headlight__()},getViewer:function(){return this._viewer.getValue()},getCollisionRadius:function(){return this._avatarSize.length>0&&this._avatarSize[0]>0?this._avatarSize[0]:.25},getAvatarHeight:function(){return this._avatarSize.length>1?this._avatarSize[1]:1.6},getStepHeight:function(){return this._avatarSize.length>2?this._avatarSize[2]:.75},getNearValue:function(){const t=this.getCollisionRadius();return 0===t?1e-5:t/2},getFarValue:function(t){return this._visibilityLimit.getValue()?this._visibilityLimit.getValue():t.getMaxFarValue()},getTransitionType:function(){for(const t of this._transitionType){if(o[t])return t}return"LINEAR"},set_type__:function(){this._viewer="EXAMINE";for(const t of this._type){switch(t){case"EXAMINE":case"WALK":case"FLY":case"LOOKAT":case"PLANE":case"NONE":this._viewer=t;break;case"PLANE_create3000.de":this._viewer="PLANE";break;default:continue}break}let t=!1,e=!1,i=!1,n=!1,r=!1,s=!1;if(this._type.length)for(const o of this._type){switch(o){case"EXAMINE":default:t=!0;continue;case"WALK":e=!0;continue;case"FLY":i=!0;continue;case"LOOKAT":s=!0;continue;case"PLANE":n=!0;continue;case"NONE":r=!0;continue;case"ANY":t=!0,e=!0,i=!0,n=!0,r=!0,s=!0}break}else t=!0,e=!0,i=!0,n=!0,r=!0,s=!0;this._availableViewers.length=0,t&&this._availableViewers.push("EXAMINE"),e&&this._availableViewers.push("WALK"),i&&this._availableViewers.push("FLY"),n&&this._availableViewers.push("PLANE"),s&&this._availableViewers.push("LOOKAT"),r&&this._availableViewers.push("NONE")},set_headlight__:function(){this._headlight.getValue()?delete this.enable:this.enable=Function.prototype},set_transitionStart__:function(){this._transitionActive.getValue()||(this._transitionActive=!0)},set_transitionComplete__:function(){this._transitionActive.getValue()&&(this._transitionActive=!1)},set_isBound__:function(){this._isBound.getValue()||this._transitionActive.getValue()&&(this._transitionActive=!1)},enable:function(t,e){t===r.DISPLAY&&this._headlight.getValue()&&e.getGlobalObjects().push(this.getBrowser().getHeadlight())},traverse:function(t,e){t===r.CAMERA&&e.getLayer().getNavigationInfos().push(this)}}),a})),define("standard/Math/Geometry/Camera",["standard/Math/Numbers/Vector3"],(function(t){"use strict";return{frustum:function(t,e,i,n,r,s,o){const a=e-t,u=n-i,l=s-r,c=2*r,h=(e+t)/a,d=(n+i)/u,p=-(s+r)/l,f=-c*s/l,g=c/a,m=c/u;return o.set(g,0,0,0,0,m,0,0,h,d,p,-1,0,0,f,0)},perspective:function(t,e,i,n,r,s){const o=Math.tan(t/2)*e;if(n>r){const t=n*o/r;return this.frustum(-t,t,-o,o,e,i,s)}{const t=r*o/n;return this.frustum(-o,o,-t,t,e,i,s)}},perspective2:function(t,e,i,n,r,s){const o=Math.tan(t/2)*e;return this.frustum(-o,o,-o,o,e,i,s)},ortho:function(t,e,i,n,r,s,o){const a=e-t,u=n-i,l=s-r,c=2/a,h=2/u,d=-2/l,p=-(e+t)/a,f=-(n+i)/u,g=-(s+r)/l;return o.set(c,0,0,0,0,h,0,0,0,0,d,0,p,f,g,1)},orthoBox:function(){const e=new t(0,0,0),i=new t(0,0,0);return function(t,n){return t.getExtents(e,i),this.ortho(e.x,i.x,e.y,i.y,-i.z,-e.z,n)}}()}})),define("x_ite/Components/Geospatial/GeoViewpoint",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Navigation/X3DViewpointNode","x_ite/Components/Geospatial/X3DGeospatialObject","x_ite/Components/Interpolation/ScalarInterpolator","x_ite/Components/Navigation/NavigationInfo","x_ite/Base/X3DConstants","standard/Math/Geometry/Camera","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Algorithm"],(function(t,e,i,n,r,s,o,a,u,l,c,h,d,p){"use strict";function f(t,e){n.prototype.traverse.call(this,t,e),this.navigationInfoNode.traverse(t,e)}function g(t){switch(n.call(this,t),r.call(this,t),this.addType(a.GeoViewpoint),this._centerOfRotation.setUnit("length"),this._fieldOfView.setUnit("angle"),this.navigationInfoNode=new o(t),this.fieldOfViewInterpolator=new s(this.getBrowser().getPrivateScene()),this.projectionMatrix=new d,this.elevation=0,t.specificationVersion){case"2.0":case"3.0":case"3.1":case"3.2":this.traverse=f}}return g.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:g,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(a.inputOutput,"metadata",new t.SFNode),new e(a.initializeOnly,"geoOrigin",new t.SFNode),new e(a.initializeOnly,"geoSystem",new t.MFString("GD","WE")),new e(a.inputOnly,"set_bind",new t.SFBool),new e(a.inputOutput,"description",new t.SFString),new e(a.inputOutput,"position",new t.SFVec3d(0,0,1e5)),new e(a.inputOutput,"orientation",new t.SFRotation),new e(a.inputOutput,"centerOfRotation",new t.SFVec3d),new e(a.inputOutput,"fieldOfView",new t.SFFloat(.7854)),new e(a.inputOutput,"jump",new t.SFBool(!0)),new e(a.inputOutput,"retainUserOffsets",new t.SFBool),new e(a.inputOutput,"navType",new t.MFString("EXAMINE","ANY")),new e(a.inputOutput,"headlight",new t.SFBool(!0)),new e(a.initializeOnly,"speedFactor",new t.SFFloat(1)),new e(a.outputOnly,"isBound",new t.SFBool),new e(a.outputOnly,"bindTime",new t.SFTime)]),getTypeName:function(){return"GeoViewpoint"},getComponentName:function(){return"Geospatial"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),r.prototype.initialize.call(this),this._position.addInterest("set_position__",this),this._positionOffset.addInterest("set_position__",this),this._navType.addFieldInterest(this.navigationInfoNode._type),this._headlight.addFieldInterest(this.navigationInfoNode._headlight),this.navigationInfoNode.setup(),this.set_position__(),this.fieldOfViewInterpolator._key=[0,1],this.fieldOfViewInterpolator.setup(),this.getEaseInEaseOut()._modifiedFraction_changed.addFieldInterest(this.fieldOfViewInterpolator._set_fraction),this.fieldOfViewInterpolator._value_changed.addFieldInterest(this._fieldOfViewScale)},setInterpolators:function(e,i){if(e.getType().indexOf(a.Viewpoint)>=0){const n=e.getFieldOfView()/i.getFieldOfView();this.fieldOfViewInterpolator._keyValue=new t.MFFloat(n,i._fieldOfViewScale.getValue()),this._fieldOfViewScale=n}else this.fieldOfViewInterpolator._keyValue=new t.MFFloat(i._fieldOfViewScale.getValue(),i._fieldOfViewScale.getValue()),this._fieldOfViewScale=i._fieldOfViewScale.getValue()},setPosition:function(){const t=new c(0,0,0);return function(e){this._position.setValue(this.getGeoCoord(e,t))}}(),getPosition:function(){const t=new c(0,0,0);return function(){return this.getCoord(this._position.getValue(),t)}}(),set_position__:function(){const t=new c(0,0,0);return function(){this.getCoord(this._position.getValue(),t),this.elevation=this.getGeoElevation(t.add(this._positionOffset.getValue()))}}(),setOrientation:function(){const t=new d,e=new h(0,0,1,0);return function(i){const n=this.getLocationMatrix(this._position.getValue(),t).submatrix;e.setMatrix(n),this._orientation.setValue(e.inverse().multLeft(i))}}(),getOrientation:function(){const t=new d,e=new h(0,0,1,0);return function(){const i=this.getLocationMatrix(this._position.getValue(),t).submatrix;return e.setMatrix(i),e.multLeft(this._orientation.getValue())}}(),getCenterOfRotation:function(){const t=new c(0,0,0);return function(){return this.getCoord(this._centerOfRotation.getValue(),t)}}(),getFieldOfView:function(){const t=this._fieldOfView*this._fieldOfViewScale;return t>0&&t<Math.PI?t:Math.PI/4},getMaxFarValue:function(){return this.getBrowser().getRenderingProperty("LogarithmicDepthBuffer")?1e10:1e9},getUpVector:function(){const t=new c(0,0,0),e=new c(0,0,0);return function(){return this.getCoord(this._position.getValue(),t),this.getGeoUpVector.call(this,t.add(this._positionOffset.getValue()),e)}}(),getSpeedFactor:function(){return(Math.max(this.elevation,0)+10)/10*this._speedFactor.getValue()},getScreenScale:function(t,e,i){const n=e[2],r=e[3];let s=Math.abs(t.z)*Math.tan(this.getFieldOfView()/2)*2;return s/=n>r?r:n,i.set(s,s,s)},getViewportSize:function(){const t=new l(0,0);return function(e,i){const n=e[2],r=e[3],s=i*Math.tan(this.getFieldOfView()/2)*2,o=n/r;return o>1?t.set(s*o,s):t.set(s,s/o)}}(),getLookAtDistance:function(t){return t.size.magnitude()/2/Math.tan(this.getFieldOfView()/2)},getProjectionMatrixWithLimits:function(t,e,i,n){if(n||this.getBrowser().getRenderingProperty("LogarithmicDepthBuffer"))return u.perspective(this.getFieldOfView(),t,e,i[2],i[3],this.projectionMatrix);const r=Math.max(p.lerp(Math.min(t,1e4),1e4,this.elevation/1e7),1),s=Math.max(p.lerp(1e6,Math.max(e,1e6),this.elevation/1e7),1e6);return u.perspective(this.getFieldOfView(),r,s,i[2],i[3],this.projectionMatrix)}}),g})),define("lib/jquery.fullscreen-min",["jquery"],(function(t){function e(t){var e,i;return this.length?((e=this[0]).ownerDocument?i=e.ownerDocument:e=(i=e).documentElement,null==t?i.exitFullscreen||i.webkitExitFullscreen||i.webkitCancelFullScreen||i.msExitFullscreen||i.mozCancelFullScreen?(t=!!(i.fullscreenElement||i.msFullscreenElement||i.webkitIsFullScreen||i.mozFullScreen))&&(i.fullscreenElement||i.webkitFullscreenElement||i.webkitCurrentFullScreenElement||i.msFullscreenElement||i.mozFullScreenElement)||t:null:(t?(t=e.requestFullscreen||e.webkitRequestFullscreen||e.webkitRequestFullScreen||e.msRequestFullscreen||e.mozRequestFullScreen)&&t.call(e):(t=i.exitFullscreen||i.webkitExitFullscreen||i.webkitCancelFullScreen||i.msExitFullscreen||i.mozCancelFullScreen)&&t.call(i),this)):this}var i,n,r;t.fn.fullScreen=e,t.fn.toggleFullScreen=function(){return e.call(this,!e.call(this))},(i=document).webkitCancelFullScreen?(n="webkitfullscreenchange",r="webkitfullscreenerror"):i.msExitFullscreen?(n="MSFullscreenChange",r="MSFullscreenError"):i.mozCancelFullScreen?(n="mozfullscreenchange",r="mozfullscreenerror"):(n="fullscreenchange",r="fullscreenerror"),t(document).bind(n,(function(){t(document).trigger(new t.Event("fullscreenchange"))})),t(document).bind(r,(function(){t(document).trigger(new t.Event("fullscreenerror"))}))})),
/*!
 * jQuery Mousewheel 3.1.13
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 */
factory=function(t){var e,i,n=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],r="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],s=Array.prototype.slice;if(t.event.fixHooks)for(var o=n.length;o;)t.event.fixHooks[n[--o]]=t.event.mouseHooks;var a=t.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var e=r.length;e;)this.addEventListener(r[--e],u,!1);else this.onmousewheel=u;t.data(this,"mousewheel-line-height",a.getLineHeight(this)),t.data(this,"mousewheel-page-height",a.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var e=r.length;e;)this.removeEventListener(r[--e],u,!1);else this.onmousewheel=null;t.removeData(this,"mousewheel-line-height"),t.removeData(this,"mousewheel-page-height")},getLineHeight:function(e){var i=t(e),n=i["offsetParent"in t.fn?"offsetParent":"parent"]();return n.length||(n=t("body")),parseInt(n.css("fontSize"),10)||parseInt(i.css("fontSize"),10)||16},getPageHeight:function(e){return t(e).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};function u(n){var r=n||window.event,o=s.call(arguments,1),u=0,h=0,d=0,p=0,f=0,g=0;if((n=t.event.fix(r)).type="mousewheel","detail"in r&&(d=-1*r.detail),"wheelDelta"in r&&(d=r.wheelDelta),"wheelDeltaY"in r&&(d=r.wheelDeltaY),"wheelDeltaX"in r&&(h=-1*r.wheelDeltaX),"axis"in r&&r.axis===r.HORIZONTAL_AXIS&&(h=-1*d,d=0),u=0===d?h:d,"deltaY"in r&&(u=d=-1*r.deltaY),"deltaX"in r&&(h=r.deltaX,0===d&&(u=-1*h)),0!==d||0!==h){if(1===r.deltaMode){var m=t.data(this,"mousewheel-line-height");u*=m,d*=m,h*=m}else if(2===r.deltaMode){var _=t.data(this,"mousewheel-page-height");u*=_,d*=_,h*=_}if(p=Math.max(Math.abs(d),Math.abs(h)),(!i||p<i)&&(i=p,c(r,p)&&(i/=40)),c(r,p)&&(u/=40,h/=40,d/=40),u=Math[u>=1?"floor":"ceil"](u/i),h=Math[h>=1?"floor":"ceil"](h/i),d=Math[d>=1?"floor":"ceil"](d/i),a.settings.normalizeOffset&&this.getBoundingClientRect){var y=this.getBoundingClientRect();f=n.clientX-y.left,g=n.clientY-y.top}return n.deltaX=h,n.deltaY=d,n.deltaFactor=i,n.offsetX=f,n.offsetY=g,n.deltaMode=0,o.unshift(n,u,h,d),e&&clearTimeout(e),e=setTimeout(l,200),(t.event.dispatch||t.event.handle).apply(this,o)}}function l(){i=null}function c(t,e){return a.settings.adjustOldDeltas&&"mousewheel"===t.type&&e%120==0}t.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}})},"function"==typeof define&&define.amd?define("jquery-mousewheel/jquery.mousewheel",["jquery"],factory):"object"==typeof exports?module.exports=factory:factory(jQuery),define("jquery-mousewheel",["jquery-mousewheel/jquery.mousewheel"],(function(t){return t})),define("x_ite/Browser/Core/ContextMenu",["jquery","x_ite/Base/X3DBaseNode","x_ite/Components/Geospatial/GeoViewpoint","locale/gettext","lib/jquery.fullscreen-min","jquery-mousewheel"],(function(t,e,i,n){"use strict";const r=Symbol();function s(t){e.call(this,t),this[r]=null}return s.prototype=Object.assign(Object.create(e.prototype),{constructor:s,getTypeName:function(){return"ContextMenu"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"contextMenu"},initialize:function(){e.prototype.initialize.call(this);const t=this.getBrowser();this.init({element:t.getElement(),appendTo:t.getShadow(),build:this.build.bind(this),animation:{duration:500,show:"fadeIn",hide:"fadeOut"}})},getUserMenu:function(){return this[r]},setUserMenu:function(t){this[r]=t},createUserMenu:function(){const e={};if("function"==typeof this[r]){const i=this[r]();if(t.isPlainObject(i))for(const t in i)e["user-"+t]=i[t]}return e},build:function(e){const r=this.getBrowser(),s=r.getActiveLayer(),o=s?s.getViewpoint():null,a=r.getElement().fullScreen();if(!r.getBrowserOptions().getContextMenu())return;const u={className:"x_ite-private-menu",items:{title:{name:r.getName()+" Browser v"+r.getVersion(),className:"context-menu-title context-menu-not-selectable"},separator0:"--------",viewpoints:{name:n("Viewpoints"),className:"context-menu-icon x_ite-private-icon-viewpoint",items:this.getViewpoints()},"available-viewers":{name:n("Available Viewers"),items:this.getAvailableViewers()},"straighten-horizon":{name:n("Straighten Horizon"),type:"checkbox",selected:r.getBrowserOption("StraightenHorizon"),events:{click:function(e){const i=t(e.target).is(":checked");if(r.setBrowserOption("StraightenHorizon",i),i){r.getNotification()._string=n("Straighten Horizon")+": "+n("on");const t=r.getActiveViewpoint();t&&t.straighten(r.getActiveLayer(),!0)}else r.getNotification()._string=n("Straighten Horizon")+": "+n("off")}.bind(this)}},"display-rubberband":{name:n("Display Rubberband"),type:"checkbox",selected:r.getBrowserOption("Rubberband"),events:{click:function(e){const i=t(e.target).is(":checked");r.setBrowserOption("Rubberband",i),r.getNotification()._string=i?n("Rubberband")+": "+n("on"):n("Rubberband")+": "+n("off")}.bind(this)}},separator1:"--------","primitive-quality":{name:n("Primitive Quality"),className:"context-menu-icon x_ite-private-icon-primitive-quality",items:{high:{name:n("High"),type:"radio",radio:"primitive-quality",selected:"HIGH"===r.getBrowserOption("PrimitiveQuality"),events:{click:function(){r.setBrowserOption("PrimitiveQuality","HIGH"),r.getNotification()._string=n("Primitive Quality")+": "+n("high")}.bind(this)}},medium:{name:n("Medium"),type:"radio",radio:"primitive-quality",selected:"MEDIUM"===r.getBrowserOption("PrimitiveQuality"),events:{click:function(){r.setBrowserOption("PrimitiveQuality","MEDIUM"),r.getNotification()._string=n("Primitive Quality")+": "+n("medium")}.bind(this)}},low:{name:n("Low"),type:"radio",radio:"primitive-quality",selected:"LOW"===r.getBrowserOption("PrimitiveQuality"),events:{click:function(){r.setBrowserOption("PrimitiveQuality","LOW"),r.getNotification()._string=n("Primitive Quality")+": "+n("low")}.bind(this)}}}},"texture-quality":{name:n("Texture Quality"),className:"context-menu-icon x_ite-private-icon-texture-quality",items:{high:{name:n("High"),type:"radio",radio:"texture-quality",selected:"HIGH"===r.getBrowserOption("TextureQuality"),events:{click:function(){r.setBrowserOption("TextureQuality","HIGH"),r.getNotification()._string=n("Texture Quality")+": "+n("high")}.bind(this)}},medium:{name:n("Medium"),type:"radio",radio:"texture-quality",selected:"MEDIUM"===r.getBrowserOption("TextureQuality"),events:{click:function(){r.setBrowserOption("TextureQuality","MEDIUM"),r.getNotification()._string=n("Texture Quality")+": "+n("medium")}.bind(this)}},low:{name:n("Low"),type:"radio",radio:"texture-quality",selected:"LOW"===r.getBrowserOption("TextureQuality"),events:{click:function(){r.setBrowserOption("TextureQuality","LOW"),r.getNotification()._string=n("Texture Quality")+": "+n("low")}.bind(this)}}}},shading:{name:n("Shading"),className:"context-menu-icon x_ite-private-icon-shading",items:{point:{name:n("Point"),type:"radio",radio:"shading",selected:"POINT"===r.getBrowserOption("Shading"),events:{click:function(){r.setBrowserOption("Shading","POINT"),r.getNotification()._string=n("Shading")+": "+n("Point")}.bind(this)}},wireframe:{name:n("Wireframe"),type:"radio",radio:"shading",selected:"WIREFRAME"===r.getBrowserOption("Shading"),events:{click:function(){r.setBrowserOption("Shading","WIREFRAME"),r.getNotification()._string=n("Shading")+": "+n("Wireframe")}.bind(this)}},flat:{name:n("Flat"),type:"radio",radio:"shading",selected:"FLAT"===r.getBrowserOption("Shading"),events:{click:function(){r.setBrowserOption("Shading","FLAT"),r.getNotification()._string=n("Shading")+": "+n("Flat")}.bind(this)}},gouraud:{name:n("Gouraud"),type:"radio",radio:"shading",selected:"GOURAUD"===r.getBrowserOption("Shading"),events:{click:function(){r.setBrowserOption("Shading","GOURAUD"),r.getNotification()._string=n("Shading")+": "+n("Gouraud")}.bind(this)}},phong:{name:n("Phong"),type:"radio",radio:"shading",selected:"PHONG"===r.getBrowserOption("Shading"),events:{click:function(){r.setBrowserOption("Shading","PHONG"),r.getNotification()._string=n("Shading")+": "+n("Phong")}.bind(this)}}}},separator2:"--------","browser-timings":{name:n("Browser Timings"),type:"checkbox",selected:r.getBrowserOption("Timings"),events:{click:function(e){r.setBrowserOption("Timings",t(e.target).is(":checked")),r.getSurface().focus()}.bind(this)}},fullscreen:{name:n(a?"Leave Fullscreen":"Fullscreen"),className:"context-menu-icon "+(a?"x_ite-private-icon-leave-fullscreen":"x_ite-private-icon-enter-fullscreen"),callback:function(){r.getElement().toggleFullScreen()}.bind(this)},separator3:"--------"}};Object.assign(u.items,this.createUserMenu()),Object.assign(u.items,{separator4:"--------","world-info":{name:n("Show World Info"),className:"context-menu-icon x_ite-private-icon-world-info",callback:function(){define.show(),require(["https://cdn.jsdelivr.net/gh/showdownjs/showdown@1.9.1/dist/showdown.min.js"],(function(e){define.hide(),r.getShadow().find(".x_ite-private-world-info").remove();const i=new e.Converter,n=r.getShadow().find(".x_ite-private-browser"),s=t("<div></div>").addClass("x_ite-private-world-info-overlay").appendTo(n),o=t("<div></div>").addClass("x_ite-private-world-info").appendTo(s),a=r.getExecutionContext().getWorldInfos()[0],u=a.title,l=a.info;i.setOption("omitExtraWLInCodeBlocks",!0),i.setOption("simplifiedAutoLink",!0),i.setOption("excludeTrailingPunctuationFromURLs",!0),i.setOption("literalMidWordUnderscores",!0),i.setOption("strikethrough",!0),i.setOption("openLinksInNewWindow",!1),t("<div></div>").addClass("x_ite-private-world-info-top").text("World Info").appendTo(o),u.length&&t("<div></div>").addClass("x_ite-private-world-info-title").text(u).appendTo(o);for(const e of l)t("<div></div>").addClass("x_ite-private-world-info-info").html(i.makeHtml(e)).appendTo(o);o.find("a").on("click",(function(t){t.stopPropagation()})),o.find("a[href^=http]").each((function(){-1===this.href.indexOf(location.hostname)&&t(this).attr("target","_blank")})),s.on("click",(function(){s.remove()}))}))}},about:{name:n("About X_ITE"),className:"context-menu-icon x_ite-private-icon-help-about",callback:function(){window.open(r.getProviderUrl())}}}),t.isEmptyObject(u.items.viewpoints.items)&&delete u.items.viewpoints,Object.keys(u.items["available-viewers"].items).length<2&&delete u.items["available-viewers"],(!r.getCurrentViewer().match(/^(?:EXAMINE|FLY)$/)||o instanceof i)&&delete u.items["straighten-horizon"],r.getDebug()||delete u.items.shading;const l=r.getExecutionContext().getWorldInfos()[0];return(!l||0===l.title.length&&0===l.info.length)&&delete u.items["world-info"],u},getViewpoints:function(){const t=this.getBrowser(),e=t.getActiveLayer();if(!e)return{};const i=t.getBrowserOption("EnableInlineViewpoints"),n=t.currentScene,r=e.getViewpoints().get(),s=e.getViewpoint(),o={};for(const e of r){const r=e._description.getValue();if(""===r)continue;if(!i&&e.getScene()!==n)continue;const a={name:r,callback:function(e){t.bindViewpoint(t.getActiveLayer(),e),t.getSurface().focus()}.bind(this,e)};e===s&&(a.className="context-menu-selected"),o["Viewpoint"+e.getId()]=a}return o},getAvailableViewers:function(){const t=this.getBrowser(),e=t._viewer.getValue(),i=t._availableViewers,r={};for(const s of i)r[s]={name:n(this.getViewerName(s)),className:"context-menu-icon x_ite-private-icon-"+s.toLowerCase()+"-viewer",callback:function(e){t._viewer=e,t.getNotification()._string=n(this.getViewerName(e)),t.getSurface().focus()}.bind(this,s)},s===e&&(r[s].className+=" context-menu-selected");return r},getViewerName:function(t){switch(t){case"EXAMINE":return n("Examine Viewer");case"WALK":return n("Walk Viewer");case"FLY":return n("Fly Viewer");case"PLANE":return n("Plane Viewer");case"LOOKAT":return n("Look At Viewer");case"NONE":return n("None Viewer")}},init:function(t){this.show=this.createRoot.bind(this,t),t.element.on("contextmenu",this.show)},show:function(t){},hide:function(t){},createRoot:function(e,i){const n=e.build(i);if(!n)return;const r=t("<div></div>").addClass("context-menu-layer").addClass(n.className).appendTo(e.appendTo),s=this.hide=function(){return delete this.hide,r.remove(),u[e.animation.hide](e.animation.duration,(function(){u.remove(),e.events&&"function"==typeof e.events.hide&&e.events.hide()})),!1}.bind(this),o=i.pageX-t(document).scrollLeft(),a=i.pageY-t(document).scrollTop(),u=t("<ul></ul>").hide().addClass("context-menu-list").addClass(n.className).addClass("context-menu-root").css({left:o,top:a}).appendTo(e.appendTo);for(const t in n.items)u.append(this.createItem(n.items[t],"context-menu-root",t,2,s));return u[e.animation.show](e.animation.duration),u.offset().left-t(document).scrollLeft()+u.outerWidth()>t(window).width()&&u.offset({left:t(document).scrollLeft()+Math.max(0,t(window).width()-u.outerWidth())}),u.offset().top-t(document).scrollTop()+u.outerHeight()>t(window).height()&&u.offset({top:t(document).scrollTop()+Math.max(0,t(window).height()-u.outerHeight())}),u.find("ul").each((function(e,i){const n=(i=t(i)).outerWidth()+u.outerWidth(),r=u.offset().left-t(document).scrollLeft()+n>t(window).width()?"right":"left";i.css("width",i.outerWidth()),i.css(r,i.parent().closest("ul").width()),i.outerHeight()>=t(window).height()&&i.css({"max-height":"100vh","overflow-y":"scroll"})})),u.find("li").on("mouseenter touchstart",(function(e){e.stopImmediatePropagation();const i=t(e.target).closest("li").children("ul");if(!i.length)return;i.css("top","");const n=i.offset().top+i.outerHeight()-t(window).scrollTop()-t(window).height();n>0&&i.offset({top:i.offset().top-n})})),r.on("click contextmenu",s),u.on("contextmenu",s),e.events&&"function"==typeof e.events.show&&e.events.show(u),!1},createItem:function(e,i,n,r,s){const o=t("<li></li>").addClass("context-menu-item");switch(typeof e){case"string":e.match(/^-+$/)&&o.addClass(["context-menu-separator","context-menu-not-selectable"]);break;case"object":switch(e.className&&o.addClass(e.className),e.type){case"radio":case"checkbox":{const n=t("<label></label>").appendTo(o),r=t("<input></input>").appendTo(n);r.attr("type",e.type).attr("name","context-menu-input-"+(e.radio||i)),t("<span></span>").text(e.name).appendTo(n),e.selected&&r.attr("checked","checked");for(const t in e.events)"function"==typeof e.events[t]&&r.on(t,e.events[t]);o.addClass("context-menu-input");break}default:e.name&&t("<span></span>").text(e.name).appendTo(o),"function"==typeof e.callback&&o.on("click",e.callback).on("click",s)}}if("object"==typeof e.items&&r<3){const i=t("<ul></ul>").addClass("context-menu-list").css({"z-index":r}).appendTo(o);for(const t in e.items)i.append(this.createItem(e.items[t],n,t,r+1,s));o.addClass("context-menu-submenu")}return o}}),s})),define("x_ite/Parser/HTMLSupport",[],(function(){"use strict";const t=new Map,e=new Map;return{addNodeTypeName:function(e){t.set(e,e),t.set(e.toUpperCase(),e)},getNodeTypeName:function(e){return t.get(e)},addFieldName:function(t){e.set(t,t),e.set(t.toLowerCase(),t)},getFieldName:function(t){return e.get(t)}}})),define("x_ite/Configuration/SupportedNodes",["x_ite/Base/X3DConstants","x_ite/Parser/HTMLSupport"],(function(t,e){"use strict";const i=new Map,n=new Map;let r=t.X3DBaseNode;function s(){}s.prototype={addType:function(n,s){t[n]=++r,i.set(n,s),e.addNodeTypeName(n);for(const i of s.prototype[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]){const n=i.name;i.accessType&t.initializeOnly&&e.addFieldName(n)}},getType:function(t){return i.get(t)},getTypes:()=>Array.from(i.values()),addAbstractType:function(e,i){t[e]=++r,n.set(e,i)},getAbstractType:function(t){return n.get(t)},getAbstractTypes:()=>Array.from(n.values())};for(const t of Reflect.ownKeys(s.prototype))Object.defineProperty(s.prototype,t,{enumerable:!1});return new s})),define("x_ite/Execution/NamedNodesArray",["x_ite/Base/X3DInfoArray"],(function(t){"use strict";function e(e){return t.call(this,e)}e.prototype=Object.assign(Object.create(t.prototype),{constructor:e,getTypeName:function(){return"NamedNodesArray"}});for(const t of Reflect.ownKeys(e.prototype))Object.defineProperty(e.prototype,t,{enumerable:!1});return e})),define("x_ite/Components/Core/X3dNode",["x_ite/Fields","x_ite/Base/X3DBaseNode","x_ite/Base/X3DConstants","x_ite/InputOutput/Generator"],(function(t,e,i,n){"use strict";function r(t){e.call(this,t),this.addType(i.X3DNode)}return r.prototype=Object.assign(Object.create(e.prototype),{constructor:r,copy:function(t){if(!t||t.getType().includes(i.X3DExecutionContext))return e.prototype.copy.call(this,t);{const e=t.getBody();if(this.getName().length){const t=e.getNamedNodes().get(this.getName());if(t)return t}const n=this.create(e);this.getNeedsName()&&this.getExecutionContext().updateNamedNode(this.getExecutionContext().getUniqueName(),this),this.getName().length&&e.updateNamedNode(this.getName(),n);for(const e of this.getPredefinedFields())try{const r=n.getField(e.getName());if(e.hasReferences())for(const i of e.getReferences())try{r.addReference(t.getField(i.getName()))}catch(t){console.error(t.message)}else if(e.getAccessType()&i.initializeOnly)switch(e.getType()){case i.SFNode:case i.MFNode:r.assign(e.copy(t));break;default:r.assign(e)}r.setModificationTime(e.getModificationTime())}catch(t){console.log(t.message)}for(const e of this.getUserDefinedFields()){const i=e.copy(t);if(n.addUserDefinedField(e.getAccessType(),e.getName(),i),e.hasReferences())for(const n of e.getReferences())try{i.addReference(t.getField(n.getName()))}catch(e){console.error("No reference '"+n.getName()+"' inside execution context "+t.getTypeName()+" '"+t.getName()+"'.")}i.setModificationTime(e.getModificationTime())}return n.setup(),n}},getDisplayName:function(){const t=/_\d+$/;return function(){return this.getName().replace(t,"")}}(),getNeedsName:function(){if(this.getName().length)return!1;if(this.getCloneCount()>1)return!0;if(this.hasRoutes())return!0;const t=this.getExecutionContext();for(const e of t.getImportedNodes())if(e.getInlineNode()===this)return!0;if(t.isScene())for(const e of t.getExportedNodes())if(e.getLocalNode()===this)return!0;return!1},getFieldsAreEnumerable:function(){return!0},traverse:function(){},toStream:function(t){t.string+=this.getTypeName()+" { }"},toVRMLStream:function(t){const e=n.Get(t);e.EnterScope();const i=e.Name(this);if(i.length&&e.ExistsNode(this))return t.string+="USE",t.string+=" ",t.string+=i,void e.LeaveScope();i.length&&(e.AddNode(this),t.string+="DEF",t.string+=" ",t.string+=i,t.string+=" "),t.string+=this.getTypeName(),t.string+=" ",t.string+="{";const r=this.getChangedFields(),s=this.getUserDefinedFields();let o=0,a=0;if(this.canUserDefinedFields()){for(const t of s)o=Math.max(o,t.getTypeName().length),a=Math.max(a,e.AccessType(t.getAccessType()).length);if(s.length){t.string+="\n",e.IncIndent();for(const e of s)this.toVRMLStreamUserDefinedField(t,e,o,a),t.string+="\n";e.DecIndent(),0!==r.length&&(t.string+="\n")}}0===r.length?s.length?t.string+=e.Indent():t.string+=" ":(0===s.length&&(t.string+="\n"),e.IncIndent(),r.forEach((function(e){this.toVRMLStreamField(t,e,o,a),t.string+="\n"}),this),e.DecIndent(),t.string+=e.Indent()),t.string+="}",e.LeaveScope()},toVRMLStreamField:function(t,e,r,s){const o=n.Get(t),a=o.IsSharedNode(this);if(0===e.getReferences().size||!o.ExecutionContext()||a)e.isInitializable()&&(t.string+=o.Indent(),t.string+=e.getName(),t.string+=" ",e.toVRMLStream(t));else{let n=0,r=!1;e.getReferences().forEach((function(i){r=r||i.isInitializable(),t.string+=o.Indent(),t.string+=e.getName(),t.string+=" ",t.string+="IS",t.string+=" ",t.string+=i.getName(),++n,n!==e.getReferences().size&&(t.string+="\n")})),e.getAccessType()!==i.inputOutput||r||this.isDefaultValue(e)||(t.string+="\n",t.string+=o.Indent(),t.string+=e.getName(),t.string+=" ",e.toVRMLStream(t))}},toVRMLStreamUserDefinedField:function(t,e,r,s){const o=n.Get(t),a=o.IsSharedNode(this);if(0===e.getReferences().size||!o.ExecutionContext()||a)t.string+=o.Indent(),t.string+=o.PadRight(o.AccessType(e.getAccessType()),s),t.string+=" ",t.string+=o.PadRight(e.getTypeName(),r),t.string+=" ",t.string+=e.getName(),e.isInitializable()&&(t.string+=" ",e.toVRMLStream(t));else{let n=0,a=!1;e.getReferences().forEach((function(i){a=a||i.isInitializable(),t.string+=o.Indent(),t.string+=o.PadRight(o.AccessType(e.getAccessType()),s),t.string+=" ",t.string+=o.PadRight(e.getTypeName(),r),t.string+=" ",t.string+=e.getName(),t.string+=" ",t.string+="IS",t.string+=" ",t.string+=i.getName(),++n,n!==e.getReferences().size&&(t.string+="\n")})),e.getAccessType()!==i.inputOutput||a||e.isDefaultValue()||(t.string+="\n",t.string+=o.Indent(),t.string+=o.PadRight(o.AccessType(e.getAccessType()),s),t.string+=" ",t.string+=o.PadRight(e.getTypeName(),r),t.string+=" ",t.string+=e.getName(),e.isInitializable()&&(t.string+=" ",e.toVRMLStream(t)))}},toXMLStream:function(t){const e=n.Get(t),r=e.IsSharedNode(this);e.EnterScope();const s=e.Name(this);if(s.length&&e.ExistsNode(this)){t.string+=e.Indent(),t.string+="<",t.string+=this.getTypeName(),t.string+=" ",t.string+="USE='",t.string+=e.XMLEncode(s),t.string+="'";const i=e.ContainerField();return i&&i.getName()!==this.getContainerField()&&(t.string+=" ",t.string+="containerField='",t.string+=e.XMLEncode(i.getName()),t.string+="'"),t.string+="/>",void e.LeaveScope()}t.string+=e.Indent(),t.string+="<",t.string+=this.getTypeName(),s.length&&(e.AddNode(this),t.string+=" ",t.string+="DEF='",t.string+=e.XMLEncode(s),t.string+="'");const o=e.ContainerField();o&&o.getName()!==this.getContainerField()&&(t.string+=" ",t.string+="containerField='",t.string+=e.XMLEncode(o.getName()),t.string+="'");const a=this.getChangedFields(),u=this.getUserDefinedFields(),l=[],c=[];let h=this.getSourceText();h&&0===h.length&&(h=null),e.IncIndent(),e.IncIndent();for(const n of a){let s=!1;if(e.ExecutionContext()&&n.getAccessType()===i.inputOutput&&0!==n.getReferences().size){let t=!1;n.getReferences().forEach((function(e){t=t||e.isInitializable()})),t||(s=!this.isDefaultValue(n))}if(0===n.getReferences().size||!e.ExecutionContext()||r||s){if(s&&l.push(n),n.isInitializable())switch(n.getType()){case i.SFNode:case i.MFNode:c.push(n);break;default:if(n===h)break;t.string+="\n",t.string+=e.Indent(),t.string+=n.getName(),t.string+="='",n.toXMLStream(t),t.string+="'"}}else l.push(n)}if(e.DecIndent(),e.DecIndent(),this.canUserDefinedFields()&&u.length||l.length&&!r||c.length||h){if(t.string+=">\n",e.IncIndent(),this.canUserDefinedFields())for(const n of u){t.string+=e.Indent(),t.string+="<field",t.string+=" ",t.string+="accessType='",t.string+=e.AccessType(n.getAccessType()),t.string+="'",t.string+=" ",t.string+="type='",t.string+=n.getTypeName(),t.string+="'",t.string+=" ",t.string+="name='",t.string+=e.XMLEncode(n.getName()),t.string+="'";let s=!1;if(n.getAccessType()===i.inputOutput&&0!==n.getReferences().size){let t=!1;n.getReferences().forEach((function(e){t=t||e.isInitializable()})),t||(s=!0)}if(0===n.getReferences().size||!e.ExecutionContext()||r||s)if(s&&e.ExecutionContext()&&l.push(n),!n.isInitializable()||n.isDefaultValue())t.string+="/>\n";else switch(n.getType()){case i.SFNode:case i.MFNode:e.PushContainerField(n),t.string+=">\n",e.IncIndent(),n.toXMLStream(t),t.string+="\n",e.DecIndent(),t.string+=e.Indent(),t.string+="</field>\n",e.PopContainerField();break;default:t.string+=" ",t.string+="value='",n.toXMLStream(t),t.string+="'",t.string+="/>\n"}else e.ExecutionContext()&&l.push(n),t.string+="/>\n"}if(l.length&&!r){t.string+=e.Indent(),t.string+="<IS>",t.string+="\n",e.IncIndent();for(const i of l){i.getReferences().forEach((function(n){t.string+=e.Indent(),t.string+="<connect",t.string+=" ",t.string+="nodeField='",t.string+=e.XMLEncode(i.getName()),t.string+="'",t.string+=" ",t.string+="protoField='",t.string+=e.XMLEncode(n.getName()),t.string+="'",t.string+="/>\n"}))}e.DecIndent(),t.string+=e.Indent(),t.string+="</IS>\n"}for(const i of c)e.PushContainerField(i),i.toXMLStream(t),t.string+="\n",e.PopContainerField();if(h)for(const i of h)t.string+="<![CDATA[",t.string+=e.escapeCDATA(i),t.string+="]]>\n";e.DecIndent(),t.string+=e.Indent(),t.string+="</",t.string+=this.getTypeName(),t.string+=">"}else t.string+="/>";e.LeaveScope()},dispose:function(){const i=this.getExecutionContext();if(this.getName()&&i.removeNamedNode(this.getName()),!i.isMainScene()){const t=i.getExecutionContext();for(const e of t.getImportedNodes())try{e.getExportedNode()===this&&t.removeImportedNode(e.getImportedName())}catch(t){}}if(i.isScene())for(const t of i.getExportedNodes())t.getLocalNode()===this&&i.removeExportedNode(t.getExportedName());for(const t of this.getFields())t.dispose();for(const e of new Set(this.getParents()))if(e instanceof t.SFNode){for(const i of new Set(e.getParents()))if(i instanceof t.MFNode){const t=i.length;i.erase(i.remove(0,t,e),t)}e.setValue(null)}e.prototype.dispose.call(this)}}),r})),define("x_ite/Execution/X3DImportedNode",["x_ite/Components/Core/X3dNode","x_ite/Base/X3DConstants","x_ite/Fields/SFNodeCache","x_ite/InputOutput/Generator"],(function(t,e,i,n){"use strict";const r=Symbol(),s=Symbol(),o=Symbol(),a=Symbol();function u(e,i,n,u){t.call(this,e),this[r]=i,this[s]=n,this[o]=u,this[a]=new Set,this[r]._loadState.addInterest("set_loadState__",this)}u.prototype=Object.assign(Object.create(t.prototype),{constructor:u,getInlineNode:function(){return this[r]},getExportedName:function(){return this[s]},getExportedNode:function(){return this[r].getInternalScene().getExportedNode(this[s]).getValue()},getImportedName:function(){return this[o]},addRoute:function(t,i,n,s){const o={sourceNode:t,sourceField:i,destinationNode:n,destinationField:s};this[a].add(o),this[r].checkLoadState()===e.COMPLETE_STATE&&this.resolveRoute(o)},resolveRoute:function(t){try{const e=t.sourceField,i=t.destinationField;let n=t.sourceNode,r=t.destinationNode;t.real&&t.real.dispose(),n instanceof u&&(n=n.getExportedNode()),r instanceof u&&(r=r.getExportedNode()),t.real=this.getExecutionContext().addSimpleRoute(n,e,r,i)}catch(t){console.error(t.message)}},deleteRoute:function(t){for(const e of this[a])e.real===t&&this[a].delete(e)},deleteRoutes:function(){for(const t of this[a]){const e=t.real;e&&(delete t.real,this.getExecutionContext().deleteSimpleRoute(e))}},set_loadState__:function(){switch(this[r].checkLoadState()){case e.NOT_STARTED_STATE:case e.FAILED_STATE:this.deleteRoutes();break;case e.COMPLETE_STATE:this.deleteRoutes();for(const t of this[a])this.resolveRoute(t)}},toVRMLStream:function(t){const e=n.Get(t);if(!e.ExistsNode(this.getInlineNode()))throw new Error("X3DImportedNode.toXMLStream: Inline node does not exist.");t.string+=e.Indent(),t.string+="IMPORT",t.string+=" ",t.string+=e.Name(this.getInlineNode()),t.string+=".",t.string+=this.getExportedName(),this.getImportedName()!==this.getExportedName()&&(t.string+=" ",t.string+="AS",t.string+=" ",t.string+=this.getImportedName());try{e.AddRouteNode(this),e.AddImportedNode(this.getExportedNode(),this.getImportedName())}catch(i){for(const i of this[a]){const n=i.sourceNode,r=i.sourceField,s=i.destinationNode,o=i.destinationField;if(e.ExistsRouteNode(n)&&e.ExistsRouteNode(s)){const i=n instanceof u?n.getImportedName():e.Name(n),a=s instanceof u?s.getImportedName():e.Name(s);t.string+="\n",t.string+="\n",t.string+=e.Indent(),t.string+="ROUTE",t.string+=" ",t.string+=i,t.string+=".",t.string+=r,t.string+=" ",t.string+="TO",t.string+=" ",t.string+=a,t.string+=".",t.string+=o}}}},toXMLStream:function(t){const e=n.Get(t);if(!e.ExistsNode(this.getInlineNode()))throw new Error("X3DImportedNode.toXMLStream: Inline node does not exist.");t.string+=e.Indent(),t.string+="<IMPORT",t.string+=" ",t.string+="inlineDEF='",t.string+=e.XMLEncode(e.Name(this.getInlineNode())),t.string+="'",t.string+=" ",t.string+="importedDEF='",t.string+=e.XMLEncode(this.getExportedName()),t.string+="'",this.getImportedName()!==this.getExportedName()&&(t.string+=" ",t.string+="AS='",t.string+=e.XMLEncode(this.getImportedName()),t.string+="'"),t.string+="/>";try{e.AddRouteNode(this),e.AddImportedNode(this.getExportedNode(),this.getImportedName())}catch(i){for(const i of this[a]){const n=i.sourceNode,r=i.sourceField,s=i.destinationNode,o=i.destinationField;if(e.ExistsRouteNode(n)&&e.ExistsRouteNode(s)){const i=n instanceof u?n.getImportedName():e.Name(n),a=s instanceof u?s.getImportedName():e.Name(s);t.string+="\n",t.string+="\n",t.string+=e.Indent(),t.string+="<ROUTE",t.string+=" ",t.string+="fromNode='",t.string+=e.XMLEncode(i),t.string+="'",t.string+=" ",t.string+="fromField='",t.string+=e.XMLEncode(r),t.string+="'",t.string+=" ",t.string+="toNode='",t.string+=e.XMLEncode(a),t.string+="'",t.string+=" ",t.string+="toField='",t.string+=e.XMLEncode(o),t.string+="'",t.string+="/>"}}}},dispose:function(){this[r]._loadState.removeInterest("set_loadState__",this),this.deleteRoutes(),t.prototype.dispose.call(this)}});for(const t of Reflect.ownKeys(u.prototype))Object.defineProperty(u.prototype,t,{enumerable:!1});return Object.defineProperty(u.prototype,"inlineNode",{get:function(){return i.get(this[r])},enumerable:!0,configurable:!1}),Object.defineProperty(u.prototype,"exportedName",{get:function(){return this[s]},enumerable:!0,configurable:!1}),Object.defineProperty(u.prototype,"exportedNode",{get:function(){return this[r].getInternalScene().getExportedNode(this[s])},enumerable:!0,configurable:!1}),Object.defineProperty(u.prototype,"importedName",{get:function(){return this[o]},enumerable:!0,configurable:!1}),u})),define("x_ite/Execution/ImportedNodesArray",["x_ite/Base/X3DInfoArray"],(function(t){"use strict";function e(e){return t.call(this,e)}e.prototype=Object.assign(Object.create(t.prototype),{constructor:e,getTypeName:function(){return"ImportedNodesArray"}});for(const t of Reflect.ownKeys(e.prototype))Object.defineProperty(e.prototype,t,{enumerable:!1});return e})),define("x_ite/Prototype/ExternProtoDeclarationArray",["x_ite/Base/X3DInfoArray"],(function(t){"use strict";function e(e){return t.call(this,e)}e.prototype=Object.assign(Object.create(t.prototype),{constructor:e,getTypeName:function(){return"ExternProtoDeclarationArray"}});for(const t of Reflect.ownKeys(e.prototype))Object.defineProperty(e.prototype,t,{enumerable:!1});return e})),define("x_ite/Prototype/ProtoDeclarationArray",["x_ite/Base/X3DInfoArray"],(function(t){"use strict";function e(e){return t.call(this,e)}e.prototype=Object.assign(Object.create(t.prototype),{constructor:e,getTypeName:function(){return"ProtoDeclarationArray"}});for(const t of Reflect.ownKeys(e.prototype))Object.defineProperty(e.prototype,t,{enumerable:!1});return e})),define("x_ite/Routing/RouteArray",["x_ite/Base/X3DInfoArray"],(function(t){"use strict";function e(){return t.call(this)}e.prototype=Object.assign(Object.create(t.prototype),{constructor:e,getTypeName:function(){return"RouteArray"}});for(const t of Reflect.ownKeys(e.prototype))Object.defineProperty(e.prototype,t,{enumerable:!1});return e})),define("x_ite/Routing/X3DRoute",["x_ite/Base/X3DObject","x_ite/Base/X3DConstants","x_ite/Fields/SFNodeCache","x_ite/InputOutput/Generator"],(function(t,e,i,n){"use strict";const r=Symbol(),s=Symbol(),o=Symbol(),a=Symbol(),u=Symbol();function l(e,i,n,l,c){t.call(this,e),this[r]=e,this[s]=i,this[o]=n,this[a]=l,this[u]=c,n.addFieldInterest(c),n.addOutputRoute(this),c.addInputRoute(this)}l.prototype=Object.assign(Object.create(t.prototype),{getTypeName:function(){return"X3DRoute"},getExecutionContext:function(){return this[r]},getSourceNode:function(){return this[s]},getSourceField:function(){return this[o]},getDestinationNode:function(){return this[a]},getDestinationField:function(){return this[u]},disconnect:function(){this[o].removeFieldInterest(this[u]),this[o].removeOutputRoute(this),this[u].removeInputRoute(this)},toVRMLStream:function(t){const i=n.Get(t),r=i.LocalName(this[s]),l=i.LocalName(this[a]);t.string+=i.Indent(),t.string+="ROUTE",t.string+=" ",t.string+=r,t.string+=".",t.string+=this[o].getName(),this[o].getAccessType()===e.inputOutput&&(t.string+="_changed"),t.string+=" ",t.string+="TO",t.string+=" ",t.string+=l,t.string+=".",this[u].getAccessType()===e.inputOutput&&(t.string+="set_"),t.string+=this[u].getName()},toXMLStream:function(t){const i=n.Get(t),r=i.LocalName(this[s]),l=i.LocalName(this[a]);t.string+=i.Indent(),t.string+="<ROUTE",t.string+=" ",t.string+="fromNode='",t.string+=i.XMLEncode(r),t.string+="'",t.string+=" ",t.string+="fromField='",t.string+=i.XMLEncode(this[o].getName()),this[o].getAccessType()===e.inputOutput&&(t.string+="_changed"),t.string+="'",t.string+=" ",t.string+="toNode='",t.string+=i.XMLEncode(l),t.string+="'",t.string+=" ",t.string+="toField='",this[u].getAccessType()===e.inputOutput&&(t.string+="set_"),t.string+=i.XMLEncode(this[u].getName()),t.string+="'",t.string+="/>"},dispose:function(){this.disconnect(),this[r].deleteRoute(this),t.prototype.dispose.call(this)}});for(const t of Reflect.ownKeys(l.prototype))Object.defineProperty(l.prototype,t,{enumerable:!1});return Object.defineProperty(l.prototype,"sourceNode",{get:function(){return i.get(this[s])},enumerable:!0,configurable:!1}),Object.defineProperty(l.prototype,"sourceField",{get:function(){return this[o].getName()},enumerable:!0,configurable:!1}),Object.defineProperty(l.prototype,"destinationNode",{get:function(){return i.get(this[a])},enumerable:!0,configurable:!1}),Object.defineProperty(l.prototype,"destinationField",{get:function(){return this[u].getName()},enumerable:!0,configurable:!1}),l})),define("x_ite/Execution/X3DExecutionContext",["x_ite/Configuration/SupportedNodes","x_ite/Fields","x_ite/Base/X3DBaseNode","x_ite/Execution/NamedNodesArray","x_ite/Execution/X3DImportedNode","x_ite/Execution/ImportedNodesArray","x_ite/Prototype/ExternProtoDeclarationArray","x_ite/Prototype/ProtoDeclarationArray","x_ite/Routing/RouteArray","x_ite/Routing/X3DRoute","x_ite/Base/X3DCast","x_ite/Base/X3DConstants","x_ite/InputOutput/Generator","x_ite/Fields/SFNodeCache","standard/Math/Algorithm"],(function(t,e,i,n,r,s,o,a,u,l,c,h,d,p,f){"use strict";const g=Symbol(),m=Symbol(),_=Symbol(),y=Symbol(),x=Symbol(),w=Symbol();function b(t){i.call(this,t),this.addType(h.X3DExecutionContext),this.addChildObjects("rootNodes",new e.MFNode,"worldInfos",new e.MFNode,"sceneGraph_changed",new e.SFTime),this._rootNodes.setAccessType(h.initializeOnly),this._rootNodes.addCloneCount(1),this[g]=new n,this[m]=new s,this[_]=new a,this[y]=new o,this[x]=new u,this.addChildObjects("namedNodes_changed",new e.SFTime,"importedNodes_changed",new e.SFTime,"protos_changed",new e.SFTime,"externprotos_changed",new e.SFTime,"routes_changed",new e.SFTime)}t.addAbstractType("X3DExecutionContext",b),b.prototype=Object.assign(Object.create(i.prototype),{constructor:b,initialize:function(){i.prototype.initialize.call(this),this.isScene()||this._sceneGraph_changed.addInterest("set_sceneGraph",this)},set_sceneGraph:function(){this.getExecutionContext()._sceneGraph_changed=this.getBrowser().getCurrentTime()},isScene:function(){return!1},getTypeName:function(){return"X3DExecutionContext"},[w]:null,getOuterNode:function(){return this[w]},setOuterNode:function(t){this[w]=t},getSpecificationVersion:function(){return this.getExecutionContext().getSpecificationVersion()},getEncoding:function(){return this.getExecutionContext().getEncoding()},getWorldURL:function(){return this.getExecutionContext().getWorldURL()},getProfile:function(){return this.getExecutionContext().getProfile()},getComponents:function(){return this.getExecutionContext().getComponents()},fromUnit:function(t,e){return this.getExecutionContext().fromUnit(t,e)},toUnit:function(t,e){return this.getExecutionContext().toUnit(t,e)},getUnits:function(){return this.getExecutionContext().getUnits()},createNode:function(t,e=!0){if(t=String(t),!1===e){const e=this.getBrowser().getSupportedNode(t);return e?new e(this):null}{const e=this.getBrowser().getSupportedNode(t);if(!e)throw new Error("Unknown node type '"+t+"'.");const i=new e(this);return i.setup(),p.get(i)}},createProto:function(t,e=!0){t=String(t);let i=this;for(;;){const n=i.protos.get(t);if(n)return n.createInstance(this,e);const r=i.externprotos.get(t);if(r)return r.createInstance(this,e);if(i.isScene())break;i=i.getExecutionContext()}if(!1===e)return null;throw new Error("Unknown proto or externproto type '"+t+"'.")},addNamedNode:function(t,e){if(this[g].has(t))throw new Error("Couldn't add named node: node named '"+t+"' is already in use.");this.updateNamedNode(t,e)},updateNamedNode:function(t,e){if(t=String(t),!(e=c(h.X3DNode,e,!1)))throw new Error("Couldn't update named node: node must be of type X3DNode.");if(e.getExecutionContext()!==this)throw new Error("Couldn't update named node: node does not belong to this execution context.");if(0===t.length)throw new Error("Couldn't update named node: node name is empty.");this.removeNamedNode(e.getName()),this.removeNamedNode(t),e.setName(t),this[g].add(t,e),this._namedNodes_changed=this.getBrowser().getCurrentTime()},removeNamedNode:function(t){t=String(t);const e=this[g].get(t);e&&(e.setName(""),this[g].remove(t),this._namedNodes_changed=this.getBrowser().getCurrentTime())},getNamedNode:function(t){t=String(t);const e=this[g].get(t);if(e)return p.get(e);throw new Error("Named node '"+t+"' not found.")},getNamedNodes:function(){return this[g]},getUniqueName:function(t=""){return v.call(this,g,t)},addImportedNode:function(t,e,i){if(void 0===i&&(i=e),e=String(e),i=String(i),this[m].has(i))throw new Error("Couldn't add imported node: imported name '"+i+"' already in use.");this.updateImportedNode(t,e,i)},updateImportedNode:function(t,e,i){if(t=c(h.Inline,t,!1),e=String(e),i=void 0===i?e:String(i),!t)throw new Error("Node must be of type Inline node.");if(t.getExecutionContext()!==this)throw new Error("Couldn't update imported node: Inline node does not belong to this execution context.");if(0===e.length)throw new Error("Couldn't update imported node: exported name is empty.");if(0===i.length)throw new Error("Couldn't update imported node: imported name is empty.");this.removeImportedNode(i);const n=new r(this,t,e,i);this[m].add(i,n),n.setup(),this._importedNodes_changed=this.getBrowser().getCurrentTime()},removeImportedNode:function(t){t=String(t);const e=this[m].get(t);e&&(e.dispose(),this[m].remove(t),this._importedNodes_changed=this.getBrowser().getCurrentTime())},getImportedNode:function(t){t=String(t);const e=this[m].get(t);if(e)return p.get(e.getExportedNode());throw new Error("Imported node '"+t+"' not found.")},getImportedNodes:function(){return this[m]},getLocalNode:function(t){t=String(t);try{return this.getNamedNode(t)}catch(e){const i=this[m].get(t);if(i)return p.get(i);throw new Error("Unknown named or imported node '"+t+"'.")}},getLocalName:function(t){if(!(t=c(h.X3DNode,t,!1)))throw new Error("Couldn't get local name: node must be of type X3DNode.");if(t.getExecutionContext()===this)return t.getName();for(const e of this[m])try{if(e.getExportedNode()===t)return e.getImportedName()}catch(t){}throw new Error("Couldn't get local name: node is shared.")},setRootNodes:function(){},getRootNodes:function(){return this._rootNodes},getProtoDeclaration:function(t){t=String(t);const e=this[_].get(t);if(e)return e;throw new Error("Proto declaration '"+t+"' not found.")},addProtoDeclaration(t,e){t=String(t);if(!(e instanceof require("x_ite/Prototype/X3DProtoDeclaration")))throw new Error("Couldn't add proto declaration: proto must be of type X3DProtoDeclaration.");if(this[_].get(t))throw new Error("Couldn't add proto declaration: proto '"+t+"' already in use.");if(0===(t=String(t)).length)throw new Error("Couldn't add proto declaration: proto name is empty.");this[_].add(t,e),e.setName(t),this._protos_changed=this.getBrowser().getCurrentTime()},updateProtoDeclaration(t,e){t=String(t);if(!(e instanceof require("x_ite/Prototype/X3DProtoDeclaration")))throw new Error("Couldn't add proto declaration: proto must be of type X3DProtoDeclaration.");if(0===(t=String(t)).length)throw new Error("Couldn't add proto declaration: proto name is empty.");this[_].update(e.getName(),t,e),e.setName(t),this._protos_changed=this.getBrowser().getCurrentTime()},removeProtoDeclaration(t){t=String(t),this[_].remove(t),this._protos_changed=this.getBrowser().getCurrentTime()},getProtoDeclarations:function(){return this[_]},getUniqueProtoName:function(t=""){return v.call(this,_,t)},getExternProtoDeclaration:function(t){t=String(t);const e=this[y].get(t);if(e)return e;throw new Error("Extern proto declaration '"+t+"' not found.")},addExternProtoDeclaration(t,e){t=String(t);if(!(e instanceof require("x_ite/Prototype/X3DExternProtoDeclaration")))throw new Error("Couldn't add extern proto declaration: extern proto must be of type X3DExternProtoDeclaration.");if(this[y].get(t))throw new Error("Couldn't add extern proto declaration: extern proto '"+t+"' already in use.");if(0===(t=String(t)).length)throw new Error("Couldn't add extern proto declaration: extern proto name is empty.");this[y].add(t,e),e.setName(t),this._externprotos_changed=this.getBrowser().getCurrentTime()},updateExternProtoDeclaration(t,e){t=String(t);if(!(e instanceof require("x_ite/Prototype/X3DExternProtoDeclaration")))throw new Error("Couldn't add extern proto declaration: extern proto must be of type X3DExternProtoDeclaration.");if(0===(t=String(t)).length)throw new Error("Couldn't add extern proto declaration: extern proto name is empty.");this[y].update(e.getName(),t,e),e.setName(t),this._externprotos_changed=this.getBrowser().getCurrentTime()},removeExternProtoDeclaration(t){t=String(t),this[y].remove(t),this._externprotos_changed=this.getBrowser().getCurrentTime()},getExternProtoDeclarations:function(){return this[y]},getUniqueExternProtoName:function(t=""){return v.call(this,y,t)},addRoute:function(t,e,i,n){if(t=c(h.X3DNode,t,!1),e=String(e),i=c(h.X3DNode,i,!1),n=String(n),!t)throw new Error("Bad ROUTE specification: source node must be of type X3DNode.");if(!i)throw new Error("Bad ROUTE specification: destination node must be of type X3DNode.");let s=t instanceof r?t:null,o=i instanceof r?i:null;try{t.getExecutionContext()!==this&&(s=this.getLocalNode(this.getLocalName(t)).getValue())}catch(t){}try{i.getExecutionContext()!==this&&(o=this.getLocalNode(this.getLocalName(i)).getValue())}catch(t){}if(s instanceof r&&o instanceof r?(s.addRoute(s,e,o,n),o.addRoute(s,e,o,n)):s instanceof r?s.addRoute(s,e,i,n):o instanceof r&&o.addRoute(t,e,o,n),s!==t&&o!==i)return this.addSimpleRoute(t,e,i,n)},addSimpleRoute:function(t,e,i,n){try{if(e=t.getField(e),n=i.getField(n),!e.isOutput())throw new Error("Field named '"+e.getName()+"' in node named '"+t.getName()+"' of type "+t.getTypeName()+" is not an output field.");if(!n.isInput())throw new Error("Field named '"+n.getName()+"' in node named '"+i.getName()+"' of type "+i.getTypeName()+" is not an input field.");if(e.getType()!==n.getType())throw new Error("ROUTE types "+e.getTypeName()+" and "+n.getTypeName()+" do not match.");const r=e.getId()+"."+n.getId();let s=this[x].get(r);return s||(s=new l(this,t,e,i,n),this[x].add(r,s),this._routes_changed=this.getBrowser().getCurrentTime(),s)}catch(t){throw new Error("Bad ROUTE specification: "+t.message)}},deleteRoute:function(t){if(4===arguments.length&&!(t=this.getRoute.apply(this,arguments)))return!1;this.deleteSimpleRoute(t)&&this.deleteImportedRoute(t.sourceNode,t.destinationNode,t)},deleteSimpleRoute:function(t){try{const e=t.getSourceField(),i=t.getDestinationField(),n=e.getId()+"."+i.getId();return this[x].remove(n),t.disconnect(),this._routes_changed=this.getBrowser().getCurrentTime(),!0}catch(t){return console.error(t),!1}},deleteImportedRoute(t,e,i){let n=null,s=null;try{t.getValue().getExecutionContext()!==this&&(n=this.getLocalNode(this.getLocalName(t)).getValue())}catch(t){}try{e.getValue().getExecutionContext()!==this&&(s=this.getLocalNode(this.getLocalName(e)).getValue())}catch(t){}n instanceof r&&s instanceof r?(n.deleteRoute(i),s.deleteRoute(i)):n instanceof r?n.deleteRoute(i):s instanceof r&&s.deleteRoute(i)},getRoute:function(t,e,i,n){if(t=c(h.X3DNode,t,!1),e=String(e),i=c(h.X3DNode,i,!1),n=String(n),!t)throw new Error("Bad ROUTE specification: sourceNode must be of type X3DNode.");if(!i)throw new Error("Bad ROUTE specification: destinationNode must be of type X3DNode.");e=t.getField(e),n=i.getField(n);const r=e.getId()+"."+n.getId();return this[x].get(r)},getRoutes:function(){return this[x]},getWorldInfos:function(){return this._worldInfos},addWorldInfo:function(t){this._worldInfos.push(t)},removeWorldInfo:function(t){for(let e=this._worldInfos.length-1;e>=0;--e)this._worldInfos[e].getValue()===t&&this._worldInfos.splice(e,1)},toVRMLStream:function(t){const e=d.Get(t);e.PushExecutionContext(this),e.EnterScope(),e.ImportedNodes(this.getImportedNodes()),this.getExternProtoDeclarations().toVRMLStream(t),this.getProtoDeclarations().toVRMLStream(t);const i=this.getRootNodes();for(let n=0,r=i.length;n<r;++n){const s=i[n];t.string+=e.Indent(),s?s.toVRMLStream(t):t.string+="NULL",t.string+="\n",n!==r-1&&(t.string+="\n")}const n=this.getImportedNodes();n.size&&(t.string+="\n",n.forEach((function(e){try{e.toVRMLStream(t),t.string+="\n"}catch(t){}})));const r=this.getRoutes();r.length&&(t.string+="\n",r.toVRMLStream(t)),e.LeaveScope(),e.PopExecutionContext()},toXMLStream:function(t){const e=d.Get(t);e.PushExecutionContext(this),e.EnterScope(),e.ImportedNodes(this.getImportedNodes()),this.getExternProtoDeclarations().toXMLStream(t),this.getProtoDeclarations().toXMLStream(t);const i=this.getRootNodes();i.length&&(i.toXMLStream(t),t.string+="\n");this.getImportedNodes().forEach((function(e){try{e.toXMLStream(t),t.string+="\n"}catch(t){}})),this.getRoutes().toXMLStream(t),e.LeaveScope(),e.PopExecutionContext()},dispose:function(){this._rootNodes.dispose();for(const t of this[x])this.deleteRoute(t);i.prototype.dispose.call(this)}});const v=function(){const t=/_\d+$/;return function(e,i=""){let n=i=String(i).replace(t,""),r=64;for(;r&&(this[e].has(n)||0===n.length);){const t=r,e=r<<=1;n=i,n+="_",n+=Math.round(f.random(t,e))}return n}}();for(const t of Reflect.ownKeys(b.prototype))Object.defineProperty(b.prototype,t,{enumerable:!1});return Object.defineProperty(b.prototype,"specificationVersion",{get:function(){return this.getSpecificationVersion()},enumerable:!0,configurable:!1}),Object.defineProperty(b.prototype,"encoding",{get:function(){return this.getEncoding()},enumerable:!0,configurable:!1}),Object.defineProperty(b.prototype,"profile",{get:function(){return this.getProfile()},enumerable:!0,configurable:!1}),Object.defineProperty(b.prototype,"components",{get:function(){return this.getComponents()},enumerable:!0,configurable:!1}),Object.defineProperty(b.prototype,"worldURL",{get:function(){return this.getWorldURL()},enumerable:!0,configurable:!1}),Object.defineProperty(b.prototype,"units",{get:function(){return this.getUnits()},enumerable:!0,configurable:!1}),Object.defineProperty(b.prototype,"rootNodes",{get:function(){return this.getRootNodes()},set:function(t){this.setRootNodes(t)},enumerable:!0,configurable:!1}),Object.defineProperty(b.prototype,"protos",{get:function(){return this.getProtoDeclarations()},enumerable:!0,configurable:!1}),Object.defineProperty(b.prototype,"externprotos",{get:function(){return this.getExternProtoDeclarations()},enumerable:!0,configurable:!1}),Object.defineProperty(b.prototype,"routes",{get:function(){return this.getRoutes()},enumerable:!0,configurable:!1}),b})),define("x_ite/Configuration/ComponentInfo",["x_ite/Base/X3DObject","x_ite/InputOutput/Generator"],(function(t,e){"use strict";function i(t,e,i,n){this.name=t,this.level=e,this.title=i,this.providerUrl=n}i.prototype=Object.assign(Object.create(t.prototype),{constructor:i,getTypeName:function(){return"ComponentInfo"},toVRMLStream:function(t){t.string+="COMPONENT",t.string+=" ",t.string+=this.name,t.string+=" ",t.string+=":",t.string+=" ",t.string+=this.level},toXMLStream:function(t){const i=e.Get(t);t.string+=i.Indent(),t.string+="<component",t.string+=" ",t.string+="name='",t.string+=this.name,t.string+="'",t.string+=" ",t.string+="level='",t.string+=this.level,t.string+="'",t.string+="/>"}});for(const t of Reflect.ownKeys(i.prototype))Object.defineProperty(i.prototype,t,{enumerable:!1});return i})),define("x_ite/Configuration/ComponentInfoArray",["x_ite/Configuration/ComponentInfo","x_ite/Base/X3DInfoArray"],(function(t,e){"use strict";function i(t){return e.call(this,t)}i.prototype=Object.assign(Object.create(e.prototype),{constructor:i,getTypeName:function(){return"ComponentInfoArray"},addComponent:function(e){this.add(e.name,new t(e.name,e.level,e.title,e.providerUrl))}});for(const t of Reflect.ownKeys(i.prototype))Object.defineProperty(i.prototype,t,{enumerable:!1});return i})),define("x_ite/Configuration/UnitInfo",["x_ite/Base/X3DObject","x_ite/InputOutput/Generator"],(function(t,e){"use strict";function i(t,e,i){Object.defineProperty(this,"category",{value:t,writable:!1}),this.name=e,this.conversionFactor=i}i.prototype=Object.assign(Object.create(t.prototype),{constructor:i,getTypeName:function(){return"UnitInfo"},toVRMLStream:function(t){t.string+="UNIT",t.string+=" ",t.string+=this.category,t.string+=" ",t.string+=this.name,t.string+=" ",t.string+=this.conversionFactor},toXMLStream:function(t){const i=e.Get(t);t.string+=i.Indent(),t.string+="<unit",t.string+=" ",t.string+="category='",t.string+=this.category,t.string+="'",t.string+=" ",t.string+="name='",t.string+=i.XMLEncode(this.name),t.string+="'",t.string+=" ",t.string+="conversionFactor='",t.string+=this.conversionFactor,t.string+="'",t.string+="/>"}});for(const t of Reflect.ownKeys(i.prototype))Object.defineProperty(i.prototype,t,{enumerable:!1});return Object.defineProperty(i.prototype,"conversion_factor",{get:function(){return this.conversionFactor},enumerable:!1,configurable:!1}),i})),define("x_ite/Configuration/UnitInfoArray",["x_ite/Base/X3DInfoArray"],(function(t){"use strict";function e(e){return t.call(this,e)}e.prototype=Object.assign(Object.create(t.prototype),{constructor:e,getTypeName:function(){return"UnitInfoArray"}});for(const t of Reflect.ownKeys(e.prototype))Object.defineProperty(e.prototype,t,{enumerable:!1});return e})),define("x_ite/Execution/X3DExportedNode",["x_ite/Base/X3DObject","x_ite/Fields/SFNodeCache","x_ite/InputOutput/Generator"],(function(t,e,i){"use strict";const n=Symbol(),r=Symbol();function s(e,i){t.call(this),this[n]=e,this[r]=i}s.prototype=Object.assign(Object.create(t.prototype),{constructor:s,getExportedName:function(){return this[n]},getLocalNode:function(){return this[r]},toVRMLStream:function(t){const e=i.Get(t),s=e.LocalName(this[r]);t.string+=e.Indent(),t.string+="EXPORT",t.string+=" ",t.string+=s,this[n]!==s&&(t.string+=" ",t.string+="AS",t.string+=" ",t.string+=this[n])},toXMLStream:function(t){const e=i.Get(t),s=e.LocalName(this[r]);t.string+=e.Indent(),t.string+="<EXPORT",t.string+=" ",t.string+="localDEF='",t.string+=e.XMLEncode(s),t.string+="'",this[n]!==s&&(t.string+=" ",t.string+="AS='",t.string+=e.XMLEncode(this[n]),t.string+="'"),t.string+="/>"}});for(const t of Reflect.ownKeys(s.prototype))Object.defineProperty(s.prototype,t,{enumerable:!1});return Object.defineProperty(s.prototype,"exportedName",{get:function(){return e.get(this[n])},enumerable:!0,configurable:!1}),Object.defineProperty(s.prototype,"localNode",{get:function(){return e.get(this[r])},enumerable:!0,configurable:!1}),s})),define("x_ite/Execution/ExportedNodesArray",["x_ite/Base/X3DInfoArray"],(function(t){"use strict";function e(e){return t.call(this,e)}e.prototype=Object.assign(Object.create(t.prototype),{constructor:e,getTypeName:function(){return"ExportedNodesArray"}});for(const t of Reflect.ownKeys(e.prototype))Object.defineProperty(e.prototype,t,{enumerable:!1});return e})),define("x_ite/Execution/X3DScene",["x_ite/Configuration/SupportedNodes","x_ite/Fields","x_ite/Execution/X3DExecutionContext","x_ite/Configuration/ComponentInfoArray","x_ite/Configuration/UnitInfo","x_ite/Configuration/UnitInfoArray","x_ite/Execution/X3DExportedNode","x_ite/Execution/ExportedNodesArray","x_ite/Base/X3DCast","x_ite/Base/X3DConstants","x_ite/InputOutput/Generator","x_ite/Fields/SFNodeCache"],(function(t,e,i,n,r,s,o,a,u,l,c,h){"use strict";const d=Symbol(),p=Symbol(),f=Symbol(),g=Symbol(),m=Symbol(),_=Symbol(),y=Symbol(),x=Symbol();function w(t){i.call(this,t),this.addType(l.X3DScene),this[d]="3.3",this[p]="SCRIPTED",this[f]=null,this[g]=new n([]),this[m]=location.toString(),this[_]=new s,this[_].add("angle",new r("angle","radian",1)),this[_].add("force",new r("force","newton",1)),this[_].add("length",new r("length","metre",1)),this[_].add("mass",new r("mass","kilogram",1)),this[y]=new Map,this[x]=new a,this.addChildObjects("profile_changed",new e.SFTime,"components_changed",new e.SFTime,"units_changed",new e.SFTime,"metadata_changed",new e.SFTime,"exportedNodes_changed",new e.SFTime),this.getRootNodes().setAccessType(l.inputOutput),this.setLive(!1)}t.addAbstractType("X3DScene",w),w.prototype=Object.assign(Object.create(i.prototype),{constructor:w,getTypeName:function(){return"X3DScene"},isMainScene:function(){return this===this.getExecutionContext()},isScene:function(){return!0},setSpecificationVersion:function(t){this[d]=String(t)},getSpecificationVersion:function(){return this[d]},setEncoding:function(t){this[p]=String(t)},getEncoding:function(){return this[p]},setWorldURL:function(t){this[m]=String(t)},getWorldURL:function(){return this[m]},setProfile:function(t){this[f]=t,this._profile_changed=this.getBrowser().getCurrentTime()},getProfile:function(){return this[f]},addComponent:function(t){this[g].add(t.name,t),this._components_changed=this.getBrowser().getCurrentTime()},removeComponent:function(t){this[g].remove(t.name),this._components_changed=this.getBrowser().getCurrentTime()},getComponents:function(){return this[g]},updateUnit:function(t,e,i){const n=this[_].get(t);n&&(n.name=String(e),n.conversionFactor=Number(i),this._units_changed=this.getBrowser().getCurrentTime())},getUnit:function(t){return this[_].get(t)},getUnits:function(){return this[_]},fromUnit:function(t,e){switch(t){case"angle":case"force":case"length":case"mass":return e*this.getUnits().get(t).conversionFactor;case"acceleration:":case"speed":return e*this.getUnits().get("length").conversionFactor;case"angularRate":return e*this.getUnits().get("angle").conversionFactor;case"area":return e*Math.pow(this.getUnits().get("length").conversionFactor,2);case"volume":return e*Math.pow(this.getUnits().get("length").conversionFactor,3)}return e},toUnit:function(t,e){switch(t){case"angle":case"force":case"length":case"mass":return e/this.getUnits().get(t).conversionFactor;case"acceleration:":case"speed":return e/this.getUnits().get("length").conversionFactor;case"angularRate":return e/this.getUnits().get("angle").conversionFactor;case"area":return e/Math.pow(this.getUnits().get("length").conversionFactor,2);case"volume":return e/Math.pow(this.getUnits().get("length").conversionFactor,3)}return e},setMetaData:function(t,e){(t=String(t)).length&&(this[y].set(t,String(e)),this._metadata_changed=this.getBrowser().getCurrentTime())},removeMetaData:function(t){t=String(t),this[y].delete(t),this._metadata_changed=this.getBrowser().getCurrentTime()},getMetaData:function(t){return t=String(t),this[y].get(t)},getMetaDatas:function(){return this[y]},addExportedNode:function(t,e){if(t=String(t),this[x].has(t))throw new Error("Couldn't add exported node: exported name '"+t+"' already in use.");this.updateExportedNode(t,e),this._exportedNodes_changed=this.getBrowser().getCurrentTime()},updateExportedNode:function(t,e){if(t=String(t),e=u(l.X3DNode,e,!1),0===t.length)throw new Error("Couldn't update exported node: node exported name is empty.");if(!e)throw new Error("Couldn't update exported node: node must be of type X3DNode.");this.removeExportedNode(t);const i=new o(t,e);this[x].add(t,i),this._exportedNodes_changed=this.getBrowser().getCurrentTime()},removeExportedNode:function(t){t=String(t),this[x].remove(t),this._exportedNodes_changed=this.getBrowser().getCurrentTime()},getExportedNode:function(t){t=String(t);const e=this[x].get(t);if(e)return h.get(e.getLocalNode());throw new Error("Exported node '"+t+"' not found.")},getExportedNodes:function(){return this[x]},addRootNode:function(t){t=h.get(u(l.X3DNode,t,!1));const e=this.getRootNodes();for(const i of e)if(i.equals(t))return;e.push(t)},removeRootNode:function(t){t=h.get(u(l.X3DNode,t,!1));const e=this.getRootNodes(),i=e.length;e.erase(e.remove(0,i,t),i)},setRootNodes:function(t){if(!(t instanceof e.MFNode))throw new Error("Value must be of type MFNode.");this.getRootNodes().assign(t)},toVRMLStream:function(t){const n=c.Get(t);let r=this.getSpecificationVersion();"2.0"===r&&(r="3.3"),t.string+="#X3D V",t.string+=r,t.string+=" ",t.string+="utf8",t.string+=" ",t.string+=this.getBrowser().name,t.string+=" ",t.string+="V",t.string+=this.getBrowser().version,t.string+="\n",t.string+="\n";const s=this.getProfile();s&&(s.toVRMLStream(t),t.string+="\n",t.string+="\n");const o=this.getComponents();o.length&&(o.toVRMLStream(t),t.string+="\n");{let e=!0;for(const i of this.getUnits())1!==i.conversionFactor&&(e=!1,i.toVRMLStream(t),t.string+="\n");e||(t.string+="\n")}const a=this.getMetaDatas();a.size&&(a.forEach((function(i,n){t.string+="META",t.string+=" ",t.string+=new e.SFString(n).toString(),t.string+=" ",t.string+=new e.SFString(i).toString(),t.string+="\n"})),t.string+="\n");const u=this.getExportedNodes();n.PushExecutionContext(this),n.EnterScope(),n.ExportedNodes(u),i.prototype.toVRMLStream.call(this,t),u.size&&(t.string+="\n",u.forEach((function(e){try{e.toVRMLStream(t),t.string+="\n"}catch(t){console.error(t)}}))),n.LeaveScope(),n.PopExecutionContext()},toXMLStream:function(t){const e=c.Get(t);let n=this.getSpecificationVersion();"2.0"===n&&(n="3.3"),t.string+='<?xml version="1.0" encoding="UTF-8"?>\n',t.string+='<!DOCTYPE X3D PUBLIC "ISO//Web3D//DTD X3D ',t.string+=n,t.string+='//EN" "http://www.web3d.org/specifications/x3d-',t.string+=n,t.string+='.dtd">\n',t.string+="<X3D",t.string+=" ",t.string+="profile='",t.string+=this.getProfile()?this.getProfile().name:"Full",t.string+="'",t.string+=" ",t.string+="version='",t.string+=n,t.string+="'",t.string+=" ",t.string+="xmlns:xsd='http://www.w3.org/2001/XMLSchema-instance'",t.string+=" ",t.string+="xsd:noNamespaceSchemaLocation='http://www.web3d.org/specifications/x3d-",t.string+=n,t.string+=".xsd'>\n",e.IncIndent(),t.string+=e.Indent(),t.string+="<head>\n",e.IncIndent(),this.getComponents().toXMLStream(t);for(const e of this.getUnits())1!==e.conversionFactor&&(e.toXMLStream(t),t.string+="\n");this.getMetaDatas().forEach((function(i,n){t.string+=e.Indent(),t.string+="<meta",t.string+=" ",t.string+="name='",t.string+=e.XMLEncode(n),t.string+="'",t.string+=" ",t.string+="content='",t.string+=e.XMLEncode(i),t.string+="'",t.string+="/>\n"})),e.DecIndent(),t.string+=e.Indent(),t.string+="</head>\n",t.string+=e.Indent(),t.string+="<Scene>\n",e.IncIndent();const r=this.getExportedNodes();e.PushExecutionContext(this),e.EnterScope(),e.ExportedNodes(r),i.prototype.toXMLStream.call(this,t);for(const e of r)try{e.toXMLStream(t),t.string+="\n"}catch(t){console.error(t)}e.LeaveScope(),e.PopExecutionContext(),e.DecIndent(),t.string+=e.Indent(),t.string+="</Scene>\n",e.DecIndent(),t.string+="</X3D>\n"}});for(const t of Reflect.ownKeys(w.prototype))Object.defineProperty(w.prototype,t,{enumerable:!1});return w})),define("x_ite/Execution/Scene",["x_ite/Fields","x_ite/Execution/X3DScene"],(function(t,e){"use strict";const i=Symbol.for("X3DEventObject.browser"),n=Symbol();function r(r){this[i]=r,e.call(this,this),this.addChildObjects("initLoadCount",new t.SFInt32,"loadCount",new t.SFInt32),this[n]=new Set}r.prototype=Object.assign(Object.create(e.prototype),{constructor:r,setExecutionContext:function(t){if(!this.isMainScene()){const t=this.getScene();for(const e of this[n])t.removeLoadCount(e)}if(e.prototype.setExecutionContext.call(this,t),!this.isMainScene()){const t=this.getScene();for(const e of this[n])t.addLoadCount(e)}},addInitLoadCount:function(t){this._initLoadCount=this._initLoadCount.getValue()+1},removeInitLoadCount:function(t){this._initLoadCount=this._initLoadCount.getValue()-1},addLoadCount:function(t){if(this[n].has(t))return;this[n].add(t),this._loadCount=this[n].size;const e=this.getBrowser(),i=this.getScene();this!==e.getExecutionContext()&&this.loader!==e.loader||e.addLoadCount(t),this.isMainScene()||i.addLoadCount(t)},removeLoadCount:function(t){if(!this[n].has(t))return;this[n].delete(t),this._loadCount=this[n].size;const e=this.getBrowser(),i=this.getScene();this!==e.getExecutionContext()&&this.loader!==e.loader||e.removeLoadCount(t),this.isMainScene()||i.removeLoadCount(t)},getLoadingObjects:function(){return this[n]}});for(const t of Reflect.ownKeys(r.prototype))Object.defineProperty(r.prototype,t,{enumerable:!1});return r})),define("x_ite/Parser/X3DParser",[],(function(){"use strict";function t(t){this.scene=t,this.executionContexts=[t],this.prototypes=[],this.units=!0}return t.prototype={constructor:t,getScene:function(){return this.scene},getBrowser:function(){return this.scene.getBrowser()},getExecutionContext:function(){return this.executionContexts.at(-1)},pushExecutionContext:function(t){return this.executionContexts.push(t)},popExecutionContext:function(){this.executionContexts.pop()},getPrototype:function(){return this.prototypes.at(-1)},pushPrototype:function(t){return this.prototypes.push(t)},popPrototype:function(){this.prototypes.pop()},isInsideProtoDefinition:function(){return Boolean(this.prototypes.length)},addRootNode:function(t){this.getExecutionContext().rootNodes.push(t)},getProviderUrls:function(){const t=/\.js$/;return function(){const e=this.getScene(),i=(e.getProfile()?e.getProfile():e.getBrowser().getProfile("Full")).components,n=e.getComponents(),r=new Set;for(const e of i){const i=e.providerUrl;i.match(t)&&r.add(i)}for(const e of n){const i=e.providerUrl;i.match(t)&&r.add(i)}if("function"==typeof __global_require__&&"string"==typeof __filename)for(const t of r)__global_require__(__global_require__("url").fileURLToPath(t));return Array.from(r)}}(),setUnits:function(t){if("boolean"==typeof arguments[0])return void(this.units=arguments[0]);const e=/Titania\s+V(\d+).*/,i=t.match(e);if(i){if(parseInt(i[1])<4)return void(this.units=!1)}this.units=!0},getUnits:function(){return this.units},fromUnit:function(t,e){return this.units?this.scene.fromUnit(t,e):e}},t})),define("x_ite/Components/Networking/X3DUrlObject",["x_ite/Fields","x_ite/Base/X3DConstants"],(function(t,e){"use strict";const i=Symbol(),n=Symbol(),r=Symbol(),s=Symbol();function o(r){this.addType(e.X3DUrlObject),this.addChildObjects("loadState",new t.SFInt32(e.NOT_STARTED_STATE),"loadNow",new t.SFTime),this[i]=!0,this[n]=performance.now()}return o.prototype={constructor:o,initialize:function(){this.isLive().addInterest("set_live__",this),this._load.addInterest("set_load__",this),this._url.addInterest("set_url__",this),this._loadNow.addInterest("loadNow",this),this._autoRefresh.addInterest("set_autoRefresh__",this),this._autoRefreshTimeLimit.addInterest("set_autoRefresh__",this)},setLoadState:function(t,i=!0){if(this._loadState=t,t===e.COMPLETE_STATE&&(this[r]=performance.now(),this.setAutoRefreshTimer(this._autoRefresh.getValue())),i)switch(t){case e.NOT_STARTED_STATE:break;case e.IN_PROGRESS_STATE:this.getScene().addLoadCount(this);break;case e.COMPLETE_STATE:case e.FAILED_STATE:this.getScene().removeLoadCount(this)}},checkLoadState:function(){return this._loadState.getValue()},getLoadState:function(){return this._loadState},setCache:function(t){this[i]=t},getCache:function(){return this[i]},requestImmediateLoad:function(t=!0){this.checkLoadState()!==e.COMPLETE_STATE&&this.checkLoadState()!==e.IN_PROGRESS_STATE&&this._load.getValue()&&0!==this._url.length&&(this.setCache(t),this.setLoadState(e.IN_PROGRESS_STATE),this._loadNow=this.getBrowser().getCurrentTime())},loadNow:function(){},requestUnload:function(){this.checkLoadState()!==e.NOT_STARTED_STATE&&this.checkLoadState()!==e.FAILED_STATE&&(this.setLoadState(e.NOT_STARTED_STATE),this.unloadNow())},unloadNow:function(){},setAutoRefreshTimer:function(t){if(clearTimeout(this[s]),this._autoRefresh.getValue()<=0)return;const e=this._autoRefreshTimeLimit.getValue();0!==e&&(performance.now()-this[n])/1e3>e-t||(this[s]=setTimeout(this.performAutoRefresh.bind(this),1e3*t))},performAutoRefresh:function(){this.setLoadState(e.NOT_STARTED_STATE),this.requestImmediateLoad(!1)},set_live__:function(){this.isLive().getValue()?this.set_autoRefresh__():clearTimeout(this[s])},set_load__:function(){this._load.getValue()?this.requestImmediateLoad():this.requestUnload()},set_url__:function(){this._load.getValue()&&(this.setLoadState(e.NOT_STARTED_STATE),this.requestImmediateLoad())},set_autoRefresh__:function(){if(this.checkLoadState()!==e.COMPLETE_STATE)return;const t=(performance.now()-this[r])/1e3,i=this._autoRefresh.getValue();let n=i-t;n<0&&(n=Math.ceil(t/i)*i-t),this.setAutoRefreshTimer(n)}},o})),define("x_ite/Components/Core/X3DPrototypeInstance",["x_ite/Base/X3DChildObject","x_ite/Components/Core/X3DNode","x_ite/Execution/X3DExecutionContext","x_ite/Base/X3DConstants","x_ite/InputOutput/Generator"],(function(t,e,i,n,r){"use strict";const s=Symbol(),o=Symbol(),a=Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions"),u=Symbol();function l(t,i){this[s]=i,this[o]=new Map(i.getFields().map((t=>[t,t.getName()]))),this[a]=i.getFieldDefinitions(),this[u]=null,e.call(this,t),this.addType(n.X3DPrototypeInstance)}return l.prototype=Object.assign(Object.create(e.prototype),{constructor:l,create:function(t){return new l(t,this[s])},getTypeName:function(){return this[s].getName()},getComponentName:function(){return"Core"},getContainerField:function(){return"children"},initialize:function(){e.prototype.initialize.call(this),this.setProtoNode(this[s])},construct:function(){this[u]&&this[u].dispose();const e=this[s].getProtoDeclaration();if(!e)return this[u]=new i(this.getExecutionContext()),this[u].setOuterNode(this),this[u].setup(),void(this.isInitialized()&&t.prototype.addEvent.call(this));if(this[s].isExternProto)for(const t of e.getUserDefinedFields())try{const e=this.getField(t.getName());if(e.getAccessType()!==t.getAccessType())continue;if(e.getType()!==t.getType())continue;if(!e.isInitializable())continue;if(e.getModificationTime())continue;if(e.hasReferences())continue;if(e.equals(t))continue;e.assign(t)}catch(i){this.addField(e.getFieldDefinitions().get(t.getName()))}this[u]=new i(e.getExecutionContext()),this[u].setOuterNode(this),this.importExternProtos(e.getBody().externprotos),this.importProtos(e.getBody().protos),this.copyRootNodes(e.getBody().rootNodes),this.copyImportedNodes(e.getBody(),e.getBody().getImportedNodes()),this.copyRoutes(e.getBody(),e.getBody().routes),this[u].setup(),this.isInitialized()&&t.prototype.addEvent.call(this),this[s]._updateInstances.removeInterest("construct",this),this[s]._updateInstances.addInterest("update",this)},update:function(){const t=this[o],e=new Map(this.getFields().map((t=>[t.getName(),t])));for(const t of e.values())this.removeField(t.getName());this[o]=new Map(this[s].getFields().map((t=>[t,t.getName()])));for(const t of this.getFieldDefinitions())this.addField(t);for(const i of this[o].keys()){const n=t.get(i);if(!n)continue;const r=this.getFields().get(i.getName()),s=e.get(n);s.addParent(this),s.setAccessType(r.getAccessType()),s.setName(r.getName()),this.getPredefinedFields().update(r.getName(),r.getName(),s),this.getFields().update(r.getName(),r.getName(),s),this.getPrivate()||s.addCloneCount(1),e.delete(n),r.dispose()}for(const t of e.values())t.dispose();this.construct()},getExtendedEventHandling:function(){return!1},getProtoNode:function(){return this[s]},setProtoNode:function(t){if(t!==this[s]){if(this[s]){const t=this[s];t._name_changed.removeFieldInterest(this._typeName_changed),t._updateInstances.removeInterest("construct",this),t._updateInstances.removeInterest("update",this)}this[o]=new Map(t.getFields().map((t=>[t,t.getName()]))),this[a]=t.getFieldDefinitions()}this[s]=t,t._name_changed.addFieldInterest(this._typeName_changed);const e=require("x_ite/Prototype/X3DProtoDeclaration");this.getExecutionContext().getOuterNode()instanceof e||(t.isExternProto?this[s].checkLoadState()===n.COMPLETE_STATE?this.construct():(t._updateInstances.addInterest("construct",this),t.requestImmediateLoad()):this.construct())},getBody:function(){return this[u]},getInnerNode:function(){const t=this[u].getRootNodes().getValue();if(t.length){const e=t[0];if(e)return e.getValue().getInnerNode()}throw new Error("Root node not available.")},importExternProtos:function(t){const e=this[u].externprotos;for(const i of t)e.add(i.getName(),i)},importProtos:function(t){const e=this[u].protos;for(const i of t)e.add(i.getName(),i)},copyRootNodes:function(t){const e=this[u].getRootNodes();for(const i of t)e.push(i.copy(this))},copyImportedNodes:function(t,e){for(const t of e)try{const e=this[u].getNamedNode(t.getInlineNode().getName()),i=t.getImportedName(),n=t.getExportedName();this[u].addImportedNode(e,n,i)}catch(t){console.error("Bad IMPORT specification in copy: ",t)}},copyRoutes:function(t,e){for(const i of e)try{const e=this[u].getLocalNode(t.getLocalName(i.sourceNode)),n=this[u].getLocalNode(t.getLocalName(i.destinationNode));this[u].addRoute(e,i.sourceField,n,i.destinationField)}catch(t){console.error(t)}},toXMLStream:function(t){const e=r.Get(t),i=e.IsSharedNode(this);e.EnterScope();const s=e.Name(this);if(s.length&&e.ExistsNode(this)){t.string+=e.Indent(),t.string+="<ProtoInstance",t.string+=" ",t.string+="name='",t.string+=e.XMLEncode(this.getTypeName()),t.string+="'",t.string+=" ",t.string+="USE='",t.string+=e.XMLEncode(s),t.string+="'";const i=e.ContainerField();return i&&i.getName()!==this.getContainerField()&&(t.string+=" ",t.string+="containerField='",t.string+=e.XMLEncode(i.getName()),t.string+="'"),t.string+="/>",void e.LeaveScope()}t.string+=e.Indent(),t.string+="<ProtoInstance",t.string+=" ",t.string+="name='",t.string+=e.XMLEncode(this.getTypeName()),t.string+="'",s.length&&(e.AddNode(this),t.string+=" ",t.string+="DEF='",t.string+=e.XMLEncode(s),t.string+="'");const o=e.ContainerField();o&&o.getName()!==this.getContainerField()&&(t.string+=" ",t.string+="containerField='",t.string+=e.XMLEncode(o.getName()),t.string+="'");const a=this.getChangedFields();if(0===a.length)t.string+="/>";else{t.string+=">\n",e.IncIndent();const r=[];for(const s of a){let o=!1;if(e.ExecutionContext()&&s.getAccessType()===n.inputOutput&&0!==s.getReferences().size){let t=!1;s.getReferences().forEach((function(e){t=t||e.isInitializable()})),t||(o=!this.isDefaultValue(s))}if(0===s.getReferences().size||!e.ExecutionContext()||i||o)switch(o&&r.push(s),s.getType()){case n.MFNode:t.string+=e.Indent(),t.string+="<fieldValue",t.string+=" ",t.string+="name='",t.string+=e.XMLEncode(s.getName()),t.string+="'",0===s.length?t.string+="/>\n":(e.PushContainerField(s),t.string+=">\n",e.IncIndent(),s.toXMLStream(t),t.string+="\n",e.DecIndent(),t.string+=e.Indent(),t.string+="</fieldValue>\n",e.PopContainerField());break;case n.SFNode:if(null!==s.getValue()){e.PushContainerField(s),t.string+=e.Indent(),t.string+="<fieldValue",t.string+=" ",t.string+="name='",t.string+=e.XMLEncode(s.getName()),t.string+="'",t.string+=">\n",e.IncIndent(),s.toXMLStream(t),t.string+="\n",e.DecIndent(),t.string+=e.Indent(),t.string+="</fieldValue>\n",e.PopContainerField();break}default:t.string+=e.Indent(),t.string+="<fieldValue",t.string+=" ",t.string+="name='",t.string+=e.XMLEncode(s.getName()),t.string+="'",t.string+=" ",t.string+="value='",s.toXMLStream(t),t.string+="'",t.string+="/>\n"}else r.push(s)}if(r.length&&!i){t.string+=e.Indent(),t.string+="<IS>",t.string+="\n",e.IncIndent();for(const i of r){i.getReferences().forEach((function(n){t.string+=e.Indent(),t.string+="<connect",t.string+=" ",t.string+="nodeField='",t.string+=e.XMLEncode(i.getName()),t.string+="'",t.string+=" ",t.string+="protoField='",t.string+=e.XMLEncode(n.getName()),t.string+="'",t.string+="/>\n"}))}e.DecIndent(),t.string+=e.Indent(),t.string+="</IS>\n"}e.DecIndent(),t.string+=e.Indent(),t.string+="</ProtoInstance>"}e.LeaveScope()},dispose:function(){this[s]._updateInstances.removeInterest("construct",this),this[s]._updateInstances.removeInterest("update",this),this[u]&&this[u].dispose(),e.prototype.dispose.call(this)}}),l})),define("x_ite/Prototype/X3DProtoDeclarationNode",["x_ite/Configuration/SupportedNodes","x_ite/Fields","x_ite/Base/X3DBaseNode","x_ite/Components/Core/X3DPrototypeInstance","x_ite/Fields/SFNodeCache","x_ite/Base/X3DConstants"],(function(t,e,i,n,r,s){"use strict";function o(t){i.call(this,t),this.addType(s.X3DProtoDeclarationNode),this.addChildObjects("updateInstances",new e.SFTime)}t.addAbstractType("X3DProtoDeclarationNode",o),o.prototype=Object.assign(Object.create(i.prototype),{constructor:o,canUserDefinedFields:function(){return!0},createInstance:function(t,e=!0){if(!1===e)return new n(t,this);{const e=new n(t,this);return e.setup(),r.get(e)}},newInstance:function(){return this.createInstance(this.getExecutionContext())},requestUpdateInstances:function(){this._updateInstances=this.getBrowser().getCurrentTime()},updateInstances:function(){this._updateInstances.processEvent()}});for(const t of Reflect.ownKeys(o.prototype))Object.defineProperty(o.prototype,t,{enumerable:!1});return o})),define("x_ite/Prototype/X3DExternProtoDeclaration",["jquery","x_ite/Configuration/SupportedNodes","x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Networking/X3DUrlObject","x_ite/Prototype/X3DProtoDeclarationNode","x_ite/Base/X3DConstants","x_ite/InputOutput/Generator"],(function(t,e,i,n,r,s,o,a,u){"use strict";e.addAbstractType("X3DExternProtoDeclaration",h);const l=Symbol(),c=Symbol();function h(t,e){o.call(this,t),s.call(this,t),this.addType(a.X3DExternProtoDeclaration),this.addChildObjects("load",new i.SFBool(!0),"url",e.copy(),"autoRefresh",new i.SFTime,"autoRefreshTimeLimit",new i.SFTime(3600))}h.prototype=Object.assign(Object.create(o.prototype),s.prototype,{constructor:h,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new r([new n(a.inputOutput,"metadata",new i.SFNode)]),getTypeName:function(){return"X3DExternProtoDeclaration"},initialize:function(){o.prototype.initialize.call(this),s.prototype.initialize.call(this)},set_live__:function(){s.prototype.set_live__.call(this),this.checkLoadState()===a.COMPLETE_STATE&&this[c].setLive(this.isLive().getValue())},canUserDefinedFields:function(){return!0},setProtoDeclaration:function(t){if(this[l]=t,t){for(const t of this.getUserDefinedFields())this.removeUserDefinedField(t.getName());for(const e of t.getUserDefinedFields())this.addUserDefinedField(e.getAccessType(),e.getName(),e)}this.updateInstances()},getProtoDeclaration:function(){return this[l]},loadNow:function(){this.getScene().addInitLoadCount(this);new(require("x_ite/InputOutput/FileLoader"))(this).createX3DFromURL(this._url,null,this.setInternalSceneAsync.bind(this))},setInternalSceneAsync:function(t){t?this.setInternalScene(t):this.setError(new Error("File could not be loaded.")),this.getScene().removeInitLoadCount(this)},setInternalScene:function(t){this[c]=t;const e=decodeURIComponent(new URL(this[c].getWorldURL()).hash.substr(1)),i=e?this[c].protos.get(e):this[c].protos[0];if(!i)throw new Error("PROTO not found");this[c].setLive(this.isLive().getValue()),this[c].setPrivate(this.getScene().getPrivate()),this[c].setExecutionContext(this.getExecutionContext()),this.setLoadState(a.COMPLETE_STATE),this.setProtoDeclaration(i)},getInternalScene:function(){return this[c]},setError:function(t){console.error("Error loading extern prototype:",t),this[c]=this.getBrowser().getPrivateScene(),this.setLoadState(a.FAILED_STATE),this.setProtoDeclaration(null)},toVRMLStream:function(t){const e=u.Get(t);t.string+=e.Indent(),t.string+="EXTERNPROTO",t.string+=" ",t.string+=this.getName(),t.string+=" ",t.string+="[";const i=this.getUserDefinedFields();let n=0,r=0;if(0===i.length)t.string+=" ";else{for(const t of i)n=Math.max(n,t.getTypeName().length),r=Math.max(r,e.AccessType(t.getAccessType()).length);t.string+="\n",e.IncIndent();for(const e of i)this.toVRMLStreamUserDefinedField(t,e,n,r),t.string+="\n";e.DecIndent(),t.string+=e.Indent()}t.string+="]",t.string+="\n",t.string+=e.Indent(),this._url.toVRMLStream(t)},toVRMLStreamUserDefinedField:function(t,e,i,n){const r=u.Get(t);t.string+=r.Indent(),t.string+=r.PadRight(r.AccessType(e.getAccessType()),n),t.string+=" ",t.string+=r.PadRight(e.getTypeName(),i),t.string+=" ",t.string+=e.getName()},toXMLStream:function(t){const e=u.Get(t);t.string+=e.Indent(),t.string+="<ExternProtoDeclare",t.string+=" ",t.string+="name='",t.string+=e.XMLEncode(this.getName()),t.string+="'",t.string+=" ",t.string+="url='",this._url.toXMLStream(t),t.string+="'",t.string+=">\n",e.IncIndent();const i=this.getUserDefinedFields();for(const n of i)t.string+=e.Indent(),t.string+="<field",t.string+=" ",t.string+="accessType='",t.string+=e.AccessType(n.getAccessType()),t.string+="'",t.string+=" ",t.string+="type='",t.string+=n.getTypeName(),t.string+="'",t.string+=" ",t.string+="name='",t.string+=e.XMLEncode(n.getName()),t.string+="'",t.string+="/>\n";e.DecIndent(),t.string+=e.Indent(),t.string+="</ExternProtoDeclare>"}});for(const t of Reflect.ownKeys(h.prototype))Object.defineProperty(h.prototype,t,{enumerable:!1});return Object.defineProperty(h.prototype,"name",{get:function(){return this.getName()},enumerable:!0,configurable:!1}),Object.defineProperty(h.prototype,"fields",{get:function(){return this.getFieldDefinitions()},enumerable:!0,configurable:!1}),Object.defineProperty(h.prototype,"isExternProto",{get:function(){return!0},enumerable:!0,configurable:!1}),Object.defineProperty(h.prototype,"urls",{get:function(){return this._url},enumerable:!0,configurable:!1}),Object.defineProperty(h.prototype,"loadState",{get:function(){return this.checkLoadState()},enumerable:!0,configurable:!1}),h})),define("x_ite/Prototype/X3DProtoDeclaration",["x_ite/Configuration/SupportedNodes","x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Execution/X3DExecutionContext","x_ite/Prototype/X3DProtoDeclarationNode","x_ite/Base/X3DConstants","x_ite/InputOutput/Generator"],(function(t,e,i,n,r,s,o,a){"use strict";t.addAbstractType("X3DProtoDeclaration",l);const u=Symbol();function l(t){s.call(this,t),this.addType(o.X3DProtoDeclaration),this.addChildObjects("loadState",new e.SFInt32(o.NOT_STARTED_STATE)),this[u]=new r(t),this[u].setOuterNode(this),this[u].setLive(!1),this.setLive(!1)}l.prototype=Object.assign(Object.create(s.prototype),{constructor:l,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new n([new i(o.inputOutput,"metadata",new e.SFNode)]),getTypeName:function(){return"X3DProtoDeclaration"},initialize:function(){s.prototype.initialize.call(this),this[u].setup(),this._loadState=o.COMPLETE_STATE},getProtoDeclaration:function(){return this},getBody:function(){return this[u]},checkLoadState:function(){return this._loadState.getValue()},canUserDefinedFields:function(){return!0},toVRMLStream:function(t){const e=a.Get(t);t.string+=e.Indent(),t.string+="PROTO",t.string+=" ",t.string+=this.getName(),t.string+=" ",t.string+="[",e.EnterScope();const i=this.getUserDefinedFields();let n=0,r=0;if(0===i.length)t.string+=" ";else{for(const t of i)n=Math.max(n,t.getTypeName().length),r=Math.max(r,e.AccessType(t.getAccessType()).length);t.string+="\n",e.IncIndent();for(const e of i)this.toVRMLStreamUserDefinedField(t,e,n,r),t.string+="\n";e.DecIndent(),t.string+=e.Indent()}e.LeaveScope(),t.string+="]",t.string+="\n",t.string+=e.Indent(),t.string+="{",t.string+="\n",e.IncIndent(),this[u].toVRMLStream(t),e.DecIndent(),t.string+=e.Indent(),t.string+="}"},toVRMLStreamUserDefinedField:function(t,e,i,n){const r=a.Get(t);t.string+=r.Indent(),t.string+=r.PadRight(r.AccessType(e.getAccessType()),n),t.string+=" ",t.string+=r.PadRight(e.getTypeName(),i),t.string+=" ",t.string+=e.getName(),e.isInitializable()&&(t.string+=" ",e.toVRMLStream(t))},toXMLStream:function(t){const e=a.Get(t);t.string+=e.Indent(),t.string+="<ProtoDeclare",t.string+=" ",t.string+="name='",t.string+=e.XMLEncode(this.getName()),t.string+="'",t.string+=">",t.string+="\n",e.EnterScope();const i=this.getUserDefinedFields();if(0!==i.length){e.IncIndent(),t.string+=e.Indent(),t.string+="<ProtoInterface>\n",e.IncIndent();for(const n of i)if(t.string+=e.Indent(),t.string+="<field",t.string+=" ",t.string+="accessType='",t.string+=e.AccessType(n.getAccessType()),t.string+="'",t.string+=" ",t.string+="type='",t.string+=n.getTypeName(),t.string+="'",t.string+=" ",t.string+="name='",t.string+=e.XMLEncode(n.getName()),t.string+="'",n.isDefaultValue())t.string+="/>\n";else switch(n.getType()){case o.SFNode:case o.MFNode:e.PushContainerField(n),t.string+=">\n",e.IncIndent(),n.toXMLStream(t),t.string+="\n",e.DecIndent(),t.string+=e.Indent(),t.string+="</field>\n",e.PopContainerField();break;default:t.string+=" ",t.string+="value='",n.toXMLStream(t),t.string+="'",t.string+="/>\n"}e.DecIndent(),t.string+=e.Indent(),t.string+="</ProtoInterface>\n",e.DecIndent()}e.LeaveScope(),e.IncIndent(),t.string+=e.Indent(),t.string+="<ProtoBody>\n",e.IncIndent(),this[u].toXMLStream(t),e.DecIndent(),t.string+=e.Indent(),t.string+="</ProtoBody>\n",e.DecIndent(),t.string+=e.Indent(),t.string+="</ProtoDeclare>"}});for(const t of Reflect.ownKeys(l.prototype))Object.defineProperty(l.prototype,t,{enumerable:!1});return Object.defineProperty(l.prototype,"name",{get:function(){return this.getName()},enumerable:!0,configurable:!1}),Object.defineProperty(l.prototype,"fields",{get:function(){return this.getFieldDefinitions()},enumerable:!0,configurable:!1}),Object.defineProperty(l.prototype,"isExternProto",{get:function(){return!1},enumerable:!0,configurable:!1}),l})),define("x_ite/Parser/VRMLParser",["x_ite/Fields","x_ite/Parser/X3DParser","x_ite/Prototype/X3DExternProtoDeclaration","x_ite/Prototype/X3DProtoDeclaration","x_ite/Base/X3DConstants"],(function(t,e,i,n,r){"use strict";var s={Whitespaces:new RegExp("([\\x20\\n,\\t\\r]+)","gy"),Comment:new RegExp("#(.*?)(?=[\\n\\r])","gy"),Header:new RegExp("^#(VRML|X3D) V(.*?) (utf8)(?:[ \\t]+(.*?))?[ \\t]*[\\n\\r]","gy"),AS:new RegExp("AS","gy"),COMPONENT:new RegExp("COMPONENT","gy"),DEF:new RegExp("DEF","gy"),EXPORT:new RegExp("EXPORT","gy"),EXTERNPROTO:new RegExp("EXTERNPROTO","gy"),FALSE:new RegExp("FALSE|false","gy"),IMPORT:new RegExp("IMPORT","gy"),IS:new RegExp("IS","gy"),META:new RegExp("META","gy"),NULL:new RegExp("NULL","gy"),TRUE:new RegExp("TRUE|true","gy"),PROFILE:new RegExp("PROFILE","gy"),PROTO:new RegExp("PROTO","gy"),ROUTE:new RegExp("ROUTE","gy"),TO:new RegExp("TO","gy"),UNIT:new RegExp("UNIT","gy"),USE:new RegExp("USE","gy"),OpenBrace:new RegExp("\\{","gy"),CloseBrace:new RegExp("\\}","gy"),OpenBracket:new RegExp("\\[","gy"),CloseBracket:new RegExp("\\]","gy"),Period:new RegExp("\\.","gy"),Colon:new RegExp("\\:","gy"),Id:new RegExp("([^\\x30-\\x39\\x00-\\x20\\x22\\x23\\x27\\x2b\\x2c\\x2d\\x2e\\x5b\\x5c\\x5d\\x7b\\x7d\\x7f]{1}[^\\x00-\\x20\\x22\\x23\\x27\\x2c\\x2e\\x5b\\x5c\\x5d\\x7b\\x7d\\x7f]*)","gy"),ComponentNameId:new RegExp("([^\\x30-\\x39\\x00-\\x20\\x22\\x23\\x27\\x2b\\x2c\\x2d\\x2e\\x5b\\x5c\\x5d\\x7b\\x7d\\x7f\\x3a]{1}[^\\x00-\\x20\\x22\\x23\\x27\\x2c\\x2e\\x5b\\x5c\\x5d\\x7b\\x7d\\x7f\\x3a]*)","gy"),initializeOnly:new RegExp("initializeOnly","gy"),inputOnly:new RegExp("inputOnly","gy"),outputOnly:new RegExp("outputOnly","gy"),inputOutput:new RegExp("inputOutput","gy"),field:new RegExp("field","gy"),eventIn:new RegExp("eventIn","gy"),eventOut:new RegExp("eventOut","gy"),exposedField:new RegExp("exposedField","gy"),FieldType:new RegExp("(MFBool|MFColorRGBA|MFColor|MFDouble|MFFloat|MFImage|MFInt32|MFMatrix3d|MFMatrix3f|MFMatrix4d|MFMatrix4f|MFNode|MFRotation|MFString|MFTime|MFVec2d|MFVec2f|MFVec3d|MFVec3f|MFVec4d|MFVec4f|SFBool|SFColorRGBA|SFColor|SFDouble|SFFloat|SFImage|SFInt32|SFMatrix3d|SFMatrix3f|SFMatrix4d|SFMatrix4f|SFNode|SFRotation|SFString|SFTime|SFVec2d|SFVec2f|SFVec3d|SFVec3f|SFVec4d|SFVec4f)","gy"),int32:new RegExp("((?:0[xX][\\da-fA-F]+)|(?:[+-]?\\d+))","gy"),double:new RegExp("([+-]?(?:(?:(?:\\d*\\.\\d+)|(?:\\d+(?:\\.)?))(?:[eE][+-]?\\d+)?))","gy"),string:new RegExp('"((?:[^\\\\"]|\\\\\\\\|\\\\\\")*)"',"gy"),Inf:new RegExp("[+]?(?:inf|Infinity)","gy"),NegativeInf:new RegExp("-(?:inf|Infinity)","gy"),NaN:new RegExp("[+-]?(nan|NaN)","gy"),Break:new RegExp("\\r?\\n","g")};function o(t){return this.lastIndex=t.lastIndex,t.result=this.exec(t.input),!!t.result&&(t.lastIndex=this.lastIndex,!0)}for(var a in s)s[a].parse=o;function u(t){e.call(this,t)}return u.prototype=Object.assign(Object.create(e.prototype),{constructor:u,accessTypes:{field:r.initializeOnly,eventIn:r.inputOnly,eventOut:r.outputOnly,exposedField:r.inputOutput,initializeOnly:r.initializeOnly,inputOnly:r.inputOnly,outputOnly:r.outputOnly,inputOutput:r.inputOutput},SFBool:new t.SFBool,SFColor:new t.SFColor,SFColorRGBA:new t.SFColorRGBA,SFDouble:new t.SFDouble,SFFloat:new t.SFFloat,SFImage:new t.SFImage,SFInt32:new t.SFInt32,SFMatrix3f:new t.SFMatrix3f,SFMatrix3d:new t.SFMatrix3d,SFMatrix4f:new t.SFMatrix4f,SFMatrix4d:new t.SFMatrix4d,SFNode:new t.SFNode,SFRotation:new t.SFRotation,SFString:new t.SFString,SFTime:new t.SFTime,SFVec2d:new t.SFVec2d,SFVec2f:new t.SFVec2f,SFVec3d:new t.SFVec3d,SFVec3f:new t.SFVec3f,SFVec4d:new t.SFVec4d,SFVec4f:new t.SFVec4f,MFBool:new t.MFBool,MFColor:new t.MFColor,MFColorRGBA:new t.MFColorRGBA,MFDouble:new t.MFDouble,MFFloat:new t.MFFloat,MFImage:new t.MFImage,MFInt32:new t.MFInt32,MFMatrix3d:new t.MFMatrix3d,MFMatrix3f:new t.MFMatrix3f,MFMatrix4d:new t.MFMatrix4d,MFMatrix4f:new t.MFMatrix4f,MFNode:new t.MFNode,MFRotation:new t.MFRotation,MFString:new t.MFString,MFTime:new t.MFTime,MFVec2d:new t.MFVec2d,MFVec2f:new t.MFVec2f,MFVec3d:new t.MFVec3d,MFVec3f:new t.MFVec3f,MFVec4d:new t.MFVec4d,MFVec4f:new t.MFVec4f,isValid:function(){return!!this.input.match(/^(?:#X3D|#VRML|(?:[\x20\n,\t\r]*|#.*?[\r\n])*(PROFILE|COMPONENT|META|UNIT|EXTERNPROTO|PROTO|DEF|NULL|IMPORT|EXPORT|ROUTE|\w+(?:[\x20\n,\t\r]*|#.*?[\r\n])\{|$))/)},getInput:function(){return this.input},setInput:function(t){this.input=t,this.lineNumber=1,this.lastIndex=0},parseIntoScene:function(t,e){try{this.success=t,this.error=e,this.getScene().setEncoding("VRML"),this.getScene().setProfile(this.getBrowser().getProfile("Full")),this.x3dScene()}catch(e){throw new Error(this.getError(e))}},exception:function(t){if(this.getBrowser().isStrict())throw new Error(t);console.warn(t)},getError:function(t){var e=t.message,i=this.getLine(),n=this.getLastLine(),r=this.getLastLine(),s=n.length-i.length+1;return n.length>80&&(n=n.substr(s-40,80),r="",s=40),"\n********************************************************************************\nParser error at line "+this.lineNumber+":"+s+"\nin '"+this.getScene().getWorldURL()+"'\n\n"+r+"\n"+n+"\n"+Array(s).join(" ")+"^\n"+e+"\n********************************************************************************\n"},getLine:function(){for(var t=this.input,e=this.lastIndex,i="";e<t.length&&"\n"!==t[e]&&"\r"!==t[e];)i+=t[e++];return this.lastIndex=e,i},getLastLine:function(){var t=this.input,e=this.lastIndex,i="";for(e<t.length&&("\n"!==t[e]||"\r"!==t[e])&&--e;e>=0&&"\n"!==t[e]&&"\r"!==t[e];)i=t[e--]+i;return this.lastIndex=e,i},comments:function(){for(;this.comment(););},comment:function(){return!!this.whitespaces()||s.Comment.parse(this)},whitespaces:function(){return!!s.Whitespaces.parse(this)&&(this.xml||this.lines(this.result[1]),!0)},lines:function(t){var e=t.match(s.Break);e&&(this.lineNumber+=e.length)},x3dScene:function(){this.headerStatement(),this.profileStatement(),this.componentStatements(),this.unitStatements(),this.metaStatements();try{this.setUnits(this.getScene().getMetaData("generator"))}catch(t){}if(this.success)require(this.getProviderUrls(),function(){try{if(this.statements(),this.lastIndex<this.input.length)throw new Error("Unknown statement.");this.success(this.getScene())}catch(t){this.error(new Error(this.getError(t)))}}.bind(this),function(t){this.error(t)}.bind(this));else if(this.statements(),this.lastIndex<this.input.length)throw new Error("Unknown statement.")},headerStatement:function(){s.Header.lastIndex=0;var t=s.Header.exec(this.input);return!!t&&(this.getScene().setSpecificationVersion(t[2]),this.getScene().setEncoding("VRML"),!0)},profileStatement:function(){if(this.comments(),s.PROFILE.parse(this)){if(this.profileNameId()){var t=this.getBrowser().getProfile(this.result[1]);return void this.getScene().setProfile(t)}throw new Error("Expected a profile name.")}},componentStatements:function(){for(var t=this.componentStatement();t;)this.getScene().addComponent(t),t=this.componentStatement()},componentStatement:function(){if(this.comments(),s.COMPONENT.parse(this)){if(this.componentNameId()){var t=this.result[1];if(this.comments(),s.Colon.parse(this)){if(this.componentSupportLevel()){var e=this.value;return this.getBrowser().getComponent(t,e)}throw new Error("Expected a component support level.")}throw new Error("Expected a ':' after component name.")}throw new Error("Expected a component name.")}return null},componentSupportLevel:function(){return this.int32()},unitStatements:function(){for(;this.unitStatement(););},unitStatement:function(){if(this.comments(),s.UNIT.parse(this)){if(this.categoryNameId()){var t=this.result[1];if(this.unitNameId()){var e=this.result[1];if(this.unitConversionFactor()){var i=this.value;try{return this.getScene().updateUnit(t,e,i),!0}catch(t){return console.log(t.message),!0}}throw new Error("Expected unit conversion factor.")}throw new Error("Expected unit name identifier.")}throw new Error("Expected category name identifier after UNIT statement.")}return!1},unitConversionFactor:function(){return this.double()},metaStatements:function(){for(;this.metaStatement(););},metaStatement:function(){if(this.comments(),s.META.parse(this)){if(this.metakey()){var t=this.value;if(this.metavalue()){var e=this.value;return this.getScene().setMetaData(t,e),!0}throw new Error("Expected metadata value.")}throw new Error("Expected metadata key.")}return!1},metakey:function(){return this.string()},metavalue:function(){return this.string()},exportStatement:function(){if(this.comments(),s.EXPORT.parse(this)){if(this.nodeNameId()){var t=this.result[1],e="";this.comments();var i=this.getScene().getLocalNode(t);if(s.AS.parse(this)){if(!this.exportedNodeNameId())throw new Error("No name given after AS.");e=this.result[1]}else e=t;if(this.getScene()===this.getExecutionContext())return this.getScene().updateExportedNode(e,i),!0;throw new Error("Export statement not allowed here.")}throw new Error("No name given after EXPORT.")}return!1},importStatement:function(){if(this.comments(),s.IMPORT.parse(this)){if(this.nodeNameId()){var t=this.result[1],e=this.getExecutionContext().getNamedNode(t);if(this.comments(),s.Period.parse(this)){if(this.exportedNodeNameId()){var i=this.result[1],n=i;if(this.comments(),s.AS.parse(this)){if(!this.nodeNameId())throw new Error("No name given after AS.");n=this.result[1]}return this.getExecutionContext().updateImportedNode(e,i,n),!0}throw new Error("Expected exported node name.")}throw new Error("Expected a '.' after exported node name.")}throw new Error("No name given after IMPORT statement.")}return!1},statements:function(){for(;this.statement(););},statement:function(){if(this.protoStatement())return!0;if(this.routeStatement())return!0;if(this.importStatement())return!0;if(this.exportStatement())return!0;var t=this.nodeStatement();return!1!==t&&(this.addRootNode(t),!0)},nodeStatement:function(){if(this.comments(),s.DEF.parse(this)){if(this.nodeNameId())return this.node(this.result[1]);throw new Error("No name given after DEF.")}if(s.USE.parse(this)){if(this.nodeNameId())return this.getExecutionContext().getNamedNode(this.result[1]).getValue();throw new Error("No name given after USE.")}return s.NULL.parse(this)?null:this.node("")},protoStatement:function(){return!!this.proto()||!!this.externproto()},protoStatements:function(){for(;this.protoStatement(););},proto:function(){if(this.comments(),s.PROTO.parse(this)){if(this.nodeTypeId()){var t=this.result[1];if(this.comments(),s.OpenBracket.parse(this)){var e=this.interfaceDeclarations();if(this.comments(),s.CloseBracket.parse(this)){if(this.comments(),s.OpenBrace.parse(this)){for(var i=new n(this.getExecutionContext()),r=0,o=e.length;r<o;++r){var a=e[r];i.addUserDefinedField(a.getAccessType(),a.getName(),a)}if(this.pushPrototype(i),this.pushExecutionContext(i.getBody()),this.protoBody(),this.popExecutionContext(),this.popPrototype(),this.comments(),s.CloseBrace.parse(this)){i.setup();try{const e=this.getExecutionContext().getProtoDeclaration(t);this.getExecutionContext().updateProtoDeclaration(this.getExecutionContext().getUniqueProtoName(t),e)}catch(t){}return this.getExecutionContext().updateProtoDeclaration(t,i),!0}throw new Error("Expected a '}' at the end of PROTO body.")}throw new Error("Expected a '{' at the beginning of PROTO body.")}throw new Error("Expected a ']' at the end of PROTO interface declaration.")}throw new Error("Expected a '[' at the beginning of PROTO interface declaration.")}throw new Error("Invalid PROTO definition name.")}return!1},protoBody:function(){this.protoStatements();var t=this.rootNodeStatement();!1!==t&&this.addRootNode(t),this.statements()},rootNodeStatement:function(){if(this.comments(),s.DEF.parse(this)){if(this.nodeNameId()){var t=this.result[0];if(!1!==(e=this.node(t)))return e;throw new Error("Expected node type name after DEF.")}throw new Error("No name given after DEF.")}var e;return!1!==(e=this.node(""))&&e},interfaceDeclarations:function(){for(var t=[],e=this.interfaceDeclaration();e;)t.push(e),e=this.interfaceDeclaration();return t},restrictedInterfaceDeclaration:function(){if(this.comments(),s.inputOnly.parse(this)||s.eventIn.parse(this)){if(this.fieldType()){var t=this.result[1];if(this.inputOnlyId()){var e=this.result[1];return(i=this[t].create()).setAccessType(r.inputOnly),i.setName(e),i}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}if(s.outputOnly.parse(this)||s.eventOut.parse(this)){if(this.fieldType()){t=this.result[1];if(this.outputOnlyId()){e=this.result[1];return(i=this[t].create()).setAccessType(r.outputOnly),i.setName(e),i}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}if(s.initializeOnly.parse(this)||s.field.parse(this)){if(this.fieldType()){t=this.result[1];if(this.initializeOnlyId()){e=this.result[1];var i=this[t].create();if(this.fieldValue(i))return i.setAccessType(r.initializeOnly),i.setName(e),i;throw new Error("Couldn't read value for field '"+e+"'.")}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}return null},interfaceDeclaration:function(){if(i=this.restrictedInterfaceDeclaration())return i;if(this.comments(),s.inputOutput.parse(this)||s.exposedField.parse(this)){if(this.fieldType()){var t=this.result[1];if(this.inputOutputId()){var e=this.result[1],i=this[t].create();if(this.fieldValue(i))return i.setAccessType(r.inputOutput),i.setName(e),i;throw new Error("Couldn't read value for field '"+e+"'.")}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}return null},externproto:function(){if(this.comments(),s.EXTERNPROTO.parse(this)){if(this.nodeTypeId()){var t=this.result[1];if(this.comments(),s.OpenBracket.parse(this)){var e=this.externInterfaceDeclarations();if(this.comments(),s.CloseBracket.parse(this)){if(this.URLList(this.MFString)){for(var n=new i(this.getExecutionContext(),this.MFString),r=0,o=e.length;r<o;++r){var a=e[r];n.addUserDefinedField(a.getAccessType(),a.getName(),a)}n.setup();try{const e=this.getExecutionContext().getExternProtoDeclaration(t);this.getExecutionContext().updateExternProtoDeclaration(this.getExecutionContext().getUniqueExternProtoName(t),e)}catch(t){}return this.getExecutionContext().updateExternProtoDeclaration(t,n),!0}throw new Error("Expected a URL list after EXTERNPROTO interface declaration '"+t+"'.")}throw new Error("Expected a ']' at the end of EXTERNPROTO interface declaration.")}throw new Error("Expected a '[' at the beginning of EXTERNPROTO interface declaration.")}throw new Error("Invalid EXTERNPROTO definition name.")}return!1},externInterfaceDeclarations:function(){for(var t=[],e=this.externInterfaceDeclaration();e;)t.push(e),e=this.externInterfaceDeclaration();return t},externInterfaceDeclaration:function(){if(this.comments(),s.inputOnly.parse(this)||s.eventIn.parse(this)){if(this.fieldType()){var t=this.result[1];if(this.inputOnlyId()){var e=this.result[1];return(i=this[t].create()).setAccessType(r.inputOnly),i.setName(e),i}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}if(s.outputOnly.parse(this)||s.eventOut.parse(this)){if(this.fieldType()){t=this.result[1];if(this.outputOnlyId()){e=this.result[1];return(i=this[t].create()).setAccessType(r.outputOnly),i.setName(e),i}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}if(s.initializeOnly.parse(this)||s.field.parse(this)){if(this.fieldType()){t=this.result[1];if(this.initializeOnlyId()){e=this.result[1];return(i=this[t].create()).setAccessType(r.initializeOnly),i.setName(e),i}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}if(s.inputOutput.parse(this)||s.exposedField.parse(this)){if(this.fieldType()){t=this.result[1];if(this.inputOutputId()){var i;e=this.result[1];return(i=this[t].create()).setAccessType(r.inputOutput),i.setName(e),i}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}return null},URLList:function(t){return this.mfstringValue(t)},routeStatement:function(){if(this.comments(),s.ROUTE.parse(this)){if(this.nodeNameId()){var t=this.result[1],e=this.getExecutionContext().getLocalNode(t);if(this.comments(),s.Period.parse(this)){if(this.outputOnlyId()){var i=this.result[1];if(this.comments(),s.TO.parse(this)){if(this.nodeNameId()){var n=this.result[1],r=this.getExecutionContext().getLocalNode(n);if(this.comments(),s.Period.parse(this)){if(this.inputOnlyId())try{var o=this.result[1];return this.getExecutionContext().addRoute(e,i,r,o),!0}catch(t){return this.exception(t.message),!0}throw new Error("Bad ROUTE specification: Expected a field name.")}throw new Error("Bad ROUTE specification: Expected a '.' after node name.")}throw new Error("Bad ROUTE specification: Expected a node name.")}throw new Error("Bad ROUTE specification: Expected a 'TO'.")}throw new Error("Bad ROUTE specification: Expected a field name.")}throw new Error("Bad ROUTE specification: Expected a '.' after node name.")}throw new Error("Bad ROUTE specification: Expected a node name.")}return!1},node:function(t){if(this.nodeTypeId()){var e=this.result[1],i=this.getExecutionContext().createNode(e,!1);if(!i&&!(i=this.getExecutionContext().createProto(e,!1)))throw new Error("Unknown node type or proto '"+e+"', you probably have insufficient component/profile statements.");if(t.length){try{var n=this.getExecutionContext().getNamedNode(t);this.getExecutionContext().updateNamedNode(this.getExecutionContext().getUniqueName(t),n)}catch(t){}this.getExecutionContext().updateNamedNode(t,i)}if(this.comments(),s.OpenBrace.parse(this)){if(i.canUserDefinedFields()?this.scriptBody(i):this.nodeBody(i),this.comments(),s.CloseBrace.parse(this))return this.isInsideProtoDefinition()||i.setup(),i;throw new Error("Expected '}' at the end of node body.")}throw new Error("Expected '{' at the beginning of node body.")}return!1},scriptBody:function(t){for(;this.scriptBodyElement(t););},scriptBodyElement:function(t){var e=this.lastIndex,i=this.lineNumber;if(this.Id()){var n=this.accessTypes[this.result[1]];if(n&&this.fieldType()){var o=this.result[1];if(this.Id()){var a=this.result[1];if(this.comments(),s.IS.parse(this)){if(this.isInsideProtoDefinition()){if(this.Id()){var u=this.result[1];try{var l=this.getPrototype().getField(u)}catch(t){return this.exception("No such event or field '"+u+"' inside PROTO "+this.getPrototype().getName()+" interface declaration."),!0}var c=this[o];if(c.getType()===l.getType()){if(l.isReference(n)){try{n===(h=t.getField(a)).getAccessType()&&l.getType()===h.getType()||(h=this.createUserDefinedField(t,n,a,c))}catch(e){var h=this.createUserDefinedField(t,n,a,c)}return h.addReference(l),!0}throw new Error("Field '"+a+"' and '"+l.getName()+"' in PROTO '"+this.getPrototype().getName()+"' are incompatible as an IS mapping.")}throw new Error("Field '"+a+"' and '"+l.getName()+"' in PROTO '"+this.getPrototype().getName()+"' have different types.")}throw new Error("No name give after IS statement.")}throw new Error("IS statement outside PROTO definition.")}}}}if(this.lastIndex=e,this.lineNumber=i,h=this.interfaceDeclaration()){try{if(h.getAccessType()===r.inputOutput){var d=t.getField(h.getName());if(d.getAccessType()===r.inputOutput&&h.getType()===d.getType())return d.setValue(h),!0}}catch(t){}return t.addUserDefinedField(h.getAccessType(),h.getName(),h),!0}return this.nodeBodyElement(t)},createUserDefinedField:function(t,e,i,n){var r=n.create();return t.addUserDefinedField(e,i,r),r},nodeBody:function(t){for(;this.nodeBodyElement(t););},nodeBodyElement:function(t){if(this.protoStatement())return!0;if(this.routeStatement())return!0;if(this.Id()){var e=this.result[1];try{var i=t.getField(e)}catch(i){throw new Error("Unknown field '"+e+"' in class '"+t.getTypeName()+"'.")}if(this.comments(),s.IS.parse(this)){if(this.isInsideProtoDefinition()){if(this.Id()){var n=this.result[1];try{var o=this.getPrototype().getField(n)}catch(t){return this.exception("No such event or field '"+n+"' inside PROTO "+this.getPrototype().getName()),!0}if(i.getType()===o.getType()){if(o.isReference(i.getAccessType()))return i.addReference(o),!0;throw new Error("Field '"+i.getName()+"' and '"+o.getName()+"' in PROTO "+this.getPrototype().getName()+" are incompatible as an IS mapping.")}throw new Error("Field '"+i.getName()+"' and '"+o.getName()+"' in PROTO "+this.getPrototype().getName()+" have different types.")}throw new Error("No name give after IS statement.")}throw new Error("IS statement outside PROTO definition.")}if(i.isInitializable()){if(this.fieldValue(i))return!0;throw new Error("Couldn't read value for field '"+e+"'.")}throw new Error("Couldn't assign value to "+function(t){switch(t){case r.inializeOnly:return"initializeOnly";case r.inputOnly:return"inputOnly";case r.outputOnly:return"outputOnly";case r.inputOutput:return"inputOutput"}}(i.getAccessType())+" field '"+e+"'.")}return!1},profileNameId:function(){return this.Id()},componentNameId:function(){return this.comments(),s.ComponentNameId.parse(this)},categoryNameId:function(){return this.Id()},unitNameId:function(){return this.Id()},exportedNodeNameId:function(){return this.Id()},nodeNameId:function(){return this.Id()},nodeTypeId:function(){return this.Id()},initializeOnlyId:function(){return this.Id()},inputOnlyId:function(){return this.Id()},outputOnlyId:function(){return this.Id()},inputOutputId:function(){return this.Id()},Id:function(){return this.comments(),s.Id.parse(this)},fieldType:function(){return this.comments(),s.FieldType.parse(this)},fieldValue:function(t){return this.fieldTypes[t.getType()].call(this,t)},double:function(){return this.comments(),s.double.parse(this)?(this.value=parseFloat(this.result[1]),!0):s.Inf.parse(this)?(this.value=Number.POSITIVE_INFINITY,!0):s.NegativeInf.parse(this)?(this.value=Number.NEGATIVE_INFINITY,!0):!!s.NaN.parse(this)&&(this.value=Number.NaN,!0)},int32:function(){return this.comments(),!!s.int32.parse(this)&&(this.value=parseInt(this.result[1]),!0)},string:function(){return this.comments(),!!s.string.parse(this)&&(this.value=t.SFString.unescape(this.result[1]),this.lines(this.value),!0)},sfboolValue:function(t){return this.comments(),s.TRUE.parse(this)?(t.setValue(!0),!0):!!s.FALSE.parse(this)&&(t.setValue(!1),!0)},mfboolValue:function(t){if(t.length=0,this.sfboolValue(this.SFBool))return t.push(this.SFBool),!0;if(s.OpenBracket.parse(this)){if(this.sfboolValues(t),this.comments(),s.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfboolValues:function(t){for(t.length=0,t=t.getTarget();this.sfboolValue(this.SFBool);)t.push(this.SFBool)},sfcolorValue:function(t){if(this.double()){var e=this.value;if(this.double()){var i=this.value;if(this.double()){var n=this.value;return t.r=e,t.g=i,t.b=n,!0}}}return!1},mfcolorValue:function(t){if(t.length=0,this.sfcolorValue(this.SFColor))return t.push(this.SFColor),!0;if(s.OpenBracket.parse(this)){if(this.sfcolorValues(t),this.comments(),s.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfcolorValues:function(t){for(t.length=0,t=t.getTarget();this.sfcolorValue(this.SFColor);)t.push(this.SFColor)},sfcolorrgbaValue:function(t){if(this.double()){var e=this.value;if(this.double()){var i=this.value;if(this.double()){var n=this.value;if(this.double()){var r=this.value;return t.r=e,t.g=i,t.b=n,t.a=r,!0}}}}return!1},mfcolorrgbaValue:function(t){if(t.length=0,this.sfcolorrgbaValue(this.SFColorRGBA))return t.push(this.SFColorRGBA),!0;if(s.OpenBracket.parse(this)){if(this.sfcolorrgbaValues(t),this.comments(),s.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfcolorrgbaValues:function(t){for(t.length=0,t=t.getTarget();this.sfcolorrgbaValue(this.SFColorRGBA);)t.push(this.SFColorRGBA)},sfdoubleValue:function(t){return!!this.double()&&(t.setValue(this.fromUnit(t.getUnit(),this.value)),!0)},mfdoubleValue:function(t){if(t.length=0,this.SFDouble.setUnit(t.getUnit()),this.sfdoubleValue(this.SFDouble))return t.push(this.SFDouble),!0;if(s.OpenBracket.parse(this)){if(this.sfdoubleValues(t),this.comments(),s.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfdoubleValues:function(t){for(t.length=0,t=t.getTarget(),this.SFDouble.setUnit(t.getUnit());this.sfdoubleValue(this.SFDouble);)t.push(this.SFDouble)},sffloatValue:function(t){return this.sfdoubleValue(t)},mffloatValue:function(t){if(t.length=0,this.SFFloat.setUnit(t.getUnit()),this.sffloatValue(this.SFFloat))return t.push(this.SFFloat),!0;if(s.OpenBracket.parse(this)){if(this.sffloatValues(t),this.comments(),s.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sffloatValues:function(t){for(t.length=0,t=t.getTarget(),this.SFFloat.setUnit(t.getUnit());this.sffloatValue(this.SFFloat);)t.push(this.SFFloat)},sfimageValue:function(t){if(this.int32()){var e=this.value;if(this.int32()){var i=this.value;if(this.int32()){var n=this.value,r=e*i;t.width=e,t.height=i,t.comp=n;for(var s=t.array,o=0;o<r;++o){if(!this.int32())return!1;s[o]=this.value}return!0}}}return!1},mfimageValue:function(t){if(t.length=0,this.sfimageValue(this.SFImage))return t.push(this.SFImage),!0;if(s.OpenBracket.parse(this)){if(this.sfimageValues(t),this.comments(),s.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfimageValues:function(t){for(t.length=0,t=t.getTarget();this.sfimageValue(this.SFImage);)t.push(this.SFImage)},sfint32Value:function(t){return!!this.int32()&&(t.setValue(this.value),!0)},mfint32Value:function(t){if(t.length=0,this.sfint32Value(this.SFInt32))return t.push(this.SFInt32),!0;if(s.OpenBracket.parse(this)){if(this.sfint32Values(t),this.comments(),s.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfint32Values:function(t){for(t.length=0,t=t.getTarget();this.sfint32Value(this.SFInt32);)t.push(this.SFInt32)},sfmatrix3dValue:function(t){if(this.double()){var e=this.value;if(this.double()){var i=this.value;if(this.double()){var n=this.value;if(this.double()){var r=this.value;if(this.double()){var s=this.value;if(this.double()){var o=this.value;if(this.double()){var a=this.value;if(this.double()){var u=this.value;if(this.double()){var l=this.value;return t[0]=e,t[1]=i,t[2]=n,t[3]=r,t[4]=s,t[5]=o,t[6]=a,t[7]=u,t[8]=l,!0}}}}}}}}}return!1},mfmatrix3dValue:function(t){if(t.length=0,this.sfmatrix3dValue(this.SFMatrix3d))return t.push(this.SFMatrix3d),!0;if(s.OpenBracket.parse(this)){if(this.sfmatrix3dValues(t),this.comments(),s.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfmatrix3dValues:function(t){for(t.length=0,t=t.getTarget();this.sfmatrix3dValue(this.SFMatrix3d);)t.push(this.SFMatrix3d)},sfmatrix3fValue:function(t){return this.sfmatrix3dValue(t)},mfmatrix3fValue:function(t){if(t.length=0,this.sfmatrix3fValue(this.SFMatrix3f))return t.push(this.SFMatrix3f),!0;if(s.OpenBracket.parse(this)){if(this.sfmatrix3fValues(t),this.comments(),s.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfmatrix3fValues:function(t){for(t.length=0,t=t.getTarget();this.sfmatrix3fValue(this.SFMatrix3f);)t.push(this.SFMatrix3f)},sfmatrix4dValue:function(t){if(this.double()){var e=this.value;if(this.double()){var i=this.value;if(this.double()){var n=this.value;if(this.double()){var r=this.value;if(this.double()){var s=this.value;if(this.double()){var o=this.value;if(this.double()){var a=this.value;if(this.double()){var u=this.value;if(this.double()){var l=this.value;if(this.double()){var c=this.value;if(this.double()){var h=this.value;if(this.double()){var d=this.value;if(this.double()){var p=this.value;if(this.double()){var f=this.value;if(this.double()){var g=this.value;if(this.double()){var m=this.value;return t[0]=e,t[1]=i,t[2]=n,t[3]=r,t[4]=s,t[5]=o,t[6]=a,t[7]=u,t[8]=l,t[9]=c,t[10]=h,t[11]=d,t[12]=p,t[13]=f,t[14]=g,t[15]=m,!0}}}}}}}}}}}}}}}}return!1},mfmatrix4dValue:function(t){if(t.length=0,this.sfmatrix4dValue(this.SFMatrix4d))return t.push(this.SFMatrix4d),!0;if(s.OpenBracket.parse(this)){if(this.sfmatrix4dValues(t),this.comments(),s.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfmatrix4dValues:function(t){for(t.length=0,t=t.getTarget();this.sfmatrix4dValue(this.SFMatrix4d);)t.push(this.SFMatrix4d)},sfmatrix4fValue:function(t){return this.sfmatrix4dValue(t)},mfmatrix4fValue:function(t){if(t.length=0,this.sfmatrix4fValue(this.SFMatrix4f))return t.push(this.SFMatrix4f),!0;if(s.OpenBracket.parse(this)){if(this.sfmatrix4fValues(t),this.comments(),s.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfmatrix4fValues:function(t){for(t.length=0,t=t.getTarget();this.sfmatrix4fValue(this.SFMatrix4f);)t.push(this.SFMatrix4f)},sfnodeValue:function(t){var e=this.nodeStatement();return!1!==e&&(t.setValue(e),!0)},mfnodeValue:function(t){t.length=0;var e=this.nodeStatement();if(!1!==e)return t.push(e),!0;if(s.OpenBracket.parse(this)){if(this.nodeStatements(t),this.comments(),s.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},nodeStatements:function(t){for(var e=this.nodeStatement();!1!==e;)t.push(e),e=this.nodeStatement()},sfrotationValue:function(t){if(this.double()){var e=this.value;if(this.double()){var i=this.value;if(this.double()){var n=this.value;if(this.double()){var r=this.value;return t.x=e,t.y=i,t.z=n,t.angle=this.fromUnit("angle",r),!0}}}}return!1},mfrotationValue:function(t){if(t.length=0,this.sfrotationValue(this.SFRotation))return t.push(this.SFRotation),!0;if(s.OpenBracket.parse(this)){if(this.sfrotationValues(t),this.comments(),s.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfrotationValues:function(t){for(t.length=0,t=t.getTarget();this.sfrotationValue(this.SFRotation);)t.push(this.SFRotation)},sfstringValue:function(t){return!!this.string()&&(t.setValue(this.value),!0)},mfstringValue:function(t){if(t.length=0,this.sfstringValue(this.SFString))return t.push(this.SFString),!0;if(s.OpenBracket.parse(this)){if(this.sfstringValues(t),this.comments(),s.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfstringValues:function(t){for(t.length=0,t=t.getTarget();this.sfstringValue(this.SFString);)t.push(this.SFString)},sftimeValue:function(t){return this.sfdoubleValue(t)},mftimeValue:function(t){if(t.length=0,this.sftimeValue(this.SFTime))return t.push(this.SFTime),!0;if(s.OpenBracket.parse(this)){if(this.sftimeValues(t),this.comments(),s.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sftimeValues:function(t){for(t.length=0,t=t.getTarget();this.sftimeValue(this.SFTime);)t.push(this.SFTime)},sfvec2dValue:function(t){if(this.double()){var e=this.value;if(this.double()){var i=this.value,n=t.getUnit();return t.x=this.fromUnit(n,e),t.y=this.fromUnit(n,i),!0}}return!1},mfvec2dValue:function(t){if(t.length=0,this.SFVec2d.setUnit(t.getUnit()),this.sfvec2dValue(this.SFVec2d))return t.push(this.SFVec2d),!0;if(s.OpenBracket.parse(this)){if(this.sfvec2dValues(t),this.comments(),s.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfvec2dValues:function(t){for(t.length=0,t=t.getTarget(),this.SFVec2d.setUnit(t.getUnit());this.sfvec2dValue(this.SFVec2d);)t.push(this.SFVec2d)},sfvec2fValue:function(t){return this.sfvec2dValue(t)},mfvec2fValue:function(t){if(t.length=0,this.SFVec2f.setUnit(t.getUnit()),this.sfvec2fValue(this.SFVec2f))return t.push(this.SFVec2f),!0;if(s.OpenBracket.parse(this)){if(this.sfvec2fValues(t),this.comments(),s.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfvec2fValues:function(t){for(t.length=0,t=t.getTarget(),this.SFVec2f.setUnit(t.getUnit());this.sfvec2fValue(this.SFVec2f);)t.push(this.SFVec2f)},sfvec3dValue:function(t){if(this.double()){var e=this.value;if(this.double()){var i=this.value;if(this.double()){var n=this.value,r=t.getUnit();return t.x=this.fromUnit(r,e),t.y=this.fromUnit(r,i),t.z=this.fromUnit(r,n),!0}}}return!1},mfvec3dValue:function(t){if(t.length=0,this.SFVec3d.setUnit(t.getUnit()),this.sfvec3dValue(this.SFVec3d))return t.push(this.SFVec3d),!0;if(s.OpenBracket.parse(this)){if(this.sfvec3dValues(t),this.comments(),s.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfvec3dValues:function(t){for(t.length=0,t=t.getTarget(),this.SFVec3d.setUnit(t.getUnit());this.sfvec3dValue(this.SFVec3d);)t.push(this.SFVec3d)},sfvec3fValue:function(t){return this.sfvec3dValue(t)},mfvec3fValue:function(t){if(t.length=0,this.SFVec3f.setUnit(t.getUnit()),this.sfvec3fValue(this.SFVec3f))return t.push(this.SFVec3f),!0;if(s.OpenBracket.parse(this)){if(this.sfvec3fValues(t),this.comments(),s.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfvec3fValues:function(t){for(t.length=0,t=t.getTarget(),this.SFVec3f.setUnit(t.getUnit());this.sfvec3fValue(this.SFVec3f);)t.push(this.SFVec3f)},sfvec4dValue:function(t){if(this.double()){var e=this.value;if(this.double()){var i=this.value;if(this.double()){var n=this.value;if(this.double()){var r=this.value,s=t.getUnit();return t.x=this.fromUnit(s,e),t.y=this.fromUnit(s,i),t.z=this.fromUnit(s,n),t.w=this.fromUnit(s,r),!0}}}}return!1},mfvec4dValue:function(t){if(t.length=0,this.SFVec4d.setUnit(t.getUnit()),this.sfvec4dValue(this.SFVec4d))return t.push(this.SFVec4d),!0;if(s.OpenBracket.parse(this)){if(this.sfvec4dValues(t),this.comments(),s.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfvec4dValues:function(t){for(t.length=0,t=t.getTarget(),this.SFVec4d.setUnit(t.getUnit());this.sfvec4dValue(this.SFVec4d);)t.push(this.SFVec4d)},sfvec4fValue:function(t){return this.sfvec4dValue(t)},mfvec4fValue:function(t){if(t.length=0,this.SFVec4f.setUnit(t.getUnit()),this.sfvec4fValue(this.SFVec4f))return t.push(this.SFVec4f),!0;if(s.OpenBracket.parse(this)){if(this.sfvec4fValues(t),this.comments(),s.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfvec4fValues:function(t){for(t.length=0,t=t.getTarget(),this.SFVec4f.setUnit(t.getUnit());this.sfvec4fValue(this.SFVec4f);)t.push(this.SFVec4f)}}),u.prototype.fieldTypes=[],u.prototype.fieldTypes[r.SFBool]=u.prototype.sfboolValue,u.prototype.fieldTypes[r.SFColor]=u.prototype.sfcolorValue,u.prototype.fieldTypes[r.SFColorRGBA]=u.prototype.sfcolorrgbaValue,u.prototype.fieldTypes[r.SFDouble]=u.prototype.sfdoubleValue,u.prototype.fieldTypes[r.SFFloat]=u.prototype.sffloatValue,u.prototype.fieldTypes[r.SFImage]=u.prototype.sfimageValue,u.prototype.fieldTypes[r.SFInt32]=u.prototype.sfint32Value,u.prototype.fieldTypes[r.SFMatrix3f]=u.prototype.sfmatrix3dValue,u.prototype.fieldTypes[r.SFMatrix3d]=u.prototype.sfmatrix3fValue,u.prototype.fieldTypes[r.SFMatrix4f]=u.prototype.sfmatrix4dValue,u.prototype.fieldTypes[r.SFMatrix4d]=u.prototype.sfmatrix4fValue,u.prototype.fieldTypes[r.SFNode]=u.prototype.sfnodeValue,u.prototype.fieldTypes[r.SFRotation]=u.prototype.sfrotationValue,u.prototype.fieldTypes[r.SFString]=u.prototype.sfstringValue,u.prototype.fieldTypes[r.SFTime]=u.prototype.sftimeValue,u.prototype.fieldTypes[r.SFVec2d]=u.prototype.sfvec2dValue,u.prototype.fieldTypes[r.SFVec2f]=u.prototype.sfvec2fValue,u.prototype.fieldTypes[r.SFVec3d]=u.prototype.sfvec3dValue,u.prototype.fieldTypes[r.SFVec3f]=u.prototype.sfvec3fValue,u.prototype.fieldTypes[r.SFVec4d]=u.prototype.sfvec4dValue,u.prototype.fieldTypes[r.SFVec4f]=u.prototype.sfvec4fValue,u.prototype.fieldTypes[r.MFBool]=u.prototype.mfboolValue,u.prototype.fieldTypes[r.MFColor]=u.prototype.mfcolorValue,u.prototype.fieldTypes[r.MFColorRGBA]=u.prototype.mfcolorrgbaValue,u.prototype.fieldTypes[r.MFDouble]=u.prototype.mfdoubleValue,u.prototype.fieldTypes[r.MFFloat]=u.prototype.mffloatValue,u.prototype.fieldTypes[r.MFImage]=u.prototype.mfimageValue,u.prototype.fieldTypes[r.MFInt32]=u.prototype.mfint32Value,u.prototype.fieldTypes[r.MFMatrix3d]=u.prototype.mfmatrix3dValue,u.prototype.fieldTypes[r.MFMatrix3f]=u.prototype.mfmatrix3fValue,u.prototype.fieldTypes[r.MFMatrix4d]=u.prototype.mfmatrix4dValue,u.prototype.fieldTypes[r.MFMatrix4f]=u.prototype.mfmatrix4fValue,u.prototype.fieldTypes[r.MFNode]=u.prototype.mfnodeValue,u.prototype.fieldTypes[r.MFRotation]=u.prototype.mfrotationValue,u.prototype.fieldTypes[r.MFString]=u.prototype.mfstringValue,u.prototype.fieldTypes[r.MFTime]=u.prototype.mftimeValue,u.prototype.fieldTypes[r.MFVec2d]=u.prototype.mfvec2dValue,u.prototype.fieldTypes[r.MFVec2f]=u.prototype.mfvec2fValue,u.prototype.fieldTypes[r.MFVec3d]=u.prototype.mfvec3dValue,u.prototype.fieldTypes[r.MFVec3f]=u.prototype.mfvec3fValue,u.prototype.fieldTypes[r.MFVec4d]=u.prototype.mfvec4dValue,u.prototype.fieldTypes[r.MFVec4f]=u.prototype.mfvec4fValue,u})),define("standard/Utility/DataStorage",[],(function(){"use strict";const t=new WeakMap,e=new WeakMap,i=new WeakMap,n={get:function(t,e){const i=t[e];if(void 0!==i)return i;const n=t.getStorage()[t.getNameSpace()+e];if(void 0===n||"undefined"===n||null===n)return t.getDefaultValue(e);return JSON.parse(n)},set:function(t,e,i){return void 0===i?t.getStorage().removeItem(t.getNameSpace()+e):t.getStorage()[t.getNameSpace()+e]=JSON.stringify(i),!0}};function r(r,s){return this.target=this,t.set(this,r),e.set(this,s),i.set(this,{}),new Proxy(this,n)}return r.prototype={constructor:r,getStorage:function(){return t.get(this.target)},getNameSpace:function(){return e.get(this.target)},addNameSpace:function(t){return new r(this.getStorage(),this.getNameSpace()+t)},addDefaultValues:function(t){Object.assign(i.get(this.target),t)},getDefaultValue(t){const e=i.get(this.target)[t];return void 0===e?void 0:JSON.parse(JSON.stringify(e))},clear:function(){const t=this.getStorage(),e=this.getNameSpace();for(const i of Object.keys(t))i.startsWith(e)&&t.removeItem(i)}},r})),define("x_ite/Browser/Core/X3DCoreContext",["jquery","x_ite/Fields","x_ite/Browser/Core/Context","x_ite/Browser/Core/BrowserTimings","x_ite/Browser/Core/BrowserOptions","x_ite/Browser/Core/BrowserProperties","x_ite/Browser/Core/RenderingProperties","x_ite/Browser/Core/Notification","x_ite/Browser/Core/ContextMenu","x_ite/Execution/Scene","x_ite/Parser/VRMLParser","standard/Utility/DataStorage","standard/Math/Numbers/Vector3","locale/gettext"],(function(t,e,i,n,r,s,o,a,u,l,c,h,d,p){"use strict";const f=Symbol(),g=Symbol(),m=Symbol(),_=Symbol(),y=Symbol(),x=Symbol(),w=Symbol(),b=Symbol(),v=Symbol(),S=Symbol(),T=Symbol(),C=Symbol(),O=Symbol(),N=Symbol(),F=Symbol(),E=Symbol(),D=Symbol(),M=Symbol(),I=Symbol(),V=Symbol();let B=0;function A(l){const c=t(l.prop("shadowRoot")),d=t("<div></div>").addClass("x_ite-private-browser"),p=t("<div></div>").addClass("x_ite-private-surface").appendTo(d),E=t("<div></div>").hide().addClass("x_ite-private-splash-screen").appendTo(d),D=(t("<div></div>").addClass("x_ite-private-spinner").appendTo(E),t("<div></div>").addClass("x_ite-private-progress").appendTo(E));t("<div></div>").addClass("x_ite-private-x_ite").html(this.getName()+"<span class='x_ite-private-x3d'>X3D</span>").appendTo(D),t("<div></div>").addClass("x_ite-private-progressbar").appendTo(D).append(t("<div></div>")),t("<div></div>").addClass("x_ite-private-spinner-text").appendTo(D),this[f]=++B,this[g]=l,this[m]=c.length?c.append(d.hide()):this[g].prepend(d),this[_]=p,this[y]=t("<canvas></canvas>").addClass("x_ite-private-canvas").prependTo(p),this[x]=i.create(this[y][0],2,"true"===l.attr("preserveDrawingBuffer")),this[w]=E,c.length&&c.prop("loaded").then((function(){d.show()})),this[b]=new h(localStorage,"X_ITE.X3DBrowser("+this[f]+")."),this[v]=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),this[S]=new n(this.getPrivateScene()),this[T]=new r(this.getPrivateScene()),this[C]=new s(this.getPrivateScene()),this[O]=new o(this.getPrivateScene()),this[N]=new a(this.getPrivateScene()),this[F]=new u(this.getPrivateScene());const M=t("<div></div>").hide().css("height","10in").appendTo(this[m]);this[V]=M.height()/720,M.remove(),t(".x_ite-console").empty(),this.addChildObjects("controlKey",new e.SFBool,"shiftKey",new e.SFBool,"altKey",new e.SFBool,"altGrKey",new e.SFBool)}return A.prototype={initialize:function(){this[S].setup(),this[T].setup(),this[C].setup(),this[O].setup(),this[N].setup(),this[F].setup(),this[E]=new MutationObserver(this.processMutations.bind(this)),this[E].observe(this[g][0],{attributes:!0,childList:!1,characterData:!1,subtree:!1}),Object.defineProperty(this.getElement().get(0),"src",{get:function(){return this.getExecutionContext().getWorldURL()}.bind(this),set:function(t){this.loadURL(new e.MFString(t),new e.MFString)}.bind(this),enumerable:!0,configurable:!1}),Object.defineProperty(this.getElement().get(0),"url",{get:function(){const t=this.getExecutionContext().getWorldURL();return t?new e.MFString(t):new e.MFString}.bind(this),set:function(t){this.loadURL(t,new e.MFString)}.bind(this),enumerable:!0,configurable:!1}),this.setBrowserEventHandler("onload"),this.setBrowserEventHandler("onshutdown"),this.setBrowserEventHandler("onerror"),this.getElement().bind("keydown.X3DCoreContext",this[M].bind(this)),this.getElement().bind("keyup.X3DCoreContext",this[I].bind(this))},getDebug:function(){return this.getBrowserOptions().getDebug()},getNumber:function(){return this[f]},isStrict:function(){return!1},getElement:function(){return this[g]},getShadow:function(){return this[m]},getSurface:function(){return this[_]},getSplashScreen:function(){return this[w]},getCanvas:function(){return this[y]},getContext:function(){return this[x]},getMobile:function(){return this[v]},getLocalStorage:function(){return this[b]},getBrowserTimings:function(){return this[S]},getBrowserOptions:function(){return this[T]},getBrowserProperties:function(){return this[C]},getRenderingProperties:function(){return this[O]},getNotification:function(){return this[N]},getContextMenu:function(){return this[F]},getPrivateScene:function(){return this[D]||(this[D]=new l(this),this[D].setPrivate(!0),this[D].setLive(!0),this[D].setup()),this[D]},processMutations:function(t){t.forEach((function(t){this.processMutation(t)}),this)},processMutation:function(t){const e=t.target;if("attributes"===t.type)this.processAttribute(t,e)},processAttribute:function(t,e){switch(t.attributeName.toLowerCase()){case"onerror":this.setBrowserEventHandler("onerror");break;case"onload":this.setBrowserEventHandler("onload");break;case"onshutdown":this.setBrowserEventHandler("onshutdown");break;case"splashscreen":this.getBrowserOptions().setAttributeSplashScreen();break;case"src":{const t=this.getElement().attr("src");this.load('"'+t+'"');break}case"url":this.load(this.getElement().attr("url"))}},load:function(t){if(t){const i=new c(this.getExecutionContext()),n=new e.MFString,r=new e.MFString;i.setInput(t),i.sfstringValues(n),n.length&&this.loadURL(n,r)}else this.getLoading()||this.getCanvas().show()},setBrowserEventHandler:function(t){const e=this.getElement().get(0),i=this.getElement().attr(t);e[t]=i?new Function(i):Function.prototype},callBrowserEventHandler:function(t){const e=this.getElement().get(0),i=e[t];window.jQuery?window.jQuery(e).trigger(t.substr(2)):i&&i.call(e)},getShiftKey:function(){return this._shiftKey.getValue()},getControlKey:function(){return this._controlKey.getValue()},getAltKey:function(){return this._altKey.getValue()},getAltGrKey:function(){return this._altGrKey.getValue()},[M]:function(t){switch(t.keyCode){case 16:this._shiftKey=!0;break;case 17:this._controlKey=!0;break;case 18:this._altKey=!0;break;case 49:this.getDebug()&&this.getControlKey()&&(t.preventDefault(),this.setBrowserOption("Shading","POINT"),this.getNotification()._string="Shading: Pointset");break;case 50:this.getDebug()&&this.getControlKey()&&(t.preventDefault(),this.setBrowserOption("Shading","WIREFRAME"),this.getNotification()._string="Shading: Wireframe");break;case 51:this.getDebug()&&this.getControlKey()&&(t.preventDefault(),this.setBrowserOption("Shading","FLAT"),this.getNotification()._string="Shading: Flat");break;case 52:this.getDebug()&&this.getControlKey()&&(t.preventDefault(),this.setBrowserOption("Shading","GOURAUD"),this.getNotification()._string="Shading: Gouraud");break;case 53:this.getDebug()&&this.getControlKey()&&(t.preventDefault(),this.setBrowserOption("Shading","PHONG"),this.getNotification()._string="Shading: Phong");break;case 83:this.getDebug()&&this.getControlKey()&&(t.preventDefault(),this.isLive().getValue()?this.endUpdate():this.beginUpdate(),this.getNotification()._string=this.isLive().getValue()?"Begin Update":"End Update");break;case 225:this._altGrKey=!0;break;case 171:case 187:this.getControlKey()&&(t.preventDefault(),this.setBrowserOption("Timings",!this.getBrowserOption("Timings")));break;case 36:t.preventDefault(),this.firstViewpoint();break;case 35:t.preventDefault(),this.lastViewpoint();break;case 33:t.preventDefault(),this.previousViewpoint();break;case 34:t.preventDefault(),this.nextViewpoint();break;case 119:if(this.getShiftKey()){t.preventDefault();const i=this.getActiveViewpoint();if(!i)break;const n=this.getPrivateScene().createNode(i.getTypeName());switch(i.getTypeName()){case"Viewpoint":n.position=i.getUserPosition(),n.orientation=i.getUserOrientation(),n.centerOfRotation=i.getUserCenterOfRotation(),n.fieldOfView=i.getFieldOfView();break;case"OrthoViewpoint":n.position=i.getUserPosition(),n.orientation=i.getUserOrientation(),n.centerOfRotation=i.getUserCenterOfRotation(),n.fieldOfView=new e.MFFloat(i.getMinimumX(),i.getMinimumY(),i.getMaximumX(),i.getMaximumY());break;case"GeoViewpoint":{const t=i._geoOrigin,e=new d(0,0,0);if(t.getValue()&&"GeoOrigin"===t.getNodeTypeName()){const e=this.getPrivateScene().createNode("GeoOrigin");n.geoOrigin=e,e.geoSystem=t.geoSystem,e.geoCoords=t.geoCoords,e.rotateYUp=t.rotateYUp}n.geoSystem=i._geoSystem,n.position=i.getGeoCoord(i.getUserPosition(),e),n.orientation=i.getUserOrientation(),n.centerOfRotation=i.getGeoCoord(i.getUserCenterOfRotation(),e),n.fieldOfView=i.getFieldOfView();break}}let r;switch(this.getExecutionContext().getEncoding()){case"ASCII":case"VRML":r=n.toVRMLString();break;case"JSON":r=n.toJSONString();break;default:r=n.toXMLString()}r+="\n",this.copyToClipboard(r),this.getNotification()._string=p("Viewpoint is copied to clipboard."),console.log("Copied Viewpoint to Clipboard."),console.debug(r)}}},[I]:function(t){switch(t.which){case 16:this._shiftKey=!1;break;case 17:this._controlKey=!1;break;case 18:this._altKey=!1;break;case 225:this._altGrKey=!1}},copyToClipboard:function(e){const i=t("<textarea></textarea>");this.getShadow().find(".x_ite-private-browser").prepend(i),i.text(e).select(),document.execCommand("copy"),i.remove()},getPixelPerPoint:function(){return this[V]}},A})),define("x_ite/Routing/X3DRoutingContext",[],(function(){"use strict";const t=Symbol(),e=Symbol(),i=Symbol(),n=Symbol();function r(){this[t]=[],this[e]=[],this[i]=[],this[n]=[]}return r.prototype={constructor:r,initialize:function(){},addTaintedField:function(e,i){this[t].push(e,i)},addTaintedNode:function(t){this[i].push(t)},processEvents:function(){do{do{const i=this[t];this[t]=this[e],this[t].length=0;for(let t=0,e=i.length;t<e;t+=2)i[t].processEvent(i[t+1]);this[e]=i}while(this[t].length);do{const t=this[i];this[i]=this[n],this[i].length=0;for(const e of t)e.processEvents();this[n]=t}while(!this[t].length&&this[i].length)}while(this[t].length)}},r})),define("x_ite/Browser/Scripting/X3DScriptingContext",[],(function(){"use strict";const t=Symbol();function e(){this[t]=[this]}return e.prototype={initialize:function(){},isExternal:function(){return 1===this[t].length},getScriptStack:function(){return this[t]}},e})),define("x_ite/Browser/Networking/urls",[],(function(){"use strict";function t(){}return t.prototype={getProviderUrl:function(t){return t?(getScriptURL().match(/\.min\.js$/)&&(t+=".min"),new URL("assets/components/"+t+".js",getScriptURL()).href):"https://create3000.github.io/x_ite/"},getShaderUrl:function(t){return new URL("assets/shaders/"+t,getScriptURL()).href},getFontsUrl:function(t){return new URL("assets/fonts/"+t,getScriptURL()).href},getLinetypeUrl:function(){return new URL("assets/linetype/linetypes.png",getScriptURL()).href},getHatchingUrl:function(t){return new URL("assets/hatching/"+t+".png",getScriptURL()).href}},new t})),define("x_ite/Browser/Networking/X3DNetworkingContext",["x_ite/Fields","x_ite/Browser/Networking/urls","locale/gettext"],(function(t,e,i){"use strict";const n=Symbol(),r=Symbol(),s=Symbol(),o=Symbol(),a=Symbol();function u(){this.addChildObjects("loadCount",new t.SFInt32),this[n]=0,this[r]=new Set,this[s]=!1,this[o]=function(t){let e=t.baseURI;return e.startsWith("about:")&&(e=document.baseURI),e}(this.getElement()[0]),this.getCanvas().hide(),this.getBrowserOptions().getSplashScreen()&&(this.getContextMenu().hide(),this.getSplashScreen().show())}return u.prototype={initialize:function(){},getProviderUrl:function(){return e.getProviderUrl()},getLocation:function(){return this[o]},getDefaultScene:function(){return this[a]=this.createScene(),this[a].setPrivate(!0),this[a].setLive(!0),this[a].setup(),this.getDefaultScene=function(){return this[a]},Object.defineProperty(this,"getDefaultScene",{enumerable:!1}),this[a]},setBrowserLoading:function(t){this[s]=t,t?(this.resetLoadCount(),this.getShadow().find(".x_ite-private-world-info").remove(),this.getBrowserOptions().getSplashScreen()?(this.getContextMenu().hide(),this.getCanvas().stop(!0,!0).animate({delay:1},1).fadeOut(0),this.getSplashScreen().stop(!0,!0).animate({delay:1},1).fadeIn(0)):this.getCanvas().hide()):this.getBrowserOptions().getSplashScreen()?(this.getSplashScreen().stop(!0,!0).show().fadeOut(2e3),this.getCanvas().stop(!0,!0).hide().fadeIn(2e3)):this.getCanvas().show()},getLoading:function(){return this[s]},addLoadCount:function(t){this[r].has(t)||(++this[n],this[r].add(t),this.setLoadCount(this[r].size),this.setCursor("DEFAULT"))},removeLoadCount:function(t){this[r].has(t)&&(this[r].delete(t),this.setLoadCount(this[r].size))},setLoadCount:function(t){if(this._loadCount=t,t)var e=i(1==t?"Loading %1 file":"Loading %1 files").replace("%1",t);else{e=i("Loading done");this.setCursor("DEFAULT")}this[s]||(this.getNotification()._string=e),this.getSplashScreen().find(".x_ite-private-spinner-text").text(e),this.getSplashScreen().find(".x_ite-private-progressbar div").css("width",100*(this[n]-t)/this[n]+"%")},resetLoadCount:function(){this._loadCount=0,this[n]=0,this[r].clear()}},u})),define("x_ite/Components/Shape/X3DAppearanceChildNode",["x_ite/Components/Core/X3DNode","x_ite/Base/X3DConstants"],(function(t,e){"use strict";function i(i){t.call(this,i),this.addType(e.X3DAppearanceChildNode)}return i.prototype=Object.assign(Object.create(t.prototype),{constructor:i}),i})),define("x_ite/Components/Shaders/X3DShaderNode",["x_ite/Fields","x_ite/Components/Shape/X3DAppearanceChildNode","x_ite/Base/X3DConstants"],(function(t,e,i){"use strict";function n(n){e.call(this,n),this.addType(i.X3DShaderNode),this.addChildObjects("activationTime",new t.SFTime),this.valid=!1,this.selected=0}return n.prototype=Object.assign(Object.create(e.prototype),{constructor:n,initialize:function(){e.prototype.initialize.call(this),this._activate.addInterest("set_activate__",this)},set_activate__:function(){this._activationTime=this.getBrowser().getCurrentTime()},setValid:function(t){this._isValid=this.valid=t},isValid:function(){return this.valid},select:function(){++this.selected,this._isSelected.getValue()||(this._isSelected=!0)},deselect:function(){--this.selected,0===this.selected&&this._isSelected.getValue()&&(this._isSelected=!1)}}),n})),define("x_ite/Components/Navigation/OrthoViewpoint",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Navigation/X3DViewpointNode","x_ite/Components/Interpolation/ScalarInterpolator","x_ite/Base/X3DConstants","standard/Math/Geometry/Camera","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4"],(function(t,e,i,n,r,s,o,a,u,l){"use strict";function c(e){n.call(this,e),this.addType(s.OrthoViewpoint),this.addChildObjects("fieldOfViewOffset",new t.MFFloat(0,0,0,0)),this._position.setUnit("length"),this._centerOfRotation.setUnit("length"),this._fieldOfView.setUnit("length"),this.projectionMatrix=new l,this.fieldOfViewOffsetInterpolator0=new r(this.getBrowser().getPrivateScene()),this.fieldOfViewOffsetInterpolator1=new r(this.getBrowser().getPrivateScene()),this.fieldOfViewOffsetInterpolator2=new r(this.getBrowser().getPrivateScene()),this.fieldOfViewOffsetInterpolator3=new r(this.getBrowser().getPrivateScene()),this.fieldOfViewScaleInterpolator=new r(this.getBrowser().getPrivateScene())}return c.prototype=Object.assign(Object.create(n.prototype),{constructor:c,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.inputOnly,"set_bind",new t.SFBool),new e(s.inputOutput,"description",new t.SFString),new e(s.inputOutput,"position",new t.SFVec3f(0,0,10)),new e(s.inputOutput,"orientation",new t.SFRotation),new e(s.inputOutput,"centerOfRotation",new t.SFVec3f),new e(s.inputOutput,"fieldOfView",new t.MFFloat(-1,-1,1,1)),new e(s.inputOutput,"jump",new t.SFBool(!0)),new e(s.inputOutput,"retainUserOffsets",new t.SFBool),new e(s.outputOnly,"isBound",new t.SFBool),new e(s.outputOnly,"bindTime",new t.SFTime)]),getTypeName:function(){return"OrthoViewpoint"},getComponentName:function(){return"Navigation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this._fieldOfView.addInterest("set_fieldOfView__",this),this._fieldOfViewOffset.addInterest("set_fieldOfView__",this),this._fieldOfViewScale.addInterest("set_fieldOfView__",this),this.fieldOfViewOffsetInterpolator0._key=new t.MFFloat(0,1),this.fieldOfViewOffsetInterpolator1._key=new t.MFFloat(0,1),this.fieldOfViewOffsetInterpolator2._key=new t.MFFloat(0,1),this.fieldOfViewOffsetInterpolator3._key=new t.MFFloat(0,1),this.fieldOfViewScaleInterpolator._key=new t.MFFloat(0,1),this.fieldOfViewOffsetInterpolator0.setup(),this.fieldOfViewOffsetInterpolator1.setup(),this.fieldOfViewOffsetInterpolator2.setup(),this.fieldOfViewOffsetInterpolator3.setup(),this.fieldOfViewScaleInterpolator.setup(),this.getEaseInEaseOut()._modifiedFraction_changed.addFieldInterest(this.fieldOfViewOffsetInterpolator0._set_fraction),this.getEaseInEaseOut()._modifiedFraction_changed.addFieldInterest(this.fieldOfViewOffsetInterpolator1._set_fraction),this.getEaseInEaseOut()._modifiedFraction_changed.addFieldInterest(this.fieldOfViewOffsetInterpolator2._set_fraction),this.getEaseInEaseOut()._modifiedFraction_changed.addFieldInterest(this.fieldOfViewOffsetInterpolator3._set_fraction),this.getEaseInEaseOut()._modifiedFraction_changed.addFieldInterest(this.fieldOfViewScaleInterpolator._set_fraction),this.fieldOfViewOffsetInterpolator0._value_changed.addInterest("set_fieldOfViewOffset__",this),this.fieldOfViewOffsetInterpolator1._value_changed.addInterest("set_fieldOfViewOffset__",this),this.fieldOfViewOffsetInterpolator2._value_changed.addInterest("set_fieldOfViewOffset__",this),this.fieldOfViewOffsetInterpolator3._value_changed.addInterest("set_fieldOfViewOffset__",this),this.fieldOfViewScaleInterpolator._value_changed.addFieldInterest(this._fieldOfViewScale),this.set_fieldOfView__()},set_fieldOfView__:function(){const t=this._fieldOfView.length,e=this._fieldOfViewScale.getValue();this.minimumX=((t>0?this._fieldOfView[0]:-1)+this._fieldOfViewOffset[0])*e,this.minimumY=((t>1?this._fieldOfView[1]:-1)+this._fieldOfViewOffset[1])*e,this.maximumX=((t>2?this._fieldOfView[2]:1)+this._fieldOfViewOffset[2])*e,this.maximumY=((t>3?this._fieldOfView[3]:1)+this._fieldOfViewOffset[3])*e,this.sizeX=this.maximumX-this.minimumX,this.sizeY=this.maximumY-this.minimumY},set_fieldOfViewOffset__:function(){this._fieldOfViewOffset[0]=this.fieldOfViewOffsetInterpolator0._value_changed.getValue(),this._fieldOfViewOffset[1]=this.fieldOfViewOffsetInterpolator1._value_changed.getValue(),this._fieldOfViewOffset[2]=this.fieldOfViewOffsetInterpolator2._value_changed.getValue(),this._fieldOfViewOffset[3]=this.fieldOfViewOffsetInterpolator3._value_changed.getValue()},setInterpolators:function(e,i){if(e.getType().indexOf(s.OrthoViewpoint)>=0){const n=i._fieldOfView.length,r=e._fieldOfView.length,s=(r>0?e._fieldOfView[0]:-1)-(n>0?i._fieldOfView[0]:-1),o=(r>1?e._fieldOfView[1]:-1)-(n>1?i._fieldOfView[1]:-1),a=(r>2?e._fieldOfView[2]:1)-(n>2?i._fieldOfView[2]:1),u=(r>3?e._fieldOfView[3]:1)-(n>3?i._fieldOfView[3]:1);this.fieldOfViewOffsetInterpolator0._keyValue=new t.MFFloat(s,i._fieldOfViewOffset[0]),this.fieldOfViewOffsetInterpolator1._keyValue=new t.MFFloat(o,i._fieldOfViewOffset[1]),this.fieldOfViewOffsetInterpolator2._keyValue=new t.MFFloat(a,i._fieldOfViewOffset[2]),this.fieldOfViewOffsetInterpolator3._keyValue=new t.MFFloat(u,i._fieldOfViewOffset[3]),this.fieldOfViewScaleInterpolator._keyValue=new t.MFFloat(e._fieldOfViewScale.getValue(),i._fieldOfViewScale.getValue()),this._fieldOfViewOffset[0]=s,this._fieldOfViewOffset[1]=o,this._fieldOfViewOffset[2]=a,this._fieldOfViewOffset[3]=u,this._fieldOfViewScale=e._fieldOfViewScale.getValue()}else this.fieldOfViewOffsetInterpolator0._keyValue=new t.MFFloat(i._fieldOfViewOffset[0],i._fieldOfViewOffset[0]),this.fieldOfViewOffsetInterpolator1._keyValue=new t.MFFloat(i._fieldOfViewOffset[1],i._fieldOfViewOffset[1]),this.fieldOfViewOffsetInterpolator2._keyValue=new t.MFFloat(i._fieldOfViewOffset[2],i._fieldOfViewOffset[2]),this.fieldOfViewOffsetInterpolator3._keyValue=new t.MFFloat(i._fieldOfViewOffset[3],i._fieldOfViewOffset[3]),this.fieldOfViewScaleInterpolator._keyValue=new t.MFFloat(i._fieldOfViewScale.getValue(),i._fieldOfViewScale.getValue()),this._fieldOfViewOffset=i._fieldOfViewOffset.getValue(),this._fieldOfViewScale=i._fieldOfViewScale.getValue()},getMinimumX:function(){return this.minimumX},getMinimumY:function(){return this.minimumY},getMaximumX:function(){return this.maximumX},getMaximumY:function(){return this.maximumY},getSizeX:function(){return this.sizeX},getSizeY:function(){return this.sizeY},getMaxFarValue:function(){return 1e5},getScreenScale:function(t,e,i){const n=e[2],r=e[3],s=this.sizeX,o=this.sizeY;if(n/r>s/o){const t=o/r;return i.set(t,t,t)}{const t=s/n;return i.set(t,t,t)}},getViewportSize:function(){const t=new a(0,0);return function(e,i){const n=e[2],r=e[3],s=this.sizeX,o=this.sizeY,a=n/r;return a>s/o?t.set(o*a,o):t.set(s,s/a)}}(),getLookAtDistance:function(t){return t.size.magnitude()/2+10},getProjectionMatrixWithLimits:function(t,e,i){const n=i[2]/i[3],r=this.sizeX,s=this.sizeY;if(n>r/s){const i=(this.minimumX+this.maximumX)/2,r=s*n/2;return o.ortho(i-r,i+r,this.minimumY,this.maximumY,t,e,this.projectionMatrix)}{const i=(this.minimumY+this.maximumY)/2,s=r/n/2;return o.ortho(this.minimumX,this.maximumX,i-s,i+s,t,e,this.projectionMatrix)}}}),c})),define("x_ite/Components/Shaders/X3DProgrammableShaderObject",["x_ite/Base/X3DCast","x_ite/Base/X3DConstants","x_ite/Components/Navigation/OrthoViewpoint","standard/Math/Numbers/Matrix3","standard/Math/Numbers/Matrix4"],(function(t,e,i,n,r){"use strict";const s=Symbol.for("X3DField.uniformLocation");function o(t){this.addType(e.X3DProgrammableShaderObject),this.uniformNames=[],this.x3d_ClipPlane=[],this.x3d_LightType=[],this.x3d_LightOn=[],this.x3d_LightColor=[],this.x3d_LightIntensity=[],this.x3d_LightAmbientIntensity=[],this.x3d_LightAttenuation=[],this.x3d_LightLocation=[],this.x3d_LightDirection=[],this.x3d_LightBeamWidth=[],this.x3d_LightCutOffAngle=[],this.x3d_LightRadius=[],this.x3d_LightMatrix=[],this.x3d_ShadowIntensity=[],this.x3d_ShadowColor=[],this.x3d_ShadowBias=[],this.x3d_ShadowMatrix=[],this.x3d_ShadowMapSize=[],this.x3d_ShadowMap=[],this.x3d_Textures=[],this.x3d_MultiTextureMode=[],this.x3d_MultiTextureAlphaMode=[],this.x3d_MultiTextureSource=[],this.x3d_MultiTextureFunction=[],this.x3d_TextureCoordinateGeneratorMode=[],this.x3d_TextureCoordinateGeneratorParameter=[],this.x3d_ProjectiveTexture=[],this.x3d_ProjectiveTextureMatrix=[],this.x3d_ProjectiveTextureLocation=[],this.x3d_TexCoord=[],this.x3d_TextureMatrix=[],this.numClipPlanes=0,this.fogNode=null,this.numLights=0,this.numGlobalLights=0,this.lightNodes=[],this.numProjectiveTextures=0,this.numGlobalProjectiveTextures=0,this.projectiveTextureNodes=[],this.textures=new Set}function a(t){return t[0].toLowerCase()+t.slice(1)}return o.prototype={constructor:o,initialize:function(){const t=this.getBrowser();this.x3d_MaxClipPlanes=t.getMaxClipPlanes(),this.x3d_MaxLights=t.getMaxLights(),this.x3d_MaxTextures=t.getMaxTextures()},canUserDefinedFields:function(){return!0},setUniformNames:function(t){this.uniformNames=t},getDefaultUniformsAndAttributes:function(t){const e=this.getBrowser(),i=e.getContext();i.useProgram(t);for(const e of this.uniformNames)this[e]=i.getUniformLocation(t,e);this.x3d_LogarithmicFarFactor1_2=i.getUniformLocation(t,"x3d_LogarithmicFarFactor1_2"),this.x3d_NumClipPlanes=i.getUniformLocation(t,"x3d_NumClipPlanes"),this.x3d_ClipPlanes=i.getUniformLocation(t,"x3d_ClipPlane");for(let e=0;e<this.x3d_MaxClipPlanes;++e)this.x3d_ClipPlane[e]=i.getUniformLocation(t,"x3d_ClipPlane["+e+"]");this.x3d_FogType=this.getUniformLocation(i,t,"x3d_Fog.type","x3d_FogType"),this.x3d_FogColor=this.getUniformLocation(i,t,"x3d_Fog.color","x3d_FogColor"),this.x3d_FogVisibilityRange=this.getUniformLocation(i,t,"x3d_Fog.visibilityRange","x3d_FogVisibilityRange"),this.x3d_FogMatrix=this.getUniformLocation(i,t,"x3d_Fog.matrix","x3d_FogMatrix"),this.x3d_AlphaCutoff=i.getUniformLocation(t,"x3d_AlphaCutoff"),this.x3d_PointPropertiesPointSizeScaleFactor=i.getUniformLocation(t,"x3d_PointProperties.pointSizeScaleFactor"),this.x3d_PointPropertiesPointSizeMinValue=i.getUniformLocation(t,"x3d_PointProperties.pointSizeMinValue"),this.x3d_PointPropertiesPointSizeMaxValue=i.getUniformLocation(t,"x3d_PointProperties.pointSizeMaxValue"),this.x3d_PointPropertiesPointSizeAttenuation=i.getUniformLocation(t,"x3d_PointProperties.pointSizeAttenuation"),this.x3d_LinePropertiesApplied=i.getUniformLocation(t,"x3d_LineProperties.applied"),this.x3d_LinePropertiesLinetype=i.getUniformLocation(t,"x3d_LineProperties.linetype"),this.x3d_LineStippleScale=i.getUniformLocation(t,"x3d_LineProperties.lineStippleScale"),this.x3d_LinePropertiesTexture=i.getUniformLocation(t,"x3d_LineProperties.texture"),this.x3d_FillPropertiesFilled=i.getUniformLocation(t,"x3d_FillProperties.filled"),this.x3d_FillPropertiesHatched=i.getUniformLocation(t,"x3d_FillProperties.hatched"),this.x3d_FillPropertiesHatchColor=i.getUniformLocation(t,"x3d_FillProperties.hatchColor"),this.x3d_FillPropertiesTexture=i.getUniformLocation(t,"x3d_FillProperties.texture"),this.x3d_NumLights=i.getUniformLocation(t,"x3d_NumLights");for(let e=0;e<this.x3d_MaxLights;++e)this.x3d_LightType[e]=this.getUniformLocation(i,t,"x3d_LightSource["+e+"].type","x3d_LightType["+e+"]"),this.x3d_LightColor[e]=this.getUniformLocation(i,t,"x3d_LightSource["+e+"].color","x3d_LightColor["+e+"]"),this.x3d_LightAmbientIntensity[e]=this.getUniformLocation(i,t,"x3d_LightSource["+e+"].ambientIntensity","x3d_LightAmbientIntensity["+e+"]"),this.x3d_LightIntensity[e]=this.getUniformLocation(i,t,"x3d_LightSource["+e+"].intensity","x3d_LightIntensity["+e+"]"),this.x3d_LightAttenuation[e]=this.getUniformLocation(i,t,"x3d_LightSource["+e+"].attenuation","x3d_LightAttenuation["+e+"]"),this.x3d_LightLocation[e]=this.getUniformLocation(i,t,"x3d_LightSource["+e+"].location","x3d_LightLocation["+e+"]"),this.x3d_LightDirection[e]=this.getUniformLocation(i,t,"x3d_LightSource["+e+"].direction","x3d_LightDirection["+e+"]"),this.x3d_LightBeamWidth[e]=this.getUniformLocation(i,t,"x3d_LightSource["+e+"].beamWidth","x3d_LightBeamWidth["+e+"]"),this.x3d_LightCutOffAngle[e]=this.getUniformLocation(i,t,"x3d_LightSource["+e+"].cutOffAngle","x3d_LightCutOffAngle["+e+"]"),this.x3d_LightRadius[e]=this.getUniformLocation(i,t,"x3d_LightSource["+e+"].radius","x3d_LightRadius["+e+"]"),this.x3d_LightMatrix[e]=this.getUniformLocation(i,t,"x3d_LightSource["+e+"].matrix","x3d_LightMatrix["+e+"]"),this.x3d_ShadowIntensity[e]=i.getUniformLocation(t,"x3d_LightSource["+e+"].shadowIntensity"),this.x3d_ShadowColor[e]=i.getUniformLocation(t,"x3d_LightSource["+e+"].shadowColor"),this.x3d_ShadowBias[e]=i.getUniformLocation(t,"x3d_LightSource["+e+"].shadowBias"),this.x3d_ShadowMatrix[e]=i.getUniformLocation(t,"x3d_LightSource["+e+"].shadowMatrix"),this.x3d_ShadowMapSize[e]=i.getUniformLocation(t,"x3d_LightSource["+e+"].shadowMapSize"),this.x3d_ShadowMap[e]=i.getUniformLocation(t,"x3d_ShadowMap["+e+"]");this.x3d_AmbientIntensity=this.getUniformLocation(i,t,"x3d_Material.ambientIntensity","x3d_FrontMaterial.ambientIntensity"),this.x3d_DiffuseColor=this.getUniformLocation(i,t,"x3d_Material.diffuseColor","x3d_FrontMaterial.diffuseColor"),this.x3d_SpecularColor=this.getUniformLocation(i,t,"x3d_Material.specularColor","x3d_FrontMaterial.specularColor"),this.x3d_EmissiveColor=this.getUniformLocation(i,t,"x3d_Material.emissiveColor","x3d_FrontMaterial.emissiveColor"),this.x3d_Shininess=this.getUniformLocation(i,t,"x3d_Material.shininess","x3d_FrontMaterial.shininess"),this.x3d_BaseColor=i.getUniformLocation(t,"x3d_Material.baseColor"),this.x3d_Metallic=i.getUniformLocation(t,"x3d_Material.metallic"),this.x3d_Roughness=i.getUniformLocation(t,"x3d_Material.roughness"),this.x3d_OcclusionStrength=i.getUniformLocation(t,"x3d_Material.occlusionStrength"),this.x3d_NormalScale=i.getUniformLocation(t,"x3d_Material.normalScale"),this.x3d_Transparency=this.getUniformLocation(i,t,"x3d_Material.transparency","x3d_FrontMaterial.transparency");const n=["x3d_AmbientTexture","x3d_DiffuseTexture","x3d_SpecularTexture","x3d_EmissiveTexture","x3d_ShininessTexture","x3d_BaseTexture","x3d_MetallicRoughnessTexture","x3d_OcclusionTexture","x3d_NormalTexture"];for(const e of n)this[e]={textureTransformMapping:i.getUniformLocation(t,e+".textureTransformMapping"),textureCoordinateMapping:i.getUniformLocation(t,e+".textureCoordinateMapping"),texture2D:i.getUniformLocation(t,e+".texture2D"),texture3D:i.getUniformLocation(t,e+".texture3D"),textureCube:i.getUniformLocation(t,e+".textureCube")};this.x3d_NumTextures=i.getUniformLocation(t,"x3d_NumTextures"),this.x3d_NumProjectiveTextures=i.getUniformLocation(t,"x3d_NumProjectiveTextures"),this.x3d_MultiTextureColor=i.getUniformLocation(t,"x3d_MultiTextureColor"),this.x3d_TexCoord.length=0;for(let e=0;e<this.x3d_MaxTextures;++e){this.x3d_Textures[e]={textureType:i.getUniformLocation(t,"x3d_TextureType["+e+"]"),texture2D:i.getUniformLocation(t,"x3d_Texture2D["+e+"]"),texture3D:i.getUniformLocation(t,"x3d_Texture3D["+e+"]"),textureCube:this.getUniformLocation(i,t,"x3d_TextureCube["+e+"]","x3d_CubeMapTexture["+e+"]")},this.x3d_MultiTextureMode[e]=i.getUniformLocation(t,"x3d_MultiTexture["+e+"].mode"),this.x3d_MultiTextureAlphaMode[e]=i.getUniformLocation(t,"x3d_MultiTexture["+e+"].alphaMode"),this.x3d_MultiTextureSource[e]=i.getUniformLocation(t,"x3d_MultiTexture["+e+"].source"),this.x3d_MultiTextureFunction[e]=i.getUniformLocation(t,"x3d_MultiTexture["+e+"].function"),this.x3d_TextureCoordinateGeneratorMode[e]=i.getUniformLocation(t,"x3d_TextureCoordinateGenerator["+e+"].mode"),this.x3d_TextureCoordinateGeneratorParameter[e]=i.getUniformLocation(t,"x3d_TextureCoordinateGenerator["+e+"].parameter"),this.x3d_ProjectiveTexture[e]=i.getUniformLocation(t,"x3d_ProjectiveTexture["+e+"]"),this.x3d_ProjectiveTextureMatrix[e]=i.getUniformLocation(t,"x3d_ProjectiveTextureMatrix["+e+"]"),this.x3d_ProjectiveTextureLocation[e]=i.getUniformLocation(t,"x3d_ProjectiveTextureLocation["+e+"]"),this.x3d_TextureMatrix[e]=i.getUniformLocation(t,"x3d_TextureMatrix["+e+"]");const n=this.getAttribLocation(i,t,"x3d_TexCoord"+e,e?"":"x3d_TexCoord");-1!==n&&this.x3d_TexCoord.push([e,n])}this.x3d_TexCoordRamp=i.getUniformLocation(t,"x3d_TexCoordRamp"),this.x3d_Viewport=i.getUniformLocation(t,"x3d_Viewport"),this.x3d_ProjectionMatrix=i.getUniformLocation(t,"x3d_ProjectionMatrix"),this.x3d_ModelViewMatrix=i.getUniformLocation(t,"x3d_ModelViewMatrix"),this.x3d_NormalMatrix=i.getUniformLocation(t,"x3d_NormalMatrix"),this.x3d_CameraSpaceMatrix=i.getUniformLocation(t,"x3d_CameraSpaceMatrix");const r=["FogDepth","Color","Normal","Vertex","Particle","ParticleMatrix"];for(const e of r){const n=i.getAttribLocation(t,`x3d_${e}`);this[`x3d_${e}`]=n,n<0?(this[`enable${e}Attribute`]=Function.prototype,this[`${a(e)}AttributeDivisor`]=Function.prototype):(delete this[`enable${e}Attribute`],delete this[`${a(e)}AttributeDivisor`])}0===this.x3d_TexCoord.length?(this.enableTexCoordAttribute=Function.prototype,this.texCoordAttributeDivisor=Function.prototype):(delete this.enableTexCoordAttribute,delete this.texCoordAttributeDivisor),i.uniform1f(this.x3d_LineStippleScale,e.getLineStippleScale()),i.uniform1i(this.x3d_LinePropertiesTexture,e.getDefaultTexture2DUnit()),i.uniform1i(this.x3d_FillPropertiesTexture,e.getDefaultTexture2DUnit());for(const t of n)i.uniform1i(this[t].texture2D,e.getDefaultTexture2DUnit()),i.uniform1i(this[t].texture3D,e.getDefaultTexture3DUnit()),i.uniform1i(this[t].textureCube,e.getDefaultTextureCubeUnit());i.uniform1i(this.x3d_NumTextures,0);for(const t of this.x3d_Textures)i.uniform1i(t.texture2D,e.getDefaultTexture2DUnit()),i.getVersion()>=2&&i.uniform1i(t.texture3D,e.getDefaultTexture3DUnit()),i.uniform1i(t.textureCube,e.getDefaultTextureCubeUnit());for(const t of this.x3d_ShadowMap)i.uniform1i(t,e.getDefaultTexture2DUnit());if(e.getProjectiveTextureMapping())for(const t of this.x3d_ProjectiveTexture)i.uniform1i(t,e.getDefaultTexture2DUnit());i.uniform1i(this.x3d_TexCoordRamp,e.getDefaultTexture2DUnit())},getUniformLocation:function(t,e,i,n){let r=t.getUniformLocation(e,i);return r||(n?(r=t.getUniformLocation(e,n),r&&console.warn(this.getTypeName(),this.getName(),"Using uniform location name »"+n+"« is depreciated, use »"+i+"«. See https://create3000.github.io/x_ite/Custom-Shaders.html."),r):0)},getAttribLocation:function(t,e,i,n){let r=t.getAttribLocation(e,i);return r>=0?r:n?(r=t.getAttribLocation(e,n),r>=0&&console.warn(this.getTypeName(),this.getName(),"Using attribute location name »"+n+"« is depreciated, use »"+i+"«. See https://create3000.github.io/x_ite/Custom-Shaders.html."),r):-1},addShaderFields:function(t){const i=this.getBrowser().getContext();i.useProgram(t),this.textures.clear();for(const n of this.getUserDefinedFields()){const r=i.getUniformLocation(t,n.getName());if(r){switch(n.getType()){case e.SFImage:r.array=new Int32Array(3+n.array.length);break;case e.SFMatrix3d:case e.SFMatrix3f:case e.SFRotation:r.array=new Float32Array(9);break;case e.SFMatrix4d:case e.SFMatrix4f:r.array=new Float32Array(16);break;case e.SFNode:break;case e.MFBool:case e.MFInt32:r.array=new Int32Array(this.getLocationLength(i,t,n));break;case e.MFFloat:case e.MFDouble:case e.MFTime:r.array=new Float32Array(this.getLocationLength(i,t,n));break;case e.MFImage:r.array=new Int32Array(this.getImagesLength(n));break;case e.MFMatrix3d:case e.MFMatrix3f:case e.MFRotation:r.array=new Float32Array(9*this.getLocationLength(i,t,n));break;case e.MFMatrix4d:case e.MFMatrix4f:r.array=new Float32Array(16*this.getLocationLength(i,t,n));break;case e.MFNode:{const e=r.locations=[];for(let r=0;;++r){const s=i.getUniformLocation(t,n.getName()+"["+r+"]");if(!s)break;e.push(s)}break}case e.MFVec2d:case e.MFVec2f:r.array=new Float32Array(2*this.getLocationLength(i,t,n));break;case e.MFVec3d:case e.MFVec3f:case e.MFColor:r.array=new Float32Array(3*this.getLocationLength(i,t,n));break;case e.MFVec4d:case e.MFVec4f:case e.MFColorRGBA:r.array=new Float32Array(4*this.getLocationLength(i,t,n))}r.array?n[s]=r.array.length?r:null:n[s]=r,n.addInterest("set_field__",this),this.set_field__(n,t)}}},removeShaderFields:function(){for(const t of this.getUserDefinedFields())t.removeInterest("set_field__",this)},set_field__:function(){const i=new n;return function(n,r){const o=this.getBrowser().getContext(),a=n[s];if(o.useProgram(r),a)switch(n.getType()){case e.SFBool:case e.SFInt32:return void o.uniform1i(a,n.getValue());case e.SFColor:{const t=n.getValue();return void o.uniform3f(a,t.r,t.g,t.b)}case e.SFColorRGBA:{const t=n.getValue();return void o.uniform4f(a,t.r,t.g,t.b,t.a)}case e.SFDouble:case e.SFFloat:case e.SFTime:return void o.uniform1f(a,n.getValue());case e.SFImage:{let t=a.array;const e=n.array,i=3+e.length;i!==t.length&&(t=a.array=new Int32Array(i)),t[0]=n.width,t[1]=n.height,t[2]=n.comp;for(let i=3,n=0,r=e.length;n<r;++n,++i)t[i]=e[n];return void o.uniform1iv(a,t)}case e.SFMatrix3d:case e.SFMatrix3f:return a.array.set(n.getValue()),void o.uniformMatrix3fv(a,!1,a.array);case e.SFMatrix4d:case e.SFMatrix4f:return a.array.set(n.getValue()),void o.uniformMatrix4fv(a,!1,a.array);case e.SFNode:{const i=t(e.X3DTextureNode,n);return void(i?(a.name=n.getName(),a.texture=i,this.textures.add(a)):this.textures.delete(a))}case e.SFRotation:return n.getValue().getMatrix(a.array),void o.uniformMatrix3fv(a,!1,a.array);case e.SFString:return;case e.SFVec2d:case e.SFVec2f:{const t=n.getValue();return void o.uniform2f(a,t.x,t.y)}case e.SFVec3d:case e.SFVec3f:{const t=n.getValue();return void o.uniform3f(a,t.x,t.y,t.z)}case e.SFVec4d:case e.SFVec4f:{const t=n.getValue();return void o.uniform4f(a,t.x,t.y,t.z,t.w)}case e.MFBool:case e.MFInt32:{const t=a.array;for(var u=0,l=n.length;u<l;++u)t[u]=n[u];for(let e=t.length;u<e;++u)t[u]=0;return void o.uniform1iv(a,t)}case e.MFColor:{const t=a.array;u=0;var c=0;for(l=n.length;u<l;++u){const e=n[u];t[c++]=e.r,t[c++]=e.g,t[c++]=e.b}for(let e=t.length;c<e;++c)t[c]=0;return void o.uniform3fv(a,t)}case e.MFColorRGBA:{const t=a.array;for(u=0,c=0,l=n.length;u<l;++u){const e=n[u];t[c++]=e.r,t[c++]=e.g,t[c++]=e.b,t[c++]=e.a}for(let e=t.length;c<e;++c)t[c]=0;return void o.uniform4fv(a,t)}case e.MFDouble:case e.MFFloat:case e.MFTime:{const t=a.array;for(u=0,l=n.length;u<l;++u)t[u]=n[u];for(let e=t.length;u<e;++u)t[u]=0;return void o.uniform1fv(a,t)}case e.MFImage:{const t=a.array;for(let e=0,i=0,r=n.length;e<r;++e){const r=n[e],s=r.array;t[i++]=r.width,t[i++]=r.height,t[i++]=r.comp;for(let e=0,n=s.length;e<n;++e)t[i++]=s[e]}return void o.uniform1iv(a,t)}case e.MFMatrix3d:case e.MFMatrix3f:{const t=a.array;for(u=0,c=0,l=n.length;u<l;++u){const e=n[u];for(let i=0;i<9;++i)t[c++]=e[i]}for(let e=t.length;c<e;++c)t[c]=0;return void o.uniformMatrix3fv(a,!1,t)}case e.MFMatrix4d:case e.MFMatrix4f:{const t=a.array;for(u=0,c=0,l=n.length;u<l;++u){const e=n[u];for(let i=0;i<16;++i)t[c++]=e[i]}for(let e=t.length;c<e;++c)t[c]=0;return void o.uniformMatrix4fv(a,!1,t)}case e.MFNode:{const i=a.locations;for(let r=0,s=n.length;r<s;++r){const s=t(e.X3DTextureNode,n[r]);s?(i[r].name=n.getName(),i[r].texture=s,this.textures.add(i[r])):this.textures.delete(i[r])}return}case e.MFRotation:{const t=a.array;for(u=0,c=0,l=n.length;u<l;++u){const e=n[u].getValue().getMatrix(i);t[c++]=e[0],t[c++]=e[1],t[c++]=e[2],t[c++]=e[3],t[c++]=e[4],t[c++]=e[5],t[c++]=e[6],t[c++]=e[7],t[c++]=e[8]}for(let e=t.length;c<e;++c)t[c]=0;return void o.uniformMatrix3fv(a,!1,t)}case e.MFString:return;case e.MFVec2d:case e.MFVec2f:{const t=a.array;for(u=0,c=0,l=n.length;u<l;++u){const e=n[u];t[c++]=e.x,t[c++]=e.y}for(let e=t.length;c<e;++c)t[c]=0;return void o.uniform2fv(a,t)}case e.MFVec3d:case e.MFVec3f:{const t=a.array;for(u=0,c=0,l=n.length;u<l;++u){const e=n[u];t[c++]=e.x,t[c++]=e.y,t[c++]=e.z}for(let e=t.length;c<e;++c)t[c]=0;return void o.uniform3fv(a,t)}case e.MFVec4d:case e.MFVec4f:{const t=a.array;for(u=0,c=0,l=n.length;u<l;++u){const e=n[u];t[c++]=e.x,t[c++]=e.y,t[c++]=e.z,t[c++]=e.w}for(let e=t.length;c<e;++c)t[c]=0;return void o.uniform4fv(a,t)}}}}(),getImagesLength:function(t){const e=t.getValue();let i=3*e.length;for(const t of e)i+=t.array.length;return i},getLocationLength:function(t,e,i){const n=i.getName();for(let i=0;;++i){if(!t.getUniformLocation(e,n+"["+i+"]"))return i}},hasFog:function(t){return this.fogNode===t||(this.fogNode=t,!1)},hasLight:function(t,e){return this.lightNodes[t]===e||(this.lightNodes[t]=e,!1)},hasTextureProjector:function(t,e){return this.projectiveTextureNodes[t]===e||(this.projectiveTextureNodes[t]=e,!1)},setLocalObjects:function(t,e){this.numClipPlanes=0,this.numLights=0,this.numProjectiveTextures=0,this.lightNodes.length=0,this.projectiveTextureNodes.length=0;for(const i of e)i.setShaderUniforms(t,this);t.uniform1i(this.x3d_NumClipPlanes,Math.min(this.numClipPlanes,this.x3d_MaxClipPlanes)),t.uniform1i(this.x3d_NumLights,Math.min(this.numLights,this.x3d_MaxLights)),t.uniform1i(this.x3d_NumProjectiveTextures,Math.min(this.numProjectiveTextures,this.x3d_MaxTextures))},setUniforms:function(){const t=new Float32Array(9);return function(e,r,s=!0){const o=r.renderer,a=r.fogNode,u=r.shapeNode,l=r.geometryContext||u.getGeometry(),c=l.geometryType,h=r.appearanceNode,d=h.getStyleProperties(c),p=s?h.getMaterial():h.getBackMaterial(),f=r.textureNode||h.getTexture(),g=r.modelViewMatrix;if(this.renderTime!==o.getRenderTime()){this.renderTime=o.getRenderTime(),e.uniform4iv(this.x3d_Viewport,o.getViewportArray()),e.uniformMatrix4fv(this.x3d_ProjectionMatrix,!1,o.getProjectionMatrixArray()),e.uniformMatrix4fv(this.x3d_CameraSpaceMatrix,!1,o.getCameraSpaceMatrixArray()),this.fogNode=null,this.numLights=0,this.numProjectiveTextures=0,this.lightNodes.length=0,this.projectiveTextureNodes.length=0;const t=o.getGlobalObjects();for(const i of t)i.setShaderUniforms(e,this,o);this.numGlobalLights=this.numLights,this.numGlobalProjectiveTextures=this.numProjectiveTextures;const n=o.getViewpoint(),r=o.getNavigationInfo();n instanceof i?e.uniform1f(this.x3d_LogarithmicFarFactor1_2,-1):e.uniform1f(this.x3d_LogarithmicFarFactor1_2,1/Math.log2(r.getFarValue(n)+1))}e.uniformMatrix4fv(this.x3d_ModelViewMatrix,!1,g),t[0]=g[0],t[3]=g[1],t[6]=g[2],t[1]=g[4],t[4]=g[5],t[7]=g[6],t[2]=g[8],t[5]=g[9],t[8]=g[10],n.prototype.inverse.call(t),e.uniformMatrix3fv(this.x3d_NormalMatrix,!1,t),this.numClipPlanes=0,this.numLights=this.numGlobalLights,this.numProjectiveTextures=this.numGlobalProjectiveTextures;for(const t of r.localObjects)t.setShaderUniforms(e,this,o);e.uniform1i(this.x3d_NumClipPlanes,Math.min(this.numClipPlanes,this.x3d_MaxClipPlanes)),e.uniform1i(this.x3d_NumLights,Math.min(this.numLights,this.x3d_MaxLights)),e.uniform1i(this.x3d_NumProjectiveTextures,Math.min(this.numProjectiveTextures,this.x3d_MaxTextures)),a&&a.setShaderUniforms(e,this),e.uniform1f(this.x3d_AlphaCutoff,h.getAlphaCutoff()),d&&d.setShaderUniforms(e,this),p.setShaderUniforms(e,this,o,h.getTextureTransformMapping(),l.textureCoordinateMapping,s),f?f.setShaderUniforms(e,this,o):e.uniform1i(this.x3d_NumTextures,0),h.getTextureTransform().setShaderUniforms(e,this),l.textureCoordinateNode.setShaderUniforms(e,this)}}(),enable:function(t,e){const i=this.getBrowser();t.useProgram(e);for(const e of this.textures){const n=e.texture,r=i.getTextureUnit(n.getTextureType());if(void 0===r)return void console.warn("Not enough combined texture units for uniform variable '"+e.name+"' available.");t.activeTexture(t.TEXTURE0+r),t.bindTexture(n.getTarget(),n.getTexture()),t.uniform1i(e,r)}},enableFloatAttrib:function(t,e,i,n,r,s){const o=t.getAttribLocation(this.getProgram(),e);-1!==o&&(t.bindBuffer(t.ARRAY_BUFFER,i),t.enableVertexAttribArray(o),t.vertexAttribPointer(o,n,t.FLOAT,!1,r,s))},enableMatrix3Attrib:function(t,e,i,n,r){const s=t.getAttribLocation(this.getProgram(),e);if(-1!==s){n=n||36,t.bindBuffer(t.ARRAY_BUFFER,i);for(let e=0;e<3;++e){const i=s+e;t.enableVertexAttribArray(i),t.vertexAttribPointer(i,3,t.FLOAT,!1,n,r+12*e)}}},enableMatrix4Attrib:function(t,e,i,n,r){const s=t.getAttribLocation(this.getProgram(),e);if(-1!==s){n=n||64,t.bindBuffer(t.ARRAY_BUFFER,i);for(let e=0;e<4;++e){const i=s+e;t.enableVertexAttribArray(i),t.vertexAttribPointer(i,4,t.FLOAT,!1,n,r+16*e)}}},enableFogDepthAttribute:function(t,e,i,n){const r=this.x3d_FogDepth;t.bindBuffer(t.ARRAY_BUFFER,e),t.enableVertexAttribArray(r),t.vertexAttribPointer(r,1,t.FLOAT,!1,i,n)},enableColorAttribute:function(t,e,i,n){const r=this.x3d_Color;t.bindBuffer(t.ARRAY_BUFFER,e),t.enableVertexAttribArray(r),t.vertexAttribPointer(r,4,t.FLOAT,!1,i,n)},colorAttributeDivisor:function(t,e){t.vertexAttribDivisor(this.x3d_Color,e)},enableTexCoordAttribute:function(t,e,i,n){for(const[r,s]of this.x3d_TexCoord)t.bindBuffer(t.ARRAY_BUFFER,e[r]),t.enableVertexAttribArray(s),t.vertexAttribPointer(s,4,t.FLOAT,!1,i,n)},texCoordAttributeDivisor:function(t,e){for(const[i,n]of this.x3d_TexCoord)t.vertexAttribDivisor(n,e)},enableNormalAttribute:function(t,e,i,n){const r=this.x3d_Normal;t.bindBuffer(t.ARRAY_BUFFER,e),t.enableVertexAttribArray(r),t.vertexAttribPointer(r,3,t.FLOAT,!1,i,n)},normalAttributeDivisor:function(t,e){t.vertexAttribDivisor(this.x3d_Normal,e)},enableVertexAttribute:function(t,e,i,n){const r=this.x3d_Vertex;t.bindBuffer(t.ARRAY_BUFFER,e),t.enableVertexAttribArray(r),t.vertexAttribPointer(r,4,t.FLOAT,!1,i,n)},vertexAttributeDivisor:function(t,e){t.vertexAttribDivisor(this.x3d_Vertex,e)},enableParticleAttribute:function(t,e,i,n,r){const s=this.x3d_Particle;t.bindBuffer(t.ARRAY_BUFFER,e),t.enableVertexAttribArray(s),t.vertexAttribPointer(s,4,t.FLOAT,!1,i,n),t.vertexAttribDivisor(s,r)},enableParticleMatrixAttribute:function(t,e,i,n,r){const s=this.x3d_ParticleMatrix;i=i||64,t.bindBuffer(t.ARRAY_BUFFER,e);for(let e=0;e<4;++e){const o=s+e;t.enableVertexAttribArray(o),t.vertexAttribPointer(o,4,t.FLOAT,!1,i,n+16*e),t.vertexAttribDivisor(o,r)}},getProgramInfo:function(){function t(t,e){return t<e?-1:t>e?1:0}const e=this.getBrowser().getContext(),i=this.getProgram(),n={attributes:[],uniforms:[],attributeCount:0,uniformCount:0},r=e.getProgramParameter(i,e.ACTIVE_UNIFORMS),s=e.getProgramParameter(i,e.ACTIVE_ATTRIBUTES),o={35664:"vec2",35665:"vec3",35666:"vec4",35667:"ivec2",35668:"ivec3",35669:"ivec4",35670:"bool",35671:"bvec2",35672:"bvec3",35673:"bvec4",35674:"mat2",35675:"mat3",35676:"mat4",35678:"sampler2D",35680:"samplerCube",5120:"byte",5121:"ubyte",5122:"short",5123:"ushort",5124:"int",5125:"uint",5126:"float"};for(let t=0;t<r;++t){const r=e.getActiveUniform(i,t);r.typeName=o[r.type],n.uniforms.push(Object.assign({},r)),n.uniformCount+=r.size}for(let t=0;t<s;++t){const r=e.getActiveAttrib(i,t);r.typeName=o[r.type],n.attributes.push(Object.assign({},r)),n.attributeCount+=r.size}return n.uniforms.sort((function(e,i){return t(e.name,i.name)})),n.attributes.sort((function(e,i){return t(e.name,i.name)})),n},printProgramInfo:function(){const t=this.getProgramInfo();console.log(this.getName()),console.table(t.attributes),console.log(this.getName(),"attributeCount",t.attributeCount),console.log(this.getName()),console.table(t.uniforms),console.log(this.getName(),"uniformCount",t.uniformCount)}},o})),define("x_ite/Components/Networking/X3DNetworkSensorNode",["x_ite/Components/Core/X3DSensorNode","x_ite/Base/X3DConstants"],(function(t,e){"use strict";function i(i){t.call(this,i),this.addType(e.X3DNetworkSensorNode)}return i.prototype=Object.assign(Object.create(t.prototype),{constructor:i}),i})),define("x_ite/Components/Networking/LoadSensor",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Networking/X3DNetworkSensorNode","x_ite/Base/X3DCast","x_ite/Base/X3DConstants"],(function(t,e,i,n,r,s){"use strict";function o(t){n.call(this,t),this.addType(s.LoadSensor),this.urlObjects=[],this.aborted=!1,this.timeOutId=void 0}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.inputOutput,"enabled",new t.SFBool(!0)),new e(s.inputOutput,"timeOut",new t.SFTime),new e(s.outputOnly,"isActive",new t.SFBool),new e(s.outputOnly,"isLoaded",new t.SFBool),new e(s.outputOnly,"progress",new t.SFFloat),new e(s.outputOnly,"loadTime",new t.SFTime),new e(s.inputOutput,"watchList",new t.MFNode)]),getTypeName:function(){return"LoadSensor"},getComponentName:function(){return"Networking"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this._enabled.addInterest("set_enabled__",this),this._timeOut.addInterest("set_timeOut__",this),this._watchList.addInterest("set_watchList__",this),this.set_watchList__()},set_enabled__:function(){this._enabled.getValue()?this.reset():(this.abort(),this.remove())},set_timeOut__:function(){this._isActive.getValue()&&(this.clearTimeout(),this.aborted=!1,this._timeOut.getValue()>0&&(this.timeOutId=setTimeout(this.abort.bind(this),1e3*this._timeOut.getValue())))},set_watchList__:function(){this.reset()},set_loadState__:function(t){switch(t.checkLoadState()){case s.NOT_STARTED_STATE:break;case s.IN_PROGRESS_STATE:case s.COMPLETE_STATE:case s.FAILED_STATE:this.count()}},count:function(){const t=this.urlObjects;let e=0,i=0;for(const n of t)e+=n.checkLoadState()==s.COMPLETE_STATE,i+=n.checkLoadState()==s.FAILED_STATE;const n=e==t.length,r=e/t.length;this.aborted||i||n?(this.clearTimeout(),this._isActive=!1,this._isLoaded=n,this._progress=r,n&&(this._loadTime=this.getBrowser().getCurrentTime())):this._isActive.getValue()?this._progress=r:(this._isActive=!0,this._progress=r,this.set_timeOut__())},abort:function(){this.clearTimeout(),this.aborted=!0,this._enabled.getValue()&&this.count()},reset:function(){if(this.remove(),this._enabled.getValue()){const t=this.urlObjects;for(const e of this._watchList){const i=r(s.X3DUrlObject,e);i&&(t.push(i),i._loadState.addInterest("set_loadState__",this,i))}this.count()}},remove:function(){this.clearTimeout();const t=this.urlObjects;for(const e of t)e._loadState.removeInterest("set_loadState__",this);t.length=0},clearTimeout:function(){clearTimeout(this.timeOutId),this.timeOutId=void 0}}),o})),define("x_ite/Components/Shaders/ComposedShader",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Shaders/X3DShaderNode","x_ite/Components/Shaders/X3DProgrammableShaderObject","x_ite/Components/Networking/LoadSensor","x_ite/Base/X3DCast","x_ite/Base/X3DConstants"],(function(t,e,i,n,r,s,o,a){"use strict";function u(t){n.call(this,t),r.call(this,t),this.addType(a.ComposedShader),this.loadSensor=new s(t),this.transformFeedbackVaryings=[]}return u.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:u,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(a.inputOutput,"metadata",new t.SFNode),new e(a.inputOnly,"activate",new t.SFBool),new e(a.outputOnly,"isSelected",new t.SFBool),new e(a.outputOnly,"isValid",new t.SFBool),new e(a.initializeOnly,"language",new t.SFString),new e(a.inputOutput,"parts",new t.MFNode)]),wireframe:!1,getTypeName:function(){return"ComposedShader"},getComponentName:function(){return"Shaders"},getContainerField:function(){return"shaders"},initialize:function(){n.prototype.initialize.call(this),r.prototype.initialize.call(this),this.isLive().addInterest("set_live__",this),this._parts.addFieldInterest(this.loadSensor._watchList),this.loadSensor._isLoaded.addInterest("set_loaded__",this),this.loadSensor._watchList=this._parts,this.loadSensor.setPrivate(!0),this.loadSensor.setup()},addUserDefinedField:function(t,e,i){this.isInitialized()&&this.isLive().getValue()&&this.isValid()&&this.removeShaderFields(),n.prototype.addUserDefinedField.call(this,t,e,i),this.isInitialized()&&this.isLive().getValue()&&this.isValid()&&this.addShaderFields(this.program)},removeUserDefinedField:function(t){this.isInitialized()&&this.isLive().getValue()&&this.isValid()&&this.removeShaderFields(),n.prototype.removeUserDefinedField.call(this,t),this.isInitialized()&&this.isLive().getValue()&&this.isValid()&&this.addShaderFields(this.program)},setTransformFeedbackVaryings:function(t){this.transformFeedbackVaryings=t},getProgram:function(){return this.program},set_live__:function(){this.isLive().getValue()?this.isValid()&&this.addShaderFields(this.program):this.isValid()&&this.removeShaderFields()},set_loaded__:function(){if(this.loadSensor._isLoaded.getValue()){const t=this.getBrowser().getContext(),e=t.createProgram();this.isValid()&&this.removeShaderFields(),t.deleteProgram(this.program),this.program=e;for(const i of this._parts){const n=o(a.ShaderPart,i);n&&t.attachShader(e,n.getShader())}this.transformFeedbackVaryings.length&&t.transformFeedbackVaryings(e,this.transformFeedbackVaryings,t.INTERLEAVED_ATTRIBS),t.linkProgram(e),t.getProgramParameter(e,t.LINK_STATUS)?(this.getDefaultUniformsAndAttributes(e),this.setValid(!0)):(this._parts.length&&console.warn("Couldn't initialize "+this.getTypeName()+" '"+this.getName()+"': "+t.getProgramInfoLog(e)),this.setValid(!1)),this.isValid()&&this.addShaderFields(this.program)}else this.setValid(!1)},set_field__:function(t){this.isValid()&&r.prototype.set_field__.call(this,t,this.program)},enable:function(t){r.prototype.enable.call(this,t,this.program)}}),u})),define("text!assets/shaders/Types.glsl",[],(function(){return"struct x3d_FogParameters {\n   mediump int   type;\n   mediump vec3  color;\n   mediump float visibilityRange;\n   mediump mat3  matrix;\n};\n\n//uniform x3d_FogParameters x3d_Fog;\n\nstruct x3d_LightSourceParameters {\n   mediump int   type;\n   mediump vec3  color;\n   mediump float intensity;\n   mediump float ambientIntensity;\n   mediump vec3  attenuation;\n   mediump vec3  location;\n   mediump vec3  direction;\n   mediump float radius;\n   mediump float beamWidth;\n   mediump float cutOffAngle;\n   mediump mat3  matrix;\n   #if defined (X3D_SHADOWS)\n   mediump vec3  shadowColor;\n   mediump float shadowIntensity;\n   mediump float shadowBias;\n   mediump mat4  shadowMatrix;\n   mediump int   shadowMapSize;\n   #endif\n};\n\n//uniform x3d_LightSourceParameters x3d_LightSource [x3d_MaxLights];\n\nstruct x3d_PointPropertiesParameters\n{\n   mediump float pointSizeScaleFactor;\n   mediump float pointSizeMinValue;\n   mediump float pointSizeMaxValue;\n   mediump vec3  pointSizeAttenuation;\n};\n\n//uniform x3d_PointPropertiesParameters x3d_PointProperties;\n\nstruct x3d_LinePropertiesParameters\n{\n   bool          applied;\n   mediump int   linetype;\n   mediump float lineStippleScale;\n   sampler2D     texture;\n};\n\n//uniform x3d_LinePropertiesParameters x3d_LineProperties;\n\nstruct x3d_FillPropertiesParameters\n{\n   bool         filled;\n   bool         hatched;\n   mediump vec3 hatchColor;\n   sampler2D    texture;\n};\n\n//uniform x3d_FillPropertiesParameters x3d_FillProperties;\n\nstruct x3d_UnlitMaterialParameters\n{\n   mediump vec3  emissiveColor;\n   mediump float normalScale;\n   mediump float transparency;\n};\n\n//uniform x3d_UnlitMaterialParameters x3d_Material;\n\nstruct x3d_MaterialParameters\n{\n   mediump float ambientIntensity;\n   mediump vec3  diffuseColor;\n   mediump vec3  specularColor;\n   mediump vec3  emissiveColor;\n   mediump float shininess;\n   mediump float occlusionStrength;\n   mediump float normalScale;\n   mediump float transparency;\n};\n\n//uniform x3d_MaterialParameters x3d_Material;\n\nstruct x3d_PhysicalMaterialParameters\n{\n   mediump vec3  baseColor;\n   mediump vec3  emissiveColor;\n   mediump float metallic;\n   mediump float roughness;\n   mediump float occlusionStrength;\n   mediump float normalScale;\n   mediump float transparency;\n};\n\n//uniform x3d_PhysicalMaterialParameters x3d_Material;\n\n#if defined (X3D_AMBIENT_TEXTURE)\nstruct x3d_AmbientTextureParameters\n{\n   mediump int         textureTransformMapping;\n   mediump int         textureCoordinateMapping;\n   #if defined (X3D_AMBIENT_TEXTURE_2D)\n   mediump sampler2D   texture2D;\n   #endif\n   #if defined (X3D_AMBIENT_TEXTURE_3D) && __VERSION__ != 100\n   mediump sampler3D   texture3D;\n   #endif\n   #if defined (X3D_AMBIENT_TEXTURE_CUBE)\n   mediump samplerCube textureCube;\n   #endif\n};\n//uniform x3d_AmbientTextureParameters x3d_AmbientTexture;\n#endif\n\n#if defined (X3D_DIFFUSE_TEXTURE)\nstruct x3d_DiffuseTextureParameters\n{\n   mediump int         textureTransformMapping;\n   mediump int         textureCoordinateMapping;\n   #if defined (X3D_DIFFUSE_TEXTURE_2D)\n   mediump sampler2D   texture2D;\n   #endif\n   #if defined (X3D_DIFFUSE_TEXTURE_3D) && __VERSION__ != 100\n   mediump sampler3D   texture3D;\n   #endif\n   #if defined (X3D_DIFFUSE_TEXTURE_CUBE)\n   mediump samplerCube textureCube;\n   #endif\n};\n//uniform x3d_DiffuseTextureParameters x3d_DiffuseTexture;\n#endif\n\n#if defined (X3D_SPECULAR_TEXTURE)\nstruct x3d_SpecularTextureParameters\n{\n   mediump int         textureTransformMapping;\n   mediump int         textureCoordinateMapping;\n   #if defined (X3D_SPECULAR_TEXTURE_2D)\n   mediump sampler2D   texture2D;\n   #endif\n   #if defined (X3D_SPECULAR_TEXTURE_3D) && __VERSION__ != 100\n   mediump sampler3D   texture3D;\n   #endif\n   #if defined (X3D_SPECULAR_TEXTURE_CUBE)\n   mediump samplerCube textureCube;\n   #endif\n};\n//uniform x3d_SpecularTextureParameters x3d_SpecularTexture;\n#endif\n\n#if defined (X3D_EMISSIVE_TEXTURE)\nstruct x3d_EmissiveTextureParameters\n{\n   mediump int         textureTransformMapping;\n   mediump int         textureCoordinateMapping;\n   #if defined (X3D_EMISSIVE_TEXTURE_2D)\n   mediump sampler2D   texture2D;\n   #endif\n   #if defined (X3D_EMISSIVE_TEXTURE_3D) && __VERSION__ != 100\n   mediump sampler3D   texture3D;\n   #endif\n   #if defined (X3D_EMISSIVE_TEXTURE_CUBE)\n   mediump samplerCube textureCube;\n   #endif\n};\n//uniform x3d_EmissiveTextureParameters x3d_EmissiveTexture;\n#endif\n\n#if defined (X3D_SHININESS_TEXTURE)\nstruct x3d_ShininessTextureParameters\n{\n   mediump int         textureTransformMapping;\n   mediump int         textureCoordinateMapping;\n   #if defined (X3D_SHININESS_TEXTURE_2D)\n   mediump sampler2D   texture2D;\n   #endif\n   #if defined (X3D_SHININESS_TEXTURE_3D) && __VERSION__ != 100\n   mediump sampler3D   texture3D;\n   #endif\n   #if defined (X3D_SHININESS_TEXTURE_CUBE)\n   mediump samplerCube textureCube;\n   #endif\n};\n//uniform x3d_ShininessTextureParameters x3d_ShininessTexture;\n#endif\n\n#if defined (X3D_BASE_TEXTURE)\nstruct x3d_BaseTextureParameters\n{\n   mediump int         textureTransformMapping;\n   mediump int         textureCoordinateMapping;\n   #if defined (X3D_BASE_TEXTURE_2D)\n   mediump sampler2D   texture2D;\n   #endif\n   #if defined (X3D_BASE_TEXTURE_3D) && __VERSION__ != 100\n   mediump sampler3D   texture3D;\n   #endif\n   #if defined (X3D_BASE_TEXTURE_CUBE)\n   mediump samplerCube textureCube;\n   #endif\n};\n//uniform x3d_BaseTextureParameters x3d_BaseTexture;\n#endif\n\n#if defined (X3D_METALLIC_ROUGHNESS_TEXTURE)\nstruct x3d_MetallicRoughnessTextureParameters\n{\n   mediump int         textureTransformMapping;\n   mediump int         textureCoordinateMapping;\n   #if defined (X3D_METALLIC_ROUGHNESS_TEXTURE_2D)\n   mediump sampler2D   texture2D;\n   #endif\n   #if defined (X3D_METALLIC_ROUGHNESS_TEXTURE_3D) && __VERSION__ != 100\n   mediump sampler3D   texture3D;\n   #endif\n   #if defined (X3D_METALLIC_ROUGHNESS_TEXTURE_CUBE)\n   mediump samplerCube textureCube;\n   #endif\n};\n//uniform x3d_MetallicRoughnessTextureParameters x3d_MetallicRoughnessTexture;\n#endif\n\n#if defined (X3D_OCCLUSION_TEXTURE)\nstruct x3d_OcclusionTextureParameters\n{\n   mediump int         textureTransformMapping;\n   mediump int         textureCoordinateMapping;\n   #if defined (X3D_OCCLUSION_TEXTURE_2D)\n   mediump sampler2D   texture2D;\n   #endif\n   #if defined (X3D_OCCLUSION_TEXTURE_3D) && __VERSION__ != 100\n   mediump sampler3D   texture3D;\n   #endif\n   #if defined (X3D_OCCLUSION_TEXTURE_CUBE)\n   mediump samplerCube textureCube;\n   #endif\n};\n//uniform x3d_OcclusionTextureParameters x3d_OcclusionTexture;\n#endif\n\n#if defined (X3D_NORMAL_TEXTURE)\nstruct x3d_NormalTextureParameters\n{\n   mediump int         textureTransformMapping;\n   mediump int         textureCoordinateMapping;\n   #if defined (X3D_NORMAL_TEXTURE_2D)\n   mediump sampler2D   texture2D;\n   #endif\n   #if defined (X3D_NORMAL_TEXTURE_3D) && __VERSION__ != 100\n   mediump sampler3D   texture3D;\n   #endif\n   #if defined (X3D_NORMAL_TEXTURE_CUBE)\n   mediump samplerCube textureCube;\n   #endif\n};\n//uniform x3d_NormalTextureParameters x3d_NormalTexture;\n#endif\n\nstruct x3d_MultiTextureParameters\n{\n   mediump int mode;\n   mediump int alphaMode;\n   mediump int source;\n   mediump int function;\n};\n\n//uniform x3d_MultiTextureParameters x3d_MultiTexture [x3d_MaxTextures];\n\nstruct x3d_TextureCoordinateGeneratorParameters\n{\n   mediump int   mode;\n   mediump float parameter [6];\n};\n\n//uniform x3d_TextureCoordinateGeneratorParameters x3d_TextureCoordinateGenerator [x3d_MaxTextures];\n"})),define("x_ite/Browser/Texturing/MultiTextureModeType",[],(function(){"use strict";let t=0;return{REPLACE:t++,MODULATE:t++,MODULATE2X:t++,MODULATE4X:t++,ADD:t++,ADDSIGNED:t++,ADDSIGNED2X:t++,ADDSMOOTH:t++,SUBTRACT:t++,BLENDDIFFUSEALPHA:t++,BLENDTEXTUREALPHA:t++,BLENDFACTORALPHA:t++,BLENDCURRENTALPHA:t++,MODULATEALPHA_ADDCOLOR:t++,MODULATEINVALPHA_ADDCOLOR:t++,MODULATEINVCOLOR_ADDALPHA:t++,DOTPRODUCT3:t++,SELECTARG1:t++,SELECTARG2:t++,OFF:t++}})),define("x_ite/Browser/Texturing/MultiTextureSourceType",[],(function(){"use strict";let t=0;return{DEFAULT:t++,DIFFUSE:t++,SPECULAR:t++,FACTOR:t++}})),define("x_ite/Browser/Texturing/MultiTextureFunctionType",[],(function(){"use strict";let t=0;return{DEFAULT:t++,COMPLEMENT:t++,ALPHAREPLICATE:t++}})),define("x_ite/Browser/Texturing/TextureCoordinateGeneratorModeType",[],(function(){"use strict";let t=0;return{NONE:t++,SPHERE:t++,CAMERASPACENORMAL:t++,CAMERASPACEPOSITION:t++,CAMERASPACEREFLECTIONVECTOR:t++,SPHERE_LOCAL:t++,COORD:t++,COORD_EYE:t++,NOISE:t++,NOISE_EYE:t++,SPHERE_REFLECT:t++,SPHERE_REFLECT_LOCAL:t++}})),define("x_ite/Browser/Shaders/Shader",["text!assets/shaders/Types.glsl","x_ite/Browser/Texturing/MultiTextureModeType","x_ite/Browser/Texturing/MultiTextureSourceType","x_ite/Browser/Texturing/MultiTextureFunctionType","x_ite/Browser/Texturing/TextureCoordinateGeneratorModeType"],(function(t,e,i,n,r){"use strict";function s(t,e,i){-1!==t.indexOf(e)&&console.warn("Use of '"+e+"' is depreciated, use '"+i+"' instead. See https://create3000.github.io/x_ite/Custom-Shaders.html.")}return{getShaderSource:function(o,a,u,l){const c="\\s+|/\\*[\\s\\S]*?\\*/|//.*?\\n",h="#line\\s+.*?\\n|#if\\s+.*?\\n|#elif\\s+.*?\\n|#ifdef\\s+.*?\\n|#ifndef\\s+.*?\\n|#else.*?\\n|#endif.*?\\n|#define\\s+(?:[^\\n\\\\]|\\\\[^\\r\\n]|\\\\\\r?\\n)*\\n|#undef\\s+.*?\\n|#pragma\\s+.*?\\n",d=new RegExp("^((?:"+c+"|"+h+")*(?:#version\\s+.*?\\n)?(?:"+c+"|"+h+"|#extension\\s+.*?\\n)*)([\\s\\S]*)$"),p=u.match(d);if(!p)return u;let f="";f+="#define X_ITE\n",(o.getVersion()>=2||o.getExtension("WEBGL_depth_texture"))&&(f+="#define X3D_DEPTH_TEXTURE\n"),a.getRenderingProperty("LogarithmicDepthBuffer")&&(f+="#define X3D_LOGARITHMIC_DEPTH_BUFFER\n"),a.getMultiTexturing()&&(f+="#define X3D_MULTI_TEXTURING\n"),a.getProjectiveTextureMapping()&&(f+="#define X3D_PROJECTIVE_TEXTURE_MAPPING\n");for(const t of l)f+="#define "+t+"\n";let g="";g+="#define x3d_None 0\n",g+="#define x3d_Points      0\n",g+="#define x3d_Lines       1\n",g+="#define x3d_Geometry2D  2\n",g+="#define x3d_Geometry3D  3\n",g+="#define x3d_MaxClipPlanes  "+a.getMaxClipPlanes()+"\n",g+="#define x3d_LinearFog        1\n",g+="#define x3d_ExponentialFog   2\n",g+="#define x3d_Exponential2Fog  3\n",g+="#define x3d_MaxLights         "+a.getMaxLights()+"\n",g+="#define x3d_DirectionalLight  1\n",g+="#define x3d_PointLight        2\n",g+="#define x3d_SpotLight         3\n",g+="#define x3d_MaxTextures      "+a.getMaxTextures()+"\n",g+="#define x3d_TextureType2D    2\n",g+="#define x3d_TextureType3D    3\n",g+="#define x3d_TextureTypeCube  4\n",g+="#define x3d_Replace                   "+e.REPLACE+"\n",g+="#define x3d_Modulate                  "+e.MODULATE+"\n",g+="#define x3d_Modulate2X                "+e.MODULATE2X+"\n",g+="#define x3d_Modulate4X                "+e.MODULATE4X+"\n",g+="#define x3d_Add                       "+e.ADD+"\n",g+="#define x3d_AddSigned                 "+e.ADDSIGNED+"\n",g+="#define x3d_AddSigned2X               "+e.ADDSIGNED2X+"\n",g+="#define x3d_AddSmooth                 "+e.ADDSMOOTH+"\n",g+="#define x3d_Subtract                  "+e.SUBTRACT+"\n",g+="#define x3d_BlendDiffuseAlpha         "+e.BLENDDIFFUSEALPHA+"\n",g+="#define x3d_BlendTextureAlpha         "+e.BLENDTEXTUREALPHA+"\n",g+="#define x3d_BlendFactorAlpha          "+e.BLENDFACTORALPHA+"\n",g+="#define x3d_BlendCurrentAlpha         "+e.BLENDCURRENTALPHA+"\n",g+="#define x3d_ModulateAlphaAddColor     "+e.MODULATEALPHA_ADDCOLOR+"\n",g+="#define x3d_ModulateInvAlphaAddColor  "+e.MODULATEINVALPHA_ADDCOLOR+"\n",g+="#define x3d_ModulateInvColorAddAlpha  "+e.MODULATEINVCOLOR_ADDALPHA+"\n",g+="#define x3d_DotProduct3               "+e.DOTPRODUCT3+"\n",g+="#define x3d_SelectArg1                "+e.SELECTARG1+"\n",g+="#define x3d_SelectArg2                "+e.SELECTARG2+"\n",g+="#define x3d_Off                       "+e.OFF+"\n",g+="#define x3d_Diffuse  "+i.DIFFUSE+"\n",g+="#define x3d_Specular "+i.SPECULAR+"\n",g+="#define x3d_Factor   "+i.FACTOR+"\n",g+="#define x3d_Complement     "+n.COMPLEMENT+"\n",g+="#define x3d_AlphaReplicate "+n.ALPHAREPLICATE+"\n",g+="#define x3d_Sphere                      "+r.SPHERE+"\n",g+="#define x3d_CameraSpaceNormal           "+r.CAMERASPACENORMAL+"\n",g+="#define x3d_CameraSpacePosition         "+r.CAMERASPACEPOSITION+"\n",g+="#define x3d_CameraSpaceReflectionVector "+r.CAMERASPACEREFLECTIONVECTOR+"\n",g+="#define x3d_SphereLocal                 "+r.SPHERE_LOCAL+"\n",g+="#define x3d_Coord                       "+r.COORD+"\n",g+="#define x3d_CoordEye                    "+r.COORD_EYE+"\n",g+="#define x3d_Noise                       "+r.NOISE+"\n",g+="#define x3d_NoiseEye                    "+r.NOISE_EYE+"\n",g+="#define x3d_SphereReflect               "+r.SPHERE_REFLECT+"\n",g+="#define x3d_SphereReflectLocal          "+r.SPHERE_REFLECT_LOCAL+"\n",g+="#define x3d_GeometryPoints  0\n",g+="#define x3d_GeometryLines   1\n",g+="#define x3d_NoneClipPlane   vec4 (88.0, 51.0, 68.0, 33.0)\n",g+="#define x3d_NoneFog         0\n",g+="#define x3d_NoneLight       0\n",g+="#define x3d_NoneTexture     0\n",s(u,"x3d_GeometryPoints","x3d_Points"),s(u,"x3d_GeometryLines","x3d_Lines"),s(u,"x3d_NoneClipPlane","x3d_NumClipPlanes"),s(u,"x3d_NoneFog","x3d_None"),s(u,"x3d_NoneLight","x3d_NumLights"),s(u,"x3d_NoneTexture","x3d_NumTextures");const m=u.match(/\s*precision\s+(lowp|mediump|highp)\s+float\s*;/),_=u.match(/\s*precision\s+(lowp|mediump|highp)\s+int\s*;/),y=m?m[1]:"mediump",x=_?_[1]:"mediump",w=t.replace(/mediump\s+(float|vec2|vec3|mat3|mat4)/g,y+" $1").replace(/mediump\s+(int)/g,x+" $1"),b=(p[1].match(/\n/g)||[]).length+1;return p[1]+f+g+w+"#line "+(b+1)+" -1\n"+p[2]}}})),define("x_ite/Parser/XMLParser",["jquery","x_ite/Base/X3DField","x_ite/Base/X3DBaseNode","x_ite/Components/Core/X3DPrototypeInstance","x_ite/Fields","x_ite/Parser/X3DParser","x_ite/Parser/VRMLParser","x_ite/Parser/HTMLSupport","x_ite/Prototype/X3DExternProtoDeclaration","x_ite/Prototype/X3DProtoDeclaration","x_ite/Base/X3DConstants"],(function(t,e,i,n,r,s,o,a,u,l,c){"use strict";const h=Symbol.for("X_ITE.dom"),d={initializeOnly:c.initializeOnly,inputOnly:c.inputOnly,outputOnly:c.outputOnly,inputOutput:c.inputOutput};function p(t){s.call(this,t),this.protoDeclarations=[],this.parents=[],this.parser=new o(t),this.url=new r.MFString;try{this.setUnits(this.getScene().getMetaData("generator")),this.parser.setUnits(this.getUnits())}catch(t){}}p.prototype=Object.assign(Object.create(s.prototype),{constructor:p,isValid:function(){return this.input instanceof XMLDocument||this.input instanceof HTMLElement||null===this.input},getInput:function(){return this.input},setInput(e){try{"string"==typeof e&&(e=t.parseXML(e)),this.input=e}catch(t){this.input=void 0}},parseIntoScene:function(t,e){this.scene[h]=this.input,this.success=t,this.error=e,this.getScene().setEncoding("XML"),this.getScene().setProfile(this.getBrowser().getProfile("Full")),this.xmlElement(this.input)},parseIntoNode:function(t,e){this.pushExecutionContext(t.getExecutionContext()),this.pushParent(t),this.childElement(e),this.popParent(),this.popExecutionContext()},xmlElement:function(e){if(null===e&&this.success)return this.success(this.getScene());switch(e.nodeName){case"#document":var i=t(e).children("X3D");if(i.length)for(var n=0;n<i.length;++n)this.x3dElement(i[n]);else this.success?require(this.getProviderUrls(),function(){try{this.childrenElements(e),this.success(this.getScene())}catch(t){this.error&&this.error(t)}}.bind(this),function(t){this.error&&this.error(t)}.bind(this)):this.childrenElements(e);break;case"X3D":this.x3dElement(e);break;case"Scene":case"SCENE":this.success?require(this.getProviderUrls(),function(){try{this.sceneElement(e),this.success(this.getScene())}catch(t){this.error&&this.error(t)}}.bind(this),function(t){this.error&&this.error(t)}.bind(this)):this.sceneElement(e);break;default:this.success?require(this.getProviderUrls(),function(){try{this.childrenElements(e),this.success(this.getScene())}catch(t){this.error&&this.error(t)}}.bind(this),function(t){this.error&&this.error(t)}.bind(this)):this.childrenElements(e)}},x3dElement:function(t){try{var e=t.getAttribute("profile"),i=this.getBrowser().getProfile(e||"Full");this.getScene().setProfile(i)}catch(t){console.error(t)}var n=t.getAttribute("version");n&&this.getScene().setSpecificationVersion(n);for(var r=t.childNodes,s=0;s<r.length;++s)this.x3dElementChildHead(r[s]);if(this.success)require(this.getProviderUrls(),function(){try{for(var t=0;t<r.length;++t)this.x3dElementChildScene(r[t]);this.success(this.getScene())}catch(t){this.error&&this.error(t)}}.bind(this),function(t){this.error&&this.error(t)}.bind(this));else for(s=0;s<r.length;++s)this.x3dElementChildScene(r[s])},x3dElementChildHead:function(t){switch(t.nodeName){case"head":case"HEAD":return void this.headElement(t)}},x3dElementChildScene:function(t){switch(t.nodeName){case"Scene":case"SCENE":return void this.sceneElement(t)}},headElement:function(t){for(var e=t.childNodes,i=0;i<e.length;++i)this.headElementChild(e[i]);try{this.setUnits(this.getScene().getMetaData("generator")),this.parser.setUnits(this.getUnits())}catch(t){}},headElementChild:function(t){switch(t.nodeName){case"component":case"COMPONENT":return void this.componentElement(t);case"unit":case"UNIT":return void this.unitElement(t);case"meta":case"META":return void this.metaElement(t)}},componentElement:function(t){try{var e=t.getAttribute("name"),i=parseInt(t.getAttribute("level"));if(null===e)return console.warn("XML Parser Error: Bad component statement: Expected name attribute.");if(null===i)return console.warn("XML Parser Error: Bad component statement: Expected level attribute.");var n=this.getBrowser().getComponent(e,i);this.getScene().addComponent(n)}catch(t){console.log(t.message)}},unitElement:function(t){var e=t.getAttribute("category"),i=t.getAttribute("name"),n=t.getAttribute("conversionFactor");return null===e?console.warn("XML Parser Error: Bad unit statement: Expected category attribute."):null===i?console.warn("XML Parser Error: Bad unit statement: Expected name attribute."):null===n?console.warn("XML Parser Error: Bad unit statement: Expected conversionFactor attribute."):void this.getScene().updateUnit(e,i,parseFloat(n))},metaElement:function(t){var e=t.getAttribute("name"),i=t.getAttribute("content");return null===e?console.warn("XML Parser Error: Bad meta statement: Expected name attribute."):null===i?console.warn("XML Parser Error: Bad meta statement: Expected content attribute."):void this.getScene().setMetaData(e,i)},sceneElement:function(t){this.childrenElements(t)},childrenElements:function(t){for(var e=t.childNodes,i=0;i<e.length;++i)this.childElement(e[i])},childElement:function(t){switch(t.nodeName){case"#comment":case"#text":return;case"#cdata-section":return void this.cdataNode(t);case"ExternProtoDeclare":case"EXTERNPROTODECLARE":return void this.externProtoDeclareElement(t);case"ProtoDeclare":case"PROTODECLARE":return void this.protoDeclareElement(t);case"IS":return void this.isElement(t);case"ProtoInstance":case"PROTOINSTANCE":return void this.protoInstanceElement(t);case"fieldValue":case"FIELDVALUE":return void this.fieldValueElement(t);case"field":case"FIELD":return void this.fieldElement(t);case"ROUTE":return void this.routeElement(t);case"IMPORT":return void this.importElement(t);case"EXPORT":return void this.exportElement(t);default:return void this.nodeElement(t)}},externProtoDeclareElement:function(t){var e=t.getAttribute("name");if(this.id(e)){var i=t.getAttribute("url");if(null===i)return console.warn("XML Parser Error: Bad ExternProtoDeclare statement: Expected url attribute.");this.parser.setInput(i),o.prototype.sfstringValues.call(this.parser,this.url);var n=new u(this.getExecutionContext(),this.url);this.pushParent(n),this.protoInterfaceElement(t),this.popParent(),n.setup();try{const t=this.getExecutionContext().getExternProtoDeclaration(e);this.getExecutionContext().updateExternProtoDeclaration(this.getExecutionContext().getUniqueExternProtoName(e),t)}catch(t){}this.getExecutionContext().updateExternProtoDeclaration(e,n)}},protoDeclareElement:function(t){var e=t.getAttribute("name");if(this.id(e)){for(var i=new l(this.getExecutionContext()),n=t.childNodes,r=0;r<n.length;++r){switch((s=n[r]).nodeName){case"ProtoInterface":case"PROTOINTERFACE":this.pushParent(i),this.protoInterfaceElement(s),this.popParent();break;default:continue}break}for(r=0;r<n.length;++r){var s;switch((s=n[r]).nodeName){case"ProtoBody":case"PROTOBODY":this.pushPrototype(i),this.pushExecutionContext(i.getBody()),this.pushParent(i),this.protoBodyElement(s),this.popParent(),this.popExecutionContext(),this.popPrototype();break;default:continue}break}i.setup();try{const t=this.getExecutionContext().getProtoDeclaration(e);this.getExecutionContext().updateProtoDeclaration(this.getExecutionContext().getUniqueProtoName(e),t)}catch(t){}this.getExecutionContext().updateProtoDeclaration(e,i)}},protoInterfaceElement:function(t){for(var e=t.childNodes,i=0;i<e.length;++i)this.protoInterfaceElementChild(e[i])},protoInterfaceElementChild:function(t){switch(t.nodeName){case"field":case"FIELD":return void this.fieldElement(t)}},fieldElement:function(t){try{if(0===this.getParents().length)return;var e=this.getParent();if(!(e instanceof i))return;if(!e.canUserDefinedFields())return;var n=d[t.getAttribute("accessType")];void 0===n&&(n=c.initializeOnly);var s=r[t.getAttribute("type")];if(void 0===s)return;var o=t.getAttribute("name");if(!this.id(o))return;var a=new s;n&c.initializeOnly&&(this.fieldValue(a,t.getAttribute("value")),this.pushParent(a),this.childrenElements(t),this.popParent()),e.addUserDefinedField(n,o,a)}catch(t){}},protoBodyElement:function(t){this.childrenElements(t)},isElement:function(t){if(this.isInsideProtoDefinition())for(var e=t.childNodes,i=0;i<e.length;++i)this.isElementChild(e[i])},isElementChild:function(t){switch(t.nodeName){case"connect":case"CONNECT":return void this.connectElement(t)}},connectElement:function(t){var e=t.getAttribute("nodeField"),n=t.getAttribute("protoField");if(null===e)return console.warn("XML Parser Error: Bad connect statement: Expected nodeField attribute.");if(null===n)return console.warn("XML Parser Error: Bad connect statement: Expected protoField attribute.");try{if(0===this.getParents().length)return;var r=this.getParent(),s=this.getPrototype();if(!(r instanceof i))return;var o=r.getField(e),a=s.getField(n);if(o.getType()!==a.getType())throw new Error("Field '"+o.getName()+"' and '"+a.getName()+"' in PROTO "+this.proto.getName()+" have different types.");if(!a.isReference(o.getAccessType()))throw new Error("Field '"+o.getName()+"' and '"+a.getName()+"' in PROTO "+s.getName()+" are incompatible as an IS mapping.");o.addReference(a)}catch(t){console.warn("XML Parser Error: Couldn't create IS reference: "+t.message)}},protoInstanceElement:function(t){try{if(this.useAttribute(t))return;var e=t.getAttribute("name");if(this.id(e)){var i=this.getExecutionContext().createProto(e,!1);if(!i)throw new Error("Unknown proto or externproto type '"+e+"'.");t.x3d=i,this.defAttribute(t,i),this.addNode(t,i),this.pushParent(i),this.childrenElements(t),this.isInsideProtoDefinition()||i.setup(),this.popParent()}}catch(t){console.warn("XML Parser Error: ",t.message)}},fieldValueElement:function(t){try{if(0===this.getParents().length)return;var e=this.getParent(),i=t.getAttribute("name");if(!(e instanceof n))return;if(!this.id(i))return;var r=e.getField(i);r.getAccessType()&c.initializeOnly&&(r.getType()===c.MFNode&&(r.length=0),this.fieldValue(r,t.getAttribute("value")),this.pushParent(r),this.childrenElements(t),this.popParent())}catch(t){console.warn("XML Parser Error: Couldn't assign field value: "+t.message)}},nodeElement:function(t){try{if(this.useAttribute(t))return;var e=this.getExecutionContext().createNode(this.nodeNameToCamelCase(t.nodeName),!1);if(!e)throw new Error("Unknown node type '"+t.nodeName+"', you probably have insufficient component/profile statements.");t.x3d=e,this.defAttribute(t,e),this.addNode(t,e),this.pushParent(e),this.nodeAttributes(t,e),this.childrenElements(t),this.isInsideProtoDefinition()||e.setup(),this.popParent()}catch(e){if("NULL"==t.nodeName)return void this.addNode(t,null);console.error(e),console.error("XML Parser Error: "+e.message)}},routeElement:function(t){try{var e=t.getAttribute("fromNode"),i=t.getAttribute("fromField"),n=t.getAttribute("toNode"),r=t.getAttribute("toField");if(null===e)throw new Error("Bad ROUTE statement: Expected fromNode attribute.");if(null===i)throw new Error("Bad ROUTE statement: Expected fromField attribute.");if(null===n)throw new Error("Bad ROUTE statement: Expected toNode attribute.");if(null===r)throw new Error("Bad ROUTE statement: Expected toField attribute.");var s=this.getExecutionContext(),o=s.getLocalNode(e),a=s.getLocalNode(n),u=s.addRoute(o,i,a,r);t.x3d=u}catch(t){console.error(t),console.warn("XML Parser Error: "+t.message)}},importElement:function(t){try{var e=t.getAttribute("inlineDEF"),i=t.getAttribute("importedDEF")||t.getAttribute("exportedDEF"),n=t.getAttribute("AS");if(null===e)throw new Error("Bad IMPORT statement: Expected inlineDEF attribute.");if(null===i)throw new Error("Bad IMPORT statement: Expected importedDEF attribute.");n||(n=i);var r=this.getExecutionContext().getNamedNode(e);this.getExecutionContext().updateImportedNode(r,i,n)}catch(t){console.warn("XML Parser Error: "+t.message)}},exportElement:function(t){try{if(this.getScene()!==this.getExecutionContext())return void console.warn("XML Parser Error: Export statement not allowed here.");var e=t.getAttribute("localDEF"),i=t.getAttribute("AS");if(null===e)throw new Error("Bad EXPORT statement: Expected localDEF attribute.");i||(i=e);var n=this.getExecutionContext().getLocalNode(e);this.getScene().updateExportedNode(i,n)}catch(t){console.warn("XML Parser Error: "+t.message)}},cdataNode:function(t){if(0!==this.getParents().length){var e=this.getParent();if(e instanceof i){var n=e.getSourceText();n&&n.push(t.data)}}},useAttribute:function(t){try{var e=t.getAttribute("USE");if(this.id(e)){var i=this.getExecutionContext().getNamedNode(e);return this.addNode(t,i.getValue()),!0}}catch(t){console.warn("Invalid USE name: "+t.message)}return!1},defAttribute:function(t,e){try{var i=t.getAttribute("DEF");if(i){try{var n=this.getExecutionContext().getNamedNode(i);this.getExecutionContext().updateNamedNode(this.getExecutionContext().getUniqueName(i),n)}catch(t){}this.getExecutionContext().updateNamedNode(i,e)}}catch(t){console.warn("Invalid DEF name: "+t.message)}},nodeAttributes:function(t,e){for(var i=t.attributes,n=0;n<i.length;++n)this.nodeAttribute(i[n],e)},nodeAttribute:function(t,e){try{var i=e.getField(this.attributeToCamelCase(t.name));i.getAccessType()&c.initializeOnly&&this.fieldValue(i,t.value)}catch(t){}},fieldValue:function(t,e){null!==e&&(this.parser.pushExecutionContext(this.getExecutionContext()),this.parser.setInput(e),this.fieldTypes[t.getType()].call(this.parser,t),this.parser.popExecutionContext())},addNode:function(t,i){if(0===this.parents.length||this.getParent()instanceof l)this.getExecutionContext().rootNodes.push(i);else{var n=this.getParent();if(n instanceof e)switch(n.getType()){case c.SFNode:return void n.setValue(i);case c.MFNode:return void n.push(i)}else try{var r=t.getAttribute("containerField");if(!r){if(!i)throw new Error("NULL node must have a container field attribute.");r=i.getContainerField()}var s=n.getField(r);switch(s.getType()){case c.SFNode:return void s.setValue(i);case c.MFNode:return void s.push(i)}}catch(t){}}},getParents:function(){return this.parents},getParent:function(){return this.parents.at(-1)},pushParent:function(t){return this.parents.push(t)},popParent:function(){this.parents.pop()},id:function(t){return null!==t&&0!==t.length},nodeNameToCamelCase:function(t){return a.getNodeTypeName(t)},attributeToCamelCase:function(t){return a.getFieldName(t)}}),p.prototype.fieldTypes=[],p.prototype.fieldTypes[c.SFBool]=o.prototype.sfboolValue,p.prototype.fieldTypes[c.SFColor]=o.prototype.sfcolorValue,p.prototype.fieldTypes[c.SFColorRGBA]=o.prototype.sfcolorrgbaValue,p.prototype.fieldTypes[c.SFDouble]=o.prototype.sfdoubleValue,p.prototype.fieldTypes[c.SFFloat]=o.prototype.sffloatValue,p.prototype.fieldTypes[c.SFImage]=o.prototype.sfimageValue,p.prototype.fieldTypes[c.SFInt32]=o.prototype.sfint32Value,p.prototype.fieldTypes[c.SFMatrix3f]=o.prototype.sfmatrix3dValue,p.prototype.fieldTypes[c.SFMatrix3d]=o.prototype.sfmatrix3fValue,p.prototype.fieldTypes[c.SFMatrix4f]=o.prototype.sfmatrix4dValue,p.prototype.fieldTypes[c.SFMatrix4d]=o.prototype.sfmatrix4fValue,p.prototype.fieldTypes[c.SFNode]=function(t){t.setValue(null)},p.prototype.fieldTypes[c.SFRotation]=o.prototype.sfrotationValue,p.prototype.fieldTypes[c.SFString]=function(t){t.setValue(r.SFString.unescape(this.input))},p.prototype.fieldTypes[c.SFTime]=o.prototype.sftimeValue,p.prototype.fieldTypes[c.SFVec2d]=o.prototype.sfvec2dValue,p.prototype.fieldTypes[c.SFVec2f]=o.prototype.sfvec2fValue,p.prototype.fieldTypes[c.SFVec3d]=o.prototype.sfvec3dValue,p.prototype.fieldTypes[c.SFVec3f]=o.prototype.sfvec3fValue,p.prototype.fieldTypes[c.SFVec4d]=o.prototype.sfvec4dValue,p.prototype.fieldTypes[c.SFVec4f]=o.prototype.sfvec4fValue,p.prototype.fieldTypes[c.MFBool]=o.prototype.sfboolValues,p.prototype.fieldTypes[c.MFColor]=o.prototype.sfcolorValues,p.prototype.fieldTypes[c.MFColorRGBA]=o.prototype.sfcolorrgbaValues,p.prototype.fieldTypes[c.MFDouble]=o.prototype.sfdoubleValues,p.prototype.fieldTypes[c.MFFloat]=o.prototype.sffloatValues,p.prototype.fieldTypes[c.MFImage]=o.prototype.sfimageValues,p.prototype.fieldTypes[c.MFInt32]=o.prototype.sfint32Values,p.prototype.fieldTypes[c.MFMatrix3d]=o.prototype.sfmatrix3dValues,p.prototype.fieldTypes[c.MFMatrix3f]=o.prototype.sfmatrix3fValues,p.prototype.fieldTypes[c.MFMatrix4d]=o.prototype.sfmatrix4dValues,p.prototype.fieldTypes[c.MFMatrix4f]=o.prototype.sfmatrix4fValues,p.prototype.fieldTypes[c.MFNode]=function(t){t.length=0},p.prototype.fieldTypes[c.MFRotation]=o.prototype.sfrotationValues,p.prototype.fieldTypes[c.MFString]=o.prototype.sfstringValues,p.prototype.fieldTypes[c.MFTime]=o.prototype.sftimeValues,p.prototype.fieldTypes[c.MFVec2d]=o.prototype.sfvec2dValues,p.prototype.fieldTypes[c.MFVec2f]=o.prototype.sfvec2fValues,p.prototype.fieldTypes[c.MFVec3d]=o.prototype.sfvec3dValues,p.prototype.fieldTypes[c.MFVec3f]=o.prototype.sfvec3fValues,p.prototype.fieldTypes[c.MFVec4d]=o.prototype.sfvec4dValues,p.prototype.fieldTypes[c.MFVec4f]=o.prototype.sfvec4fValues;var f=/\binf\b/g,g=/\bnan\b/g,m=/^[\x20\n,\t\r"]+|[\x20\n,\t\r"]+$/g,_=/[\x20\n,\t\r"]+/,y=new RegExp('"((?:[^\\\\"]|\\\\\\\\|\\\\\\")*)"',"g");function x(t){return t.replace(f,"Infinity").replace(g,"NaN").replace(m,"").split(_)}return p.prototype.fieldTypes[c.MFColor]=p.prototype.fieldTypes[c.MFColorRGBA]=p.prototype.fieldTypes[c.MFMatrix3d]=p.prototype.fieldTypes[c.MFMatrix3f]=p.prototype.fieldTypes[c.MFMatrix4d]=p.prototype.fieldTypes[c.MFMatrix4f]=p.prototype.fieldTypes[c.MFVec4d]=p.prototype.fieldTypes[c.MFVec4f]=function(t){t.setValue(x(this.getInput()).map((function(t){return parseFloat(t)})))},p.prototype.fieldTypes[c.MFBool]=function(t){var e;t.setValue((e=this.getInput(),e.replace(m,"").split(_)).map((function(t){return"true"===t||"TRUE"===t})))},p.prototype.fieldTypes[c.MFInt32]=function(t){var e;t.setValue((e=this.getInput(),e.replace(m,"").split(_)).map((function(t){return parseInt(t)})))},p.prototype.fieldTypes[c.MFDouble]=p.prototype.fieldTypes[c.MFFloat]=p.prototype.fieldTypes[c.MFVec2d]=p.prototype.fieldTypes[c.MFVec2f]=p.prototype.fieldTypes[c.MFVec3d]=p.prototype.fieldTypes[c.MFVec3f]=function(t){var e=t.getUnit();t.setValue(x(this.getInput()).map((function(t){return this.fromUnit(e,parseFloat(t))}),this))},p.prototype.fieldTypes[c.MFString]=function(t){t.setValue(function(t){for(var e=null,i=[];e=y.exec(t);)i.push(e[1]);return i.map(r.SFString.unescape)}(this.getInput()))},p})),define("x_ite/Parser/JSONParser",["x_ite/Parser/XMLParser","x_ite/Parser/X3DParser"],(function(t,e){"use strict";function i(t){e.call(this,t),this.x3djsonNS="http://www.web3d.org/specifications/x3d-namespace"}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i,isValid:function(){return this.input instanceof Object},getInput:function(){return this.input},setInput:function(t){try{"string"==typeof t&&(t=JSON.parse(t)),this.input=t}catch(t){this.input=void 0}},parseIntoScene:function(e,i){const n=this.createElement("X3D");this.convertToDOM(this.input,"",n);const r=new t(this.getScene());return r.setInput(n),r.parseIntoScene(e,i),n},elementSetAttribute:function(t,e,i){switch(e){case"SON schema":case"ncoding":break;default:"function"==typeof t.setAttribute&&t.setAttribute(e,i)}},convertChildren:function(t,e,i){for(const n in e)"object"==typeof e[n]&&(isNaN(parseInt(n))?this.convertObject(n,e,i,t.substr(1)):this.convertToDOM(e[n],n,i,t.substr(1)))},createElement:function(t,e){if(void 0===this.x3djsonNS)var i=document.createElement(t);else null==(i=document.createElementNS(this.x3djsonNS,t))&&(console.error("Trouble creating element for",t),i=document.createElement(t));return void 0!==e&&this.elementSetAttribute(i,"containerField",e),i},createCDATA:function(t,e,i){let n=i.trim().replace(/\\"/g,'\\"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&");do{n=(i=n).replace(/'([^'\r\n]*)\n([^']*)'/g,"'$1\\n$2'"),i!==n&&console.log("CDATA Replacing",i,"with",n)}while(n!==i);const r="<script> <![CDATA[ "+n+" ]]> <\/script>",s=(new DOMParser).parseFromString(r,"application/xml").children[0].childNodes[1];e.appendChild(s)},convertObject:function(t,e,i,n){if(null!==e&&"object"==typeof e[t])if("@"===t.substr(0,1))this.convertToDOM(e[t],t,i);else if("-"===t.substr(0,1))this.convertChildren(t,e[t],i);else if("#comment"===t)for(const n in e[t]){const r=document.createComment(this.commentStringToXML(e[t][n]));i.appendChild(r)}else if("#sourceCode"===t||"@sourceCode"===t||"#sourceText"===t)this.createCDATA(document,i,e[t].join("\r\n")+"\r\n");else if("connect"===t||"fieldValue"===t||"field"===t||"meta"===t||"component"===t){for(const r in e[t])if("object"==typeof e[t][r]){const s=this.createElement(t,n);this.convertToDOM(e[t][r],r,s),i.appendChild(s),i.appendChild(document.createTextNode("\n"))}}else{const r=this.createElement(t,n);this.convertToDOM(e[t],t,r),i.appendChild(r),i.appendChild(document.createTextNode("\n"))}},commentStringToXML:function(t){let e=t;return e!==(t=t.replace(/\\\\/g,"\\"))&&console.log("X3DJSONLD <!-> replacing",e,"with",t),t},SFStringToXML:function(t){const e=t;return e!==(t=(t=t.replace(/\\/g,"\\\\")).replace(/"/g,'\\"'))&&console.log("X3DJSONLD [] replacing",e,"with",t),t},JSONStringToXML:function(t){const e=t;return e!==(t=(t=t.replace(/\\/g,"\\\\")).replace(/\n/g,"\\n"))&&console.log("X3DJSONLD replacing",e,"with",t),t},convertToDOM:function(t,e,i,n){let r=!1,s=[],o=!1;for(const e in t)if(r=!isNaN(parseInt(e)),r)switch(typeof t[e]){case"number":case"boolean":s.push(t[e]);break;case"string":s.push(t[e]),o=!0;break;case"object":this.convertToDOM(t[e],e,i);break;case"undefined":break;default:console.error("Unknown type found in array "+typeof t[e])}else switch(typeof t[e]){case"object":"X3D"===e?this.convertToDOM(t[e],e,i):this.convertObject(e,t,i,n);break;case"number":case"boolean":this.elementSetAttribute(i,e.substr(1),t[e]);break;case"string":if("#comment"!==e)this.elementSetAttribute(i,e.substr(1),this.JSONStringToXML(t[e]));else{const n=document.createComment(this.commentStringToXML(t[e]));i.appendChild(n)}break;case"undefined":break;default:console.error("Unknown type found in object "+typeof t[e]),console.error(t)}if(r){if("@"===e.substr(0,1))if(o){o=!1;for(const t in s)s[t]=this.SFStringToXML(s[t]);this.elementSetAttribute(i,e.substr(1),'"'+s.join('" "')+'"')}else this.elementSetAttribute(i,e.substr(1),s.join(" "));r=!1}return i}}),i})),define("x_ite/Parser/GoldenGate",["x_ite/Parser/X3DParser","x_ite/Parser/JSONParser","x_ite/Parser/VRMLParser","x_ite/Parser/XMLParser"],(function(t,e,i,n){"use strict";function r(e){t.call(this,e)}return r.prototype=Object.assign(Object.create(t.prototype),{constructor:r,parseIntoScene:function(t,e,i){for(const n of r.Parser)try{const r=new n(this.getScene());if(r.setInput(t),r.isValid())return r.pushExecutionContext(this.getExecutionContext()),r.parseIntoScene(e,i),void r.popExecutionContext()}catch(t){if(!i)throw t;return void i(t)}throw this.getScene().worldURL.startsWith("data:")?new Error("Couldn't parse X3D. No suitable file handler found for 'data:' URL."):new Error("Couldn't parse X3D. No suitable file handler found for '"+this.getScene().worldURL+"'.")}}),r.Parser=[n,e,i],r})),define("standard/Math/Geometry/Plane3",["standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4"],(function(t,e){"use strict";const i=new t(0,0,0),n=new t(0,0,0),r=new e;function s(t,e){this.normal=e.copy(),this.distanceFromOrigin=e.dot(t)}return s.prototype={constructor:s,copy:function(){const t=Object.create(s.prototype);return t.normal=this.normal.copy(),t.distanceFromOrigin=this.distanceFromOrigin,t},assign:function(t){return this.normal.assign(t.normal),this.distanceFromOrigin=t.distanceFromOrigin,this},set:function(t,e){return this.normal.assign(e),this.distanceFromOrigin=e.dot(t),this},multRight:function(t){return n.assign(this.normal).multiply(this.distanceFromOrigin),r.assign(t).inverse(),r.multMatrixDir(i.assign(this.normal)).normalize(),t.multVecMatrix(n),this.normal.assign(i),this.distanceFromOrigin=i.dot(n),this},multLeft:function(t){return n.assign(this.normal).multiply(this.distanceFromOrigin),r.assign(t).inverse(),r.multDirMatrix(i.assign(this.normal)).normalize(),t.multMatrixVec(n),this.normal.assign(i),this.distanceFromOrigin=i.dot(n),this},getDistanceToPoint:function(e){return t.dot(e,this.normal)-this.distanceFromOrigin},intersectsLine:function(t,e){const i=t.point,n=t.direction,r=n.dot(this.normal);if(0===r)return!1;const s=(this.distanceFromOrigin-this.normal.dot(i))/r;return e.x=i.x+n.x*s,e.y=i.y+n.y*s,e.z=i.z+n.z*s,!0},toString:function(){return this.normal.toString()+" "+this.distanceFromOrigin}},s}));
/**
 * @license
 * Copyright 2000, Silicon Graphics, Inc. All Rights Reserved.
 * Copyright 2015, Google Inc. All Rights Reserved.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice including the dates of first publication and
 * either this permission notice or a reference to http://oss.sgi.com/projects/FreeB/
 * shall be included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL
 * SILICON GRAPHICS, INC. BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR
 * IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 *
 * Original Code. The Original Code is: OpenGL Sample Implementation,
 * Version 1.2.1, released January 26, 2000, developed by Silicon Graphics,
 * Inc. The Original Code is Copyright (c) 1991-2000 Silicon Graphics, Inc.
 * Copyright in any portions created by third parties is as indicated
 * elsewhere herein. All Rights Reserved.
 */
var libtess={DEBUG:!1,assert:function(t,e){if(libtess.DEBUG&&!t)throw new Error("Assertion failed"+(e?": "+e:""))},GLU_TESS_MAX_COORD:1e150,TRUE_PROJECT:!1,GLU_TESS_DEFAULT_TOLERANCE:0,windingRule:{GLU_TESS_WINDING_ODD:100130,GLU_TESS_WINDING_NONZERO:100131,GLU_TESS_WINDING_POSITIVE:100132,GLU_TESS_WINDING_NEGATIVE:100133,GLU_TESS_WINDING_ABS_GEQ_TWO:100134},primitiveType:{GL_LINE_LOOP:2,GL_TRIANGLES:4,GL_TRIANGLE_STRIP:5,GL_TRIANGLE_FAN:6},errorType:{GLU_TESS_MISSING_BEGIN_POLYGON:100151,GLU_TESS_MISSING_END_POLYGON:100153,GLU_TESS_MISSING_BEGIN_CONTOUR:100152,GLU_TESS_MISSING_END_CONTOUR:100154,GLU_TESS_COORD_TOO_LARGE:100155,GLU_TESS_NEED_COMBINE_CALLBACK:100156},gluEnum:{GLU_TESS_BEGIN:100100,GLU_TESS_VERTEX:100101,GLU_TESS_END:100102,GLU_TESS_ERROR:100103,GLU_TESS_EDGE_FLAG:100104,GLU_TESS_COMBINE:100105,GLU_TESS_BEGIN_DATA:100106,GLU_TESS_VERTEX_DATA:100107,GLU_TESS_END_DATA:100108,GLU_TESS_ERROR_DATA:100109,GLU_TESS_EDGE_FLAG_DATA:100110,GLU_TESS_COMBINE_DATA:100111,GLU_TESS_MESH:100112,GLU_TESS_TOLERANCE:100142,GLU_TESS_WINDING_RULE:100140,GLU_TESS_BOUNDARY_ONLY:100141,GLU_INVALID_ENUM:100900,GLU_INVALID_VALUE:100901}};libtess.PQHandle,libtess.geom={},libtess.geom.vertEq=function(t,e){return t.s===e.s&&t.t===e.t},libtess.geom.vertLeq=function(t,e){return t.s<e.s||t.s===e.s&&t.t<=e.t},libtess.geom.edgeEval=function(t,e,i){var n=e.s-t.s,r=i.s-e.s;return n+r>0?n<r?e.t-t.t+(t.t-i.t)*(n/(n+r)):e.t-i.t+(i.t-t.t)*(r/(n+r)):0},libtess.geom.edgeSign=function(t,e,i){var n=e.s-t.s,r=i.s-e.s;return n+r>0?(e.t-i.t)*n+(e.t-t.t)*r:0},libtess.geom.transLeq=function(t,e){return t.t<e.t||t.t===e.t&&t.s<=e.s},libtess.geom.transEval=function(t,e,i){var n=e.t-t.t,r=i.t-e.t;return n+r>0?n<r?e.s-t.s+(t.s-i.s)*(n/(n+r)):e.s-i.s+(i.s-t.s)*(r/(n+r)):0},libtess.geom.transSign=function(t,e,i){var n=e.t-t.t,r=i.t-e.t;return n+r>0?(e.s-i.s)*n+(e.s-t.s)*r:0},libtess.geom.edgeGoesLeft=function(t){return libtess.geom.vertLeq(t.dst(),t.org)},libtess.geom.edgeGoesRight=function(t){return libtess.geom.vertLeq(t.org,t.dst())},libtess.geom.vertL1dist=function(t,e){return Math.abs(t.s-e.s)+Math.abs(t.t-e.t)},libtess.geom.vertCCW=function(t,e,i){return t.s*(e.t-i.t)+e.s*(i.t-t.t)+i.s*(t.t-e.t)>=0},libtess.geom.interpolate_=function(t,e,i,n){return(t=t<0?0:t)<=(i=i<0?0:i)?0===i?(e+n)/2:e+t/(t+i)*(n-e):n+i/(t+i)*(e-n)},libtess.geom.edgeIntersect=function(t,e,i,n,r){var s,o,a;libtess.geom.vertLeq(t,e)||(a=t,t=e,e=a),libtess.geom.vertLeq(i,n)||(a=i,i=n,n=a),libtess.geom.vertLeq(t,i)||(a=t,t=i,i=a,a=e,e=n,n=a),libtess.geom.vertLeq(i,e)?libtess.geom.vertLeq(e,n)?((s=libtess.geom.edgeEval(t,i,e))+(o=libtess.geom.edgeEval(i,e,n))<0&&(s=-s,o=-o),r.s=libtess.geom.interpolate_(s,i.s,o,e.s)):((s=libtess.geom.edgeSign(t,i,e))+(o=-libtess.geom.edgeSign(t,n,e))<0&&(s=-s,o=-o),r.s=libtess.geom.interpolate_(s,i.s,o,n.s)):r.s=(i.s+e.s)/2,libtess.geom.transLeq(t,e)||(a=t,t=e,e=a),libtess.geom.transLeq(i,n)||(a=i,i=n,n=a),libtess.geom.transLeq(t,i)||(a=t,t=i,i=a,a=e,e=n,n=a),libtess.geom.transLeq(i,e)?libtess.geom.transLeq(e,n)?((s=libtess.geom.transEval(t,i,e))+(o=libtess.geom.transEval(i,e,n))<0&&(s=-s,o=-o),r.t=libtess.geom.interpolate_(s,i.t,o,e.t)):((s=libtess.geom.transSign(t,i,e))+(o=-libtess.geom.transSign(t,n,e))<0&&(s=-s,o=-o),r.t=libtess.geom.interpolate_(s,i.t,o,n.t)):r.t=(i.t+e.t)/2},libtess.mesh={},libtess.mesh.makeEdge=function(t){var e=libtess.mesh.makeEdgePair_(t.eHead);return libtess.mesh.makeVertex_(e,t.vHead),libtess.mesh.makeVertex_(e.sym,t.vHead),libtess.mesh.makeFace_(e,t.fHead),e},libtess.mesh.meshSplice=function(t,e){var i=!1,n=!1;t!==e&&(e.org!==t.org&&(n=!0,libtess.mesh.killVertex_(e.org,t.org)),e.lFace!==t.lFace&&(i=!0,libtess.mesh.killFace_(e.lFace,t.lFace)),libtess.mesh.splice_(e,t),n||(libtess.mesh.makeVertex_(e,t.org),t.org.anEdge=t),i||(libtess.mesh.makeFace_(e,t.lFace),t.lFace.anEdge=t))},libtess.mesh.deleteEdge=function(t){var e=t.sym,i=!1;t.lFace!==t.rFace()&&(i=!0,libtess.mesh.killFace_(t.lFace,t.rFace())),t.oNext===t?libtess.mesh.killVertex_(t.org,null):(t.rFace().anEdge=t.oPrev(),t.org.anEdge=t.oNext,libtess.mesh.splice_(t,t.oPrev()),i||libtess.mesh.makeFace_(t,t.lFace)),e.oNext===e?(libtess.mesh.killVertex_(e.org,null),libtess.mesh.killFace_(e.lFace,null)):(t.lFace.anEdge=e.oPrev(),e.org.anEdge=e.oNext,libtess.mesh.splice_(e,e.oPrev())),libtess.mesh.killEdge_(t)},libtess.mesh.addEdgeVertex=function(t){var e=libtess.mesh.makeEdgePair_(t),i=e.sym;return libtess.mesh.splice_(e,t.lNext),e.org=t.dst(),libtess.mesh.makeVertex_(i,e.org),e.lFace=i.lFace=t.lFace,e},libtess.mesh.splitEdge=function(t){var e=libtess.mesh.addEdgeVertex(t).sym;return libtess.mesh.splice_(t.sym,t.sym.oPrev()),libtess.mesh.splice_(t.sym,e),t.sym.org=e.org,e.dst().anEdge=e.sym,e.sym.lFace=t.rFace(),e.winding=t.winding,e.sym.winding=t.sym.winding,e},libtess.mesh.connect=function(t,e){var i=!1,n=libtess.mesh.makeEdgePair_(t),r=n.sym;return e.lFace!==t.lFace&&(i=!0,libtess.mesh.killFace_(e.lFace,t.lFace)),libtess.mesh.splice_(n,t.lNext),libtess.mesh.splice_(r,e),n.org=t.dst(),r.org=e.org,n.lFace=r.lFace=t.lFace,t.lFace.anEdge=r,i||libtess.mesh.makeFace_(n,t.lFace),n},libtess.mesh.zapFace=function(t){var e,i=t.anEdge,n=i.lNext;do{if(n=(e=n).lNext,e.lFace=null,null===e.rFace()){e.oNext===e?libtess.mesh.killVertex_(e.org,null):(e.org.anEdge=e.oNext,libtess.mesh.splice_(e,e.oPrev()));var r=e.sym;r.oNext===r?libtess.mesh.killVertex_(r.org,null):(r.org.anEdge=r.oNext,libtess.mesh.splice_(r,r.oPrev())),libtess.mesh.killEdge_(e)}}while(e!==i);var s=t.prev,o=t.next;o.prev=s,s.next=o},libtess.mesh.meshUnion=function(t,e){var i=t.fHead,n=t.vHead,r=t.eHead,s=e.fHead,o=e.vHead,a=e.eHead;return s.next!==s&&(i.prev.next=s.next,s.next.prev=i.prev,s.prev.next=i,i.prev=s.prev),o.next!==o&&(n.prev.next=o.next,o.next.prev=n.prev,o.prev.next=n,n.prev=o.prev),a.next!==a&&(r.sym.next.sym.next=a.next,a.next.sym.next=r.sym.next,a.sym.next.sym.next=r,r.sym.next=a.sym.next),t},libtess.mesh.deleteMesh=function(t){},libtess.mesh.makeEdgePair_=function(t){var e=new libtess.GluHalfEdge,i=new libtess.GluHalfEdge,n=t.sym.next;return i.next=n,n.sym.next=e,e.next=t,t.sym.next=i,e.sym=i,e.oNext=e,e.lNext=i,i.sym=e,i.oNext=i,i.lNext=e,e},libtess.mesh.splice_=function(t,e){var i=t.oNext,n=e.oNext;i.sym.lNext=e,n.sym.lNext=t,t.oNext=n,e.oNext=i},libtess.mesh.makeVertex_=function(t,e){var i=e.prev,n=new libtess.GluVertex(e,i);i.next=n,e.prev=n,n.anEdge=t;var r=t;do{r.org=n,r=r.oNext}while(r!==t)},libtess.mesh.makeFace_=function(t,e){var i=e.prev,n=new libtess.GluFace(e,i);i.next=n,e.prev=n,n.anEdge=t,n.inside=e.inside;var r=t;do{r.lFace=n,r=r.lNext}while(r!==t)},libtess.mesh.killEdge_=function(t){var e=t.next,i=t.sym.next;e.sym.next=i,i.sym.next=e},libtess.mesh.killVertex_=function(t,e){var i=t.anEdge,n=i;do{n.org=e,n=n.oNext}while(n!==i);var r=t.prev,s=t.next;s.prev=r,r.next=s},libtess.mesh.killFace_=function(t,e){var i=t.anEdge,n=i;do{n.lFace=e,n=n.lNext}while(n!==i);var r=t.prev,s=t.next;s.prev=r,r.next=s},libtess.normal={},libtess.normal.S_UNIT_X_=1,libtess.normal.S_UNIT_Y_=0,libtess.normal.projectPolygon=function(t,e,i,n){var r=!1,s=[e,i,n];0===e&&0===i&&0===n&&(libtess.normal.computeNormal_(t,s),r=!0);var o,a=libtess.normal.longAxis_(s),u=t.mesh.vHead;if(libtess.TRUE_PROJECT){libtess.normal.normalize_(s);var l=[0,0,0],c=[0,0,0];l[a]=0,l[(a+1)%3]=libtess.normal.S_UNIT_X_,l[(a+2)%3]=libtess.normal.S_UNIT_Y_;var h=libtess.normal.dot_(l,s);for(l[0]-=h*s[0],l[1]-=h*s[1],l[2]-=h*s[2],libtess.normal.normalize_(l),c[0]=s[1]*l[2]-s[2]*l[1],c[1]=s[2]*l[0]-s[0]*l[2],c[2]=s[0]*l[1]-s[1]*l[0],libtess.normal.normalize_(c),o=u.next;o!==u;o=o.next)o.s=libtess.normal.dot_(o.coords,l),o.t=libtess.normal.dot_(o.coords,c)}else{var d=(a+1)%3,p=(a+2)%3,f=s[a]>0?1:-1;for(o=u.next;o!==u;o=o.next)o.s=o.coords[d],o.t=f*o.coords[p]}r&&libtess.normal.checkOrientation_(t)},libtess.normal.dot_=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},libtess.normal.normalize_=function(t){var e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2];e=Math.sqrt(e),t[0]/=e,t[1]/=e,t[2]/=e},libtess.normal.longAxis_=function(t){var e=0;return Math.abs(t[1])>Math.abs(t[0])&&(e=1),Math.abs(t[2])>Math.abs(t[e])&&(e=2),e},libtess.normal.computeNormal_=function(t,e){var i,n=[-2*libtess.GLU_TESS_MAX_COORD,-2*libtess.GLU_TESS_MAX_COORD,-2*libtess.GLU_TESS_MAX_COORD],r=[2*libtess.GLU_TESS_MAX_COORD,2*libtess.GLU_TESS_MAX_COORD,2*libtess.GLU_TESS_MAX_COORD],s=[],o=[],a=t.mesh.vHead;for(i=a.next;i!==a;i=i.next)for(var u=0;u<3;++u){var l=i.coords[u];l<r[u]&&(r[u]=l,o[u]=i),l>n[u]&&(n[u]=l,s[u]=i)}var c=0;if(n[1]-r[1]>n[0]-r[0]&&(c=1),n[2]-r[2]>n[c]-r[c]&&(c=2),r[c]>=n[c])return e[0]=0,e[1]=0,void(e[2]=1);var h=0,d=o[c],p=s[c],f=[0,0,0],g=[d.coords[0]-p.coords[0],d.coords[1]-p.coords[1],d.coords[2]-p.coords[2]],m=[0,0,0];for(i=a.next;i!==a;i=i.next){m[0]=i.coords[0]-p.coords[0],m[1]=i.coords[1]-p.coords[1],m[2]=i.coords[2]-p.coords[2],f[0]=g[1]*m[2]-g[2]*m[1],f[1]=g[2]*m[0]-g[0]*m[2],f[2]=g[0]*m[1]-g[1]*m[0];var _=f[0]*f[0]+f[1]*f[1]+f[2]*f[2];_>h&&(h=_,e[0]=f[0],e[1]=f[1],e[2]=f[2])}h<=0&&(e[0]=e[1]=e[2]=0,e[libtess.normal.longAxis_(g)]=1)},libtess.normal.checkOrientation_=function(t){for(var e=0,i=t.mesh.fHead,n=i.next;n!==i;n=n.next){var r=n.anEdge;if(!(r.winding<=0))do{e+=(r.org.s-r.dst().s)*(r.org.t+r.dst().t),r=r.lNext}while(r!==n.anEdge)}if(e<0)for(var s=t.mesh.vHead,o=s.next;o!==s;o=o.next)o.t=-o.t},libtess.render={},libtess.render.renderMesh=function(t,e,i){for(var n=!1,r=-1,s=e.fHead.prev;s!==e.fHead;s=s.prev)if(s.inside){n||(t.callBeginCallback(libtess.primitiveType.GL_TRIANGLES),n=!0);var o=s.anEdge;do{if(i){var a=o.rFace().inside?0:1;r!==a&&(r=a,t.callEdgeFlagCallback(!!r))}t.callVertexCallback(o.org.data),o=o.lNext}while(o!==s.anEdge)}n&&t.callEndCallback()},libtess.render.renderBoundary=function(t,e){for(var i=e.fHead.next;i!==e.fHead;i=i.next)if(i.inside){t.callBeginCallback(libtess.primitiveType.GL_LINE_LOOP);var n=i.anEdge;do{t.callVertexCallback(n.org.data),n=n.lNext}while(n!==i.anEdge);t.callEndCallback()}},libtess.sweep={},libtess.sweep.SENTINEL_COORD_=4*libtess.GLU_TESS_MAX_COORD,libtess.sweep.TOLERANCE_NONZERO_=!1,libtess.sweep.computeInterior=function(t){var e;for(t.fatalError=!1,libtess.sweep.removeDegenerateEdges_(t),libtess.sweep.initPriorityQ_(t),libtess.sweep.initEdgeDict_(t);null!==(e=t.pq.extractMin());){for(;;){var i=t.pq.minimum();if(null===i||!libtess.geom.vertEq(i,e))break;i=t.pq.extractMin(),libtess.sweep.spliceMergeVertices_(t,e.anEdge,i.anEdge)}libtess.sweep.sweepEvent_(t,e)}var n=t.dict.getMin().getKey();t.event=n.eUp.org,libtess.sweep.doneEdgeDict_(t),libtess.sweep.donePriorityQ_(t),libtess.sweep.removeDegenerateFaces_(t.mesh),t.mesh.checkMesh()},libtess.sweep.addWinding_=function(t,e){t.winding+=e.winding,t.sym.winding+=e.sym.winding},libtess.sweep.edgeLeq_=function(t,e,i){var n=t.event,r=e.eUp,s=i.eUp;return r.dst()===n?s.dst()===n?libtess.geom.vertLeq(r.org,s.org)?libtess.geom.edgeSign(s.dst(),r.org,s.org)<=0:libtess.geom.edgeSign(r.dst(),s.org,r.org)>=0:libtess.geom.edgeSign(s.dst(),n,s.org)<=0:s.dst()===n?libtess.geom.edgeSign(r.dst(),n,r.org)>=0:libtess.geom.edgeEval(r.dst(),n,r.org)>=libtess.geom.edgeEval(s.dst(),n,s.org)},libtess.sweep.deleteRegion_=function(t,e){e.fixUpperEdge,e.eUp.activeRegion=null,t.dict.deleteNode(e.nodeUp),e.nodeUp=null},libtess.sweep.fixUpperEdge_=function(t,e){libtess.mesh.deleteEdge(t.eUp),t.fixUpperEdge=!1,t.eUp=e,e.activeRegion=t},libtess.sweep.topLeftRegion_=function(t){var e=t.eUp.org;do{t=t.regionAbove()}while(t.eUp.org===e);if(t.fixUpperEdge){var i=libtess.mesh.connect(t.regionBelow().eUp.sym,t.eUp.lNext);libtess.sweep.fixUpperEdge_(t,i),t=t.regionAbove()}return t},libtess.sweep.topRightRegion_=function(t){var e=t.eUp.dst();do{t=t.regionAbove()}while(t.eUp.dst()===e);return t},libtess.sweep.addRegionBelow_=function(t,e,i){var n=new libtess.ActiveRegion;return n.eUp=i,n.nodeUp=t.dict.insertBefore(e.nodeUp,n),i.activeRegion=n,n},libtess.sweep.isWindingInside_=function(t,e){switch(t.windingRule){case libtess.windingRule.GLU_TESS_WINDING_ODD:return 0!=(1&e);case libtess.windingRule.GLU_TESS_WINDING_NONZERO:return 0!==e;case libtess.windingRule.GLU_TESS_WINDING_POSITIVE:return e>0;case libtess.windingRule.GLU_TESS_WINDING_NEGATIVE:return e<0;case libtess.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:return e>=2||e<=-2}return!1},libtess.sweep.computeWinding_=function(t,e){e.windingNumber=e.regionAbove().windingNumber+e.eUp.winding,e.inside=libtess.sweep.isWindingInside_(t,e.windingNumber)},libtess.sweep.finishRegion_=function(t,e){var i=e.eUp,n=i.lFace;n.inside=e.inside,n.anEdge=i,libtess.sweep.deleteRegion_(t,e)},libtess.sweep.finishLeftRegions_=function(t,e,i){for(var n=e,r=e.eUp;n!==i;){n.fixUpperEdge=!1;var s=n.regionBelow(),o=s.eUp;if(o.org!==r.org){if(!s.fixUpperEdge){libtess.sweep.finishRegion_(t,n);break}o=libtess.mesh.connect(r.lPrev(),o.sym),libtess.sweep.fixUpperEdge_(s,o)}r.oNext!==o&&(libtess.mesh.meshSplice(o.oPrev(),o),libtess.mesh.meshSplice(r,o)),libtess.sweep.finishRegion_(t,n),r=s.eUp,n=s}return r},libtess.sweep.addRightEdges_=function(t,e,i,n,r,s){var o=!0,a=i;do{libtess.sweep.addRegionBelow_(t,e,a.sym),a=a.oNext}while(a!==n);null===r&&(r=e.regionBelow().eUp.rPrev());for(var u,l=e,c=r;(a=(u=l.regionBelow()).eUp.sym).org===c.org;)a.oNext!==c&&(libtess.mesh.meshSplice(a.oPrev(),a),libtess.mesh.meshSplice(c.oPrev(),a)),u.windingNumber=l.windingNumber-a.winding,u.inside=libtess.sweep.isWindingInside_(t,u.windingNumber),l.dirty=!0,!o&&libtess.sweep.checkForRightSplice_(t,l)&&(libtess.sweep.addWinding_(a,c),libtess.sweep.deleteRegion_(t,l),libtess.mesh.deleteEdge(c)),o=!1,l=u,c=a;l.dirty=!0,s&&libtess.sweep.walkDirtyRegions_(t,l)},libtess.sweep.callCombine_=function(t,e,i,n,r){var s=[e.coords[0],e.coords[1],e.coords[2]];e.data=null,e.data=t.callCombineCallback(s,i,n),null===e.data&&(r?t.fatalError||(t.callErrorCallback(libtess.errorType.GLU_TESS_NEED_COMBINE_CALLBACK),t.fatalError=!0):e.data=i[0])},libtess.sweep.spliceMergeVertices_=function(t,e,i){var n=[null,null,null,null];n[0]=e.org.data,n[1]=i.org.data,libtess.sweep.callCombine_(t,e.org,n,[.5,.5,0,0],!1),libtess.mesh.meshSplice(e,i)},libtess.sweep.vertexWeights_=function(t,e,i,n,r){var s=libtess.geom.vertL1dist(e,t),o=libtess.geom.vertL1dist(i,t),a=r,u=r+1;n[a]=.5*o/(s+o),n[u]=.5*s/(s+o),t.coords[0]+=n[a]*e.coords[0]+n[u]*i.coords[0],t.coords[1]+=n[a]*e.coords[1]+n[u]*i.coords[1],t.coords[2]+=n[a]*e.coords[2]+n[u]*i.coords[2]},libtess.sweep.getIntersectData_=function(t,e,i,n,r,s){var o=[0,0,0,0],a=[i.data,n.data,r.data,s.data];e.coords[0]=e.coords[1]=e.coords[2]=0,libtess.sweep.vertexWeights_(e,i,n,o,0),libtess.sweep.vertexWeights_(e,r,s,o,2),libtess.sweep.callCombine_(t,e,a,o,!0)},libtess.sweep.checkForRightSplice_=function(t,e){var i=e.regionBelow(),n=e.eUp,r=i.eUp;if(libtess.geom.vertLeq(n.org,r.org)){if(libtess.geom.edgeSign(r.dst(),n.org,r.org)>0)return!1;libtess.geom.vertEq(n.org,r.org)?n.org!==r.org&&(t.pq.remove(n.org.pqHandle),libtess.sweep.spliceMergeVertices_(t,r.oPrev(),n)):(libtess.mesh.splitEdge(r.sym),libtess.mesh.meshSplice(n,r.oPrev()),e.dirty=i.dirty=!0)}else{if(libtess.geom.edgeSign(n.dst(),r.org,n.org)<0)return!1;e.regionAbove().dirty=e.dirty=!0,libtess.mesh.splitEdge(n.sym),libtess.mesh.meshSplice(r.oPrev(),n)}return!0},libtess.sweep.checkForLeftSplice_=function(t,e){var i,n=e.regionBelow(),r=e.eUp,s=n.eUp;if(libtess.geom.vertLeq(r.dst(),s.dst())){if(libtess.geom.edgeSign(r.dst(),s.dst(),r.org)<0)return!1;e.regionAbove().dirty=e.dirty=!0,i=libtess.mesh.splitEdge(r),libtess.mesh.meshSplice(s.sym,i),i.lFace.inside=e.inside}else{if(libtess.geom.edgeSign(s.dst(),r.dst(),s.org)>0)return!1;e.dirty=n.dirty=!0,i=libtess.mesh.splitEdge(s),libtess.mesh.meshSplice(r.lNext,s.sym),i.rFace().inside=e.inside}return!0},libtess.sweep.checkForIntersect_=function(t,e){var i=e.regionBelow(),n=e.eUp,r=i.eUp,s=n.org,o=r.org,a=n.dst(),u=r.dst(),l=new libtess.GluVertex;if(s===o)return!1;if(Math.min(s.t,a.t)>Math.max(o.t,u.t))return!1;if(libtess.geom.vertLeq(s,o)){if(libtess.geom.edgeSign(u,s,o)>0)return!1}else if(libtess.geom.edgeSign(a,o,s)<0)return!1;libtess.geom.edgeIntersect(a,s,u,o,l),libtess.geom.vertLeq(l,t.event)&&(l.s=t.event.s,l.t=t.event.t);var c=libtess.geom.vertLeq(s,o)?s:o;if(libtess.geom.vertLeq(c,l)&&(l.s=c.s,l.t=c.t),libtess.geom.vertEq(l,s)||libtess.geom.vertEq(l,o))return libtess.sweep.checkForRightSplice_(t,e),!1;if(!libtess.geom.vertEq(a,t.event)&&libtess.geom.edgeSign(a,t.event,l)>=0||!libtess.geom.vertEq(u,t.event)&&libtess.geom.edgeSign(u,t.event,l)<=0){if(u===t.event)return libtess.mesh.splitEdge(n.sym),libtess.mesh.meshSplice(r.sym,n),n=(e=libtess.sweep.topLeftRegion_(e)).regionBelow().eUp,libtess.sweep.finishLeftRegions_(t,e.regionBelow(),i),libtess.sweep.addRightEdges_(t,e,n.oPrev(),n,n,!0),!0;if(a===t.event){libtess.mesh.splitEdge(r.sym),libtess.mesh.meshSplice(n.lNext,r.oPrev()),i=e;var h=(e=libtess.sweep.topRightRegion_(e)).regionBelow().eUp.rPrev();return i.eUp=r.oPrev(),r=libtess.sweep.finishLeftRegions_(t,i,null),libtess.sweep.addRightEdges_(t,e,r.oNext,n.rPrev(),h,!0),!0}return libtess.geom.edgeSign(a,t.event,l)>=0&&(e.regionAbove().dirty=e.dirty=!0,libtess.mesh.splitEdge(n.sym),n.org.s=t.event.s,n.org.t=t.event.t),libtess.geom.edgeSign(u,t.event,l)<=0&&(e.dirty=i.dirty=!0,libtess.mesh.splitEdge(r.sym),r.org.s=t.event.s,r.org.t=t.event.t),!1}return libtess.mesh.splitEdge(n.sym),libtess.mesh.splitEdge(r.sym),libtess.mesh.meshSplice(r.oPrev(),n),n.org.s=l.s,n.org.t=l.t,n.org.pqHandle=t.pq.insert(n.org),libtess.sweep.getIntersectData_(t,n.org,s,a,o,u),e.regionAbove().dirty=e.dirty=i.dirty=!0,!1},libtess.sweep.walkDirtyRegions_=function(t,e){for(var i=e.regionBelow();;){for(;i.dirty;)e=i,i=i.regionBelow();if(!e.dirty&&(i=e,null===(e=e.regionAbove())||!e.dirty))return;e.dirty=!1;var n=e.eUp,r=i.eUp;if(n.dst()!==r.dst()&&libtess.sweep.checkForLeftSplice_(t,e)&&(i.fixUpperEdge?(libtess.sweep.deleteRegion_(t,i),libtess.mesh.deleteEdge(r),r=(i=e.regionBelow()).eUp):e.fixUpperEdge&&(libtess.sweep.deleteRegion_(t,e),libtess.mesh.deleteEdge(n),n=(e=i.regionAbove()).eUp)),n.org!==r.org)if(n.dst()===r.dst()||e.fixUpperEdge||i.fixUpperEdge||n.dst()!==t.event&&r.dst()!==t.event)libtess.sweep.checkForRightSplice_(t,e);else if(libtess.sweep.checkForIntersect_(t,e))return;n.org===r.org&&n.dst()===r.dst()&&(libtess.sweep.addWinding_(r,n),libtess.sweep.deleteRegion_(t,e),libtess.mesh.deleteEdge(n),e=i.regionAbove())}},libtess.sweep.connectRightVertex_=function(t,e,i){var n,r=i.oNext,s=e.regionBelow(),o=e.eUp,a=s.eUp,u=!1;(o.dst()!==a.dst()&&libtess.sweep.checkForIntersect_(t,e),libtess.geom.vertEq(o.org,t.event)&&(libtess.mesh.meshSplice(r.oPrev(),o),r=(e=libtess.sweep.topLeftRegion_(e)).regionBelow().eUp,libtess.sweep.finishLeftRegions_(t,e.regionBelow(),s),u=!0),libtess.geom.vertEq(a.org,t.event)&&(libtess.mesh.meshSplice(i,a.oPrev()),i=libtess.sweep.finishLeftRegions_(t,s,null),u=!0),u)?libtess.sweep.addRightEdges_(t,e,i.oNext,r,r,!0):(n=libtess.geom.vertLeq(a.org,o.org)?a.oPrev():o,n=libtess.mesh.connect(i.lPrev(),n),libtess.sweep.addRightEdges_(t,e,n,n.oNext,n.oNext,!1),n.sym.activeRegion.fixUpperEdge=!0,libtess.sweep.walkDirtyRegions_(t,e))},libtess.sweep.connectLeftDegenerate_=function(t,e,i){var n=e.eUp;if(libtess.geom.vertEq(n.org,i))libtess.sweep.TOLERANCE_NONZERO_&&libtess.sweep.spliceMergeVertices_(t,n,i.anEdge);else{if(!libtess.geom.vertEq(n.dst(),i))return libtess.mesh.splitEdge(n.sym),e.fixUpperEdge&&(libtess.mesh.deleteEdge(n.oNext),e.fixUpperEdge=!1),libtess.mesh.meshSplice(i.anEdge,n),void libtess.sweep.sweepEvent_(t,i);if(libtess.sweep.TOLERANCE_NONZERO_){var r=(e=libtess.sweep.topRightRegion_(e)).regionBelow(),s=r.eUp.sym,o=s.oNext,a=o;r.fixUpperEdge&&(libtess.sweep.deleteRegion_(t,r),libtess.mesh.deleteEdge(s),s=o.oPrev()),libtess.mesh.meshSplice(i.anEdge,s),libtess.geom.edgeGoesLeft(o)||(o=null),libtess.sweep.addRightEdges_(t,e,s.oNext,a,o,!0)}}},libtess.sweep.connectLeftVertex_=function(t,e){var i=new libtess.ActiveRegion;i.eUp=e.anEdge.sym;var n=t.dict.search(i).getKey(),r=n.regionBelow(),s=n.eUp,o=r.eUp;if(0!==libtess.geom.edgeSign(s.dst(),e,s.org)){var a,u=libtess.geom.vertLeq(o.dst(),s.dst())?n:r;if(n.inside||u.fixUpperEdge){if(u===n)a=libtess.mesh.connect(e.anEdge.sym,s.lNext);else a=libtess.mesh.connect(o.dNext(),e.anEdge).sym;u.fixUpperEdge?libtess.sweep.fixUpperEdge_(u,a):libtess.sweep.computeWinding_(t,libtess.sweep.addRegionBelow_(t,n,a)),libtess.sweep.sweepEvent_(t,e)}else libtess.sweep.addRightEdges_(t,n,e.anEdge,e.anEdge,null,!0)}else libtess.sweep.connectLeftDegenerate_(t,n,e)},libtess.sweep.sweepEvent_=function(t,e){t.event=e;for(var i=e.anEdge;null===i.activeRegion;)if((i=i.oNext)===e.anEdge)return void libtess.sweep.connectLeftVertex_(t,e);var n=libtess.sweep.topLeftRegion_(i.activeRegion),r=n.regionBelow(),s=r.eUp,o=libtess.sweep.finishLeftRegions_(t,r,null);o.oNext===s?libtess.sweep.connectRightVertex_(t,n,o):libtess.sweep.addRightEdges_(t,n,o.oNext,s,s,!0)},libtess.sweep.addSentinel_=function(t,e){var i=new libtess.ActiveRegion,n=libtess.mesh.makeEdge(t.mesh);n.org.s=libtess.sweep.SENTINEL_COORD_,n.org.t=e,n.dst().s=-libtess.sweep.SENTINEL_COORD_,n.dst().t=e,t.event=n.dst(),i.eUp=n,i.windingNumber=0,i.inside=!1,i.fixUpperEdge=!1,i.sentinel=!0,i.dirty=!1,i.nodeUp=t.dict.insert(i)},libtess.sweep.initEdgeDict_=function(t){t.dict=new libtess.Dict(t,libtess.sweep.edgeLeq_),libtess.sweep.addSentinel_(t,-libtess.sweep.SENTINEL_COORD_),libtess.sweep.addSentinel_(t,libtess.sweep.SENTINEL_COORD_)},libtess.sweep.doneEdgeDict_=function(t){for(var e;null!==(e=t.dict.getMin().getKey());)e.sentinel,libtess.sweep.deleteRegion_(t,e);t.dict=null},libtess.sweep.removeDegenerateEdges_=function(t){for(var e,i=t.mesh.eHead,n=i.next;n!==i;n=e){e=n.next;var r=n.lNext;libtess.geom.vertEq(n.org,n.dst())&&n.lNext.lNext!==n&&(libtess.sweep.spliceMergeVertices_(t,r,n),libtess.mesh.deleteEdge(n),r=(n=r).lNext),r.lNext===n&&(r!==n&&(r!==e&&r!==e.sym||(e=e.next),libtess.mesh.deleteEdge(r)),n!==e&&n!==e.sym||(e=e.next),libtess.mesh.deleteEdge(n))}},libtess.sweep.initPriorityQ_=function(t){var e=new libtess.PriorityQ;t.pq=e;var i,n=t.mesh.vHead;for(i=n.next;i!==n;i=i.next)i.pqHandle=e.insert(i);e.init()},libtess.sweep.donePriorityQ_=function(t){t.pq.deleteQ(),t.pq=null},libtess.sweep.removeDegenerateFaces_=function(t){for(var e,i=t.fHead.next;i!==t.fHead;i=e){e=i.next;var n=i.anEdge;n.lNext.lNext===n&&(libtess.sweep.addWinding_(n.oNext,n),libtess.mesh.deleteEdge(n))}},libtess.tessmono={},libtess.tessmono.tessellateMonoRegion_=function(t){for(var e=t.anEdge;libtess.geom.vertLeq(e.dst(),e.org);e=e.lPrev());for(;libtess.geom.vertLeq(e.org,e.dst());e=e.lNext);for(var i,n=e.lPrev();e.lNext!==n;)if(libtess.geom.vertLeq(e.dst(),n.org)){for(;n.lNext!==e&&(libtess.geom.edgeGoesLeft(n.lNext)||libtess.geom.edgeSign(n.org,n.dst(),n.lNext.dst())<=0);)n=(i=libtess.mesh.connect(n.lNext,n)).sym;n=n.lPrev()}else{for(;n.lNext!==e&&(libtess.geom.edgeGoesRight(e.lPrev())||libtess.geom.edgeSign(e.dst(),e.org,e.lPrev().org)>=0);)i=libtess.mesh.connect(e,e.lPrev()),e=i.sym;e=e.lNext}for(;n.lNext.lNext!==e;)n=(i=libtess.mesh.connect(n.lNext,n)).sym},libtess.tessmono.tessellateInterior=function(t){for(var e,i=t.fHead.next;i!==t.fHead;i=e)e=i.next,i.inside&&libtess.tessmono.tessellateMonoRegion_(i)},libtess.tessmono.discardExterior=function(t){for(var e,i=t.fHead.next;i!==t.fHead;i=e)e=i.next,i.inside||libtess.mesh.zapFace(i)},libtess.tessmono.setWindingNumber=function(t,e,i){for(var n,r=t.eHead.next;r!==t.eHead;r=n)n=r.next,r.rFace().inside!==r.lFace.inside?r.winding=r.lFace.inside?e:-e:i?libtess.mesh.deleteEdge(r):r.winding=0},libtess.Dict=function(t,e){this.head_=new libtess.DictNode,this.frame_=t,this.leq_=e},libtess.Dict.prototype.deleteDict_=function(){},libtess.Dict.prototype.insertBefore=function(t,e){do{t=t.prev}while(null!==t.key&&!this.leq_(this.frame_,t.key,e));var i=new libtess.DictNode(e,t.next,t);return t.next.prev=i,t.next=i,i},libtess.Dict.prototype.insert=function(t){return this.insertBefore(this.head_,t)},libtess.Dict.prototype.deleteNode=function(t){t.next.prev=t.prev,t.prev.next=t.next},libtess.Dict.prototype.search=function(t){var e=this.head_;do{e=e.next}while(null!==e.key&&!this.leq_(this.frame_,t,e.key));return e},libtess.Dict.prototype.getMin=function(){return this.head_.next},libtess.Dict.prototype.getMax=function(){return this.head_.prev},libtess.DictNode=function(t,e,i){this.key=t||null,this.next=e||this,this.prev=i||this},libtess.DictNode.prototype.getKey=function(){return this.key},libtess.DictNode.prototype.getSuccessor=function(){return this.next},libtess.DictNode.prototype.getPredecessor=function(){return this.prev},libtess.GluTesselator=function(){this.state_=libtess.GluTesselator.tessState_.T_DORMANT,this.lastEdge_=null,this.mesh=null,this.errorCallback_=null,this.normal_=[0,0,0],this.windingRule=libtess.windingRule.GLU_TESS_WINDING_ODD,this.fatalError=!1,this.dict=null,this.pq=null,this.event=null,this.combineCallback_=null,this.boundaryOnly_=!1,this.beginCallback_=null,this.edgeFlagCallback_=null,this.vertexCallback_=null,this.endCallback_=null,this.meshCallback_=null,this.polygonData_=null},libtess.GluTesselator.tessState_={T_DORMANT:0,T_IN_POLYGON:1,T_IN_CONTOUR:2},libtess.GluTesselator.prototype.gluDeleteTess=function(){this.requireState_(libtess.GluTesselator.tessState_.T_DORMANT)},libtess.GluTesselator.prototype.gluTessProperty=function(t,e){switch(t){case libtess.gluEnum.GLU_TESS_TOLERANCE:return;case libtess.gluEnum.GLU_TESS_WINDING_RULE:var i=e;switch(i){case libtess.windingRule.GLU_TESS_WINDING_ODD:case libtess.windingRule.GLU_TESS_WINDING_NONZERO:case libtess.windingRule.GLU_TESS_WINDING_POSITIVE:case libtess.windingRule.GLU_TESS_WINDING_NEGATIVE:case libtess.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:return void(this.windingRule=i)}break;case libtess.gluEnum.GLU_TESS_BOUNDARY_ONLY:return void(this.boundaryOnly_=!!e);default:return void this.callErrorCallback(libtess.gluEnum.GLU_INVALID_ENUM)}this.callErrorCallback(libtess.gluEnum.GLU_INVALID_VALUE)},libtess.GluTesselator.prototype.gluGetTessProperty=function(t){switch(t){case libtess.gluEnum.GLU_TESS_TOLERANCE:return 0;case libtess.gluEnum.GLU_TESS_WINDING_RULE:return this.windingRule;case libtess.gluEnum.GLU_TESS_BOUNDARY_ONLY:return this.boundaryOnly_;default:this.callErrorCallback(libtess.gluEnum.GLU_INVALID_ENUM)}return!1},libtess.GluTesselator.prototype.gluTessNormal=function(t,e,i){this.normal_[0]=t,this.normal_[1]=e,this.normal_[2]=i},libtess.GluTesselator.prototype.gluTessCallback=function(t,e){var i=e||null;switch(t){case libtess.gluEnum.GLU_TESS_BEGIN:case libtess.gluEnum.GLU_TESS_BEGIN_DATA:return void(this.beginCallback_=i);case libtess.gluEnum.GLU_TESS_EDGE_FLAG:case libtess.gluEnum.GLU_TESS_EDGE_FLAG_DATA:return void(this.edgeFlagCallback_=i);case libtess.gluEnum.GLU_TESS_VERTEX:case libtess.gluEnum.GLU_TESS_VERTEX_DATA:return void(this.vertexCallback_=i);case libtess.gluEnum.GLU_TESS_END:case libtess.gluEnum.GLU_TESS_END_DATA:return void(this.endCallback_=i);case libtess.gluEnum.GLU_TESS_ERROR:case libtess.gluEnum.GLU_TESS_ERROR_DATA:return void(this.errorCallback_=i);case libtess.gluEnum.GLU_TESS_COMBINE:case libtess.gluEnum.GLU_TESS_COMBINE_DATA:return void(this.combineCallback_=i);case libtess.gluEnum.GLU_TESS_MESH:return void(this.meshCallback_=i);default:return void this.callErrorCallback(libtess.gluEnum.GLU_INVALID_ENUM)}},libtess.GluTesselator.prototype.gluTessVertex=function(t,e){var i=!1,n=[0,0,0];this.requireState_(libtess.GluTesselator.tessState_.T_IN_CONTOUR);for(var r=0;r<3;++r){var s=t[r];s<-libtess.GLU_TESS_MAX_COORD&&(s=-libtess.GLU_TESS_MAX_COORD,i=!0),s>libtess.GLU_TESS_MAX_COORD&&(s=libtess.GLU_TESS_MAX_COORD,i=!0),n[r]=s}i&&this.callErrorCallback(libtess.errorType.GLU_TESS_COORD_TOO_LARGE),this.addVertex_(n,e)},libtess.GluTesselator.prototype.gluTessBeginPolygon=function(t){this.requireState_(libtess.GluTesselator.tessState_.T_DORMANT),this.state_=libtess.GluTesselator.tessState_.T_IN_POLYGON,this.mesh=new libtess.GluMesh,this.polygonData_=t},libtess.GluTesselator.prototype.gluTessBeginContour=function(){this.requireState_(libtess.GluTesselator.tessState_.T_IN_POLYGON),this.state_=libtess.GluTesselator.tessState_.T_IN_CONTOUR,this.lastEdge_=null},libtess.GluTesselator.prototype.gluTessEndContour=function(){this.requireState_(libtess.GluTesselator.tessState_.T_IN_CONTOUR),this.state_=libtess.GluTesselator.tessState_.T_IN_POLYGON},libtess.GluTesselator.prototype.gluTessEndPolygon=function(){if(this.requireState_(libtess.GluTesselator.tessState_.T_IN_POLYGON),this.state_=libtess.GluTesselator.tessState_.T_DORMANT,libtess.normal.projectPolygon(this,this.normal_[0],this.normal_[1],this.normal_[2]),libtess.sweep.computeInterior(this),!this.fatalError){var t=this.mesh;if(this.boundaryOnly_?libtess.tessmono.setWindingNumber(t,1,!0):libtess.tessmono.tessellateInterior(t),this.mesh.checkMesh(),this.beginCallback_||this.endCallback_||this.vertexCallback_||this.edgeFlagCallback_)if(this.boundaryOnly_)libtess.render.renderBoundary(this,this.mesh);else{var e=!!this.edgeFlagCallback_;libtess.render.renderMesh(this,this.mesh,e)}if(this.meshCallback_)return libtess.tessmono.discardExterior(this.mesh),this.meshCallback_(this.mesh),this.mesh=null,void(this.polygonData_=null)}libtess.mesh.deleteMesh(this.mesh),this.polygonData_=null,this.mesh=null},libtess.GluTesselator.prototype.requireState_=function(t){this.state_!==t&&this.gotoState_(t)},libtess.GluTesselator.prototype.gotoState_=function(t){for(;this.state_!==t;)if(this.state_<t)switch(this.state_){case libtess.GluTesselator.tessState_.T_DORMANT:this.callErrorCallback(libtess.errorType.GLU_TESS_MISSING_BEGIN_POLYGON),this.gluTessBeginPolygon(null);break;case libtess.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorCallback(libtess.errorType.GLU_TESS_MISSING_BEGIN_CONTOUR),this.gluTessBeginContour()}else switch(this.state_){case libtess.GluTesselator.tessState_.T_IN_CONTOUR:this.callErrorCallback(libtess.errorType.GLU_TESS_MISSING_END_CONTOUR),this.gluTessEndContour();break;case libtess.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorCallback(libtess.errorType.GLU_TESS_MISSING_END_POLYGON),this.gluTessEndPolygon()}},libtess.GluTesselator.prototype.addVertex_=function(t,e){var i=this.lastEdge_;null===i?(i=libtess.mesh.makeEdge(this.mesh),libtess.mesh.meshSplice(i,i.sym)):(libtess.mesh.splitEdge(i),i=i.lNext),i.org.data=e,i.org.coords[0]=t[0],i.org.coords[1]=t[1],i.org.coords[2]=t[2],i.winding=1,i.sym.winding=-1,this.lastEdge_=i},libtess.GluTesselator.prototype.callBeginCallback=function(t){this.beginCallback_&&this.beginCallback_(t,this.polygonData_)},libtess.GluTesselator.prototype.callVertexCallback=function(t){this.vertexCallback_&&this.vertexCallback_(t,this.polygonData_)},libtess.GluTesselator.prototype.callEdgeFlagCallback=function(t){this.edgeFlagCallback_&&this.edgeFlagCallback_(t,this.polygonData_)},libtess.GluTesselator.prototype.callEndCallback=function(){this.endCallback_&&this.endCallback_(this.polygonData_)},libtess.GluTesselator.prototype.callCombineCallback=function(t,e,i){return this.combineCallback_&&this.combineCallback_(t,e,i,this.polygonData_)||null},libtess.GluTesselator.prototype.callErrorCallback=function(t){this.errorCallback_&&this.errorCallback_(t,this.polygonData_)},libtess.GluFace=function(t,e){this.next=t||this,this.prev=e||this,this.anEdge=null,this.data=null,this.inside=!1},libtess.GluHalfEdge=function(t){this.next=t||this,this.sym=null,this.oNext=null,this.lNext=null,this.org=null,this.lFace=null,this.activeRegion=null,this.winding=0},libtess.GluHalfEdge.prototype.rFace=function(){return this.sym.lFace},libtess.GluHalfEdge.prototype.dst=function(){return this.sym.org},libtess.GluHalfEdge.prototype.oPrev=function(){return this.sym.lNext},libtess.GluHalfEdge.prototype.lPrev=function(){return this.oNext.sym},libtess.GluHalfEdge.prototype.dPrev=function(){return this.lNext.sym},libtess.GluHalfEdge.prototype.rPrev=function(){return this.sym.oNext},libtess.GluHalfEdge.prototype.dNext=function(){return this.rPrev().sym},libtess.GluHalfEdge.prototype.rNext=function(){return this.oPrev().sym},libtess.GluMesh=function(){this.vHead=new libtess.GluVertex,this.fHead=new libtess.GluFace,this.eHead=new libtess.GluHalfEdge,this.eHeadSym=new libtess.GluHalfEdge,this.eHead.sym=this.eHeadSym,this.eHeadSym.sym=this.eHead},libtess.GluMesh.prototype.checkMesh=function(){if(libtess.DEBUG){var t,e,i,n=this.fHead,r=this.vHead,s=this.eHead,o=n;for(o=n;(e=o.next)!==n;o=e){t=e.anEdge;do{t=t.lNext}while(t!==e.anEdge)}var a=r;for(a=r;(i=a.next)!==r;a=i){t=i.anEdge;do{t=t.oNext}while(t!==i.anEdge)}var u=s;for(u=s;(t=u.next)!==s;u=t);}},libtess.GluVertex=function(t,e){this.next=t||this,this.prev=e||this,this.anEdge=null,this.data=null,this.coords=[0,0,0],this.s=0,this.t=0,this.pqHandle=0},libtess.PriorityQ=function(){this.verts_=[],this.order_=null,this.size_=0,this.initialized_=!1,this.heap_=new libtess.PriorityQHeap},libtess.PriorityQ.prototype.deleteQ=function(){this.heap_=null,this.order_=null,this.verts_=null},libtess.PriorityQ.prototype.init=function(){this.order_=[];for(var t=0;t<this.size_;t++)this.order_[t]=t;var e,i=(e=this.verts_,function(t,i){return libtess.geom.vertLeq(e[t],e[i])?1:-1});if(this.order_.sort(i),this.initialized_=!0,this.heap_.init(),libtess.DEBUG){var n=0+this.size_-1;for(t=0;t<n;++t);}},libtess.PriorityQ.prototype.insert=function(t){if(this.initialized_)return this.heap_.insert(t);var e=this.size_++;return this.verts_[e]=t,-(e+1)},libtess.PriorityQ.prototype.extractMin=function(){if(0===this.size_)return this.heap_.extractMin();var t=this.verts_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var e=this.heap_.minimum();if(libtess.geom.vertLeq(e,t))return this.heap_.extractMin()}do{--this.size_}while(this.size_>0&&null===this.verts_[this.order_[this.size_-1]]);return t},libtess.PriorityQ.prototype.minimum=function(){if(0===this.size_)return this.heap_.minimum();var t=this.verts_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var e=this.heap_.minimum();if(libtess.geom.vertLeq(e,t))return e}return t},libtess.PriorityQ.prototype.remove=function(t){if(t>=0)this.heap_.remove(t);else for(t=-(t+1),this.verts_[t]=null;this.size_>0&&null===this.verts_[this.order_[this.size_-1]];)--this.size_},libtess.PriorityQHeap=function(){this.heap_=libtess.PriorityQHeap.reallocNumeric_([0],libtess.PriorityQHeap.INIT_SIZE_+1),this.verts_=[null,null],this.handles_=[0,0],this.size_=0,this.max_=libtess.PriorityQHeap.INIT_SIZE_,this.freeList_=0,this.initialized_=!1,this.heap_[1]=1},libtess.PriorityQHeap.INIT_SIZE_=32,libtess.PriorityQHeap.reallocNumeric_=function(t,e){for(var i=new Array(e),n=0;n<t.length;n++)i[n]=t[n];for(;n<e;n++)i[n]=0;return i},libtess.PriorityQHeap.prototype.init=function(){for(var t=this.size_;t>=1;--t)this.floatDown_(t);this.initialized_=!0},libtess.PriorityQHeap.prototype.insert=function(t){var e,i=++this.size_;return 2*i>this.max_&&(this.max_*=2,this.handles_=libtess.PriorityQHeap.reallocNumeric_(this.handles_,this.max_+1)),0===this.freeList_?e=i:(e=this.freeList_,this.freeList_=this.handles_[this.freeList_]),this.verts_[e]=t,this.handles_[e]=i,this.heap_[i]=e,this.initialized_&&this.floatUp_(i),e},libtess.PriorityQHeap.prototype.isEmpty=function(){return 0===this.size_},libtess.PriorityQHeap.prototype.minimum=function(){return this.verts_[this.heap_[1]]},libtess.PriorityQHeap.prototype.extractMin=function(){var t=this.heap_,e=this.verts_,i=this.handles_,n=t[1],r=e[n];return this.size_>0&&(t[1]=t[this.size_],i[t[1]]=1,e[n]=null,i[n]=this.freeList_,this.freeList_=n,--this.size_>0&&this.floatDown_(1)),r},libtess.PriorityQHeap.prototype.remove=function(t){var e=this.heap_,i=this.verts_,n=this.handles_,r=n[t];if(e[r]=e[this.size_],n[e[r]]=r,r<=--this.size_)if(r<=1)this.floatDown_(r);else{var s=i[e[r]],o=i[e[r>>1]];libtess.geom.vertLeq(o,s)?this.floatDown_(r):this.floatUp_(r)}i[t]=null,n[t]=this.freeList_,this.freeList_=t},libtess.PriorityQHeap.prototype.floatDown_=function(t){for(var e=this.heap_,i=this.verts_,n=this.handles_,r=t,s=e[r];;){var o=r<<1;o<this.size_&&libtess.geom.vertLeq(i[e[o+1]],i[e[o]])&&(o+=1);var a=e[o];if(o>this.size_||libtess.geom.vertLeq(i[s],i[a]))return e[r]=s,void(n[s]=r);e[r]=a,n[a]=r,r=o}},libtess.PriorityQHeap.prototype.floatUp_=function(t){for(var e=this.heap_,i=this.verts_,n=this.handles_,r=t,s=e[r];;){var o=r>>1,a=e[o];if(0===o||libtess.geom.vertLeq(i[a],i[s]))return e[r]=s,void(n[s]=r);e[r]=a,n[a]=r,r=o}},libtess.ActiveRegion=function(){this.eUp=null,this.nodeUp=null,this.windingNumber=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperEdge=!1},libtess.ActiveRegion.prototype.regionBelow=function(){return this.nodeUp.getPredecessor().getKey()},libtess.ActiveRegion.prototype.regionAbove=function(){return this.nodeUp.getSuccessor().getKey()},void 0!==module&&(module.exports=libtess),define("libtess",["libtess/libtess.cat"],(function(t){return t})),define("libtess/libtess.cat",(function(){})),define("standard/Math/Geometry/Triangle3",["standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4","libtess"],(function(t,e){"use strict";return{area:function(){const e=new t(0,0,0),i=new t(0,0,0);return function(t,n,r){return e.assign(n).subtract(t).cross(i.assign(r).subtract(t)).magnitude()/2}}(),normal:function(t,e,i,n){const r=i.x-e.x,s=i.y-e.y,o=i.z-e.z,a=t.x-e.x,u=t.y-e.y,l=t.z-e.z;return n.set(s*l-o*u,o*a-r*l,r*u-s*a),n.normalize()},quadNormal:function(t,e,i,n,r){const s=i.x-t.x,o=i.y-t.y,a=i.z-t.z,u=n.x-e.x,l=n.y-e.y,c=n.z-e.z;return r.set(o*c-a*l,a*u-s*c,s*l-o*u),r.normalize()},triangulatePolygon:function(){const t=function(){const t=new libtess.GluTesselator;return t.gluTessCallback(libtess.gluEnum.GLU_TESS_VERTEX_DATA,(function(t,e){e[e.length]=t})),t.gluTessCallback(libtess.gluEnum.GLU_TESS_BEGIN,(function(t){t!==libtess.primitiveType.GL_TRIANGLES&&console.log("expected TRIANGLES but got type: "+t)})),t.gluTessCallback(libtess.gluEnum.GLU_TESS_ERROR,(function(t){console.log("error callback"),console.log("error number: "+t)})),t.gluTessCallback(libtess.gluEnum.GLU_TESS_COMBINE,(function(t,e,i){return e[0]})),t.gluTessCallback(libtess.gluEnum.GLU_TESS_EDGE_FLAG,(function(t){})),t.gluTessProperty(libtess.gluEnum.GLU_TESS_TOLERANCE,0),t.gluTessProperty(libtess.gluEnum.GLU_TESS_WINDING_RULE,libtess.windingRule.GLU_TESS_WINDING_ODD),t}();return function(){const e=arguments[arguments.length-1];t.gluTessBeginPolygon(e);for(let e=0,i=arguments.length-1;e<i;++e){t.gluTessBeginContour();for(const i of arguments[e])t.gluTessVertex(i,i);t.gluTessEndContour()}return t.gluTessEndPolygon(),e}}(),triangulateConvexPolygon:function(t,e){for(let i=1,n=t.length-1;i<n;++i)e.push(t[0],t[i],t[i+1])},getPolygonNormal:function(t,e){e.set(0,0,0);var i=t[0];for(let r=0,s=t.length;r<s;++r){var n=i;i=t[(r+1)%s];e.x+=(n.y-i.y)*(n.z+i.z),e.y+=(n.z-i.z)*(n.x+i.x),e.z+=(n.x-i.x)*(n.y+i.y)}return e.normalize()}}})),define("standard/Math/Algorithms/SAT",[],(function(){"use strict";const t={min:0,max:0},e={min:0,max:0};function i(){}function n(t,e,i){i.min=Number.POSITIVE_INFINITY,i.max=Number.NEGATIVE_INFINITY;for(const n of t){const t=n.dot(e);t<i.min&&(i.min=t),t>i.max&&(i.max=t)}}function r(t,e,i){return e<=t&&t<=i}return i.isSeparated=function(i,s,o){for(const c of i)if(n(s,c,t),n(o,c,e),l=e.max,!r(u=e.min,a=t.min,t.max)&&!r(a,u,l))return!0;var a,u,l;return!1},i})),define("standard/Math/Geometry/ViewVolume",["standard/Math/Geometry/Plane3","standard/Math/Geometry/Triangle3","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Numbers/Matrix4","standard/Math/Algorithms/SAT"],(function(t,e,i,n,r,s,o){"use strict";function a(e,i,s){this.viewport=new r(0,0,0,0),this.scissor=new r(0,0,0,0),this.points=[new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0)],this.normals=[new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0)],this.edges=[new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0)],this.planes=[new t(n.Zero,n.Zero),new t(n.Zero,n.Zero),new t(n.Zero,n.Zero),new t(n.Zero,n.Zero),new t(n.Zero,n.Zero),new t(n.Zero,n.Zero)],arguments.length&&this.set(e,i,s)}return a.prototype={constructor:a,set:function(){const t=new s;return function(i,n,r){this.viewport.assign(n),this.scissor.assign(r);const s=this.points,o=s[0],u=s[1],l=s[2],c=s[3],h=s[4],d=s[5],p=s[6],f=s[7],g=r[0],m=g+r[2],_=r[1],y=_+r[3];t.assign(i).inverse(),a.unProjectPointMatrix(g,_,0,t,n,o),a.unProjectPointMatrix(m,_,0,t,n,u),a.unProjectPointMatrix(m,y,0,t,n,l),a.unProjectPointMatrix(g,y,0,t,n,c),a.unProjectPointMatrix(g,_,1,t,n,h),a.unProjectPointMatrix(m,_,1,t,n,d),a.unProjectPointMatrix(m,y,1,t,n,p),a.unProjectPointMatrix(g,y,1,t,n,f);const x=this.normals;e.normal(o,u,l,x[0]),e.normal(f,h,o,x[1]),e.normal(p,l,u,x[2]),e.normal(l,p,f,x[3]),e.normal(u,o,h,x[4]),e.normal(h,f,p,x[5]);const w=this.planes;return w[0].set(u,x[0]),w[1].set(h,x[1]),w[2].set(l,x[2]),w[3].set(p,x[3]),w[4].set(o,x[4]),w[5].set(f,x[5]),this.edges.tainted=!0,this}}(),getViewport:function(){return this.viewport},getScissor:function(){return this.scissor},getEdges:function(){const t=this.edges;if(t.tainted){const e=this.points;t[0].assign(e[0]).subtract(e[1]),t[1].assign(e[1]).subtract(e[2]),t[2].assign(e[2]).subtract(e[3]),t[3].assign(e[3]).subtract(e[0]),t[4].assign(e[0]).subtract(e[4]),t[5].assign(e[1]).subtract(e[5]),t[6].assign(e[2]).subtract(e[6]),t[7].assign(e[3]).subtract(e[7]),t.tainted=!1}return t},intersectsSphere:function(t,e){const i=this.planes;return!(i[0].getDistanceToPoint(e)>t)&&(!(i[1].getDistanceToPoint(e)>t)&&(!(i[2].getDistanceToPoint(e)>t)&&(!(i[3].getDistanceToPoint(e)>t)&&(!(i[4].getDistanceToPoint(e)>t)&&!(i[5].getDistanceToPoint(e)>t)))))},intersectsBox:function(){const t=[new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0),new n(0,0,0)],e=[new n(0,0,0),new n(0,0,0),new n(0,0,0)],i=[new n(0,0,0),new n(0,0,0),new n(0,0,0)],r=[];for(let t=0;t<24;++t)r.push(new n(0,0,0));return function(n){n.getPoints(t);const s=this.points;if(o.isSeparated(n.getNormals(e),t,s))return!1;if(o.isSeparated(this.normals,t,s))return!1;n.getAxes(i);const a=this.getEdges();for(let t=0;t<3;++t)for(let e=0;e<8;++e)r[3*t+e].assign(i[t]).cross(a[e]);return!o.isSeparated(r,t,s)}}()},Object.assign(a,{unProjectPoint:function(){const t=new s;return function(e,i,n,r,s,o,a){return this.unProjectPointMatrix(e,i,n,t.assign(r).multRight(s).inverse(),o,a)}}(),unProjectPointMatrix:function(){const t=new r(0,0,0,0);return function(e,i,n,r,s,o){t.set((e-s[0])/s[2]*2-1,(i-s[1])/s[3]*2-1,2*n-1,1),r.multVecMatrix(t);const a=1/t.w;return o.set(t.x*a,t.y*a,t.z*a,1)}}(),unProjectRay:function(){const t=new s;return function(e,i,n,r,s,o){return this.unProjectRayMatrix(e,i,t.assign(n).multRight(r).inverse(),s,o)}}(),unProjectRayMatrix:function(){const t=new n(0,0,0),e=new n(0,0,0);return function(i,n,r,s,o){return a.unProjectPointMatrix(i,n,0,r,s,t),a.unProjectPointMatrix(i,n,.9,r,s,e),o.setPoints(t,e)}}(),projectPoint:function(){const t=new r(0,0,0,0);return function(e,i,n,r,s){4===e.length?t.assign(e):t.set(e.x,e.y,e.z,1),n.multVecMatrix(i.multVecMatrix(t));const o=1/(2*t.w);return s.set((t.x*o+.5)*r[2]+r[0],(t.y*o+.5)*r[3]+r[1],t.z*o+.5)}}(),projectPointMatrix:function(){const t=new r(0,0,0,0);return function(e,i,n,r){4===e.length?t.assign(e):t.set(e.x,e.y,e.z,1),i.multVecMatrix(t);const s=1/(2*t.w);return r.set((t.x*s+.5)*n[2]+n[0],(t.y*s+.5)*n[3]+n[1],t.z*s+.5)}}(),projectLine:function(){const t=new s;return function(e,i,n,r,s){return this.projectLineMatrix(e,t.assign(i).multRight(n),r,s)}}(),projectLineMatrix:function(){const t=new i(0,0),e=new i(0,0),r=new n(0,0,0);return function(i,n,s,o){return a.projectPointMatrix(i.point,n,s,t),a.projectPointMatrix(r.assign(i.direction).multiply(1e9).add(i.point),n,s,e),o.setPoints(t,e)}}()}),a})),define("x_ite/Rendering/TextureBuffer",["standard/Math/Geometry/ViewVolume","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4"],(function(t,e,i){"use strict";function n(t,e,i){const n=t.getContext();if(this.browser=t,this.width=e,this.height=i,this.array=new Uint8Array(e*i*4),this.lastBuffer=n.getParameter(n.FRAMEBUFFER_BINDING),this.buffer=n.createFramebuffer(),n.bindFramebuffer(n.FRAMEBUFFER,this.buffer),this.colorTexture=n.createTexture(),n.bindTexture(n.TEXTURE_2D,this.colorTexture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,e,i,0,n.RGBA,n.UNSIGNED_BYTE,null),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,this.colorTexture,0),n.getVersion()>=2||n.getExtension("WEBGL_depth_texture")){this.depthTexture=n.createTexture(),n.bindTexture(n.TEXTURE_2D,this.depthTexture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST);const t=n.getVersion()>=2?n.DEPTH_COMPONENT24:n.DEPTH_COMPONENT;n.texImage2D(n.TEXTURE_2D,0,t,e,i,0,n.DEPTH_COMPONENT,n.UNSIGNED_INT,null),n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,this.depthTexture,0)}else this.depthBuffer=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,this.depthBuffer),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_COMPONENT16,e,i),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,this.depthBuffer);const r=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;if(n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,this.lastBuffer),!r)throw new Error("Couldn't create frame buffer.")}n.prototype={constructor:n,getWidth:function(){return this.width},getHeight:function(){return this.height},getColorTexture:function(){return this.colorTexture},getDepthTexture:function(){return this.depthTexture},readPixels:function(){const t=this.browser.getContext(),e=this.array,i=this.width,n=this.height;return t.readPixels(0,0,i,n,t.RGBA,t.UNSIGNED_BYTE,e),e},getDepth:function(){const n=new i,r=new e(0,0,0);return function(e,i){const s=this.browser.getContext(),o=this.array,a=this.width,u=this.height;let l=0,c=0,h=Number.POSITIVE_INFINITY;n.assign(e).inverse(),s.readPixels(0,0,a,u,s.RGBA,s.UNSIGNED_BYTE,o);for(let t=0,e=0;t<u;++t)for(let i=0;i<a;++i,e+=4){const n=o[e]/255+o[e+1]/65025+o[e+2]/16581375+o[e+3]/4228250625;n<h&&(l=i,c=t,h=n)}return t.unProjectPointMatrix(l,c,h,n,i,r),r.z}}(),bind:function(){const t=this.browser.getContext();this.lastBuffer=t.getParameter(t.FRAMEBUFFER_BINDING),t.bindFramebuffer(t.FRAMEBUFFER,this.buffer)},unbind:function(){const t=this.browser.getContext();t.bindFramebuffer(t.FRAMEBUFFER,this.lastBuffer)},delete:function(){const t=this.browser.getContext();t.deleteFramebuffer(this.buffer),t.deleteTexture(this.colorTexture),t.getVersion()>=2||t.getExtension("WEBGL_depth_texture")?t.deleteTexture(this.depthTexture):t.deleteRenderbuffer(this.depthBuffer)}};for(const t of Reflect.ownKeys(n.prototype))Object.defineProperty(n.prototype,t,{enumerable:!1});return n})),define("standard/Math/Algorithms/MergeSort",[],(function(){"use strict";function t(t,e){this.array=t,this.auxiliary=[],e&&(this.compare=e)}return t.prototype={compare:function(t,e){return t<e},sort:function(t,e){this.mergeSort(t,e-1)},mergeSort:function(t,e){if(t<e){const i=t+e>>>1;this.mergeSort(t,i),this.mergeSort(i+1,e),this.merge(t,i,e)}},merge:function(t,e,i){let n,r,s;for(n=0,r=t;r<=e;)this.auxiliary[n++]=this.array[r++];for(n=0,s=t;s<r&&r<=i;)this.compare(this.array[r],this.auxiliary[n])?this.array[s++]=this.array[r++]:this.array[s++]=this.auxiliary[n++];for(;s<r;)this.array[s++]=this.auxiliary[n++]}},t})),define("standard/Math/Geometry/Box3",["standard/Math/Geometry/Triangle3","standard/Math/Numbers/Matrix4","standard/Math/Numbers/Vector3","standard/Math/Algorithms/SAT"],(function(t,e,i,n){"use strict";function r(t,i){switch(arguments.length){case 0:return void(this.matrix=new e(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0));case 2:return void(this.matrix=new e(t.x/2,0,0,0,0,t.y/2,0,0,0,0,t.z/2,0,i.x,i.y,i.z,1));case 3:{const t=arguments[0],i=arguments[1],n=(i.x-t.x)/2,r=(i.y-t.y)/2,s=(i.z-t.z)/2,o=(i.x+t.x)/2,a=(i.y+t.y)/2,u=(i.z+t.z)/2;return void(this.matrix=new e(n,0,0,0,0,r,0,0,0,0,s,0,o,a,u,1))}}}return r.prototype={constructor:r,copy:function(){const t=Object.create(r.prototype);return t.matrix=this.matrix.copy(),t},assign:function(t){return this.matrix.assign(t.matrix),this},equals:function(t){return this.matrix.equals(t.matrix)},getMatrix:function(){return this.matrix},set:function(t,e){const i=this.matrix;switch(arguments.length){case 0:return i[0]=.5,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=.5,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=.5,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=0,this;case 2:return i[0]=t.x/2,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=t.y/2,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=t.z/2,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this;case 3:{const t=arguments[0],e=arguments[1],i=(e.x-t.x)/2,n=(e.y-t.y)/2,r=(e.z-t.z)/2,s=(e.x+t.x)/2,o=(e.y+t.y)/2,a=(e.z+t.z)/2;return this.matrix.set(i,0,0,0,0,n,0,0,0,0,r,0,s,o,a,1),this}}},setExtents:function(t,e){const i=this.matrix,n=(e.x-t.x)/2,r=(e.y-t.y)/2,s=(e.z-t.z)/2,o=(e.x+t.x)/2,a=(e.y+t.y)/2,u=(e.z+t.z)/2;return i[0]=n,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=r,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=s,i[11]=0,i[12]=o,i[13]=a,i[14]=u,i[15]=1,this},getExtents:function(t,e){this.getAbsoluteExtents(t,e),t.add(this.center),e.add(this.center)},getAbsoluteExtents:function(){const t=new i(0,0,0),e=new i(0,0,0),n=new i(0,0,0);return function(i,r){const s=this.matrix,o=s.xAxis,a=s.yAxis,u=s.zAxis;t.assign(a).add(u);const l=u.subtract(a);e.assign(o).add(t),n.assign(o).add(l);const c=t.subtract(o),h=l.subtract(o);i.assign(e),r.assign(e),i.min(c,h,n),r.max(c,h,n),e.negate(),c.negate(),h.negate(),n.negate(),i.min(e,c,h,n),r.max(e,c,h,n)}}(),getPoints:function(){const t=new i(0,0,0),e=new i(0,0,0),n=new i(0,0,0),r=new i(0,0,0);return function(i){const s=this.matrix;t.assign(s.xAxis),e.assign(s.yAxis),n.assign(s.zAxis),r.assign(e).add(n);const o=n.subtract(e);i[0].assign(t).add(r),i[1].assign(r).subtract(t),i[2].assign(o).subtract(t),i[3].assign(t).add(o),i[4].assign(i[2]).negate(),i[5].assign(i[3]).negate(),i[6].assign(i[0]).negate(),i[7].assign(i[1]).negate();const a=this.center;return i[0].add(a),i[1].add(a),i[2].add(a),i[3].add(a),i[4].add(a),i[5].add(a),i[6].add(a),i[7].add(a),i}}(),getAxes:function(t){const e=this.matrix;return t[0].assign(e.xAxis),t[1].assign(e.yAxis),t[2].assign(e.zAxis),t},getNormals:function(){const t=new i(0,0,0),e=new i(0,0,0),n=new i(0,0,0),r=[i.xAxis,i.yAxis,i.zAxis];return function(s){const o=this.matrix;if(t.assign(o.xAxis),e.assign(o.yAxis),n.assign(o.zAxis),0===t.norm()&&(t.assign(e).cross(n),0===t.norm())){for(const i of r)if(t.assign(i).cross(e),0!==t.norm())break;if(0===t.norm()){for(const e of r)if(t.assign(e).cross(n),0!==t.norm())break;0===t.norm()&&t.assign(i.xAxis)}}if(0===e.norm()&&(e.assign(n).cross(t),0===e.norm())){for(const t of r)if(e.assign(t).cross(n),0!==e.norm())break;if(0===e.norm()){for(const i of r)if(e.assign(i).cross(t),0!==e.norm())break;0===e.norm()&&e.assign(i.yAxis)}}if(0===n.norm()&&(n.assign(t).cross(e),0===n.norm())){for(const e of r)if(n.assign(e).cross(t),0!==n.norm())break;if(0===n.norm()){for(const t of r)if(n.assign(t).cross(e),0!==n.norm())break;0===n.norm()&&n.assign(i.zAxis)}}return s[0].assign(e).cross(n).normalize(),s[1].assign(n).cross(t).normalize(),s[2].assign(t).cross(e).normalize(),s}}(),isEmpty:function(){return 0===this.matrix[15]},add:function(){const t=new i(0,0,0),e=new i(0,0,0),n=new i(0,0,0),r=new i(0,0,0);return function(i){return this.isEmpty()?this.assign(i):i.isEmpty()?this:(this.getExtents(t,e),i.getExtents(n,r),this.set(t.min(n),e.max(r),!0))}}(),multLeft:function(t){return this.matrix.multLeft(t),this},multRight:function(t){return this.matrix.multRight(t),this},containsPoint:function(){const t=new i(0,0,0),e=new i(0,0,0);return function(i){return this.getExtents(t,e),t.x<=i.x&&e.x>=i.x&&t.y<=i.y&&e.y>=i.y&&t.z<=i.z&&e.z>=i.z}}(),intersectsBox:function(){const t=[new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0)],e=[new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0)],r=[new i(0,0,0),new i(0,0,0),new i(0,0,0)],s=[new i(0,0,0),new i(0,0,0),new i(0,0,0)],o=[new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0)],a=[new i(0,0,0),new i(0,0,0),new i(0,0,0)];return function(i){if(this.isEmpty())return!1;if(i.isEmpty())return!1;if(this.getPoints(t),i.getPoints(e),n.isSeparated(this.getNormals(a),t,e))return!1;if(n.isSeparated(i.getNormals(a),t,e))return!1;this.getAxes(r),i.getAxes(s);for(let t=0;t<3;++t)for(let e=0;e<3;++e)o[3*t+e].assign(r[t]).cross(s[e]);return!n.isSeparated(o,t,e)}}(),intersectsTriangle:function(){const e=[new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0)],r=[new i(0,0,0),new i(0,0,0),new i(0,0,0)],s=[new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0)],o=[new i(0,0,0),new i(0,0,0),new i(0,0,0)],a=[],u=[new i(0,0,0)],l=[new i(0,0,0),new i(0,0,0),new i(0,0,0)];return function(i,c,h){if(this.isEmpty())return!1;if(this.getPoints(e),a[0]=i,a[1]=c,a[2]=h,n.isSeparated(this.getNormals(o),e,a))return!1;if(t.normal(i,c,h,u[0]),n.isSeparated(u,e,a))return!1;this.getAxes(r),l[0].assign(i).subtract(c),l[1].assign(c).subtract(h),l[2].assign(h).subtract(i);for(let t=0;t<3;++t)for(let e=0;e<3;++e)s[3*t+e].assign(r[t]).cross(l[e]);return!n.isSeparated(s,e,a)}}(),toString:function(){return this.size+", "+this.center}},Object.defineProperty(r.prototype,"size",{get:function(){const t=new i(0,0,0),e=new i(0,0,0);return function(){return this.getAbsoluteExtents(t,e),e.subtract(t)}}(),enumerable:!0,configurable:!1}),Object.defineProperty(r.prototype,"center",{get:function(){return this.matrix.origin},enumerable:!0,configurable:!1}),r})),define("standard/Math/Utility/MatrixStack",[],(function(){"use strict";return function(t){return Object.assign([new t],{top:0,set:function(t){this[this.top].assign(t)},get:function(){return this[this.top]},push:function(){const t=++this.top;t<this.length?this[t].assign(this[t-1]):this[t]=this[t-1].copy()},pushMatrix:function(t){const e=++this.top;e<this.length?this[e].assign(t):this[e]=t.copy()},pop:function(){--this.top},clear:function(){this.top=0},size:function(){return this.top+1},identity:function(){this[this.top].identity()},multLeft:function(t){this[this.top].multLeft(t)},translate:function(t){this[this.top].translate(t)},rotate:function(t){this[this.top].rotate(t)},scale:function(t){this[this.top].scale(t)}})}})),define("x_ite/Rendering/X3DRenderObject",["x_ite/Rendering/TextureBuffer","x_ite/Rendering/TraverseType","standard/Math/Algorithm","standard/Math/Algorithms/MergeSort","standard/Math/Geometry/Camera","standard/Math/Geometry/Box3","standard/Math/Geometry/ViewVolume","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Utility/MatrixStack"],(function(t,e,i,n,r,s,o,a,u,l,c,h){"use strict";function d(t,e){return t.distance<e.distance}function p(e){this.viewVolumes=[],this.cameraSpaceMatrix=new h(c),this.viewMatrix=new h(c),this.projectionMatrix=new h(c),this.modelViewMatrix=new h(c),this.viewportArray=new Int32Array(4),this.projectionMatrixArray=new Float32Array(16),this.cameraSpaceMatrixArray=new Float32Array(16),this.globalObjects=[],this.localObjects=[],this.lights=[],this.shadows=[!1],this.localFogs=[null],this.layouts=[],this.textureProjectors=[],this.generatedCubeMapTextures=[],this.collisions=[],this.numOpaqueShapes=0,this.numTransparentShapes=0,this.numCollisionShapes=0,this.numDepthShapes=0,this.opaqueShapes=[],this.transparentShapes=[],this.transparencySorter=new n(this.transparentShapes,d),this.collisionShapes=[],this.activeCollisions=new Set,this.depthShapes=[],this.speed=0;try{this.depthBuffer=new t(e.getBrowser(),16,16)}catch(t){console.error(t),this.getDepth=function(){return 0}}}function f(t,e){for(var i=0,n=e.length;i<n;++i)t[i]=e[i];t.length=n}return p.prototype={constructor:p,initialize:function(){},isIndependent:function(){return!0},getRenderTime:function(){return this.renderTime},getViewVolumes:function(){return this.viewVolumes},getViewVolume:function(){return this.viewVolumes.at(-1)},getCameraSpaceMatrix:function(){return this.cameraSpaceMatrix},getViewMatrix:function(){return this.viewMatrix},getProjectionMatrix:function(){return this.projectionMatrix},getModelViewMatrix:function(){return this.modelViewMatrix},getViewportArray:function(){return this.viewportArray},getProjectionMatrixArray:function(){return this.projectionMatrixArray},getCameraSpaceMatrixArray:function(){return this.cameraSpaceMatrixArray},getGlobalObjects:function(){return this.globalObjects},getLocalObjects:function(){return this.localObjects},getLights:function(){return this.lights},pushShadows:function(t){this.shadows.push(t||this.shadows.at(-1))},popShadows:function(){this.shadows.pop()},setGlobalFog:function(){const t=new c;return function(e){if(e.getFogType()){const i=this.localFogs[0]||e.getFogs().pop();t.assign(e.getModelMatrix()).multRight(this.getViewMatrix().get()),i.set(e,t),this.localFogs[0]=i}else this.localFogs[0]=null}}(),getLocalFogs:function(){return this.localFogs},getLayouts:function(){return this.layouts},getParentLayout:function(){return this.layouts.at(-1)},getTextureProjectors:function(){return this.textureProjectors},getGeneratedCubeMapTextures:function(){return this.generatedCubeMapTextures},getCollisions:function(){return this.collisions},setNumCollisionShapes:function(t){this.numCollisionShapes=t},getNumCollisionShapes:function(){return this.numCollisionShapes},getCollisionShapes:function(){return this.collisionShapes},setNumDepthShapes:function(t){this.numDepthShapes=t},getNumDepthShapes:function(){return this.numDepthShapes},getDepthShapes:function(){return this.depthShapes},setNumOpaqueShapes:function(t){this.numOpaqueShapes=t},getNumOpaqueShapes:function(){return this.numOpaqueShapes},getOpaqueShapes:function(){return this.opaqueShapes},setNumTransparentShapes:function(t){this.numTransparentShapes=t},getNumTransparentShapes:function(){return this.numTransparentShapes},getTransparentShapes:function(){return this.transparentShapes},constrainTranslation:function(t,e){const i=this.getDistance(t)-this.getNavigationInfo().getCollisionRadius();if(i>0){return t.magnitude()>i?t.normalize().multiply(i):t}return e?this.constrainTranslation(t.normalize().multiply(i),!1):t.assign(a.Zero)},getDistance:function(){const t=new c,e=new c,i=new l(0,0,1,0),n=new a(0,0,0),s=new l(0,0,1,0);return function(o){const u=performance.now(),l=this.getViewpoint(),c=this.getNavigationInfo(),h=c.getCollisionRadius(),d=c.getStepHeight()-c.getAvatarHeight(),p=c.getNearValue(),f=c.getAvatarHeight();r.ortho(-h,h,Math.min(d,-h),h,p,Math.max(2*h,2*f),t),i.assign(l._orientation.getValue()).inverse().multRight(l.getOrientation()),s.setFromToVec(a.zAxis,n.assign(o).negate()).multRight(i),l.straightenHorizon(s),e.assign(l.getModelMatrix()),e.translate(l.getUserPosition()),e.rotate(s),e.inverse(),e.multRight(t),e.multLeft(l.getCameraSpaceMatrix()),this.getProjectionMatrix().pushMatrix(e);const g=this.getDepth(t);return this.getProjectionMatrix().pop(),this.collisionTime+=performance.now()-u,-g}}(),getDepth:function(){const t=new u(0,0,16,16),e=new o;return e.set(c.Identity,t,t),function(i){this.depthBuffer.bind(),this.viewVolumes.push(e),this.depth(this.collisionShapes,this.numCollisionShapes),this.viewVolumes.pop();const n=this.depthBuffer.getDepth(i,t);return this.depthBuffer.unbind(),n}}(),render:function(t,i,n){switch(t){case e.COLLISION:this.numCollisionShapes=0,i.call(n,t,this),this.collide(),this.gravite();break;case e.SHADOW:this.numDepthShapes=0,i.call(n,t,this),this.depth(this.depthShapes,this.numDepthShapes);break;case e.DISPLAY:this.lightIndex=0,this.numOpaqueShapes=0,this.numTransparentShapes=0,this.setGlobalFog(this.getFog()),i.call(n,t,this),this.draw()}},addCollisionShape:function(){const t=new a(0,0,0),e=new a(0,0,0);return function(i){const n=this.getModelViewMatrix().get();n.multDirMatrix(t.assign(i.getBBoxSize())),n.multVecMatrix(e.assign(i.getBBoxCenter()));const r=t.magnitude()/2,s=this.viewVolumes.at(-1);if(s.intersectsSphere(r,e)){const t=this.numCollisionShapes++;t===this.collisionShapes.length&&this.collisionShapes.push({renderer:this,modelViewMatrix:new Float32Array(16),collisions:[],clipPlanes:[]});const e=this.collisionShapes[t];return e.modelViewMatrix.set(n),e.shapeNode=i,e.scissor=s.getScissor(),f(e.collisions,this.collisions),f(e.clipPlanes,this.localObjects),!0}return!1}}(),addDepthShape:function(){const t=new a(0,0,0),e=new a(0,0,0);return function(i){const n=this.getModelViewMatrix().get();n.multDirMatrix(t.assign(i.getBBoxSize())),n.multVecMatrix(e.assign(i.getBBoxCenter()));const r=t.magnitude()/2,s=this.viewVolumes.at(-1);if(s.intersectsSphere(r,e)){const t=this.numDepthShapes++;t===this.depthShapes.length&&this.depthShapes.push({renderer:this,modelViewMatrix:new Float32Array(16),clipPlanes:[]});const e=this.depthShapes[t];return e.modelViewMatrix.set(n),e.shapeNode=i,e.scissor=s.getScissor(),f(e.clipPlanes,this.localObjects),!0}return!1}}(),addDisplayShape:function(){const t=new a(0,0,0),e=new a(0,0,0);return function(i){const n=this.getModelViewMatrix().get();n.multDirMatrix(t.assign(i.getBBoxSize())),n.multVecMatrix(e.assign(i.getBBoxCenter()));const r=t.magnitude()/2,s=this.viewVolumes.at(-1);if(s.intersectsSphere(r,e)){if(i.getTransparent()){const t=this.numTransparentShapes++;t===this.transparentShapes.length&&this.transparentShapes.push(this.createShapeContext(!0));var o=this.transparentShapes[t]}else{const t=this.numOpaqueShapes++;t===this.opaqueShapes.length&&this.opaqueShapes.push(this.createShapeContext(!1));o=this.opaqueShapes[t]}return o.modelViewMatrix.set(n),o.scissor.assign(s.getScissor()),o.shapeNode=i,o.appearanceNode=i.getAppearance(),o.textureNode=null,o.distance=e.z,o.fogNode=this.localFogs.at(-1),o.shadows=this.shadows.at(-1),f(o.localObjects,this.localObjects),!0}return!1}}(),createShapeContext:function(t){return{renderer:this,transparent:t,modelViewMatrix:new Float32Array(16),scissor:new u(0,0,0,0),localObjects:[]}},collide:function(){const t=new c,e=new c,n=new s(a.Zero,a.Zero),r=new a(0,0,0);return function(){const s=new Set,o=2.2*this.getNavigationInfo().getCollisionRadius();r.set(o,o,o);for(let i=0,o=this.numCollisionShapes;i<o;++i){const o=this.collisionShapes[i],u=o.collisions;if(u.length&&(n.set(r,a.Zero),n.multRight(t.assign(o.modelViewMatrix).inverse()),o.shapeNode.intersectsBox(n,o.clipPlanes,e.assign(o.modelViewMatrix))))for(const t of u)s.add(t)}if(this.activeCollisions.size){const t=s.size?i.set_difference(this.activeCollisions,s,new Set):this.activeCollisions;for(const e of t)e.set_active(!1)}this.activeCollisions=s;for(const t of s)t.set_active(!0)}}(),gravite:function(){const t=new c,e=new c,i=new a(0,0,0),n=new l(0,0,1,0);return function(){const s=this.getBrowser();if(s.getDepthShader().isValid()){if(s.getActiveLayer()===this){if("WALK"!==s.getCurrentViewer())return}else if("WALK"!==this.getNavigationInfo().getViewer())return;const o=this.getNavigationInfo(),u=this.getViewpoint(),l=o.getCollisionRadius(),c=o.getNearValue(),h=o.getAvatarHeight(),d=o.getStepHeight();r.ortho(-l,l,-l,l,c,Math.max(2*l,2*h),t);const p=u.getUpVector(),f=n.setFromToVec(a.zAxis,p);e.assign(u.getModelMatrix()),e.translate(u.getUserPosition()),e.rotate(f),e.inverse(),e.multRight(t),e.multLeft(u.getCameraSpaceMatrix()),this.getProjectionMatrix().pushMatrix(e);let g=-this.getDepth(t);this.getProjectionMatrix().pop(),g-=h;const m=n.setFromToVec(a.yAxis,p);if(g>0){const t=this.speed?s.getCurrentFrameRate():1e6;this.speed-=s.getBrowserOptions()._Gravity.getValue()/t;let e=this.speed/t;e<-g&&(e=-g,this.speed=0),u._positionOffset=u._positionOffset.getValue().add(m.multVecRot(i.set(0,e,0)))}else this.speed=0,g=-g,g>.01&&g<d&&(this.constrainTranslation(m.multVecRot(i.set(0,g,0)),!1),u._positionOffset=i.add(u._positionOffset.getValue()))}}}(),depth:function(){const t=new Float32Array(16);return function(e,i){const n=this.getBrowser(),r=n.getContext(),s=this.getViewVolume().getViewport(),o=n.getDepthShader();if(o.isValid()){o.enable(r),t.set(this.getProjectionMatrix().get()),r.uniformMatrix4fv(o.x3d_ProjectionMatrix,!1,t),r.viewport(s[0],s[1],s[2],s[3]),r.scissor(s[0],s[1],s[2],s[3]),r.clearColor(1,0,0,0),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT),r.enable(r.DEPTH_TEST),r.depthMask(!0),r.disable(r.BLEND),r.disable(r.CULL_FACE);for(let t=0;t<i;++t){const i=e[t],n=i.scissor;r.scissor(n.x,n.y,n.z,n.w),o.setLocalObjects(r,i.clipPlanes),r.uniformMatrix4fv(o.x3d_ModelViewMatrix,!1,i.modelViewMatrix),i.shapeNode.depth(r,i,o)}}}}(),draw:function(){const t=this.getBrowser(),e=t.getContext(),i=this.getViewVolume().getViewport(),n=this.lights,r=this.textureProjectors,s=this.generatedCubeMapTextures;if(this.renderTime=performance.now(),this.isIndependent()){for(const t of n)t.renderShadowMap(this);for(const t of s)t.renderTexture(this)}t.getHeadlight().setGlobalVariables(this);for(const t of n)t.setGlobalVariables(this);for(const t of r)t.setGlobalVariables(this);this.viewportArray.set(i),this.cameraSpaceMatrixArray.set(this.getCameraSpaceMatrix().get()),this.projectionMatrixArray.set(this.getProjectionMatrix().get()),e.viewport(i.x,i.y,i.z,i.w),e.scissor(i.x,i.y,i.z,i.w),e.clear(e.DEPTH_BUFFER_BIT),this.getBackground().display(e,this,i),e.depthMask(!0),e.enable(e.DEPTH_TEST),e.disable(e.BLEND);const o=this.opaqueShapes;for(let i=0,n=this.numOpaqueShapes;i<n;++i){const n=o[i],r=n.scissor;e.scissor(r.x,r.y,r.z,r.w),n.shapeNode.display(e,n),t.resetTextureUnits()}e.depthMask(!1),e.enable(e.BLEND);const a=this.transparentShapes;this.transparencySorter.sort(0,this.numTransparentShapes);for(let i=0,n=this.numTransparentShapes;i<n;++i){const n=a[i],r=n.scissor;e.scissor(r.x,r.y,r.z,r.w),n.shapeNode.display(e,n),t.resetTextureUnits()}e.depthMask(!0),e.disable(e.BLEND);const u=this.globalObjects;if(this.isIndependent()){const e=t.getLocalObjects();for(const t of e)t.dispose();e.length=0;for(const t of u)t.dispose()}u.length=0,n.length=0,r.length=0,s.length=0}},p})),define("x_ite/Components/Grouping/X3DBoundedObject",["x_ite/Fields","x_ite/Base/X3DCast","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Box3"],(function(t,e,i,n,r,s){"use strict";function o(e){this.addType(i.X3DBoundedObject),this.addChildObjects("transformSensors_changed",new t.SFTime),this._bboxSize.setUnit("length"),this._bboxCenter.setUnit("length"),this.childBBox=new s,this.transformSensorNodes=new Set}return o.prototype={constructor:o,initialize:function(){},getDefaultBBoxSize:function(){const t=new n(-1,-1,-1);return function(){return t}}(),getBBox:function(t,e,i){const n=this.childBBox;e.set();for(var r=0,s=t.length;r<s;++r){const s=t[r];s.getBBox&&e.add(s.getBBox(n,i))}return e},displayBBox:function(){const t=new s,e=new r;return function(i,n){const r=n.getModelViewMatrix();this.getBBox(t),e.set(t.center,null,t.size),r.push(),r.multLeft(e),this.getBrowser().getBBoxNode().traverse(i,n),r.pop()}}(),addTransformSensor:function(t){this.transformSensorNodes.add(t),this._transformSensors_changed=this.getBrowser().getCurrentTime()},removeTransformSensor:function(t){this.transformSensorNodes.delete(t),this._transformSensors_changed=this.getBrowser().getCurrentTime()},getTransformSensors:function(){return this.transformSensorNodes}},o})),define("x_ite/Components/Grouping/X3DGroupingNode",["x_ite/Components/Core/X3DChildNode","x_ite/Components/Grouping/X3DBoundedObject","x_ite/Rendering/TraverseType","x_ite/Base/X3DConstants","x_ite/Base/X3DCast"],(function(t,e,i,n,r){"use strict";function s(i){t.call(this,i),e.call(this,i),this.addType(n.X3DGroupingNode),this.hidden=!1,this.allowedTypes=new Set,this.clipPlaneNodes=[],this.localFogNodes=[],this.lightNodes=[],this.textureProjectorNodes=[],this.pointingDeviceSensorNodes=[],this.maybeCameraObjects=[],this.cameraObjects=[],this.maybePickableSensorNodes=[],this.pickableSensorNodes=[],this.pickableObjects=[],this.childNodes=[],this.displayNodes=[],this.visibleNodes=[],this.boundedObjects=[],this.sensors=new Map}function o(t,e,i,n,r,s){const o=new Set;for(let t=r;t<s;++t)o.add(n[t]);return t.remove(e,i,(function(t){return o.has(t)}))}return s.prototype=Object.assign(Object.create(t.prototype),e.prototype,{constructor:s,initialize:function(){t.prototype.initialize.call(this),e.prototype.initialize.call(this),this._transformSensors_changed.addInterest("set_transformSensors__",this),this._addChildren.addInterest("set_addChildren__",this),this._removeChildren.addInterest("set_removeChildren__",this),this._children.addInterest("set_children__",this),this.set_children__()},getBBox:function(t,e){return this.getSubBBox(t,e)},getSubBBox:function(t,i){return this._bboxSize.getValue().equals(this.getDefaultBBoxSize())?e.prototype.getBBox.call(this,this.visibleNodes,t,i):t.set(this._bboxSize.getValue(),this._bboxCenter.getValue())},setHidden:function(t){t!==this.hidden&&(this.hidden=t,this.set_children__())},setAllowedTypes:function(){const t=this.allowedTypes;t.clear();for(const e of arguments)t.add(e)},set_addChildren__:function(){0!==this._addChildren.length&&(this._addChildren.setTainted(!0),this._addChildren.erase(o(this._addChildren,0,this._addChildren.length,this._children,0,this._children.length),this._addChildren.length),this._children.isTainted()||(this._children.removeInterest("set_children__",this),this._children.addInterest("connectChildren",this)),this._children.insert(this._children.length,this._addChildren,0,this._addChildren.length),this.add(this._addChildren),this._addChildren.length=0,this._addChildren.setTainted(!1))},set_removeChildren__:function(){0!==this._removeChildren.length&&(this._removeChildren.setTainted(!0),this._children.length>0&&(this._children.isTainted()||(this._children.removeInterest("set_children__",this),this._children.addInterest("connectChildren",this)),this._children.erase(o(this._children,0,this._children.length,this._removeChildren,0,this._removeChildren.length),this._children.length),this.remove(this._removeChildren)),this._removeChildren.length=0,this._removeChildren.setTainted(!1))},set_children__:function(){this.clear(),this.add(this._children)},connectChildren:function(){this._children.removeInterest("connectChildren",this),this._children.addInterest("set_children__",this)},clear:function(){for(const t of this.maybePickableSensorNodes)t._isPickableObject.removeInterest("set_pickableObjects__",this);for(const t of this.childNodes)t._isCameraObject.removeInterest("set_cameraObjects__",this),t._isPickableObject.removeInterest("set_pickableObjects__",this),r(n.X3DBoundedObject,t)&&(t._visible.removeInterest("set_visibles__",this),t._bboxDisplay.removeInterest("set_bboxDisplays__",this));this.clipPlaneNodes.length=0,this.localFogNodes.length=0,this.lightNodes.length=0,this.textureProjectorNodes.length=0,this.pointingDeviceSensorNodes.length=0,this.maybeCameraObjects.length=0,this.maybePickableSensorNodes.length=0,this.childNodes.length=0},add:function(t){if(!this.hidden){for(const e of t)if(e)try{const t=e.getValue().getInnerNode(),i=t.getType();for(let e=i.length-1;e>=0;--e){switch(i[e]){case n.X3DPointingDeviceSensorNode:this.pointingDeviceSensorNodes.push(t);break;case n.ClipPlane:this.clipPlaneNodes.push(t);break;case n.LocalFog:this.localFogNodes.push(t);break;case n.X3DTextureProjectorNode:this.textureProjectorNodes.push(t);break;case n.X3DLightNode:this.lightNodes.push(t);break;case n.X3DBindableNode:this.maybeCameraObjects.push(t);break;case n.TransformSensor:case n.X3DPickSensorNode:t._isPickableObject.addInterest("set_pickableObjects__",this),this.maybePickableSensorNodes.push(t);break;case n.X3DBackgroundNode:case n.X3DChildNode:t._isCameraObject.addInterest("set_cameraObjects__",this),t._isPickableObject.addInterest("set_pickableObjects__",this),r(n.X3DBoundedObject,t)&&(t._visible.addInterest("set_visibles__",this),t._bboxDisplay.addInterest("set_bboxDisplays__",this)),this.maybeCameraObjects.push(t),this.childNodes.push(t);break;case n.BooleanFilter:case n.BooleanToggle:case n.NurbsOrientationInterpolator:case n.NurbsPositionInterpolator:case n.NurbsSurfaceInterpolator:case n.TimeSensor:case n.X3DFollowerNode:case n.X3DInfoNode:case n.X3DInterpolatorNode:case n.X3DKeyDeviceSensorNode:case n.X3DLayoutNode:case n.X3DScriptNode:case n.X3DSequencerNode:case n.X3DTriggerNode:break;default:continue}break}}catch(t){}this.set_pickableObjects__(),this.set_displayNodes__(),this.set_visibles__(),this.set_bboxDisplays__()}},remove:function(t){for(const i of t)if(i)try{const t=i.getValue().getInnerNode(),s=t.getType();for(let i=s.length-1;i>=0;--i){switch(s[i]){case n.X3DPointingDeviceSensorNode:{const e=this.pointingDeviceSensorNodes.indexOf(t);e>=0&&this.pointingDeviceSensorNodes.splice(e,1);break}case n.ClipPlane:{const e=this.clipPlaneNodes.indexOf(t);e>=0&&this.clipPlaneNodes.splice(e,1);break}case n.LocalFog:{const e=this.localFogNodes.indexOf(t);e>=0&&this.localFogNodes.splice(e,1);break}case n.X3DTextureProjectorNode:{const e=this.textureProjectorNodes.indexOf(t);e>=0&&this.textureProjectorNodes.splice(e,1);break}case n.X3DLightNode:{const e=this.lightNodes.indexOf(t);e>=0&&this.lightNodes.splice(e,1);break}case n.X3DBindableNode:{const e=this.maybeCameraObjects.indexOf(t);e>=0&&this.maybeCameraObjects.splice(e,1);break}case n.TransformSensor:case n.X3DPickSensorNode:{t._isPickableObject.removeInterest("set_pickableObjects__",this);const e=this.maybePickableSensorNodes.indexOf(t);e>=0&&this.maybePickableSensorNodes.splice(e,1);break}case n.X3DBackgroundNode:case n.X3DChildNode:var e;t._isCameraObject.removeInterest("set_cameraObjects__",this),t._isPickableObject.removeInterest("set_pickableObjects__",this),r(n.X3DBoundedObject,t)&&(t._visible.removeInterest("set_visibles__",this),t._bboxDisplay.removeInterest("set_bboxDisplays__",this)),(e=this.maybeCameraObjects.indexOf(t))>=0&&this.maybeCameraObjects.splice(e,1),(e=this.childNodes.indexOf(t))>=0&&this.childNodes.splice(e,1);break;case n.BooleanFilter:case n.BooleanToggle:case n.NurbsOrientationInterpolator:case n.NurbsPositionInterpolator:case n.NurbsSurfaceInterpolator:case n.TimeSensor:case n.X3DFollowerNode:case n.X3DInfoNode:case n.X3DInterpolatorNode:case n.X3DKeyDeviceSensorNode:case n.X3DLayoutNode:case n.X3DScriptNode:case n.X3DSequencerNode:case n.X3DTriggerNode:break;default:continue}break}}catch(t){}this.set_pickableObjects__(),this.set_displayNodes__(),this.set_visibles__(),this.set_bboxDisplays__()},set_cameraObjects__:function(){const t=this.cameraObjects;t.length=0;for(const e of this.maybeCameraObjects)e.getCameraObject()&&(r(n.X3DBoundedObject,e)?e._visible.getValue()&&t.push(e):t.push(e));this.setCameraObject(Boolean(t.length))},set_pickableObjects__:function(){const t=this.pickableSensorNodes,e=this.pickableObjects;t.length=0,e.length=0;for(const e of this.maybePickableSensorNodes)e.getPickableObject()&&t.push(e);for(const t of this.childNodes)t.getPickableObject()&&e.push(t);this.set_transformSensors__()},set_transformSensors__:function(){this.setPickableObject(Boolean(this.getTransformSensors().size||this.pickableSensorNodes.length||this.pickableObjects.length))},set_displayNodes__:function(){const t=this.displayNodes;t.length=0;for(const e of this.clipPlaneNodes)t.push(e);for(const e of this.localFogNodes)t.push(e);for(const e of this.lightNodes)t.push(e);for(const e of this.textureProjectorNodes)t.push(e)},set_visibles__:function(){const t=this.childNodes,e=this.visibleNodes;e.length=0;for(const i of t)r(n.X3DBoundedObject,i)?i._visible.getValue()&&e.push(i):e.push(i);this.set_cameraObjects__()},set_bboxDisplays__:function(){const t=this.boundedObjects;t.length=0;for(const e of this.childNodes)r(n.X3DBoundedObject,e)&&e._bboxDisplay.getValue()&&t.push(e)},traverse:function(t,e){switch(t){case i.POINTER:{const i=this.pointingDeviceSensorNodes,n=this.clipPlaneNodes,r=this.sensors;if(r.clear(),i.length){for(const t of i)t.push(e,r);r.size&&this.getBrowser().getSensors().push(r)}for(const t of n)t.push(e);for(const i of this.childNodes)i.traverse(t,e);for(const t of n)t.pop(e);return void(r.size&&this.getBrowser().getSensors().pop())}case i.CAMERA:for(const i of this.cameraObjects)i.traverse(t,e);return;case i.PICKING:{if(this.getTransformSensors().size){const t=e.getModelViewMatrix().get();for(const e of this.getTransformSensors())e.collect(t)}for(const i of this.pickableSensorNodes)i.traverse(t,e);const i=this.getBrowser(),n=i.getPickingHierarchy();if(n.push(this),i.getPickable().at(-1))for(const i of this.childNodes)i.traverse(t,e);else for(const i of this.pickableObjects)i.traverse(t,e);return void n.pop()}case i.COLLISION:{const i=this.clipPlaneNodes;for(const t of i)t.push(e);for(const i of this.childNodes)i.traverse(t,e);for(const t of i)t.pop(e);return}case i.SHADOW:{const i=this.clipPlaneNodes;for(const t of i)t.push(e);for(const i of this.visibleNodes)i.traverse(t,e);for(const t of i)t.push(e);return}case i.DISPLAY:{const i=this.displayNodes;for(const t of i)t.push(e,this);for(const i of this.visibleNodes)i.traverse(t,e);for(const i of this.boundedObjects)i.displayBBox(t,e);for(const t of i)t.pop(e);return}}}}),s})),define("x_ite/Components/Layering/X3DViewportNode",["x_ite/Components/Grouping/X3DGroupingNode","x_ite/Base/X3DConstants"],(function(t,e){"use strict";function i(i){t.call(this,i),this.addType(e.X3DViewportNode)}return i.prototype=Object.assign(Object.create(t.prototype),{constructor:i}),i})),define("x_ite/Execution/BindableStack",["x_ite/Base/X3DBaseNode"],(function(t){"use strict";function e(e,i){t.call(this,e),this.array=[i],this.transitionNode=i.create(e)}e.prototype=Object.assign(Object.create(t.prototype),{constructor:e,getTypeName:function(){return"BindableStack"},get:function(){return this.array},top:function(){return this.transitionNode._transitionActive.getValue()?this.transitionNode:this.array.at(-1)},pushOnTop:function(t){t!==this.array[0]&&(this.array.at(-1)._isBound=!1,this.array.push(t)),t._isBound=!0,t._bindTime=this.getBrowser().getCurrentTime(),this.addNodeEvent()},update:function(t,e,i){if(0===e.length&&0===i.length)return;const n=this.top(),r=this.array.at(-1);for(const t of e){const e=this.array.indexOf(t);e>0&&this.array.splice(e,1)}r!==this.array[0]&&i.some((t=>!t._set_bind.getValue()&&t===r))&&this.array.pop();for(const t of i)if(t._set_bind.getValue()){const e=this.array.indexOf(t);e>-1&&this.array.splice(e,1),this.array.push(t)}const s=this.array.at(-1);s!==r&&(r._set_bind=!1,r._isBound=!1,s._set_bind=!0,s._isBound=!0,s._bindTime=this.getBrowser().getCurrentTime(),this.transitionNode=s.create(this.getExecutionContext()),this.transitionNode.setup(),this.transitionNode.transitionStart(t,n,s),this.transitionNode._transitionActive.getValue()&&this.transitionNode._transitionActive.addInterest("set_transitionActive__",this),this.addNodeEvent())},set_transitionActive__:function(t){t.getValue()||(this.transitionNode._transitionActive.removeInterest("set_transitionActive__",this),this.addNodeEvent())}});for(const t of Reflect.ownKeys(e.prototype))Object.defineProperty(e.prototype,t,{enumerable:!1});return e})),define("x_ite/Execution/BindableList",["x_ite/Base/X3DBaseNode","x_ite/Components/Core/X3DPrototypeInstance"],(function(t,e){"use strict";function i(e,i){t.call(this,e),this.collected=[i],this.array=[i],this.updateTime=0,this.removedNodes=[]}i.prototype=Object.assign(Object.create(t.prototype),{constructor:i,getTypeName:function(){return"BindableList"},get:function(){return this.array},getBound:function(t){if(this.array.length>1){const i=!1,n=this.getMainScene();if(t&&t.length)for(let r=1,s=this.array.length;r<s;++r){const s=this.array[r],o=s.getExecutionContext().getOuterNode(),a=o instanceof e?o.getScene():s.getScene();if((i||a===n)&&s.getName()==t)return s}for(let t=1,r=this.array.length;t<r;++t){const r=this.array[t],s=r.getExecutionContext().getOuterNode(),o=s instanceof e?s.getScene():r.getScene();if((i||o===n)&&r._isBound.getValue())return r}for(let t=1,r=this.array.length;t<r;++t){const r=this.array[t],s=r.getExecutionContext().getOuterNode(),o=s instanceof e?s.getScene():r.getScene();if(i||o===n)return r}}return this.array[0]},push:function(t){return this.collected.push(t)},update:function(t,e){const i=this.collected.filter((t=>t._set_bind.getModificationTime()>this.updateTime)),n=this.removedNodes;if(!function(t,e){if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}(this.collected,this.array)){for(const t of this.array)-1===this.collected.indexOf(t)&&n.push(t);const t=this.array;this.array=this.collected,this.collected=t}this.collected.length=1,e.update(t,n,i),n.length=0,this.updateTime=performance.now()}});for(const t of Reflect.ownKeys(i.prototype))Object.defineProperty(i.prototype,t,{enumerable:!1});return i})),define("standard/Utility/ObjectCache",[],(function(){"use strict";return function(t){return{stack:[],last:-1,pop:function(){if(this.last>-1){const t=this.stack[this.last];return this.last--,t}return new t},push:function(t){return this.last++,this.stack[this.last]=t},clear:function(){this.stack.length=0,this.last=-1}}}})),define("x_ite/Components/EnvironmentalEffects/X3DFogObject",["x_ite/Base/X3DConstants","standard/Math/Numbers/Matrix3","standard/Utility/ObjectCache"],(function(t,e,i){"use strict";const n=i(r);function r(){this.fogMatrix=new Float32Array(9)}function s(e){this.addType(t.X3DFogObject),this._visibilityRange.setUnit("length"),this.hidden=!1,this.colorArray=new Float32Array(3)}return r.prototype={constructor:r,set:function(t,e){this.fogNode=t,this.fogMatrix.set(e.submatrix.inverse())},setShaderUniforms:function(t,e){if(e.hasFog(this))return;const i=this.fogNode;t.uniform1i(e.x3d_FogType,i.fogType),t.uniform3fv(e.x3d_FogColor,i.colorArray),t.uniform1f(e.x3d_FogVisibilityRange,i.visibilityRange),t.uniformMatrix3fv(e.x3d_FogMatrix,!1,this.fogMatrix)},dispose:function(){n.push(this)}},s.prototype={constructor:s,initialize:function(){this._fogType.addInterest("set_fogType__",this),this._color.addInterest("set_color__",this),this._visibilityRange.addInterest("set_visibilityRange__",this),this.set_color__(),this.set_visibilityRange__()},setHidden:function(t){this.hidden=t,this.set_fogType__(),this.getBrowser().addBrowserEvent()},getHidden:function(){return this.hidden},getFogType:function(){return this.fogType},getFogs:function(){return n},set_fogType__:function(){const t=new Map([["LINEAR",1],["EXPONENTIAL",2]]);return function(){this.hidden||0===this.visibilityRange?this.fogType=0:this.fogType=t.get(this._fogType.getValue())||1}}(),set_color__:function(){const t=this._color.getValue(),e=this.colorArray;e[0]=t.r,e[1]=t.g,e[2]=t.b},set_visibilityRange__:function(){this.visibilityRange=Math.max(0,this._visibilityRange.getValue()),this.set_fogType__()}},s})),define("x_ite/Components/EnvironmentalEffects/Fog",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Core/X3DBindableNode","x_ite/Components/EnvironmentalEffects/X3DFogObject","x_ite/Rendering/TraverseType","x_ite/Base/X3DConstants","standard/Math/Numbers/Matrix4"],(function(t,e,i,n,r,s,o,a){"use strict";function u(t){n.call(this,t),r.call(this,t),this.addType(o.Fog),this.modelMatrix=new a}return u.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:u,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.inputOnly,"set_bind",new t.SFBool),new e(o.inputOutput,"fogType",new t.SFString("LINEAR")),new e(o.inputOutput,"color",new t.SFColor(1,1,1)),new e(o.inputOutput,"visibilityRange",new t.SFFloat),new e(o.outputOnly,"isBound",new t.SFBool),new e(o.outputOnly,"bindTime",new t.SFTime)]),getTypeName:function(){return"Fog"},getComponentName:function(){return"EnvironmentalEffects"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),r.prototype.initialize.call(this)},getModelMatrix:function(){return this.modelMatrix},traverse:function(t,e){t===s.CAMERA&&(e.getLayer().getFogs().push(this),this.modelMatrix.assign(e.getModelViewMatrix().get()))}}),u})),define("x_ite/Rendering/VertexArray",[],(function(){"use strict";function t(){this.vertexArray=null,this.shaderNode=null,this.tainted=!0}return t.prototype={update:function(t=!0){return this.tainted=this.tainted||t,this},enable:function(t,e){return this.tainted||this.shaderNode!==e?(t.deleteVertexArray(this.vertexArray),this.vertexArray=t.createVertexArray(),this.shaderNode=e,this.tainted=!1,t.bindVertexArray(this.vertexArray),!0):(t.bindVertexArray(this.vertexArray),!1)},disable:function(t){t.bindVertexArray(null)},delete:function(t){t.deleteVertexArray(this.vertexArray)}},t})),define("x_ite/Components/Rendering/X3DGeometryNode",["x_ite/Fields","x_ite/Rendering/VertexArray","x_ite/Components/Core/X3DNode","x_ite/Base/X3DConstants","x_ite/Browser/Core/Shading","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Box3","standard/Math/Geometry/Plane3","standard/Math/Geometry/Triangle3","standard/Math/Algorithm"],(function(t,e,i,n,r,s,o,a,u,l,c,h){"use strict";const d=[new o(0,0,1),new o(0,0,-1),new o(0,1,0),new o(0,-1,0),new o(1,0,0)];function p(e){i.call(this,e),this.addType(n.X3DGeometryNode),this.addChildObjects("transparent",new t.SFBool,"bbox_changed",new t.SFTime,"rebuild",new t.SFTime),this._transparent.setAccessType(n.outputOnly),this._bbox_changed.setAccessType(n.outputOnly),this._rebuild.setAccessType(n.outputOnly);const r=this.getBrowser();this.min=new o(0,0,0),this.max=new o(0,0,0),this.bbox=new u(this.min,this.max,!0),this.solid=!0,this.primitiveMode=r.getContext().TRIANGLES,this.geometryType=3,this.flatShading=void 0,this.colorMaterial=!1,this.attribNodes=[],this.attribArrays=[],this.textureCoordinateMapping=new Map,this.multiTexCoords=[],this.texCoords=p.createArray(),this.fogDepths=p.createArray(),this.colors=p.createArray(),this.normals=p.createArray(),this.flatNormals=p.createArray(),this.vertices=p.createArray(),this.hasFogCoords=!1,this.hasNormals=!1,this.geometryMask=0,this.vertexCount=0,this.planes=[];for(let t=0;t<5;++t)this.planes[t]=new l(o.Zero,o.zAxis)}return p.createArray=function(){const t=[];return t.typedArray=new Float32Array,t.assign=function(t){const e=t.length;for(let i=0;i<e;++i)this[i]=t[i];this.length=e},t.getValue=function(){return this.typedArray},t.shrinkToFit=function(){this.length===this.typedArray.length?this.typedArray.set(this):this.typedArray=new Float32Array(this)},t},p.prototype=Object.assign(Object.create(i.prototype),{constructor:p,setup:function(){i.prototype.setup.call(this),this.rebuild()},initialize:function(){i.prototype.initialize.call(this);const t=this.getBrowser(),n=t.getContext();this.isLive().addInterest("set_live__",this),this.addInterest("requestRebuild",this),this._rebuild.addInterest("rebuild",this),this.frontFace=n.CCW,this.backFace=new Map([[n.CCW,n.CW],[n.CW,n.CCW]]),this.attribBuffers=[],this.textureCoordinateNode=t.getDefaultTextureCoordinate(),this.texCoordBuffers=Array.from({length:t.getMaxTextures()},(()=>n.createBuffer())),this.fogDepthBuffer=n.createBuffer(),this.colorBuffer=n.createBuffer(),this.normalBuffer=n.createBuffer(),this.vertexBuffer=n.createBuffer(),this.vertexArrayObject=new e,this.shadowArrayObject=new e,this.set_live__()},setGeometryType:function(t){this.geometryType=t},getGeometryType:function(){return this.geometryType},setTransparent:function(t){t!==this._transparent.getValue()&&(this._transparent=t)},getTransparent:function(){return this._transparent.getValue()},getBBox:function(){return this.bbox},setBBox:function(t){if(!t.equals(this.bbox)){t.getExtents(this.min,this.max),this.bbox.assign(t);for(let t=0;t<5;++t)this.planes[t].set(t%2?this.min:this.max,d[t]);this._bbox_changed.addEvent()}},getMin:function(){return this.min},getMax:function(){return this.max},getMatrix:function(){return a.Identity},setPrimitiveMode:function(t){this.primitiveMode=t},getPrimitiveMode:function(){return this.primitiveMode},setSolid:function(t){this.solid=t},setCCW:function(t){const e=this.getBrowser().getContext();this.frontFace=t?e.CCW:e.CW},getAttrib:function(){return this.attribNodes},getAttribs:function(){return this.attribArrays},getAttribBuffers:function(){return this.attribBuffers},setFogDepths:function(t){this.fogDepths.assign(t)},getFogDepths:function(){return this.fogDepths},setColors:function(t){this.colors.assign(t)},getColors:function(){return this.colors},setMultiTexCoords:function(t){const e=this.multiTexCoords,i=t.length;for(let n=0;n<i;++n)e[n]=t[n];e.length=i},getMultiTexCoords:function(){return this.multiTexCoords},getTexCoords:function(){return this.texCoords},setTextureCoordinate:function(t){this.textureCoordinateNode.removeInterest("updateTextureCoordinateMapping",this),this.textureCoordinateNode=t||this.getBrowser().getDefaultTextureCoordinate(),this.textureCoordinateNode.addInterest("updateTextureCoordinateMapping",this),this.updateTextureCoordinateMapping()},updateTextureCoordinateMapping:function(){this.textureCoordinateMapping.clear(),this.textureCoordinateNode.getTextureMapping(this.textureCoordinateMapping)},setNormals:function(t){this.normals.assign(t)},getNormals:function(){return this.normals},setVertices:function(t){this.vertices.assign(t)},getVertices:function(){return this.vertices},updateVertexArrays:function(){this.vertexArrayObject.update(),this.shadowArrayObject.update(),this.updateParticlesShadow=!0,this.updateParticles=!0},buildTexCoords:function(){const t=this.texCoords;if(0===t.length){const e=this.getTexCoordParams(),i=e.min,n=e.Sindex,r=e.Tindex,s=e.Ssize,o=i[n],a=i[r],u=this.vertices.getValue();for(let e=0,i=u.length;e<i;e+=4)t.push((u[e+n]-o)/s,(u[e+r]-a)/s,0,1);t.shrinkToFit()}this.getMultiTexCoords().push(t)},getTexCoordParams:function(){const t={min:new o(0,0,0),Ssize:0,Sindex:0,Tindex:0};return function(){const e=this.getBBox(),i=e.size,n=i.x,r=i.y,s=i.z;return t.min.assign(e.center).subtract(i.divide(2)),n>=r&&n>=s?(t.Ssize=n,t.Sindex=0,t.Tindex=r>=s?1:2):r>=n&&r>=s?(t.Ssize=r,t.Sindex=1,t.Tindex=n>=s?0:2):(t.Ssize=s,t.Sindex=2,t.Tindex=n>=r?0:1),t}}(),refineNormals:function(t,e,i){if(0===i)return e;const n=Math.cos(h.clamp(i,0,Math.PI)),r=[];for(const i in t){const s=t[i];for(const t of s){const i=e[t],a=new o(0,0,0);for(const t of s){const r=e[t];r.dot(i)>=n&&a.add(r)}r[t]=a.normalize()}}return r},transformLine:function(t){},transformMatrix:function(t){},isClipped:function(t,e){return e.some((function(e){return e.isClipped(t)}))},intersectsLine:function(t,e,i,n,r){return this.intersectsLineWithGeometry(t,e.getModelViewMatrix().get(),e.getLocalObjects(),r)},intersectsLineWithGeometry:function(){const t=new a,e={u:0,v:0,t:0},i=new o(0,0,0),n=new o(0,0,0),r=new o(0,0,0),u=new o(0,0,0);return function(a,l,c,h){if(this.intersectsBBox(a)){this.transformLine(a),this.transformMatrix(t.assign(l));const d=this.multiTexCoords[0].getValue(),p=this.normals.getValue(),f=this.vertices.getValue(),g=this.vertexCount;for(let l=0;l<g;l+=3){const g=4*l;if(i.x=f[g],i.y=f[g+1],i.z=f[g+2],n.x=f[g+4],n.y=f[g+5],n.z=f[g+6],r.x=f[g+8],r.y=f[g+9],r.z=f[g+10],a.intersectsTriangle(i,n,r,e)){const i=e.u,n=e.v,r=e.t,a=new o(r*f[g]+i*f[g+4]+n*f[g+8],r*f[g+1]+i*f[g+5]+n*f[g+9],r*f[g+2]+i*f[g+6]+n*f[g+10]);if(c.length&&this.isClipped(t.multVecMatrix(u.assign(a)),c))continue;const m=new s(r*d[g]+i*d[g+4]+n*d[g+8],r*d[g+1]+i*d[g+5]+n*d[g+9]),_=3*l,y=new o(r*p[_]+i*p[_+3]+n*p[_+6],r*p[_+1]+i*p[_+4]+n*p[_+7],r*p[_+2]+i*p[_+5]+n*p[_+8]);h.push({texCoord:m,normal:y,point:this.getMatrix().multVecMatrix(a)})}}}return h.length}}(),getPlanesWithOffset:function(){const t=new o(0,0,0),e=new o(0,0,0),i=[];for(let t=0;t<5;++t)i[t]=new l(o.Zero,o.zAxis);return function(n,r,s,o,a,u){t.set(n,r,s),e.set(o,a,u);for(let n=0;n<5;++n)i[n].set(n%2?t:e,d[n]);return i}}(),intersectsBBox:function(){const t=new o(0,0,0);return function(e,i){if(i)var n=this.min,r=this.max,s=n.x-i.x,o=r.x+i.x,a=n.y-i.y,u=r.y+i.y,l=n.z-i.z,c=r.z+i.z,h=this.getPlanesWithOffset(s,a,l,o,u,c);else n=this.min,r=this.max,s=n.x,o=r.x,a=n.y,u=r.y,l=n.z,c=r.z,h=this.planes;return!!(h[0].intersectsLine(e,t)&&t.x>=s&&t.x<=o&&t.y>=a&&t.y<=u)||(!!(h[1].intersectsLine(e,t)&&t.x>=s&&t.x<=o&&t.y>=a&&t.y<=u)||(!!(h[2].intersectsLine(e,t)&&t.x>=s&&t.x<=o&&t.z>=l&&t.z<=c)||(!!(h[3].intersectsLine(e,t)&&t.x>=s&&t.x<=o&&t.z>=l&&t.z<=c)||!!(h[4].intersectsLine(e,t)&&t.y>=a&&t.y<=u&&t.z>=l&&t.z<=c))))}}(),intersectsBox:function(){const t=new o(0,0,0),e=new o(0,0,0),i=new o(0,0,0),n=new a,r=new o(0,0,0);return function(s,o,a){if(s.intersectsBox(this.bbox)){s.multRight(n.assign(this.getMatrix()).inverse()),this.transformMatrix(a);const u=this.vertices.getValue();for(let n=0,l=this.vertexCount;n<l;n+=3){const l=4*n;if(t.x=u[l],t.y=u[l+1],t.z=u[l+2],e.x=u[l+4],e.y=u[l+5],e.z=u[l+6],i.x=u[l+8],i.y=u[l+9],i.z=u[l+10],s.intersectsTriangle(t,e,i)){if(o.length){if(this.isClipped(a.multVecMatrix(r.assign(t)),o))continue;if(this.isClipped(a.multVecMatrix(r.assign(e)),o))continue;if(this.isClipped(a.multVecMatrix(r.assign(i)),o))continue}return!0}}}return!1}}(),set_live__:function(){this.isLive().getValue()?this.getBrowser().getBrowserOptions()._Shading.addInterest("set_shading__",this):this.getBrowser().getBrowserOptions()._Shading.removeInterest("set_shading__",this)},set_shading__:function(){const t=new o(0,0,0),e=new o(0,0,0),i=new o(0,0,0),n=new o(0,0,0);return function(s){if(this.geometryType<2)return;const o=this.getBrowser(),a=o.getBrowserOptions().getShading()===r.FLAT;if(a===this.flatShading)return;this.flatShading=a;const u=o.getContext();if(a&&!this.flatNormals.length){const r=this.frontFace===u.CW,s=this.flatNormals,o=this.vertices.getValue();for(let a=0,u=o.length;a<u;a+=12)c.normal(t.set(o[a],o[a+1],o[a+2]),e.set(o[a+4],o[a+5],o[a+6]),i.set(o[a+8],o[a+9],o[a+10]),n),r&&n.negate(),s.push(n.x,n.y,n.z,n.x,n.y,n.z,n.x,n.y,n.z);s.shrinkToFit()}u.bindBuffer(u.ARRAY_BUFFER,this.normalBuffer),u.bufferData(u.ARRAY_BUFFER,a?this.flatNormals.getValue():this.normals.getValue(),u.DYNAMIC_DRAW)}}(),requestRebuild:function(){this._rebuild.addEvent()},rebuild:function(){const t=new o(0,0,0);return function(){this.clear(),this.build();for(const t of this.attribArrays)t.shrinkToFit();for(const t of this.multiTexCoords)t.shrinkToFit();this.fogDepths.shrinkToFit(),this.colors.shrinkToFit(),this.normals.shrinkToFit(),this.vertices.shrinkToFit();const e=this.min,i=this.max,n=this.vertices.getValue();if(n.length){if(e.x===Number.POSITIVE_INFINITY)for(let r=0,s=n.length;r<s;r+=4)t.set(n[r],n[r+1],n[r+2]),e.min(t),i.max(t);this.bbox.setExtents(e,i)}else this.bbox.setExtents(e.set(0,0,0),i.set(0,0,0));this._bbox_changed.addEvent();for(let t=0;t<5;++t)this.planes[t].set(t%2?e:i,d[t]);if(0===this.multiTexCoords.length&&this.buildTexCoords(),this.multiTexCoords.length){const t=this.getBrowser().getMaxTextures();for(let e=this.multiTexCoords.length;e<t;++e)this.multiTexCoords[e]=this.multiTexCoords.at(-1);this.multiTexCoords.length=t}this.transfer(),this.updateGeometryMask(),this.updateRenderFunctions()}}(),clear:function(){this.min.set(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),this.max.set(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);{const t=this.attribArrays;for(const e of t)e.length=0;const e=this.attribNodes.length;for(let i=t.length;i<e;++i)t[i]=p.createArray();t.length=e}this.flatShading=void 0,this.fogDepths.length=0,this.colors.length=0,this.multiTexCoords.length=0,this.texCoords.length=0,this.normals.length=0,this.flatNormals.length=0,this.vertices.length=0},transfer:function(){const t=this.getBrowser().getContext();for(let e=this.attribBuffers.length,i=this.attribArrays.length;e<i;++e)this.attribBuffers.push(t.createBuffer());for(let e=0,i=this.attribArrays.length;e<i;++e)t.bindBuffer(t.ARRAY_BUFFER,this.attribBuffers[e]),t.bufferData(t.ARRAY_BUFFER,this.attribArrays[e].getValue(),t.DYNAMIC_DRAW);const e=this.hasFogCoords;t.bindBuffer(t.ARRAY_BUFFER,this.fogDepthBuffer),t.bufferData(t.ARRAY_BUFFER,this.fogDepths.getValue(),t.DYNAMIC_DRAW),this.hasFogCoords=!!this.fogDepths.length,this.hasFogCoords!==e&&this.updateVertexArrays();const i=this.colorMaterial;t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer),t.bufferData(t.ARRAY_BUFFER,this.colors.getValue(),t.DYNAMIC_DRAW),this.colorMaterial=!!this.colors.length,this.colorMaterial!==i&&this.updateVertexArrays();for(let e=0,i=this.multiTexCoords.length;e<i;++e)t.bindBuffer(t.ARRAY_BUFFER,this.texCoordBuffers[e]),t.bufferData(t.ARRAY_BUFFER,this.multiTexCoords[e].getValue(),t.DYNAMIC_DRAW);const n=this.hasNormals;this.set_shading__(this.getBrowser().getBrowserOptions()._Shading),this.hasNormals=!!this.normals.getValue().length,this.hasNormals!==n&&this.updateVertexArrays(),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices.getValue(),t.DYNAMIC_DRAW),this.vertexCount=this.vertices.length/4},updateGeometryMask:function(){this.geometryMask=this.geometryType,this.geometryMask|=this.hasFogCoords<<2,this.geometryMask|=this.colorMaterial<<3,this.geometryMask|=this.hasNormals<<4},updateRenderFunctions:function(){this.vertexCount?(delete this.depth,delete this.display,delete this.displayParticlesDepth,delete this.displayParticles):(this.depth=Function.prototype,this.display=Function.prototype,this.displayParticlesDepth=Function.prototype,this.displayParticles=Function.prototype)},traverse:function(t,e){},depth:function(t,e,i){this.shadowArrayObject.enable(t,i)&&i.enableVertexAttribute(t,this.vertexBuffer,0,0),t.drawArrays(this.primitiveMode,0,this.vertexCount)},display:function(t,e){const i=e.appearanceNode,n=i.getShader(this,e);if(this.solid||!i.getBackMaterial()||this.getBrowser().getWireframe())this.displayGeometry(t,e,i,n,!0,!0);else{const r=i.getBackShader(this,e);this.displayGeometry(t,e,i,r,!0,!1),this.displayGeometry(t,e,i,n,!1,!0)}},displayGeometry:function(t,e,i,n,r,s){const o=this.getBrowser(),u=i.getBlendMode(),l=this.attribNodes,c=this.attribBuffers,h=o.getPrimitiveMode(this.primitiveMode);if(u&&u.enable(t),n.enable(t),n.setUniforms(t,e,s),this.vertexArrayObject.enable(t,n)){for(let e=0,i=l.length;e<i;++e)l[e].enable(t,n,c[e]);this.hasFogCoords&&n.enableFogDepthAttribute(t,this.fogDepthBuffer,0,0),this.colorMaterial&&n.enableColorAttribute(t,this.colorBuffer,0,0),n.enableTexCoordAttribute(t,this.texCoordBuffers,0,0),n.enableNormalAttribute(t,this.normalBuffer,0,0),n.enableVertexAttribute(t,this.vertexBuffer,0,0)}if(o.getWireframe())for(let e=0,i=this.vertexCount;e<i;e+=3)t.drawArrays(h,e,3);else{const i=a.prototype.determinant3.call(e.modelViewMatrix)>0;t.frontFace(i?this.frontFace:this.backFace.get(this.frontFace)),e.transparent||r!==s?(t.enable(t.CULL_FACE),r&&!this.solid&&(t.cullFace(t.FRONT),t.drawArrays(h,0,this.vertexCount)),s&&(t.cullFace(t.BACK),t.drawArrays(h,0,this.vertexCount))):(this.solid?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE),t.drawArrays(h,0,this.vertexCount))}u&&u.disable(t)},displayParticlesDepth:function(t,e,i,n){const r=n.outputParticles;if(r.shadowArrayObject.update(this.updateParticlesShadow).enable(t,i)){const e=n.particleStride;i.enableParticleAttribute(t,r,e,n.particleOffset,1),i.enableParticleMatrixAttribute(t,r,e,n.matrixOffset,1),i.enableVertexAttribute(t,this.vertexBuffer,0,0),this.updateParticlesShadow=!1}t.drawArraysInstanced(this.primitiveMode,0,this.vertexCount,n.numParticles)},displayParticles:function(t,e,i){const n=e.appearanceNode,r=n.getShader(this,e);if(this.solid||!n.getBackMaterial()||this.getBrowser().getWireframe())this.displayParticlesGeometry(t,e,n,r,!0,!0,i);else{const s=n.getBackShader(this,e);this.displayParticlesGeometry(t,e,n,s,!0,!1,i),this.displayParticlesGeometry(t,e,n,r,!1,!0,i)}},displayParticlesGeometry:function(t,e,i,n,r,s,o){const u=this.getBrowser(),l=i.getBlendMode(),c=this.attribNodes,h=this.attribBuffers,d=u.getPrimitiveMode(this.primitiveMode);l&&l.enable(t),n.enable(t),n.setUniforms(t,e,s);const p=o.outputParticles;if(p.vertexArrayObject.update(this.updateParticles).enable(t,n)){const e=o.particleStride;n.enableParticleAttribute(t,p,e,o.particleOffset,1),n.enableParticleMatrixAttribute(t,p,e,o.matrixOffset,1);for(let e=0,i=c.length;e<i;++e)c[e].enable(t,n,h[e]);this.hasFogCoords&&n.enableFogDepthAttribute(t,this.fogDepthBuffer,0,0),this.colorMaterial&&n.enableColorAttribute(t,this.colorBuffer,0,0),n.enableTexCoordAttribute(t,this.texCoordBuffers,0,0),n.enableNormalAttribute(t,this.normalBuffer,0,0),n.enableVertexAttribute(t,this.vertexBuffer,0,0),this.updateParticles=!1}const f=a.prototype.determinant3.call(e.modelViewMatrix)>0;t.frontFace(f?this.frontFace:this.backFace.get(this.frontFace)),e.transparent||r!==s?(t.enable(t.CULL_FACE),r&&!this.solid&&(t.cullFace(t.FRONT),t.drawArraysInstanced(d,0,this.vertexCount,o.numParticles)),s&&(t.cullFace(t.BACK),t.drawArraysInstanced(d,0,this.vertexCount,o.numParticles))):(this.solid?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE),t.drawArraysInstanced(d,0,this.vertexCount,o.numParticles)),l&&l.disable(t)}}),p})),define("standard/Math/Numbers/Complex",[],(function(){"use strict";function t(t,e){this.real=t,this.imag=e}return t.prototype={constructor:t,[Symbol.iterator]:function*(){yield this.real,yield this.imag},copy:function(){const e=Object.create(t.prototype);return e.real=this.real,e.imag=this.imag,e},assign:function(t){return this.real=t.real,this.imag=t.imag,this},equals:function(t){return this.real===t.real&&this.imag===t.imag},setPolar:function(t,e){return this.real=t*Math.cos(e),this.imag=t*Math.sin(e),this},conjugate:function(){return this.imag=-this.imag,this},negate:function(){return this.real=-this.real,this.imag=-this.imag,this},inverse:function(){const t=this.real*this.real+this.imag*this.imag;return this.real/=t,this.imag/=-t,this},add:function(t){return this.real+=t.real,this.imag+=t.imag,this},subtract:function(t){return this.real-=t.real,this.imag-=t.imag,this},multiply:function(t){return this.real*=t,this.imag*=t,this},multComp:function(){const t=this.real,e=this.imag;return this.real=t*value.real-e*value.imag,this.imag=t*value.imag+e*value.real,this},divComp:function(t){const e=this.real,i=this.imag,n=t.real,r=t.imag,s=n*n+r*r;return this.real=(e*n+i*r)/s,this.imag=(i*n-e*r)/s,this},toString:function(){return this.imag?this.real+" "+this.imag+"i":String(this.real)}},Object.defineProperty(t.prototype,"magnitude",{get:function(){return this.real?this.imag?Math.hypot(this.real,this.imag):Math.abs(this.real):Math.abs(this.imag)},set:function(t){this.setPolar(t,this.angle)},enumerable:!1,configurable:!1}),Object.defineProperty(t.prototype,"angle",{get:function(){return Math.atan2(this.imag,this.real)},set:function(t){this.setPolar(this.magnitude,t)},enumerable:!1,configurable:!1}),Object.assign(t,{Polar:function(e,i){return Object.create(t.prototype).setPolar(e,i)},multiply:function(t,e){return t.copy().multiply(e)},multComp:function(t,e){return t.copy().multComp(e)}}),t})),define("standard/Utility/BitSet",[],(function(){"use strict";function t(t=0){this.value=t}return t.prototype={set:function(t,e){const i=1<<t;e?this.value|=i:this.value&=~i},get:function(t){const e=1<<t;return!!(this.value&e)},valueOf:function(){return this.value},toString:function(){return"0b"+this.value.toString(2)}},t})),define("x_ite/Components/EnvironmentalEffects/X3DBackgroundNode",["x_ite/Components/Core/X3DBindableNode","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Rendering/VertexArray","x_ite/Rendering/TraverseType","x_ite/Base/X3DConstants","standard/Math/Geometry/ViewVolume","standard/Math/Numbers/Complex","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Algorithm","standard/Utility/BitSet"],(function(t,e,i,n,r,s,o,a,u,l,c,h){"use strict";const d=Math.SQRT2/2;function p(i){t.call(this,i),this.addType(r.X3DBackgroundNode),this._skyAngle.setUnit("angle"),this._groundAngle.setUnit("angle");const n=this.getBrowser();this.hidden=!1,this.projectionMatrixArray=new Float32Array(16),this.modelMatrix=new l,this.modelViewMatrixArray=new Float32Array(16),this.localObjects=[],this.colors=[],this.sphere=[],this.textureBits=new h,this.sphereContext={geometryType:3,colorMaterial:!0,hasNormals:!1},this.texturesContext={geometryType:3,colorMaterial:!1,hasNormals:!1},this.context={appearanceNode:n.getDefaultAppearance()},e.prototype.updateGeometryMask.call(this.sphereContext),e.prototype.updateGeometryMask.call(this.texturesContext)}return p.prototype=Object.assign(Object.create(t.prototype),{constructor:p,initialize:function(){t.prototype.initialize.call(this);const e=this.getBrowser(),n=e.getContext();this.colorBuffer=n.createBuffer(),this.sphereBuffer=n.createBuffer(),this.texCoordBuffers=new Array(e.getMaxTextures()).fill(n.createBuffer()),this.frontBuffer=n.createBuffer(),this.backBuffer=n.createBuffer(),this.leftBuffer=n.createBuffer(),this.rightBuffer=n.createBuffer(),this.topBuffer=n.createBuffer(),this.bottomBuffer=n.createBuffer(),this.sphereArrayObject=new i,this.frontArrayObject=new i,this.backArrayObject=new i,this.leftArrayObject=new i,this.rightArrayObject=new i,this.topArrayObject=new i,this.bottomArrayObject=new i,this._groundAngle.addInterest("build",this),this._groundColor.addInterest("build",this),this._skyAngle.addInterest("build",this),this._skyColor.addInterest("build",this),this.build(),this.transferRectangle()},set_frontTexture__:function(t){this.setTexture("frontTexture",t,0)},set_backTexture__:function(t){this.setTexture("backTexture",t,1)},set_leftTexture__:function(t){this.setTexture("leftTexture",t,2)},set_rightTexture__:function(t){this.setTexture("rightTexture",t,3)},set_topTexture__:function(t){this.setTexture("topTexture",t,4)},set_bottomTexture__:function(t){this.setTexture("bottomTexture",t,5)},setTexture:function(t,e,i){this[t]&&this[t]._loadState.removeInterest("setTextureBit",this),this[t]=e,e?(e._loadState.addInterest("setTextureBit",this,e,i),this.setTextureBit(e,i,e._loadState)):this.textureBits.set(i,!1)},setTextureBit:function(t,e,i){this.textureBits.set(e,i.getValue()===r.COMPLETE_STATE||t&&t.getData())},setHidden:function(t){this.hidden=t,this.getBrowser().addBrowserEvent()},getHidden:function(){return this.hidden},getTransparent:function(){return!!this.hidden||0!==this._transparency.getValue()&&(!(this.frontTexture&&!this.frontTexture._transparent.getValue())||(!(this.backTexture&&!this.backTexture._transparent.getValue())||(!(this.leftTexture&&!this.leftTexture._transparent.getValue())||(!(this.rightTexture&&!this.rightTexture._transparent.getValue())||(!(this.topTexture&&!this.topTexture._transparent.getValue())||!(this.bottomTexture&&!this.bottomTexture._transparent.getValue()))))))},getColor:function(t,e,i){return e[c.upperBound(i,0,i.length,t)]},build:function(){const t=d;if(this.colors.length=0,this.sphere.length=0,0===this._groundColor.length&&1==this._skyColor.length){this.sphere.vertices=36,this.sphere.push(t,t,-t,1,-t,t,-t,1,-t,-t,-t,1,t,t,-t,1,-t,-t,-t,1,t,-t,-t,1,-t,t,t,1,t,t,t,1,-t,-t,t,1,-t,-t,t,1,t,t,t,1,t,-t,t,1,-t,t,-t,1,-t,t,t,1,-t,-t,t,1,-t,t,-t,1,-t,-t,t,1,-t,-t,-t,1,t,t,t,1,t,t,-t,1,t,-t,t,1,t,-t,t,1,t,t,-t,1,t,-t,-t,1,t,t,t,1,-t,t,t,1,-t,t,-t,1,t,t,t,1,-t,t,-t,1,t,t,-t,1,-t,-t,t,1,t,-t,t,1,-t,-t,-t,1,-t,-t,-t,1,t,-t,t,1,t,-t,-t,1);const e=this._skyColor[0];for(let t=0,i=this.sphere.vertices;t<i;++t)this.colors.push(e.r,e.g,e.b,1)}else{if(this._skyColor.length>this._skyAngle.length){const t=this._skyAngle.slice();(0===t.length||t[0]>0)&&t.unshift(0),t.at(-1)<Math.PI&&t.push(Math.PI),2===t.length&&t.splice(1,0,(t[0]+t[1])/2),this.buildSphere(1,t,this._skyAngle,this._skyColor,!1)}if(this._groundColor.length>this._groundAngle.length){const t=this._groundAngle.slice().reverse();(0===t.length||t[0]<Math.PI/2)&&t.unshift(Math.PI/2),t.at(-1)>0&&t.push(0),this.buildSphere(1,t,this._groundAngle,this._groundColor,!0)}}this.transferSphere()},buildSphere:function(){const t=new o(0,0),e=new o(0,0),i=new o(0,0),n=new o(0,0),r=new o(0,0),s=new o(0,0);return function(o,a,u,l,h){const d=h?Math.PI/2:Math.PI,p=a.length-1;for(let f=0;f<p;++f){let p=c.clamp(a[f],0,d),g=c.clamp(a[f+1],0,d);h&&(p=Math.PI-p,g=Math.PI-g),t.setPolar(o,p),e.setPolar(o,g);const m=this.getColor(a[f],l,u),_=this.getColor(a[f+1],l,u);for(let o=0;o<20;++o){const a=o<19?o+1:0;let u=2*Math.PI*(o/20);i.setPolar(-t.imag,u),n.setPolar(-e.imag,u),u=2*Math.PI*(a/20),r.setPolar(-e.imag,u),s.setPolar(-t.imag,u),this.colors.push(m.r,m.g,m.b,1,_.r,_.g,_.b,1,_.r,_.g,_.b,1,m.r,m.g,m.b,1,m.r,m.g,m.b,1,_.r,_.g,_.b,1),this.sphere.push(i.imag,t.real,i.real,1,r.imag,e.real,r.real,1,n.imag,e.real,n.real,1,i.imag,t.real,i.real,1,s.imag,t.real,s.real,1,r.imag,e.real,r.real,1)}}}}(),transferSphere:function(){const t=this.getBrowser().getContext();t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(this.colors),t.DYNAMIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this.sphereBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(this.sphere),t.DYNAMIC_DRAW),this.sphereCount=this.sphere.length/4},transferRectangle:function(){const t=[1,1,0,1,0,1,0,1,0,0,0,1,1,1,0,1,0,0,0,1,1,0,0,1],e=[d,d,-d,1,-d,d,-d,1,-d,-d,-d,1,d,d,-d,1,-d,-d,-d,1,d,-d,-d,1],i=[-d,d,d,1,d,d,d,1,d,-d,d,1,-d,d,d,1,d,-d,d,1,-d,-d,d,1],n=[-d,d,-d,1,-d,d,d,1,-d,-d,d,1,-d,d,-d,1,-d,-d,d,1,-d,-d,-d,1],r=[d,d,d,1,d,d,-d,1,d,-d,-d,1,d,d,d,1,d,-d,-d,1,d,-d,d,1],s=[d,d,d,1,-d,d,d,1,-d,d,-d,1,d,d,d,1,-d,d,-d,1,d,d,-d,1],o=[d,-d,-d,1,-d,-d,-d,1,-d,-d,d,1,d,-d,-d,1,-d,-d,d,1,d,-d,d,1];return function(){const a=this.getBrowser().getContext();a.bindBuffer(a.ARRAY_BUFFER,this.texCoordBuffers[0]),a.bufferData(a.ARRAY_BUFFER,new Float32Array(t),a.DYNAMIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,this.frontBuffer),a.bufferData(a.ARRAY_BUFFER,new Float32Array(e),a.DYNAMIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,this.backBuffer),a.bufferData(a.ARRAY_BUFFER,new Float32Array(i),a.DYNAMIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,this.leftBuffer),a.bufferData(a.ARRAY_BUFFER,new Float32Array(n),a.DYNAMIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,this.rightBuffer),a.bufferData(a.ARRAY_BUFFER,new Float32Array(r),a.DYNAMIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,this.topBuffer),a.bufferData(a.ARRAY_BUFFER,new Float32Array(s),a.DYNAMIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,this.bottomBuffer),a.bufferData(a.ARRAY_BUFFER,new Float32Array(o),a.DYNAMIC_DRAW)}}(),traverse:function(t,e){switch(t){case n.CAMERA:return e.getLayer().getBackgrounds().push(this),void this.modelMatrix.assign(e.getModelViewMatrix().get());case n.DISPLAY:{const t=e.getLocalObjects(),i=this.localObjects;for(let e=0,n=t.length;e<n;++e)i[e]=t[e];return void(i.length=t.length)}}},display:function(){const t=new l,e=new l,i=new u,n=new a(0,0,0),r=new a(0,0,0);return function(o,a,u){if(this.hidden)return;o.disable(o.DEPTH_TEST),o.depthMask(!1),o.enable(o.CULL_FACE),o.frontFace(o.CCW);const l=.8*-s.unProjectPointMatrix(0,0,1,t.assign(a.getProjectionMatrix().get()).inverse(),u,r).z;this.projectionMatrixArray.set(a.getProjectionMatrix().get()),e.assign(this.modelMatrix),e.multRight(a.getViewMatrix().get()),e.get(null,i),e.identity(),e.rotate(i),e.scale(n.set(l,l,l)),this.modelViewMatrixArray.set(e),this.drawSphere(a),+this.textureBits&&this.drawCube(a)}}(),drawSphere:function(t){const e=this._transparency.getValue();if(e>=1)return;const i=this.getBrowser(),n=i.getContext(),r=i.getDefaultMaterial().getShader(this.sphereContext,this.context);r.enable(n),r.setLocalObjects(n,this.localObjects),n.uniform1i(r.x3d_FogType,0),n.uniform1i(r.x3d_FillPropertiesFilled,!0),n.uniform1i(r.x3d_FillPropertiesHatched,!1),n.uniform1f(r.x3d_Transparency,e),n.uniform1i(r.x3d_NumTextures,0),n.uniform1i(r.x3d_TextureCoordinateGeneratorMode[0],0),n.uniform1i(r.x3d_NumProjectiveTextures,0),n.uniformMatrix4fv(r.x3d_ProjectionMatrix,!1,this.projectionMatrixArray),n.uniformMatrix4fv(r.x3d_ModelViewMatrix,!1,this.modelViewMatrixArray),this.sphereArrayObject.enable(n,r)&&(r.enableColorAttribute(n,this.colorBuffer,0,0),r.enableVertexAttribute(n,this.sphereBuffer,0,0)),e?n.enable(n.BLEND):n.disable(n.BLEND),n.drawArrays(n.TRIANGLES,0,this.sphereCount)},drawCube:function(){const t=new Float32Array(l.Identity);return function(e){const i=this.getBrowser(),n=i.getContext(),r=i.getDefaultMaterial().getShader(this.texturesContext,this.context);r.enable(n),r.setLocalObjects(n,this.localObjects),n.uniform1i(r.x3d_FogType,0),n.uniform1i(r.x3d_FillPropertiesFilled,!0),n.uniform1i(r.x3d_FillPropertiesHatched,!1),n.uniform3f(r.x3d_EmissiveColor,1,1,1),n.uniform1f(r.x3d_Transparency,0),n.uniform1i(r.x3d_NumTextures,1),n.uniform1i(r.x3d_TextureCoordinateGeneratorMode[0],0),n.uniform1i(r.x3d_NumProjectiveTextures,0),n.uniformMatrix4fv(r.x3d_TextureMatrix[0],!1,t),n.uniformMatrix4fv(r.x3d_ProjectionMatrix,!1,this.projectionMatrixArray),n.uniformMatrix4fv(r.x3d_ModelViewMatrix,!1,this.modelViewMatrixArray),this.drawRectangle(n,i,r,e,this.frontTexture,this.frontBuffer,this.frontArrayObject),this.drawRectangle(n,i,r,e,this.backTexture,this.backBuffer,this.backArrayObject),this.drawRectangle(n,i,r,e,this.leftTexture,this.leftBuffer,this.leftArrayObject),this.drawRectangle(n,i,r,e,this.rightTexture,this.rightBuffer,this.rightArrayObject),this.drawRectangle(n,i,r,e,this.topTexture,this.topBuffer,this.topArrayObject),this.drawRectangle(n,i,r,e,this.bottomTexture,this.bottomBuffer,this.bottomArrayObject)}}(),drawRectangle:function(t,e,i,n,s,o,a){s&&(s.checkLoadState()===r.COMPLETE_STATE||s.getData())&&(s.setShaderUniforms(t,i,n),s._transparent.getValue()?t.enable(t.BLEND):t.disable(t.BLEND),a.enable(t,i)&&(i.enableTexCoordAttribute(t,this.texCoordBuffers,0,0),i.enableVertexAttribute(t,o,0,0)),t.drawArrays(t.TRIANGLES,0,6),e.resetTextureUnits())}}),p})),define("x_ite/Components/Texturing/X3DTextureNode",["x_ite/Fields","x_ite/Components/Shape/X3DAppearanceChildNode","x_ite/Base/X3DConstants"],(function(t,e,i){"use strict";function n(n){e.call(this,n),this.addType(i.X3DTextureNode),this.addChildObjects("transparent",new t.SFBool),this._transparent.setAccessType(i.outputOnly)}return n.prototype=Object.assign(Object.create(e.prototype),{constructor:n,setTransparent:function(t){t!==this._transparent.getValue()&&(this._transparent=t)},getTransparent:function(){return this._transparent.getValue()}}),n})),define("x_ite/Components/Texturing/X3DSingleTextureNode",["x_ite/Components/Texturing/X3DTextureNode","x_ite/Base/X3DConstants","x_ite/Base/X3DCast","x_ite/Browser/Texturing/MultiTextureModeType","x_ite/Browser/Texturing/MultiTextureSourceType","x_ite/Browser/Texturing/MultiTextureFunctionType"],(function(t,e,i,n,r,s){"use strict";function o(i){t.call(this,i),this.addType(e.X3DSingleTextureNode)}return o.prototype=Object.assign(Object.create(t.prototype),{constructor:o,initialize:function(){t.prototype.initialize.call(this),this._textureProperties.addInterest("set_textureProperties__",this,!0);const e=this.getBrowser().getContext();this.texture=e.createTexture(),this.set_textureProperties__(!1)},set_textureProperties__:function(t){this.texturePropertiesNode&&this.texturePropertiesNode.removeInterest("updateTextureProperties",this),this.texturePropertiesNode=i(e.TextureProperties,this._textureProperties),this.texturePropertiesNode||(this.texturePropertiesNode=this.getBrowser().getDefaultTextureProperties()),this.texturePropertiesNode.addInterest("updateTextureProperties",this),t&&this.updateTextureProperties()},getTexture:function(){return this.texture},updateTextureProperties:function(){const t=["EXT_texture_filter_anisotropic","MOZ_EXT_texture_filter_anisotropic","WEBKIT_EXT_texture_filter_anisotropic"];return function(e,i,n,r,s,o,a,u){const l=this.getBrowser().getContext();l.bindTexture(e,this.getTexture()),Math.max(r,s)<this.getBrowser().getMinTextureSize()&&!i?(l.texParameteri(e,l.TEXTURE_MIN_FILTER,l.NEAREST),l.texParameteri(e,l.TEXTURE_MAG_FILTER,l.NEAREST)):(n._generateMipMaps.getValue()&&l.generateMipmap(e),l.texParameteri(e,l.TEXTURE_MIN_FILTER,l[n.getMinificationFilter()]),l.texParameteri(e,l.TEXTURE_MAG_FILTER,l[n.getMagnificationFilter()])),i?(l.texParameteri(e,l.TEXTURE_WRAP_S,l[n.getBoundaryModeS()]),l.texParameteri(e,l.TEXTURE_WRAP_T,l[n.getBoundaryModeT()]),l.getVersion()>=2&&l.texParameteri(e,l.TEXTURE_WRAP_R,l[n.getBoundaryModeR()])):(l.texParameteri(e,l.TEXTURE_WRAP_S,o?l.REPEAT:l.CLAMP_TO_EDGE),l.texParameteri(e,l.TEXTURE_WRAP_T,a?l.REPEAT:l.CLAMP_TO_EDGE),l.getVersion()>=2&&l.texParameteri(e,l.TEXTURE_WRAP_R,u?l.REPEAT:l.CLAMP_TO_EDGE));for(const i of t){const t=l.getExtension(i);if(t){l.texParameterf(e,t.TEXTURE_MAX_ANISOTROPY_EXT,n._anisotropicDegree.getValue());break}}}}(),setShaderUniforms:function(t,e,i){this.setShaderUniformsToChannel(t,e,i,e.x3d_Textures[0]),t.uniform1i(e.x3d_NumTextures,1),t.uniform1i(e.x3d_MultiTextureMode[0],n.MODULATE),t.uniform1i(e.x3d_MultiTextureAlphaMode[0],n.MODULATE),t.uniform1i(e.x3d_MultiTextureSource[0],r.DEFAULT),t.uniform1i(e.x3d_MultiTextureFunction[0],s.DEFAULT)}}),o})),define("x_ite/Components/Texturing/X3DTexture2DNode",["x_ite/Components/Texturing/X3DSingleTextureNode","x_ite/Base/X3DConstants"],(function(t,e){"use strict";const i=new Uint8Array([255,255,255,255]);function n(i){t.call(this,i),this.addType(e.X3DTexture2DNode);const n=this.getBrowser().getContext();this.target=n.TEXTURE_2D,this.width=0,this.height=0,this.flipY=!1,this.data=null}return n.prototype=Object.assign(Object.create(t.prototype),{constructor:n,initialize:function(){t.prototype.initialize.call(this),this._repeatS.addInterest("updateTextureProperties",this),this._repeatT.addInterest("updateTextureProperties",this);const e=this.getBrowser().getContext();e.bindTexture(e.TEXTURE_2D,this.getTexture()),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,i)},getTarget:function(){return this.target},getTextureType:function(){return 2},getTextureTypeString:function(){return"2D"},getWidth:function(){return this.width},getHeight:function(){return this.height},getFlipY:function(){return this.flipY},getData:function(){return this.data},clearTexture:function(){this.setTexture(1,1,!1,i,!1),this.data=null},setTexture:function(t,e,i,n,r){this.width=t,this.height=e,this.flipY=r,this.data=n;const s=this.getBrowser().getContext();s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,r),s.bindTexture(s.TEXTURE_2D,this.getTexture()),s.texImage2D(s.TEXTURE_2D,0,s.RGBA,t,e,0,s.RGBA,s.UNSIGNED_BYTE,n),s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,!1),this.setTransparent(i),this.updateTextureProperties(),this.addNodeEvent()},updateTexture:function(t,e){this.data=t;const i=this.getBrowser().getContext();i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,e),i.bindTexture(i.TEXTURE_2D,this.getTexture()),i.texSubImage2D(i.TEXTURE_2D,0,0,0,i.RGBA,i.UNSIGNED_BYTE,t),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!1),this.texturePropertiesNode._generateMipMaps.getValue()&&i.generateMipmap(i.TEXTURE_2D),this.addNodeEvent()},updateTextureProperties:function(){t.prototype.updateTextureProperties.call(this,this.target,this._textureProperties.getValue(),this.texturePropertiesNode,this.width,this.height,this._repeatS.getValue(),this._repeatT.getValue(),!1)},setShaderUniformsToChannel:function(t,e,i,n){const r=this.getBrowser().getTexture2DUnit();t.activeTexture(t.TEXTURE0+r),t.bindTexture(t.TEXTURE_2D,this.getTexture()),t.uniform1i(n.textureType,2),t.uniform1i(n.texture2D,r)}}),n})),define("x_ite/Components/Texturing/ImageTexture",["jquery","x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Texturing/X3DTexture2DNode","x_ite/Components/Networking/X3DUrlObject","x_ite/Base/X3DConstants","standard/Math/Algorithm","x_ite/DEBUG"],(function(t,e,i,n,r,s,o,a,u){"use strict";function l(i){r.call(this,i),s.call(this,i),this.addType(o.ImageTexture),this.image=t("<img></img>"),this.canvas=t("<canvas></canvas>"),this.urlStack=new e.MFString}return l.prototype=Object.assign(Object.create(r.prototype),s.prototype,{constructor:l,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOutput,"description",new e.SFString),new i(o.inputOutput,"load",new e.SFBool(!0)),new i(o.inputOutput,"url",new e.MFString),new i(o.inputOutput,"autoRefresh",new e.SFTime),new i(o.inputOutput,"autoRefreshTimeLimit",new e.SFTime(3600)),new i(o.initializeOnly,"repeatS",new e.SFBool(!0)),new i(o.initializeOnly,"repeatT",new e.SFBool(!0)),new i(o.initializeOnly,"textureProperties",new e.SFNode)]),getTypeName:function(){return"ImageTexture"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"texture"},initialize:function(){r.prototype.initialize.call(this),s.prototype.initialize.call(this),this.image.on("load",this.setImage.bind(this)),this.image.on("abort error",this.setError.bind(this)),this.image[0].crossOrigin="Anonymous",this.requestImmediateLoad()},unloadNow:function(){this.clearTexture()},loadNow:function(){this.urlStack.setValue(this._url),this.loadNext()},loadNext:function(){if(0===this.urlStack.length)return this.clearTexture(),void this.setLoadState(o.FAILED_STATE);this.URL=new URL(this.urlStack.shift(),this.getExecutionContext().getWorldURL()),"data:"!==this.URL.protocol&&(this.getBrowser().getBrowserOptions().getCache()&&this.getCache()||this.URL.searchParams.set("_",Date.now())),this.image.attr("src",this.URL.href)},setError:function(t){"data:"!==this.URL.protocol&&console.warn("Error loading image:",decodeURI(this.URL.href),t.type),this.loadNext()},setImage:function(){u&&"data:"!==this.URL.protocol&&console.info("Done loading image:",decodeURI(this.URL.href));try{const t=this.getBrowser().getContext(),e=this.image[0],i=this.canvas[0],n=i.getContext("2d",{willReadFrequently:!0});let r=e.width,s=e.height;t.getVersion()>=2||a.isPowerOfTwo(r)&&a.isPowerOfTwo(s)?(i.width=r,i.height=s,n.clearRect(0,0,r,s),n.save(),n.translate(0,s),n.scale(1,-1),n.drawImage(e,0,0),n.restore()):(r=a.nextPowerOfTwo(r),s=a.nextPowerOfTwo(s),i.width=r,i.height=s,n.clearRect(0,0,r,s),n.save(),n.translate(0,s),n.scale(1,-1),n.drawImage(e,0,0,e.width,e.height,0,0,r,s),n.restore());const u=n.getImageData(0,0,r,s).data;let l=!1;for(let t=3,e=u.length;t<e;t+=4)if(255!==u[t]){l=!0;break}this.setTexture(r,s,l,new Uint8Array(u.buffer),!1),this.setLoadState(o.COMPLETE_STATE)}catch(t){console.log(t.message),this.setError()}}}),l})),define("x_ite/Components/EnvironmentalEffects/Background",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/EnvironmentalEffects/X3DBackgroundNode","x_ite/Components/Texturing/ImageTexture","x_ite/Base/X3DConstants"],(function(t,e,i,n,r,s){"use strict";function o(t){n.call(this,t),this.addType(s.Background)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.inputOnly,"set_bind",new t.SFBool),new e(s.inputOutput,"frontUrl",new t.MFString),new e(s.inputOutput,"backUrl",new t.MFString),new e(s.inputOutput,"leftUrl",new t.MFString),new e(s.inputOutput,"rightUrl",new t.MFString),new e(s.inputOutput,"topUrl",new t.MFString),new e(s.inputOutput,"bottomUrl",new t.MFString),new e(s.inputOutput,"skyAngle",new t.MFFloat),new e(s.inputOutput,"skyColor",new t.MFColor(new t.SFColor)),new e(s.inputOutput,"groundAngle",new t.MFFloat),new e(s.inputOutput,"groundColor",new t.MFColor),new e(s.inputOutput,"transparency",new t.SFFloat),new e(s.outputOnly,"isBound",new t.SFBool),new e(s.outputOnly,"bindTime",new t.SFTime)]),getTypeName:function(){return"Background"},getComponentName:function(){return"EnvironmentalEffects"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this);const t=new r(this.getExecutionContext()),e=new r(this.getExecutionContext()),i=new r(this.getExecutionContext()),s=new r(this.getExecutionContext()),o=new r(this.getExecutionContext()),a=new r(this.getExecutionContext()),u=this.getBrowser().getBackgroundTextureProperties();this._frontUrl.addFieldInterest(t._url),this._backUrl.addFieldInterest(e._url),this._leftUrl.addFieldInterest(i._url),this._rightUrl.addFieldInterest(s._url),this._topUrl.addFieldInterest(o._url),this._bottomUrl.addFieldInterest(a._url),t._url=this._frontUrl,e._url=this._backUrl,i._url=this._leftUrl,s._url=this._rightUrl,o._url=this._topUrl,a._url=this._bottomUrl,t._textureProperties=u,e._textureProperties=u,i._textureProperties=u,s._textureProperties=u,o._textureProperties=u,a._textureProperties=u,t.setup(),e.setup(),i.setup(),s.setup(),o.setup(),a.setup(),this.set_frontTexture__(t),this.set_backTexture__(e),this.set_leftTexture__(i),this.set_rightTexture__(s),this.set_topTexture__(o),this.set_bottomTexture__(a)}}),o})),define("x_ite/Components/Layering/X3DLayerNode",["x_ite/Components/Core/X3DNode","x_ite/Rendering/X3DRenderObject","x_ite/Components/Layering/X3DViewportNode","x_ite/Execution/BindableStack","x_ite/Execution/BindableList","x_ite/Components/Navigation/NavigationInfo","x_ite/Components/EnvironmentalEffects/Fog","x_ite/Components/EnvironmentalEffects/Background","x_ite/Base/X3DCast","x_ite/Rendering/TraverseType","x_ite/Base/X3DConstants","standard/Math/Geometry/Camera","standard/Math/Geometry/Box3","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4"],(function(t,e,i,n,r,s,o,a,u,l,c,h,d,p,f){"use strict";var g=new f;function m(i,u,l){t.call(this,i),e.call(this,i),this.addType(c.X3DLayerNode),this.groupNode=l,this.currentViewport=null,this.defaultNavigationInfo=new s(i),this.defaultViewpoint=u,this.defaultBackground=new a(i),this.defaultFog=new o(i),this.navigationInfoStack=new n(i,this.defaultNavigationInfo),this.viewpointStack=new n(i,this.defaultViewpoint),this.backgroundStack=new n(i,this.defaultBackground),this.fogStack=new n(i,this.defaultFog),this.navigationInfos=new r(i,this.defaultNavigationInfo),this.viewpoints=new r(i,this.defaultViewpoint),this.backgrounds=new r(i,this.defaultBackground),this.fogs=new r(i,this.defaultFog),this.defaultBackground.setHidden(!0),this.defaultFog.setHidden(!0),this.collisionTime=0}return m.prototype=Object.assign(Object.create(t.prototype),e.prototype,{constructor:m,layer0:!1,initialize:function(){t.prototype.initialize.call(this),e.prototype.initialize.call(this),this.defaultNavigationInfo.setup(),this.defaultViewpoint.setup(),this.defaultBackground.setup(),this.defaultFog.setup(),this.navigationInfoStack.setup(),this.viewpointStack.setup(),this.backgroundStack.setup(),this.fogStack.setup(),this.navigationInfos.setup(),this.viewpoints.setup(),this.backgrounds.setup(),this.fogs.setup(),this._viewport.addInterest("set_viewport__",this),this.set_viewport__()},isLayer0:function(t){this.layer0=t,this.defaultBackground.setHidden(!t)},getLayer:function(){return this},getGroup:function(){return this.groupNode},getViewport:function(){return this.currentViewport},getBackground:function(){return this.backgroundStack.top()},getFog:function(){return this.fogStack.top()},getNavigationInfo:function(){return this.navigationInfoStack.top()},getViewpoint:function(){return this.viewpointStack.top()},getBackgrounds:function(){return this.backgrounds},getFogs:function(){return this.fogs},getNavigationInfos:function(){return this.navigationInfos},getViewpoints:function(){return this.viewpoints},getUserViewpoints:function(){for(var t=[],e=0;e<this.viewpoints.get().length;++e){var i=this.viewpoints.get()[e];i._description.length&&t.push(i)}return t},getBackgroundStack:function(){return this.backgroundStack},getFogStack:function(){return this.fogStack},getNavigationInfoStack:function(){return this.navigationInfoStack},getViewpointStack:function(){return this.viewpointStack},getBBox:function(t,e){return this.groupNode.getBBox(t,e)},lookAt:function(t,e){this.getViewpoint().lookAtBBox(this.getBBox(new d),t,e)},set_viewport__:function(){this.currentViewport=u(c.X3DViewportNode,this._viewport),this.currentViewport||(this.currentViewport=this.getBrowser().getDefaultViewport())},bind:function(t){this.traverse(l.CAMERA,this);const e=this.navigationInfos.getBound(),i=this.backgrounds.getBound(),n=this.fogs.getBound(),r=this.viewpoints.getBound(t);this.navigationInfoStack.pushOnTop(e),this.viewpointStack.pushOnTop(r),this.backgroundStack.pushOnTop(i),this.fogStack.pushOnTop(n),r.resetUserOffsets()},traverse:function(t,e){e=e||this;var i=this.getViewpoint();switch(this.getProjectionMatrix().pushMatrix(i.getProjectionMatrix(this)),this.getCameraSpaceMatrix().pushMatrix(i.getCameraSpaceMatrix()),this.getViewMatrix().pushMatrix(i.getViewMatrix()),t){case l.POINTER:this.pointer(t,e);break;case l.CAMERA:this.camera(t,e);break;case l.PICKING:this.picking(t,e);break;case l.COLLISION:this.collision(t,e);break;case l.SHADOW:case l.DISPLAY:this.display(t,e)}this.getViewMatrix().pop(),this.getCameraSpaceMatrix().pop(),this.getProjectionMatrix().pop()},pointer:function(t,e){if(this._isPickable.getValue()){var i=this.getBrowser(),n=this.currentViewport.getRectangle(i);if(i.getSelectedLayer()){if(i.getSelectedLayer()!==this)return}else if(!i.isPointerInRectangle(n))return;i.setHitRay(this.getProjectionMatrix().get(),n),this.getModelViewMatrix().pushMatrix(this.getViewMatrix().get()),this.currentViewport.push(this),this.groupNode.traverse(t,e),this.currentViewport.pop(this),this.getModelViewMatrix().pop()}},camera:function(t,e){this.getModelViewMatrix().pushMatrix(f.Identity),this.currentViewport.push(this),this.groupNode.traverse(t,e),this.currentViewport.pop(this),this.getModelViewMatrix().pop(),this.navigationInfos.update(this,this.navigationInfoStack),this.viewpoints.update(this,this.viewpointStack),this.backgrounds.update(this,this.backgroundStack),this.fogs.update(this,this.fogStack),this.getViewpoint().update()},picking:function(t,e){this.getModelViewMatrix().pushMatrix(f.Identity),this.currentViewport.push(this),this.groupNode.traverse(t,e),this.currentViewport.pop(this),this.getModelViewMatrix().pop()},collision:function(t,e){var i=this.getNavigationInfo();if(!i._transitionActive.getValue()){var n=i.getCollisionRadius(),r=i.getAvatarHeight(),s=Math.max(2*n,2*r);this.collisionTime=0,h.ortho(-s,s,-s,s,-s,s,g),this.getProjectionMatrix().pushMatrix(g),this.getModelViewMatrix().pushMatrix(this.getViewMatrix().get()),this.currentViewport.push(this),e.render(t,this.groupNode.traverse,this.groupNode),this.currentViewport.pop(this),this.getModelViewMatrix().pop(),this.getProjectionMatrix().pop()}},display:function(t,e){this.getNavigationInfo().enable(t,e),this.getModelViewMatrix().pushMatrix(this.getViewMatrix().get()),this.currentViewport.push(this),e.render(t,this.groupNode.traverse,this.groupNode),this.currentViewport.pop(this),this.getModelViewMatrix().pop()}}),m})),define("x_ite/Components/Navigation/Viewpoint",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Navigation/X3DViewpointNode","x_ite/Components/Interpolation/ScalarInterpolator","x_ite/Base/X3DConstants","standard/Math/Geometry/Camera","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4"],(function(t,e,i,n,r,s,o,a,u,l){"use strict";function c(t){n.call(this,t),this.addType(s.Viewpoint),this._position.setUnit("length"),this._centerOfRotation.setUnit("length"),this._fieldOfView.setUnit("angle"),this.projectionMatrix=new l,this.fieldOfViewInterpolator=new r(this.getBrowser().getPrivateScene())}return c.prototype=Object.assign(Object.create(n.prototype),{constructor:c,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.inputOnly,"set_bind",new t.SFBool),new e(s.inputOutput,"description",new t.SFString),new e(s.inputOutput,"position",new t.SFVec3f(0,0,10)),new e(s.inputOutput,"orientation",new t.SFRotation),new e(s.inputOutput,"centerOfRotation",new t.SFVec3f),new e(s.inputOutput,"fieldOfView",new t.SFFloat(.7854)),new e(s.inputOutput,"jump",new t.SFBool(!0)),new e(s.inputOutput,"retainUserOffsets",new t.SFBool),new e(s.outputOnly,"isBound",new t.SFBool),new e(s.outputOnly,"bindTime",new t.SFTime)]),getTypeName:function(){return"Viewpoint"},getComponentName:function(){return"Navigation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.fieldOfViewInterpolator._key=new t.MFFloat(0,1),this.fieldOfViewInterpolator.setup(),this.getEaseInEaseOut()._modifiedFraction_changed.addFieldInterest(this.fieldOfViewInterpolator._set_fraction),this.fieldOfViewInterpolator._value_changed.addFieldInterest(this._fieldOfViewScale)},setInterpolators:function(e,i){if(e.getType().indexOf(s.Viewpoint)>=0){const n=e.getFieldOfView()/i.getFieldOfView();this.fieldOfViewInterpolator._keyValue=new t.MFFloat(n,i._fieldOfViewScale.getValue()),this._fieldOfViewScale=n}else this.fieldOfViewInterpolator._keyValue=new t.MFFloat(i._fieldOfViewScale.getValue(),i._fieldOfViewScale.getValue()),this._fieldOfViewScale=i._fieldOfViewScale.getValue()},getFieldOfView:function(){const t=this._fieldOfView.getValue()*this._fieldOfViewScale.getValue();return t>0&&t<Math.PI?t:Math.PI/4},getScreenScale:function(t,e,i){const n=e[2],r=e[3];let s=Math.abs(t.z)*Math.tan(this.getFieldOfView()/2)*2;return s/=n>r?r:n,i.set(s,s,s)},getViewportSize:function(){const t=new a(0,0);return function(e,i){const n=e[2],r=e[3],s=i*Math.tan(this.getFieldOfView()/2)*2,o=n/r;return o>1?t.set(s*o,s):t.set(s,s/o)}}(),getLookAtDistance:function(t){return t.size.magnitude()/2/Math.tan(this.getFieldOfView()/2)},getProjectionMatrixWithLimits:function(t,e,i){return o.perspective(this.getFieldOfView(),t,e,i[2],i[3],this.projectionMatrix)}}),c})),define("x_ite/Components/Grouping/Group",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Base/X3DConstants"],(function(t,e,i,n,r){"use strict";function s(t){n.call(this,t),this.addType(r.Group)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"visible",new t.SFBool(!0)),new e(r.inputOutput,"bboxDisplay",new t.SFBool),new e(r.initializeOnly,"bboxSize",new t.SFVec3f(-1,-1,-1)),new e(r.initializeOnly,"bboxCenter",new t.SFVec3f),new e(r.inputOnly,"addChildren",new t.MFNode),new e(r.inputOnly,"removeChildren",new t.MFNode),new e(r.inputOutput,"children",new t.MFNode)]),getTypeName:function(){return"Group"},getComponentName:function(){return"Grouping"},getContainerField:function(){return"children"}}),s})),define("x_ite/Components/Layering/Layer",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Layering/X3DLayerNode","x_ite/Components/Navigation/Viewpoint","x_ite/Components/Grouping/Group","x_ite/Base/X3DConstants"],(function(t,e,i,n,r,s,o){"use strict";function a(t){n.call(this,t,new r(t),new s(t)),this.addType(o.Layer)}return a.prototype=Object.assign(Object.create(n.prototype),{constructor:a,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.inputOutput,"isPickable",new t.SFBool(!0)),new e(o.inputOutput,"viewport",new t.SFNode),new e(o.inputOnly,"addChildren",new t.MFNode),new e(o.inputOnly,"removeChildren",new t.MFNode),new e(o.inputOutput,"children",new t.MFNode)]),getTypeName:function(){return"Layer"},getComponentName:function(){return"Layering"},getContainerField:function(){return"layers"},initialize:function(){n.prototype.initialize.call(this),this._addChildren.addFieldInterest(this.getGroup()._addChildren),this._removeChildren.addFieldInterest(this.getGroup()._removeChildren),this._children.addFieldInterest(this.getGroup()._children),this.getGroup()._children=this._children,this.getGroup().setPrivate(!0),this.getGroup().setup()}}),a})),define("x_ite/Components/Layering/LayerSet",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Components/Layering/Layer","x_ite/Base/X3DCast","x_ite/Rendering/TraverseType","x_ite/Base/X3DConstants"],(function(t,e,i,n,r,s,o,a){"use strict";function u(t){n.call(this,t),this.addType(a.LayerSet),this.layerNodes=[new r(t)],this.layerNode0=this.layerNodes[0],this.activeLayerNode=null}return u.prototype=Object.assign(Object.create(n.prototype),{constructor:u,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(a.inputOutput,"metadata",new t.SFNode),new e(a.inputOutput,"activeLayer",new t.SFInt32),new e(a.inputOutput,"order",new t.MFInt32(0)),new e(a.inputOutput,"layers",new t.MFNode)]),getTypeName:function(){return"LayerSet"},getComponentName:function(){return"Layering"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.layerNode0.setPrivate(!0),this.layerNode0.setup(),this.layerNode0.isLayer0(!0),this._activeLayer.addInterest("set_activeLayer",this),this._order.addInterest("set_layers",this),this._layers.addInterest("set_layers",this),this.set_layers()},getActiveLayer:function(){return this.activeLayerNode},setLayer0:function(t){this.layerNode0=t,this.set_layers()},getLayer0:function(){return this.layerNode0},getLayers:function(){return this.layerNodes},set_activeLayer:function(){if(0===this._activeLayer.getValue())this.activeLayerNode!==this.layerNode0&&(this.activeLayerNode=this.layerNode0);else{const t=this._activeLayer-1;t>=0&&t<this._layers.length?this.activeLayerNode!==this._layers[t].getValue()&&(this.activeLayerNode=s(a.X3DLayerNode,this._layers[t])):null!==this.activeLayerNode&&(this.activeLayerNode=null)}},set_layers:function(){const t=this._layers.getValue();this.layerNodes.length=0;for(let e of this._order)if(0===e)this.layerNodes.push(this.layerNode0);else if(--e,e>=0&&e<t.length){const i=s(a.X3DLayerNode,t[e]);i&&this.layerNodes.push(i)}this.set_activeLayer()},bind:function(t){const e=this._layers.getValue();this.layerNode0.bind(t);for(let i=0,n=e.length;i<n;++i){const n=s(a.X3DLayerNode,e[i]);n&&n.bind(t)}},traverse:function(t,e){const i=this.layerNodes;if(t===o.POINTER)for(let n=0,r=i.length;n<r;++n)this.getBrowser().setLayerNumber(n),i[n].traverse(t,e);else for(const n of i)n.traverse(t,e)}}),u})),define("x_ite/Execution/X3DWorld",["x_ite/Configuration/SupportedNodes","x_ite/Fields/SFNode","x_ite/Base/X3DBaseNode","x_ite/Components/Layering/LayerSet","x_ite/Components/Layering/Layer","x_ite/Base/X3DCast","x_ite/Base/X3DConstants"],(function(t,e,i,n,r,s,o){"use strict";function a(t){i.call(this,t),this.addType(o.X3DWorld),this.addChildObjects("activeLayer",new e(this.layer0)),this.defaultLayerSet=new n(t),this.layerSet=this.defaultLayerSet,this.layer0=new r(t)}t.addAbstractType("X3DWorld",a),a.prototype=Object.assign(Object.create(i.prototype),{constructor:a,getTypeName:function(){return"X3DWorld"},initialize:function(){i.prototype.initialize.call(this),this.layerSet.setPrivate(!0),this.layerSet.setup(),this.layerSet.setLayer0(this.layer0),this.layerSet._activeLayer.addInterest("set_rootNodes__",this),this.getExecutionContext().getRootNodes().addInterest("set_rootNodes__",this),this.set_rootNodes__(),this.layer0.setPrivate(!0),this.layer0.isLayer0(!0),this.layer0.setup(),this.set_activeLayer__()},getCache:function(){return!0},getLayerSet:function(){return this.layerSet},getActiveLayer:function(){return this._activeLayer.getValue()},set_rootNodes__:function(){const t=this.layerSet,e=this.getExecutionContext().getRootNodes();this.layerSet=this.defaultLayerSet,this.layer0._children=e;for(const t of e){const e=s(o.LayerSet,t);e&&(this.layerSet=e)}this.layerSet!==t&&(this.layerSet.setLayer0(this.layer0),t._activeLayer.removeInterest("set_activeLayer__",this),this.layerSet._activeLayer.addInterest("set_activeLayer__",this),this.set_activeLayer__())},set_activeLayer__:function(){this._activeLayer=this.layerSet.getActiveLayer()},bind:function(){const t=this.getExecutionContext().getWorldURL();this.layerSet.bind(decodeURIComponent(new URL(t,t).hash.substr(1)))},traverse:function(t,e){this.layerSet.traverse(t,e)}});for(const t of Reflect.ownKeys(a.prototype))Object.defineProperty(a.prototype,t,{enumerable:!1});return a})),define("standard/Networking/BinaryTransport",[],(function(){"use strict";return function(t){t.ajaxTransport("+binary",(function(t,e,i){if(t.dataType&&"binary"==t.dataType)return{send:function(e,i){const n=t.xhr();if(n.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(const e in t.xhrFields)n[e]=t.xhrFields[e];t.mimeType&&n.overrideMimeType&&n.overrideMimeType(t.mimeType);for(const t in e)n.setRequestHeader(t,e[t]);n.onload=function(){n.onload=n.onerror=null;const e={};e[t.dataType]=n.response,i(n.status||200,n.statusText,e,n.getAllResponseHeaders())},n.onerror=function(){n.onload=n.onerror=null,i(n.status||404,n.statusText)},n.responseType=t.responseType||"blob",n.send(t.hasContent&&t.data||null)},abort:function(){const e=t.xhr();e.onload=e.onerror=null,e.abort()}}}))}})),
/*! pako 2.0.4 https://github.com/nodeca/pako @license (MIT AND Zlib) */
function(t,e){"object"==typeof exports&&void 0!==module?e(exports):"function"==typeof define&&define.amd?define("pako_inflate/dist/pako_inflate",["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).pako={})}(this,(function(t){"use strict";var e=(t,e,i,n)=>{let r=65535&t|0,s=t>>>16&65535|0,o=0;for(;0!==i;){o=i>2e3?2e3:i,i-=o;do{r=r+e[n++]|0,s=s+r|0}while(--o);r%=65521,s%=65521}return r|s<<16|0};const i=new Uint32Array((()=>{let t,e=[];for(var i=0;i<256;i++){t=i;for(var n=0;n<8;n++)t=1&t?3988292384^t>>>1:t>>>1;e[i]=t}return e})());var n=(t,e,n,r)=>{const s=i,o=r+n;t^=-1;for(let i=r;i<o;i++)t=t>>>8^s[255&(t^e[i])];return-1^t};var r=function(t,e){let i,n,r,s,o,a,u,l,c,h,d,p,f,g,m,_,y,x,w,b,v,S,T,C;const O=t.state;i=t.next_in,T=t.input,n=i+(t.avail_in-5),r=t.next_out,C=t.output,s=r-(e-t.avail_out),o=r+(t.avail_out-257),a=O.dmax,u=O.wsize,l=O.whave,c=O.wnext,h=O.window,d=O.hold,p=O.bits,f=O.lencode,g=O.distcode,m=(1<<O.lenbits)-1,_=(1<<O.distbits)-1;t:do{p<15&&(d+=T[i++]<<p,p+=8,d+=T[i++]<<p,p+=8),y=f[d&m];e:for(;;){if(x=y>>>24,d>>>=x,p-=x,x=y>>>16&255,0===x)C[r++]=65535&y;else{if(!(16&x)){if(0==(64&x)){y=f[(65535&y)+(d&(1<<x)-1)];continue e}if(32&x){O.mode=12;break t}t.msg="invalid literal/length code",O.mode=30;break t}w=65535&y,x&=15,x&&(p<x&&(d+=T[i++]<<p,p+=8),w+=d&(1<<x)-1,d>>>=x,p-=x),p<15&&(d+=T[i++]<<p,p+=8,d+=T[i++]<<p,p+=8),y=g[d&_];i:for(;;){if(x=y>>>24,d>>>=x,p-=x,x=y>>>16&255,!(16&x)){if(0==(64&x)){y=g[(65535&y)+(d&(1<<x)-1)];continue i}t.msg="invalid distance code",O.mode=30;break t}if(b=65535&y,x&=15,p<x&&(d+=T[i++]<<p,p+=8,p<x&&(d+=T[i++]<<p,p+=8)),b+=d&(1<<x)-1,b>a){t.msg="invalid distance too far back",O.mode=30;break t}if(d>>>=x,p-=x,x=r-s,b>x){if(x=b-x,x>l&&O.sane){t.msg="invalid distance too far back",O.mode=30;break t}if(v=0,S=h,0===c){if(v+=u-x,x<w){w-=x;do{C[r++]=h[v++]}while(--x);v=r-b,S=C}}else if(c<x){if(v+=u+c-x,x-=c,x<w){w-=x;do{C[r++]=h[v++]}while(--x);if(v=0,c<w){x=c,w-=x;do{C[r++]=h[v++]}while(--x);v=r-b,S=C}}}else if(v+=c-x,x<w){w-=x;do{C[r++]=h[v++]}while(--x);v=r-b,S=C}for(;w>2;)C[r++]=S[v++],C[r++]=S[v++],C[r++]=S[v++],w-=3;w&&(C[r++]=S[v++],w>1&&(C[r++]=S[v++]))}else{v=r-b;do{C[r++]=C[v++],C[r++]=C[v++],C[r++]=C[v++],w-=3}while(w>2);w&&(C[r++]=C[v++],w>1&&(C[r++]=C[v++]))}break}}break}}while(i<n&&r<o);w=p>>3,i-=w,p-=w<<3,d&=(1<<p)-1,t.next_in=i,t.next_out=r,t.avail_in=i<n?n-i+5:5-(i-n),t.avail_out=r<o?o-r+257:257-(r-o),O.hold=d,O.bits=p};const s=15,o=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),a=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),u=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),l=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var c=(t,e,i,n,r,c,h,d)=>{const p=d.bits;let f,g,m,_,y,x,w=0,b=0,v=0,S=0,T=0,C=0,O=0,N=0,F=0,E=0,D=null,M=0;const I=new Uint16Array(16),V=new Uint16Array(16);let B,A,R,P=null,L=0;for(w=0;w<=s;w++)I[w]=0;for(b=0;b<n;b++)I[e[i+b]]++;for(T=p,S=s;S>=1&&0===I[S];S--);if(T>S&&(T=S),0===S)return r[c++]=20971520,r[c++]=20971520,d.bits=1,0;for(v=1;v<S&&0===I[v];v++);for(T<v&&(T=v),N=1,w=1;w<=s;w++)if(N<<=1,N-=I[w],N<0)return-1;if(N>0&&(0===t||1!==S))return-1;for(V[1]=0,w=1;w<s;w++)V[w+1]=V[w]+I[w];for(b=0;b<n;b++)0!==e[i+b]&&(h[V[e[i+b]]++]=b);if(0===t?(D=P=h,x=19):1===t?(D=o,M-=257,P=a,L-=257,x=256):(D=u,P=l,x=-1),E=0,b=0,w=v,y=c,C=T,O=0,m=-1,F=1<<T,_=F-1,1===t&&F>852||2===t&&F>592)return 1;for(;;){B=w-O,h[b]<x?(A=0,R=h[b]):h[b]>x?(A=P[L+h[b]],R=D[M+h[b]]):(A=96,R=0),f=1<<w-O,g=1<<C,v=g;do{g-=f,r[y+(E>>O)+g]=B<<24|A<<16|R|0}while(0!==g);for(f=1<<w-1;E&f;)f>>=1;if(0!==f?(E&=f-1,E+=f):E=0,b++,0==--I[w]){if(w===S)break;w=e[i+h[b]]}if(w>T&&(E&_)!==m){for(0===O&&(O=T),y+=v,C=w-O,N=1<<C;C+O<S&&(N-=I[C+O],!(N<=0));)C++,N<<=1;if(F+=1<<C,1===t&&F>852||2===t&&F>592)return 1;m=E&_,r[m]=T<<24|C<<16|y-c|0}}return 0!==E&&(r[y+E]=w-O<<24|64<<16|0),d.bits=T,0},h={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{Z_FINISH:d,Z_BLOCK:p,Z_TREES:f,Z_OK:g,Z_STREAM_END:m,Z_NEED_DICT:_,Z_STREAM_ERROR:y,Z_DATA_ERROR:x,Z_MEM_ERROR:w,Z_BUF_ERROR:b,Z_DEFLATED:v}=h,S=12,T=30,C=t=>(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24);function O(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const N=t=>{if(!t||!t.state)return y;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=1,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(852),e.distcode=e.distdyn=new Int32Array(592),e.sane=1,e.back=-1,g},F=t=>{if(!t||!t.state)return y;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,N(t)},E=(t,e)=>{let i;if(!t||!t.state)return y;const n=t.state;return e<0?(i=0,e=-e):(i=1+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?y:(null!==n.window&&n.wbits!==e&&(n.window=null),n.wrap=i,n.wbits=e,F(t))},D=(t,e)=>{if(!t)return y;const i=new O;t.state=i,i.window=null;const n=E(t,e);return n!==g&&(t.state=null),n};let M,I,V=!0;const B=t=>{if(V){M=new Int32Array(512),I=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(c(1,t.lens,0,288,M,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;c(2,t.lens,0,32,I,0,t.work,{bits:5}),V=!1}t.lencode=M,t.lenbits=9,t.distcode=I,t.distbits=5},A=(t,e,i,n)=>{let r;const s=t.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),n>=s.wsize?(s.window.set(e.subarray(i-s.wsize,i),0),s.wnext=0,s.whave=s.wsize):(r=s.wsize-s.wnext,r>n&&(r=n),s.window.set(e.subarray(i-n,i-n+r),s.wnext),(n-=r)?(s.window.set(e.subarray(i-n,i),0),s.wnext=n,s.whave=s.wsize):(s.wnext+=r,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=r))),0};var R={inflateReset:F,inflateReset2:E,inflateResetKeep:N,inflateInit:t=>D(t,15),inflateInit2:D,inflate:(t,i)=>{let s,o,a,u,l,h,O,N,F,E,D,M,I,V,R,P,L,U,k,X,z,j,G=0;const q=new Uint8Array(4);let H,W;const Y=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return y;s=t.state,s.mode===S&&(s.mode=13),l=t.next_out,a=t.output,O=t.avail_out,u=t.next_in,o=t.input,h=t.avail_in,N=s.hold,F=s.bits,E=h,D=O,j=g;t:for(;;)switch(s.mode){case 1:if(0===s.wrap){s.mode=13;break}for(;F<16;){if(0===h)break t;h--,N+=o[u++]<<F,F+=8}if(2&s.wrap&&35615===N){s.check=0,q[0]=255&N,q[1]=N>>>8&255,s.check=n(s.check,q,2,0),N=0,F=0,s.mode=2;break}if(s.flags=0,s.head&&(s.head.done=!1),!(1&s.wrap)||(((255&N)<<8)+(N>>8))%31){t.msg="incorrect header check",s.mode=T;break}if((15&N)!==v){t.msg="unknown compression method",s.mode=T;break}if(N>>>=4,F-=4,z=8+(15&N),0===s.wbits)s.wbits=z;else if(z>s.wbits){t.msg="invalid window size",s.mode=T;break}s.dmax=1<<s.wbits,t.adler=s.check=1,s.mode=512&N?10:S,N=0,F=0;break;case 2:for(;F<16;){if(0===h)break t;h--,N+=o[u++]<<F,F+=8}if(s.flags=N,(255&s.flags)!==v){t.msg="unknown compression method",s.mode=T;break}if(57344&s.flags){t.msg="unknown header flags set",s.mode=T;break}s.head&&(s.head.text=N>>8&1),512&s.flags&&(q[0]=255&N,q[1]=N>>>8&255,s.check=n(s.check,q,2,0)),N=0,F=0,s.mode=3;case 3:for(;F<32;){if(0===h)break t;h--,N+=o[u++]<<F,F+=8}s.head&&(s.head.time=N),512&s.flags&&(q[0]=255&N,q[1]=N>>>8&255,q[2]=N>>>16&255,q[3]=N>>>24&255,s.check=n(s.check,q,4,0)),N=0,F=0,s.mode=4;case 4:for(;F<16;){if(0===h)break t;h--,N+=o[u++]<<F,F+=8}s.head&&(s.head.xflags=255&N,s.head.os=N>>8),512&s.flags&&(q[0]=255&N,q[1]=N>>>8&255,s.check=n(s.check,q,2,0)),N=0,F=0,s.mode=5;case 5:if(1024&s.flags){for(;F<16;){if(0===h)break t;h--,N+=o[u++]<<F,F+=8}s.length=N,s.head&&(s.head.extra_len=N),512&s.flags&&(q[0]=255&N,q[1]=N>>>8&255,s.check=n(s.check,q,2,0)),N=0,F=0}else s.head&&(s.head.extra=null);s.mode=6;case 6:if(1024&s.flags&&(M=s.length,M>h&&(M=h),M&&(s.head&&(z=s.head.extra_len-s.length,s.head.extra||(s.head.extra=new Uint8Array(s.head.extra_len)),s.head.extra.set(o.subarray(u,u+M),z)),512&s.flags&&(s.check=n(s.check,o,M,u)),h-=M,u+=M,s.length-=M),s.length))break t;s.length=0,s.mode=7;case 7:if(2048&s.flags){if(0===h)break t;M=0;do{z=o[u+M++],s.head&&z&&s.length<65536&&(s.head.name+=String.fromCharCode(z))}while(z&&M<h);if(512&s.flags&&(s.check=n(s.check,o,M,u)),h-=M,u+=M,z)break t}else s.head&&(s.head.name=null);s.length=0,s.mode=8;case 8:if(4096&s.flags){if(0===h)break t;M=0;do{z=o[u+M++],s.head&&z&&s.length<65536&&(s.head.comment+=String.fromCharCode(z))}while(z&&M<h);if(512&s.flags&&(s.check=n(s.check,o,M,u)),h-=M,u+=M,z)break t}else s.head&&(s.head.comment=null);s.mode=9;case 9:if(512&s.flags){for(;F<16;){if(0===h)break t;h--,N+=o[u++]<<F,F+=8}if(N!==(65535&s.check)){t.msg="header crc mismatch",s.mode=T;break}N=0,F=0}s.head&&(s.head.hcrc=s.flags>>9&1,s.head.done=!0),t.adler=s.check=0,s.mode=S;break;case 10:for(;F<32;){if(0===h)break t;h--,N+=o[u++]<<F,F+=8}t.adler=s.check=C(N),N=0,F=0,s.mode=11;case 11:if(0===s.havedict)return t.next_out=l,t.avail_out=O,t.next_in=u,t.avail_in=h,s.hold=N,s.bits=F,_;t.adler=s.check=1,s.mode=S;case S:if(i===p||i===f)break t;case 13:if(s.last){N>>>=7&F,F-=7&F,s.mode=27;break}for(;F<3;){if(0===h)break t;h--,N+=o[u++]<<F,F+=8}switch(s.last=1&N,N>>>=1,F-=1,3&N){case 0:s.mode=14;break;case 1:if(B(s),s.mode=20,i===f){N>>>=2,F-=2;break t}break;case 2:s.mode=17;break;case 3:t.msg="invalid block type",s.mode=T}N>>>=2,F-=2;break;case 14:for(N>>>=7&F,F-=7&F;F<32;){if(0===h)break t;h--,N+=o[u++]<<F,F+=8}if((65535&N)!=(N>>>16^65535)){t.msg="invalid stored block lengths",s.mode=T;break}if(s.length=65535&N,N=0,F=0,s.mode=15,i===f)break t;case 15:s.mode=16;case 16:if(M=s.length,M){if(M>h&&(M=h),M>O&&(M=O),0===M)break t;a.set(o.subarray(u,u+M),l),h-=M,u+=M,O-=M,l+=M,s.length-=M;break}s.mode=S;break;case 17:for(;F<14;){if(0===h)break t;h--,N+=o[u++]<<F,F+=8}if(s.nlen=257+(31&N),N>>>=5,F-=5,s.ndist=1+(31&N),N>>>=5,F-=5,s.ncode=4+(15&N),N>>>=4,F-=4,s.nlen>286||s.ndist>30){t.msg="too many length or distance symbols",s.mode=T;break}s.have=0,s.mode=18;case 18:for(;s.have<s.ncode;){for(;F<3;){if(0===h)break t;h--,N+=o[u++]<<F,F+=8}s.lens[Y[s.have++]]=7&N,N>>>=3,F-=3}for(;s.have<19;)s.lens[Y[s.have++]]=0;if(s.lencode=s.lendyn,s.lenbits=7,H={bits:s.lenbits},j=c(0,s.lens,0,19,s.lencode,0,s.work,H),s.lenbits=H.bits,j){t.msg="invalid code lengths set",s.mode=T;break}s.have=0,s.mode=19;case 19:for(;s.have<s.nlen+s.ndist;){for(;G=s.lencode[N&(1<<s.lenbits)-1],R=G>>>24,P=G>>>16&255,L=65535&G,!(R<=F);){if(0===h)break t;h--,N+=o[u++]<<F,F+=8}if(L<16)N>>>=R,F-=R,s.lens[s.have++]=L;else{if(16===L){for(W=R+2;F<W;){if(0===h)break t;h--,N+=o[u++]<<F,F+=8}if(N>>>=R,F-=R,0===s.have){t.msg="invalid bit length repeat",s.mode=T;break}z=s.lens[s.have-1],M=3+(3&N),N>>>=2,F-=2}else if(17===L){for(W=R+3;F<W;){if(0===h)break t;h--,N+=o[u++]<<F,F+=8}N>>>=R,F-=R,z=0,M=3+(7&N),N>>>=3,F-=3}else{for(W=R+7;F<W;){if(0===h)break t;h--,N+=o[u++]<<F,F+=8}N>>>=R,F-=R,z=0,M=11+(127&N),N>>>=7,F-=7}if(s.have+M>s.nlen+s.ndist){t.msg="invalid bit length repeat",s.mode=T;break}for(;M--;)s.lens[s.have++]=z}}if(s.mode===T)break;if(0===s.lens[256]){t.msg="invalid code -- missing end-of-block",s.mode=T;break}if(s.lenbits=9,H={bits:s.lenbits},j=c(1,s.lens,0,s.nlen,s.lencode,0,s.work,H),s.lenbits=H.bits,j){t.msg="invalid literal/lengths set",s.mode=T;break}if(s.distbits=6,s.distcode=s.distdyn,H={bits:s.distbits},j=c(2,s.lens,s.nlen,s.ndist,s.distcode,0,s.work,H),s.distbits=H.bits,j){t.msg="invalid distances set",s.mode=T;break}if(s.mode=20,i===f)break t;case 20:s.mode=21;case 21:if(h>=6&&O>=258){t.next_out=l,t.avail_out=O,t.next_in=u,t.avail_in=h,s.hold=N,s.bits=F,r(t,D),l=t.next_out,a=t.output,O=t.avail_out,u=t.next_in,o=t.input,h=t.avail_in,N=s.hold,F=s.bits,s.mode===S&&(s.back=-1);break}for(s.back=0;G=s.lencode[N&(1<<s.lenbits)-1],R=G>>>24,P=G>>>16&255,L=65535&G,!(R<=F);){if(0===h)break t;h--,N+=o[u++]<<F,F+=8}if(P&&0==(240&P)){for(U=R,k=P,X=L;G=s.lencode[X+((N&(1<<U+k)-1)>>U)],R=G>>>24,P=G>>>16&255,L=65535&G,!(U+R<=F);){if(0===h)break t;h--,N+=o[u++]<<F,F+=8}N>>>=U,F-=U,s.back+=U}if(N>>>=R,F-=R,s.back+=R,s.length=L,0===P){s.mode=26;break}if(32&P){s.back=-1,s.mode=S;break}if(64&P){t.msg="invalid literal/length code",s.mode=T;break}s.extra=15&P,s.mode=22;case 22:if(s.extra){for(W=s.extra;F<W;){if(0===h)break t;h--,N+=o[u++]<<F,F+=8}s.length+=N&(1<<s.extra)-1,N>>>=s.extra,F-=s.extra,s.back+=s.extra}s.was=s.length,s.mode=23;case 23:for(;G=s.distcode[N&(1<<s.distbits)-1],R=G>>>24,P=G>>>16&255,L=65535&G,!(R<=F);){if(0===h)break t;h--,N+=o[u++]<<F,F+=8}if(0==(240&P)){for(U=R,k=P,X=L;G=s.distcode[X+((N&(1<<U+k)-1)>>U)],R=G>>>24,P=G>>>16&255,L=65535&G,!(U+R<=F);){if(0===h)break t;h--,N+=o[u++]<<F,F+=8}N>>>=U,F-=U,s.back+=U}if(N>>>=R,F-=R,s.back+=R,64&P){t.msg="invalid distance code",s.mode=T;break}s.offset=L,s.extra=15&P,s.mode=24;case 24:if(s.extra){for(W=s.extra;F<W;){if(0===h)break t;h--,N+=o[u++]<<F,F+=8}s.offset+=N&(1<<s.extra)-1,N>>>=s.extra,F-=s.extra,s.back+=s.extra}if(s.offset>s.dmax){t.msg="invalid distance too far back",s.mode=T;break}s.mode=25;case 25:if(0===O)break t;if(M=D-O,s.offset>M){if(M=s.offset-M,M>s.whave&&s.sane){t.msg="invalid distance too far back",s.mode=T;break}M>s.wnext?(M-=s.wnext,I=s.wsize-M):I=s.wnext-M,M>s.length&&(M=s.length),V=s.window}else V=a,I=l-s.offset,M=s.length;M>O&&(M=O),O-=M,s.length-=M;do{a[l++]=V[I++]}while(--M);0===s.length&&(s.mode=21);break;case 26:if(0===O)break t;a[l++]=s.length,O--,s.mode=21;break;case 27:if(s.wrap){for(;F<32;){if(0===h)break t;h--,N|=o[u++]<<F,F+=8}if(D-=O,t.total_out+=D,s.total+=D,D&&(t.adler=s.check=s.flags?n(s.check,a,D,l-D):e(s.check,a,D,l-D)),D=O,(s.flags?N:C(N))!==s.check){t.msg="incorrect data check",s.mode=T;break}N=0,F=0}s.mode=28;case 28:if(s.wrap&&s.flags){for(;F<32;){if(0===h)break t;h--,N+=o[u++]<<F,F+=8}if(N!==(4294967295&s.total)){t.msg="incorrect length check",s.mode=T;break}N=0,F=0}s.mode=29;case 29:j=m;break t;case T:j=x;break t;case 31:return w;default:return y}return t.next_out=l,t.avail_out=O,t.next_in=u,t.avail_in=h,s.hold=N,s.bits=F,(s.wsize||D!==t.avail_out&&s.mode<T&&(s.mode<27||i!==d))&&A(t,t.output,t.next_out,D-t.avail_out),E-=t.avail_in,D-=t.avail_out,t.total_in+=E,t.total_out+=D,s.total+=D,s.wrap&&D&&(t.adler=s.check=s.flags?n(s.check,a,D,t.next_out-D):e(s.check,a,D,t.next_out-D)),t.data_type=s.bits+(s.last?64:0)+(s.mode===S?128:0)+(20===s.mode||15===s.mode?256:0),(0===E&&0===D||i===d)&&j===g&&(j=b),j},inflateEnd:t=>{if(!t||!t.state)return y;let e=t.state;return e.window&&(e.window=null),t.state=null,g},inflateGetHeader:(t,e)=>{if(!t||!t.state)return y;const i=t.state;return 0==(2&i.wrap)?y:(i.head=e,e.done=!1,g)},inflateSetDictionary:(t,i)=>{const n=i.length;let r,s,o;return t&&t.state?(r=t.state,0!==r.wrap&&11!==r.mode?y:11===r.mode&&(s=1,s=e(s,i,n,0),s!==r.check)?x:(o=A(t,i,n,n),o?(r.mode=31,w):(r.havedict=1,g))):y},inflateInfo:"pako inflate (from Nodeca project)"};const P=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var L=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const i=e.shift();if(i){if("object"!=typeof i)throw new TypeError(i+"must be non-object");for(const e in i)P(i,e)&&(t[e]=i[e])}}return t},U=t=>{let e=0;for(let i=0,n=t.length;i<n;i++)e+=t[i].length;const i=new Uint8Array(e);for(let e=0,n=0,r=t.length;e<r;e++){let r=t[e];i.set(r,n),n+=r.length}return i};let k=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){k=!1}const X=new Uint8Array(256);for(let t=0;t<256;t++)X[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;X[254]=X[254]=1;var z=t=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(t);let e,i,n,r,s,o=t.length,a=0;for(r=0;r<o;r++)i=t.charCodeAt(r),55296==(64512&i)&&r+1<o&&(n=t.charCodeAt(r+1),56320==(64512&n)&&(i=65536+(i-55296<<10)+(n-56320),r++)),a+=i<128?1:i<2048?2:i<65536?3:4;for(e=new Uint8Array(a),s=0,r=0;s<a;r++)i=t.charCodeAt(r),55296==(64512&i)&&r+1<o&&(n=t.charCodeAt(r+1),56320==(64512&n)&&(i=65536+(i-55296<<10)+(n-56320),r++)),i<128?e[s++]=i:i<2048?(e[s++]=192|i>>>6,e[s++]=128|63&i):i<65536?(e[s++]=224|i>>>12,e[s++]=128|i>>>6&63,e[s++]=128|63&i):(e[s++]=240|i>>>18,e[s++]=128|i>>>12&63,e[s++]=128|i>>>6&63,e[s++]=128|63&i);return e},j=(t,e)=>{const i=e||t.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(t.subarray(0,e));let n,r;const s=new Array(2*i);for(r=0,n=0;n<i;){let e=t[n++];if(e<128){s[r++]=e;continue}let o=X[e];if(o>4)s[r++]=65533,n+=o-1;else{for(e&=2===o?31:3===o?15:7;o>1&&n<i;)e=e<<6|63&t[n++],o--;o>1?s[r++]=65533:e<65536?s[r++]=e:(e-=65536,s[r++]=55296|e>>10&1023,s[r++]=56320|1023&e)}}return((t,e)=>{if(e<65534&&t.subarray&&k)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let i="";for(let n=0;n<e;n++)i+=String.fromCharCode(t[n]);return i})(s,r)},G=(t,e)=>{(e=e||t.length)>t.length&&(e=t.length);let i=e-1;for(;i>=0&&128==(192&t[i]);)i--;return i<0||0===i?e:i+X[t[i]]>e?i:e},q={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"};var H=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};var W=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const Y=Object.prototype.toString,{Z_NO_FLUSH:Z,Z_FINISH:K,Z_OK:Q,Z_STREAM_END:$,Z_NEED_DICT:J,Z_STREAM_ERROR:tt,Z_DATA_ERROR:et,Z_MEM_ERROR:it}=h;function nt(t){this.options=L({chunkSize:65536,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new H,this.strm.avail_out=0;let i=R.inflateInit2(this.strm,e.windowBits);if(i!==Q)throw new Error(q[i]);if(this.header=new W,R.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"==typeof e.dictionary?e.dictionary=z(e.dictionary):"[object ArrayBuffer]"===Y.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(i=R.inflateSetDictionary(this.strm,e.dictionary),i!==Q)))throw new Error(q[i])}function rt(t,e){const i=new nt(e);if(i.push(t),i.err)throw i.msg||q[i.err];return i.result}nt.prototype.push=function(t,e){const i=this.strm,n=this.options.chunkSize,r=this.options.dictionary;let s,o,a;if(this.ended)return!1;for(o=e===~~e?e:!0===e?K:Z,"[object ArrayBuffer]"===Y.call(t)?i.input=new Uint8Array(t):i.input=t,i.next_in=0,i.avail_in=i.input.length;;){for(0===i.avail_out&&(i.output=new Uint8Array(n),i.next_out=0,i.avail_out=n),s=R.inflate(i,o),s===J&&r&&(s=R.inflateSetDictionary(i,r),s===Q?s=R.inflate(i,o):s===et&&(s=J));i.avail_in>0&&s===$&&i.state.wrap>0&&0!==t[i.next_in];)R.inflateReset(i),s=R.inflate(i,o);switch(s){case tt:case et:case J:case it:return this.onEnd(s),this.ended=!0,!1}if(a=i.avail_out,i.next_out&&(0===i.avail_out||s===$))if("string"===this.options.to){let t=G(i.output,i.next_out),e=i.next_out-t,r=j(i.output,t);i.next_out=e,i.avail_out=n-e,e&&i.output.set(i.output.subarray(t,t+e),0),this.onData(r)}else this.onData(i.output.length===i.next_out?i.output:i.output.subarray(0,i.next_out));if(s!==Q||0!==a){if(s===$)return s=R.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(0===i.avail_in)break}}return!0},nt.prototype.onData=function(t){this.chunks.push(t)},nt.prototype.onEnd=function(t){t===Q&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=U(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var st=nt,ot=rt,at=function(t,e){return(e=e||{}).raw=!0,rt(t,e)},ut=rt,lt=h,ct={Inflate:st,inflate:ot,inflateRaw:at,ungzip:ut,constants:lt};t.Inflate=st,t.constants=lt,t.default=ct,t.inflate=ot,t.inflateRaw=at,t.ungzip=ut,Object.defineProperty(t,"__esModule",{value:!0})})),define("pako_inflate",["pako_inflate/dist/pako_inflate"],(function(t){return t})),define("x_ite/InputOutput/FileLoader",["jquery","x_ite/Base/X3DObject","x_ite/Fields","x_ite/Parser/GoldenGate","x_ite/Parser/JSONParser","x_ite/Parser/XMLParser","x_ite/Execution/X3DWorld","standard/Networking/BinaryTransport","pako_inflate","x_ite/DEBUG"],(function(t,e,i,n,r,s,o,a,u,l){"use strict";a(t);Symbol.for("X_ITE.dom");const c=/^\s*(?:vrmlscript|javascript|ecmascript)\:([^]*)$/,h=/^data:(.*?)(?:;charset=(.*?))?(?:;(base64))?,([^]*)$/,d=/^(?:(.*?);(.*?)$)/,p=new RegExp(".(?:html|xhtml)$"),f={"text/html":!0,"application/xhtml+xml":!0},g=new i.MFString;function m(t,i){e.call(this),this.node=t,this.browser=t.getBrowser(),this.external=void 0===i?this.browser.isExternal():i,this.executionContext=this.external?t.getExecutionContext():this.browser.currentScene,this.userAgent=this.browser.getName()+"/"+this.browser.getVersion()+" (X3D Browser; +"+this.browser.getProviderUrl()+")",this.target="",this.url=[],this.URL=new URL(this.getReferer(),this.getReferer()),this.fileReader=new FileReader,this.text=!0}m.prototype=Object.assign(Object.create(e.prototype),{constructor:m,abort:function(){this.callback=Function.prototype,this.bindViewpoint=Function.prototype,this.foreign=Function.prototype},getWorldURL:function(){return this.URL},createX3DFromString:function(t,e,i,r){try{const s=this.browser.createScene();return this.node instanceof o?s.loader=this:s.setExecutionContext(this.executionContext),s.setWorldURL(decodeURI(new URL(t,this.getReferer()).href)),i&&(i=this.setScene.bind(this,s,i,r)),new n(s).parseIntoScene(e,i,r),s}catch(t){if(!r)throw r;r(t)}},setScene:function(t,e,i){t._initLoadCount.addInterest("set_initLoadCount__",this,t,e,i),t._initLoadCount.addEvent()},set_initLoadCount__:function(t,e,i,n){if(!n.getValue()){t._initLoadCount.removeInterest("set_initLoadCount__",this),delete t.loader;try{e(t)}catch(t){if(!i)throw t;i(t)}l&&"data:"!==this.URL.protocol&&console.info("Done loading scene "+decodeURI(this.URL.href))}},createX3DFromURL:function(t,e,i,n,r){return this.bindViewpoint=n,this.foreign=r,this.target=this.getTarget(e||g),i?this.loadDocument(t,this.createX3DFromURLAsync.bind(this,i)):this.createX3DFromURLSync(t)},createX3DFromURLAsync:function(t,e){null===e?t(null,this.URL):this.createX3DFromString(this.URL,e,t,this.loadDocumentError.bind(this))},createX3DFromURLSync:function(e){if(0===e.length)throw new Error("No URL given.");let i=null,n=!1;for(const r of e)if(this.URL=new URL(r,this.getReferer()),t.ajax({url:decodeURI(this.URL.href),dataType:"text",async:!1,cache:this.browser.getBrowserOptions().getCache()&&this.node.getCache(),global:!1,context:this,success:function(t){try{i=this.createX3DFromString(this.URL,t),n=!0}catch(t){this.error(t)}},error:function(t,e,i){}}),n)return i;throw new Error("Couldn't load any url of '"+Array.prototype.join.call(e,", ")+"'.")},loadScript:function(t,e){this.script=!0,this.loadDocument(t,e)},loadDocument:function(t,e){if(this.url=t.copy(),this.callback=e,0===t.length)return this.loadDocumentError(new Error("No URL given."));this.loadDocumentAsync(this.url.shift())},loadBinaryDocument:function(t,e){if(this.url=t.copy(),this.callback=e,this.text=!1,0===t.length)return this.loadDocumentError(new Error("No URL given."));this.loadDocumentAsync(this.url.shift())},getTarget:function(t){for(const e of t){const t=e.split("=");if(2===t.length&&"target"===t[0])return t[1]}return""},loadDocumentAsync:function(e){try{if(0===e.length)return void this.loadDocumentError(new Error("URL is empty."));if(this.script){const t=c.exec(e);if(t)return void this.callback(t[1])}{const t=h.exec(e);if(t){let e=t[4];return e="base64"===t[3]?atob(e):unescape(e),void this.callback(e)}}if(this.URL=new URL(e,this.getReferer()),this.bindViewpoint&&this.URL.href.substr(0,this.getReferer().length)===this.getReferer())return void this.bindViewpoint(decodeURIComponent(this.URL.hash.substr(1)));if(this.foreign){if(this.target.length&&"_self"!==this.target)return this.foreign(this.URL.href,this.target);if(this.URL.href.match(p))return this.foreign(this.URL.href,this.target)}t.ajax({url:decodeURI(this.URL.href),dataType:"binary",async:!0,cache:this.browser.getBrowserOptions().getCache()&&this.node.getCache(),global:!1,context:this,success:function(t,e,i){if(this.foreign&&f[this.getContentType(i)])return this.foreign(this.URL.href,this.target);this.text?(this.fileReader.onload=this.readAsArrayBuffer.bind(this,t),this.fileReader.readAsArrayBuffer(t)):(this.fileReader.onload=this.readAsBinaryString.bind(this),this.fileReader.readAsBinaryString(t))},error:function(t,e,i){this.loadDocumentError(new Error(i))}})}catch(t){return void this.loadDocumentError(t)}},readAsArrayBuffer:function(t){try{this.callback(u.ungzip(this.fileReader.result,{to:"string"}),this.URL)}catch(e){this.fileReader.onload=this.readAsText.bind(this,t),this.fileReader.readAsText(t)}},readAsText:function(t){try{this.callback(this.fileReader.result,this.URL)}catch(t){this.loadDocumentError(t)}},readAsBinaryString:function(){try{this.callback(this.fileReader.result,this.URL)}catch(t){this.loadDocumentError(t)}},loadDocumentError:function(t){this.error(t),this.url.length?this.loadDocumentAsync(this.url.shift()):this.callback(null)},error:function(t){"data:"===this.URL.protocol?console.warn("Couldn't load URL 'data':",t.message):console.warn("Couldn't load URL '"+decodeURI(this.URL.href)+"':",t.message),l&&console.error(t)},getReferer:function(){return"X3DWorld"===this.node.getTypeName()&&this.external?this.browser.getLocation():this.executionContext.getWorldURL()},getContentType:function(t){const e=t.getResponseHeader("Content-Type"),i=d.exec(e);return i?i[1]:""}});for(const t of Reflect.ownKeys(m.prototype))Object.defineProperty(m.prototype,t,{enumerable:!1});return m})),define("x_ite/Components/Shaders/ShaderPart",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Browser/Shaders/Shader","x_ite/Browser/Shaders/ShaderCompiler","x_ite/Components/Core/X3DNode","x_ite/Components/Networking/X3DUrlObject","x_ite/InputOutput/FileLoader","x_ite/Base/X3DConstants"],(function(t,e,i,n,r,s,o,a,u){"use strict";function l(t){s.call(this,t),o.call(this,t),this.addType(u.ShaderPart),this.options=[]}return l.prototype=Object.assign(Object.create(s.prototype),o.prototype,{constructor:l,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(u.inputOutput,"metadata",new t.SFNode),new e(u.initializeOnly,"type",new t.SFString("VERTEX")),new e(u.inputOutput,"load",new t.SFBool(!0)),new e(u.inputOutput,"url",new t.MFString),new e(u.inputOutput,"autoRefresh",new t.SFTime),new e(u.inputOutput,"autoRefreshTimeLimit",new t.SFTime(3600))]),getTypeName:function(){return"ShaderPart"},getComponentName:function(){return"Shaders"},getContainerField:function(){return"parts"},initialize:function(){s.prototype.initialize.call(this),o.prototype.initialize.call(this);const t=this.getBrowser().getContext();this.shader=t.createShader(t[this.getShaderType()]),this.requestImmediateLoad()},getShader:function(){return this.shader},getShaderType:function(){const t=new Map([["VERTEX","VERTEX_SHADER"],["TESS_CONTROL","TESS_CONTROL_SHADER"],["TESS_EVALUATION","TESS_EVALUATION_SHADER"],["GEOMETRY","GEOMETRY_SHADER"],["FRAGMENT","FRAGMENT_SHADER"],["COMPUTE","COMPUTE_SHADER"]]);return function(){return t.get(this._type.getValue())||"VERTEX_SHADER"}}(),getSourceText:function(){return this._url},setOptions:function(t){this.options=t},getOptions:function(){return this.options},unloadNow:function(){this.valid=!1},loadNow:function(){new a(this).loadDocument(this._url,function(t,e){if(null===t)this.setLoadState(u.FAILED_STATE);else{const i=this.getBrowser(),s=i.getContext(),o=new r(s),a=n.getShaderSource(s,i,o.process(t),this.options);if(s.shaderSource(this.shader,a),s.compileShader(this.shader),!s.getShaderParameter(this.shader,s.COMPILE_STATUS)){const t=s.getShaderInfoLog(this.shader).match(/(\d+):(\d+)/),i=o.getSourceFileName(t[1])||e;throw new Error("Error in "+this.getTypeName()+" '"+this.getName()+"' in URL '"+i+"', line "+t[2])}this.setLoadState(u.COMPLETE_STATE)}}.bind(this))}}),l})),define("x_ite/Browser/Shaders/X3DShadersContext",["x_ite/Browser/Core/Shading","x_ite/Components/Shaders/ComposedShader","x_ite/Components/Shaders/ShaderPart","x_ite/Browser/Networking/urls"],(function(t,e,i,n){"use strict";const r=Symbol(),s=Symbol(),o=Symbol(),a=Symbol();function u(){this[r]=!1,this[s]=new Map,this[a]=new Map}return u.prototype={initialize:function(){this.getDefaultShader(),this.setShading(this.getBrowserOptions().getShading())},getShadingLanguageVersion:function(){const t=this.getContext();return t.getParameter(t.SHADING_LANGUAGE_VERSION)},getMaxVertexUniformVectors:function(){const t=this.getContext();return t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS)},getMaxFragmentUniformVectors:function(){const t=this.getContext();return t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS)},getMaxVertexAttribs:function(){const t=this.getContext();return t.getParameter(t.MAX_VERTEX_ATTRIBS)},getWireframe:function(){return this[r]},getPrimitiveMode:function(t){return this[s].get(t)},getDefaultShader:function(){return this[o]=this.createShader("DefaultShader","data:x-shader/x-vertex,\n         precision highp float;\n         uniform mat4 x3d_ProjectionMatrix;\n         uniform mat4 x3d_ModelViewMatrix;\n         attribute vec4 x3d_Vertex;\n         void\n         main ()\n         {\n            gl_Position = x3d_ProjectionMatrix * (x3d_ModelViewMatrix * x3d_Vertex);\n         }\n         ","data:x-shader/x-fragment,\n         precision highp float;\n         void\n         main ()\n         {\n            gl_FragColor = vec4 (0.0);\n            discard;\n         }\n         "),this.getDefaultShader=function(){return this[o]},Object.defineProperty(this,"getDefaultShader",{enumerable:!1}),this[o]},getShaders:function(){return this[a]},setShading:function(e){const i=this.getContext();switch(e){case t.POINT:this[r]=!1,this[s].set(i.POINTS,i.POINTS),this[s].set(i.LINES,i.POINTS),this[s].set(i.TRIANGLES,i.POINTS);break;case t.WIREFRAME:this[r]=!0,this[s].set(i.POINTS,i.POINTS),this[s].set(i.LINES,i.LINES),this[s].set(i.TRIANGLES,i.LINE_LOOP);break;default:this[r]=!1,this[s].set(i.POINTS,i.POINTS),this[s].set(i.LINES,i.LINES),this[s].set(i.TRIANGLES,i.TRIANGLES)}},createShader:function(t,r,s=r,o=[]){this.getDebug()&&console.info("Initializing "+t);const a=this.getContext().getVersion(),u=new i(this.getPrivateScene());u.setName(t+"Vertex"),u.setOptions(o),u._url.push(r.startsWith("data:")?r:n.getShaderUrl("webgl"+a+"/"+r+".vs")),u.setup();const l=new i(this.getPrivateScene());l.setName(t+"Fragment"),l.setOptions(o),l._type="FRAGMENT",l._url.push(s.startsWith("data:")?s:n.getShaderUrl("webgl"+a+"/"+s+".fs")),l.setup();const c=new e(this.getPrivateScene());return c.setName(t),c._language="GLSL",c._parts.push(u),c._parts.push(l),c.setup(),c}},u})),function(t,e){"function"==typeof define&&define.amd?define("ResizeSensor/src/ResizeSensor",e):"object"==typeof exports?module.exports=e():t.ResizeSensor=e()}("undefined"!=typeof window?window:this,(function(){if("undefined"==typeof window)return null;var t="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),e=t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||function(e){return t.setTimeout(e,20)},i=t.cancelAnimationFrame||t.mozCancelAnimationFrame||t.webkitCancelAnimationFrame||function(e){t.clearTimeout(e)};function n(t,e){var i=Object.prototype.toString.call(t),n="[object Array]"===i||"[object NodeList]"===i||"[object HTMLCollection]"===i||"[object Object]"===i||"undefined"!=typeof jQuery&&t instanceof jQuery||"undefined"!=typeof Elements&&t instanceof Elements,r=0,s=t.length;if(n)for(;r<s;r++)e(t[r]);else e(t)}function r(t){if(!t.getBoundingClientRect)return{width:t.offsetWidth,height:t.offsetHeight};var e=t.getBoundingClientRect();return{width:Math.round(e.width),height:Math.round(e.height)}}function s(t,e){Object.keys(e).forEach((function(i){t.style[i]=e[i]}))}var o=function(t,a){var u=0;function l(){var t,e,i=[];this.add=function(t){i.push(t)},this.call=function(n){for(t=0,e=i.length;t<e;t++)i[t].call(this,n)},this.remove=function(n){var r=[];for(t=0,e=i.length;t<e;t++)i[t]!==n&&r.push(i[t]);i=r},this.length=function(){return i.length}}function c(t,i){if(t)if(t.resizedAttached)t.resizedAttached.add(i);else{t.resizedAttached=new l,t.resizedAttached.add(i),t.resizeSensor=document.createElement("div"),t.resizeSensor.dir="ltr",t.resizeSensor.className="resize-sensor";var n={pointerEvents:"none",position:"absolute",left:"0px",top:"0px",right:"0px",bottom:"0px",overflow:"hidden",zIndex:"-1",visibility:"hidden",maxWidth:"100%"},o={position:"absolute",left:"0px",top:"0px",transition:"0s"};s(t.resizeSensor,n);var a=document.createElement("div");a.className="resize-sensor-expand",s(a,n);var c=document.createElement("div");s(c,o),a.appendChild(c);var h=document.createElement("div");h.className="resize-sensor-shrink",s(h,n);var d=document.createElement("div");s(d,o),s(d,{width:"200%",height:"200%"}),h.appendChild(d),t.resizeSensor.appendChild(a),t.resizeSensor.appendChild(h),t.appendChild(t.resizeSensor);var p=window.getComputedStyle(t),f=p?p.getPropertyValue("position"):null;"absolute"!==f&&"relative"!==f&&"fixed"!==f&&"sticky"!==f&&(t.style.position="relative");var g=!1,m=0,_=r(t),y=0,x=0,w=!0;u=0;var b=function(){if(w){if(0===t.offsetWidth&&0===t.offsetHeight)return void(u||(u=e((function(){u=0,b()}))));w=!1}var i,n;i=t.offsetWidth,n=t.offsetHeight,c.style.width=i+10+"px",c.style.height=n+10+"px",a.scrollLeft=i+10,a.scrollTop=n+10,h.scrollLeft=i+10,h.scrollTop=n+10};t.resizeSensor.resetSensor=b;var v=function(){m=0,g&&(y=_.width,x=_.height,t.resizedAttached&&t.resizedAttached.call(_))},S=function(){_=r(t),(g=_.width!==y||_.height!==x)&&!m&&(m=e(v)),b()},T=function(t,e,i){t.attachEvent?t.attachEvent("on"+e,i):t.addEventListener(e,i)};T(a,"scroll",S),T(h,"scroll",S),u=e((function(){u=0,b()}))}}n(t,(function(t){c(t,a)})),this.detach=function(e){u||(i(u),u=0),o.detach(t,e)},this.reset=function(){t.resizeSensor.resetSensor()}};if(o.reset=function(t){n(t,(function(t){t.resizeSensor.resetSensor()}))},o.detach=function(t,e){n(t,(function(t){t&&(t.resizedAttached&&"function"==typeof e&&(t.resizedAttached.remove(e),t.resizedAttached.length())||t.resizeSensor&&(t.contains(t.resizeSensor)&&t.removeChild(t.resizeSensor),delete t.resizeSensor,delete t.resizedAttached))}))},"undefined"!=typeof MutationObserver){var a=new MutationObserver((function(t){for(var e in t)if(t.hasOwnProperty(e))for(var i=t[e].addedNodes,n=0;n<i.length;n++)i[n].resizeSensor&&o.reset(i[n])}));document.addEventListener("DOMContentLoaded",(function(t){a.observe(document.body,{childList:!0,subtree:!0})}))}return o})),define("ResizeSensor",["ResizeSensor/src/ResizeSensor"],(function(t){return t})),define("x_ite/Browser/Rendering/X3DRenderingContext",["jquery","ResizeSensor"],(function(t,e){"use strict";const i=Symbol(),n=Symbol(),r=Symbol(),s=Symbol();function o(){this[i]=[0,0,300,150],this[n]=[]}return o.prototype={initialize:function(){const i=this.getContext();i.enable(i.SCISSOR_TEST),i.cullFace(i.BACK),i.enable(i.DEPTH_TEST),i.depthFunc(i.LEQUAL),i.clearDepth(1),i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA),i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD),i.enable(i.BLEND),t(document).on("webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange",this.onfullscreen.bind(this)),this[s]=new e(this.getSurface(),this.reshape.bind(this)),this.getSurface().css("position",""),this.reshape()},getRenderer:function(){const t=this.getContext();if(!navigator.userAgent.match(/Firefox/)){const e=t.getExtension("WEBGL_debug_renderer_info");if(e)return t.getParameter(e.UNMASKED_RENDERER_WEBGL)}return t.getParameter(t.RENDERER)},getVendor:function(){const t=this.getContext();if(!navigator.userAgent.match(/Firefox/)){const e=t.getExtension("WEBGL_debug_renderer_info");if(e)return t.getParameter(e.UNMASKED_VENDOR_WEBGL)}return t.getParameter(t.VENDOR)},getWebGLVersion:function(){const t=this.getContext();return t.getParameter(t.VERSION)},getAntialiased:function(){const t=this.getContext();return t.getParameter(t.SAMPLES)>0},getMaxClipPlanes:function(){return 6},getDepthSize:function(){const t=this.getContext();return t.getParameter(t.DEPTH_BITS)},getColorDepth:function(){const t=this.getContext();return t.getParameter(t.RED_BITS)+t.getParameter(t.BLUE_BITS)+t.getParameter(t.GREEN_BITS)+t.getParameter(t.ALPHA_BITS)},getViewport:function(){return this[i]},getLocalObjects:function(){return this[n]},getDepthShader:function(){return this[r]=this.createShader("DepthShader","Depth"),this.getDepthShader=function(){return this[r]},Object.defineProperty(this,"getDepthShader",{enumerable:!1}),this[r]},reshape:function(){const t=this.getContext(),e=this.getCanvas(),n=e.width(),r=e.height(),s=e[0];s.width=n,s.height=r,this[i][2]=n,this[i][3]=r,t.viewport(0,0,n,r),t.scissor(0,0,n,r),this.addBrowserEvent()},onfullscreen:function(){const t=this.getElement();t.fullScreen()?t.addClass("x_ite-fullscreen"):t.removeClass("x_ite-fullscreen")}},o})),define("x_ite/Components/Shape/X3DAppearanceNode",["x_ite/Fields","x_ite/Components/Core/X3DNode","x_ite/Base/X3DConstants"],(function(t,e,i){"use strict";function n(n){e.call(this,n),this.addType(i.X3DAppearanceNode),this.addChildObjects("transparent",new t.SFBool),this._transparent.setAccessType(i.outputOnly)}return n.prototype=Object.assign(Object.create(e.prototype),{constructor:n,setTransparent:function(t){t!==this._transparent.getValue()&&(this._transparent=t)},getTransparent:function(){return this._transparent.getValue()}}),n})),define("x_ite/Browser/Shape/AlphaMode",[],(function(){"use strict";let t=0;return{AUTO:t++,OPAQUE:t++,MASK:t++,BLEND:t++}})),define("x_ite/Components/Shape/Appearance",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Shape/X3DAppearanceNode","x_ite/Base/X3DCast","x_ite/Base/X3DConstants","x_ite/Browser/Shape/AlphaMode"],(function(t,e,i,n,r,s,o){"use strict";function a(t){n.call(this,t),this.addType(s.Appearance),this.stylePropertiesNode=[],this.materialNode=null,this.backMaterialNode=null,this.textureNode=null,this.textureTransformNode=null,this.textureTransformMapping=new Map,this.shaderNodes=[],this.shaderNode=null,this.blendModeNode=null}return a.prototype=Object.assign(Object.create(n.prototype),{constructor:a,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.inputOutput,"alphaMode",new t.SFString("AUTO")),new e(s.inputOutput,"alphaCutoff",new t.SFFloat(.5)),new e(s.inputOutput,"acousticProperties",new t.SFNode),new e(s.inputOutput,"pointProperties",new t.SFNode),new e(s.inputOutput,"lineProperties",new t.SFNode),new e(s.inputOutput,"fillProperties",new t.SFNode),new e(s.inputOutput,"material",new t.SFNode),new e(s.inputOutput,"backMaterial",new t.SFNode),new e(s.inputOutput,"texture",new t.SFNode),new e(s.inputOutput,"textureTransform",new t.SFNode),new e(s.inputOutput,"shaders",new t.MFNode),new e(s.inputOutput,"blendMode",new t.SFNode)]),getTypeName:function(){return"Appearance"},getComponentName:function(){return"Shape"},getContainerField:function(){return"appearance"},initialize:function(){n.prototype.initialize.call(this),this._alphaMode.addInterest("set_alphaMode__",this),this._alphaCutoff.addInterest("set_alphaCutoff__",this),this._pointProperties.addInterest("set_pointProperties__",this),this._lineProperties.addInterest("set_lineProperties__",this),this._fillProperties.addInterest("set_fillProperties__",this),this._material.addInterest("set_material__",this),this._backMaterial.addInterest("set_backMaterial__",this),this._texture.addInterest("set_texture__",this),this._textureTransform.addInterest("set_textureTransform__",this),this._shaders.addInterest("set_shaders__",this),this._blendMode.addInterest("set_blendMode__",this),this._alphaMode.addInterest("set_transparent__",this),this._fillProperties.addInterest("set_transparent__",this),this._material.addInterest("set_transparent__",this),this._texture.addInterest("set_transparent__",this),this._blendMode.addInterest("set_transparent__",this),this.set_alphaMode__(),this.set_pointProperties__(),this.set_lineProperties__(),this.set_fillProperties__(),this.set_material__(),this.set_backMaterial__(),this.set_texture__(),this.set_textureTransform__(),this.set_shaders__(),this.set_blendMode__(),this.set_transparent__()},getAlphaMode:function(){return this.alphaMode},getAlphaCutoff:function(){return this.alphaCutoff},getStyleProperties:function(t){return this.stylePropertiesNode[t]},getPointProperties:function(){return this.stylePropertiesNode[0]},getLineProperties:function(){return this.stylePropertiesNode[1]},getFillProperties:function(){return this.stylePropertiesNode[2]},getMaterial:function(){return this.materialNode},getBackMaterial:function(){return this.backMaterialNode},getTexture:function(){return this.textureNode},getTextureTransform:function(){return this.textureTransformNode},getTextureTransformMapping:function(){return this.textureTransformMapping},getShader:function(t,e){return this.materialNode.getShader(t,e)},getBackShader:function(t,e){return this.backMaterialNode.getShader(t,e)},getBlendMode:function(){return this.blendModeNode},set_alphaMode__:function(){this.alphaMode=this.getEnum(o,this._alphaMode.getValue(),o.AUTO),this.set_alphaCutoff__()},set_alphaCutoff__:function(){this.alphaCutoff=this.alphaMode===o.MASK?this._alphaCutoff.getValue():0},set_pointProperties__:function(){this.stylePropertiesNode[0]=r(s.PointProperties,this._pointProperties)},set_lineProperties__:function(){this.stylePropertiesNode[1]=r(s.LineProperties,this._lineProperties)},set_fillProperties__:function(){this.stylePropertiesNode[2]&&this.stylePropertiesNode[2]._transparent.removeInterest("set_transparent__",this),this.stylePropertiesNode[2]=r(s.FillProperties,this._fillProperties),this.stylePropertiesNode[2]&&this.stylePropertiesNode[2]._transparent.addInterest("set_transparent__",this),this.stylePropertiesNode[3]=this.stylePropertiesNode[2]},set_material__:function(){this.materialNode&&this.materialNode._transparent.removeInterest("set_transparent__",this),this.materialNode=r(s.X3DMaterialNode,this._material),this.materialNode||(this.materialNode=this.getBrowser().getDefaultMaterial()),this.materialNode&&this.materialNode._transparent.addInterest("set_transparent__",this),"TwoSidedMaterial"===this.materialNode.getTypeName()&&this.set_backMaterial__()},set_backMaterial__:function(){this.backMaterialNode&&this.backMaterialNode._transparent.removeInterest("set_transparent__",this),this.backMaterialNode=r(s.X3DOneSidedMaterialNode,this._backMaterial),this.backMaterialNode&&this.backMaterialNode._transparent.addInterest("set_transparent__",this),this.backMaterialNode||"TwoSidedMaterial"!==this.materialNode.getTypeName()||(this.backMaterialNode=this.materialNode)},set_texture__:function(){this.textureNode&&this.textureNode._transparent.removeInterest("set_transparent__",this),this.textureNode=r(s.X3DTextureNode,this._texture),this.textureNode&&this.textureNode._transparent.addInterest("set_transparent__",this)},set_textureTransform__:function(){this.textureTransformNode&&this.textureTransformNode.removeInterest("updateTextureTransformMapping",this),this.textureTransformNode=r(s.X3DTextureTransformNode,this._textureTransform),this.textureTransformNode||(this.textureTransformNode=this.getBrowser().getDefaultTextureTransform()),this.textureTransformNode.addInterest("updateTextureTransformMapping",this),this.updateTextureTransformMapping()},updateTextureTransformMapping:function(){this.textureTransformMapping.clear(),this.textureTransformNode.getTextureMapping(this.textureTransformMapping)},set_shaders__:function(){const t=this.shaderNodes;for(const e of t)e._isValid.removeInterest("set_shader__",this),e._activationTime.removeInterest("set_shader__",this);t.length=0;for(const e of this._shaders){const i=r(s.X3DShaderNode,e);i&&(t.push(i),i._isValid.addInterest("set_shader__",this),i._activationTime.addInterest("set_shader__",this))}this.set_shader__()},set_shader__:function(){function t(){return this.shaderNode}return function(){const e=this.shaderNodes;this.shaderNode&&this.shaderNode.deselect(),this.shaderNode=null;for(const t of e)if(t._isValid.getValue()&&t._activationTime.getValue()===this.getBrowser().getCurrentTime()){this.shaderNode=t;break}if(!this.shaderNode)for(const t of e)if(t._isValid.getValue()){this.shaderNode=t;break}this.shaderNode?(this.shaderNode.select(),this.getShader=t,this.getBackShader=t):(delete this.getShader,delete this.getBackShader)}}(),set_blendMode__:function(){this.blendModeNode=r(s.BlendMode,this._blendMode)},set_transparent__:function(){switch(this.alphaMode){case o.AUTO:this.setTransparent(Boolean(this.stylePropertiesNode[3]&&this.stylePropertiesNode[3].getTransparent()||this.materialNode&&this.materialNode.getTransparent()||this.backMaterialNode&&this.backMaterialNode.getTransparent()||this.textureNode&&this.textureNode.getTransparent()||this.blendModeNode));break;case o.OPAQUE:case o.MASK:this.setTransparent(!1);break;case o.BLEND:this.setTransparent(!0)}},traverse:function(t,e){this.textureNode&&this.textureNode.traverse(t,e)}}),a})),define("x_ite/Components/Shape/X3DMaterialNode",["x_ite/Fields","x_ite/Components/Shape/X3DAppearanceChildNode","x_ite/Base/X3DConstants","standard/Utility/BitSet"],(function(t,e,i,n){"use strict";function r(r){e.call(this,r),this.addType(i.X3DMaterialNode),this.addChildObjects("transparent",new t.SFBool),this._transparent.setAccessType(i.outputOnly),this.textureBits=new n,this.shaderNodes=this.getBrowser().getShaders()}return r.prototype=Object.assign(Object.create(e.prototype),{constructor:r,initialize:function(){e.prototype.initialize.call(this),this.getBrowser().getRenderingProperties()._LogarithmicDepthBuffer.addInterest("set_logarithmicDepthBuffer__",this),this.set_logarithmicDepthBuffer__()},set_logarithmicDepthBuffer__:function(){this.logarithmicDepthBuffer=this.getBrowser().getRenderingProperty("LogarithmicDepthBuffer")},setTransparent:function(t){t!==this._transparent.getValue()&&(this._transparent=t)},getTransparent:function(){return this._transparent.getValue()},setTexture:function(t,e){const i=e?e.getTextureType()-1:0;this.textureBits.set(2*t+0,1&i),this.textureBits.set(2*t+1,2&i)},getTextureBits:function(){return this.textureBits},getShader:function(t,e){const i=e.appearanceNode.getStyleProperties(t.geometryType);let n=+this.textureBits;n|=this.getMaterialType(e.shadows)<<14,n|=this.logarithmicDepthBuffer<<16,n|=e.shadows<<17,n|=(e.fogNode?1:0)<<18,n|=(i?1:0)<<19,n|=t.geometryMask<<20;const r=this.shaderNodes.get(n)||this.createShader(n,t,e);if(r.isValid())return t.shaderNode=r,r;{const e=t.shaderNode;return e&&e.isValid()?e:this.getBrowser().getDefaultShader()}},getGeometryType:function(){const t=["X3D_GEOMETRY_0D","X3D_GEOMETRY_1D","X3D_GEOMETRY_2D","X3D_GEOMETRY_3D"];return function(e){return t[e]}}()}),r})),define("x_ite/Components/Shape/X3DOneSidedMaterialNode",["x_ite/Fields","x_ite/Components/Shape/X3DMaterialNode","x_ite/Base/X3DCast","x_ite/Base/X3DConstants","standard/Math/Algorithm"],(function(t,e,i,n,r){"use strict";function s(i){e.call(this,i),this.addType(n.X3DOneSidedMaterialNode),this.addChildObjects("textures",new t.SFTime),this.emissiveColor=new Float32Array(3)}return s.prototype=Object.assign(Object.create(e.prototype),{constructor:s,initialize:function(){e.prototype.initialize.call(this),this._emissiveColor.addInterest("set_emissiveColor__",this),this._emissiveTexture.addInterest("set_emissiveTexture__",this),this._normalTexture.addInterest("set_normalTexture__",this),this._transparency.addInterest("set_transparency__",this),this._transparency.addInterest("set_transparent__",this),this.set_emissiveColor__(),this.set_emissiveTexture__(),this.set_normalTexture__(),this.set_transparency__()},set_emissiveColor__:function(){const t=this.emissiveColor,e=this._emissiveColor.getValue();t[0]=e.r,t[1]=e.g,t[2]=e.b},set_emissiveTexture__:function(){this.emissiveTextureNode=i(n.X3DSingleTextureNode,this._emissiveTexture),this.setTexture(this.getTextureIndices().EMISSIVE_TEXTURE,this.emissiveTextureNode)},set_normalTexture__:function(){this.normalTextureNode=i(n.X3DSingleTextureNode,this._normalTexture),this.setTexture(this.getTextureIndices().NORMAL_TEXTURE,this.normalTextureNode)},set_transparency__:function(){this.transparency=r.clamp(this._transparency.getValue(),0,1)},set_transparent__:function(){this.setTransparent(Boolean(this.transparency))},getEmissiveTexture:function(){return this.emissiveTextureNode},getNormalTexture:function(){return this.normalTextureNode},getTransparency:function(){return this.transparency},getTextureIndices:function(){const t={EMISSIVE_TEXTURE:0,NORMAL_TEXTURE:1};return function(){return t}}(),setShaderUniforms:function(t,e,i,n,r){if(t.uniform3fv(e.x3d_EmissiveColor,this.emissiveColor),t.uniform1f(e.x3d_Transparency,this.transparency),+this.getTextureBits()){if(this.emissiveTextureNode){const s=e.x3d_EmissiveTexture;this.emissiveTextureNode.setShaderUniformsToChannel(t,e,i,s),t.uniform1i(s.textureTransformMapping,n.get(this._emissiveTextureMapping.getValue())||0),t.uniform1i(s.textureCoordinateMapping,r.get(this._emissiveTextureMapping.getValue())||0)}if(this.normalTextureNode){const s=e.x3d_NormalTexture;this.normalTextureNode.setShaderUniformsToChannel(t,e,i,s),t.uniform1i(s.textureTransformMapping,n.get(this._normalTextureMapping.getValue())||0),t.uniform1i(s.textureCoordinateMapping,r.get(this._normalTextureMapping.getValue())||0),t.uniform1f(e.x3d_NormalScale,this._normalScale.getValue())}}}}),s})),define("x_ite/Components/Shape/UnlitMaterial",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Shape/X3DOneSidedMaterialNode","x_ite/Base/X3DConstants"],(function(t,e,i,n,r){"use strict";function s(t){n.call(this,t),this.addType(r.UnlitMaterial)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"emissiveColor",new t.SFColor(1,1,1)),new e(r.inputOutput,"emissiveTexture",new t.SFNode),new e(r.inputOutput,"emissiveTextureMapping",new t.SFString),new e(r.inputOutput,"normalScale",new t.SFFloat(1)),new e(r.inputOutput,"normalTexture",new t.SFNode),new e(r.inputOutput,"normalTextureMapping",new t.SFString),new e(r.inputOutput,"transparency",new t.SFFloat)]),getTypeName:function(){return"UnlitMaterial"},getComponentName:function(){return"Shape"},getContainerField:function(){return"material"},initialize:function(){n.prototype.initialize.call(this),this.set_transparent__()},set_emissiveTexture__:function(){this.getEmissiveTexture()&&this.getEmissiveTexture()._transparent.removeInterest("set_transparent__",this),n.prototype.set_emissiveTexture__.call(this),this.getEmissiveTexture()&&this.getEmissiveTexture()._transparent.addInterest("set_transparent__",this)},set_transparent__:function(){this.setTransparent(Boolean(this.getTransparency()||this.getEmissiveTexture()&&this.getEmissiveTexture().getTransparent()))},getMaterialType:function(){return 0},createShader:function(t,e,i){const n=this.getBrowser(),r=i.appearanceNode.getStyleProperties(e.geometryType),s=[];s.push("X3D_UNLIT",this.getGeometryType(e.geometryType)),i.shadows&&s.push("X3D_SHADOWS","X3D_PCF_FILTERING"),i.fogNode&&s.push("X3D_FOG"),e.hasFogCoords&&s.push("X3D_FOG_COORDS"),e.colorMaterial&&s.push("X3D_COLOR_MATERIAL"),e.hasNormals&&s.push("X3D_NORMALS"),r&&s.push("X3D_STYLE_PROPERTIES"),+this.getTextureBits()&&(s.push("X3D_MATERIAL_TEXTURES"),this.getEmissiveTexture()&&s.push("X3D_EMISSIVE_TEXTURE","X3D_EMISSIVE_TEXTURE","X3D_EMISSIVE_TEXTURE_"+this.getEmissiveTexture().getTextureTypeString()),this.getNormalTexture()&&s.push("X3D_NORMAL_TEXTURE","X3D_NORMAL_TEXTURE_"+this.getNormalTexture().getTextureTypeString()));const o=n.createShader("UnlitShader","Default","Unlit",s);return n.getShaders().set(t,o),o}}),s})),define("x_ite/Components/Texturing/TextureProperties",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Base/X3DConstants","standard/Math/Algorithm"],(function(t,e,i,n,r,s){"use strict";function o(t){n.call(this,t),this.addType(r.TextureProperties)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"borderColor",new t.SFColorRGBA),new e(r.inputOutput,"borderWidth",new t.SFInt32),new e(r.inputOutput,"anisotropicDegree",new t.SFFloat(1)),new e(r.initializeOnly,"generateMipMaps",new t.SFBool),new e(r.inputOutput,"minificationFilter",new t.SFString("DEFAULT")),new e(r.inputOutput,"magnificationFilter",new t.SFString("DEFAULT")),new e(r.inputOutput,"boundaryModeS",new t.SFString("REPEAT")),new e(r.inputOutput,"boundaryModeT",new t.SFString("REPEAT")),new e(r.inputOutput,"boundaryModeR",new t.SFString("REPEAT")),new e(r.inputOutput,"textureCompression",new t.SFString("DEFAULT")),new e(r.inputOutput,"texturePriority",new t.SFFloat)]),getTypeName:function(){return"TextureProperties"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"textureProperties"},getBorderWidth:function(){return s.clamp(this._borderWidth.getValue(),0,1)},getBoundaryMode:function(){const t=new Map([["CLAMP","CLAMP_TO_EDGE"],["CLAMP_TO_EDGE","CLAMP_TO_EDGE"],["CLAMP_TO_BOUNDARY","CLAMP_TO_EDGE"],["MIRRORED_REPEAT","MIRRORED_REPEAT"],["REPEAT","REPEAT"]]);return function(e){const i=t.get(e);return void 0!==i?i:"REPEAT"}}(),getBoundaryModeS:function(){return this.getBoundaryMode(this._boundaryModeS.getValue())},getBoundaryModeT:function(){return this.getBoundaryMode(this._boundaryModeT.getValue())},getBoundaryModeR:function(){return this.getBoundaryMode(this._boundaryModeR.getValue())},getMinificationFilter:function(){const t=new Map([["AVG_PIXEL_AVG_MIPMAP","LINEAR_MIPMAP_LINEAR"],["AVG_PIXEL","LINEAR"],["AVG_PIXEL_NEAREST_MIPMAP","LINEAR_MIPMAP_NEAREST"],["NEAREST_PIXEL_AVG_MIPMAP","NEAREST_MIPMAP_LINEAR"],["NEAREST_PIXEL_NEAREST_MIPMAP","NEAREST_MIPMAP_NEAREST"],["NEAREST_PIXEL","NEAREST"],["NICEST","LINEAR_MIPMAP_LINEAR"],["FASTEST","NEAREST"]]);return function(){if(this._generateMipMaps.getValue()){const e=t.get(this._minificationFilter.getValue());return void 0!==e?e:this.getBrowser().getDefaultTextureProperties().getMinificationFilter()}return"LINEAR"}}(),getMagnificationFilter:function(){const t=new Map([["AVG_PIXEL","LINEAR"],["NEAREST_PIXEL","NEAREST"],["NICEST","LINEAR"],["FASTEST","NEAREST"]]);return function(){const e=t.get(this._magnificationFilter.getValue());return void 0!==e?e:this.getBrowser().getDefaultTextureProperties().getMagnificationFilter()}}(),getTextureCompression:function(){const t=new Map([["DEFAULT","RGBA"],["NICEST","RGBA"],["FASTEST","RGBA"],["LOW","RGBA"],["MEDIUM","RGBA"],["HIGH","RGBA"]]);return function(){const e=this.getBrowser().getContext(),i=e.getExtension("WEBGL_compressed_texture_etc"),n=i?i[t.get(this._textureCompression.getValue())]:void 0;return void 0!==n?n:e.RGBA}}()}),o})),define("x_ite/Browser/Shape/X3DShapeContext",["x_ite/Components/Shape/Appearance","x_ite/Components/Shape/UnlitMaterial","x_ite/Components/Texturing/ImageTexture","x_ite/Components/Texturing/TextureProperties","x_ite/Browser/Networking/urls"],(function(t,e,i,n,r){"use strict";const s=Symbol(),o=Symbol(),a=Symbol(),u=Symbol(),l=Symbol(),c=Symbol(),h=Symbol(),d=Symbol();function p(){this[a]=[],this[s]=1/(32*this.getPixelPerPoint())}return p.prototype={initialize:function(){},getDefaultAppearance:function(){return this[u]=new t(this.getPrivateScene()),this[u].setup(),this.getDefaultAppearance=function(){return this[u]},Object.defineProperty(this,"getDefaultAppearance",{enumerable:!1}),this[u]},getLineStippleScale:function(){return this[s]},getDefaultMaterial:function(){return this[l]=new e(this.getPrivateScene()),this[l].setup(),this.getDefaultMaterial=function(){return this[l]},Object.defineProperty(this,"getDefaultMaterial",{enumerable:!1}),this[l]},getLinetypeTexture:function(){return this[o]=new i(this.getPrivateScene()),this[o]._url[0]=r.getLinetypeUrl(),this[o]._textureProperties=this.getLineFillTextureProperties(),this[o].setup(),this.getLinetypeTexture=function(){return this[o]},Object.defineProperty(this,"getLinetypeTexture",{enumerable:!1}),this[o]},getHatchStyleTexture:function(t){let e=this[a][t];return e||(e=this[a][t]=new i(this.getPrivateScene()),e._url[0]=r.getHatchingUrl(t),e._textureProperties=this.getLineFillTextureProperties(),e.setup(),e)},getLineFillTextureProperties:function(){return this[c]=new n(this.getPrivateScene()),this[c]._minificationFilter="NEAREST_PIXEL",this[c]._magnificationFilter="NEAREST_PIXEL",this[c].setup(),this.getLineFillTextureProperties=function(){return this[c]},Object.defineProperty(this,"getLineFillTextureProperties",{enumerable:!1}),this[c]},getLineTransformShader:function(){return this[h]=this.createShader("LineTransformShader","LineTransform"),this[h].setUniformNames(["viewport","modelViewProjectionMatrix","invModelViewProjectionMatrix","scale"]),this[h].setTransformFeedbackVaryings(["fogDepth0","color0","texCoord0","vertex0","fogDepth1","color1","texCoord1","vertex1","fogDepth2","color2","texCoord2","vertex2"]),this.getLineTransformShader=function(){return this[h]},Object.defineProperty(this,"getLineTransformShader",{enumerable:!1}),this[h]},getLineTransformFeedback:function(){const t=this.getContext();return this[d]=t.createTransformFeedback(),this.getLineTransformFeedback=function(){return this[d]},Object.defineProperty(this,"getLineTransformFeedback",{enumerable:!1}),this[d]}},p})),define("x_ite/Components/Shape/X3DShapeNode",["x_ite/Components/Core/X3DChildNode","x_ite/Components/Grouping/X3DBoundedObject","x_ite/Base/X3DCast","x_ite/Base/X3DConstants","x_ite/Browser/Shape/AlphaMode","standard/Math/Geometry/Box3","standard/Math/Numbers/Vector3"],(function(t,e,i,n,r,s,o){"use strict";function a(i){t.call(this,i),e.call(this,i),this.addType(n.X3DShapeNode),this.bbox=new s,this.bboxSize=new o(0,0,0),this.bboxCenter=new o(0,0,0)}return a.prototype=Object.assign(Object.create(t.prototype),e.prototype,{constructor:a,initialize:function(){t.prototype.initialize.call(this),e.prototype.initialize.call(this),this._bboxSize.addInterest("set_bbox__",this),this._bboxCenter.addInterest("set_bbox__",this),this._appearance.addInterest("set_apparance__",this),this._geometry.addInterest("set_geometry__",this),this._appearance.addInterest("set_transparent__",this),this._geometry.addInterest("set_transparent__",this),this.set_apparance__(),this.set_geometry__(),this.set_transparent__()},getBBox:function(t,e){return e?this._castShadow.getValue()?t.assign(this.bbox):t.set():t.assign(this.bbox)},getBBoxSize:function(){return this.bboxSize},getBBoxCenter:function(){return this.bboxCenter},getAppearance:function(){return this.apparanceNode},getGeometry:function(){return this.geometryNode},setTransparent:function(t){this.transparent=t},getTransparent:function(){return this.transparent},set_bbox__:function(){this._bboxSize.getValue().equals(this.getDefaultBBoxSize())?this.getGeometry()?this.bbox.assign(this.getGeometry().getBBox()):this.bbox.set():this.bbox.set(this._bboxSize.getValue(),this._bboxCenter.getValue()),this.bboxSize.assign(this.bbox.size),this.bboxCenter.assign(this.bbox.center)},set_apparance__:function(){this.apparanceNode&&this.apparanceNode._transparent.removeInterest("set_transparent__",this),this.apparanceNode=i(n.X3DAppearanceNode,this._appearance),this.apparanceNode?(this.apparanceNode._alphaMode.addInterest("set_transparent__",this),this.apparanceNode._transparent.addInterest("set_transparent__",this)):this.apparanceNode=this.getBrowser().getDefaultAppearance()},set_geometry__:function(){this.geometryNode&&(this.geometryNode._transparent.addInterest("set_transparent__",this),this.geometryNode._bbox_changed.addInterest("set_bbox__",this)),this.geometryNode=i(n.X3DGeometryNode,this._geometry),this.geometryNode&&(this.geometryNode._transparent.addInterest("set_transparent__",this),this.geometryNode._bbox_changed.addInterest("set_bbox__",this)),this.set_bbox__()},set_transparent__:function(){this.apparanceNode.getAlphaMode()===r.AUTO?this.transparent=this.apparanceNode.getTransparent()||this.geometryNode&&this.geometryNode.getTransparent():this.transparent=this.apparanceNode.getTransparent()}}),a})),define("standard/Math/Geometry/Line3",["standard/Math/Numbers/Vector3"],(function(t){"use strict";function e(t,e){this.point=t.copy(),this.direction=e.copy()}return e.prototype={constructor:e,copy:function(){const t=Object.create(e.prototype);return t.point=this.point.copy(),t.direction=this.direction.copy(),t},assign:function(t){return this.point.assign(t.point),this.direction.assign(t.direction),this},set:function(t,e){return this.point.assign(t),this.direction.assign(e),this},setPoints:function(t,e){return this.point.assign(t),this.direction.assign(e).subtract(t).normalize(),this},multMatrixLine:function(t){return t.multMatrixVec(this.point),t.multMatrixDir(this.direction).normalize(),this},multLineMatrix:function(t){return t.multVecMatrix(this.point),t.multDirMatrix(this.direction).normalize(),this},getClosestPointToPoint:function(t,e){const i=e.assign(t).subtract(this.point).dot(this.direction);return e.assign(this.direction).multiply(i).add(this.point)},getClosestPointToLine:function(){const e=new t(0,0,0);return function(t,i){const n=this.point,r=t.point,s=this.direction,o=t.direction;let a=s.dot(o);return!(Math.abs(a)>=1)&&(e.assign(r).subtract(n),a=(e.dot(s)-a*e.dot(o))/(1-a*a),i.assign(s).multiply(a).add(n),!0)}}(),getPerpendicularVectorToPoint:function(){const e=new t(0,0,0);return function(t,i){return i.assign(this.point).subtract(t),i.subtract(e.assign(this.direction).multiply(i.dot(this.direction)))}}(),getPerpendicularVectorToLine:function(){const e=new t(0,0,0),i=new t(0,0,0);return function(t,n){const r=n;e.assign(this.point).subtract(t.point);const s=e.dot(this.direction),o=e.dot(t.direction),a=this.direction.dot(t.direction),u=a*a,l=(s-o*a)/(1-u),c=-(o-s*a)/(1-u);return i.assign(this.direction).multiply(l),r.assign(t.direction).multiply(c),r.subtract(i).add(e)}}(),intersectsTriangle:function(){const e=new t(0,0,0),i=new t(0,0,0);return function(t,n,r,s){const o=n.subtract(t),a=r.subtract(t);e.assign(this.direction).cross(a);const u=o.dot(e);if(0===u)return!1;const l=1/u;i.assign(this.point).subtract(t);const c=i.dot(e)*l;if(c<0||c>1)return!1;const h=i.cross(o),d=this.direction.dot(h)*l;return!(d<0||c+d>1)&&(s.u=c,s.v=d,s.t=1-c-d,!0)}}(),toString:function(){return this.point+", "+this.direction}},e.Points=function(i,n){const r=Object.create(e.prototype);return r.point=i.copy(),r.direction=t.subtract(n,i).normalize(),r},e})),define("standard/Math/Algorithms/QuickSort",[],(function(){"use strict";function t(t,e){this.array=t,e&&(this.compare=e)}return t.prototype={compare:function(t,e){return t<e},sort:function(t,e){e-t>1&&this.quicksort(t,e-1)},quicksort:function(t,e){let i=t,n=e;const r=this.array,s=this.compare,o=r[t+e>>>1];for(;;){for(;s(r[i],o);)++i;for(;s(o,r[n]);)--n;if(!(i<n)){i===n&&(++i,--n);break}{const t=r[i];r[i]=r[n],r[n]=t,i++,n--}}t<n&&this.quicksort(t,n),i<e&&this.quicksort(i,e)}},t})),define("x_ite/Components/Shape/Shape",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Shape/X3DShapeNode","x_ite/Rendering/TraverseType","x_ite/Base/X3DConstants","standard/Math/Algorithm","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Line3","standard/Math/Algorithms/QuickSort"],(function(t,e,i,n,r,s,o,a,u,l,c){"use strict";function h(t){n.call(this,t),this.addType(s.Shape)}return h.prototype=Object.assign(Object.create(n.prototype),{constructor:h,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.inputOutput,"visible",new t.SFBool(!0)),new e(s.inputOutput,"castShadow",new t.SFBool(!0)),new e(s.inputOutput,"bboxDisplay",new t.SFBool),new e(s.initializeOnly,"bboxSize",new t.SFVec3f(-1,-1,-1)),new e(s.initializeOnly,"bboxCenter",new t.SFVec3f),new e(s.inputOutput,"appearance",new t.SFNode),new e(s.inputOutput,"geometry",new t.SFNode)]),getTypeName:function(){return"Shape"},getComponentName:function(){return"Shape"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this._transformSensors_changed.addInterest("set_transformSensors__",this),this.set_transformSensors__()},set_geometry__:function(){n.prototype.set_geometry__.call(this),this.getGeometry()?delete this.traverse:this.traverse=Function.prototype},set_transformSensors__:function(){this.setPickableObject(this.getTransformSensors().size)},intersectsBox:function(t,e,i){return this.getGeometry().intersectsBox(t,e,i)},traverse:function(t,e){switch(t){case r.POINTER:this.pointer(e);break;case r.PICKING:this.picking(e);break;case r.COLLISION:e.addCollisionShape(this);break;case r.SHADOW:this._castShadow.getValue()&&e.addDepthShape(this);break;case r.DISPLAY:e.addDisplayShape(this)&&this.getAppearance().traverse(t,e)}this.getGeometry().traverse(t,e)},pointer:function(){const t=new u,e=new u,i=new l(new a(0,0,0),new a(0,0,0)),n=[],r=new c(n,(function(t,e){return t.point.z>e.point.z})),s=function(t,e){return t.point.z>e};return function(a){const u=this.getBrowser();if(u.getPickOnlySensors()&&1===u.getSensors().length)return;const l=this.getGeometry();if(t.assign(a.getModelViewMatrix().get()),e.assign(t).inverse(),i.assign(u.getHitRay()).multLineMatrix(e),l.intersectsLine(i,a,e,this.getAppearance(),n)){for(const e of n)t.multVecMatrix(e.point);r.sort(0,n.length);const i=o.lowerBound(n,0,n.length,-a.getNavigationInfo().getNearValue(),s);i!==n.length&&(e.multMatrixDir(n[i].normal).normalize(),u.addHit(n[i],a.getLayer(),this,t.multRight(a.getCameraSpaceMatrix().get()))),n.length=0}}}(),picking:function(t){const e=t.getModelViewMatrix().get();if(this.getTransformSensors().size)for(const t of this.getTransformSensors())t.collect(e);const i=this.getBrowser(),n=i.getPickSensors(),r=i.getPickingHierarchy();r.push(this);for(const t of n.at(-1))t.collect(this.getGeometry(),e,r);r.pop()},depth:function(t,e,i){this.getGeometry().depth(t,e,i)},display:function(t,e){this.getGeometry().display(t,e)}}),h})),define("standard/Math/Geometry/Line2",["standard/Math/Numbers/Vector2"],(function(t){"use strict";function e(t,e){this.point=t.copy(),this.direction=e.copy()}return e.prototype={constructor:e,copy:function(){const t=Object.create(e.prototype);return t.point=this.point.copy(),t.direction=this.direction.copy(),t},assign:function(t){return this.point.assign(t.point),this.direction.assign(t.direction),this},set:function(t,e){return this.point.assign(t),this.direction.assign(e),this},setPoints:function(t,e){return this.point.assign(t),this.direction.assign(e).subtract(t).normalize(),this},multMatrixLine:function(t){return t.multMatrixVec(this.point),t.multMatrixDir(this.direction).normalize(),this},multLineMatrix:function(t){return t.multVecMatrix(this.point),t.multDirMatrix(this.direction).normalize(),this},getClosestPointToPoint:function(t,e){const i=e.assign(t).subtract(this.point).dot(this.direction);return e.assign(this.direction).multiply(i).add(this.point)},getPerpendicularVectorToPoint:function(){const e=new t(0,0);return function(t,i){return i.assign(this.point).subtract(t),i.subtract(e.assign(this.direction).multiply(i.dot(this.direction)))}}(),intersectsLine:function(){const e=new t(0,0);return function(t,i){const n=this.point,r=t.point,s=this.direction,o=t.direction,a=s.dot(o);if(Math.abs(a)>=1)return!1;e.assign(r).subtract(n);const u=(e.dot(s)-a*e.dot(o))/(1-a*a);return i.assign(s).multiply(u).add(n),!0}}(),toString:function(){return this.point+", "+this.direction}},e.Points=function(i,n){const r=Object.create(e.prototype);return r.point=i.copy(),r.direction=t.subtract(n,i).normalize(),r},e})),define("x_ite/Components/Rendering/X3DLineGeometryNode",["x_ite/Components/Rendering/X3DGeometryNode","x_ite/Rendering/VertexArray","standard/Math/Geometry/ViewVolume","standard/Math/Geometry/Box3","standard/Math/Geometry/Line2","standard/Math/Geometry/Line3","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Numbers/Matrix2","standard/Math/Numbers/Matrix4"],(function(t,e,i,n,r,s,o,a,u,l,c){"use strict";function h(i){this.getExecutionContext()||t.call(this,i);const n=this.getBrowser(),r=n.getContext();this.transformVertexArrayObject=new e,this.thickVertexArrayObject=new e,this.trianglesBuffer=r.createBuffer(),this.trianglesTexCoordBuffers=new Array(n.getMaxTextures()).fill(this.trianglesBuffer),this.setGeometryType(1),this.setPrimitiveMode(r.LINES),this.setSolid(!1)}return h.prototype=Object.assign(Object.create(t.prototype),{constructor:h,updateVertexArrays:function(){t.prototype.updateVertexArrays.call(this),this.transformVertexArrayObject.update(),this.thickVertexArrayObject.update()},intersectsLine:function(){const t=new n,e=new a(0,0,0),u=new a(0,0,0),h=new a(0,0,0),d=new a(0,0,0),p=new c,f=new a(0,0,0),g=new a(0,0,0),m=new o(0,0),_=new o(0,0),y=new r(o.Zero,o.yAxis),x=new o(0,0),w=new s(a.Zero,a.zAxis),b=new s(a.Zero,a.zAxis),v=new a(0,0,0),S=new l,T=new a(0,0,0);return function(n,r,s,o,a){const l=r.getModelViewMatrix().get(),c=r.getViewVolume().getViewport(),C=(t.assign(this.getBBox()).multRight(l).getExtents(e,u),o.getLineProperties()),O=Math.max(1.5,C&&C.getApplied()?C.getLinewidthScaleFactor()/2:1),N=r.getViewpoint().getScreenScale(e,c,h),F=s.multDirMatrix(N.multiply(O)),E=r.getViewpoint().getScreenScale(u,c,d),D=s.multDirMatrix(E.multiply(O));if(this.intersectsBBox(n,F.abs().max(D.abs()))){const t=this.getBrowser().getPointer(),e=r.getProjectionMatrix().get(),n=r.getLocalObjects(),s=this.getVertices(),o=s.length;p.assign(l).multRight(e);for(let r=0;r<o;r+=8)if(f.set(s[r+0],s[r+1],s[r+2]),g.set(s[r+4],s[r+5],s[r+6]),i.projectPointMatrix(f,p,c,m),i.projectPointMatrix(g,p,c,_),y.setPoints(m,_),y.getClosestPointToPoint(t,x)){const r=m.distance(_),s=m.distance(x),o=_.distance(x);if(s<=r&&o<=r&&x.distance(t)<=O){if(n.length&&this.isClipped(l.multVecMatrix(T.assign(x)),n))continue;const o=y.direction,u=S.set(o.x,o.y,-o.y,o.x).inverse().multVecMatrix(t.copy().subtract(x)),h=u.set(s/r,(u.y/O+1)/2),d=g.copy().subtract(f).normalize();i.unProjectRay(x.x,x.y,l,e,c,w),b.setPoints(f,g).getClosestPointToLine(w,v),a.push({texCoord:h,normal:d,point:v.copy()})}}}return a.length}}(),intersectsLineWithGeometry:function(){return!1},intersectsBox:function(t,e,i){return!1},buildTexCoords:function(){const t=this.getTexCoords();if(t.getValue().length!==this.getVertices().length){const e=this.getBrowser().getContext(),i=this.getVertices().length/8;t.length=this.getVertices().length,t.fill(0),t.shrinkToFit(),e.bindBuffer(e.ARRAY_BUFFER,this.trianglesBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(78*i),e.DYNAMIC_DRAW)}this.getMultiTexCoords().push(t)},updateLengthSoFar:function(){const t=new c,e=new u(0,0,0),n=new u(0,0,0),r=new o(0,0),s=new o(0,0);return function(o,a){const u=a.renderer.getViewVolume().getViewport(),l=a.renderer.getProjectionMatrix().get(),c=this.getTexCoords().getValue(),h=this.getVertices(),d=h.length;t.assign(a.modelViewMatrix).multRight(l);let p=0;for(let o=0;o<d;o+=8)e.set(h[o],h[o+1],h[o+2],h[o+3]),n.set(h[o+4],h[o+5],h[o+6],h[o+7]),i.projectPointMatrix(e,t,u,r),i.projectPointMatrix(n,t,u,s),c[o]=s.x,c[o+1]=s.y,c[o+4]=r.x,c[o+5]=r.y,c[o+6]=p,p+=s.subtract(r).magnitude();o.bindBuffer(o.ARRAY_BUFFER,this.texCoordBuffers[0]),o.bufferData(o.ARRAY_BUFFER,c,o.DYNAMIC_DRAW)}}(),display:function(){const t=new c,e=new Float32Array(16),i=new Float32Array(16);return function(n,r){const s=this.getBrowser(),o=r.appearanceNode,a=o.getLineProperties(),u=o.getShader(this,r),l=o.getBlendMode(),c=this.getAttrib(),h=this.getAttribBuffers();if(a&&(a.getApplied()&&1!==a.getLinetype()&&this.updateLengthSoFar(n,r),a.getMustTransformLines())){const o=s.getLineTransformShader();if(o.isValid()){const c=r.renderer,h=c.getViewVolume().getViewport(),d=c.getProjectionMatrix().get(),p=s.getPrimitiveMode(n.TRIANGLES);if(e.set(t.assign(r.modelViewMatrix).multRight(d)),i.set(t.inverse()),o.enable(n),n.uniform4f(o.viewport,h.x,h.y,h.z,h.w),n.uniformMatrix4fv(o.modelViewProjectionMatrix,!1,e),n.uniformMatrix4fv(o.invModelViewProjectionMatrix,!1,i),n.uniform1f(o.scale,a.getLinewidthScaleFactor()/2),this.transformVertexArrayObject.enable(n,u)){const t=2*Float32Array.BYTES_PER_ELEMENT,e=0,i=1*Float32Array.BYTES_PER_ELEMENT,r=8*Float32Array.BYTES_PER_ELEMENT,s=0,a=4*Float32Array.BYTES_PER_ELEMENT,u=8*Float32Array.BYTES_PER_ELEMENT,l=0,c=4*Float32Array.BYTES_PER_ELEMENT,h=8*Float32Array.BYTES_PER_ELEMENT,d=0,p=4*Float32Array.BYTES_PER_ELEMENT;this.hasFogCoords&&(o.enableFloatAttrib(n,"x3d_FogDepth0",this.fogDepthBuffer,1,t,e),o.enableFloatAttrib(n,"x3d_FogDepth1",this.fogDepthBuffer,1,t,i)),this.colorMaterial&&(o.enableFloatAttrib(n,"x3d_Color0",this.colorBuffer,4,r,s),o.enableFloatAttrib(n,"x3d_Color1",this.colorBuffer,4,r,a)),o.enableFloatAttrib(n,"x3d_TexCoord0",this.texCoordBuffers[0],4,u,l),o.enableFloatAttrib(n,"x3d_TexCoord1",this.texCoordBuffers[0],4,u,c),o.enableFloatAttrib(n,"x3d_Vertex0",this.vertexBuffer,4,h,d),o.enableFloatAttrib(n,"x3d_Vertex1",this.vertexBuffer,4,h,p)}if(n.bindTransformFeedback(n.TRANSFORM_FEEDBACK,s.getLineTransformFeedback()),n.bindBufferBase(n.TRANSFORM_FEEDBACK_BUFFER,0,this.trianglesBuffer),n.enable(n.RASTERIZER_DISCARD),n.beginTransformFeedback(n.POINTS),n.drawArraysInstanced(n.POINTS,0,this.vertexCount/2,2),n.endTransformFeedback(),n.disable(n.RASTERIZER_DISCARD),n.bindTransformFeedback(n.TRANSFORM_FEEDBACK,null),l&&l.enable(n),u.enable(n),u.setUniforms(n,r),this.thickVertexArrayObject.enable(n,u)){const t=13*Float32Array.BYTES_PER_ELEMENT,e=0,i=1*Float32Array.BYTES_PER_ELEMENT,r=5*Float32Array.BYTES_PER_ELEMENT,s=9*Float32Array.BYTES_PER_ELEMENT;this.hasFogCoords&&u.enableFogDepthAttribute(n,this.trianglesBuffer,t,e),this.colorMaterial&&u.enableColorAttribute(n,this.trianglesBuffer,t,i),u.enableTexCoordAttribute(n,this.trianglesTexCoordBuffers,t,r),u.enableVertexAttribute(n,this.trianglesBuffer,t,s),n.bindBuffer(n.ARRAY_BUFFER,null)}if(s.getWireframe())for(let t=0,e=3*this.vertexCount;t<e;t+=3)n.drawArrays(p,t,3);else n.frontFace(n.CCW),n.enable(n.CULL_FACE),n.drawArrays(p,0,3*this.vertexCount);l&&l.disable(n)}return}const d=s.getPrimitiveMode(this.getPrimitiveMode());if(l&&l.enable(n),u.enable(n),u.setUniforms(n,r),this.vertexArrayObject.enable(n,u)){for(let t=0,e=c.length;t<e;++t)c[t].enable(n,u,h[t]);this.hasFogCoords&&u.enableFogDepthAttribute(n,this.fogDepthBuffer,0,0),this.colorMaterial&&u.enableColorAttribute(n,this.colorBuffer,0,0),u.enableTexCoordAttribute(n,this.texCoordBuffers,0,0),u.enableVertexAttribute(n,this.vertexBuffer,0,0)}n.drawArrays(d,0,this.vertexCount),l&&l.disable(n)}}(),displayParticles:function(t,e,i){const n=this.getBrowser(),r=e.appearanceNode,s=r.getShader(this,e),o=r.getBlendMode(),a=this.getAttrib(),u=this.getAttribBuffers(),l=n.getPrimitiveMode(this.getPrimitiveMode());o&&o.enable(t),s.enable(t),s.setUniforms(t,e);const c=i.outputParticles;if(c.vertexArrayObject.update(this.updateParticles).enable(t,s)){const e=i.particleStride;s.enableParticleAttribute(t,c,e,i.particleOffset,1),s.enableParticleMatrixAttribute(t,c,e,i.matrixOffset,1);for(let e=0,i=a.length;e<i;++e)a[e].enable(t,s,u[e]);this.hasFogCoords&&s.enableFogDepthAttribute(t,this.fogDepthBuffer,0,0),this.colorMaterial&&s.enableColorAttribute(t,this.colorBuffer,0,0),s.enableTexCoordAttribute(t,this.texCoordBuffers,0,0),s.enableVertexAttribute(t,this.vertexBuffer,0,0),this.updateParticles=!1}t.drawArraysInstanced(l,0,this.vertexCount,i.numParticles),o&&o.disable(t)}}),h})),define("x_ite/Components/Rendering/IndexedLineSet",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Rendering/X3DLineGeometryNode","x_ite/Base/X3DCast","x_ite/Base/X3DConstants"],(function(t,e,i,n,r,s){"use strict";function o(t){n.call(this,t),this.addType(s.IndexedLineSet),this.fogCoordNode=null,this.colorNode=null,this.normalNode=null,this.coordNode=null}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.inputOnly,"set_colorIndex",new t.MFInt32),new e(s.inputOnly,"set_coordIndex",new t.MFInt32),new e(s.initializeOnly,"colorPerVertex",new t.SFBool(!0)),new e(s.initializeOnly,"colorIndex",new t.MFInt32),new e(s.initializeOnly,"coordIndex",new t.MFInt32),new e(s.inputOutput,"attrib",new t.MFNode),new e(s.inputOutput,"fogCoord",new t.SFNode),new e(s.inputOutput,"color",new t.SFNode),new e(s.inputOutput,"normal",new t.SFNode),new e(s.inputOutput,"coord",new t.SFNode)]),getTypeName:function(){return"IndexedLineSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},initialize:function(){n.prototype.initialize.call(this),this._set_colorIndex.addFieldInterest(this._colorIndex),this._set_coordIndex.addFieldInterest(this._coordIndex),this._attrib.addInterest("set_attrib__",this),this._fogCoord.addInterest("set_fogCoord__",this),this._color.addInterest("set_color__",this),this._normal.addInterest("set_normal__",this),this._coord.addInterest("set_coord__",this),this.set_attrib__(),this.set_fogCoord__(),this.set_color__(),this.set_normal__(),this.set_coord__()},set_attrib__:function(){const t=this.getAttrib();for(const e of t)e.removeInterest("requestRebuild",this),e._attribute_changed.removeInterest("updateVertexArrays",this);t.length=0;for(const e of this._attrib){const i=r(s.X3DVertexAttributeNode,e);i&&t.push(i)}for(const e of t)e.addInterest("requestRebuild",this),e._attribute_changed.addInterest("updateVertexArrays",this);this.updateVertexArrays()},set_fogCoord__:function(){this.fogCoordNode&&this.fogCoordNode.removeInterest("requestRebuild",this),this.fogCoordNode=r(s.FogCoordinate,this._fogCoord),this.fogCoordNode&&this.fogCoordNode.addInterest("requestRebuild",this)},set_color__:function(){this.colorNode&&(this.colorNode.removeInterest("requestRebuild",this),this.colorNode._transparent.removeInterest("set_transparent__",this)),this.colorNode=r(s.X3DColorNode,this._color),this.colorNode?(this.colorNode.addInterest("requestRebuild",this),this.colorNode._transparent.addInterest("set_transparent__",this),this.set_transparent__()):this.setTransparent(!1)},set_transparent__:function(){this.setTransparent(this.colorNode.getTransparent())},set_normal__:function(){this.normalNode&&this.normalNode.removeInterest("requestRebuild",this),this.normalNode=r(s.X3DNormalNode,this._normal),this.normalNode&&this.normalNode.addInterest("requestRebuild",this)},set_coord__:function(){this.coordNode&&this.coordNode.removeInterest("requestRebuild",this),this.coordNode=r(s.X3DCoordinateNode,this._coord),this.coordNode&&this.coordNode.addInterest("requestRebuild",this)},getColorPerVertexIndex:function(t){return t<this._colorIndex.length?this._colorIndex[t]:this._coordIndex[t]},getColorIndex:function(t){return t<this._colorIndex.length?this._colorIndex[t]:t},getPolylineIndices:function(){const t=this._coordIndex,e=[];let i=[];if(t.length){for(let n=0,r=t.length;n<r;++n){t[n]>=0?i.push(n):(e.push(i),i=[])}t[t.length-1]>=0&&e.push(i)}return e},build:function(){if(!this.coordNode||this.coordNode.isEmpty())return;const t=this._coordIndex,e=this.getPolylineIndices(),i=this._colorPerVertex.getValue(),n=this.getAttrib(),r=n.length,s=this.getAttribs(),o=this.fogCoordNode,a=this.colorNode,u=this.coordNode,l=this.getFogDepths(),c=this.getColors(),h=this.getVertices();let d=0;for(const p of e){if(p.length>1)for(let e=0,f=p.length-1;e<f;++e)for(let f=e,g=e+2;f<g;++f){const e=p[f],g=t[e];for(let t=0;t<r;++t)n[t].addValue(g,s[t]);o&&o.addDepth(g,l),a&&(i?a.addColor(this.getColorPerVertexIndex(e),c):a.addColor(this.getColorIndex(d),c)),u.addPoint(g,h)}++d}}}),o})),define("x_ite/Components/Rendering/X3DGeometricPropertyNode",["x_ite/Components/Core/X3DNode","x_ite/Base/X3DConstants"],(function(t,e){"use strict";function i(i){t.call(this,i),this.addType(e.X3DGeometricPropertyNode)}return i.prototype=Object.assign(Object.create(t.prototype),{constructor:i}),i})),define("x_ite/Components/Rendering/X3DColorNode",["x_ite/Fields","x_ite/Components/Rendering/X3DGeometricPropertyNode","x_ite/Base/X3DConstants"],(function(t,e,i){"use strict";function n(n){e.call(this,n),this.addType(i.X3DColorNode),this.addChildObjects("transparent",new t.SFBool),this._transparent.setAccessType(i.outputOnly)}return n.prototype=Object.assign(Object.create(e.prototype),{constructor:n,setTransparent:function(t){t!==this._transparent.getValue()&&(this._transparent=t)},getTransparent:function(){return this._transparent.getValue()}}),n})),define("x_ite/Components/Rendering/Color",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Rendering/X3DColorNode","x_ite/Base/X3DConstants"],(function(t,e,i,n,r){"use strict";function s(t){n.call(this,t),this.addType(r.Color)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"color",new t.MFColor)]),getTypeName:function(){return"Color"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"color"},initialize:function(){n.prototype.initialize.call(this),this._color.addInterest("set_color__",this),this.set_color__()},set_color__:function(){this.color=this._color.getValue(),this.length=this._color.length},addColor:function(t,e){if(t>=0&&t<this.length){const i=this.color;t*=3,e.push(i[t],i[t+1],i[t+2],1)}else if(this.length){const i=this.color;t=3*(this.length-1),e.push(i[t],i[t+1],i[t+2],1)}else e.push(1,1,1,1)},addColors:function(t,e){if(this.length){const r=this.color;for(var i=0,n=3*Math.min(e,this.length);i<n;i+=3)t.push(r[i],r[i+1],r[i+2],1);if(this.length<e){const s=r[i=3*(this.length-1)],o=r[i+1],a=r[i+2];for(i=n,n=3*e;i<n;i+=3)t.push(s,o,a,1)}}else for(let i=0;i<e;++i)t.push(1,1,1,1);return t}}),s})),define("x_ite/Components/Rendering/X3DCoordinateNode",["x_ite/Components/Rendering/X3DGeometricPropertyNode","x_ite/Base/X3DConstants","standard/Math/Geometry/Triangle3","standard/Math/Numbers/Vector3"],(function(t,e,i,n){"use strict";function r(i){t.call(this,i),this.addType(e.X3DCoordinateNode)}return r.prototype=Object.assign(Object.create(t.prototype),{constructor:r,initialize:function(){t.prototype.initialize.call(this),this._point.addInterest("set_point__",this),this.set_point__()},set_point__:function(){this.point=this._point.getValue(),this.length=this._point.length},isEmpty:function(){return 0===this.length},getSize:function(){return this.length},set1Point:function(t,e){this._point[t]=e},get1Point:function(t,e){if(t<this.length){const i=this.point;return t*=3,e.set(i[t],i[t+1],i[t+2])}return e.set(0,0,0)},addPoint:function(t,e){if(t<this.length){const i=this.point;t*=3,e.push(i[t],i[t+1],i[t+2],1)}else e.push(0,0,0,1)},addPoints:function(t,e){const i=this.point;for(var n=0,r=3*this.length;n<r;n+=3)t.push(i[n],i[n+1],i[n+2],1);for(n=r,r=3*e;n<r;n+=3)t.push(0,0,0,1)},getNormal:function(){const t=new n(0,0,0),e=new n(0,0,0),r=new n(0,0,0);return function(s,o,a){const u=this.length;return s<u&&o<u&&a<u?i.normal(this.get1Point(s,t),this.get1Point(o,e),this.get1Point(a,r),new n(0,0,0)):new n(0,0,0)}}(),getQuadNormal:function(){const t=new n(0,0,0),e=new n(0,0,0),r=new n(0,0,0),s=new n(0,0,0);return function(o,a,u,l){const c=this.length;return o<c&&a<c&&u<c&&l<c?i.quadNormal(this.get1Point(o,t),this.get1Point(a,e),this.get1Point(u,r),this.get1Point(l,s),new n(0,0,0)):new n(0,0,0)}}()}),r})),define("x_ite/Components/Rendering/Coordinate",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Rendering/X3DCoordinateNode","x_ite/Base/X3DConstants"],(function(t,e,i,n,r){"use strict";function s(t){n.call(this,t),this.addType(r.Coordinate),this._point.setUnit("length")}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"point",new t.MFVec3f)]),getTypeName:function(){return"Coordinate"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"coord"}}),s})),define("x_ite/Browser/Grouping/X3DGroupingContext",["x_ite/Fields","x_ite/Components/Shape/Shape","x_ite/Components/Rendering/IndexedLineSet","x_ite/Components/Rendering/Color","x_ite/Components/Rendering/Coordinate"],(function(t,e,i,n,r){"use strict";const s=Symbol();function o(){}return o.prototype={initialize:function(){},getBBoxNode:function(){const o=new e(this.getPrivateScene()),a=new i(this.getPrivateScene()),u=new n(this.getPrivateScene()),l=new r(this.getPrivateScene());return o._geometry=a,a._coordIndex=new t.MFFloat(0,1,2,3,0,-1,4,5,6,7,4,-1,0,4,-1,1,5,-1,2,6,-1,3,7,-1),a._color=u,a._coord=l,u._color=new t.MFColor(new t.SFColor(1,1,1)),l._point=new t.MFVec3f(new t.SFVec3f(.5,.5,.5),new t.SFVec3f(-.5,.5,.5),new t.SFVec3f(-.5,-.5,.5),new t.SFVec3f(.5,-.5,.5),new t.SFVec3f(.5,.5,-.5),new t.SFVec3f(-.5,.5,-.5),new t.SFVec3f(-.5,-.5,-.5),new t.SFVec3f(.5,-.5,-.5)),l.setup(),u.setup(),a.setup(),o.setup(),this[s]=o,this.getBBoxNode=function(){return this[s]},Object.defineProperty(this,"getBBoxNode",{enumerable:!1}),o}},o})),define("x_ite/Components/Rendering/X3DComposedGeometryNode",["x_ite/Components/Rendering/X3DGeometryNode","x_ite/Base/X3DCast","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3"],(function(t,e,i,n){"use strict";function r(e){t.call(this,e),this.addType(i.X3DComposedGeometryNode),this.fogCoordNode=null,this.colorNode=null,this.texCoordNode=null,this.normalNode=null,this.coordNode=null}return r.prototype=Object.assign(Object.create(t.prototype),{constructor:r,initialize:function(){t.prototype.initialize.call(this),this._attrib.addInterest("set_attrib__",this),this._fogCoord.addInterest("set_fogCoord__",this),this._color.addInterest("set_color__",this),this._texCoord.addInterest("set_texCoord__",this),this._normal.addInterest("set_normal__",this),this._coord.addInterest("set_coord__",this),this.set_attrib__(),this.set_fogCoord__(),this.set_color__(),this.set_texCoord__(),this.set_normal__(),this.set_coord__()},getFogCoord:function(){return this.fogCoordNode},getColor:function(){return this.colorNode},getTexCoord:function(){return this.texCoordNode},getNormal:function(){return this.normalNode},getCoord:function(){return this.coordNode},set_attrib__:function(){const t=this.getAttrib();for(const e of t)e.removeInterest("requestRebuild",this),e._attribute_changed.removeInterest("updateVertexArrays",this);t.length=0;for(const n of this._attrib){const r=e(i.X3DVertexAttributeNode,n);r&&t.push(r)}for(const e of t)e.addInterest("requestRebuild",this),e._attribute_changed.addInterest("updateVertexArrays",this);this.updateVertexArrays()},set_fogCoord__:function(){this.fogCoordNode&&this.fogCoordNode.removeInterest("requestRebuild",this),this.fogCoordNode=e(i.FogCoordinate,this._fogCoord),this.fogCoordNode&&this.fogCoordNode.addInterest("requestRebuild",this)},set_color__:function(){this.colorNode&&(this.colorNode.removeInterest("requestRebuild",this),this.colorNode._transparent.removeInterest("set_transparent__",this)),this.colorNode=e(i.X3DColorNode,this._color),this.colorNode?(this.colorNode.addInterest("requestRebuild",this),this.colorNode._transparent.addInterest("set_transparent__",this),this.set_transparent__()):this.setTransparent(!1)},set_transparent__:function(){this.setTransparent(this.colorNode.getTransparent())},set_texCoord__:function(){this.texCoordNode&&this.texCoordNode.removeInterest("requestRebuild",this),this.texCoordNode=e(i.X3DTextureCoordinateNode,this._texCoord),this.texCoordNode&&this.texCoordNode.addInterest("requestRebuild",this),this.setTextureCoordinate(this.texCoordNode)},set_normal__:function(){this.normalNode&&this.normalNode.removeInterest("requestRebuild",this),this.normalNode=e(i.X3DNormalNode,this._normal),this.normalNode&&this.normalNode.addInterest("requestRebuild",this)},set_coord__:function(){this.coordNode&&this.coordNode.removeInterest("requestRebuild",this),this.coordNode=e(i.X3DCoordinateNode,this._coord),this.coordNode&&this.coordNode.addInterest("requestRebuild",this)},getPolygonIndex:function(t){return t},getTriangleIndex:function(t){return t},build:function(t,e,i,n){if(!this.coordNode||this.coordNode.isEmpty())return;e-=e%t,n-=n%i;const r=this._colorPerVertex.getValue(),s=this._normalPerVertex.getValue(),o=this.getAttrib(),a=o.length,u=this.getAttribs(),l=this.getFogCoord(),c=this.getColor(),h=this.getTexCoord(),d=this.getNormal(),p=this.getCoord(),f=this.getFogDepths(),g=this.getColors(),m=this.getMultiTexCoords(),_=this.getNormals(),y=this.getVertices();h&&h.init(m);for(let t=0;t<n;++t){const e=Math.floor(t/i),n=this.getPolygonIndex(this.getTriangleIndex(t));for(let t=0;t<a;++t)o[t].addValue(n,u[t]);l&&l.addDepth(n,f),c&&(r?c.addColor(n,g):c.addColor(e,g)),h&&h.addTexCoord(n,m),d&&(s?d.addVector(n,_):d.addVector(e,_)),p.addPoint(n,y)}this.getNormal()||this.buildNormals(t,e,n),this.setSolid(this._solid.getValue()),this.setCCW(this._ccw.getValue())},buildNormals:function(t,e,i){const n=this.createNormals(t,e),r=this.getNormals();for(let t=0;t<i;++t){const e=n[this.getTriangleIndex(t)];r.push(e.x,e.y,e.z)}},createNormals:function(t,e){const i=this.createFaceNormals(t,e);if(this._normalPerVertex.getValue()){const t=[];for(let i=0;i<e;++i){const e=this.getPolygonIndex(i);let n=t[e];n||(n=t[e]=[]),n.push(i)}return this.refineNormals(t,i,Math.PI)}return i},createFaceNormals:function(t,e){const i=!this._ccw.getValue(),n=this.coordNode,r=[];for(let s=0;s<e;s+=t){const e=this.getPolygonNormal(s,t,n);i&&e.negate();for(let i=0;i<t;++i)r.push(e)}return r},getPolygonNormal:function(){let t=new n(0,0,0),e=new n(0,0,0);return function(i,r,s){const o=new n(0,0,0);s.get1Point(this.getPolygonIndex(i),e);for(let n=0;n<r;++n){const a=t;t=e,e=a,s.get1Point(this.getPolygonIndex(i+(n+1)%r),e),o.x+=(t.y-e.y)*(t.z+e.z),o.y+=(t.z-e.z)*(t.x+e.x),o.z+=(t.x-e.x)*(t.y+e.y)}return o.normalize()}}()}),r})),define("x_ite/Components/Geometry3D/IndexedFaceSet",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Rendering/X3DComposedGeometryNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Triangle3"],(function(t,e,i,n,r,s,o,a){"use strict";function u(t){n.call(this,t),this.addType(r.IndexedFaceSet),this._creaseAngle.setUnit("angle")}return u.prototype=Object.assign(Object.create(n.prototype),{constructor:u,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOnly,"set_colorIndex",new t.MFInt32),new e(r.inputOnly,"set_texCoordIndex",new t.MFInt32),new e(r.inputOnly,"set_normalIndex",new t.MFInt32),new e(r.inputOnly,"set_coordIndex",new t.MFInt32),new e(r.initializeOnly,"solid",new t.SFBool(!0)),new e(r.initializeOnly,"ccw",new t.SFBool(!0)),new e(r.initializeOnly,"convex",new t.SFBool(!0)),new e(r.initializeOnly,"creaseAngle",new t.SFFloat),new e(r.initializeOnly,"colorPerVertex",new t.SFBool(!0)),new e(r.initializeOnly,"normalPerVertex",new t.SFBool(!0)),new e(r.initializeOnly,"colorIndex",new t.MFInt32),new e(r.initializeOnly,"texCoordIndex",new t.MFInt32),new e(r.initializeOnly,"normalIndex",new t.MFInt32),new e(r.initializeOnly,"coordIndex",new t.MFInt32),new e(r.inputOutput,"attrib",new t.MFNode),new e(r.inputOutput,"fogCoord",new t.SFNode),new e(r.inputOutput,"color",new t.SFNode),new e(r.inputOutput,"texCoord",new t.SFNode),new e(r.inputOutput,"normal",new t.SFNode),new e(r.inputOutput,"coord",new t.SFNode)]),getTypeName:function(){return"IndexedFaceSet"},getComponentName:function(){return"Geometry3D"},getContainerField:function(){return"geometry"},initialize:function(){n.prototype.initialize.call(this),this._set_colorIndex.addFieldInterest(this._colorIndex),this._set_texCoordIndex.addFieldInterest(this._texCoordIndex),this._set_normalIndex.addFieldInterest(this._normalIndex),this._set_coordIndex.addFieldInterest(this._coordIndex)},getTexCoordPerVertexIndex:function(t){return t<this._texCoordIndex.length?this._texCoordIndex[t]:this._coordIndex[t]},getColorPerVertexIndex:function(t){return t<this._colorIndex.length?this._colorIndex[t]:this._coordIndex[t]},getColorIndex:function(t){return t<this._colorIndex.length?this._colorIndex[t]:t},getNormalPerVertexIndex:function(t){return t<this._normalIndex.length?this._normalIndex[t]:this._coordIndex[t]},getNormalIndex:function(t){return t<this._normalIndex.length?this._normalIndex[t]:t},build:function(){const t=this.triangulate();if(0===t.length)return;const e=this._colorPerVertex.getValue(),i=this._normalPerVertex.getValue(),n=this._coordIndex.getValue(),r=this.getAttrib(),s=r.length,o=this.getAttribs(),a=this.getFogCoord(),u=this.getColor(),l=this.getTexCoord(),c=this.getNormal(),h=this.getCoord(),d=this.getFogDepths(),p=this.getColors(),f=this.getMultiTexCoords(),g=this.getNormals(),m=this.getVertices();l&&l.init(f);for(const _ of t){const t=_.triangles,y=_.face;for(const _ of t){const t=n[_];for(let e=0;e<s;++e)r[e].addValue(t,o[e]);a&&a.addDepth(t,d),u&&(e?u.addColor(this.getColorPerVertexIndex(_),p):u.addColor(this.getColorIndex(y),p)),l&&l.addTexCoord(this.getTexCoordPerVertexIndex(_),f),c&&(i?c.addVector(this.getNormalPerVertexIndex(_),g):c.addVector(this.getNormalIndex(y),g)),h.addPoint(t,m)}}this.getNormal()||this.buildNormals(t),this.setSolid(this._solid.getValue()),this.setCCW(this._ccw.getValue())},triangulate:function(){const t=this._convex.getValue(),e=this._coordIndex.length,i=[];if(!this.getCoord())return i;if(e&&this._coordIndex[e-1]>-1&&this._coordIndex.push(-1),e){const e=this._coordIndex.getValue(),n=this._coordIndex.length;let r=[];for(let s=0,o=0;s<n;++s){if(e[s]>-1)r.push(s);else{if(r.length)switch(r.length){case 0:case 1:case 2:r.length=0;break;case 3:i.push({vertices:r,triangles:r,face:o}),r=[];break;default:{const e=[],n={vertices:r,triangles:e,face:o};t?this.triangulateConvexPolygon(r,e):this.triangulatePolygon(r,e),e.length<3?r.length=0:(i.push(n),r=[]);break}}++o}}}return i},triangulatePolygon:function(){const t=[];return function(e,i){const n=this._coordIndex.getValue(),r=this.getCoord(),o=e.length;for(let i=0;i<o;++i){const o=e[i];let a=t[i];a||(a=t[i]=new s(0,0,0)),a.index=o,r.get1Point(n[o],a)}t.length=o,a.triangulatePolygon(t,i);for(let t=0,e=i.length;t<e;++t)i[t]=i[t].index}}(),triangulateConvexPolygon:function(t,e){for(let i=1,n=t.length-1;i<n;++i)e.push(t[0],t[i],t[i+1])},buildNormals:function(t){const e=this.createNormals(t),i=this.getNormals();for(const n of t)for(const t of n.triangles){const n=e[t];i.push(n.x,n.y,n.z)}},createNormals:function(){const t=[],e=[];return function(i){const n=!this._ccw.getValue(),r=this._coordIndex.getValue(),s=this.getCoord();t.length=0,e.length=0;for(const a of i){const i=a.vertices,u=i.length;switch(u){case 3:var o=s.getNormal(r[i[0]],r[i[1]],r[i[2]]);break;case 4:o=s.getQuadNormal(r[i[0]],r[i[1]],r[i[2]],r[i[3]]);break;default:o=this.getPolygonNormal(i,r,s)}for(let t=0;t<u;++t){const n=i[t],s=r[n];let o=e[s];o||(o=e[s]=[]),o.push(n)}n&&o.negate();for(let e=0;e<u;++e)t[i[e]]=o}return this.refineNormals(e,t,this._creaseAngle.getValue())}}(),getPolygonNormal:function(){let t=new s(0,0,0),e=new s(0,0,0);return function(i,n,r){const o=new s(0,0,0);r.get1Point(n[i[0]],e);for(let s=0,a=i.length;s<a;++s){const u=t;t=e,e=u,r.get1Point(n[i[(s+1)%a]],e),o.x+=(t.y-e.y)*(t.z+e.z),o.y+=(t.z-e.z)*(t.x+e.x),o.z+=(t.x-e.x)*(t.y+e.y)}return o.normalize()}}()}),u})),define("x_ite/Components/Texturing/X3DTextureCoordinateNode",["x_ite/Components/Rendering/X3DGeometricPropertyNode","x_ite/Base/X3DConstants"],(function(t,e){"use strict";function i(i){t.call(this,i),this.addType(e.X3DTextureCoordinateNode)}return i.prototype=Object.assign(Object.create(t.prototype),{constructor:i,setShaderUniformsToChannel:function(t,e,i){t.uniform1i(e.x3d_TextureCoordinateGeneratorMode[i],0)}}),i})),define("x_ite/Components/Texturing/X3DSingleTextureCoordinateNode",["x_ite/Components/Texturing/X3DTextureCoordinateNode","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Base/X3DConstants"],(function(t,e,i){"use strict";function n(n){t.call(this,n),this.addType(i.X3DSingleTextureCoordinateNode),this.texCoordArray=e.createArray()}return n.prototype=Object.assign(Object.create(t.prototype),{constructor:n,init:function(t){this.texCoordArray.length=0,t.push(this.texCoordArray)},addTexCoord:function(t,e){this.addTexCoordToChannel(t,e[0])},getTextureMapping:function(t,e=0){this._mapping.getValue()&&t.set(this._mapping.getValue(),e)},setShaderUniforms:function(t,e){for(let i=0,n=e.x3d_MaxTextures;i<n;++i)this.setShaderUniformsToChannel(t,e,i)}}),n})),define("x_ite/Components/Texturing/TextureCoordinate",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Texturing/X3DSingleTextureCoordinateNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector4"],(function(t,e,i,n,r,s){"use strict";function o(t){n.call(this,t),this.addType(r.TextureCoordinate)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"mapping",new t.SFString),new e(r.inputOutput,"point",new t.MFVec2f)]),getTypeName:function(){return"TextureCoordinate"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"texCoord"},initialize:function(){n.prototype.initialize.call(this),this._point.addInterest("set_point__",this),this.set_point__()},set_point__:function(){this.point=this._point.getValue(),this.length=this._point.length},isEmpty:function(){return 0===this.length},getSize:function(){return this.length},get1Point:function(t,e){if(t>=0&&t<this.length){const i=this.point;return t*=2,e.set(i[t],i[t+1],0,1)}if(t>=0&&this.length){const i=this.point;return t%=this.length,t*=2,e.set(i[t],i[t+1],0,1)}return e.set(0,0,0,1)},addTexCoordToChannel:function(t,e){if(t>=0&&t<this.length){const i=this.point;t*=2,e.push(i[t],i[t+1],0,1)}else if(t>=0&&this.length){const i=this.point;t%=this.length,t*=2,e.push(i[t],i[t+1],0,1)}else e.push(0,0,0,1)},getTexCoord:function(t){const e=this.point,i=this.length;for(let n=0,r=0;n<i;++n,r+=2)t.push(e[r],e[r+1],0,1);return t}}),o})),define("x_ite/Browser/Geometry3D/BoxOptions",["x_ite/Fields","x_ite/Base/X3DBaseNode","x_ite/Components/Geometry3D/IndexedFaceSet","x_ite/Components/Rendering/Coordinate","x_ite/Components/Texturing/TextureCoordinate"],(function(t,e,i,n,r){"use strict";function s(t){e.call(this,t)}return s.prototype=Object.assign(Object.create(e.prototype),{constructor:s,getTypeName:function(){return"BoxOptions"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"boxOptions"},initialize:function(){e.prototype.initialize.call(this)},getGeometry:function(){if(this.geometry)return this.geometry;this.geometry=new i(this.getExecutionContext()),this.geometry._texCoord=new r(this.getExecutionContext()),this.geometry._coord=new n(this.getExecutionContext());const e=this.geometry,s=this.geometry._texCoord.getValue(),o=this.geometry._coord.getValue();return e._texCoordIndex=new t.MFInt32(0,1,2,3,-1,0,1,2,3,-1,0,1,2,3,-1,0,1,2,3,-1,0,1,2,3,-1,0,1,2,3,-1),e._coordIndex=new t.MFInt32(0,1,2,3,-1,5,4,7,6,-1,1,5,6,2,-1,4,0,3,7,-1,4,5,1,0,-1,3,2,6,7,-1),s._point=new t.MFVec2f(new t.SFVec2f(1,1),new t.SFVec2f(0,1),new t.SFVec2f(0,0),new t.SFVec2f(1,0)),o._point=new t.MFVec3f(new t.SFVec3f(1,1,1),new t.SFVec3f(-1,1,1),new t.SFVec3f(-1,-1,1),new t.SFVec3f(1,-1,1),new t.SFVec3f(1,1,-1),new t.SFVec3f(-1,1,-1),new t.SFVec3f(-1,-1,-1),new t.SFVec3f(1,-1,-1)),s.setup(),o.setup(),e.setup(),this.geometry}}),s})),define("x_ite/Browser/Geometry3D/ConeOptions",["x_ite/Fields","x_ite/Base/X3DBaseNode"],(function(t,e){"use strict";function i(i){e.call(this,i),this.addChildObjects("xDimension",new t.SFInt32(20),"yDimension",new t.SFInt32(1))}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i,getTypeName:function(){return"ConeOptions"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"coneOptions"}}),i})),define("x_ite/Browser/Geometry3D/CylinderOptions",["x_ite/Fields","x_ite/Base/X3DBaseNode"],(function(t,e){"use strict";function i(i){e.call(this,i),this.addChildObjects("xDimension",new t.SFInt32(20),"yDimension",new t.SFInt32(1))}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i,getTypeName:function(){return"CylinderOptions"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"cylinderOptions"}}),i})),define("x_ite/Browser/Geometry3D/QuadSphereOptions",["x_ite/Fields","x_ite/Base/X3DBaseNode","x_ite/Components/Geometry3D/IndexedFaceSet","x_ite/Components/Rendering/Coordinate","x_ite/Components/Texturing/TextureCoordinate","standard/Math/Numbers/Complex","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3"],(function(t,e,i,n,r,s,o,a){"use strict";function u(i){e.call(this,i),this.addChildObjects("xDimension",new t.SFInt32(32),"yDimension",new t.SFInt32(15))}return u.prototype=Object.assign(Object.create(e.prototype),{constructor:u,getTypeName:function(){return"QuadSphereOptions"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"quadSphereOptions"},initialize:function(){e.prototype.initialize.call(this),this.addInterest("eventsProcessed",this)},getGeometry:function(){return this.geometry||this.eventsProcessed(),this.geometry},createTexCoordIndex:function(){const t=this._xDimension.getValue()+1,e=this._yDimension.getValue(),i=this.geometry._texCoordIndex;for(let e=0,n=t-1;e<n;++e)i.push(e),i.push(e+t-1),i.push(e+t),i.push(-1);for(let n=t-1,r=0,s=e-3;r<s;++r,++n)for(let e=0,r=t-1;e<r;++e,++n)i.push(n),i.push(n+t),i.push(n+t+1),i.push(n+1),i.push(-1);let n=(e-2)*t-1;for(let e=0,r=t-1;e<r;++e,++n)i.push(n+t),i.push(n+1),i.push(n),i.push(-1)},createTexCoord:function(){const t=this._xDimension.getValue()+1,e=this._yDimension.getValue(),i=this.geometry._texCoord.getValue()._point,n=-.5/(t-1);for(let e=1;e<t;++e){const r=e/(t-1)+n;i.push(new o(r,1))}for(let n=1,r=e-1;n<r;++n){const r=1-n/(e-1);for(let e=0;e<t;++e){const n=e/(t-1);i.push(new o(n,r))}}for(let e=1;e<t;++e){const r=e/(t-1)+n;i.push(new o(r,0))}},createCoordIndex:function(){const t=this._xDimension.getValue()+1,e=this._yDimension.getValue(),i=this.geometry._coordIndex;let n=1;for(const e=t-1;n<e;++n)i.push(0),i.push(n),i.push(n+1),i.push(-1);i.push(0),i.push(n),i.push(1),i.push(-1);let r=1;for(let n=0,s=e-3;n<s;++n,++r){for(let e=0,n=t-2;e<n;++e,++r)i.push(r),i.push(r+t-1),i.push(r+t),i.push(r+1),i.push(-1);i.push(r),i.push(r+t-1),i.push(r+1),i.push(r-t+2),i.push(-1)}const s=r+t-1;for(let e=0,n=t-2;e<n;++e,++r)i.push(s),i.push(r+1),i.push(r),i.push(-1);i.push(s),i.push(s-t+1),i.push(r),i.push(-1)},createPoints:function(){const t=this._xDimension.getValue()+1,e=this._yDimension.getValue(),i=this.geometry._coord.getValue()._point;i.push(new a(0,1,0));for(let n=1,r=e-1;n<r;++n){const e=s.Polar(1,-Math.PI*n/r);for(let n=0,r=t-1;n<r;++n){const t=s.Polar(e.imag,2*Math.PI*n/r);i.push(new a(t.imag,e.real,t.real))}}i.push(new a(0,-1,0))},eventsProcessed:function(){this.geometry=new i(this.getExecutionContext()),this.geometry._texCoord=new r(this.getExecutionContext()),this.geometry._coord=new n(this.getExecutionContext()),this.createTexCoordIndex(),this.createTexCoord(),this.createCoordIndex(),this.createPoints();const t=this.geometry,e=this.geometry._texCoord.getValue(),s=this.geometry._coord.getValue();t._creaseAngle=Math.PI,e.setup(),s.setup(),t.setup()}}),u})),define("x_ite/Browser/Geometry3D/X3DGeometry3DContext",["x_ite/Browser/Geometry3D/BoxOptions","x_ite/Browser/Geometry3D/ConeOptions","x_ite/Browser/Geometry3D/CylinderOptions","x_ite/Browser/Geometry3D/QuadSphereOptions","x_ite/Browser/Core/PrimitiveQuality"],(function(t,e,i,n,r){"use strict";function s(){}function o(t,e){const i=new e(this.getPrivateScene());return i.setup(),this[t]=function(){return i},Object.defineProperty(this,t,{enumerable:!1}),i}return s.prototype={initialize:function(){this.setPrimitiveQuality3D(this.getBrowserOptions().getPrimitiveQuality())},getBoxOptions:function(){return o.call(this,"getBoxOptions",t)},getConeOptions:function(){return o.call(this,"getConeOptions",e)},getCylinderOptions:function(){return o.call(this,"getCylinderOptions",i)},getSphereOptions:function(){return o.call(this,"getSphereOptions",n)},setPrimitiveQuality3D:function(t){const e=this.getConeOptions(),i=this.getCylinderOptions(),n=this.getSphereOptions();switch(t){case r.LOW:e._xDimension=16,i._xDimension=16,n._xDimension=20,n._yDimension=9;break;case r.MEDIUM:e._xDimension=20,i._xDimension=20,n._xDimension=32,n._yDimension=15;break;case r.HIGH:e._xDimension=32,i._xDimension=32,n._xDimension=64,n._yDimension=31}}},s})),define("x_ite/Browser/PointingDeviceSensor/PointingDevice",["jquery","x_ite/Base/X3DBaseNode"],(function(t,e){"use strict";function i(t){e.call(this,t),this.cursor="DEFAULT",this.isOver=!1,this.motionTime=0}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i,getTypeName:function(){return"PointingDevice"},initialize:function(){const t=this.getBrowser().getSurface();t.bind("mousedown.PointingDevice"+this.getId(),this.mousedown.bind(this)),t.bind("mouseup.PointingDevice"+this.getId(),this.mouseup.bind(this)),t.bind("dblclick.PointingDevice"+this.getId(),this.dblclick.bind(this)),t.bind("mousemove.PointingDevice"+this.getId(),this.mousemove.bind(this)),t.bind("mouseout.PointingDevice"+this.getId(),this.onmouseout.bind(this)),t.bind("touchstart.PointingDevice"+this.getId(),this.touchstart.bind(this)),t.bind("touchend.PointingDevice"+this.getId(),this.touchend.bind(this))},mousewheel:function(t){},mousedown:function(e){const i=this.getBrowser();if(i.getElement().focus(),!(i.getShiftKey()&&i.getControlKey()||0!==e.button)){const n=i.getSurface(),r=n.offset(),s=e.pageX-r.left-parseFloat(n.css("borderLeftWidth")),o=n.innerHeight()-(e.pageY-r.top-parseFloat(n.css("borderTopWidth")));n.unbind("mousemove.PointingDevice"+this.getId()),t(document).bind("mouseup.PointingDevice"+this.getId(),this.mouseup.bind(this)),t(document).bind("mousemove.PointingDevice"+this.getId(),this.mousemove.bind(this)),t(document).bind("touchend.PointingDevice"+this.getId(),this.touchend.bind(this)),t(document).bind("touchmove.PointingDevice"+this.getId(),this.touchmove.bind(this)),i.buttonPressEvent(s,o)&&(e.preventDefault(),e.stopImmediatePropagation(),i.setCursor("HAND"),i.finished().addInterest("onverifymotion",this,s,o))}},mouseup:function(e){if(e.preventDefault(),0===e.button){const i=this.getBrowser(),n=i.getSurface(),r=n.offset(),s=e.pageX-r.left-parseFloat(n.css("borderLeftWidth")),o=n.innerHeight()-(e.pageY-r.top-parseFloat(n.css("borderTopWidth")));t(document).unbind(".PointingDevice"+this.getId()),n.bind("mousemove.PointingDevice"+this.getId(),this.mousemove.bind(this)),i.buttonReleaseEvent(),i.setCursor(this.isOver?"HAND":"DEFAULT"),i.finished().addInterest("onverifymotion",this,s,o),i.addBrowserEvent(),this.cursor="DEFAULT"}},dblclick:function(t){this.isOver&&t.stopImmediatePropagation()},mousemove:function(t){t.preventDefault();const e=this.getBrowser();if(this.motionTime===e.getCurrentTime())return;this.motionTime=e.getCurrentTime();const i=e.getSurface(),n=i.offset(),r=t.pageX-n.left-parseFloat(i.css("borderLeftWidth")),s=i.innerHeight()-(t.pageY-n.top-parseFloat(i.css("borderTopWidth")));this.onmotion(r,s)},touchstart:function(t){const e=t.originalEvent.touches;switch(e.length){case 1:{t.button=0,t.pageX=e[0].pageX,t.pageY=e[0].pageY,this.mousedown(t);const i=this.getBrowser().getNearestHit();i&&0!==i.sensors.size||(this.touchX=t.pageX,this.touchY=t.pageY,this.touchTimeout=setTimeout(this.showContextMenu.bind(this,t),1200));break}case 2:this.touchend(t)}},touchend:function(t){t.button=0,this.mouseup(t),clearTimeout(this.touchTimeout)},touchmove:function(t){const e=t.originalEvent.touches;if(1===e.length)t.button=0,t.pageX=e[0].pageX,t.pageY=e[0].pageY,this.mousemove(t),Math.hypot(this.touchX-t.pageX,this.touchY-t.pageY)>7&&clearTimeout(this.touchTimeout)},onmotion:function(t,e){const i=this.getBrowser();i.motionNotifyEvent(t,e)?this.isOver||(this.isOver=!0,this.cursor=i.getCursor(),i.setCursor("HAND")):this.isOver&&(this.isOver=!1,i.setCursor(this.cursor))},onmouseout:function(t){this.getBrowser().leaveNotifyEvent()},onverifymotion:function(t,e){this.getBrowser().finished().removeInterest("onverifymotion",this),this.onmotion(t,e)},showContextMenu:function(t){this.getBrowser().getContextMenu().show(t)}}),i})),define("x_ite/Browser/PointingDeviceSensor/X3DPointingDeviceSensorContext",["x_ite/Browser/PointingDeviceSensor/PointingDevice","x_ite/Rendering/TraverseType","standard/Math/Geometry/Line3","standard/Math/Geometry/ViewVolume","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4","standard/Math/Algorithms/MergeSort","standard/Math/Algorithm"],(function(t,e,i,n,r,s,o,a,u){"use strict";const l=Symbol(),c=Symbol(),h=Symbol(),d=Symbol(),p=Symbol(),f=Symbol(),g=Symbol(),m=Symbol(),_=Symbol(),y=Symbol(),x=Symbol(),w=Symbol(),b=Symbol(),v=Symbol(),S=new i(s.Zero,s.Zero);function T(){this[l]=new t(this),this[h]=new r(0,0),this[d]=new i(s.Zero,s.Zero),this[p]=[],this[f]=[new Map],this[m]=null,this[_]=new Set,this[y]=new Set,this[x]=new a(this[p],(function(t,e){return t.intersection.point.z<e.intersection.point.z})),this[b]=new a(this[p],(function(t,e){return t.layerNumber<e.layerNumber})),this[v]=0}return T.prototype={initialize:function(){this.getElement().attr("tabindex",this.getElement().attr("tabindex")||0),this.setCursor("DEFAULT"),this[l].setup()},setCursor:function(t){const e=this.getSurface();switch(this[c]=t,t){case"HAND":e.css("cursor","pointer");break;case"MOVE":e.css("cursor","move");break;case"CROSSHAIR":e.css("cursor","crosshair");break;default:this._loadCount.getValue()?e.css("cursor","wait"):this[l]&&this[l].isOver?e.css("cursor","pointer"):e.css("cursor","default")}},getCursor:function(){return this[c]},getPointer:function(){return this[h]},isPointerInRectangle:function(t){return this[h].x>t.x&&this[h].x<t.x+t.z&&this[h].y>t.y&&this[h].y<t.y+t.w},setLayerNumber:function(t){this[w]=t},getSelectedLayer:function(){return this[m]},setHitRay:function(t,e){n.unProjectRay(this[h].x,this[h].y,o.Identity,t,e,this[d])},getHitRay:function(){return this[d]},getSensors:function(){return this[f]},getPickOnlySensors:function(){return this[g]},addHit:function(t,e,i,n){const r=this[f].at(-1);this[p].push({pointer:this[h],hitRay:this[d].copy(),intersection:t,sensors:new Set(r.values()),layer:e,layerNumber:this[w],shape:i,modelViewMatrix:n.copy()})},getHits:function(){return this[p]},getNearestHit:function(){return this[p].at(-1)},buttonPressEvent:function(t,e){if(this.touch(t,e,!0),0===this[p].length)return!1;const i=this.getNearestHit();this[m]=i.layer,this[y]=i.sensors;for(const t of this[y])t.set_active__(!0,i);return!!i.sensors.size},buttonReleaseEvent:function(){this[m]=null;for(const t of this[y])t.set_active__(!1,null);return this[y]=new Set,!0},motionNotifyEvent:function(t,e){return this.touch(t,e,!0),this.motion(),!(!this[p].length||!this[p].at(-1).sensors.size)},leaveNotifyEvent:function(){},touch:function(t,i,n){if(this.getViewer()._isActive.getValue())return void(this[v]=0);const r=performance.now();this[g]=n,this[h].set(t,i),this[p].length=0,this.getWorld().traverse(e.POINTER,null),this[x].sort(0,this[p].length),this[b].sort(0,this[p].length),this.addBrowserEvent(),this[v]=performance.now()-r},motion:function(){if(this[p].length)var t=this[p].at(-1);else t={pointer:this[h],modelViewMatrix:new o,hitRay:this[m]?this[d]:S,intersection:null,sensors:new Set,shape:null,layer:null,layerNumber:0};if(this[p].length)var e=u.set_difference(this[_],t.sensors,new Set);else e=new Set(this[_]);for(const i of e)i.set_over__(!1,t);if(this[p].length){this[_]=t.sensors;for(const e of this[_])e.set_over__(!0,t)}else this[_]=new Set;for(const e of this[y])e.set_motion__(t)},getPointerTime:function(){return this[v]}},T})),define("x_ite/Browser/Navigation/X3DViewer",["x_ite/Base/X3DBaseNode","x_ite/Components/Navigation/OrthoViewpoint","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Box3","standard/Math/Geometry/ViewVolume"],(function(t,e,i,n,r,s){"use strict";function o(e){t.call(this,e)}return o.prototype=Object.assign(Object.create(t.prototype),{constructor:o,getTypeName:function(){return"X3DViewer"},initialize:function(){},loadShaders:function(){},getActiveLayer:function(){return this.getBrowser().getActiveLayer()},getViewport:function(){return this.getBrowser().getActiveLayer().getViewport()},getNavigationInfo:function(){return this.getBrowser().getActiveLayer().getNavigationInfo()},getActiveViewpoint:function(){return this.getBrowser().getActiveLayer().getViewpoint()},getStraightenHorizon:function(){return this.getBrowser().getBrowserOption("StraightenHorizon")},getButton:function(t){return 0===t&&this.getBrowser().getAltKey()?1:t},getPointOnCenterPlane:function(){const t=new i(0,0,-1),r=new i(0,0,0),o=new i(0,0,0);return function(i,a,u){const l=this.getNavigationInfo(),c=this.getActiveViewpoint(),h=this.getViewport().getRectangle(this.getBrowser()),d=c.getProjectionMatrixWithLimits(l.getNearValue(),l.getFarValue(c),h);if(s.unProjectPoint(i,this.getBrowser().getViewport()[3]-a,.9,n.Identity,d,h,o),c instanceof e)return u.set(o.x,o.y,-this.getDistanceToCenter(r).magnitude());const p=o.normalize();return u.assign(p).multiply(this.getDistanceToCenter(r).magnitude()/p.dot(t))}}(),getDistanceToCenter:function(t,e){const i=this.getActiveViewpoint();return t.assign(i.getPosition()).add(e||i._positionOffset.getValue()).subtract(i.getUserCenterOfRotation())},trackballProjectToSphere:function(t,e,i){const n=this.getViewport().getRectangle(this.getBrowser());return e=this.getBrowser().getViewport()[3]-e,t=(t-n[0])/n[2]-.5,e=(e-n[1])/n[3]-.5,i.set(t,e,function(t,e,i){const n=Math.hypot(e,i);if(n<t*Math.sqrt(.5))return Math.sqrt(t*t-n*n);const r=t/Math.sqrt(2);return r*r/n}(.5,t,e))},lookAtPoint:function(t,e,i){if(!this.touch(t,e))return;const n=this.getBrowser().getNearestHit();this.getActiveViewpoint().lookAtPoint(this.getActiveLayer(),n.intersection.point,.381966,i)},lookAtBBox:function(){const t=new r;return function(e,i,n){if(!this.touch(e,i))return;const r=this.getBrowser().getNearestHit();r.shape.getBBox(t).multRight(r.modelViewMatrix),this.getActiveViewpoint().lookAtBBox(this.getActiveLayer(),t,.381966,n)}}(),touch:function(t,e){return this.getBrowser().touch(t,e,!1),this.getBrowser().getHits().length},dispose:function(){}}),o})),define("x_ite/Components/Followers/X3DFollowerNode",["x_ite/Components/Core/X3DChildNode","x_ite/Base/X3DConstants"],(function(t,e){"use strict";function i(i){t.call(this,i),this.addType(e.X3DFollowerNode),this.buffer=[],this.a=this.getVector(),this.vector=this.getVector()}return i.prototype=Object.assign(Object.create(t.prototype),{constructor:i,initialize:function(){t.prototype.initialize.call(this),this.isLive().addInterest("set_live__",this)},getBuffer:function(){return this.buffer},getValue:function(){return this._set_value.getValue()},getDestination:function(){return this._set_destination.getValue()},getInitialValue:function(){return this._initialValue.getValue()},getInitialDestination:function(){return this._initialDestination.getValue()},setValue:function(t){this._value_changed=t},setDestination:function(t){this.destination.assign(t)},duplicate:function(t){return t.copy()},assign:function(t,e,i){t[e].assign(i)},equals:function(t,e,i){return this.a.assign(t).subtract(e).magnitude()<i},interpolate:function(t,e,i){return this.vector.assign(t).lerp(e,i)},set_live__:function(){(this.isLive().getValue()||this.getPrivate())&&this._isActive.getValue()?(this.getBrowser().prepareEvents().addInterest("prepareEvents",this),this.getBrowser().addBrowserEvent()):this.getBrowser().prepareEvents().removeInterest("prepareEvents",this)},set_active:function(t){t!==this._isActive.getValue()&&(this._isActive=t,this.set_live__())}}),i})),define("x_ite/Components/Followers/X3DChaserNode",["x_ite/Components/Followers/X3DFollowerNode","x_ite/Base/X3DConstants"],(function(t,e){"use strict";function i(i){t.call(this,i),this.addType(e.X3DChaserNode),this.destination=null,this.previousValue=null,this.bufferEndTime=0,this.stepTime=0,this.deltaOut=this.getVector()}return i.prototype=Object.assign(Object.create(t.prototype),{constructor:i,initialize:function(){t.prototype.initialize.call(this),this._set_value.addInterest("set_value__",this),this._set_destination.addInterest("set_destination__",this),this._duration.addInterest("set_duration__",this),this.set_duration__();var e=this.getBuffer(),i=this.getInitialValue(),n=this.getInitialDestination(),r=this.getNumBuffers();this.bufferEndTime=this.getBrowser().getCurrentTime(),this.previousValue=this.duplicate(i),e[0]=this.duplicate(n);for(var s=1;s<r;++s)e[s]=this.duplicate(i);this.destination=this.duplicate(n),this.equals(n,i,this.getTolerance())?this.setValue(n):this.set_active(!0)},getNumBuffers:function(){return 60},getTolerance:function(){return 1e-8},getArray:function(){return this.getVector()},setPreviousValue:function(t){this.previousValue.assign(t)},step:function(t,e,i){this.output.add(this.deltaOut.assign(t).subtract(e).multiply(i))},stepResponse:function(t){if(t<=0)return 0;var e=this._duration.getValue();return t>=e?1:.5-.5*Math.cos(t/e*Math.PI)},set_value__:function(){this._isActive.getValue()||(this.bufferEndTime=this.getBrowser().getCurrentTime());for(var t=this.getBuffer(),e=this.getValue(),i=0,n=t.length;i<n;++i)this.assign(t,i,e);this.setPreviousValue(e),this.setValue(e),this.set_active(!0)},set_destination__:function(){this.setDestination(this.getDestination()),this._isActive.getValue()||(this.bufferEndTime=this.getBrowser().getCurrentTime()),this.set_active(!0)},set_duration__:function(){this.stepTime=this._duration.getValue()/this.getNumBuffers()},prepareEvents:function(){var t=this.getBuffer(),e=t.length,i=this.updateBuffer();this.output=this.interpolate(this.previousValue,t[e-1],this.stepResponse((e-1+i)*this.stepTime));for(var n=e-2;n>=0;--n)this.step(t[n],t[n+1],this.stepResponse((n+i)*this.stepTime));this.setValue(this.output),this.equals(this.output,this.destination,this.getTolerance())&&this.set_active(!1)},updateBuffer:function(){var t=this.getBuffer(),e=t.length,i=(this.getBrowser().getCurrentTime()-this.bufferEndTime)/this.stepTime;if(i>=1){var n=Math.floor(i);if(i-=n,n<e){this.setPreviousValue(t[e-n]);for(var r=e-1;r>=n;--r)this.assign(t,r,t[r-n]);for(r=0;r<n;++r){var s=r/n;this.assign(t,r,this.interpolate(this.destination,t[n],s))}}else{this.setPreviousValue(n==e?t[0]:this.destination);for(r=0;r<e;++r)this.assign(t,r,this.destination)}this.bufferEndTime+=n*this.stepTime}return i}}),i})),define("x_ite/Components/Followers/PositionChaser",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Followers/X3DChaserNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3"],(function(t,e,i,n,r,s){"use strict";function o(t){n.call(this,t),this.addType(r.PositionChaser)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOnly,"set_value",new t.SFVec3f),new e(r.inputOnly,"set_destination",new t.SFVec3f),new e(r.initializeOnly,"initialValue",new t.SFVec3f),new e(r.initializeOnly,"initialDestination",new t.SFVec3f),new e(r.initializeOnly,"duration",new t.SFTime(1)),new e(r.outputOnly,"isActive",new t.SFBool),new e(r.outputOnly,"value_changed",new t.SFVec3f)]),getTypeName:function(){return"PositionChaser"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new s(0,0,0)}}),o})),define("x_ite/Components/Followers/OrientationChaser",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Followers/X3DChaserNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Rotation4"],(function(t,e,i,n,r,s){"use strict";var o=new s(0,0,1,0),a=new s(0,0,1,0);function u(t){n.call(this,t),this.addType(r.OrientationChaser),this._set_value.setUnit("angle"),this._set_destination.setUnit("angle"),this._initialValue.setUnit("angle"),this._initialDestination.setUnit("angle"),this._value_changed.setUnit("angle")}return u.prototype=Object.assign(Object.create(n.prototype),{constructor:u,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOnly,"set_value",new t.SFRotation),new e(r.inputOnly,"set_destination",new t.SFRotation),new e(r.initializeOnly,"initialValue",new t.SFRotation),new e(r.initializeOnly,"initialDestination",new t.SFRotation),new e(r.initializeOnly,"duration",new t.SFTime(1)),new e(r.outputOnly,"isActive",new t.SFBool),new e(r.outputOnly,"value_changed",new t.SFRotation)]),getTypeName:function(){return"OrientationChaser"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new s(0,0,1,0)},equals:function(t,e,i){return o.assign(t).inverse().multRight(e),Math.abs(o.angle)<i},interpolate:function(t,e,i){return a.assign(t).slerp(e,i)},step:function(t,e,i){this.deltaOut.assign(e).inverse().multRight(t).multLeft(this.output),this.output.slerp(this.deltaOut,i)}}),u})),define("x_ite/Browser/Navigation/ExamineViewer",["jquery","x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Base/X3DConstants","x_ite/Browser/Navigation/X3DViewer","x_ite/Components/Followers/PositionChaser","x_ite/Components/Followers/OrientationChaser","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","jquery-mousewheel"],(function(t,e,i,n,r,s,o,a,u,l,c){"use strict";var h,d,p,f,g,m,_,y,x,w,b,v,S,T,C,O=/Mac OS X/i.test(navigator.userAgent),N=O?1/120:.05;function F(t){s.call(this,t),this.button=-1,this.orientationOffset=new c(0,0,1,0),this.fromVector=new l(0,0,0),this.toVector=new l(0,0,0),this.fromPoint=new l(0,0,0),this.toPoint=new l(0,0,0),this.rotation=new c(0,0,1,0),this.pressTime=0,this.motionTime=0,this.touchMode=0,this.touch1=new u(0,0),this.touch2=new u(0,0),this.tapStart=0,this.dblTapInterval=.4,this.initialPositionOffset=new l(0,0,0),this.initialOrientationOffset=new c(0,0,1,0),this.positionChaser=new o(t),this.centerOfRotationChaser=new o(t),this.rotationChaser=new a(t)}return F.prototype=Object.assign(Object.create(s.prototype),{constructor:F,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new n([new i(r.outputOnly,"isActive",new e.SFBool)]),initialize:function(){s.prototype.initialize.call(this);var t=this.getBrowser(),e=t.getSurface();this.getNavigationInfo()._transitionStart.addInterest("disconnect",this),t._activeViewpoint.addInterest("set_activeViewpoint__",this),e.bind("mousedown.ExamineViewer",this.mousedown.bind(this)),e.bind("mouseup.ExamineViewer",this.mouseup.bind(this)),e.bind("dblclick.ExamineViewer",this.dblclick.bind(this)),e.bind("mousewheel.ExamineViewer",this.mousewheel.bind(this)),e.bind("touchstart.ExamineViewer",this.touchstart.bind(this)),e.bind("touchend.ExamineViewer",this.touchend.bind(this)),this.positionChaser._duration=.2,this.positionChaser.setPrivate(!0),this.positionChaser.setup(),this.centerOfRotationChaser._duration=.2,this.centerOfRotationChaser.setPrivate(!0),this.centerOfRotationChaser.setup(),this.rotationChaser._duration=.2,this.rotationChaser.setPrivate(!0),this.rotationChaser.setup(),this.set_activeViewpoint__()},set_activeViewpoint__:function(){if(this.getStraightenHorizon()){var t=this.getActiveViewpoint();t&&(t._orientationOffset=this.getOrientationOffset(c.Identity,t._orientationOffset.getValue(),!1))}this.disconnect()},mousedown:function(e){if(!(this.button>=0)){this.pressTime=performance.now();var i=this.getBrowser().getSurface().offset(),n=e.pageX-i.left,r=e.pageY-i.top;switch(this.getButton(e.button)){case 0:e.preventDefault(),e.stopImmediatePropagation(),this.button=e.button,t(document).bind("mouseup.ExamineViewer"+this.getId(),this.mouseup.bind(this)),t(document).bind("mousemove.ExamineViewer"+this.getId(),this.mousemove.bind(this)),t(document).bind("touchend.ExamineViewer"+this.getId(),this.touchend.bind(this)),t(document).bind("touchmove.ExamineViewer"+this.getId(),this.touchmove.bind(this)),this.disconnect(),this.getActiveViewpoint().transitionStop(),this.getBrowser().setCursor("MOVE"),this.trackballProjectToSphere(n,r,this.fromVector),this.rotation.assign(c.Identity),this.motionTime=0,this._isActive=!0;break;case 1:e.preventDefault(),e.stopImmediatePropagation(),this.button=e.button,t(document).bind("mouseup.ExamineViewer"+this.getId(),this.mouseup.bind(this)),t(document).bind("mousemove.ExamineViewer"+this.getId(),this.mousemove.bind(this)),t(document).bind("touchend.ExamineViewer"+this.getId(),this.touchend.bind(this)),t(document).bind("touchmove.ExamineViewer"+this.getId(),this.touchmove.bind(this)),this.disconnect(),this.getActiveViewpoint().transitionStop(),this.getBrowser().setCursor("MOVE"),this.getPointOnCenterPlane(n,r,this.fromPoint),this._isActive=!0}}},mouseup:function(e){if(e.button===this.button)switch(this.button=-1,t(document).unbind(".ExamineViewer"+this.getId()),this.getButton(e.button)){case 0:e.preventDefault(),e.stopImmediatePropagation();var i=this.getActiveViewpoint();this.getBrowser().setCursor("DEFAULT"),Math.abs(this.rotation.angle)>.003&&performance.now()-this.motionTime<40&&(this.getStraightenHorizon()&&"GeoViewpoint"!==i.getTypeName()&&(this.rotation=this.getHorizonRotation(this.rotation)),this.addSpinning(this.rotation)),this._isActive=!1;break;case 1:e.preventDefault(),e.stopImmediatePropagation(),this.getBrowser().setCursor("DEFAULT"),this._isActive=!1}},dblclick:function(t){t.preventDefault(),t.stopImmediatePropagation();const e=this.getBrowser().getSurface(),i=e.offset(),n=t.pageX-i.left-parseFloat(e.css("borderLeftWidth")),r=e.innerHeight()-(t.pageY-i.top-parseFloat(e.css("borderTopWidth")));this.disconnect(),this.lookAtBBox(n,r,this.getStraightenHorizon())},mousemove:(C=new l(0,0,0),function(t){var e=this.getBrowser().getSurface().offset(),i=t.pageX-e.left,n=t.pageY-e.top;switch(this.getButton(this.button)){case 0:t.preventDefault(),t.stopImmediatePropagation();var r=this.trackballProjectToSphere(i,n,this.toVector);if(this.rotation.setFromToVec(r,this.fromVector),Math.abs(this.rotation.angle)<.003&&performance.now()-this.pressTime<50)return;this.addRotate(this.rotation),this.fromVector.assign(r),this.motionTime=performance.now();break;case 1:t.preventDefault(),t.stopImmediatePropagation();var s=this.getActiveViewpoint(),o=this.getPointOnCenterPlane(i,n,this.toPoint),a=s.getUserOrientation().multVecRot(C.assign(this.fromPoint).subtract(o));this.addMove(a,a),this.fromPoint.assign(o)}}),mousewheel:(S=new l(0,0,0),T=new l(0,0,0),function(t){t.preventDefault(),t.stopImmediatePropagation();var e=this.getBrowser(),i=this.getActiveViewpoint();e.prepareEvents().removeInterest("spin",this),i.transitionStop(),S=this.getDistanceToCenter(S).multiply(t.zoomFactor||N),T=i.getUserOrientation().multVecRot(T.set(0,0,S.magnitude())),t.deltaY>0?this.addMove(T.negate(),l.Zero):t.deltaY<0&&this.addMove(T,l.Zero)}),touchstart:function(t){var e=t.originalEvent.touches;switch(e.length){case 1:t.button=0,t.pageX=e[0].pageX,t.pageY=e[0].pageY,this.mousedown(t),this.touch1.set(e[0].pageX,e[0].pageY);break;case 2:this.touchend(t),t.button=1,t.pageX=(e[0].pageX+e[1].pageX)/2,t.pageY=(e[0].pageY+e[1].pageY)/2,this.mousedown(t),this.touch1.set(e[0].pageX,e[0].pageY),this.touch2.set(e[1].pageX,e[1].pageY);break;case 3:this.touchend(t)}},touchend:function(t){switch(this.button){case 0:t.button=0,t.pageX=this.touch1.x,t.pageY=this.touch1.y,this.mouseup(t),this.tapedTwice?this.dblclick(t):(this.tapedTwice=!0,setTimeout(function(){this.tapedTwice=!1}.bind(this),300));break;case 1:this.touchMode=0,t.button=1,this.mouseup(t)}},touchmove:(b=new u(0,0),v=new u(0,0),function(e){var i=e.originalEvent.touches;switch(i.length){case 1:e.pageX=i[0].pageX,e.pageY=i[0].pageY,this.mousemove(e);break;case 2:b.set(i[0].pageX,i[0].pageY).subtract(this.touch1).normalize(),v.set(i[1].pageX,i[1].pageY).subtract(this.touch2).normalize();var n=b.dot(v)>.7,r=b.dot(v)<-.7;switch(this.touchMode||(n?1:r?2:0)){case 1:this.touchMode=1,e.pageX=(i[0].pageX+i[1].pageX)/2,e.pageY=(i[0].pageY+i[1].pageY)/2,this.mousemove(e);break;case 2:this.touchMode=2;var s=this.touch1.distance(this.touch2);this.touch1.set(i[0].pageX,i[0].pageY),this.touch2.set(i[1].pageX,i[1].pageY);var o=this.touch1.distance(this.touch2)-s;e.deltaY=o,e.zoomFactor=Math.abs(o)/t(window).width(),this.mousewheel(e)}this.touch1.set(i[0].pageX,i[0].pageY),this.touch2.set(i[1].pageX,i[1].pageY)}}),spin:function(){var t=this.getActiveViewpoint();this.orientationOffset.assign(t._orientationOffset.getValue()),t._orientationOffset=this.getOrientationOffset(this.rotation,this.orientationOffset),t._positionOffset=this.getPositionOffset(t._positionOffset.getValue(),this.orientationOffset,t._orientationOffset.getValue())},set_positionOffset__:function(t){this.getActiveViewpoint()._positionOffset=t},set_centerOfRotationOffset__:function(t){this.getActiveViewpoint()._centerOfRotationOffset=t},set_rotation__:function(t){var e=this.getActiveViewpoint();e._orientationOffset=this.getOrientationOffset(t.getValue(),this.initialOrientationOffset,!1),e._positionOffset=this.getPositionOffset(this.initialPositionOffset,this.initialOrientationOffset,e._orientationOffset.getValue())},addRotate:(w=new c,function(t){var e=this.getActiveViewpoint();if(this.rotationChaser._isActive.getValue()&&this.rotationChaser._value_changed.hasInterest("set_rotation__",this))try{w.assign(this.rotationChaser._set_destination.getValue()).multLeft(t),this.getOrientationOffset(w,this.initialOrientationOffset,!0),this.rotationChaser._set_destination=w}catch(e){t=this.getHorizonRotation(t),w.assign(this.rotationChaser._set_destination.getValue()).multLeft(t),this.rotationChaser._set_destination=w}else try{this.initialOrientationOffset.assign(e._orientationOffset.getValue()),this.initialPositionOffset.assign(e._positionOffset.getValue()),this.getOrientationOffset(t,this.initialOrientationOffset,!0),this.rotationChaser._set_value=c.Identity,this.rotationChaser._set_destination=t}catch(e){this.rotationChaser._set_value=c.Identity,this.rotationChaser._set_destination=this.getHorizonRotation(t)}this.disconnect(),this.rotationChaser._value_changed.addInterest("set_rotation__",this)}),addSpinning:(x=new c(0,0,1,0),function(t){this.disconnect(),this.getBrowser().prepareEvents().addInterest("spin",this),this.rotation.assign(x.assign(c.Identity).slerp(t,.6))}),addMove:(_=new l(0,0,0),y=new l(0,0,0),function(t,e){var i=this.getActiveViewpoint();this.positionChaser._isActive.getValue()&&this.positionChaser._value_changed.hasInterest("set_positionOffset__",this)?(_.assign(this.positionChaser._set_destination.getValue()).add(t),this.positionChaser._set_destination=_):(_.assign(i._positionOffset.getValue()).add(t),this.positionChaser._set_value=i._positionOffset,this.positionChaser._set_destination=_),this.centerOfRotationChaser._isActive.getValue()&&this.centerOfRotationChaser._value_changed.hasInterest("set_centerOfRotationOffset__",this)?(y.assign(this.centerOfRotationChaser._set_destination.getValue()).add(e),this.centerOfRotationChaser._set_destination=y):(y.assign(i._centerOfRotationOffset.getValue()).add(e),this.centerOfRotationChaser._set_value=i._centerOfRotationOffset,this.centerOfRotationChaser._set_destination=y),this.disconnect(),this.positionChaser._value_changed.addInterest("set_positionOffset__",this),this.centerOfRotationChaser._value_changed.addInterest("set_centerOfRotationOffset__",this)}),getPositionOffset:(f=new l(0,0,0),g=new l(0,0,0),m=new c(0,0,1,0),function(t,e,i){return this.getDistanceToCenter(f,t),m.assign(e).inverse().multRight(i).multVecRot(g.assign(f)).subtract(f).add(t)}),getOrientationOffset:(h=new c(0,0,1,0),d=new c(0,0,1,0),p=new l(0,0,0),function(t,e,i){var n=this.getActiveViewpoint(),r=this.getStraightenHorizon();h.assign(t).multRight(n.getOrientation()).multRight(e),r&&"GeoViewpoint"!==n.getTypeName()&&n.straightenHorizon(h);var s=d.assign(n.getOrientation()).inverse().multRight(h);if(r&&"GeoViewpoint"!==n.getTypeName()){if(!i)return s;var o=h.multVecRot(p.assign(l.zAxis));if(Math.abs(n.getUpVector().dot(o))<.97)return s;throw new Error("Critical angle")}return s}),getHorizonRotation:function(){var t=new l(0,0,0);return function(e){var i=this.getActiveViewpoint(),n=e.multVecRot(t.assign(l.zAxis)).normalize(),r=l.cross(i.getUpVector(),n).normalize(),s=l.cross(r,i.getUpVector()).normalize();return new c(l.zAxis,s)}}(),disconnect:function(){var t=this.getBrowser();this.positionChaser._value_changed.removeInterest("set_positionOffset__",this),this.centerOfRotationChaser._value_changed.removeInterest("set_centerOfRotationOffset__",this),this.rotationChaser._value_changed.removeInterest("set_rotation__",this),t.prepareEvents().removeInterest("spin",this)},dispose:function(){var e=this.getBrowser();this.disconnect(),e._activeViewpoint.removeInterest("set_activeViewpoint__",this),e.getSurface().unbind(".ExamineViewer"),t(document).unbind(".ExamineViewer"+this.getId())}}),F})),define("x_ite/Browser/Navigation/X3DFlyViewer",["jquery","x_ite/Browser/Navigation/X3DViewer","x_ite/Components/Followers/OrientationChaser","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Rendering/VertexArray","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Camera","jquery-mousewheel"],(function(t,e,i,n,r,s,o,a,u){"use strict";var l,c,h,d,p,f,g,m,_=/Mac OS X/i.test(navigator.userAgent),y=.007,x=_?Math.PI/512:Math.PI/32;function w(t){e.call(this,t);const o=this.getBrowser(),a=o.getContext();this.button=-1,this.fromVector=new s(0,0,0),this.toVector=new s(0,0,0),this.direction=new s(0,0,0),this.startTime=0,this.lineCount=2,this.lineVertices=new Array(4*this.lineCount),this.lineArray=new Float32Array(this.lineVertices),this.lineBuffer=a.createBuffer(),this.lineArrayObject=new r,this.event=null,this.lookAround=!1,this.orientationChaser=new i(t),this.geometryContext={geometryType:1,colorMaterial:!1,hasNormals:!1},this.context={appearanceNode:o.getDefaultAppearance()},n.prototype.updateGeometryMask.call(this.geometryContext)}return w.prototype=Object.assign(Object.create(e.prototype),{constructor:w,initialize:function(){e.prototype.initialize.call(this);const t=this.getBrowser(),i=t.getSurface();i.bind("mousedown.X3DFlyViewer",this.mousedown.bind(this)),i.bind("mouseup.X3DFlyViewer",this.mouseup.bind(this)),i.bind("mousewheel.X3DFlyViewer",this.mousewheel.bind(this)),i.bind("touchstart.X3DFlyViewer",this.touchstart.bind(this)),i.bind("touchend.X3DFlyViewer",this.touchend.bind(this)),t._controlKey.addInterest("set_controlKey__",this),this.orientationChaser._duration=.3,this.orientationChaser.setPrivate(!0),this.orientationChaser.setup(),this.loadShaders()},loadShaders:function(){const t=this.getBrowser();t.getBrowserOption("Rubberband")&&(t.getDefaultMaterial().getShader(this.geometryContext,this.context),t.getDepthShader())},addCollision:function(){},removeCollision:function(){},set_controlKey__:function(){this.event&&0===this.event.button&&(this.button=-1,this.mousedown(this.event))},mousedown:function(e){if(!(this.button>=0)){this.event=e;var i=this.getBrowser().getSurface().offset(),n=e.pageX-i.left,r=e.pageY-i.top;switch(this.getButton(e.button)){case 0:e.preventDefault(),e.stopImmediatePropagation(),this.button=e.button,t(document).bind("mouseup.X3DFlyViewer"+this.getId(),this.mouseup.bind(this)),t(document).bind("mousemove.X3DFlyViewer"+this.getId(),this.mousemove.bind(this)),t(document).bind("touchend.X3DFlyViewer"+this.getId(),this.touchend.bind(this)),t(document).bind("touchmove.X3DFlyViewer"+this.getId(),this.touchmove.bind(this)),this.disconnect(),this.getActiveViewpoint().transitionStop(),this.getBrowser().setCursor("MOVE"),this.addCollision(),this.getBrowser().getControlKey()||this.lookAround?this.trackballProjectToSphere(n,r,this.fromVector):(this.fromVector.set(n,0,r),this.toVector.assign(this.fromVector),this.getFlyDirection(this.fromVector,this.toVector,this.direction),this.addFly(),this.getBrowser().getBrowserOption("Rubberband")&&this.getBrowser().finished().addInterest("display",this,0)),this._isActive=!0;break;case 1:e.preventDefault(),e.stopImmediatePropagation(),this.button=e.button,t(document).bind("mouseup.X3DFlyViewer"+this.getId(),this.mouseup.bind(this)),t(document).bind("mousemove.X3DFlyViewer"+this.getId(),this.mousemove.bind(this)),this.disconnect(),this.getActiveViewpoint().transitionStop(),this.getBrowser().setCursor("MOVE"),this.addCollision(),this.fromVector.set(n,-r,0),this.toVector.assign(this.fromVector),this.direction.set(0,0,0),this.addPan(),this.getBrowser().getBrowserOption("Rubberband")&&this.getBrowser().finished().addInterest("display",this,1),this._isActive=!0}}},mouseup:function(e){e.preventDefault(),e.button===this.button&&(this.event=null,this.button=-1,t(document).unbind(".X3DFlyViewer"+this.getId()),this.disconnect(),this.getBrowser().setCursor("DEFAULT"),this.removeCollision(),this._isActive=!1)},mousemove:function(t){this.getBrowser().addBrowserEvent(),this.event=t;var e=this.getBrowser().getSurface().offset(),i=t.pageX-e.left,n=t.pageY-e.top;switch(this.getButton(this.button)){case 0:if(this.getBrowser().getControlKey()||this.lookAround){t.preventDefault(),t.stopImmediatePropagation();var r=this.trackballProjectToSphere(i,n,this.toVector);this.addRotation(this.fromVector,r),this.fromVector.assign(r);break}this.toVector.set(i,0,n),this.getFlyDirection(this.fromVector,this.toVector,this.direction);break;case 1:t.preventDefault(),t.stopImmediatePropagation(),this.toVector.set(i,-n,0),this.direction.assign(this.toVector).subtract(this.fromVector)}},mousewheel:function(t){t.preventDefault(),t.stopImmediatePropagation(),this.getActiveViewpoint().transitionStop(),t.deltaY>0?this.addRoll(-x):t.deltaY<0&&this.addRoll(x)},touchstart:function(t){var e=t.originalEvent.touches;switch(e.length){case 1:t.button=0,t.pageX=e[0].pageX,t.pageY=e[0].pageY,this.mousedown(t);break;case 2:this.touchend(t),this.lookAround=!0,t.button=0,t.pageX=(e[0].pageX+e[1].pageX)/2,t.pageY=(e[0].pageY+e[1].pageY)/2,this.mousedown(t);break;case 3:this.touchend(t)}},touchend:function(t){if(0===this.button)this.lookAround=!1,t.button=0,this.mouseup(t)},touchmove:function(t){var e=t.originalEvent.touches;switch(e.length){case 1:t.button=0,t.pageX=e[0].pageX,t.pageY=e[0].pageY,this.mousemove(t);break;case 2:t.button=0,t.pageX=(e[0].pageX+e[1].pageX)/2,t.pageY=(e[0].pageY+e[1].pageY)/2,this.mousemove(t)}},fly:(l=new s(0,0,0),c=new s(0,0,0),h=new s(0,0,0),d=new o(0,0,1,0),p=new o(0,0,1,0),f=new o(0,0,1,0),g=new o(0,0,1,0),m=new o(0,0,1,0),function(){var t=this.getNavigationInfo(),e=this.getActiveViewpoint(),i=performance.now(),n=(i-this.startTime)/1e3;l.assign(e.getUpVector()),g.setFromToVec(s.yAxis,l),this.direction.z>0?f.setFromToVec(g.multVecRot(c.assign(this.direction)),g.multVecRot(h.set(0,0,1))):f.setFromToVec(g.multVecRot(h.set(0,0,-1)),g.multVecRot(c.assign(this.direction)));var r=this.direction.magnitude(),a=1-f.angle/(Math.PI/2);a*=t._speed.getValue(),a*=e.getSpeedFactor(),a*=this.getBrowser().getShiftKey()?.028:y,a*=n;var u=this.getTranslationOffset(c.assign(this.direction).multiply(a));this.getActiveLayer().constrainTranslation(u,!0),e._positionOffset=u.add(e._positionOffset.getValue());var _=1.4*n*Math.pow(r/(r+40),2);d.assign(o.Identity).slerp(f,_).multRight(e.getUserOrientation()),"GeoViewpoint"!==e.getTypeName()&&this.getStraightenHorizon()&&e.straightenHorizon(d),p.assign(e.getOrientation()).inverse().multRight(d),e._orientationOffset=p,m.setFromToVec(l,e.getUpVector()),e._orientationOffset=m.multLeft(e._orientationOffset.getValue()),this.startTime=i}),pan:function(){var t=new s(0,0,0),e=new s(0,0,0);return function(){var i=this.getNavigationInfo(),n=this.getActiveViewpoint(),r=performance.now(),a=(r-this.startTime)/1e3,u=n.getUpVector();this.constrainPanDirection(t.assign(this.direction));var l=1;l*=i._speed.getValue(),l*=n.getSpeedFactor(),l*=this.getBrowser().getShiftKey()?.0098:.007,l*=a;var c=n.getUserOrientation().multRight(new o(n.getUserOrientation().multVecRot(e.assign(s.yAxis)),u)).multVecRot(t.multiply(l));this.getActiveLayer().constrainTranslation(c,!0),n._positionOffset=c.add(n._positionOffset.getValue()),this.startTime=r}}(),set_orientationOffset__:function(t){this.getActiveViewpoint()._orientationOffset=t},addFly:function(){this.startTime||(this.getBrowser().prepareEvents().addInterest("fly",this),this.getBrowser().addBrowserEvent(),this.startTime=performance.now())},addPan:function(){this.startTime||(this.disconnect(),this.getBrowser().prepareEvents().addInterest("pan",this),this.getBrowser().addBrowserEvent(),this.startTime=performance.now())},addRoll:function(){var t=new o(0,0,1,0),e=new o(0,0,1,0);return function(i){var n=this.getActiveViewpoint();this.orientationChaser._isActive.getValue()&&this.orientationChaser._value_changed.hasInterest("set_orientationOffset__",this)?(t.assign(n.getOrientation()).inverse().multRight(e.set(1,0,0,i)).multRight(n.getOrientation()).multRight(this.orientationChaser._set_destination.getValue()),this.orientationChaser._set_destination=t):(t.assign(n.getOrientation()).inverse().multRight(e.set(1,0,0,i)).multRight(n.getUserOrientation()),this.orientationChaser._set_value=n._orientationOffset,this.orientationChaser._set_destination=t),this.disconnect(),this.orientationChaser._value_changed.addInterest("set_orientationOffset__",this)}}(),addRotation:function(){var t=new o(0,0,1,0),e=new o(0,0,1,0);return function(i,n){var r=this.getActiveViewpoint();this.orientationChaser._isActive.getValue()&&this.orientationChaser._value_changed.hasInterest("set_orientationOffset__",this)?(t.setFromToVec(n,i).multRight(r.getOrientation()).multRight(this.orientationChaser._set_destination.getValue()),"GeoViewpoint"!==r.getTypeName()&&this.getStraightenHorizon()&&r.straightenHorizon(t),e.assign(r.getOrientation()).inverse().multRight(t),this.orientationChaser._set_destination=e):(t.setFromToVec(n,i).multRight(r.getUserOrientation()),"GeoViewpoint"!==r.getTypeName()&&this.getStraightenHorizon()&&r.straightenHorizon(t),e.assign(r.getOrientation()).inverse().multRight(t),this.orientationChaser._set_value=r._orientationOffset,this.orientationChaser._set_destination=e),this.disconnect(),this.orientationChaser._value_changed.addInterest("set_orientationOffset__",this)}}(),display:function(){const t=new s(0,0,0),e=new s(0,0,0),i=new a,n=new Float32Array(a.Identity),r=new Float32Array(a.Identity);return function(s){const o=this.getBrowser(),a=o.getViewport(),l=a[2],c=a[3];u.ortho(0,l,0,c,-1,1,i),n.set(i),0===s?(t.set(this.fromVector.x,c-this.fromVector.z,0),e.set(this.toVector.x,c-this.toVector.z,0)):(t.set(this.fromVector.x,c+this.fromVector.y,0),e.set(this.toVector.x,c+this.toVector.y,0)),this.transfer(t,e);const h=o.getContext(),d=o.getDefaultMaterial().getShader(this.geometryContext,this.context),p=h.getParameter(h.LINE_WIDTH);d.enable(h),this.lineArrayObject.enable(h,d)&&d.enableVertexAttribute(h,this.lineBuffer,0,0),h.uniform1i(d.x3d_NumClipPlanes,0),h.uniform1i(d.x3d_FogType,0),h.uniform1i(d.x3d_LinePropertiesApplied,!1),h.uniformMatrix4fv(d.x3d_ProjectionMatrix,!1,n),h.uniformMatrix4fv(d.x3d_ModelViewMatrix,!1,r),h.disable(h.DEPTH_TEST),h.lineWidth(2),h.uniform3f(d.x3d_EmissiveColor,0,0,0),h.uniform1f(d.x3d_Transparency,0),h.drawArrays(h.LINES,0,this.lineCount),h.lineWidth(1),h.uniform3f(d.x3d_EmissiveColor,1,1,1),h.drawArrays(h.LINES,0,this.lineCount),h.enable(h.DEPTH_TEST),h.lineWidth(p)}}(),transfer:function(t,e){const i=this.getBrowser().getContext(),n=this.lineVertices;n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=1,n[4]=e.x,n[5]=e.y,n[6]=e.z,n[7]=1,this.lineArray.set(n),i.bindBuffer(i.ARRAY_BUFFER,this.lineBuffer),i.bufferData(i.ARRAY_BUFFER,this.lineArray,i.DYNAMIC_DRAW)},disconnect:function(){var t=this.getBrowser();t.addBrowserEvent(),t.prepareEvents().removeInterest("fly",this),t.prepareEvents().removeInterest("pan",this),t.finished().removeInterest("display",this),this.orientationChaser._value_changed.removeInterest("set_orientationOffset__",this),this.startTime=0},dispose:function(){const e=this.getBrowser().getContext();e.deleteBuffer(this.lineBuffer),this.lineArrayObject.delete(e),this.disconnect(),this.getBrowser()._controlKey.removeInterest("set_controlKey__",this),this.getBrowser().getSurface().unbind(".X3DFlyViewer"),t(document).unbind(".X3DFlyViewer"+this.getId())}}),w})),define("x_ite/Browser/Navigation/WalkViewer",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Browser/Navigation/X3DFlyViewer","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4"],(function(t,e,i,n,r,s,o){"use strict";function a(t){n.call(this,t)}var u,l,c;return a.prototype=Object.assign(Object.create(n.prototype),{constructor:a,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.outputOnly,"isActive",new t.SFBool)]),initialize:function(){n.prototype.initialize.call(this),this.getBrowser().addCollision(this)},getStraightenHorizon:function(){return!0},getFlyDirection:function(t,e,i){return i.assign(e).subtract(t)},getTranslationOffset:(u=new s(0,0,0),l=new o(0,0,1,0),c=new o(0,0,1,0),function(t){var e=this.getActiveViewpoint(),i=e.getUpVector();return l.assign(e.getUserOrientation()),l.multVecRot(u.assign(s.yAxis)),c.setFromToVec(u,i),l.multRight(c).multVecRot(t)}),constrainPanDirection:function(t){return t.y<0&&(t.y=0),t},dispose:function(){this.getBrowser().removeCollision(this),n.prototype.dispose.call(this)}}),a})),define("x_ite/Browser/Navigation/FlyViewer",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Base/X3DConstants","x_ite/Browser/Navigation/X3DFlyViewer","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4"],(function(t,e,i,n,r,s,o){"use strict";function a(t){r.call(this,t)}return a.prototype=Object.assign(Object.create(r.prototype),{constructor:a,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(n.outputOnly,"isActive",new t.SFBool)]),addCollision:function(){this.getBrowser().addCollision(this)},removeCollision:function(){this.getBrowser().removeCollision(this)},getFlyDirection:function(t,e,i){return i.assign(e).subtract(t)},getTranslationOffset:function(t){return this.getActiveViewpoint().getUserOrientation().multVecRot(t)},constrainPanDirection:function(t){return t}}),a})),define("x_ite/Browser/Navigation/PlaneViewer",["jquery","x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Base/X3DConstants","x_ite/Browser/Navigation/X3DViewer","x_ite/Components/Navigation/Viewpoint","standard/Math/Numbers/Vector3","jquery-mousewheel"],(function(t,e,i,n,r,s,o,a){"use strict";var u=/Mac OS X/i.test(navigator.userAgent)?1/160:.05,l=new a(0,0,0),c=new a(0,0,0),h=new a(0,0,0);function d(t){s.call(this,t),this.button=-1,this.fromPoint=new a(0,0,0),this.toPoint=new a(0,0,0)}return d.prototype=Object.assign(Object.create(s.prototype),{constructor:d,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new n([new i(r.outputOnly,"isActive",new e.SFBool)]),initialize:function(){s.prototype.initialize.call(this);var t=this.getBrowser().getSurface();t.bind("mousedown.PlaneViewer",this.mousedown.bind(this)),t.bind("mouseup.PlaneViewer",this.mouseup.bind(this)),t.bind("mousemove.PlaneViewer",this.mousemove.bind(this)),t.bind("mousewheel.PlaneViewer",this.mousewheel.bind(this))},mousedown:function(e){if(!(this.button>=0)){var i=this.getBrowser().getSurface().offset(),n=e.pageX-i.left,r=e.pageY-i.top;if(1===this.getButton(e.button))e.preventDefault(),e.stopImmediatePropagation(),this.button=e.button,this.getBrowser().getSurface().unbind("mousemove.PlaneViewer"),t(document).bind("mouseup.PlaneViewer"+this.getId(),this.mouseup.bind(this)),t(document).bind("mousemove.PlaneViewer"+this.getId(),this.mousemove.bind(this)),this.getActiveViewpoint().transitionStop(),this.getBrowser().setCursor("MOVE"),this.getPointOnCenterPlane(n,r,this.fromPoint),this._isActive=!0}},mouseup:function(e){e.preventDefault(),e.stopImmediatePropagation(),e.button===this.button&&(this.button=-1,t(document).unbind(".PlaneViewer"+this.getId()),this.getBrowser().getSurface().bind("mousemove.PlaneViewer",this.mousemove.bind(this)),this.getBrowser().setCursor("DEFAULT"),this._isActive=!1)},mousemove:function(t){var e=this.getBrowser().getSurface().offset(),i=t.pageX-e.left,n=t.pageY-e.top;if(1===this.getButton(this.button)){t.preventDefault(),t.stopImmediatePropagation();var r=this.getActiveViewpoint(),s=this.getPointOnCenterPlane(i,n,this.toPoint),o=r.getUserOrientation().multVecRot(this.fromPoint.subtract(s));r._positionOffset=c.assign(r._positionOffset.getValue()).add(o),r._centerOfRotationOffset=h.assign(r._centerOfRotationOffset.getValue()).add(o),this.fromPoint.assign(s)}},mousewheel:function(t){t.preventDefault(),t.stopImmediatePropagation();var e=this.getBrowser().getSurface().offset(),i=t.pageX-e.left,n=t.pageY-e.top,r=this.getActiveViewpoint(),s=this.getPointOnCenterPlane(i,n,this.fromPoint);r.transitionStop(),t.deltaY>0?r._fieldOfViewScale=Math.max(1e-5,r._fieldOfViewScale.getValue()*(1-u)):t.deltaY<0&&(r._fieldOfViewScale=r._fieldOfViewScale.getValue()*(1+u),this.constrainFieldOfViewScale()),r.set_fieldOfView___&&r.set_fieldOfView___();var o=this.getPointOnCenterPlane(i,n,this.toPoint),a=r.getUserOrientation().multVecRot(l.assign(s).subtract(o));r._positionOffset=c.assign(r._positionOffset.getValue()).add(a),r._centerOfRotationOffset=h.assign(r._centerOfRotationOffset.getValue()).add(a)},constrainFieldOfViewScale:function(){var t=this.getActiveViewpoint();(t instanceof o||"GeoViewpoint"===t.getTypeName())&&t._fieldOfView.getValue()*t._fieldOfViewScale.getValue()>=Math.PI&&(t._fieldOfViewScale=(Math.PI-.001)/t._fieldOfView.getValue())},dispose:function(){this.getBrowser().getSurface().unbind(".PlaneViewer"),t(document).unbind(".PlaneViewer"+this.getId())}}),d})),define("x_ite/Browser/Navigation/NoneViewer",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Base/X3DConstants","x_ite/Browser/Navigation/X3DViewer"],(function(t,e,i,n,r){"use strict";function s(t){r.call(this,t)}return s.prototype=Object.assign(Object.create(r.prototype),{constructor:s,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(n.outputOnly,"isActive",new t.SFBool)])}),s})),define("x_ite/Browser/Navigation/LookAtViewer",["jquery","x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Base/X3DConstants","x_ite/Browser/Navigation/X3DViewer","x_ite/Components/Followers/PositionChaser","x_ite/Components/Followers/OrientationChaser","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4"],(function(t,e,i,n,r,s,o,a,u,l,c){"use strict";var h,d,p,f,g,m,_,y,x=/Mac OS X/i.test(navigator.userAgent)?1/120:.05;function w(t){s.call(this,t),this.button=-1,this.fromVector=new l(0,0,0),this.toVector=new l(0,0,0),this.touch1=new u(0,0),this.touch2=new u(0,0),this.tapStart=0,this.dblTapInterval=.4,this.positionChaser=new o(t),this.centerOfRotationChaser=new o(t),this.orientationChaser=new a(t)}return w.prototype=Object.assign(Object.create(s.prototype),{constructor:w,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new n([new i(r.outputOnly,"isActive",new e.SFBool)]),initialize:function(){s.prototype.initialize.call(this);var t=this.getBrowser().getSurface();t.bind("mousedown.LookAtViewer",this.mousedown.bind(this)),t.bind("mouseup.LookAtViewer",this.mouseup.bind(this)),t.bind("dblclick.LookAtViewer",this.dblclick.bind(this)),t.bind("mousewheel.LookAtViewer",this.mousewheel.bind(this)),t.bind("touchstart.LookAtViewer",this.touchstart.bind(this)),t.bind("touchend.LookAtViewer",this.touchend.bind(this)),this.positionChaser._duration=.3,this.positionChaser.setPrivate(!0),this.positionChaser.setup(),this.centerOfRotationChaser._duration=.3,this.centerOfRotationChaser.setPrivate(!0),this.centerOfRotationChaser.setup(),this.orientationChaser._duration=.3,this.orientationChaser.setPrivate(!0),this.orientationChaser.setup()},mousedown:function(e){if(!(this.button>=0)){var i=this.getBrowser().getSurface().offset(),n=e.pageX-i.left,r=e.pageY-i.top;if(0===e.button)e.preventDefault(),e.stopImmediatePropagation(),this.button=e.button,t(document).bind("mouseup.LookAtViewer"+this.getId(),this.mouseup.bind(this)),t(document).bind("mousemove.LookAtViewer"+this.getId(),this.mousemove.bind(this)),t(document).bind("touchend.LookAtViewer"+this.getId(),this.mouseup.bind(this)),t(document).bind("touchmove.LookAtViewer"+this.getId(),this.touchmove.bind(this)),this.getActiveViewpoint().transitionStop(),this.trackballProjectToSphere(n,r,this.fromVector),this._isActive=!0}},mouseup:function(e){if(e.button===this.button&&(this.button=-1,t(document).unbind(".LookAtViewer"+this.getId()),0===e.button))e.preventDefault(),e.stopImmediatePropagation(),this._isActive=!1},dblclick:function(t){t.preventDefault(),t.stopImmediatePropagation();var e=this.getBrowser().getSurface(),i=e.offset(),n=t.pageX-i.left-parseFloat(e.css("borderLeftWidth")),r=e.innerHeight()-(t.pageY-i.top-parseFloat(e.css("borderTopWidth")));this.disconnect(),this.lookAtPoint(n,r,this.getStraightenHorizon())},mousemove:function(t){this.getBrowser().addBrowserEvent(),this.event=t;var e=this.getBrowser().getSurface().offset(),i=t.pageX-e.left,n=t.pageY-e.top;if(0===this.button){t.preventDefault(),t.stopImmediatePropagation();var r=this.trackballProjectToSphere(i,n,this.toVector);this.addRotation(this.fromVector,r),this.fromVector.assign(r)}},mousewheel:(_=new l(0,0,0),y=new l(0,0,0),function(t){t.preventDefault(),t.stopImmediatePropagation();var e=this.getActiveViewpoint();e.transitionStop(),_=this.getDistanceToCenter(_).multiply(t.zoomFactor||x),y=e.getUserOrientation().multVecRot(y.set(0,0,_.magnitude())),t.deltaY>0?this.addMove(y.negate(),l.Zero):t.deltaY<0&&this.addMove(y,l.Zero)}),touchstart:function(t){var e=t.originalEvent.touches;switch(e.length){case 1:this.touch1.set(e[0].pageX,e[0].pageY);break;case 2:this.touchend(t),t.button=0,t.pageX=(e[0].pageX+e[1].pageX)/2,t.pageY=(e[0].pageY+e[1].pageY)/2,this.mousedown(t),this.touch1.set(e[0].pageX,e[0].pageY),this.touch2.set(e[1].pageX,e[1].pageY);break;case 3:this.touchend(t)}},touchend:function(t){if(0===this.button)this.mouseup(t);this.getBrowser().getCurrentTime()-this.tapStart<this.dblTapInterval&&(t.button=1,t.pageX=this.touch1.x,t.pageY=this.touch1.y,this.dblclick(t)),this.tapStart=this.getBrowser().getCurrentTime()},touchmove:(g=new u(0,0),m=new u(0,0),function(e){var i=e.originalEvent.touches;switch(i.length){case 1:break;case 2:g.set(i[0].pageX,i[0].pageY).subtract(this.touch1).normalize(),m.set(i[1].pageX,i[1].pageY).subtract(this.touch2).normalize();var n=g.dot(m)>.7,r=g.dot(m)<-.7;if(n)e.button=0,e.pageX=(i[0].pageX+i[1].pageX)/2,e.pageY=(i[0].pageY+i[1].pageY)/2,this.mousemove(e);else if(r){var s=this.touch1.distance(this.touch2);this.touch1.set(i[0].pageX,i[0].pageY),this.touch2.set(i[1].pageX,i[1].pageY);var o=this.touch1.distance(this.touch2)-s;e.deltaY=o,e.zoomFactor=Math.abs(o)/t(window).width(),this.mousewheel(e)}this.touch1.set(i[0].pageX,i[0].pageY),this.touch2.set(i[1].pageX,i[1].pageY)}}),set_positionOffset__:function(t){this.getActiveViewpoint()._positionOffset=t},set_centerOfRotationOffset__:function(t){this.getActiveViewpoint()._centerOfRotationOffset=t},set_orientationOffset__:function(t){this.getActiveViewpoint()._orientationOffset=t},addMove:(p=new l(0,0,0),f=new l(0,0,0),function(t,e){var i=this.getActiveViewpoint();this.positionChaser._isActive.getValue()&&this.positionChaser._value_changed.hasInterest("set_positionOffset__",this)?(p.assign(this.positionChaser._set_destination.getValue()).add(t),this.positionChaser._set_destination=p):(p.assign(i._positionOffset.getValue()).add(t),this.positionChaser._set_value=i._positionOffset,this.positionChaser._set_destination=p),this.centerOfRotationChaser._isActive.getValue()&&this.centerOfRotationChaser._value_changed.hasInterest("set_centerOfRotationOffset__",this)?(f.assign(this.centerOfRotationChaser._set_destination.getValue()).add(e),this.centerOfRotationChaser._set_destination=f):(f.assign(i._centerOfRotationOffset.getValue()).add(e),this.centerOfRotationChaser._set_value=i._centerOfRotationOffset,this.centerOfRotationChaser._set_destination=f),this.disconnect(),this.positionChaser._value_changed.addInterest("set_positionOffset__",this),this.centerOfRotationChaser._value_changed.addInterest("set_centerOfRotationOffset__",this)}),addRotation:(h=new c(0,0,1,0),d=new c(0,0,1,0),function(t,e){var i=this.getActiveViewpoint();this.orientationChaser._isActive.getValue()&&this.orientationChaser._value_changed.hasInterest("set_orientationOffset__",this)?(h.setFromToVec(e,t).multRight(i.getOrientation()).multRight(this.orientationChaser._set_destination.getValue()),i.straightenHorizon(h),d.assign(i.getOrientation()).inverse().multRight(h),this.orientationChaser._set_destination=d):(h.setFromToVec(e,t).multRight(i.getUserOrientation()),i.straightenHorizon(h),d.assign(i.getOrientation()).inverse().multRight(h),this.orientationChaser._set_value=i._orientationOffset,this.orientationChaser._set_destination=d),this.disconnect(),this.orientationChaser._value_changed.addInterest("set_orientationOffset__",this)}),disconnect:function(){this.orientationChaser._value_changed.removeInterest("set_orientationOffset__",this),this.positionChaser._value_changed.removeInterest("set_positionOffset__",this),this.centerOfRotationChaser._value_changed.removeInterest("set_centerOfRotationOffset__",this)},dispose:function(){this.getBrowser().getSurface().unbind(".LookAtViewer"),t(document).unbind(".LookAtViewer"+this.getId())}}),w})),define("x_ite/Components/Lighting/X3DLightNode",["x_ite/Components/Core/X3DChildNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Matrix4","standard/Math/Algorithm"],(function(t,e,i,n){"use strict";function r(i){t.call(this,i),this.addType(e.X3DLightNode)}return r.prototype=Object.assign(Object.create(t.prototype),{constructor:r,initialize:function(){t.prototype.initialize.call(this),this._on.addInterest("set_on__",this),this._intensity.addInterest("set_on__",this),this.set_on__()},set_on__:function(){this._on.getValue()&&this.getIntensity()>0?(delete this.push,delete this.pop):(this.push=Function.prototype,this.pop=Function.prototype)},getGlobal:function(){return this._global.getValue()},getColor:function(){return this._color.getValue()},getIntensity:function(){return Math.max(this._intensity.getValue(),0)},getAmbientIntensity:function(){return n.clamp(this._ambientIntensity.getValue(),0,1)},getDirection:function(){return this._direction.getValue()},getShadows:function(){return this._shadows.getValue()},getShadowColor:function(){return this._shadowColor.getValue()},getShadowIntensity:function(){return this.getShadows()?n.clamp(this._shadowIntensity.getValue(),0,1):0},getShadowBias:function(){return n.clamp(this._shadowBias.getValue(),0,1)},getShadowMapSize:function(){return Math.min(this._shadowMapSize.getValue(),this.getBrowser().getMaxTextureSize())},getBiasMatrix:function(){const t=new i(.5,0,0,0,0,.5,0,0,0,0,.5,0,.5,.5,.5,1);return function(){return t}}(),push:function(t,e){if(t.isIndependent()){const i=this.getLights().pop();this._global.getValue()?(i.set(this.getBrowser(),this,t.getLayer().getGroup(),t.getModelViewMatrix().get()),t.getGlobalObjects().push(i),t.getLights().push(i)):(i.set(this.getBrowser(),this,e,t.getModelViewMatrix().get()),t.getLocalObjects().push(i),t.getLights().push(i))}else{const e=t.getLightContainer();this._global.getValue()?(e.getModelViewMatrix().pushMatrix(t.getModelViewMatrix().get()),t.getGlobalObjects().push(e),t.getLights().push(e)):(e.getModelViewMatrix().pushMatrix(t.getModelViewMatrix().get()),t.getLocalObjects().push(e),t.getLights().push(e))}t.pushShadows(!!this.getShadowIntensity())},pop:function(t){this._global.getValue()||(t.isIndependent()?this.getBrowser().getLocalObjects().push(t.getLocalObjects().pop()):t.getLocalObjects().pop(),t.popShadows())}}),r})),define("x_ite/Components/Lighting/DirectionalLight",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Lighting/X3DLightNode","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Rendering/TraverseType","x_ite/Base/X3DConstants","standard/Math/Geometry/Box3","standard/Math/Geometry/Camera","standard/Math/Geometry/ViewVolume","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Utility/MatrixStack","standard/Utility/ObjectCache"],(function(t,e,i,n,r,s,o,a,u,l,c,h,d,p,f,g){"use strict";const m=g(_);function _(){this.direction=new c(0,0,0),this.shadowBuffer=null,this.bbox=new a,this.viewVolume=new l,this.viewport=new h(0,0,0,0),this.projectionMatrix=new p,this.modelViewMatrix=new f(p),this.modelMatrix=new p,this.invLightSpaceMatrix=new p,this.invLightSpaceProjectionMatrix=new p,this.shadowMatrix=new p,this.shadowMatrixArray=new Float32Array(16),this.rotation=new d,this.textureUnit=void 0}function y(t){n.call(this,t),this.addType(o.DirectionalLight),"2.0"===t.getSpecificationVersion()&&(this._global=!0)}return _.prototype={constructor:_,getModelViewMatrix:function(){return this.modelViewMatrix},set:function(t,e,i,n){const r=e.getShadowMapSize();this.browser=t,this.lightNode=e,this.groupNode=i,this.modelViewMatrix.pushMatrix(n),e.getShadowIntensity()>0&&r>0&&(this.shadowBuffer=t.popShadowBuffer(r),this.shadowBuffer||console.warn("Couldn't create shadow buffer."))},renderShadowMap:function(t){if(!this.shadowBuffer)return;const e=this.lightNode,i=t.getCameraSpaceMatrix().get(),n=this.modelMatrix.assign(this.modelViewMatrix.get()).multRight(i),o=this.invLightSpaceMatrix.assign(e.getGlobal()?n:p.Identity);o.rotate(this.rotation.setFromToVec(c.zAxis,this.direction.assign(e.getDirection()).negate())),o.inverse();const a=this.groupNode.getSubBBox(this.bbox,!0).multRight(o),l=e.getShadowMapSize(),h=this.viewport.set(0,0,l,l),d=u.orthoBox(a,this.projectionMatrix);this.shadowBuffer.bind(),t.getViewVolumes().push(this.viewVolume.set(d,h,h)),t.getProjectionMatrix().pushMatrix(d),t.getModelViewMatrix().pushMatrix(o),t.render(s.SHADOW,r.prototype.traverse,this.groupNode),t.getModelViewMatrix().pop(),t.getProjectionMatrix().pop(),t.getViewVolumes().pop(),this.shadowBuffer.unbind(),e.getGlobal()||o.multLeft(n.inverse()),this.invLightSpaceProjectionMatrix.assign(o).multRight(d).multRight(e.getBiasMatrix())},setGlobalVariables:function(t){this.modelViewMatrix.get().multDirMatrix(this.direction.assign(this.lightNode.getDirection())).normalize(),this.shadowMatrix.assign(t.getCameraSpaceMatrix().get()).multRight(this.invLightSpaceProjectionMatrix),this.shadowMatrixArray.set(this.shadowMatrix)},setShaderUniforms:function(t,e){const i=e.numLights++;if(e.hasLight(i,this))return;const n=this.lightNode,r=n.getColor(),s=this.direction;if(t.uniform1i(e.x3d_LightType[i],1),t.uniform3f(e.x3d_LightColor[i],r.r,r.g,r.b),t.uniform1f(e.x3d_LightIntensity[i],n.getIntensity()),t.uniform1f(e.x3d_LightAmbientIntensity[i],n.getAmbientIntensity()),t.uniform3f(e.x3d_LightDirection[i],s.x,s.y,s.z),this.shadowBuffer){const r=this.browser,s=n.getShadowColor();t.uniform3f(e.x3d_ShadowColor[i],s.r,s.g,s.b),t.uniform1f(e.x3d_ShadowIntensity[i],n.getShadowIntensity()),t.uniform1f(e.x3d_ShadowBias[i],n.getShadowBias()),t.uniformMatrix4fv(e.x3d_ShadowMatrix[i],!1,this.shadowMatrixArray),t.uniform1i(e.x3d_ShadowMapSize[i],n.getShadowMapSize()),this.textureUnit=n.getGlobal()?void 0===this.textureUnit?r.popTexture2DUnit():this.textureUnit:r.getTexture2DUnit(),void 0!==this.textureUnit?(t.activeTexture(t.TEXTURE0+this.textureUnit),t.getVersion()>=2||t.getExtension("WEBGL_depth_texture")?t.bindTexture(t.TEXTURE_2D,this.shadowBuffer.getDepthTexture()):t.bindTexture(t.TEXTURE_2D,this.shadowBuffer.getColorTexture()),t.uniform1i(e.x3d_ShadowMap[i],this.textureUnit)):console.warn("Not enough combined texture units for shadow map available.")}},dispose:function(){this.browser.pushShadowBuffer(this.shadowBuffer),this.lightNode.getGlobal()&&this.browser.pushTexture2DUnit(this.textureUnit),this.modelViewMatrix.clear(),this.browser=null,this.lightNode=null,this.groupNode=null,this.shadowBuffer=null,this.textureUnit=void 0,m.push(this)}},y.prototype=Object.assign(Object.create(n.prototype),{constructor:y,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.inputOutput,"global",new t.SFBool(!1)),new e(o.inputOutput,"on",new t.SFBool(!0)),new e(o.inputOutput,"color",new t.SFColor(1,1,1)),new e(o.inputOutput,"intensity",new t.SFFloat(1)),new e(o.inputOutput,"ambientIntensity",new t.SFFloat),new e(o.inputOutput,"direction",new t.SFVec3f(0,0,-1)),new e(o.inputOutput,"shadows",new t.SFBool),new e(o.inputOutput,"shadowColor",new t.SFColor),new e(o.inputOutput,"shadowIntensity",new t.SFFloat(1)),new e(o.inputOutput,"shadowBias",new t.SFFloat(.005)),new e(o.initializeOnly,"shadowMapSize",new t.SFInt32(1024))]),getTypeName:function(){return"DirectionalLight"},getComponentName:function(){return"Lighting"},getContainerField:function(){return"children"},getLights:function(){return m}}),y})),define("x_ite/Browser/Navigation/X3DNavigationContext",["x_ite/Fields","x_ite/Browser/Navigation/ExamineViewer","x_ite/Browser/Navigation/WalkViewer","x_ite/Browser/Navigation/FlyViewer","x_ite/Browser/Navigation/PlaneViewer","x_ite/Browser/Navigation/NoneViewer","x_ite/Browser/Navigation/LookAtViewer","x_ite/Components/Lighting/DirectionalLight","standard/Math/Numbers/Matrix4"],(function(t,e,i,n,r,s,o,a,u){"use strict";const l=Symbol(),c=Symbol(),h=Symbol();function d(){this.addChildObjects("activeLayer",new t.SFNode,"activeNavigationInfo",new t.SFNode,"activeViewpoint",new t.SFNode,"availableViewers",new t.MFString,"viewer",new t.SFString("EXAMINE")),this[l]=new Set,this[c]=new s(this)}return d.prototype={initialize:function(){this._viewer.addInterest("set_viewer__",this),this.initialized().addInterest("set_world__",this),this.shutdown().addInterest("remove_world__",this),this[h]=function(t){const e=new a(t.getPrivateScene());e.setup();const i=e.getLights().pop();return i.set(t,e,null,u.Identity),i.dispose=Function.prototype,i}(this),this[c].setup()},getHeadlight:function(){return this[h]},getActiveLayer:function(){return this._activeLayer.getValue()},getActiveNavigationInfo:function(){return this._activeNavigationInfo.getValue()},getActiveViewpoint:function(){return this._activeViewpoint.getValue()},getCurrentViewer:function(){return this._viewer.getValue()},getViewer:function(){return this[c]},addCollision:function(t){this[l].add(t)},removeCollision:function(t){this[l].delete(t)},getCollisionCount:function(){return this[l].size},remove_world__:function(){this.getWorld()._activeLayer.removeInterest("set_activeLayer__",this)},set_world__:function(){this.getWorld()._activeLayer.addInterest("set_activeLayer__",this),this.set_activeLayer__()},set_activeLayer__:function(){this._activeLayer.getValue()&&(this._activeLayer.getValue().getNavigationInfoStack().removeInterest("set_activeNavigationInfo__",this),this._activeLayer.getValue().getViewpointStack().removeInterest("set_activeViewpoint__",this)),this._activeLayer=this.getWorld().getActiveLayer(),this._activeLayer.getValue()&&(this._activeLayer.getValue().getNavigationInfoStack().addInterest("set_activeNavigationInfo__",this),this._activeLayer.getValue().getViewpointStack().addInterest("set_activeViewpoint__",this)),this.set_activeNavigationInfo__(),this.set_activeViewpoint__()},set_activeNavigationInfo__:function(){this._activeNavigationInfo.getValue()&&this._activeNavigationInfo.getValue()._viewer.removeFieldInterest(this._viewer),this._activeLayer.getValue()?(this._activeNavigationInfo=this._activeLayer.getValue().getNavigationInfo(),this._activeNavigationInfo.getValue()._viewer.addFieldInterest(this._viewer),this._viewer=this._activeNavigationInfo.getValue()._viewer):(this._activeNavigationInfo=null,this._viewer="NONE")},set_activeViewpoint__:function(){this._activeLayer.getValue()?this._activeViewpoint=this._activeLayer.getValue().getViewpoint():this._activeViewpoint=null},set_viewer__:function(t){switch(this._activeNavigationInfo.getValue()?this._availableViewers=this._activeNavigationInfo.getValue()._availableViewers:this._availableViewers.length=0,this[c]&&this[c].dispose(),t.getValue()){case"EXAMINE":default:this[c]=new e(this);break;case"WALK":this[c]=new i(this);break;case"FLY":this[c]=new n(this);break;case"PLANE":case"PLANE_create3000.de":this[c]=new r(this);break;case"NONE":this[c]=new s(this);break;case"LOOKAT":this[c]=new o(this)}this[c].setup()}},d})),define("x_ite/Components/Layering/Viewport",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Layering/X3DViewportNode","x_ite/Base/X3DConstants","x_ite/Rendering/TraverseType","standard/Utility/ObjectCache","standard/Math/Geometry/ViewVolume","standard/Math/Numbers/Vector4"],(function(t,e,i,n,r,s,o,a,u){"use strict";const l=o(a);function c(t){n.call(this,t),this.addType(r.Viewport),this.rectangle=new u(0,0,0,0)}return c.prototype=Object.assign(Object.create(n.prototype),{constructor:c,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"clipBoundary",new t.MFFloat(0,1,0,1)),new e(r.inputOutput,"visible",new t.SFBool(!0)),new e(r.inputOutput,"bboxDisplay",new t.SFBool),new e(r.initializeOnly,"bboxSize",new t.SFVec3f(-1,-1,-1)),new e(r.initializeOnly,"bboxCenter",new t.SFVec3f),new e(r.inputOnly,"addChildren",new t.MFNode),new e(r.inputOnly,"removeChildren",new t.MFNode),new e(r.inputOutput,"children",new t.MFNode)]),getTypeName:function(){return"Viewport"},getComponentName:function(){return"Layering"},getContainerField:function(){return"viewport"},getRectangle:function(t){const e=t.getViewport(),i=Math.floor(e[2]*this.getLeft()),n=Math.floor(e[2]*this.getRight()),r=Math.floor(e[3]*this.getBottom()),s=Math.floor(e[3]*this.getTop());return this.rectangle.set(i,r,Math.max(0,n-i),Math.max(0,s-r)),this.rectangle},getLeft:function(){return this._clipBoundary.length>0?this._clipBoundary[0]:0},getRight:function(){return this._clipBoundary.length>1?this._clipBoundary[1]:1},getBottom:function(){return this._clipBoundary.length>2?this._clipBoundary[2]:0},getTop:function(){return this._clipBoundary.length>3?this._clipBoundary[3]:1},traverse:function(t,e){if(this.push(e),t===s.POINTER)this.getBrowser().isPointerInRectangle(this.rectangle)&&n.prototype.traverse.call(this,t,e);else n.prototype.traverse.call(this,t,e);this.pop(e)},push:function(t){const e=t.getViewVolumes(),i=this.getRectangle(this.getBrowser()),n=e.length?e.at(-1).getViewport():i,r=l.pop();r.set(t.getProjectionMatrix().get(),n,i),e.push(r)},pop:function(t){l.push(t.getViewVolumes().pop())}}),c})),define("x_ite/Browser/Layering/X3DLayeringContext",["x_ite/Components/Layering/Viewport"],(function(t){"use strict";const e=Symbol();function i(){this[e]=new t(this.getPrivateScene())}return i.prototype={initialize:function(){this[e].setup()},getDefaultViewport:function(){return this[e]}},i})),define("x_ite/Browser/EnvironmentalEffects/X3DEnvironmentalEffectsContext",["x_ite/Components/Texturing/TextureProperties"],(function(t){"use strict";const e=Symbol();function i(){}return i.prototype={initialize:function(){},getBackgroundTextureProperties:function(){return this[e]=new t(this.getPrivateScene()),this[e]._boundaryModeS="CLAMP_TO_EDGE",this[e]._boundaryModeT="CLAMP_TO_EDGE",this[e]._boundaryModeR="CLAMP_TO_EDGE",this[e]._minificationFilter="NICEST",this[e]._magnificationFilter="NICEST",this[e].setup(),this.getBackgroundTextureProperties=function(){return this[e]},Object.defineProperty(this,"getBackgroundTextureProperties",{enumerable:!1}),this[e]}},i})),define("x_ite/Browser/Lighting/X3DLightingContext",["x_ite/Rendering/TextureBuffer"],(function(t){"use strict";const e=Symbol(),i=Symbol();function n(){const t=this.getContext(),n=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS);this[e]=n>16?8:n>8?4:2,this[i]=[]}return n.prototype={initialize:function(){},getMaxLights:function(){return this[e]},popShadowBuffer:function(e){try{const n=this[i][e];if(n){if(n.length)return n.pop()}else this[i][e]=[];return new t(this,e,e)}catch(t){return console.error(t),null}},pushShadowBuffer:function(t){t&&this[i][t.getWidth()].push(t)}},n})),define("x_ite/Browser/Picking/X3DPickingContext",["x_ite/Rendering/TraverseType"],(function(t){"use strict";const e=Symbol(),i=Symbol(),n=Symbol(),r=Symbol(),s=Symbol();function o(){this[e]=new Set,this[i]=[new Set],this[n]=[],this[r]=[!1],this[s]=0}return o.prototype={initialize:function(){},addTransformSensor:function(t){this[e].add(t),this.enablePicking()},removeTransformSensor:function(t){this[e].delete(t),this.enablePicking()},addPickSensor:function(t){this[i][0].add(t),this.enablePicking()},removePickSensor:function(t){this[i][0].delete(t),this.enablePicking()},getPickSensors:function(){return this[i]},getPickingHierarchy:function(){return this[n]},getPickable:function(){return this[r]},enablePicking:function(){this[e].size||this[i][0].size?this._sensorEvents.addInterest("picking",this):this._sensorEvents.removeInterest("picking",this)},picking:function(){const n=performance.now();this.getWorld().traverse(t.PICKING,null);for(const t of this[e])t.process();for(const t of this[i][0])t.process();this[s]=performance.now()-n},getPickingTime:function(){return this[s]}},o})),define("x_ite/Browser/Sound/X3DSoundContext",["x_ite/Fields"],(function(t){"use strict";function e(){this.addChildObjects("volume",new t.SFFloat(1),"mute",new t.SFBool)}return e.prototype={initialize:function(){}},e})),define("x_ite/Browser/Text/TextAlignment",[],(function(){"use strict";let t=0;return{BEGIN:++t,FIRST:++t,MIDDLE:++t,END:++t}})),define("x_ite/Components/Text/X3DFontStyleNode",["x_ite/Fields","x_ite/Components/Core/X3DNode","x_ite/Components/Networking/X3DUrlObject","x_ite/Browser/Text/TextAlignment","x_ite/InputOutput/FileLoader","x_ite/Base/X3DConstants","x_ite/Browser/Networking/urls"],(function(t,e,i,n,r,s,o){"use strict";const a={SERIF:{PLAIN:o.getFontsUrl("DroidSerif-Regular.ttf"),ITALIC:o.getFontsUrl("DroidSerif-Italic.ttf"),BOLD:o.getFontsUrl("DroidSerif-Bold.ttf"),BOLDITALIC:o.getFontsUrl("DroidSerif-BoldItalic.ttf")},SANS:{PLAIN:o.getFontsUrl("Ubuntu-R.ttf"),ITALIC:o.getFontsUrl("Ubuntu-RI.ttf"),BOLD:o.getFontsUrl("Ubuntu-B.ttf"),BOLDITALIC:o.getFontsUrl("Ubuntu-BI.ttf")},TYPEWRITER:{PLAIN:o.getFontsUrl("UbuntuMono-R.ttf"),ITALIC:o.getFontsUrl("UbuntuMono-RI.ttf"),BOLD:o.getFontsUrl("UbuntuMono-B.ttf"),BOLDITALIC:o.getFontsUrl("UbuntuMono-BI.ttf")}};function u(n){e.call(this,n),i.call(this,n),this.addType(s.X3DFontStyleNode),this.addChildObjects("load",new t.SFBool(!0),"autoRefresh",new t.SFTime,"autoRefreshTimeLimit",new t.SFTime(3600)),this.addAlias("url",this._family),this.familyStack=[],this.alignments=[],this.loader=new r(this)}return u.prototype=Object.assign(Object.create(e.prototype),i.prototype,{constructor:u,initialize:function(){e.prototype.initialize.call(this),i.prototype.initialize.call(this),this._style.addInterest("set_style__",this),this._justify.addInterest("set_justify__",this),this.font=null,this.familyIndex=0,this.set_justify__(),this.set_style__(),this.requestImmediateLoad()},set_style__:function(){this._load.getValue()&&(this.setLoadState(s.NOT_STARTED_STATE),this.requestImmediateLoad())},set_justify__:function(){const t=this._horizontal.getValue()?this._leftToRight.getValue():this._topToBottom.getValue();this.alignments[0]=this._justify.length>0?this.getAlignment(0,t):t?n.BEGIN:n.END;const e=this._horizontal.getValue()?this._topToBottom.getValue():this._leftToRight.getValue();this.alignments[1]=this._justify.length>1?this.getAlignment(1,e):e?n.FIRST:n.END},getMajorAlignment:function(){return this.alignments[0]},getMinorAlignment:function(){return this.alignments[1]},getAlignment:function(t,e){if(e)switch(this._justify[t]){case"FIRST":return n.FIRST;case"BEGIN":return n.BEGIN;case"MIDDLE":return n.MIDDLE;case"END":return n.END}else switch(this._justify[t]){case"FIRST":case"BEGIN":return n.END;case"MIDDLE":return n.MIDDLE;case"END":return n.BEGIN}return t?n.FIRST:n.BEGIN},getDefaultFont:function(t){const e=a[t];if(e)return e[this._style.getValue()]||e.PLAIN},loadNow:function(){const t=this._url.copy();t.push("SERIF"),this.familyStack.length=0;for(const e of t)this.familyStack.push(this.getDefaultFont(e)||e);this.loadNext()},loadNext:function(){try{if(0===this.familyStack.length)return this.setLoadState(s.FAILED_STATE),void(this.font=null);this.family=this.familyStack.shift(),this.URL=new URL(this.family,this.loader.getReferer()),"data:"!==this.URL.protocol&&(this.getBrowser().getBrowserOptions().getCache()&&this.getCache()||this.URL.searchParams.set("_",Date.now())),this.getBrowser().getFont(this.URL).done(this.setFont.bind(this)).fail(this.setError.bind(this))}catch(t){this.setError(t.message)}},setError:function(t){"data:"!==this.URL.protocol&&console.warn("Error loading font '"+decodeURI(this.URL.href)+"':",t),this.loadNext()},setFont:function(t){this.font=t,this.setLoadState(s.COMPLETE_STATE),this.addNodeEvent()},getFont:function(){return this.font}}),u})),define("standard/Math/Geometry/Box2",["standard/Math/Numbers/Matrix3","standard/Math/Numbers/Vector2"],(function(t,e){"use strict";function i(e,i){switch(arguments.length){case 0:return void(this.matrix=new t(0,0,0,0,0,0,0,0,0));case 2:return void(this.matrix=new t(e.x/2,0,0,0,e.y/2,0,i.x,i.y,1));case 3:{const e=arguments[0],i=arguments[1],n=(i.x-e.x)/2,r=(i.y-e.y)/2,s=(i.x+e.x)/2,o=(i.y+e.y)/2;return void(this.matrix=new t(n,0,0,0,r,0,s,o,1))}}}return i.prototype={constructor:i,copy:function(){const t=Object.create(i.prototype);return t.matrix=this.matrix.copy(),t},assign:function(t){return this.matrix.assign(t.matrix),this},equals:function(t){return this.matrix.equals(t.matrix)},set:function(t,e){const i=this.matrix;switch(arguments.length){case 0:return i[0]=.5,i[1]=0,i[2]=0,i[3]=0,i[4]=.5,i[5]=0,i[6]=0,i[7]=0,i[8]=0,this;case 2:return i[0]=t.x/2,i[1]=0,i[2]=0,i[3]=0,i[4]=t.y/2,i[5]=0,i[6]=e.x,i[7]=e.y,i[8]=1,this;case 3:{const t=arguments[0],e=arguments[1],i=(e.x-t.x)/2,n=(e.y-t.y)/2,r=(e.x+t.x)/2,s=(e.y+t.y)/2;return this.matrix.set(i,0,0,0,n,0,r,s,1),this}}},setExtents:function(t,e){const i=this.matrix,n=(e.x-t.x)/2,r=(e.y-t.y)/2,s=(e.x+t.x)/2,o=(e.y+t.y)/2;return i[0]=n,i[1]=0,i[2]=0,i[3]=0,i[4]=r,i[5]=0,i[6]=s,i[7]=o,i[8]=1,this},isEmpty:function(){return 0===this.matrix[8]},add:function(){const t=new e(0,0),i=new e(0,0),n=new e(0,0),r=new e(0,0);return function(e){return this.isEmpty()?this.assign(e):e.isEmpty()?this:(this.getExtents(t,i),e.getExtents(n,r),this.set(t.min(n),i.max(r),!0))}}(),multLeft:function(t){return this.matrix.multLeft(t),this},multRight:function(t){return this.matrix.multRight(t),this},getExtents:function(t,e){this.getAbsoluteExtents(t,e),t.add(this.center),e.add(this.center)},getAbsoluteExtents:function(){const t=new e(0,0);return function(e,i){const n=this.matrix,r=n.xAxis,s=n.yAxis;t.assign(r).add(s);const o=s.subtract(r);e.assign(t).min(o),i.assign(t).max(o),t.negate(),o.negate(),e.min(t,o),i.max(t,o)}}(),containsPoint:function(){const t=new e(0,0),i=new e(0,0);return function(e){return this.getExtents(t,i),t.x<=e.x&&i.x>=e.x&&t.y<=e.y&&i.y>=e.y}}(),toString:function(){return this.size+", "+this.center}},Object.defineProperty(i.prototype,"size",{get:function(){const t=new e(0,0),i=new e(0,0);return function(){return this.getAbsoluteExtents(t,i),i.subtract(t)}}(),enumerable:!0,configurable:!1}),Object.defineProperty(i.prototype,"center",{get:function(){return this.matrix.origin},enumerable:!0,configurable:!1}),i})),define("x_ite/Browser/Text/X3DTextGeometry",["x_ite/Browser/Text/TextAlignment","standard/Math/Geometry/Box2","standard/Math/Geometry/Box3","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3"],(function(t,e,i,n,r){"use strict";var s=new e,o=new e,a=new n(0,0),u=new n(0,0),l=new n(0,0),c=new n(0,0),h=new r(0,0,0),d=new r(0,0,0),p=new n(0,0),f=new n(0,0),g=new n(0,0),m=new n(0,0),_=new n(0,0),y=new r(0,0,0),x=new n(0,0),w=new e,b=new n(0,0),v=new r(0,0,0);function S(t,e){this.browser=t.getBrowser(),this.text=t,this.fontStyle=e,this.glyphs=[],this.minorAlignment=new n(0,0),this.translations=[],this.charSpacings=[],this.bearing=new n(0,0),this.yPad=[],this.bbox=new i}return S.prototype={constructor:S,getBrowser:function(){return this.browser},getText:function(){return this.text},getFontStyle:function(){return this.fontStyle},getGlyphs:function(){return this.glyphs},getMinorAlignment:function(){return this.minorAlignment},getTranslations:function(){return this.translations},getCharSpacings:function(){return this.charSpacings},getBearing:function(){return this.bearing},getBBox:function(){return this.bbox},update:function(){var t=this.text,e=this.fontStyle,i=t._string.length;if(t._lineBounds.length=i,this.glyphs.length=0,0===i||!e.getFont())return t._origin.setValue(v),t._textBounds.setValue(b),void this.bbox.set();if(e._horizontal.getValue())this.resizeArray(this.translations,i),this.resizeArray(this.charSpacings,i),this.horizontal(t,e);else{for(var n=t._string,r=0,s=0,o=n.length;s<o;++s)r+=n[s].length;this.resizeArray(this.translations,r),this.resizeArray(this.charSpacings,r),this.vertical(t,e)}},resizeArray:function(t,e){for(var i=t.length;i<e;++i)t.push(new n(0,0));t.length=e},horizontal:function(e,i){var n=i.getFont(),r=e._string,o=r.length,l=Math.max(0,e._maxExtent.getValue()),c=i._topToBottom.getValue(),m=i.getScale(),x=i._spacing.getValue();s.set();for(var b=c?o:-1,v=c?1:-1,S=c?0:o-1,T=0;S!==b;S+=v,++T){var C=r[S],O=this.getHorizontalLineExtents(i,C,a,u,T);p.assign(u).subtract(a);var N=0,F=e.getLength(S);switch(_.set(p.x*m,0==T?u.y-n.descender/n.unitsPerEm*m:x),l&&(F=F?Math.min(l,F):Math.min(l,p.x*m)),F&&(N=(F-_.x)/(O.length-1),_.x=F,p.x=F/m),this.charSpacings[T]=N,e._lineBounds[S]=_,i.getMajorAlignment()){case t.BEGIN:case t.FIRST:this.translations[T].set(0,-T*x);break;case t.MIDDLE:this.translations[T].set(-a.x-p.x/2,-T*x);break;case t.END:this.translations[T].set(-a.x-p.x,-T*x)}this.translations[T].multiply(m),f.assign(a).add(g.assign(p).divide(2)),s.add(w.set(p.multiply(m),f.multiply(m).add(this.translations[T])))}switch(s.getExtents(a,u),p.assign(u).subtract(a),e._textBounds=p,this.bearing.set(0,-u.y),i.getMinorAlignment()){case t.BEGIN:this.minorAlignment.assign(this.bearing);break;case t.FIRST:this.minorAlignment.set(0,0);break;case t.MIDDLE:this.minorAlignment.set(0,p.y/2-u.y);break;case t.END:this.minorAlignment.set(0,(o-1)*x*m)}a.add(this.minorAlignment),u.add(this.minorAlignment),e._origin.setValue(y.set(a.x,u.y,0)),this.bbox.setExtents(h.set(a.x,a.y,0),d.set(u.x,u.y,0))},vertical:function(e,i){var r=i.getFont(),c=e._string,b=c.length,v=Math.max(0,e._maxExtent.getValue()),S=i._leftToRight.getValue(),T=i._topToBottom.getValue(),C=i.getScale(),O=i._spacing.getValue(),N=this.yPad,F=this.getBrowser().getBrowserOptions().getPrimitiveQuality();s.set();for(var E=S?b:-1,D=S?1:-1,M=0,I=S?0:b-1;I!==E;I+=D){var V=this.stringToGlyphs(r,c[I],!0,I),B=M,A=V.length;o.set();for(var R=T?A:-1,P=T?1:-1,L=T?0:A-1;L!==R;L+=P,++M){var U=V[L];this.getGlyphExtents(r,U,F,a,u),p.assign(u).subtract(a);var k=T?L:A-L-1;this.translations[M].set((O-p.x-a.x)/2,-k),f.assign(a).add(g.assign(p).divide(2)).add(this.translations[M]),o.add(w.set(p,f))}o.getExtents(a,u),p.assign(u).subtract(a);var X=S?I:b-I-1,z=(O-p.x)/2,j=0,G=e.getLength(I);switch(_.set(0===I?O-z:O,A?p.y:0).multiply(C),v&&(G=G?Math.min(v,G):Math.min(v,p.y*C)),G&&(j=(G-_.y)/(V.length-1)/C,_.y=G,p.y=G/C,a.y=u.y-p.y),e._lineBounds[I]=_,i.getMajorAlignment()){case t.BEGIN:case t.FIRST:m.set(X*O,-1);break;case t.MIDDLE:m.set(X*O,p.y/2-u.y);break;case t.END:A&&this.getGlyphExtents(r,V[T?A-1:0],F,l.assign(n.Zero),x),m.set(X*O,p.y-u.y+l.y)}for(var q=0,H=B;H<M;++H)this.translations[H].add(m),this.translations[H].y-=q,this.translations[H].multiply(C),q+=j;switch(i.getMajorAlignment()){case t.BEGIN:case t.FIRST:N[I]=u.y+m.y;break;case t.MIDDLE:N[I]=0;break;case t.END:N[I]=a.y+m.y}f.assign(a).add(g.assign(p).divide(2)),s.add(w.set(p.multiply(C),f.add(m).multiply(C)))}switch(s.getExtents(a,u),p.assign(u).subtract(a),i.getMajorAlignment()){case t.BEGIN:case t.FIRST:var W=0;for(G=(Y=e._lineBounds).length;W<G;++W)Y[W].y+=u.y-N[W]*C;break;case t.MIDDLE:break;case t.END:var Y;for(W=0,G=(Y=e._lineBounds).length;W<G;++W)Y[W].y+=N[W]*C-a.y}switch(e._textBounds=p,i.getMajorAlignment()){case t.BEGIN:case t.FIRST:this.bearing.set(-a.x,u.y);break;case t.MIDDLE:this.bearing.set(-a.x,0);break;case t.END:this.bearing.set(-a.x,a.y)}switch(i.getMinorAlignment()){case t.BEGIN:case t.FIRST:this.minorAlignment.set(-a.x,0);break;case t.MIDDLE:this.minorAlignment.set(-a.x-p.x/2,0);break;case t.END:this.minorAlignment.set(-a.x-p.x,0)}a.add(this.minorAlignment),u.add(this.minorAlignment),e._origin.setValue(y.set(a.x,u.y,0)),this.bbox.set(h.set(a.x,a.y,0),d.set(u.x,u.y,0),!0)},stringToGlyphs:function(t,e,i,n){var r=this.glyphs[n];r||(r=this.glyphs[n]=[]),r.length=e.length;for(var s=i?0:e.length-1,o=i?e.length:-1,a=i?1:-1,u=s,l=0;u!==o;u+=a,++l)r[l]=t.charToGlyph(e[u]);return r},getHorizontalLineExtents:function(e,i,n,r,s){for(var o=e.getFont(),a=e._horizontal.getValue()?e._leftToRight.getValue():e._topToBottom.getValue(),u=this.stringToGlyphs(o,i,a,s),h=this.getBrowser().getBrowserOptions().getPrimitiveQuality(),d=0,p=0,f=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY,m=0,_=u.length;m<_;++m){var y=u[m],x=m+1<_?o.getKerningValue(y,u[m+1]):0;this.getGlyphExtents(o,y,h,l,c),p+=y.advanceWidth+x,f=Math.min(f,l.y),g=Math.max(g,c.y)}switch(u.length?(this.getGlyphExtents(o,u[0],h,l,c),d=l.x):(f=0,g=0),n.set(d,f),r.set(p/o.unitsPerEm,g),e.getMajorAlignment()){case t.BEGIN:case t.FIRST:n.x=0}return u},traverse:function(t,e){}},S})),define("standard/Math/Algorithms/Bezier",["standard/Math/Algorithm"],(function(t){"use strict";const e=t.lerp;function i(t,e,i,n,r,s,o,a){this.x0=t,this.y0=e,this.x1=i,this.y1=n,this.x2=r,this.y2=s,this.x3=o,this.y3=a,this.order=arguments.length/2-1}function n(t,i,n,r,s,o,a){const u=e(t,n,a),l=e(i,r,a),c=e(n,s,a),h=e(r,o,a);return{x:e(u,c,a),y:e(l,h,a)}}function r(t,i,n,r,s,o,a,u,l){const c=e(t,n,l),h=e(i,r,l),d=e(n,s,l),p=e(r,o,l),f=e(s,a,l),g=e(o,u,l),m=e(c,d,l),_=e(h,p,l),y=e(d,f,l),x=e(p,g,l);return{x:e(m,y,l),y:e(_,x,l)}}return i.prototype={getLUT:function(t){const e=this.x0,i=this.y0,s=this.x1,o=this.y1,a=this.x2,u=this.y2,l=this.x3,c=this.y3,h=[];switch(this.order){case 2:for(let r=0,l=t-1;r<t;++r)h.push(n(e,i,s,o,a,u,r/l));break;case 3:for(let n=0,d=t-1;n<t;++n)h.push(r(e,i,s,o,a,u,l,c,n/d))}return h}},i})),define("x_ite/Browser/Text/PolygonText",["x_ite/Browser/Core/PrimitiveQuality","x_ite/Browser/Text/X3DTextGeometry","x_ite/Components/Rendering/X3DGeometryNode","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Triangle3","standard/Math/Algorithms/Bezier"],(function(t,e,i,n,r,s,o){"use strict";function a(t,n){e.call(this,t,n),t._transparent=!1,this.texCoordArray=i.createArray()}var u,l,c,h,d;return a.prototype=Object.assign(Object.create(e.prototype),{constructor:a,getTransparent:function(){return!1},getMatrix:function(){return r.Identity},build:(h=new n(0,0,0),d=new n(0,0,0),function(){var t=this.getFontStyle(),e=t.getFont();if(e){var i=this.getText(),n=this.getGlyphs(),r=this.getMinorAlignment(),s=this.getTranslations(),o=this.getCharSpacings(),a=t.getScale(),u=t._spacing.getValue(),l=i._origin.getValue(),c=a/e.unitsPerEm,p=this.getBrowser().getBrowserOptions().getPrimitiveQuality(),f=this.texCoordArray,g=i.getNormals(),m=i.getVertices();if(i.getMultiTexCoords().push(f),this.getBBox().getExtents(h,d),i.getMin().assign(h),i.getMax().assign(d),t._horizontal.getValue())for(var _=0,y=n.length;_<y;++_)for(var x=n[_],w=o[_],b=s[_],v=0,S=0,T=x.length;S<T;++S){for(var C=x[S],O=this.getGlyphGeometry(e,C,p),N=r.x+b.x+v+S*w,F=r.y+b.y,E=0,D=O.length;E<D;++E){var M=O[E].x*a+N,I=O[E].y*a+F;f.push((M-l.x)/u,(I-l.y)/u,0,1),g.push(0,0,1),m.push(M,I,0,1)}var V=0;S+1<x.length&&(V=e.getKerningValue(C,x[S+1])),v+=(C.advanceWidth+V)*c}else for(var B=t._leftToRight.getValue(),A=t._topToBottom.getValue(),R=B?0:i._string.length-1,P=B?i._string.length:-1,L=B?1:-1,U=(_=R,0);_!==P;_+=L){var k=(x=n[_]).length,X=A?k:-1,z=A?1:-1;for(S=A?0:k-1;S!==X;S+=z,++U)for(b=s[U],E=0,D=(O=this.getGlyphGeometry(e,x[S],p)).length;E<D;++E)M=O[E].x*a+r.x+b.x,I=O[E].y*a+r.y+b.y,f.push((M-l.x)/u,(I-l.y)/u,0,1),g.push(0,0,1),m.push(M,I,0,1)}}}),getGlyphExtents:function(t,e,i,n,r){var s=this.getBrowser().getGlyph(t,i,e.index);if(o=s.extents)return n.assign(o.min),void r.assign(o.max);var o,a=this.getGlyphGeometry(t,e,i);if(a.length){var u=a[0];n.assign(u),r.assign(u);for(var l=1,c=a.length;l<c;++l){u=a[l];n.min(u),r.max(u)}}else n.set(0,0,0),r.set(0,0,0);(o=s.extents={}).min=n.copy(),o.max=r.copy()},getGlyphGeometry:function(t,e,i){var n=this.getBrowser().getGlyph(t,i,e.index),r=n.geometry;return r||(r=n.geometry=[],this.createGlyphGeometry(e,r,i),r)},createGlyphGeometry:(u=[],l=[],c=new n(0,0,0),function(t,e,i){var r=this.getBezierDimension(i),a=t.getPath(0,0,1).commands,h=0,d=0;u.length=0,l.length=0;for(var p=0,f=a.length;p<f;++p){var g=a[p];switch(g.type){case"M":case"Z":u.length>2&&(u[0].x===u.at(-1).x&&u[0].y===u.at(-1).y&&u.pop(),l.push(u)),u=[],"M"===g.type&&u.push(new n(g.x,-g.y,0));break;case"L":u.push(new n(g.x,-g.y,0));break;case"Q":for(var m=1,_=(y=new o(h,-d,g.x1,-g.y1,g.x,-g.y).getLUT(r)).length;m<_;++m)u.push(new n(y[m].x,y[m].y,0));break;case"C":var y;for(m=1,_=(y=new o(h,-d,g.x1,-g.y1,g.x2,-g.y2,g.x,-g.y).getLUT(r)).length;m<_;++m)u.push(new n(y[m].x,y[m].y,0));break;default:continue}h=g.x,d=g.y}l=l.map((function(t){return s.getPolygonNormal(t,c),c.dot(n.zAxis)>0?t:t.reverse()})),l.push(e),s.triangulatePolygon.apply(s,l)}),getBezierDimension:function(e){switch(e){case t.LOW:return 3;case t.HIGH:return 7;default:return 5}},display:function(t,e){},transformLine:function(t){},transformMatrix:function(t){}}),a})),define("x_ite/Components/Text/FontStyle",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Text/X3DFontStyleNode","x_ite/Browser/Text/PolygonText","x_ite/Base/X3DConstants"],(function(t,e,i,n,r,s){"use strict";function o(t){n.call(this,t),this.addType(s.FontStyle),this._size.setUnit("length")}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.inputOutput,"language",new t.SFString),new e(s.inputOutput,"family",new t.MFString("SERIF")),new e(s.inputOutput,"style",new t.SFString("PLAIN")),new e(s.inputOutput,"size",new t.SFFloat(1)),new e(s.inputOutput,"spacing",new t.SFFloat(1)),new e(s.inputOutput,"horizontal",new t.SFBool(!0)),new e(s.inputOutput,"leftToRight",new t.SFBool(!0)),new e(s.inputOutput,"topToBottom",new t.SFBool(!0)),new e(s.inputOutput,"justify",new t.MFString("BEGIN"))]),getTypeName:function(){return"FontStyle"},getComponentName:function(){return"Text"},getContainerField:function(){return"fontStyle"},getTextGeometry:function(t){return new r(t,this)},getScale:function(){return this._size.getValue()}}),o})),function(t,e){"object"==typeof exports&&void 0!==module?e(exports):"function"==typeof define&&define.amd?define("opentype/dist/opentype",["exports"],e):e((t=t||self).opentype={})}(this,(function(t){"use strict";
/*! https://mths.be/codepointat v0.2.0 by @mathias */var e,i;String.prototype.codePointAt||(e=function(){try{var t={},e=Object.defineProperty,i=e(t,t,t)&&e}catch(t){}return i}(),i=function(t){if(null==this)throw TypeError();var e=String(this),i=e.length,n=t?Number(t):0;if(n!=n&&(n=0),!(n<0||n>=i)){var r,s=e.charCodeAt(n);return s>=55296&&s<=56319&&i>n+1&&(r=e.charCodeAt(n+1))>=56320&&r<=57343?1024*(s-55296)+r-56320+65536:s}},e?e(String.prototype,"codePointAt",{value:i,configurable:!0,writable:!0}):String.prototype.codePointAt=i);function n(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}function r(t,e){this.source=t,this.sourceIndex=0,this.tag=0,this.bitcount=0,this.dest=e,this.destLen=0,this.ltree=new n,this.dtree=new n}var s=new n,o=new n,a=new Uint8Array(30),u=new Uint16Array(30),l=new Uint8Array(30),c=new Uint16Array(30),h=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),d=new n,p=new Uint8Array(320);function f(t,e,i,n){var r,s;for(r=0;r<i;++r)t[r]=0;for(r=0;r<30-i;++r)t[r+i]=r/i|0;for(s=n,r=0;r<30;++r)e[r]=s,s+=1<<t[r]}var g=new Uint16Array(16);function m(t,e,i,n){var r,s;for(r=0;r<16;++r)t.table[r]=0;for(r=0;r<n;++r)t.table[e[i+r]]++;for(t.table[0]=0,s=0,r=0;r<16;++r)g[r]=s,s+=t.table[r];for(r=0;r<n;++r)e[i+r]&&(t.trans[g[e[i+r]]++]=r)}function _(t){t.bitcount--||(t.tag=t.source[t.sourceIndex++],t.bitcount=7);var e=1&t.tag;return t.tag>>>=1,e}function y(t,e,i){if(!e)return i;for(;t.bitcount<24;)t.tag|=t.source[t.sourceIndex++]<<t.bitcount,t.bitcount+=8;var n=t.tag&65535>>>16-e;return t.tag>>>=e,t.bitcount-=e,n+i}function x(t,e){for(;t.bitcount<24;)t.tag|=t.source[t.sourceIndex++]<<t.bitcount,t.bitcount+=8;var i=0,n=0,r=0,s=t.tag;do{n=2*n+(1&s),s>>>=1,++r,i+=e.table[r],n-=e.table[r]}while(n>=0);return t.tag=s,t.bitcount-=r,e.trans[i+n]}function w(t,e,i){var n,r,s,o,a,u;for(n=y(t,5,257),r=y(t,5,1),s=y(t,4,4),o=0;o<19;++o)p[o]=0;for(o=0;o<s;++o){var l=y(t,3,0);p[h[o]]=l}for(m(d,p,0,19),a=0;a<n+r;){var c=x(t,d);switch(c){case 16:var f=p[a-1];for(u=y(t,2,3);u;--u)p[a++]=f;break;case 17:for(u=y(t,3,3);u;--u)p[a++]=0;break;case 18:for(u=y(t,7,11);u;--u)p[a++]=0;break;default:p[a++]=c}}m(e,p,0,n),m(i,p,n,r)}function b(t,e,i){for(;;){var n,r,s,o,h=x(t,e);if(256===h)return 0;if(h<256)t.dest[t.destLen++]=h;else for(n=y(t,a[h-=257],u[h]),r=x(t,i),o=s=t.destLen-y(t,l[r],c[r]);o<s+n;++o)t.dest[t.destLen++]=t.dest[o]}}function v(t){for(var e,i;t.bitcount>8;)t.sourceIndex--,t.bitcount-=8;if((e=256*(e=t.source[t.sourceIndex+1])+t.source[t.sourceIndex])!==(65535&~(256*t.source[t.sourceIndex+3]+t.source[t.sourceIndex+2])))return-3;for(t.sourceIndex+=4,i=e;i;--i)t.dest[t.destLen++]=t.source[t.sourceIndex++];return t.bitcount=0,0}!function(t,e){var i;for(i=0;i<7;++i)t.table[i]=0;for(t.table[7]=24,t.table[8]=152,t.table[9]=112,i=0;i<24;++i)t.trans[i]=256+i;for(i=0;i<144;++i)t.trans[24+i]=i;for(i=0;i<8;++i)t.trans[168+i]=280+i;for(i=0;i<112;++i)t.trans[176+i]=144+i;for(i=0;i<5;++i)e.table[i]=0;for(e.table[5]=32,i=0;i<32;++i)e.trans[i]=i}(s,o),f(a,u,4,3),f(l,c,2,1),a[28]=0,u[28]=258;var S=function(t,e){var i,n,a=new r(t,e);do{switch(i=_(a),y(a,2,0)){case 0:n=v(a);break;case 1:n=b(a,s,o);break;case 2:w(a,a.ltree,a.dtree),n=b(a,a.ltree,a.dtree);break;default:n=-3}if(0!==n)throw new Error("Data error")}while(!i);return a.destLen<a.dest.length?"function"==typeof a.dest.slice?a.dest.slice(0,a.destLen):a.dest.subarray(0,a.destLen):a.dest};function T(t,e,i,n,r){return Math.pow(1-r,3)*t+3*Math.pow(1-r,2)*r*e+3*(1-r)*Math.pow(r,2)*i+Math.pow(r,3)*n}function C(){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN}function O(){this.commands=[],this.fill="black",this.stroke=null,this.strokeWidth=1}function N(t){throw new Error(t)}function F(t,e){t||N(e)}C.prototype.isEmpty=function(){return isNaN(this.x1)||isNaN(this.y1)||isNaN(this.x2)||isNaN(this.y2)},C.prototype.addPoint=function(t,e){"number"==typeof t&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=t,this.x2=t),t<this.x1&&(this.x1=t),t>this.x2&&(this.x2=t)),"number"==typeof e&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=e,this.y2=e),e<this.y1&&(this.y1=e),e>this.y2&&(this.y2=e))},C.prototype.addX=function(t){this.addPoint(t,null)},C.prototype.addY=function(t){this.addPoint(null,t)},C.prototype.addBezier=function(t,e,i,n,r,s,o,a){var u=[t,e],l=[i,n],c=[r,s],h=[o,a];this.addPoint(t,e),this.addPoint(o,a);for(var d=0;d<=1;d++){var p=6*u[d]-12*l[d]+6*c[d],f=-3*u[d]+9*l[d]-9*c[d]+3*h[d],g=3*l[d]-3*u[d];if(0!==f){var m=Math.pow(p,2)-4*g*f;if(!(m<0)){var _=(-p+Math.sqrt(m))/(2*f);0<_&&_<1&&(0===d&&this.addX(T(u[d],l[d],c[d],h[d],_)),1===d&&this.addY(T(u[d],l[d],c[d],h[d],_)));var y=(-p-Math.sqrt(m))/(2*f);0<y&&y<1&&(0===d&&this.addX(T(u[d],l[d],c[d],h[d],y)),1===d&&this.addY(T(u[d],l[d],c[d],h[d],y)))}}else{if(0===p)continue;var x=-g/p;0<x&&x<1&&(0===d&&this.addX(T(u[d],l[d],c[d],h[d],x)),1===d&&this.addY(T(u[d],l[d],c[d],h[d],x)))}}},C.prototype.addQuad=function(t,e,i,n,r,s){var o=t+2/3*(i-t),a=e+2/3*(n-e),u=o+1/3*(r-t),l=a+1/3*(s-e);this.addBezier(t,e,o,a,u,l,r,s)},O.prototype.moveTo=function(t,e){this.commands.push({type:"M",x:t,y:e})},O.prototype.lineTo=function(t,e){this.commands.push({type:"L",x:t,y:e})},O.prototype.curveTo=O.prototype.bezierCurveTo=function(t,e,i,n,r,s){this.commands.push({type:"C",x1:t,y1:e,x2:i,y2:n,x:r,y:s})},O.prototype.quadTo=O.prototype.quadraticCurveTo=function(t,e,i,n){this.commands.push({type:"Q",x1:t,y1:e,x:i,y:n})},O.prototype.close=O.prototype.closePath=function(){this.commands.push({type:"Z"})},O.prototype.extend=function(t){if(t.commands)t=t.commands;else if(t instanceof C){var e=t;return this.moveTo(e.x1,e.y1),this.lineTo(e.x2,e.y1),this.lineTo(e.x2,e.y2),this.lineTo(e.x1,e.y2),void this.close()}Array.prototype.push.apply(this.commands,t)},O.prototype.getBoundingBox=function(){for(var t=new C,e=0,i=0,n=0,r=0,s=0;s<this.commands.length;s++){var o=this.commands[s];switch(o.type){case"M":t.addPoint(o.x,o.y),e=n=o.x,i=r=o.y;break;case"L":t.addPoint(o.x,o.y),n=o.x,r=o.y;break;case"Q":t.addQuad(n,r,o.x1,o.y1,o.x,o.y),n=o.x,r=o.y;break;case"C":t.addBezier(n,r,o.x1,o.y1,o.x2,o.y2,o.x,o.y),n=o.x,r=o.y;break;case"Z":n=e,r=i;break;default:throw new Error("Unexpected path command "+o.type)}}return t.isEmpty()&&t.addPoint(0,0),t},O.prototype.draw=function(t){t.beginPath();for(var e=0;e<this.commands.length;e+=1){var i=this.commands[e];"M"===i.type?t.moveTo(i.x,i.y):"L"===i.type?t.lineTo(i.x,i.y):"C"===i.type?t.bezierCurveTo(i.x1,i.y1,i.x2,i.y2,i.x,i.y):"Q"===i.type?t.quadraticCurveTo(i.x1,i.y1,i.x,i.y):"Z"===i.type&&t.closePath()}this.fill&&(t.fillStyle=this.fill,t.fill()),this.stroke&&(t.strokeStyle=this.stroke,t.lineWidth=this.strokeWidth,t.stroke())},O.prototype.toPathData=function(t){function e(e){return Math.round(e)===e?""+Math.round(e):e.toFixed(t)}function i(){for(var t=arguments,i="",n=0;n<arguments.length;n+=1){var r=t[n];r>=0&&n>0&&(i+=" "),i+=e(r)}return i}t=void 0!==t?t:2;for(var n="",r=0;r<this.commands.length;r+=1){var s=this.commands[r];"M"===s.type?n+="M"+i(s.x,s.y):"L"===s.type?n+="L"+i(s.x,s.y):"C"===s.type?n+="C"+i(s.x1,s.y1,s.x2,s.y2,s.x,s.y):"Q"===s.type?n+="Q"+i(s.x1,s.y1,s.x,s.y):"Z"===s.type&&(n+="Z")}return n},O.prototype.toSVG=function(t){var e='<path d="';return e+=this.toPathData(t),e+='"',this.fill&&"black"!==this.fill&&(null===this.fill?e+=' fill="none"':e+=' fill="'+this.fill+'"'),this.stroke&&(e+=' stroke="'+this.stroke+'" stroke-width="'+this.strokeWidth+'"'),e+="/>"},O.prototype.toDOMElement=function(t){var e=this.toPathData(t),i=document.createElementNS("http://www.w3.org/2000/svg","path");return i.setAttribute("d",e),i};var E={fail:N,argument:F,assert:F},D=2147483648,M={},I={},V={};function B(t){return function(){return t}}I.BYTE=function(t){return E.argument(t>=0&&t<=255,"Byte value should be between 0 and 255."),[t]},V.BYTE=B(1),I.CHAR=function(t){return[t.charCodeAt(0)]},V.CHAR=B(1),I.CHARARRAY=function(t){void 0===t&&(t="",console.warn("Undefined CHARARRAY encountered and treated as an empty string. This is probably caused by a missing glyph name."));for(var e=[],i=0;i<t.length;i+=1)e[i]=t.charCodeAt(i);return e},V.CHARARRAY=function(t){return void 0===t?0:t.length},I.USHORT=function(t){return[t>>8&255,255&t]},V.USHORT=B(2),I.SHORT=function(t){return t>=32768&&(t=-(65536-t)),[t>>8&255,255&t]},V.SHORT=B(2),I.UINT24=function(t){return[t>>16&255,t>>8&255,255&t]},V.UINT24=B(3),I.ULONG=function(t){return[t>>24&255,t>>16&255,t>>8&255,255&t]},V.ULONG=B(4),I.LONG=function(t){return t>=D&&(t=-(2*D-t)),[t>>24&255,t>>16&255,t>>8&255,255&t]},V.LONG=B(4),I.FIXED=I.ULONG,V.FIXED=V.ULONG,I.FWORD=I.SHORT,V.FWORD=V.SHORT,I.UFWORD=I.USHORT,V.UFWORD=V.USHORT,I.LONGDATETIME=function(t){return[0,0,0,0,t>>24&255,t>>16&255,t>>8&255,255&t]},V.LONGDATETIME=B(8),I.TAG=function(t){return E.argument(4===t.length,"Tag should be exactly 4 ASCII characters."),[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]},V.TAG=B(4),I.Card8=I.BYTE,V.Card8=V.BYTE,I.Card16=I.USHORT,V.Card16=V.USHORT,I.OffSize=I.BYTE,V.OffSize=V.BYTE,I.SID=I.USHORT,V.SID=V.USHORT,I.NUMBER=function(t){return t>=-107&&t<=107?[t+139]:t>=108&&t<=1131?[247+((t-=108)>>8),255&t]:t>=-1131&&t<=-108?[251+((t=-t-108)>>8),255&t]:t>=-32768&&t<=32767?I.NUMBER16(t):I.NUMBER32(t)},V.NUMBER=function(t){return I.NUMBER(t).length},I.NUMBER16=function(t){return[28,t>>8&255,255&t]},V.NUMBER16=B(3),I.NUMBER32=function(t){return[29,t>>24&255,t>>16&255,t>>8&255,255&t]},V.NUMBER32=B(5),I.REAL=function(t){var e=t.toString(),i=/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/.exec(e);if(i){var n=parseFloat("1e"+((i[2]?+i[2]:0)+i[1].length));e=(Math.round(t*n)/n).toString()}for(var r="",s=0,o=e.length;s<o;s+=1){var a=e[s];r+="e"===a?"-"===e[++s]?"c":"b":"."===a?"a":"-"===a?"e":a}for(var u=[30],l=0,c=(r+=1&r.length?"f":"ff").length;l<c;l+=2)u.push(parseInt(r.substr(l,2),16));return u},V.REAL=function(t){return I.REAL(t).length},I.NAME=I.CHARARRAY,V.NAME=V.CHARARRAY,I.STRING=I.CHARARRAY,V.STRING=V.CHARARRAY,M.UTF8=function(t,e,i){for(var n=[],r=i,s=0;s<r;s++,e+=1)n[s]=t.getUint8(e);return String.fromCharCode.apply(null,n)},M.UTF16=function(t,e,i){for(var n=[],r=i/2,s=0;s<r;s++,e+=2)n[s]=t.getUint16(e);return String.fromCharCode.apply(null,n)},I.UTF16=function(t){for(var e=[],i=0;i<t.length;i+=1){var n=t.charCodeAt(i);e[e.length]=n>>8&255,e[e.length]=255&n}return e},V.UTF16=function(t){return 2*t.length};var A={"x-mac-croatian":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®Š™´¨≠ŽØ∞±≤≥∆µ∂∑∏š∫ªºΩžø¿¡¬√ƒ≈Ć«Č… ÀÃÕŒœĐ—“”‘’÷◊©⁄€‹›Æ»–·‚„‰ÂćÁčÈÍÎÏÌÓÔđÒÚÛÙıˆ˜¯πË˚¸Êæˇ","x-mac-cyrillic":"АБВГДЕЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯ†°Ґ£§•¶І®©™Ђђ≠Ѓѓ∞±≤≥іµґЈЄєЇїЉљЊњјЅ¬√ƒ≈∆«»… ЋћЌќѕ–—“”‘’÷„ЎўЏџ№Ёёяабвгдежзийклмнопрстуфхцчшщъыьэю","x-mac-gaelic":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØḂ±≤≥ḃĊċḊḋḞḟĠġṀæøṁṖṗɼƒſṠ«»… ÀÃÕŒœ–—“”‘’ṡẛÿŸṪ€‹›Ŷŷṫ·Ỳỳ⁊ÂÊÁËÈÍÎÏÌÓÔ♣ÒÚÛÙıÝýŴŵẄẅẀẁẂẃ","x-mac-greek":"Ä¹²É³ÖÜ΅àâä΄¨çéèêë£™îï•½‰ôö¦€ùûü†ΓΔΘΛΞΠß®©ΣΪ§≠°·Α±≤≥¥ΒΕΖΗΙΚΜΦΫΨΩάΝ¬ΟΡ≈Τ«»… ΥΧΆΈœ–―“”‘’÷ΉΊΌΎέήίόΏύαβψδεφγηιξκλμνοπώρστθωςχυζϊϋΐΰ­","x-mac-icelandic":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûüÝ°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€ÐðÞþý·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-inuit":"ᐃᐄᐅᐆᐊᐋᐱᐲᐳᐴᐸᐹᑉᑎᑏᑐᑑᑕᑖᑦᑭᑮᑯᑰᑲᑳᒃᒋᒌᒍᒎᒐᒑ°ᒡᒥᒦ•¶ᒧ®©™ᒨᒪᒫᒻᓂᓃᓄᓅᓇᓈᓐᓯᓰᓱᓲᓴᓵᔅᓕᓖᓗᓘᓚᓛᓪᔨᔩᔪᔫᔭ… ᔮᔾᕕᕖᕗ–—“”‘’ᕘᕙᕚᕝᕆᕇᕈᕉᕋᕌᕐᕿᖀᖁᖂᖃᖄᖅᖏᖐᖑᖒᖓᖔᖕᙱᙲᙳᙴᙵᙶᖖᖠᖡᖢᖣᖤᖥᖦᕼŁł","x-mac-ce":"ÄĀāÉĄÖÜáąČäčĆćéŹźĎíďĒēĖóėôöõúĚěü†°Ę£§•¶ß®©™ę¨≠ģĮįĪ≤≥īĶ∂∑łĻļĽľĹĺŅņŃ¬√ńŇ∆«»… ňŐÕőŌ–—“”‘’÷◊ōŔŕŘ‹›řŖŗŠ‚„šŚśÁŤťÍŽžŪÓÔūŮÚůŰűŲųÝýķŻŁżĢˇ",macintosh:"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€‹›ﬁﬂ‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-romanian":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ĂȘ∞±≤≥¥µ∂∑∏π∫ªºΩăș¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€‹›Țț‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-turkish":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸĞğİıŞş‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙˆ˜¯˘˙˚¸˝˛ˇ"};M.MACSTRING=function(t,e,i,n){var r=A[n];if(void 0!==r){for(var s="",o=0;o<i;o++){var a=t.getUint8(e+o);s+=a<=127?String.fromCharCode(a):r[127&a]}return s}};var R,P="function"==typeof WeakMap&&new WeakMap;function L(t){return t>=-128&&t<=127}function U(t,e,i){for(var n=0,r=t.length;e<r&&n<64&&0===t[e];)++e,++n;return i.push(128|n-1),e}function k(t,e,i){for(var n=0,r=t.length,s=e;s<r&&n<64;){var o=t[s];if(!L(o))break;if(0===o&&s+1<r&&0===t[s+1])break;++s,++n}i.push(n-1);for(var a=e;a<s;++a)i.push(t[a]+256&255);return s}function X(t,e,i){for(var n=0,r=t.length,s=e;s<r&&n<64;){var o=t[s];if(0===o)break;if(L(o)&&s+1<r&&L(t[s+1]))break;++s,++n}i.push(64|n-1);for(var a=e;a<s;++a){var u=t[a];i.push(u+65536>>8&255,u+256&255)}return s}I.MACSTRING=function(t,e){var i=function(t){if(!R)for(var e in R={},A)R[e]=new String(e);var i=R[t];if(void 0!==i){if(P){var n=P.get(i);if(void 0!==n)return n}var r=A[t];if(void 0!==r){for(var s={},o=0;o<r.length;o++)s[r.charCodeAt(o)]=o+128;return P&&P.set(i,s),s}}}(e);if(void 0!==i){for(var n=[],r=0;r<t.length;r++){var s=t.charCodeAt(r);if(s>=128&&void 0===(s=i[s]))return;n[r]=s}return n}},V.MACSTRING=function(t,e){var i=I.MACSTRING(t,e);return void 0!==i?i.length:0},I.VARDELTAS=function(t){for(var e=0,i=[];e<t.length;){var n=t[e];e=0===n?U(t,e,i):n>=-128&&n<=127?k(t,e,i):X(t,e,i)}return i},I.INDEX=function(t){for(var e=1,i=[e],n=[],r=0;r<t.length;r+=1){var s=I.OBJECT(t[r]);Array.prototype.push.apply(n,s),e+=s.length,i.push(e)}if(0===n.length)return[0,0];for(var o=[],a=1+Math.floor(Math.log(e)/Math.log(2))/8|0,u=[void 0,I.BYTE,I.USHORT,I.UINT24,I.ULONG][a],l=0;l<i.length;l+=1){var c=u(i[l]);Array.prototype.push.apply(o,c)}return Array.prototype.concat(I.Card16(t.length),I.OffSize(a),o,n)},V.INDEX=function(t){return I.INDEX(t).length},I.DICT=function(t){for(var e=[],i=Object.keys(t),n=i.length,r=0;r<n;r+=1){var s=parseInt(i[r],0),o=t[s];e=(e=e.concat(I.OPERAND(o.value,o.type))).concat(I.OPERATOR(s))}return e},V.DICT=function(t){return I.DICT(t).length},I.OPERATOR=function(t){return t<1200?[t]:[12,t-1200]},I.OPERAND=function(t,e){var i=[];if(Array.isArray(e))for(var n=0;n<e.length;n+=1)E.argument(t.length===e.length,"Not enough arguments given for type"+e),i=i.concat(I.OPERAND(t[n],e[n]));else if("SID"===e)i=i.concat(I.NUMBER(t));else if("offset"===e)i=i.concat(I.NUMBER32(t));else if("number"===e)i=i.concat(I.NUMBER(t));else{if("real"!==e)throw new Error("Unknown operand type "+e);i=i.concat(I.REAL(t))}return i},I.OP=I.BYTE,V.OP=V.BYTE;var z="function"==typeof WeakMap&&new WeakMap;function j(t,e,i){if(e.length&&("coverageFormat"!==e[0].name||1===e[0].value))for(var n=0;n<e.length;n+=1){var r=e[n];this[r.name]=r.value}if(this.tableName=t,this.fields=e,i)for(var s=Object.keys(i),o=0;o<s.length;o+=1){var a=s[o],u=i[a];void 0!==this[a]&&(this[a]=u)}}function G(t,e,i){void 0===i&&(i=e.length);var n=new Array(e.length+1);n[0]={name:t+"Count",type:"USHORT",value:i};for(var r=0;r<e.length;r++)n[r+1]={name:t+r,type:"USHORT",value:e[r]};return n}function q(t,e,i){var n=e.length,r=new Array(n+1);r[0]={name:t+"Count",type:"USHORT",value:n};for(var s=0;s<n;s++)r[s+1]={name:t+s,type:"TABLE",value:i(e[s],s)};return r}function H(t,e,i){var n=e.length,r=[];r[0]={name:t+"Count",type:"USHORT",value:n};for(var s=0;s<n;s++)r=r.concat(i(e[s],s));return r}function W(t){1===t.format?j.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:1}].concat(G("glyph",t.glyphs))):2===t.format?j.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:2}].concat(H("rangeRecord",t.ranges,(function(t){return[{name:"startGlyphID",type:"USHORT",value:t.start},{name:"endGlyphID",type:"USHORT",value:t.end},{name:"startCoverageIndex",type:"USHORT",value:t.index}]})))):E.assert(!1,"Coverage format must be 1 or 2.")}function Y(t){j.call(this,"scriptListTable",H("scriptRecord",t,(function(t,e){var i=t.script,n=i.defaultLangSys;return E.assert(!!n,"Unable to write GSUB: script "+t.tag+" has no default language system."),[{name:"scriptTag"+e,type:"TAG",value:t.tag},{name:"script"+e,type:"TABLE",value:new j("scriptTable",[{name:"defaultLangSys",type:"TABLE",value:new j("defaultLangSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:n.reqFeatureIndex}].concat(G("featureIndex",n.featureIndexes)))}].concat(H("langSys",i.langSysRecords,(function(t,e){var i=t.langSys;return[{name:"langSysTag"+e,type:"TAG",value:t.tag},{name:"langSys"+e,type:"TABLE",value:new j("langSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:i.reqFeatureIndex}].concat(G("featureIndex",i.featureIndexes)))}]}))))}]})))}function Z(t){j.call(this,"featureListTable",H("featureRecord",t,(function(t,e){var i=t.feature;return[{name:"featureTag"+e,type:"TAG",value:t.tag},{name:"feature"+e,type:"TABLE",value:new j("featureTable",[{name:"featureParams",type:"USHORT",value:i.featureParams}].concat(G("lookupListIndex",i.lookupListIndexes)))}]})))}function K(t,e){j.call(this,"lookupListTable",q("lookup",t,(function(t){var i=e[t.lookupType];return E.assert(!!i,"Unable to write GSUB lookup type "+t.lookupType+" tables."),new j("lookupTable",[{name:"lookupType",type:"USHORT",value:t.lookupType},{name:"lookupFlag",type:"USHORT",value:t.lookupFlag}].concat(q("subtable",t.subtables,i)))})))}I.CHARSTRING=function(t){if(z){var e=z.get(t);if(void 0!==e)return e}for(var i=[],n=t.length,r=0;r<n;r+=1){var s=t[r];i=i.concat(I[s.type](s.value))}return z&&z.set(t,i),i},V.CHARSTRING=function(t){return I.CHARSTRING(t).length},I.OBJECT=function(t){var e=I[t.type];return E.argument(void 0!==e,"No encoding function for type "+t.type),e(t.value)},V.OBJECT=function(t){var e=V[t.type];return E.argument(void 0!==e,"No sizeOf function for type "+t.type),e(t.value)},I.TABLE=function(t){for(var e=[],i=t.fields.length,n=[],r=[],s=0;s<i;s+=1){var o=t.fields[s],a=I[o.type];E.argument(void 0!==a,"No encoding function for field type "+o.type+" ("+o.name+")");var u=t[o.name];void 0===u&&(u=o.value);var l=a(u);"TABLE"===o.type?(r.push(e.length),e=e.concat([0,0]),n.push(l)):e=e.concat(l)}for(var c=0;c<n.length;c+=1){var h=r[c],d=e.length;E.argument(d<65536,"Table "+t.tableName+" too big."),e[h]=d>>8,e[h+1]=255&d,e=e.concat(n[c])}return e},V.TABLE=function(t){for(var e=0,i=t.fields.length,n=0;n<i;n+=1){var r=t.fields[n],s=V[r.type];E.argument(void 0!==s,"No sizeOf function for field type "+r.type+" ("+r.name+")");var o=t[r.name];void 0===o&&(o=r.value),e+=s(o),"TABLE"===r.type&&(e+=2)}return e},I.RECORD=I.TABLE,V.RECORD=V.TABLE,I.LITERAL=function(t){return t},V.LITERAL=function(t){return t.length},j.prototype.encode=function(){return I.TABLE(this)},j.prototype.sizeOf=function(){return V.TABLE(this)},W.prototype=Object.create(j.prototype),W.prototype.constructor=W,Y.prototype=Object.create(j.prototype),Y.prototype.constructor=Y,Z.prototype=Object.create(j.prototype),Z.prototype.constructor=Z,K.prototype=Object.create(j.prototype),K.prototype.constructor=K;var Q={Table:j,Record:j,Coverage:W,ScriptList:Y,FeatureList:Z,LookupList:K,ushortList:G,tableList:q,recordList:H};function $(t,e){return t.getUint8(e)}function J(t,e){return t.getUint16(e,!1)}function tt(t,e){return t.getUint32(e,!1)}function et(t,e){return t.getInt16(e,!1)+t.getUint16(e+2,!1)/65535}var it={byte:1,uShort:2,short:2,uLong:4,fixed:4,longDateTime:8,tag:4};function nt(t,e){this.data=t,this.offset=e,this.relativeOffset=0}nt.prototype.parseByte=function(){var t=this.data.getUint8(this.offset+this.relativeOffset);return this.relativeOffset+=1,t},nt.prototype.parseChar=function(){var t=this.data.getInt8(this.offset+this.relativeOffset);return this.relativeOffset+=1,t},nt.prototype.parseCard8=nt.prototype.parseByte,nt.prototype.parseUShort=function(){var t=this.data.getUint16(this.offset+this.relativeOffset);return this.relativeOffset+=2,t},nt.prototype.parseCard16=nt.prototype.parseUShort,nt.prototype.parseSID=nt.prototype.parseUShort,nt.prototype.parseOffset16=nt.prototype.parseUShort,nt.prototype.parseShort=function(){var t=this.data.getInt16(this.offset+this.relativeOffset);return this.relativeOffset+=2,t},nt.prototype.parseF2Dot14=function(){var t=this.data.getInt16(this.offset+this.relativeOffset)/16384;return this.relativeOffset+=2,t},nt.prototype.parseULong=function(){var t=tt(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,t},nt.prototype.parseOffset32=nt.prototype.parseULong,nt.prototype.parseFixed=function(){var t=et(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,t},nt.prototype.parseString=function(t){var e=this.data,i=this.offset+this.relativeOffset,n="";this.relativeOffset+=t;for(var r=0;r<t;r++)n+=String.fromCharCode(e.getUint8(i+r));return n},nt.prototype.parseTag=function(){return this.parseString(4)},nt.prototype.parseLongDateTime=function(){var t=tt(this.data,this.offset+this.relativeOffset+4);return t-=2082844800,this.relativeOffset+=8,t},nt.prototype.parseVersion=function(t){var e=J(this.data,this.offset+this.relativeOffset),i=J(this.data,this.offset+this.relativeOffset+2);return this.relativeOffset+=4,void 0===t&&(t=4096),e+i/t/10},nt.prototype.skip=function(t,e){void 0===e&&(e=1),this.relativeOffset+=it[t]*e},nt.prototype.parseULongList=function(t){void 0===t&&(t=this.parseULong());for(var e=new Array(t),i=this.data,n=this.offset+this.relativeOffset,r=0;r<t;r++)e[r]=i.getUint32(n),n+=4;return this.relativeOffset+=4*t,e},nt.prototype.parseOffset16List=nt.prototype.parseUShortList=function(t){void 0===t&&(t=this.parseUShort());for(var e=new Array(t),i=this.data,n=this.offset+this.relativeOffset,r=0;r<t;r++)e[r]=i.getUint16(n),n+=2;return this.relativeOffset+=2*t,e},nt.prototype.parseShortList=function(t){for(var e=new Array(t),i=this.data,n=this.offset+this.relativeOffset,r=0;r<t;r++)e[r]=i.getInt16(n),n+=2;return this.relativeOffset+=2*t,e},nt.prototype.parseByteList=function(t){for(var e=new Array(t),i=this.data,n=this.offset+this.relativeOffset,r=0;r<t;r++)e[r]=i.getUint8(n++);return this.relativeOffset+=t,e},nt.prototype.parseList=function(t,e){e||(e=t,t=this.parseUShort());for(var i=new Array(t),n=0;n<t;n++)i[n]=e.call(this);return i},nt.prototype.parseList32=function(t,e){e||(e=t,t=this.parseULong());for(var i=new Array(t),n=0;n<t;n++)i[n]=e.call(this);return i},nt.prototype.parseRecordList=function(t,e){e||(e=t,t=this.parseUShort());for(var i=new Array(t),n=Object.keys(e),r=0;r<t;r++){for(var s={},o=0;o<n.length;o++){var a=n[o],u=e[a];s[a]=u.call(this)}i[r]=s}return i},nt.prototype.parseRecordList32=function(t,e){e||(e=t,t=this.parseULong());for(var i=new Array(t),n=Object.keys(e),r=0;r<t;r++){for(var s={},o=0;o<n.length;o++){var a=n[o],u=e[a];s[a]=u.call(this)}i[r]=s}return i},nt.prototype.parseStruct=function(t){if("function"==typeof t)return t.call(this);for(var e=Object.keys(t),i={},n=0;n<e.length;n++){var r=e[n],s=t[r];i[r]=s.call(this)}return i},nt.prototype.parseValueRecord=function(t){if(void 0===t&&(t=this.parseUShort()),0!==t){var e={};return 1&t&&(e.xPlacement=this.parseShort()),2&t&&(e.yPlacement=this.parseShort()),4&t&&(e.xAdvance=this.parseShort()),8&t&&(e.yAdvance=this.parseShort()),16&t&&(e.xPlaDevice=void 0,this.parseShort()),32&t&&(e.yPlaDevice=void 0,this.parseShort()),64&t&&(e.xAdvDevice=void 0,this.parseShort()),128&t&&(e.yAdvDevice=void 0,this.parseShort()),e}},nt.prototype.parseValueRecordList=function(){for(var t=this.parseUShort(),e=this.parseUShort(),i=new Array(e),n=0;n<e;n++)i[n]=this.parseValueRecord(t);return i},nt.prototype.parsePointer=function(t){var e=this.parseOffset16();if(e>0)return new nt(this.data,this.offset+e).parseStruct(t)},nt.prototype.parsePointer32=function(t){var e=this.parseOffset32();if(e>0)return new nt(this.data,this.offset+e).parseStruct(t)},nt.prototype.parseListOfLists=function(t){for(var e=this.parseOffset16List(),i=e.length,n=this.relativeOffset,r=new Array(i),s=0;s<i;s++){var o=e[s];if(0!==o)if(this.relativeOffset=o,t){for(var a=this.parseOffset16List(),u=new Array(a.length),l=0;l<a.length;l++)this.relativeOffset=o+a[l],u[l]=t.call(this);r[s]=u}else r[s]=this.parseUShortList();else r[s]=void 0}return this.relativeOffset=n,r},nt.prototype.parseCoverage=function(){var t=this.offset+this.relativeOffset,e=this.parseUShort(),i=this.parseUShort();if(1===e)return{format:1,glyphs:this.parseUShortList(i)};if(2===e){for(var n=new Array(i),r=0;r<i;r++)n[r]={start:this.parseUShort(),end:this.parseUShort(),index:this.parseUShort()};return{format:2,ranges:n}}throw new Error("0x"+t.toString(16)+": Coverage format must be 1 or 2.")},nt.prototype.parseClassDef=function(){var t=this.offset+this.relativeOffset,e=this.parseUShort();if(1===e)return{format:1,startGlyph:this.parseUShort(),classes:this.parseUShortList()};if(2===e)return{format:2,ranges:this.parseRecordList({start:nt.uShort,end:nt.uShort,classId:nt.uShort})};throw new Error("0x"+t.toString(16)+": ClassDef format must be 1 or 2.")},nt.list=function(t,e){return function(){return this.parseList(t,e)}},nt.list32=function(t,e){return function(){return this.parseList32(t,e)}},nt.recordList=function(t,e){return function(){return this.parseRecordList(t,e)}},nt.recordList32=function(t,e){return function(){return this.parseRecordList32(t,e)}},nt.pointer=function(t){return function(){return this.parsePointer(t)}},nt.pointer32=function(t){return function(){return this.parsePointer32(t)}},nt.tag=nt.prototype.parseTag,nt.byte=nt.prototype.parseByte,nt.uShort=nt.offset16=nt.prototype.parseUShort,nt.uShortList=nt.prototype.parseUShortList,nt.uLong=nt.offset32=nt.prototype.parseULong,nt.uLongList=nt.prototype.parseULongList,nt.struct=nt.prototype.parseStruct,nt.coverage=nt.prototype.parseCoverage,nt.classDef=nt.prototype.parseClassDef;var rt={reserved:nt.uShort,reqFeatureIndex:nt.uShort,featureIndexes:nt.uShortList};nt.prototype.parseScriptList=function(){return this.parsePointer(nt.recordList({tag:nt.tag,script:nt.pointer({defaultLangSys:nt.pointer(rt),langSysRecords:nt.recordList({tag:nt.tag,langSys:nt.pointer(rt)})})}))||[]},nt.prototype.parseFeatureList=function(){return this.parsePointer(nt.recordList({tag:nt.tag,feature:nt.pointer({featureParams:nt.offset16,lookupListIndexes:nt.uShortList})}))||[]},nt.prototype.parseLookupList=function(t){return this.parsePointer(nt.list(nt.pointer((function(){var e=this.parseUShort();E.argument(1<=e&&e<=9,"GPOS/GSUB lookup type "+e+" unknown.");var i=this.parseUShort(),n=16&i;return{lookupType:e,lookupFlag:i,subtables:this.parseList(nt.pointer(t[e])),markFilteringSet:n?this.parseUShort():void 0}}))))||[]},nt.prototype.parseFeatureVariationsList=function(){return this.parsePointer32((function(){var t=this.parseUShort(),e=this.parseUShort();return E.argument(1===t&&e<1,"GPOS/GSUB feature variations table unknown."),this.parseRecordList32({conditionSetOffset:nt.offset32,featureTableSubstitutionOffset:nt.offset32})}))||[]};var st={getByte:$,getCard8:$,getUShort:J,getCard16:J,getShort:function(t,e){return t.getInt16(e,!1)},getULong:tt,getFixed:et,getTag:function(t,e){for(var i="",n=e;n<e+4;n+=1)i+=String.fromCharCode(t.getInt8(n));return i},getOffset:function(t,e,i){for(var n=0,r=0;r<i;r+=1)n<<=8,n+=t.getUint8(e+r);return n},getBytes:function(t,e,i){for(var n=[],r=e;r<i;r+=1)n.push(t.getUint8(r));return n},bytesToString:function(t){for(var e="",i=0;i<t.length;i+=1)e+=String.fromCharCode(t[i]);return e},Parser:nt};function ot(t,e,i){t.segments.push({end:e,start:e,delta:-(e-i),offset:0,glyphIndex:i})}var at={parse:function(t,e){var i={};i.version=st.getUShort(t,e),E.argument(0===i.version,"cmap table version should be 0."),i.numTables=st.getUShort(t,e+2);for(var n=-1,r=i.numTables-1;r>=0;r-=1){var s=st.getUShort(t,e+4+8*r),o=st.getUShort(t,e+4+8*r+2);if(3===s&&(0===o||1===o||10===o)||0===s&&(0===o||1===o||2===o||3===o||4===o)){n=st.getULong(t,e+4+8*r+4);break}}if(-1===n)throw new Error("No valid cmap sub-tables found.");var a=new st.Parser(t,e+n);if(i.format=a.parseUShort(),12===i.format)!function(t,e){var i;e.parseUShort(),t.length=e.parseULong(),t.language=e.parseULong(),t.groupCount=i=e.parseULong(),t.glyphIndexMap={};for(var n=0;n<i;n+=1)for(var r=e.parseULong(),s=e.parseULong(),o=e.parseULong(),a=r;a<=s;a+=1)t.glyphIndexMap[a]=o,o++}(i,a);else{if(4!==i.format)throw new Error("Only format 4 and 12 cmap tables are supported (found format "+i.format+").");!function(t,e,i,n,r){var s;t.length=e.parseUShort(),t.language=e.parseUShort(),t.segCount=s=e.parseUShort()>>1,e.skip("uShort",3),t.glyphIndexMap={};for(var o=new st.Parser(i,n+r+14),a=new st.Parser(i,n+r+16+2*s),u=new st.Parser(i,n+r+16+4*s),l=new st.Parser(i,n+r+16+6*s),c=n+r+16+8*s,h=0;h<s-1;h+=1)for(var d=void 0,p=o.parseUShort(),f=a.parseUShort(),g=u.parseShort(),m=l.parseUShort(),_=f;_<=p;_+=1)0!==m?(c=l.offset+l.relativeOffset-2,c+=m,c+=2*(_-f),0!==(d=st.getUShort(i,c))&&(d=d+g&65535)):d=_+g&65535,t.glyphIndexMap[_]=d}(i,a,t,e,n)}return i},make:function(t){var e,i=!0;for(e=t.length-1;e>0;e-=1){if(t.get(e).unicode>65535){console.log("Adding CMAP format 12 (needed!)"),i=!1;break}}var n=[{name:"version",type:"USHORT",value:0},{name:"numTables",type:"USHORT",value:i?1:2},{name:"platformID",type:"USHORT",value:3},{name:"encodingID",type:"USHORT",value:1},{name:"offset",type:"ULONG",value:i?12:20}];i||(n=n.concat([{name:"cmap12PlatformID",type:"USHORT",value:3},{name:"cmap12EncodingID",type:"USHORT",value:10},{name:"cmap12Offset",type:"ULONG",value:0}])),n=n.concat([{name:"format",type:"USHORT",value:4},{name:"cmap4Length",type:"USHORT",value:0},{name:"language",type:"USHORT",value:0},{name:"segCountX2",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);var r=new Q.Table("cmap",n);for(r.segments=[],e=0;e<t.length;e+=1){for(var s=t.get(e),o=0;o<s.unicodes.length;o+=1)ot(r,s.unicodes[o],e);r.segments=r.segments.sort((function(t,e){return t.start-e.start}))}!function(t){t.segments.push({end:65535,start:65535,delta:1,offset:0})}(r);var a=r.segments.length,u=0,l=[],c=[],h=[],d=[],p=[],f=[];for(e=0;e<a;e+=1){var g=r.segments[e];g.end<=65535&&g.start<=65535?(l=l.concat({name:"end_"+e,type:"USHORT",value:g.end}),c=c.concat({name:"start_"+e,type:"USHORT",value:g.start}),h=h.concat({name:"idDelta_"+e,type:"SHORT",value:g.delta}),d=d.concat({name:"idRangeOffset_"+e,type:"USHORT",value:g.offset}),void 0!==g.glyphId&&(p=p.concat({name:"glyph_"+e,type:"USHORT",value:g.glyphId}))):u+=1,i||void 0===g.glyphIndex||(f=(f=(f=f.concat({name:"cmap12Start_"+e,type:"ULONG",value:g.start})).concat({name:"cmap12End_"+e,type:"ULONG",value:g.end})).concat({name:"cmap12Glyph_"+e,type:"ULONG",value:g.glyphIndex}))}if(r.segCountX2=2*(a-u),r.searchRange=2*Math.pow(2,Math.floor(Math.log(a-u)/Math.log(2))),r.entrySelector=Math.log(r.searchRange/2)/Math.log(2),r.rangeShift=r.segCountX2-r.searchRange,r.fields=r.fields.concat(l),r.fields.push({name:"reservedPad",type:"USHORT",value:0}),r.fields=r.fields.concat(c),r.fields=r.fields.concat(h),r.fields=r.fields.concat(d),r.fields=r.fields.concat(p),r.cmap4Length=14+2*l.length+2+2*c.length+2*h.length+2*d.length+2*p.length,!i){var m=16+4*f.length;r.cmap12Offset=20+r.cmap4Length,r.fields=r.fields.concat([{name:"cmap12Format",type:"USHORT",value:12},{name:"cmap12Reserved",type:"USHORT",value:0},{name:"cmap12Length",type:"ULONG",value:m},{name:"cmap12Language",type:"ULONG",value:0},{name:"cmap12nGroups",type:"ULONG",value:f.length/3}]),r.fields=r.fields.concat(f)}return r}},ut=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","266 ff","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"],lt=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls"],ct=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],ht=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"];function dt(t){this.font=t}function pt(t){this.cmap=t}function ft(t,e){this.encoding=t,this.charset=e}function gt(t){switch(t.version){case 1:this.names=ht.slice();break;case 2:this.names=new Array(t.numberOfGlyphs);for(var e=0;e<t.numberOfGlyphs;e++)t.glyphNameIndex[e]<ht.length?this.names[e]=ht[t.glyphNameIndex[e]]:this.names[e]=t.names[t.glyphNameIndex[e]-ht.length];break;case 2.5:this.names=new Array(t.numberOfGlyphs);for(var i=0;i<t.numberOfGlyphs;i++)this.names[i]=ht[i+t.glyphNameIndex[i]];break;default:this.names=[]}}function mt(t,e){e.lowMemory?function(t){t._IndexToUnicodeMap={};for(var e=t.tables.cmap.glyphIndexMap,i=Object.keys(e),n=0;n<i.length;n+=1){var r=i[n],s=e[r];void 0===t._IndexToUnicodeMap[s]?t._IndexToUnicodeMap[s]={unicodes:[parseInt(r)]}:t._IndexToUnicodeMap[s].unicodes.push(parseInt(r))}}(t):function(t){for(var e,i=t.tables.cmap.glyphIndexMap,n=Object.keys(i),r=0;r<n.length;r+=1){var s=n[r],o=i[s];(e=t.glyphs.get(o)).addUnicode(parseInt(s))}for(var a=0;a<t.glyphs.length;a+=1)e=t.glyphs.get(a),t.cffEncoding?t.isCIDFont?e.name="gid"+a:e.name=t.cffEncoding.charset[a]:t.glyphNames.names&&(e.name=t.glyphNames.glyphIndexToName(a))}(t)}dt.prototype.charToGlyphIndex=function(t){var e=t.codePointAt(0),i=this.font.glyphs;if(i)for(var n=0;n<i.length;n+=1)for(var r=i.get(n),s=0;s<r.unicodes.length;s+=1)if(r.unicodes[s]===e)return n;return null},pt.prototype.charToGlyphIndex=function(t){return this.cmap.glyphIndexMap[t.codePointAt(0)]||0},ft.prototype.charToGlyphIndex=function(t){var e=t.codePointAt(0),i=this.encoding[e];return this.charset.indexOf(i)},gt.prototype.nameToGlyphIndex=function(t){return this.names.indexOf(t)},gt.prototype.glyphIndexToName=function(t){return this.names[t]};var _t={line:function(t,e,i,n,r){t.beginPath(),t.moveTo(e,i),t.lineTo(n,r),t.stroke()}};function yt(t){this.bindConstructorValues(t)}function xt(t,e,i){Object.defineProperty(t,e,{get:function(){return t.path,t[i]},set:function(e){t[i]=e},enumerable:!0,configurable:!0})}function wt(t,e){if(this.font=t,this.glyphs={},Array.isArray(e))for(var i=0;i<e.length;i++){var n=e[i];n.path.unitsPerEm=t.unitsPerEm,this.glyphs[i]=n}this.length=e&&e.length||0}yt.prototype.bindConstructorValues=function(t){var e,i;this.index=t.index||0,this.name=t.name||null,this.unicode=t.unicode||void 0,this.unicodes=t.unicodes||void 0!==t.unicode?[t.unicode]:[],"xMin"in t&&(this.xMin=t.xMin),"yMin"in t&&(this.yMin=t.yMin),"xMax"in t&&(this.xMax=t.xMax),"yMax"in t&&(this.yMax=t.yMax),"advanceWidth"in t&&(this.advanceWidth=t.advanceWidth),Object.defineProperty(this,"path",(e=t.path,i=e||new O,{configurable:!0,get:function(){return"function"==typeof i&&(i=i()),i},set:function(t){i=t}}))},yt.prototype.addUnicode=function(t){0===this.unicodes.length&&(this.unicode=t),this.unicodes.push(t)},yt.prototype.getBoundingBox=function(){return this.path.getBoundingBox()},yt.prototype.getPath=function(t,e,i,n,r){var s,o;t=void 0!==t?t:0,e=void 0!==e?e:0,i=void 0!==i?i:72,n||(n={});var a=n.xScale,u=n.yScale;if(n.hinting&&r&&r.hinting&&(o=this.path&&r.hinting.exec(this,i)),o)s=r.hinting.getCommands(o),t=Math.round(t),e=Math.round(e),a=u=1;else{s=this.path.commands;var l=1/(this.path.unitsPerEm||1e3)*i;void 0===a&&(a=l),void 0===u&&(u=l)}for(var c=new O,h=0;h<s.length;h+=1){var d=s[h];"M"===d.type?c.moveTo(t+d.x*a,e+-d.y*u):"L"===d.type?c.lineTo(t+d.x*a,e+-d.y*u):"Q"===d.type?c.quadraticCurveTo(t+d.x1*a,e+-d.y1*u,t+d.x*a,e+-d.y*u):"C"===d.type?c.curveTo(t+d.x1*a,e+-d.y1*u,t+d.x2*a,e+-d.y2*u,t+d.x*a,e+-d.y*u):"Z"===d.type&&c.closePath()}return c},yt.prototype.getContours=function(){if(void 0===this.points)return[];for(var t=[],e=[],i=0;i<this.points.length;i+=1){var n=this.points[i];e.push(n),n.lastPointOfContour&&(t.push(e),e=[])}return E.argument(0===e.length,"There are still points left in the current contour."),t},yt.prototype.getMetrics=function(){for(var t=this.path.commands,e=[],i=[],n=0;n<t.length;n+=1){var r=t[n];"Z"!==r.type&&(e.push(r.x),i.push(r.y)),"Q"!==r.type&&"C"!==r.type||(e.push(r.x1),i.push(r.y1)),"C"===r.type&&(e.push(r.x2),i.push(r.y2))}var s={xMin:Math.min.apply(null,e),yMin:Math.min.apply(null,i),xMax:Math.max.apply(null,e),yMax:Math.max.apply(null,i),leftSideBearing:this.leftSideBearing};return isFinite(s.xMin)||(s.xMin=0),isFinite(s.xMax)||(s.xMax=this.advanceWidth),isFinite(s.yMin)||(s.yMin=0),isFinite(s.yMax)||(s.yMax=0),s.rightSideBearing=this.advanceWidth-s.leftSideBearing-(s.xMax-s.xMin),s},yt.prototype.draw=function(t,e,i,n,r){this.getPath(e,i,n,r).draw(t)},yt.prototype.drawPoints=function(t,e,i,n){function r(e,i,n,r){t.beginPath();for(var s=0;s<e.length;s+=1)t.moveTo(i+e[s].x*r,n+e[s].y*r),t.arc(i+e[s].x*r,n+e[s].y*r,2,0,2*Math.PI,!1);t.closePath(),t.fill()}e=void 0!==e?e:0,i=void 0!==i?i:0,n=void 0!==n?n:24;for(var s=1/this.path.unitsPerEm*n,o=[],a=[],u=this.path,l=0;l<u.commands.length;l+=1){var c=u.commands[l];void 0!==c.x&&o.push({x:c.x,y:-c.y}),void 0!==c.x1&&a.push({x:c.x1,y:-c.y1}),void 0!==c.x2&&a.push({x:c.x2,y:-c.y2})}t.fillStyle="blue",r(o,e,i,s),t.fillStyle="red",r(a,e,i,s)},yt.prototype.drawMetrics=function(t,e,i,n){var r;e=void 0!==e?e:0,i=void 0!==i?i:0,n=void 0!==n?n:24,r=1/this.path.unitsPerEm*n,t.lineWidth=1,t.strokeStyle="black",_t.line(t,e,-1e4,e,1e4),_t.line(t,-1e4,i,1e4,i);var s=this.xMin||0,o=this.yMin||0,a=this.xMax||0,u=this.yMax||0,l=this.advanceWidth||0;t.strokeStyle="blue",_t.line(t,e+s*r,-1e4,e+s*r,1e4),_t.line(t,e+a*r,-1e4,e+a*r,1e4),_t.line(t,-1e4,i+-o*r,1e4,i+-o*r),_t.line(t,-1e4,i+-u*r,1e4,i+-u*r),t.strokeStyle="green",_t.line(t,e+l*r,-1e4,e+l*r,1e4)},wt.prototype.get=function(t){if(void 0===this.glyphs[t]){this.font._push(t),"function"==typeof this.glyphs[t]&&(this.glyphs[t]=this.glyphs[t]());var e=this.glyphs[t],i=this.font._IndexToUnicodeMap[t];if(i)for(var n=0;n<i.unicodes.length;n++)e.addUnicode(i.unicodes[n]);this.font.cffEncoding?this.font.isCIDFont?e.name="gid"+t:e.name=this.font.cffEncoding.charset[t]:this.font.glyphNames.names&&(e.name=this.font.glyphNames.glyphIndexToName(t)),this.glyphs[t].advanceWidth=this.font._hmtxTableData[t].advanceWidth,this.glyphs[t].leftSideBearing=this.font._hmtxTableData[t].leftSideBearing}else"function"==typeof this.glyphs[t]&&(this.glyphs[t]=this.glyphs[t]());return this.glyphs[t]},wt.prototype.push=function(t,e){this.glyphs[t]=e,this.length++};var bt={GlyphSet:wt,glyphLoader:function(t,e){return new yt({index:e,font:t})},ttfGlyphLoader:function(t,e,i,n,r,s){return function(){var o=new yt({index:e,font:t});return o.path=function(){i(o,n,r);var e=s(t.glyphs,o);return e.unitsPerEm=t.unitsPerEm,e},xt(o,"xMin","_xMin"),xt(o,"xMax","_xMax"),xt(o,"yMin","_yMin"),xt(o,"yMax","_yMax"),o}},cffGlyphLoader:function(t,e,i,n){return function(){var r=new yt({index:e,font:t});return r.path=function(){var e=i(t,r,n);return e.unitsPerEm=t.unitsPerEm,e},r}}};function vt(t,e){if(t===e)return!0;if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;for(var i=0;i<t.length;i+=1)if(!vt(t[i],e[i]))return!1;return!0}return!1}function St(t){return t.length<1240?107:t.length<33900?1131:32768}function Tt(t,e,i){var n,r,s=[],o=[],a=st.getCard16(t,e);if(0!==a){var u=st.getByte(t,e+2);n=e+(a+1)*u+2;for(var l=e+3,c=0;c<a+1;c+=1)s.push(st.getOffset(t,l,u)),l+=u;r=n+s[a]}else r=e+2;for(var h=0;h<s.length-1;h+=1){var d=st.getBytes(t,n+s[h],n+s[h+1]);i&&(d=i(d)),o.push(d)}return{objects:o,startOffset:e,endOffset:r}}function Ct(t,e){if(28===e)return t.parseByte()<<8|t.parseByte();if(29===e)return t.parseByte()<<24|t.parseByte()<<16|t.parseByte()<<8|t.parseByte();if(30===e)return function(t){for(var e="",i=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"];;){var n=t.parseByte(),r=n>>4,s=15&n;if(15===r)break;if(e+=i[r],15===s)break;e+=i[s]}return parseFloat(e)}(t);if(e>=32&&e<=246)return e-139;if(e>=247&&e<=250)return 256*(e-247)+t.parseByte()+108;if(e>=251&&e<=254)return 256*-(e-251)-t.parseByte()-108;throw new Error("Invalid b0 "+e)}function Ot(t,e,i){e=void 0!==e?e:0;var n=new st.Parser(t,e),r=[],s=[];for(i=void 0!==i?i:t.length;n.relativeOffset<i;){var o=n.parseByte();o<=21?(12===o&&(o=1200+n.parseByte()),r.push([o,s]),s=[]):s.push(Ct(n,o))}return function(t){for(var e={},i=0;i<t.length;i+=1){var n=t[i][0],r=t[i][1],s=void 0;if(s=1===r.length?r[0]:r,e.hasOwnProperty(n)&&!isNaN(e[n]))throw new Error("Object "+e+" already has key "+n);e[n]=s}return e}(r)}function Nt(t,e){return e=e<=390?ut[e]:t[e-391]}function Ft(t,e,i){for(var n,r={},s=0;s<e.length;s+=1){var o=e[s];if(Array.isArray(o.type)){var a=[];a.length=o.type.length;for(var u=0;u<o.type.length;u++)void 0===(n=void 0!==t[o.op]?t[o.op][u]:void 0)&&(n=void 0!==o.value&&void 0!==o.value[u]?o.value[u]:null),"SID"===o.type[u]&&(n=Nt(i,n)),a[u]=n;r[o.name]=a}else void 0===(n=t[o.op])&&(n=void 0!==o.value?o.value:null),"SID"===o.type&&(n=Nt(i,n)),r[o.name]=n}return r}var Et=[{name:"version",op:0,type:"SID"},{name:"notice",op:1,type:"SID"},{name:"copyright",op:1200,type:"SID"},{name:"fullName",op:2,type:"SID"},{name:"familyName",op:3,type:"SID"},{name:"weight",op:4,type:"SID"},{name:"isFixedPitch",op:1201,type:"number",value:0},{name:"italicAngle",op:1202,type:"number",value:0},{name:"underlinePosition",op:1203,type:"number",value:-100},{name:"underlineThickness",op:1204,type:"number",value:50},{name:"paintType",op:1205,type:"number",value:0},{name:"charstringType",op:1206,type:"number",value:2},{name:"fontMatrix",op:1207,type:["real","real","real","real","real","real"],value:[.001,0,0,.001,0,0]},{name:"uniqueId",op:13,type:"number"},{name:"fontBBox",op:5,type:["number","number","number","number"],value:[0,0,0,0]},{name:"strokeWidth",op:1208,type:"number",value:0},{name:"xuid",op:14,type:[],value:null},{name:"charset",op:15,type:"offset",value:0},{name:"encoding",op:16,type:"offset",value:0},{name:"charStrings",op:17,type:"offset",value:0},{name:"private",op:18,type:["number","offset"],value:[0,0]},{name:"ros",op:1230,type:["SID","SID","number"]},{name:"cidFontVersion",op:1231,type:"number",value:0},{name:"cidFontRevision",op:1232,type:"number",value:0},{name:"cidFontType",op:1233,type:"number",value:0},{name:"cidCount",op:1234,type:"number",value:8720},{name:"uidBase",op:1235,type:"number"},{name:"fdArray",op:1236,type:"offset"},{name:"fdSelect",op:1237,type:"offset"},{name:"fontName",op:1238,type:"SID"}],Dt=[{name:"subrs",op:19,type:"offset",value:0},{name:"defaultWidthX",op:20,type:"number",value:0},{name:"nominalWidthX",op:21,type:"number",value:0}];function Mt(t,e){return Ft(Ot(t,0,t.byteLength),Et,e)}function It(t,e,i,n){return Ft(Ot(t,e,i),Dt,n)}function Vt(t,e,i,n){for(var r=[],s=0;s<i.length;s+=1){var o=Mt(new DataView(new Uint8Array(i[s]).buffer),n);o._subrs=[],o._subrsBias=0,o._defaultWidthX=0,o._nominalWidthX=0;var a=o.private[0],u=o.private[1];if(0!==a&&0!==u){var l=It(t,u+e,a,n);if(o._defaultWidthX=l.defaultWidthX,o._nominalWidthX=l.nominalWidthX,0!==l.subrs){var c=Tt(t,u+l.subrs+e);o._subrs=c.objects,o._subrsBias=St(o._subrs)}o._privateDict=l}r.push(o)}return r}function Bt(t,e,i){var n,r,s,o,a,u,l,c,h=new O,d=[],p=0,f=!1,g=!1,m=0,_=0;if(t.isCIDFont){var y=t.tables.cff.topDict._fdSelect[e.index],x=t.tables.cff.topDict._fdArray[y];a=x._subrs,u=x._subrsBias,l=x._defaultWidthX,c=x._nominalWidthX}else a=t.tables.cff.topDict._subrs,u=t.tables.cff.topDict._subrsBias,l=t.tables.cff.topDict._defaultWidthX,c=t.tables.cff.topDict._nominalWidthX;var w=l;function b(t,e){g&&h.closePath(),h.moveTo(t,e),g=!0}function v(){d.length%2!=0&&!f&&(w=d.shift()+c),p+=d.length>>1,d.length=0,f=!0}return function i(l){for(var y,x,S,T,C,O,N,F,E,D,M,I,V=0;V<l.length;){var B=l[V];switch(V+=1,B){case 1:case 3:case 18:case 23:v();break;case 4:d.length>1&&!f&&(w=d.shift()+c,f=!0),_+=d.pop(),b(m,_);break;case 5:for(;d.length>0;)m+=d.shift(),_+=d.shift(),h.lineTo(m,_);break;case 6:for(;d.length>0&&(m+=d.shift(),h.lineTo(m,_),0!==d.length);)_+=d.shift(),h.lineTo(m,_);break;case 7:for(;d.length>0&&(_+=d.shift(),h.lineTo(m,_),0!==d.length);)m+=d.shift(),h.lineTo(m,_);break;case 8:for(;d.length>0;)n=m+d.shift(),r=_+d.shift(),s=n+d.shift(),o=r+d.shift(),m=s+d.shift(),_=o+d.shift(),h.curveTo(n,r,s,o,m,_);break;case 10:C=d.pop()+u,(O=a[C])&&i(O);break;case 11:return;case 12:switch(B=l[V],V+=1,B){case 35:n=m+d.shift(),r=_+d.shift(),s=n+d.shift(),o=r+d.shift(),N=s+d.shift(),F=o+d.shift(),E=N+d.shift(),D=F+d.shift(),M=E+d.shift(),I=D+d.shift(),m=M+d.shift(),_=I+d.shift(),d.shift(),h.curveTo(n,r,s,o,N,F),h.curveTo(E,D,M,I,m,_);break;case 34:n=m+d.shift(),r=_,s=n+d.shift(),o=r+d.shift(),N=s+d.shift(),F=o,E=N+d.shift(),D=o,M=E+d.shift(),I=_,m=M+d.shift(),h.curveTo(n,r,s,o,N,F),h.curveTo(E,D,M,I,m,_);break;case 36:n=m+d.shift(),r=_+d.shift(),s=n+d.shift(),o=r+d.shift(),N=s+d.shift(),F=o,E=N+d.shift(),D=o,M=E+d.shift(),I=D+d.shift(),m=M+d.shift(),h.curveTo(n,r,s,o,N,F),h.curveTo(E,D,M,I,m,_);break;case 37:n=m+d.shift(),r=_+d.shift(),s=n+d.shift(),o=r+d.shift(),N=s+d.shift(),F=o+d.shift(),E=N+d.shift(),D=F+d.shift(),M=E+d.shift(),I=D+d.shift(),Math.abs(M-m)>Math.abs(I-_)?m=M+d.shift():_=I+d.shift(),h.curveTo(n,r,s,o,N,F),h.curveTo(E,D,M,I,m,_);break;default:console.log("Glyph "+e.index+": unknown operator 1200"+B),d.length=0}break;case 14:d.length>0&&!f&&(w=d.shift()+c,f=!0),g&&(h.closePath(),g=!1);break;case 19:case 20:v(),V+=p+7>>3;break;case 21:d.length>2&&!f&&(w=d.shift()+c,f=!0),_+=d.pop(),b(m+=d.pop(),_);break;case 22:d.length>1&&!f&&(w=d.shift()+c,f=!0),b(m+=d.pop(),_);break;case 24:for(;d.length>2;)n=m+d.shift(),r=_+d.shift(),s=n+d.shift(),o=r+d.shift(),m=s+d.shift(),_=o+d.shift(),h.curveTo(n,r,s,o,m,_);m+=d.shift(),_+=d.shift(),h.lineTo(m,_);break;case 25:for(;d.length>6;)m+=d.shift(),_+=d.shift(),h.lineTo(m,_);n=m+d.shift(),r=_+d.shift(),s=n+d.shift(),o=r+d.shift(),m=s+d.shift(),_=o+d.shift(),h.curveTo(n,r,s,o,m,_);break;case 26:for(d.length%2&&(m+=d.shift());d.length>0;)n=m,r=_+d.shift(),s=n+d.shift(),o=r+d.shift(),m=s,_=o+d.shift(),h.curveTo(n,r,s,o,m,_);break;case 27:for(d.length%2&&(_+=d.shift());d.length>0;)n=m+d.shift(),r=_,s=n+d.shift(),o=r+d.shift(),m=s+d.shift(),_=o,h.curveTo(n,r,s,o,m,_);break;case 28:y=l[V],x=l[V+1],d.push((y<<24|x<<16)>>16),V+=2;break;case 29:C=d.pop()+t.gsubrsBias,(O=t.gsubrs[C])&&i(O);break;case 30:for(;d.length>0&&(n=m,r=_+d.shift(),s=n+d.shift(),o=r+d.shift(),m=s+d.shift(),_=o+(1===d.length?d.shift():0),h.curveTo(n,r,s,o,m,_),0!==d.length);)n=m+d.shift(),r=_,s=n+d.shift(),o=r+d.shift(),_=o+d.shift(),m=s+(1===d.length?d.shift():0),h.curveTo(n,r,s,o,m,_);break;case 31:for(;d.length>0&&(n=m+d.shift(),r=_,s=n+d.shift(),o=r+d.shift(),_=o+d.shift(),m=s+(1===d.length?d.shift():0),h.curveTo(n,r,s,o,m,_),0!==d.length);)n=m,r=_+d.shift(),s=n+d.shift(),o=r+d.shift(),m=s+d.shift(),_=o+(1===d.length?d.shift():0),h.curveTo(n,r,s,o,m,_);break;default:B<32?console.log("Glyph "+e.index+": unknown operator "+B):B<247?d.push(B-139):B<251?(y=l[V],V+=1,d.push(256*(B-247)+y+108)):B<255?(y=l[V],V+=1,d.push(256*-(B-251)-y-108)):(y=l[V],x=l[V+1],S=l[V+2],T=l[V+3],V+=4,d.push((y<<24|x<<16|S<<8|T)/65536))}}}(i),e.advanceWidth=w,h}function At(t,e){var i,n=ut.indexOf(t);return n>=0&&(i=n),(n=e.indexOf(t))>=0?i=n+ut.length:(i=ut.length+e.length,e.push(t)),i}function Rt(t,e,i){for(var n={},r=0;r<t.length;r+=1){var s=t[r],o=e[s.name];void 0===o||vt(o,s.value)||("SID"===s.type&&(o=At(o,i)),n[s.op]={name:s.name,type:s.type,value:o})}return n}function Pt(t,e){var i=new Q.Record("Top DICT",[{name:"dict",type:"DICT",value:{}}]);return i.dict=Rt(Et,t,e),i}function Lt(t){var e=new Q.Record("Top DICT INDEX",[{name:"topDicts",type:"INDEX",value:[]}]);return e.topDicts=[{name:"topDict_0",type:"TABLE",value:t}],e}function Ut(t){var e=[],i=t.path;e.push({name:"width",type:"NUMBER",value:t.advanceWidth});for(var n=0,r=0,s=0;s<i.commands.length;s+=1){var o=void 0,a=void 0,u=i.commands[s];if("Q"===u.type){var l=1/3,c=2/3;u={type:"C",x:u.x,y:u.y,x1:Math.round(l*n+c*u.x1),y1:Math.round(l*r+c*u.y1),x2:Math.round(l*u.x+c*u.x1),y2:Math.round(l*u.y+c*u.y1)}}if("M"===u.type)o=Math.round(u.x-n),a=Math.round(u.y-r),e.push({name:"dx",type:"NUMBER",value:o}),e.push({name:"dy",type:"NUMBER",value:a}),e.push({name:"rmoveto",type:"OP",value:21}),n=Math.round(u.x),r=Math.round(u.y);else if("L"===u.type)o=Math.round(u.x-n),a=Math.round(u.y-r),e.push({name:"dx",type:"NUMBER",value:o}),e.push({name:"dy",type:"NUMBER",value:a}),e.push({name:"rlineto",type:"OP",value:5}),n=Math.round(u.x),r=Math.round(u.y);else if("C"===u.type){var h=Math.round(u.x1-n),d=Math.round(u.y1-r),p=Math.round(u.x2-u.x1),f=Math.round(u.y2-u.y1);o=Math.round(u.x-u.x2),a=Math.round(u.y-u.y2),e.push({name:"dx1",type:"NUMBER",value:h}),e.push({name:"dy1",type:"NUMBER",value:d}),e.push({name:"dx2",type:"NUMBER",value:p}),e.push({name:"dy2",type:"NUMBER",value:f}),e.push({name:"dx",type:"NUMBER",value:o}),e.push({name:"dy",type:"NUMBER",value:a}),e.push({name:"rrcurveto",type:"OP",value:8}),n=Math.round(u.x),r=Math.round(u.y)}}return e.push({name:"endchar",type:"OP",value:14}),e}var kt={parse:function(t,e,i,n){i.tables.cff={};var r=function(t,e){var i={};return i.formatMajor=st.getCard8(t,e),i.formatMinor=st.getCard8(t,e+1),i.size=st.getCard8(t,e+2),i.offsetSize=st.getCard8(t,e+3),i.startOffset=e,i.endOffset=e+4,i}(t,e),s=Tt(t,r.endOffset,st.bytesToString),o=Tt(t,s.endOffset),a=Tt(t,o.endOffset,st.bytesToString),u=Tt(t,a.endOffset);i.gsubrs=u.objects,i.gsubrsBias=St(i.gsubrs);var l=Vt(t,e,o.objects,a.objects);if(1!==l.length)throw new Error("CFF table has too many fonts in 'FontSet' - count of fonts NameIndex.length = "+l.length);var c=l[0];if(i.tables.cff.topDict=c,c._privateDict&&(i.defaultWidthX=c._privateDict.defaultWidthX,i.nominalWidthX=c._privateDict.nominalWidthX),void 0!==c.ros[0]&&void 0!==c.ros[1]&&(i.isCIDFont=!0),i.isCIDFont){var h=c.fdArray,d=c.fdSelect;if(0===h||0===d)throw new Error("Font is marked as a CID font, but FDArray and/or FDSelect information is missing");var p=Tt(t,h+=e),f=Vt(t,e,p.objects,a.objects);c._fdArray=f,d+=e,c._fdSelect=function(t,e,i,n){var r,s=[],o=new st.Parser(t,e),a=o.parseCard8();if(0===a)for(var u=0;u<i;u++){if((r=o.parseCard8())>=n)throw new Error("CFF table CID Font FDSelect has bad FD index value "+r+" (FD count "+n+")");s.push(r)}else{if(3!==a)throw new Error("CFF Table CID Font FDSelect table has unsupported format "+a);var l,c=o.parseCard16(),h=o.parseCard16();if(0!==h)throw new Error("CFF Table CID Font FDSelect format 3 range has bad initial GID "+h);for(var d=0;d<c;d++){if(r=o.parseCard8(),l=o.parseCard16(),r>=n)throw new Error("CFF table CID Font FDSelect has bad FD index value "+r+" (FD count "+n+")");if(l>i)throw new Error("CFF Table CID Font FDSelect format 3 range has bad GID "+l);for(;h<l;h++)s.push(r);h=l}if(l!==i)throw new Error("CFF Table CID Font FDSelect format 3 range has bad final GID "+l)}return s}(t,d,i.numGlyphs,f.length)}var g,m=e+c.private[1],_=It(t,m,c.private[0],a.objects);if(i.defaultWidthX=_.defaultWidthX,i.nominalWidthX=_.nominalWidthX,0!==_.subrs){var y=m+_.subrs,x=Tt(t,y);i.subrs=x.objects,i.subrsBias=St(i.subrs)}else i.subrs=[],i.subrsBias=0;n.lowMemory?(g=function(t,e){var i,n,r=[],s=st.getCard16(t,e);if(0!==s){var o=st.getByte(t,e+2);i=e+(s+1)*o+2;for(var a=e+3,u=0;u<s+1;u+=1)r.push(st.getOffset(t,a,o)),a+=o;n=i+r[s]}else n=e+2;return{offsets:r,startOffset:e,endOffset:n}}(t,e+c.charStrings),i.nGlyphs=g.offsets.length):(g=Tt(t,e+c.charStrings),i.nGlyphs=g.objects.length);var w=function(t,e,i,n){var r,s,o=new st.Parser(t,e);i-=1;var a=[".notdef"],u=o.parseCard8();if(0===u)for(var l=0;l<i;l+=1)r=o.parseSID(),a.push(Nt(n,r));else if(1===u)for(;a.length<=i;){r=o.parseSID(),s=o.parseCard8();for(var c=0;c<=s;c+=1)a.push(Nt(n,r)),r+=1}else{if(2!==u)throw new Error("Unknown charset format "+u);for(;a.length<=i;){r=o.parseSID(),s=o.parseCard16();for(var h=0;h<=s;h+=1)a.push(Nt(n,r)),r+=1}}return a}(t,e+c.charset,i.nGlyphs,a.objects);if(0===c.encoding?i.cffEncoding=new ft(lt,w):1===c.encoding?i.cffEncoding=new ft(ct,w):i.cffEncoding=function(t,e,i){var n,r={},s=new st.Parser(t,e),o=s.parseCard8();if(0===o)for(var a=s.parseCard8(),u=0;u<a;u+=1)r[n=s.parseCard8()]=u;else{if(1!==o)throw new Error("Unknown encoding format "+o);var l=s.parseCard8();n=1;for(var c=0;c<l;c+=1)for(var h=s.parseCard8(),d=s.parseCard8(),p=h;p<=h+d;p+=1)r[p]=n,n+=1}return new ft(r,i)}(t,e+c.encoding,w),i.encoding=i.encoding||i.cffEncoding,i.glyphs=new bt.GlyphSet(i),n.lowMemory)i._push=function(n){var r=function(t,e,i,n,r){var s=st.getCard16(i,n),o=0;0!==s&&(o=n+(s+1)*st.getByte(i,n+2)+2);var a=st.getBytes(i,o+e[t],o+e[t+1]);return r&&(a=r(a)),a}(n,g.offsets,t,e+c.charStrings);i.glyphs.push(n,bt.cffGlyphLoader(i,n,Bt,r))};else for(var b=0;b<i.nGlyphs;b+=1){var v=g.objects[b];i.glyphs.push(b,bt.cffGlyphLoader(i,b,Bt,v))}},make:function(t,e){for(var i,n=new Q.Table("CFF ",[{name:"header",type:"RECORD"},{name:"nameIndex",type:"RECORD"},{name:"topDictIndex",type:"RECORD"},{name:"stringIndex",type:"RECORD"},{name:"globalSubrIndex",type:"RECORD"},{name:"charsets",type:"RECORD"},{name:"charStringsIndex",type:"RECORD"},{name:"privateDict",type:"RECORD"}]),r=1/e.unitsPerEm,s={version:e.version,fullName:e.fullName,familyName:e.familyName,weight:e.weightName,fontBBox:e.fontBBox||[0,0,0,0],fontMatrix:[r,0,0,r,0,0],charset:999,encoding:0,charStrings:999,private:[0,999]},o=[],a=1;a<t.length;a+=1)i=t.get(a),o.push(i.name);var u=[];n.header=new Q.Record("Header",[{name:"major",type:"Card8",value:1},{name:"minor",type:"Card8",value:0},{name:"hdrSize",type:"Card8",value:4},{name:"major",type:"Card8",value:1}]),n.nameIndex=function(t){var e=new Q.Record("Name INDEX",[{name:"names",type:"INDEX",value:[]}]);e.names=[];for(var i=0;i<t.length;i+=1)e.names.push({name:"name_"+i,type:"NAME",value:t[i]});return e}([e.postScriptName]);var l=Pt(s,u);n.topDictIndex=Lt(l),n.globalSubrIndex=new Q.Record("Global Subr INDEX",[{name:"subrs",type:"INDEX",value:[]}]),n.charsets=function(t,e){for(var i=new Q.Record("Charsets",[{name:"format",type:"Card8",value:0}]),n=0;n<t.length;n+=1){var r=At(t[n],e);i.fields.push({name:"glyph_"+n,type:"SID",value:r})}return i}(o,u),n.charStringsIndex=function(t){for(var e=new Q.Record("CharStrings INDEX",[{name:"charStrings",type:"INDEX",value:[]}]),i=0;i<t.length;i+=1){var n=t.get(i),r=Ut(n);e.charStrings.push({name:n.name,type:"CHARSTRING",value:r})}return e}(t),n.privateDict=function(t,e){var i=new Q.Record("Private DICT",[{name:"dict",type:"DICT",value:{}}]);return i.dict=Rt(Dt,t,e),i}({},u),n.stringIndex=function(t){var e=new Q.Record("String INDEX",[{name:"strings",type:"INDEX",value:[]}]);e.strings=[];for(var i=0;i<t.length;i+=1)e.strings.push({name:"string_"+i,type:"STRING",value:t[i]});return e}(u);var c=n.header.sizeOf()+n.nameIndex.sizeOf()+n.topDictIndex.sizeOf()+n.stringIndex.sizeOf()+n.globalSubrIndex.sizeOf();return s.charset=c,s.encoding=0,s.charStrings=s.charset+n.charsets.sizeOf(),s.private[1]=s.charStrings+n.charStringsIndex.sizeOf(),l=Pt(s,u),n.topDictIndex=Lt(l),n}};var Xt={parse:function(t,e){var i={},n=new st.Parser(t,e);return i.version=n.parseVersion(),i.fontRevision=Math.round(1e3*n.parseFixed())/1e3,i.checkSumAdjustment=n.parseULong(),i.magicNumber=n.parseULong(),E.argument(1594834165===i.magicNumber,"Font header has wrong magic number."),i.flags=n.parseUShort(),i.unitsPerEm=n.parseUShort(),i.created=n.parseLongDateTime(),i.modified=n.parseLongDateTime(),i.xMin=n.parseShort(),i.yMin=n.parseShort(),i.xMax=n.parseShort(),i.yMax=n.parseShort(),i.macStyle=n.parseUShort(),i.lowestRecPPEM=n.parseUShort(),i.fontDirectionHint=n.parseShort(),i.indexToLocFormat=n.parseShort(),i.glyphDataFormat=n.parseShort(),i},make:function(t){var e=Math.round((new Date).getTime()/1e3)+2082844800,i=e;return t.createdTimestamp&&(i=t.createdTimestamp+2082844800),new Q.Table("head",[{name:"version",type:"FIXED",value:65536},{name:"fontRevision",type:"FIXED",value:65536},{name:"checkSumAdjustment",type:"ULONG",value:0},{name:"magicNumber",type:"ULONG",value:1594834165},{name:"flags",type:"USHORT",value:0},{name:"unitsPerEm",type:"USHORT",value:1e3},{name:"created",type:"LONGDATETIME",value:i},{name:"modified",type:"LONGDATETIME",value:e},{name:"xMin",type:"SHORT",value:0},{name:"yMin",type:"SHORT",value:0},{name:"xMax",type:"SHORT",value:0},{name:"yMax",type:"SHORT",value:0},{name:"macStyle",type:"USHORT",value:0},{name:"lowestRecPPEM",type:"USHORT",value:0},{name:"fontDirectionHint",type:"SHORT",value:2},{name:"indexToLocFormat",type:"SHORT",value:0},{name:"glyphDataFormat",type:"SHORT",value:0}],t)}};var zt={parse:function(t,e){var i={},n=new st.Parser(t,e);return i.version=n.parseVersion(),i.ascender=n.parseShort(),i.descender=n.parseShort(),i.lineGap=n.parseShort(),i.advanceWidthMax=n.parseUShort(),i.minLeftSideBearing=n.parseShort(),i.minRightSideBearing=n.parseShort(),i.xMaxExtent=n.parseShort(),i.caretSlopeRise=n.parseShort(),i.caretSlopeRun=n.parseShort(),i.caretOffset=n.parseShort(),n.relativeOffset+=8,i.metricDataFormat=n.parseShort(),i.numberOfHMetrics=n.parseUShort(),i},make:function(t){return new Q.Table("hhea",[{name:"version",type:"FIXED",value:65536},{name:"ascender",type:"FWORD",value:0},{name:"descender",type:"FWORD",value:0},{name:"lineGap",type:"FWORD",value:0},{name:"advanceWidthMax",type:"UFWORD",value:0},{name:"minLeftSideBearing",type:"FWORD",value:0},{name:"minRightSideBearing",type:"FWORD",value:0},{name:"xMaxExtent",type:"FWORD",value:0},{name:"caretSlopeRise",type:"SHORT",value:1},{name:"caretSlopeRun",type:"SHORT",value:0},{name:"caretOffset",type:"SHORT",value:0},{name:"reserved1",type:"SHORT",value:0},{name:"reserved2",type:"SHORT",value:0},{name:"reserved3",type:"SHORT",value:0},{name:"reserved4",type:"SHORT",value:0},{name:"metricDataFormat",type:"SHORT",value:0},{name:"numberOfHMetrics",type:"USHORT",value:0}],t)}};var jt={parse:function(t,e,i,n,r,s,o){o.lowMemory?function(t,e,i,n,r){var s,o;t._hmtxTableData={};for(var a=new st.Parser(e,i),u=0;u<r;u+=1)u<n&&(s=a.parseUShort(),o=a.parseShort()),t._hmtxTableData[u]={advanceWidth:s,leftSideBearing:o}}(t,e,i,n,r):function(t,e,i,n,r){for(var s,o,a=new st.Parser(t,e),u=0;u<n;u+=1){u<i&&(s=a.parseUShort(),o=a.parseShort());var l=r.get(u);l.advanceWidth=s,l.leftSideBearing=o}}(e,i,n,r,s)},make:function(t){for(var e=new Q.Table("hmtx",[]),i=0;i<t.length;i+=1){var n=t.get(i),r=n.advanceWidth||0,s=n.leftSideBearing||0;e.fields.push({name:"advanceWidth_"+i,type:"USHORT",value:r}),e.fields.push({name:"leftSideBearing_"+i,type:"SHORT",value:s})}return e}};var Gt={make:function(t){for(var e=new Q.Table("ltag",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"numTags",type:"ULONG",value:t.length}]),i="",n=12+4*t.length,r=0;r<t.length;++r){var s=i.indexOf(t[r]);s<0&&(s=i.length,i+=t[r]),e.fields.push({name:"offset "+r,type:"USHORT",value:n+s}),e.fields.push({name:"length "+r,type:"USHORT",value:t[r].length})}return e.fields.push({name:"stringPool",type:"CHARARRAY",value:i}),e},parse:function(t,e){var i=new st.Parser(t,e),n=i.parseULong();E.argument(1===n,"Unsupported ltag table version."),i.skip("uLong",1);for(var r=i.parseULong(),s=[],o=0;o<r;o++){for(var a="",u=e+i.parseUShort(),l=i.parseUShort(),c=u;c<u+l;++c)a+=String.fromCharCode(t.getInt8(c));s.push(a)}return s}};var qt={parse:function(t,e){var i={},n=new st.Parser(t,e);return i.version=n.parseVersion(),i.numGlyphs=n.parseUShort(),1===i.version&&(i.maxPoints=n.parseUShort(),i.maxContours=n.parseUShort(),i.maxCompositePoints=n.parseUShort(),i.maxCompositeContours=n.parseUShort(),i.maxZones=n.parseUShort(),i.maxTwilightPoints=n.parseUShort(),i.maxStorage=n.parseUShort(),i.maxFunctionDefs=n.parseUShort(),i.maxInstructionDefs=n.parseUShort(),i.maxStackElements=n.parseUShort(),i.maxSizeOfInstructions=n.parseUShort(),i.maxComponentElements=n.parseUShort(),i.maxComponentDepth=n.parseUShort()),i},make:function(t){return new Q.Table("maxp",[{name:"version",type:"FIXED",value:20480},{name:"numGlyphs",type:"USHORT",value:t}])}},Ht=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","license","licenseURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"],Wt={0:"en",1:"fr",2:"de",3:"it",4:"nl",5:"sv",6:"es",7:"da",8:"pt",9:"no",10:"he",11:"ja",12:"ar",13:"fi",14:"el",15:"is",16:"mt",17:"tr",18:"hr",19:"zh-Hant",20:"ur",21:"hi",22:"th",23:"ko",24:"lt",25:"pl",26:"hu",27:"es",28:"lv",29:"se",30:"fo",31:"fa",32:"ru",33:"zh",34:"nl-BE",35:"ga",36:"sq",37:"ro",38:"cz",39:"sk",40:"si",41:"yi",42:"sr",43:"mk",44:"bg",45:"uk",46:"be",47:"uz",48:"kk",49:"az-Cyrl",50:"az-Arab",51:"hy",52:"ka",53:"mo",54:"ky",55:"tg",56:"tk",57:"mn-CN",58:"mn",59:"ps",60:"ks",61:"ku",62:"sd",63:"bo",64:"ne",65:"sa",66:"mr",67:"bn",68:"as",69:"gu",70:"pa",71:"or",72:"ml",73:"kn",74:"ta",75:"te",76:"si",77:"my",78:"km",79:"lo",80:"vi",81:"id",82:"tl",83:"ms",84:"ms-Arab",85:"am",86:"ti",87:"om",88:"so",89:"sw",90:"rw",91:"rn",92:"ny",93:"mg",94:"eo",128:"cy",129:"eu",130:"ca",131:"la",132:"qu",133:"gn",134:"ay",135:"tt",136:"ug",137:"dz",138:"jv",139:"su",140:"gl",141:"af",142:"br",143:"iu",144:"gd",145:"gv",146:"ga",147:"to",148:"el-polyton",149:"kl",150:"az",151:"nn"},Yt={0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:5,11:1,12:4,13:0,14:6,15:0,16:0,17:0,18:0,19:2,20:4,21:9,22:21,23:3,24:29,25:29,26:29,27:29,28:29,29:0,30:0,31:4,32:7,33:25,34:0,35:0,36:0,37:0,38:29,39:29,40:0,41:5,42:7,43:7,44:7,45:7,46:7,47:7,48:7,49:7,50:4,51:24,52:23,53:7,54:7,55:7,56:7,57:27,58:7,59:4,60:4,61:4,62:4,63:26,64:9,65:9,66:9,67:13,68:13,69:11,70:10,71:12,72:17,73:16,74:14,75:15,76:18,77:19,78:20,79:22,80:30,81:0,82:0,83:0,84:4,85:28,86:28,87:28,88:0,89:0,90:0,91:0,92:0,93:0,94:0,128:0,129:0,130:0,131:0,132:0,133:0,134:0,135:7,136:4,137:26,138:0,139:0,140:0,141:0,142:0,143:28,144:0,145:0,146:0,147:0,148:6,149:0,150:0,151:0},Zt={1078:"af",1052:"sq",1156:"gsw",1118:"am",5121:"ar-DZ",15361:"ar-BH",3073:"ar",2049:"ar-IQ",11265:"ar-JO",13313:"ar-KW",12289:"ar-LB",4097:"ar-LY",6145:"ary",8193:"ar-OM",16385:"ar-QA",1025:"ar-SA",10241:"ar-SY",7169:"aeb",14337:"ar-AE",9217:"ar-YE",1067:"hy",1101:"as",2092:"az-Cyrl",1068:"az",1133:"ba",1069:"eu",1059:"be",2117:"bn",1093:"bn-IN",8218:"bs-Cyrl",5146:"bs",1150:"br",1026:"bg",1027:"ca",3076:"zh-HK",5124:"zh-MO",2052:"zh",4100:"zh-SG",1028:"zh-TW",1155:"co",1050:"hr",4122:"hr-BA",1029:"cs",1030:"da",1164:"prs",1125:"dv",2067:"nl-BE",1043:"nl",3081:"en-AU",10249:"en-BZ",4105:"en-CA",9225:"en-029",16393:"en-IN",6153:"en-IE",8201:"en-JM",17417:"en-MY",5129:"en-NZ",13321:"en-PH",18441:"en-SG",7177:"en-ZA",11273:"en-TT",2057:"en-GB",1033:"en",12297:"en-ZW",1061:"et",1080:"fo",1124:"fil",1035:"fi",2060:"fr-BE",3084:"fr-CA",1036:"fr",5132:"fr-LU",6156:"fr-MC",4108:"fr-CH",1122:"fy",1110:"gl",1079:"ka",3079:"de-AT",1031:"de",5127:"de-LI",4103:"de-LU",2055:"de-CH",1032:"el",1135:"kl",1095:"gu",1128:"ha",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig",1057:"id",1117:"iu",2141:"iu-Latn",2108:"ga",1076:"xh",1077:"zu",1040:"it",2064:"it-CH",1041:"ja",1099:"kn",1087:"kk",1107:"km",1158:"quc",1159:"rw",1089:"sw",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1062:"lv",1063:"lt",2094:"dsb",1134:"lb",1071:"mk",2110:"ms-BN",1086:"ms",1100:"ml",1082:"mt",1153:"mi",1146:"arn",1102:"mr",1148:"moh",1104:"mn",2128:"mn-CN",1121:"ne",1044:"nb",2068:"nn",1154:"oc",1096:"or",1123:"ps",1045:"pl",1046:"pt",2070:"pt-PT",1094:"pa",1131:"qu-BO",2155:"qu-EC",3179:"qu",1048:"ro",1047:"rm",1049:"ru",9275:"smn",4155:"smj-NO",5179:"smj",3131:"se-FI",1083:"se",2107:"se-SE",8251:"sms",6203:"sma-NO",7227:"sms",1103:"sa",7194:"sr-Cyrl-BA",3098:"sr",6170:"sr-Latn-BA",2074:"sr-Latn",1132:"nso",1074:"tn",1115:"si",1051:"sk",1060:"sl",11274:"es-AR",16394:"es-BO",13322:"es-CL",9226:"es-CO",5130:"es-CR",7178:"es-DO",12298:"es-EC",17418:"es-SV",4106:"es-GT",18442:"es-HN",2058:"es-MX",19466:"es-NI",6154:"es-PA",15370:"es-PY",10250:"es-PE",20490:"es-PR",3082:"es",1034:"es",21514:"es-US",14346:"es-UY",8202:"es-VE",2077:"sv-FI",1053:"sv",1114:"syr",1064:"tg",2143:"tzm",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1055:"tr",1090:"tk",1152:"ug",1058:"uk",1070:"hsb",1056:"ur",2115:"uz-Cyrl",1091:"uz",1066:"vi",1106:"cy",1160:"wo",1157:"sah",1144:"ii",1130:"yo"};function Kt(t,e,i){switch(t){case 0:if(65535===e)return"und";if(i)return i[e];break;case 1:return Wt[e];case 3:return Zt[e]}}var Qt="utf-16",$t={0:"macintosh",1:"x-mac-japanese",2:"x-mac-chinesetrad",3:"x-mac-korean",6:"x-mac-greek",7:"x-mac-cyrillic",9:"x-mac-devanagai",10:"x-mac-gurmukhi",11:"x-mac-gujarati",12:"x-mac-oriya",13:"x-mac-bengali",14:"x-mac-tamil",15:"x-mac-telugu",16:"x-mac-kannada",17:"x-mac-malayalam",18:"x-mac-sinhalese",19:"x-mac-burmese",20:"x-mac-khmer",21:"x-mac-thai",22:"x-mac-lao",23:"x-mac-georgian",24:"x-mac-armenian",25:"x-mac-chinesesimp",26:"x-mac-tibetan",27:"x-mac-mongolian",28:"x-mac-ethiopic",29:"x-mac-ce",30:"x-mac-vietnamese",31:"x-mac-extarabic"},Jt={15:"x-mac-icelandic",17:"x-mac-turkish",18:"x-mac-croatian",24:"x-mac-ce",25:"x-mac-ce",26:"x-mac-ce",27:"x-mac-ce",28:"x-mac-ce",30:"x-mac-icelandic",37:"x-mac-romanian",38:"x-mac-ce",39:"x-mac-ce",40:"x-mac-ce",143:"x-mac-inuit",146:"x-mac-gaelic"};function te(t,e,i){switch(t){case 0:return Qt;case 1:return Jt[i]||$t[e];case 3:if(1===e||10===e)return Qt}}function ee(t){var e={};for(var i in t)e[t[i]]=parseInt(i);return e}function ie(t,e,i,n,r,s){return new Q.Record("NameRecord",[{name:"platformID",type:"USHORT",value:t},{name:"encodingID",type:"USHORT",value:e},{name:"languageID",type:"USHORT",value:i},{name:"nameID",type:"USHORT",value:n},{name:"length",type:"USHORT",value:r},{name:"offset",type:"USHORT",value:s}])}function ne(t,e){var i=function(t,e){var i=t.length,n=e.length-i+1;t:for(var r=0;r<n;r++)for(;r<n;r++){for(var s=0;s<i;s++)if(e[r+s]!==t[s])continue t;return r}return-1}(t,e);if(i<0){i=e.length;for(var n=0,r=t.length;n<r;++n)e.push(t[n])}return i}var re={parse:function(t,e,i){for(var n={},r=new st.Parser(t,e),s=r.parseUShort(),o=r.parseUShort(),a=r.offset+r.parseUShort(),u=0;u<o;u++){var l=r.parseUShort(),c=r.parseUShort(),h=r.parseUShort(),d=r.parseUShort(),p=Ht[d]||d,f=r.parseUShort(),g=r.parseUShort(),m=Kt(l,h,i),_=te(l,c,h);if(void 0!==_&&void 0!==m){var y=void 0;if(y=_===Qt?M.UTF16(t,a+g,f):M.MACSTRING(t,a+g,f,_)){var x=n[p];void 0===x&&(x=n[p]={}),x[m]=y}}}return 1===s&&r.parseUShort(),n},make:function(t,e){var i,n=[],r={},s=ee(Ht);for(var o in t){var a=s[o];if(void 0===a&&(a=o),i=parseInt(a),isNaN(i))throw new Error('Name table entry "'+o+'" does not exist, see nameTableNames for complete list.');r[i]=t[o],n.push(i)}for(var u=ee(Wt),l=ee(Zt),c=[],h=[],d=0;d<n.length;d++){var p=r[i=n[d]];for(var f in p){var g=p[f],m=1,_=u[f],y=Yt[_],x=te(m,y,_),w=I.MACSTRING(g,x);void 0===w&&(m=0,(_=e.indexOf(f))<0&&(_=e.length,e.push(f)),y=4,w=I.UTF16(g));var b=ne(w,h);c.push(ie(m,y,_,i,w.length,b));var v=l[f];if(void 0!==v){var S=I.UTF16(g),T=ne(S,h);c.push(ie(3,1,v,i,S.length,T))}}}c.sort((function(t,e){return t.platformID-e.platformID||t.encodingID-e.encodingID||t.languageID-e.languageID||t.nameID-e.nameID}));for(var C=new Q.Table("name",[{name:"format",type:"USHORT",value:0},{name:"count",type:"USHORT",value:c.length},{name:"stringOffset",type:"USHORT",value:6+12*c.length}]),O=0;O<c.length;O++)C.fields.push({name:"record_"+O,type:"RECORD",value:c[O]});return C.fields.push({name:"strings",type:"LITERAL",value:h}),C}},se=[{begin:0,end:127},{begin:128,end:255},{begin:256,end:383},{begin:384,end:591},{begin:592,end:687},{begin:688,end:767},{begin:768,end:879},{begin:880,end:1023},{begin:11392,end:11519},{begin:1024,end:1279},{begin:1328,end:1423},{begin:1424,end:1535},{begin:42240,end:42559},{begin:1536,end:1791},{begin:1984,end:2047},{begin:2304,end:2431},{begin:2432,end:2559},{begin:2560,end:2687},{begin:2688,end:2815},{begin:2816,end:2943},{begin:2944,end:3071},{begin:3072,end:3199},{begin:3200,end:3327},{begin:3328,end:3455},{begin:3584,end:3711},{begin:3712,end:3839},{begin:4256,end:4351},{begin:6912,end:7039},{begin:4352,end:4607},{begin:7680,end:7935},{begin:7936,end:8191},{begin:8192,end:8303},{begin:8304,end:8351},{begin:8352,end:8399},{begin:8400,end:8447},{begin:8448,end:8527},{begin:8528,end:8591},{begin:8592,end:8703},{begin:8704,end:8959},{begin:8960,end:9215},{begin:9216,end:9279},{begin:9280,end:9311},{begin:9312,end:9471},{begin:9472,end:9599},{begin:9600,end:9631},{begin:9632,end:9727},{begin:9728,end:9983},{begin:9984,end:10175},{begin:12288,end:12351},{begin:12352,end:12447},{begin:12448,end:12543},{begin:12544,end:12591},{begin:12592,end:12687},{begin:43072,end:43135},{begin:12800,end:13055},{begin:13056,end:13311},{begin:44032,end:55215},{begin:55296,end:57343},{begin:67840,end:67871},{begin:19968,end:40959},{begin:57344,end:63743},{begin:12736,end:12783},{begin:64256,end:64335},{begin:64336,end:65023},{begin:65056,end:65071},{begin:65040,end:65055},{begin:65104,end:65135},{begin:65136,end:65279},{begin:65280,end:65519},{begin:65520,end:65535},{begin:3840,end:4095},{begin:1792,end:1871},{begin:1920,end:1983},{begin:3456,end:3583},{begin:4096,end:4255},{begin:4608,end:4991},{begin:5024,end:5119},{begin:5120,end:5759},{begin:5760,end:5791},{begin:5792,end:5887},{begin:6016,end:6143},{begin:6144,end:6319},{begin:10240,end:10495},{begin:40960,end:42127},{begin:5888,end:5919},{begin:66304,end:66351},{begin:66352,end:66383},{begin:66560,end:66639},{begin:118784,end:119039},{begin:119808,end:120831},{begin:1044480,end:1048573},{begin:65024,end:65039},{begin:917504,end:917631},{begin:6400,end:6479},{begin:6480,end:6527},{begin:6528,end:6623},{begin:6656,end:6687},{begin:11264,end:11359},{begin:11568,end:11647},{begin:19904,end:19967},{begin:43008,end:43055},{begin:65536,end:65663},{begin:65856,end:65935},{begin:66432,end:66463},{begin:66464,end:66527},{begin:66640,end:66687},{begin:66688,end:66735},{begin:67584,end:67647},{begin:68096,end:68191},{begin:119552,end:119647},{begin:73728,end:74751},{begin:119648,end:119679},{begin:7040,end:7103},{begin:7168,end:7247},{begin:7248,end:7295},{begin:43136,end:43231},{begin:43264,end:43311},{begin:43312,end:43359},{begin:43520,end:43615},{begin:65936,end:65999},{begin:66e3,end:66047},{begin:66208,end:66271},{begin:127024,end:127135}];var oe={parse:function(t,e){var i={},n=new st.Parser(t,e);i.version=n.parseUShort(),i.xAvgCharWidth=n.parseShort(),i.usWeightClass=n.parseUShort(),i.usWidthClass=n.parseUShort(),i.fsType=n.parseUShort(),i.ySubscriptXSize=n.parseShort(),i.ySubscriptYSize=n.parseShort(),i.ySubscriptXOffset=n.parseShort(),i.ySubscriptYOffset=n.parseShort(),i.ySuperscriptXSize=n.parseShort(),i.ySuperscriptYSize=n.parseShort(),i.ySuperscriptXOffset=n.parseShort(),i.ySuperscriptYOffset=n.parseShort(),i.yStrikeoutSize=n.parseShort(),i.yStrikeoutPosition=n.parseShort(),i.sFamilyClass=n.parseShort(),i.panose=[];for(var r=0;r<10;r++)i.panose[r]=n.parseByte();return i.ulUnicodeRange1=n.parseULong(),i.ulUnicodeRange2=n.parseULong(),i.ulUnicodeRange3=n.parseULong(),i.ulUnicodeRange4=n.parseULong(),i.achVendID=String.fromCharCode(n.parseByte(),n.parseByte(),n.parseByte(),n.parseByte()),i.fsSelection=n.parseUShort(),i.usFirstCharIndex=n.parseUShort(),i.usLastCharIndex=n.parseUShort(),i.sTypoAscender=n.parseShort(),i.sTypoDescender=n.parseShort(),i.sTypoLineGap=n.parseShort(),i.usWinAscent=n.parseUShort(),i.usWinDescent=n.parseUShort(),i.version>=1&&(i.ulCodePageRange1=n.parseULong(),i.ulCodePageRange2=n.parseULong()),i.version>=2&&(i.sxHeight=n.parseShort(),i.sCapHeight=n.parseShort(),i.usDefaultChar=n.parseUShort(),i.usBreakChar=n.parseUShort(),i.usMaxContent=n.parseUShort()),i},make:function(t){return new Q.Table("OS/2",[{name:"version",type:"USHORT",value:3},{name:"xAvgCharWidth",type:"SHORT",value:0},{name:"usWeightClass",type:"USHORT",value:0},{name:"usWidthClass",type:"USHORT",value:0},{name:"fsType",type:"USHORT",value:0},{name:"ySubscriptXSize",type:"SHORT",value:650},{name:"ySubscriptYSize",type:"SHORT",value:699},{name:"ySubscriptXOffset",type:"SHORT",value:0},{name:"ySubscriptYOffset",type:"SHORT",value:140},{name:"ySuperscriptXSize",type:"SHORT",value:650},{name:"ySuperscriptYSize",type:"SHORT",value:699},{name:"ySuperscriptXOffset",type:"SHORT",value:0},{name:"ySuperscriptYOffset",type:"SHORT",value:479},{name:"yStrikeoutSize",type:"SHORT",value:49},{name:"yStrikeoutPosition",type:"SHORT",value:258},{name:"sFamilyClass",type:"SHORT",value:0},{name:"bFamilyType",type:"BYTE",value:0},{name:"bSerifStyle",type:"BYTE",value:0},{name:"bWeight",type:"BYTE",value:0},{name:"bProportion",type:"BYTE",value:0},{name:"bContrast",type:"BYTE",value:0},{name:"bStrokeVariation",type:"BYTE",value:0},{name:"bArmStyle",type:"BYTE",value:0},{name:"bLetterform",type:"BYTE",value:0},{name:"bMidline",type:"BYTE",value:0},{name:"bXHeight",type:"BYTE",value:0},{name:"ulUnicodeRange1",type:"ULONG",value:0},{name:"ulUnicodeRange2",type:"ULONG",value:0},{name:"ulUnicodeRange3",type:"ULONG",value:0},{name:"ulUnicodeRange4",type:"ULONG",value:0},{name:"achVendID",type:"CHARARRAY",value:"XXXX"},{name:"fsSelection",type:"USHORT",value:0},{name:"usFirstCharIndex",type:"USHORT",value:0},{name:"usLastCharIndex",type:"USHORT",value:0},{name:"sTypoAscender",type:"SHORT",value:0},{name:"sTypoDescender",type:"SHORT",value:0},{name:"sTypoLineGap",type:"SHORT",value:0},{name:"usWinAscent",type:"USHORT",value:0},{name:"usWinDescent",type:"USHORT",value:0},{name:"ulCodePageRange1",type:"ULONG",value:0},{name:"ulCodePageRange2",type:"ULONG",value:0},{name:"sxHeight",type:"SHORT",value:0},{name:"sCapHeight",type:"SHORT",value:0},{name:"usDefaultChar",type:"USHORT",value:0},{name:"usBreakChar",type:"USHORT",value:0},{name:"usMaxContext",type:"USHORT",value:0}],t)},unicodeRanges:se,getUnicodeRange:function(t){for(var e=0;e<se.length;e+=1){var i=se[e];if(t>=i.begin&&t<i.end)return e}return-1}};var ae={parse:function(t,e){var i={},n=new st.Parser(t,e);switch(i.version=n.parseVersion(),i.italicAngle=n.parseFixed(),i.underlinePosition=n.parseShort(),i.underlineThickness=n.parseShort(),i.isFixedPitch=n.parseULong(),i.minMemType42=n.parseULong(),i.maxMemType42=n.parseULong(),i.minMemType1=n.parseULong(),i.maxMemType1=n.parseULong(),i.version){case 1:i.names=ht.slice();break;case 2:i.numberOfGlyphs=n.parseUShort(),i.glyphNameIndex=new Array(i.numberOfGlyphs);for(var r=0;r<i.numberOfGlyphs;r++)i.glyphNameIndex[r]=n.parseUShort();i.names=[];for(var s=0;s<i.numberOfGlyphs;s++)if(i.glyphNameIndex[s]>=ht.length){var o=n.parseChar();i.names.push(n.parseString(o))}break;case 2.5:i.numberOfGlyphs=n.parseUShort(),i.offset=new Array(i.numberOfGlyphs);for(var a=0;a<i.numberOfGlyphs;a++)i.offset[a]=n.parseChar()}return i},make:function(){return new Q.Table("post",[{name:"version",type:"FIXED",value:196608},{name:"italicAngle",type:"FIXED",value:0},{name:"underlinePosition",type:"FWORD",value:0},{name:"underlineThickness",type:"FWORD",value:0},{name:"isFixedPitch",type:"ULONG",value:0},{name:"minMemType42",type:"ULONG",value:0},{name:"maxMemType42",type:"ULONG",value:0},{name:"minMemType1",type:"ULONG",value:0},{name:"maxMemType1",type:"ULONG",value:0}])}},ue=new Array(9);ue[1]=function(){var t=this.offset+this.relativeOffset,e=this.parseUShort();return 1===e?{substFormat:1,coverage:this.parsePointer(nt.coverage),deltaGlyphId:this.parseUShort()}:2===e?{substFormat:2,coverage:this.parsePointer(nt.coverage),substitute:this.parseOffset16List()}:void E.assert(!1,"0x"+t.toString(16)+": lookup type 1 format must be 1 or 2.")},ue[2]=function(){var t=this.parseUShort();return E.argument(1===t,"GSUB Multiple Substitution Subtable identifier-format must be 1"),{substFormat:t,coverage:this.parsePointer(nt.coverage),sequences:this.parseListOfLists()}},ue[3]=function(){var t=this.parseUShort();return E.argument(1===t,"GSUB Alternate Substitution Subtable identifier-format must be 1"),{substFormat:t,coverage:this.parsePointer(nt.coverage),alternateSets:this.parseListOfLists()}},ue[4]=function(){var t=this.parseUShort();return E.argument(1===t,"GSUB ligature table identifier-format must be 1"),{substFormat:t,coverage:this.parsePointer(nt.coverage),ligatureSets:this.parseListOfLists((function(){return{ligGlyph:this.parseUShort(),components:this.parseUShortList(this.parseUShort()-1)}}))}};var le={sequenceIndex:nt.uShort,lookupListIndex:nt.uShort};ue[5]=function(){var t=this.offset+this.relativeOffset,e=this.parseUShort();if(1===e)return{substFormat:e,coverage:this.parsePointer(nt.coverage),ruleSets:this.parseListOfLists((function(){var t=this.parseUShort(),e=this.parseUShort();return{input:this.parseUShortList(t-1),lookupRecords:this.parseRecordList(e,le)}}))};if(2===e)return{substFormat:e,coverage:this.parsePointer(nt.coverage),classDef:this.parsePointer(nt.classDef),classSets:this.parseListOfLists((function(){var t=this.parseUShort(),e=this.parseUShort();return{classes:this.parseUShortList(t-1),lookupRecords:this.parseRecordList(e,le)}}))};if(3===e){var i=this.parseUShort(),n=this.parseUShort();return{substFormat:e,coverages:this.parseList(i,nt.pointer(nt.coverage)),lookupRecords:this.parseRecordList(n,le)}}E.assert(!1,"0x"+t.toString(16)+": lookup type 5 format must be 1, 2 or 3.")},ue[6]=function(){var t=this.offset+this.relativeOffset,e=this.parseUShort();return 1===e?{substFormat:1,coverage:this.parsePointer(nt.coverage),chainRuleSets:this.parseListOfLists((function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(le)}}))}:2===e?{substFormat:2,coverage:this.parsePointer(nt.coverage),backtrackClassDef:this.parsePointer(nt.classDef),inputClassDef:this.parsePointer(nt.classDef),lookaheadClassDef:this.parsePointer(nt.classDef),chainClassSet:this.parseListOfLists((function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(le)}}))}:3===e?{substFormat:3,backtrackCoverage:this.parseList(nt.pointer(nt.coverage)),inputCoverage:this.parseList(nt.pointer(nt.coverage)),lookaheadCoverage:this.parseList(nt.pointer(nt.coverage)),lookupRecords:this.parseRecordList(le)}:void E.assert(!1,"0x"+t.toString(16)+": lookup type 6 format must be 1, 2 or 3.")},ue[7]=function(){var t=this.parseUShort();E.argument(1===t,"GSUB Extension Substitution subtable identifier-format must be 1");var e=this.parseUShort(),i=new nt(this.data,this.offset+this.parseULong());return{substFormat:1,lookupType:e,extension:ue[e].call(i)}},ue[8]=function(){var t=this.parseUShort();return E.argument(1===t,"GSUB Reverse Chaining Contextual Single Substitution Subtable identifier-format must be 1"),{substFormat:t,coverage:this.parsePointer(nt.coverage),backtrackCoverage:this.parseList(nt.pointer(nt.coverage)),lookaheadCoverage:this.parseList(nt.pointer(nt.coverage)),substitutes:this.parseUShortList()}};var ce=new Array(9);ce[1]=function(t){return 1===t.substFormat?new Q.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new Q.Coverage(t.coverage)},{name:"deltaGlyphID",type:"USHORT",value:t.deltaGlyphId}]):new Q.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:2},{name:"coverage",type:"TABLE",value:new Q.Coverage(t.coverage)}].concat(Q.ushortList("substitute",t.substitute)))},ce[2]=function(t){return E.assert(1===t.substFormat,"Lookup type 2 substFormat must be 1."),new Q.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new Q.Coverage(t.coverage)}].concat(Q.tableList("seqSet",t.sequences,(function(t){return new Q.Table("sequenceSetTable",Q.ushortList("sequence",t))}))))},ce[3]=function(t){return E.assert(1===t.substFormat,"Lookup type 3 substFormat must be 1."),new Q.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new Q.Coverage(t.coverage)}].concat(Q.tableList("altSet",t.alternateSets,(function(t){return new Q.Table("alternateSetTable",Q.ushortList("alternate",t))}))))},ce[4]=function(t){return E.assert(1===t.substFormat,"Lookup type 4 substFormat must be 1."),new Q.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new Q.Coverage(t.coverage)}].concat(Q.tableList("ligSet",t.ligatureSets,(function(t){return new Q.Table("ligatureSetTable",Q.tableList("ligature",t,(function(t){return new Q.Table("ligatureTable",[{name:"ligGlyph",type:"USHORT",value:t.ligGlyph}].concat(Q.ushortList("component",t.components,t.components.length+1)))})))}))))},ce[6]=function(t){if(1===t.substFormat){var e=new Q.Table("chainContextTable",[{name:"substFormat",type:"USHORT",value:t.substFormat},{name:"coverage",type:"TABLE",value:new Q.Coverage(t.coverage)}].concat(Q.tableList("chainRuleSet",t.chainRuleSets,(function(t){return new Q.Table("chainRuleSetTable",Q.tableList("chainRule",t,(function(t){var e=Q.ushortList("backtrackGlyph",t.backtrack,t.backtrack.length).concat(Q.ushortList("inputGlyph",t.input,t.input.length+1)).concat(Q.ushortList("lookaheadGlyph",t.lookahead,t.lookahead.length)).concat(Q.ushortList("substitution",[],t.lookupRecords.length));return t.lookupRecords.forEach((function(t,i){e=e.concat({name:"sequenceIndex"+i,type:"USHORT",value:t.sequenceIndex}).concat({name:"lookupListIndex"+i,type:"USHORT",value:t.lookupListIndex})})),new Q.Table("chainRuleTable",e)})))}))));return e}if(2===t.substFormat)E.assert(!1,"lookup type 6 format 2 is not yet supported.");else if(3===t.substFormat){var i=[{name:"substFormat",type:"USHORT",value:t.substFormat}];return i.push({name:"backtrackGlyphCount",type:"USHORT",value:t.backtrackCoverage.length}),t.backtrackCoverage.forEach((function(t,e){i.push({name:"backtrackCoverage"+e,type:"TABLE",value:new Q.Coverage(t)})})),i.push({name:"inputGlyphCount",type:"USHORT",value:t.inputCoverage.length}),t.inputCoverage.forEach((function(t,e){i.push({name:"inputCoverage"+e,type:"TABLE",value:new Q.Coverage(t)})})),i.push({name:"lookaheadGlyphCount",type:"USHORT",value:t.lookaheadCoverage.length}),t.lookaheadCoverage.forEach((function(t,e){i.push({name:"lookaheadCoverage"+e,type:"TABLE",value:new Q.Coverage(t)})})),i.push({name:"substitutionCount",type:"USHORT",value:t.lookupRecords.length}),t.lookupRecords.forEach((function(t,e){i=i.concat({name:"sequenceIndex"+e,type:"USHORT",value:t.sequenceIndex}).concat({name:"lookupListIndex"+e,type:"USHORT",value:t.lookupListIndex})})),new Q.Table("chainContextTable",i)}E.assert(!1,"lookup type 6 format must be 1, 2 or 3.")};var he={parse:function(t,e){var i=new nt(t,e=e||0),n=i.parseVersion(1);return E.argument(1===n||1.1===n,"Unsupported GSUB table version."),1===n?{version:n,scripts:i.parseScriptList(),features:i.parseFeatureList(),lookups:i.parseLookupList(ue)}:{version:n,scripts:i.parseScriptList(),features:i.parseFeatureList(),lookups:i.parseLookupList(ue),variations:i.parseFeatureVariationsList()}},make:function(t){return new Q.Table("GSUB",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new Q.ScriptList(t.scripts)},{name:"features",type:"TABLE",value:new Q.FeatureList(t.features)},{name:"lookups",type:"TABLE",value:new Q.LookupList(t.lookups,ce)}])}};var de={parse:function(t,e){var i=new st.Parser(t,e),n=i.parseULong();E.argument(1===n,"Unsupported META table version."),i.parseULong(),i.parseULong();for(var r=i.parseULong(),s={},o=0;o<r;o++){var a=i.parseTag(),u=i.parseULong(),l=i.parseULong(),c=M.UTF8(t,e+u,l);s[a]=c}return s},make:function(t){var e=Object.keys(t).length,i="",n=16+12*e,r=new Q.Table("meta",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"offset",type:"ULONG",value:n},{name:"numTags",type:"ULONG",value:e}]);for(var s in t){var o=i.length;i+=t[s],r.fields.push({name:"tag "+s,type:"TAG",value:s}),r.fields.push({name:"offset "+s,type:"ULONG",value:n+o}),r.fields.push({name:"length "+s,type:"ULONG",value:t[s].length})}return r.fields.push({name:"stringPool",type:"CHARARRAY",value:i}),r}};function pe(t){return Math.log(t)/Math.log(2)|0}function fe(t){for(;t.length%4!=0;)t.push(0);for(var e=0,i=0;i<t.length;i+=4)e+=(t[i]<<24)+(t[i+1]<<16)+(t[i+2]<<8)+t[i+3];return e%=Math.pow(2,32)}function ge(t,e,i,n){return new Q.Record("Table Record",[{name:"tag",type:"TAG",value:void 0!==t?t:""},{name:"checkSum",type:"ULONG",value:void 0!==e?e:0},{name:"offset",type:"ULONG",value:void 0!==i?i:0},{name:"length",type:"ULONG",value:void 0!==n?n:0}])}function me(t){var e=new Q.Table("sfnt",[{name:"version",type:"TAG",value:"OTTO"},{name:"numTables",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);e.tables=t,e.numTables=t.length;var i=Math.pow(2,pe(e.numTables));e.searchRange=16*i,e.entrySelector=pe(i),e.rangeShift=16*e.numTables-e.searchRange;for(var n=[],r=[],s=e.sizeOf()+ge().sizeOf()*e.numTables;s%4!=0;)s+=1,r.push({name:"padding",type:"BYTE",value:0});for(var o=0;o<t.length;o+=1){var a=t[o];E.argument(4===a.tableName.length,"Table name"+a.tableName+" is invalid.");var u=a.sizeOf(),l=ge(a.tableName,fe(a.encode()),s,u);for(n.push({name:l.tag+" Table Record",type:"RECORD",value:l}),r.push({name:a.tableName+" table",type:"RECORD",value:a}),s+=u,E.argument(!isNaN(s),"Something went wrong calculating the offset.");s%4!=0;)s+=1,r.push({name:"padding",type:"BYTE",value:0})}return n.sort((function(t,e){return t.value.tag>e.value.tag?1:-1})),e.fields=e.fields.concat(n),e.fields=e.fields.concat(r),e}function _e(t,e,i){for(var n=0;n<e.length;n+=1){var r=t.charToGlyphIndex(e[n]);if(r>0)return t.glyphs.get(r).getMetrics()}return i}function ye(t){for(var e=0,i=0;i<t.length;i+=1)e+=t[i];return e/t.length}var xe={make:me,fontToTable:function(t){for(var e,i=[],n=[],r=[],s=[],o=[],a=[],u=[],l=0,c=0,h=0,d=0,p=0,f=0;f<t.glyphs.length;f+=1){var g=t.glyphs.get(f),m=0|g.unicode;if(isNaN(g.advanceWidth))throw new Error("Glyph "+g.name+" ("+f+"): advanceWidth is not a number.");(e>m||void 0===e)&&m>0&&(e=m),l<m&&(l=m);var _=oe.getUnicodeRange(m);if(_<32)c|=1<<_;else if(_<64)h|=1<<_-32;else if(_<96)d|=1<<_-64;else{if(!(_<123))throw new Error("Unicode ranges bits > 123 are reserved for internal usage");p|=1<<_-96}if(".notdef"!==g.name){var y=g.getMetrics();i.push(y.xMin),n.push(y.yMin),r.push(y.xMax),s.push(y.yMax),a.push(y.leftSideBearing),u.push(y.rightSideBearing),o.push(g.advanceWidth)}}var x={xMin:Math.min.apply(null,i),yMin:Math.min.apply(null,n),xMax:Math.max.apply(null,r),yMax:Math.max.apply(null,s),advanceWidthMax:Math.max.apply(null,o),advanceWidthAvg:ye(o),minLeftSideBearing:Math.min.apply(null,a),maxLeftSideBearing:Math.max.apply(null,a),minRightSideBearing:Math.min.apply(null,u)};x.ascender=t.ascender,x.descender=t.descender;var w=Xt.make({flags:3,unitsPerEm:t.unitsPerEm,xMin:x.xMin,yMin:x.yMin,xMax:x.xMax,yMax:x.yMax,lowestRecPPEM:3,createdTimestamp:t.createdTimestamp}),b=zt.make({ascender:x.ascender,descender:x.descender,advanceWidthMax:x.advanceWidthMax,minLeftSideBearing:x.minLeftSideBearing,minRightSideBearing:x.minRightSideBearing,xMaxExtent:x.maxLeftSideBearing+(x.xMax-x.xMin),numberOfHMetrics:t.glyphs.length}),v=qt.make(t.glyphs.length),S=oe.make(Object.assign({xAvgCharWidth:Math.round(x.advanceWidthAvg),usFirstCharIndex:e,usLastCharIndex:l,ulUnicodeRange1:c,ulUnicodeRange2:h,ulUnicodeRange3:d,ulUnicodeRange4:p,sTypoAscender:x.ascender,sTypoDescender:x.descender,sTypoLineGap:0,usWinAscent:x.yMax,usWinDescent:Math.abs(x.yMin),ulCodePageRange1:1,sxHeight:_e(t,"xyvw",{yMax:Math.round(x.ascender/2)}).yMax,sCapHeight:_e(t,"HIKLEFJMNTZBDPRAGOQSUVWXY",x).yMax,usDefaultChar:t.hasChar(" ")?32:0,usBreakChar:t.hasChar(" ")?32:0},t.tables.os2)),T=jt.make(t.glyphs),C=at.make(t.glyphs),O=t.getEnglishName("fontFamily"),N=t.getEnglishName("fontSubfamily"),F=O+" "+N,E=t.getEnglishName("postScriptName");E||(E=O.replace(/\s/g,"")+"-"+N);var D={};for(var M in t.names)D[M]=t.names[M];D.uniqueID||(D.uniqueID={en:t.getEnglishName("manufacturer")+":"+F}),D.postScriptName||(D.postScriptName={en:E}),D.preferredFamily||(D.preferredFamily=t.names.fontFamily),D.preferredSubfamily||(D.preferredSubfamily=t.names.fontSubfamily);var I=[],V=re.make(D,I),B=I.length>0?Gt.make(I):void 0,A=ae.make(),R=kt.make(t.glyphs,{version:t.getEnglishName("version"),fullName:F,familyName:O,weightName:N,postScriptName:E,unitsPerEm:t.unitsPerEm,fontBBox:[0,x.yMin,x.ascender,x.advanceWidthMax]}),P=t.metas&&Object.keys(t.metas).length>0?de.make(t.metas):void 0,L=[w,b,v,S,V,C,A,R,T];B&&L.push(B),t.tables.gsub&&L.push(he.make(t.tables.gsub)),P&&L.push(P);for(var U=me(L),k=fe(U.encode()),X=U.fields,z=!1,j=0;j<X.length;j+=1)if("head table"===X[j].name){X[j].value.checkSumAdjustment=2981146554-k,z=!0;break}if(!z)throw new Error("Could not find head table with checkSum to adjust.");return U},computeCheckSum:fe};function we(t,e){for(var i=0,n=t.length-1;i<=n;){var r=i+n>>>1,s=t[r].tag;if(s===e)return r;s<e?i=r+1:n=r-1}return-i-1}function be(t,e){for(var i=0,n=t.length-1;i<=n;){var r=i+n>>>1,s=t[r];if(s===e)return r;s<e?i=r+1:n=r-1}return-i-1}function ve(t,e){for(var i,n=0,r=t.length-1;n<=r;){var s=n+r>>>1,o=(i=t[s]).start;if(o===e)return i;o<e?n=s+1:r=s-1}if(n>0)return e>(i=t[n-1]).end?0:i}function Se(t,e){this.font=t,this.tableName=e}function Te(t){Se.call(this,t,"gpos")}function Ce(t){Se.call(this,t,"gsub")}function Oe(t,e){var i=t.length;if(i!==e.length)return!1;for(var n=0;n<i;n++)if(t[n]!==e[n])return!1;return!0}function Ne(t,e,i){for(var n=t.subtables,r=0;r<n.length;r++){var s=n[r];if(s.substFormat===e)return s}if(i)return n.push(i),i}function Fe(t){for(var e=new ArrayBuffer(t.length),i=new Uint8Array(e),n=0;n<t.length;++n)i[n]=t[n];return e}function Ee(t,e){if(!t)throw e}function De(t,e,i,n,r){var s;return(e&n)>0?(s=t.parseByte(),0==(e&r)&&(s=-s),s=i+s):s=(e&r)>0?i:i+t.parseShort(),s}function Me(t,e,i){var n,r,s=new st.Parser(e,i);if(t.numberOfContours=s.parseShort(),t._xMin=s.parseShort(),t._yMin=s.parseShort(),t._xMax=s.parseShort(),t._yMax=s.parseShort(),t.numberOfContours>0){for(var o=t.endPointIndices=[],a=0;a<t.numberOfContours;a+=1)o.push(s.parseUShort());t.instructionLength=s.parseUShort(),t.instructions=[];for(var u=0;u<t.instructionLength;u+=1)t.instructions.push(s.parseByte());var l=o[o.length-1]+1;n=[];for(var c=0;c<l;c+=1)if(r=s.parseByte(),n.push(r),(8&r)>0)for(var h=s.parseByte(),d=0;d<h;d+=1)n.push(r),c+=1;if(E.argument(n.length===l,"Bad flags."),o.length>0){var p,f=[];if(l>0){for(var g=0;g<l;g+=1)r=n[g],(p={}).onCurve=!!(1&r),p.lastPointOfContour=o.indexOf(g)>=0,f.push(p);for(var m=0,_=0;_<l;_+=1)r=n[_],(p=f[_]).x=De(s,r,m,2,16),m=p.x;for(var y=0,x=0;x<l;x+=1)r=n[x],(p=f[x]).y=De(s,r,y,4,32),y=p.y}t.points=f}else t.points=[]}else if(0===t.numberOfContours)t.points=[];else{t.isComposite=!0,t.points=[],t.components=[];for(var w=!0;w;){n=s.parseUShort();var b={glyphIndex:s.parseUShort(),xScale:1,scale01:0,scale10:0,yScale:1,dx:0,dy:0};(1&n)>0?(2&n)>0?(b.dx=s.parseShort(),b.dy=s.parseShort()):b.matchedPoints=[s.parseUShort(),s.parseUShort()]:(2&n)>0?(b.dx=s.parseChar(),b.dy=s.parseChar()):b.matchedPoints=[s.parseByte(),s.parseByte()],(8&n)>0?b.xScale=b.yScale=s.parseF2Dot14():(64&n)>0?(b.xScale=s.parseF2Dot14(),b.yScale=s.parseF2Dot14()):(128&n)>0&&(b.xScale=s.parseF2Dot14(),b.scale01=s.parseF2Dot14(),b.scale10=s.parseF2Dot14(),b.yScale=s.parseF2Dot14()),t.components.push(b),w=!!(32&n)}if(256&n){t.instructionLength=s.parseUShort(),t.instructions=[];for(var v=0;v<t.instructionLength;v+=1)t.instructions.push(s.parseByte())}}}function Ie(t,e){for(var i=[],n=0;n<t.length;n+=1){var r=t[n],s={x:e.xScale*r.x+e.scale01*r.y+e.dx,y:e.scale10*r.x+e.yScale*r.y+e.dy,onCurve:r.onCurve,lastPointOfContour:r.lastPointOfContour};i.push(s)}return i}function Ve(t){var e=new O;if(!t)return e;for(var i=function(t){for(var e=[],i=[],n=0;n<t.length;n+=1){var r=t[n];i.push(r),r.lastPointOfContour&&(e.push(i),i=[])}return E.argument(0===i.length,"There are still points left in the current contour."),e}(t),n=0;n<i.length;++n){var r=i[n],s=null,o=r[r.length-1],a=r[0];if(o.onCurve)e.moveTo(o.x,o.y);else if(a.onCurve)e.moveTo(a.x,a.y);else{var u={x:.5*(o.x+a.x),y:.5*(o.y+a.y)};e.moveTo(u.x,u.y)}for(var l=0;l<r.length;++l)if(s=o,o=a,a=r[(l+1)%r.length],o.onCurve)e.lineTo(o.x,o.y);else{var c=a;s.onCurve||{x:.5*(o.x+s.x),y:.5*(o.y+s.y)},a.onCurve||(c={x:.5*(o.x+a.x),y:.5*(o.y+a.y)}),e.quadraticCurveTo(o.x,o.y,c.x,c.y)}e.closePath()}return e}function Be(t,e){if(e.isComposite)for(var i=0;i<e.components.length;i+=1){var n=e.components[i],r=t.get(n.glyphIndex);if(r.getPath(),r.points){var s=void 0;if(void 0===n.matchedPoints)s=Ie(r.points,n);else{if(n.matchedPoints[0]>e.points.length-1||n.matchedPoints[1]>r.points.length-1)throw Error("Matched points out of range in "+e.name);var o=e.points[n.matchedPoints[0]],a=r.points[n.matchedPoints[1]],u={xScale:n.xScale,scale01:n.scale01,scale10:n.scale10,yScale:n.yScale,dx:0,dy:0};a=Ie([a],u)[0],u.dx=o.x-a.x,u.dy=o.y-a.y,s=Ie(r.points,u)}e.points=e.points.concat(s)}}return Ve(e.points)}Se.prototype={searchTag:we,binSearch:be,getTable:function(t){var e=this.font.tables[this.tableName];return!e&&t&&(e=this.font.tables[this.tableName]=this.createDefaultTable()),e},getScriptNames:function(){var t=this.getTable();return t?t.scripts.map((function(t){return t.tag})):[]},getDefaultScriptName:function(){var t=this.getTable();if(t){for(var e=!1,i=0;i<t.scripts.length;i++){var n=t.scripts[i].tag;if("DFLT"===n)return n;"latn"===n&&(e=!0)}return e?"latn":void 0}},getScriptTable:function(t,e){var i=this.getTable(e);if(i){t=t||"DFLT";var n=i.scripts,r=we(i.scripts,t);if(r>=0)return n[r].script;if(e){var s={tag:t,script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}};return n.splice(-1-r,0,s),s.script}}},getLangSysTable:function(t,e,i){var n=this.getScriptTable(t,i);if(n){if(!e||"dflt"===e||"DFLT"===e)return n.defaultLangSys;var r=we(n.langSysRecords,e);if(r>=0)return n.langSysRecords[r].langSys;if(i){var s={tag:e,langSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]}};return n.langSysRecords.splice(-1-r,0,s),s.langSys}}},getFeatureTable:function(t,e,i,n){var r=this.getLangSysTable(t,e,n);if(r){for(var s,o=r.featureIndexes,a=this.font.tables[this.tableName].features,u=0;u<o.length;u++)if((s=a[o[u]]).tag===i)return s.feature;if(n){var l=a.length;return E.assert(0===l||i>=a[l-1].tag,"Features must be added in alphabetical order."),s={tag:i,feature:{params:0,lookupListIndexes:[]}},a.push(s),o.push(l),s.feature}}},getLookupTables:function(t,e,i,n,r){var s=this.getFeatureTable(t,e,i,r),o=[];if(s){for(var a,u=s.lookupListIndexes,l=this.font.tables[this.tableName].lookups,c=0;c<u.length;c++)(a=l[u[c]]).lookupType===n&&o.push(a);if(0===o.length&&r){a={lookupType:n,lookupFlag:0,subtables:[],markFilteringSet:void 0};var h=l.length;return l.push(a),u.push(h),[a]}}return o},getGlyphClass:function(t,e){switch(t.format){case 1:return t.startGlyph<=e&&e<t.startGlyph+t.classes.length?t.classes[e-t.startGlyph]:0;case 2:var i=ve(t.ranges,e);return i?i.classId:0}},getCoverageIndex:function(t,e){switch(t.format){case 1:var i=be(t.glyphs,e);return i>=0?i:-1;case 2:var n=ve(t.ranges,e);return n?n.index+e-n.start:-1}},expandCoverage:function(t){if(1===t.format)return t.glyphs;for(var e=[],i=t.ranges,n=0;n<i.length;n++)for(var r=i[n],s=r.start,o=r.end,a=s;a<=o;a++)e.push(a);return e}},Te.prototype=Se.prototype,Te.prototype.init=function(){var t=this.getDefaultScriptName();this.defaultKerningTables=this.getKerningTables(t)},Te.prototype.getKerningValue=function(t,e,i){for(var n=0;n<t.length;n++)for(var r=t[n].subtables,s=0;s<r.length;s++){var o=r[s],a=this.getCoverageIndex(o.coverage,e);if(!(a<0))switch(o.posFormat){case 1:for(var u=o.pairSets[a],l=0;l<u.length;l++){var c=u[l];if(c.secondGlyph===i)return c.value1&&c.value1.xAdvance||0}break;case 2:var h=this.getGlyphClass(o.classDef1,e),d=this.getGlyphClass(o.classDef2,i),p=o.classRecords[h][d];return p.value1&&p.value1.xAdvance||0}}return 0},Te.prototype.getKerningTables=function(t,e){if(this.font.tables.gpos)return this.getLookupTables(t,e,"kern",2)},Ce.prototype=Se.prototype,Ce.prototype.createDefaultTable=function(){return{version:1,scripts:[{tag:"DFLT",script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}}],features:[],lookups:[]}},Ce.prototype.getSingle=function(t,e,i){for(var n=[],r=this.getLookupTables(e,i,t,1),s=0;s<r.length;s++)for(var o=r[s].subtables,a=0;a<o.length;a++){var u=o[a],l=this.expandCoverage(u.coverage),c=void 0;if(1===u.substFormat){var h=u.deltaGlyphId;for(c=0;c<l.length;c++){var d=l[c];n.push({sub:d,by:d+h})}}else{var p=u.substitute;for(c=0;c<l.length;c++)n.push({sub:l[c],by:p[c]})}}return n},Ce.prototype.getMultiple=function(t,e,i){for(var n=[],r=this.getLookupTables(e,i,t,2),s=0;s<r.length;s++)for(var o=r[s].subtables,a=0;a<o.length;a++){var u=o[a],l=this.expandCoverage(u.coverage),c=void 0;for(c=0;c<l.length;c++){var h=l[c],d=u.sequences[c];n.push({sub:h,by:d})}}return n},Ce.prototype.getAlternates=function(t,e,i){for(var n=[],r=this.getLookupTables(e,i,t,3),s=0;s<r.length;s++)for(var o=r[s].subtables,a=0;a<o.length;a++)for(var u=o[a],l=this.expandCoverage(u.coverage),c=u.alternateSets,h=0;h<l.length;h++)n.push({sub:l[h],by:c[h]});return n},Ce.prototype.getLigatures=function(t,e,i){for(var n=[],r=this.getLookupTables(e,i,t,4),s=0;s<r.length;s++)for(var o=r[s].subtables,a=0;a<o.length;a++)for(var u=o[a],l=this.expandCoverage(u.coverage),c=u.ligatureSets,h=0;h<l.length;h++)for(var d=l[h],p=c[h],f=0;f<p.length;f++){var g=p[f];n.push({sub:[d].concat(g.components),by:g.ligGlyph})}return n},Ce.prototype.addSingle=function(t,e,i,n){var r=Ne(this.getLookupTables(i,n,t,1,!0)[0],2,{substFormat:2,coverage:{format:1,glyphs:[]},substitute:[]});E.assert(1===r.coverage.format,"Single: unable to modify coverage table format "+r.coverage.format);var s=e.sub,o=this.binSearch(r.coverage.glyphs,s);o<0&&(o=-1-o,r.coverage.glyphs.splice(o,0,s),r.substitute.splice(o,0,0)),r.substitute[o]=e.by},Ce.prototype.addMultiple=function(t,e,i,n){E.assert(e.by instanceof Array&&e.by.length>1,'Multiple: "by" must be an array of two or more ids');var r=Ne(this.getLookupTables(i,n,t,2,!0)[0],1,{substFormat:1,coverage:{format:1,glyphs:[]},sequences:[]});E.assert(1===r.coverage.format,"Multiple: unable to modify coverage table format "+r.coverage.format);var s=e.sub,o=this.binSearch(r.coverage.glyphs,s);o<0&&(o=-1-o,r.coverage.glyphs.splice(o,0,s),r.sequences.splice(o,0,0)),r.sequences[o]=e.by},Ce.prototype.addAlternate=function(t,e,i,n){var r=Ne(this.getLookupTables(i,n,t,3,!0)[0],1,{substFormat:1,coverage:{format:1,glyphs:[]},alternateSets:[]});E.assert(1===r.coverage.format,"Alternate: unable to modify coverage table format "+r.coverage.format);var s=e.sub,o=this.binSearch(r.coverage.glyphs,s);o<0&&(o=-1-o,r.coverage.glyphs.splice(o,0,s),r.alternateSets.splice(o,0,0)),r.alternateSets[o]=e.by},Ce.prototype.addLigature=function(t,e,i,n){var r=this.getLookupTables(i,n,t,4,!0)[0],s=r.subtables[0];s||(s={substFormat:1,coverage:{format:1,glyphs:[]},ligatureSets:[]},r.subtables[0]=s),E.assert(1===s.coverage.format,"Ligature: unable to modify coverage table format "+s.coverage.format);var o=e.sub[0],a=e.sub.slice(1),u={ligGlyph:e.by,components:a},l=this.binSearch(s.coverage.glyphs,o);if(l>=0){for(var c=s.ligatureSets[l],h=0;h<c.length;h++)if(Oe(c[h].components,a))return;c.push(u)}else l=-1-l,s.coverage.glyphs.splice(l,0,o),s.ligatureSets.splice(l,0,[u])},Ce.prototype.getFeature=function(t,e,i){if(/ss\d\d/.test(t))return this.getSingle(t,e,i);switch(t){case"aalt":case"salt":return this.getSingle(t,e,i).concat(this.getAlternates(t,e,i));case"dlig":case"liga":case"rlig":return this.getLigatures(t,e,i);case"ccmp":return this.getMultiple(t,e,i).concat(this.getLigatures(t,e,i));case"stch":return this.getMultiple(t,e,i)}},Ce.prototype.add=function(t,e,i,n){if(/ss\d\d/.test(t))return this.addSingle(t,e,i,n);switch(t){case"aalt":case"salt":return"number"==typeof e.by?this.addSingle(t,e,i,n):this.addAlternate(t,e,i,n);case"dlig":case"liga":case"rlig":return this.addLigature(t,e,i,n);case"ccmp":return e.by instanceof Array?this.addMultiple(t,e,i,n):this.addLigature(t,e,i,n)}};var Ae,Re,Pe,Le,Ue={getPath:Ve,parse:function(t,e,i,n,r){return r.lowMemory?function(t,e,i,n){var r=new bt.GlyphSet(n);return n._push=function(s){var o=i[s];o!==i[s+1]?r.push(s,bt.ttfGlyphLoader(n,s,Me,t,e+o,Be)):r.push(s,bt.glyphLoader(n,s))},r}(t,e,i,n):function(t,e,i,n){for(var r=new bt.GlyphSet(n),s=0;s<i.length-1;s+=1){var o=i[s];o!==i[s+1]?r.push(s,bt.ttfGlyphLoader(n,s,Me,t,e+o,Be)):r.push(s,bt.glyphLoader(n,s))}return r}(t,e,i,n)}};function ke(t){this.font=t,this.getCommands=function(t){return Ue.getPath(t).commands},this._fpgmState=this._prepState=void 0,this._errorState=0}function Xe(t){return t}function ze(t){return Math.sign(t)*Math.round(Math.abs(t))}function je(t){return Math.sign(t)*Math.round(Math.abs(2*t))/2}function Ge(t){return Math.sign(t)*(Math.round(Math.abs(t)+.5)-.5)}function qe(t){return Math.sign(t)*Math.ceil(Math.abs(t))}function He(t){return Math.sign(t)*Math.floor(Math.abs(t))}var We=function(t){var e=this.srPeriod,i=this.srPhase,n=1;return t<0&&(t=-t,n=-1),t+=this.srThreshold-i,t=Math.trunc(t/e)*e,(t+=i)<0?i*n:t*n},Ye={x:1,y:0,axis:"x",distance:function(t,e,i,n){return(i?t.xo:t.x)-(n?e.xo:e.x)},interpolate:function(t,e,i,n){var r,s,o,a,u,l,c;if(!n||n===this)return r=t.xo-e.xo,s=t.xo-i.xo,u=e.x-e.xo,l=i.x-i.xo,0===(c=(o=Math.abs(r))+(a=Math.abs(s)))?void(t.x=t.xo+(u+l)/2):void(t.x=t.xo+(u*a+l*o)/c);r=n.distance(t,e,!0,!0),s=n.distance(t,i,!0,!0),u=n.distance(e,e,!1,!0),l=n.distance(i,i,!1,!0),0!==(c=(o=Math.abs(r))+(a=Math.abs(s)))?Ye.setRelative(t,t,(u*a+l*o)/c,n,!0):Ye.setRelative(t,t,(u+l)/2,n,!0)},normalSlope:Number.NEGATIVE_INFINITY,setRelative:function(t,e,i,n,r){if(n&&n!==this){var s=r?e.xo:e.x,o=r?e.yo:e.y,a=s+i*n.x,u=o+i*n.y;t.x=a+(t.y-u)/n.normalSlope}else t.x=(r?e.xo:e.x)+i},slope:0,touch:function(t){t.xTouched=!0},touched:function(t){return t.xTouched},untouch:function(t){t.xTouched=!1}},Ze={x:0,y:1,axis:"y",distance:function(t,e,i,n){return(i?t.yo:t.y)-(n?e.yo:e.y)},interpolate:function(t,e,i,n){var r,s,o,a,u,l,c;if(!n||n===this)return r=t.yo-e.yo,s=t.yo-i.yo,u=e.y-e.yo,l=i.y-i.yo,0===(c=(o=Math.abs(r))+(a=Math.abs(s)))?void(t.y=t.yo+(u+l)/2):void(t.y=t.yo+(u*a+l*o)/c);r=n.distance(t,e,!0,!0),s=n.distance(t,i,!0,!0),u=n.distance(e,e,!1,!0),l=n.distance(i,i,!1,!0),0!==(c=(o=Math.abs(r))+(a=Math.abs(s)))?Ze.setRelative(t,t,(u*a+l*o)/c,n,!0):Ze.setRelative(t,t,(u+l)/2,n,!0)},normalSlope:0,setRelative:function(t,e,i,n,r){if(n&&n!==this){var s=r?e.xo:e.x,o=r?e.yo:e.y,a=s+i*n.x,u=o+i*n.y;t.y=u+n.normalSlope*(t.x-a)}else t.y=(r?e.yo:e.y)+i},slope:Number.POSITIVE_INFINITY,touch:function(t){t.yTouched=!0},touched:function(t){return t.yTouched},untouch:function(t){t.yTouched=!1}};function Ke(t,e){this.x=t,this.y=e,this.axis=void 0,this.slope=e/t,this.normalSlope=-t/e,Object.freeze(this)}function Qe(t,e){var i=Math.sqrt(t*t+e*e);return e/=i,1===(t/=i)&&0===e?Ye:0===t&&1===e?Ze:new Ke(t,e)}function $e(t,e,i,n){this.x=this.xo=Math.round(64*t)/64,this.y=this.yo=Math.round(64*e)/64,this.lastPointOfContour=i,this.onCurve=n,this.prevPointOnContour=void 0,this.nextPointOnContour=void 0,this.xTouched=!1,this.yTouched=!1,Object.preventExtensions(this)}Object.freeze(Ye),Object.freeze(Ze),Ke.prototype.distance=function(t,e,i,n){return this.x*Ye.distance(t,e,i,n)+this.y*Ze.distance(t,e,i,n)},Ke.prototype.interpolate=function(t,e,i,n){var r,s,o,a,u,l,c;o=n.distance(t,e,!0,!0),a=n.distance(t,i,!0,!0),r=n.distance(e,e,!1,!0),s=n.distance(i,i,!1,!0),0!==(c=(u=Math.abs(o))+(l=Math.abs(a)))?this.setRelative(t,t,(r*l+s*u)/c,n,!0):this.setRelative(t,t,(r+s)/2,n,!0)},Ke.prototype.setRelative=function(t,e,i,n,r){n=n||this;var s=r?e.xo:e.x,o=r?e.yo:e.y,a=s+i*n.x,u=o+i*n.y,l=n.normalSlope,c=this.slope,h=t.x,d=t.y;t.x=(c*h-l*a+u-d)/(c-l),t.y=c*(t.x-h)+d},Ke.prototype.touch=function(t){t.xTouched=!0,t.yTouched=!0},$e.prototype.nextTouched=function(t){for(var e=this.nextPointOnContour;!t.touched(e)&&e!==this;)e=e.nextPointOnContour;return e},$e.prototype.prevTouched=function(t){for(var e=this.prevPointOnContour;!t.touched(e)&&e!==this;)e=e.prevPointOnContour;return e};var Je=Object.freeze(new $e(0,0)),ti={cvCutIn:17/16,deltaBase:9,deltaShift:.125,loop:1,minDis:1,autoFlip:!0};function ei(t,e){switch(this.env=t,this.stack=[],this.prog=e,t){case"glyf":this.zp0=this.zp1=this.zp2=1,this.rp0=this.rp1=this.rp2=0;case"prep":this.fv=this.pv=this.dpv=Ye,this.round=ze}}function ii(t){for(var e=t.tZone=new Array(t.gZone.length),i=0;i<e.length;i++)e[i]=new $e(0,0)}function ni(t,e){var i,n=t.prog,r=t.ip,s=1;do{if(88===(i=n[++r]))s++;else if(89===i)s--;else if(64===i)r+=n[r+1]+1;else if(65===i)r+=2*n[r+1]+1;else if(i>=176&&i<=183)r+=i-176+1;else if(i>=184&&i<=191)r+=2*(i-184+1);else if(e&&1===s&&27===i)break}while(s>0);t.ip=r}function ri(e,i){t.DEBUG&&console.log(i.step,"SVTCA["+e.axis+"]"),i.fv=i.pv=i.dpv=e}function si(e,i){t.DEBUG&&console.log(i.step,"SPVTCA["+e.axis+"]"),i.pv=i.dpv=e}function oi(e,i){t.DEBUG&&console.log(i.step,"SFVTCA["+e.axis+"]"),i.fv=e}function ai(e,i){var n,r,s=i.stack,o=s.pop(),a=s.pop(),u=i.z2[o],l=i.z1[a];t.DEBUG&&console.log("SPVTL["+e+"]",o,a),e?(n=u.y-l.y,r=l.x-u.x):(n=l.x-u.x,r=l.y-u.y),i.pv=i.dpv=Qe(n,r)}function ui(e,i){var n,r,s=i.stack,o=s.pop(),a=s.pop(),u=i.z2[o],l=i.z1[a];t.DEBUG&&console.log("SFVTL["+e+"]",o,a),e?(n=u.y-l.y,r=l.x-u.x):(n=l.x-u.x,r=l.y-u.y),i.fv=Qe(n,r)}function li(e){t.DEBUG&&console.log(e.step,"POP[]"),e.stack.pop()}function ci(e,i){var n=i.stack.pop(),r=i.z0[n],s=i.fv,o=i.pv;t.DEBUG&&console.log(i.step,"MDAP["+e+"]",n);var a=o.distance(r,Je);e&&(a=i.round(a)),s.setRelative(r,Je,a,o),s.touch(r),i.rp0=i.rp1=n}function hi(e,i){var n,r,s,o=i.z2,a=o.length-2;t.DEBUG&&console.log(i.step,"IUP["+e.axis+"]");for(var u=0;u<a;u++)n=o[u],e.touched(n)||(r=n.prevTouched(e))!==n&&(r===(s=n.nextTouched(e))&&e.setRelative(n,n,e.distance(r,r,!1,!0),e,!0),e.interpolate(n,r,s,e))}function di(e,i){for(var n=i.stack,r=e?i.rp1:i.rp2,s=(e?i.z0:i.z1)[r],o=i.fv,a=i.pv,u=i.loop,l=i.z2;u--;){var c=n.pop(),h=l[c],d=a.distance(s,s,!1,!0);o.setRelative(h,h,d,a),o.touch(h),t.DEBUG&&console.log(i.step,(i.loop>1?"loop "+(i.loop-u)+": ":"")+"SHP["+(e?"rp1":"rp2")+"]",c)}i.loop=1}function pi(e,i){var n=i.stack,r=e?i.rp1:i.rp2,s=(e?i.z0:i.z1)[r],o=i.fv,a=i.pv,u=n.pop(),l=i.z2[i.contours[u]],c=l;t.DEBUG&&console.log(i.step,"SHC["+e+"]",u);var h=a.distance(s,s,!1,!0);do{c!==s&&o.setRelative(c,c,h,a),c=c.nextPointOnContour}while(c!==l)}function fi(e,i){var n,r,s=i.stack,o=e?i.rp1:i.rp2,a=(e?i.z0:i.z1)[o],u=i.fv,l=i.pv,c=s.pop();switch(t.DEBUG&&console.log(i.step,"SHZ["+e+"]",c),c){case 0:n=i.tZone;break;case 1:n=i.gZone;break;default:throw new Error("Invalid zone")}for(var h=l.distance(a,a,!1,!0),d=n.length-2,p=0;p<d;p++)r=n[p],u.setRelative(r,r,h,l)}function gi(e,i){var n=i.stack,r=n.pop()/64,s=n.pop(),o=i.z1[s],a=i.z0[i.rp0],u=i.fv,l=i.pv;u.setRelative(o,a,r,l),u.touch(o),t.DEBUG&&console.log(i.step,"MSIRP["+e+"]",r,s),i.rp1=i.rp0,i.rp2=s,e&&(i.rp0=s)}function mi(e,i){var n=i.stack,r=n.pop(),s=n.pop(),o=i.z0[s],a=i.fv,u=i.pv,l=i.cvt[r];t.DEBUG&&console.log(i.step,"MIAP["+e+"]",r,"(",l,")",s);var c=u.distance(o,Je);e&&(Math.abs(c-l)<i.cvCutIn&&(c=l),c=i.round(c)),a.setRelative(o,Je,c,u),0===i.zp0&&(o.xo=o.x,o.yo=o.y),a.touch(o),i.rp0=i.rp1=s}function _i(e,i){var n=i.stack,r=n.pop(),s=i.z2[r];t.DEBUG&&console.log(i.step,"GC["+e+"]",r),n.push(64*i.dpv.distance(s,Je,e,!1))}function yi(e,i){var n=i.stack,r=n.pop(),s=n.pop(),o=i.z1[r],a=i.z0[s],u=i.dpv.distance(a,o,e,e);t.DEBUG&&console.log(i.step,"MD["+e+"]",r,s,"->",u),i.stack.push(Math.round(64*u))}function xi(e,i){var n=i.stack,r=n.pop(),s=i.fv,o=i.pv,a=i.ppem,u=i.deltaBase+16*(e-1),l=i.deltaShift,c=i.z0;t.DEBUG&&console.log(i.step,"DELTAP["+e+"]",r,n);for(var h=0;h<r;h++){var d=n.pop(),p=n.pop();if(u+((240&p)>>4)===a){var f=(15&p)-8;f>=0&&f++,t.DEBUG&&console.log(i.step,"DELTAPFIX",d,"by",f*l);var g=c[d];s.setRelative(g,g,f*l,o)}}}function wi(e,i){var n=i.stack,r=n.pop();t.DEBUG&&console.log(i.step,"ROUND[]"),n.push(64*i.round(r/64))}function bi(e,i){var n=i.stack,r=n.pop(),s=i.ppem,o=i.deltaBase+16*(e-1),a=i.deltaShift;t.DEBUG&&console.log(i.step,"DELTAC["+e+"]",r,n);for(var u=0;u<r;u++){var l=n.pop(),c=n.pop();if(o+((240&c)>>4)===s){var h=(15&c)-8;h>=0&&h++;var d=h*a;t.DEBUG&&console.log(i.step,"DELTACFIX",l,"by",d),i.cvt[l]+=d}}}function vi(e,i){var n,r,s=i.stack,o=s.pop(),a=s.pop(),u=i.z2[o],l=i.z1[a];t.DEBUG&&console.log(i.step,"SDPVTL["+e+"]",o,a),e?(n=u.y-l.y,r=l.x-u.x):(n=l.x-u.x,r=l.y-u.y),i.dpv=Qe(n,r)}function Si(e,i){var n=i.stack,r=i.prog,s=i.ip;t.DEBUG&&console.log(i.step,"PUSHB["+e+"]");for(var o=0;o<e;o++)n.push(r[++s]);i.ip=s}function Ti(e,i){var n=i.ip,r=i.prog,s=i.stack;t.DEBUG&&console.log(i.ip,"PUSHW["+e+"]");for(var o=0;o<e;o++){var a=r[++n]<<8|r[++n];32768&a&&(a=-(1+(65535^a))),s.push(a)}i.ip=n}function Ci(e,i,n,r,s,o){var a,u,l,c,h=o.stack,d=e&&h.pop(),p=h.pop(),f=o.rp0,g=o.z0[f],m=o.z1[p],_=o.minDis,y=o.fv,x=o.dpv;l=(u=a=x.distance(m,g,!0,!0))>=0?1:-1,u=Math.abs(u),e&&(c=o.cvt[d],r&&Math.abs(u-c)<o.cvCutIn&&(u=c)),n&&u<_&&(u=_),r&&(u=o.round(u)),y.setRelative(m,g,l*u,x),y.touch(m),t.DEBUG&&console.log(o.step,(e?"MIRP[":"MDRP[")+(i?"M":"m")+(n?">":"_")+(r?"R":"_")+(0===s?"Gr":1===s?"Bl":2===s?"Wh":"")+"]",e?d+"("+o.cvt[d]+","+c+")":"",p,"(d =",a,"->",l*u,")"),o.rp1=o.rp0,o.rp2=p,i&&(o.rp0=p)}function Oi(t){this.char=t,this.state={},this.activeState=null}function Ni(t,e,i){this.contextName=i,this.startIndex=t,this.endOffset=e}function Fi(t,e,i){this.contextName=t,this.openRange=null,this.ranges=[],this.checkStart=e,this.checkEnd=i}function Ei(t,e){this.context=t,this.index=e,this.length=t.length,this.current=t[e],this.backtrack=t.slice(0,e),this.lookahead=t.slice(e+1)}function Di(t){this.eventId=t,this.subscribers=[]}function Mi(t){var e=this,i=["start","end","next","newToken","contextStart","contextEnd","insertToken","removeToken","removeRange","replaceToken","replaceRange","composeRUD","updateContextsRanges"];i.forEach((function(t){Object.defineProperty(e.events,t,{value:new Di(t)})})),t&&i.forEach((function(i){var n=t[i];"function"==typeof n&&e.events[i].subscribe(n)}));["insertToken","removeToken","removeRange","replaceToken","replaceRange","composeRUD"].forEach((function(t){e.events[t].subscribe(e.updateContextsRanges)}))}function Ii(t){this.tokens=[],this.registeredContexts={},this.contextCheckers=[],this.events={},this.registeredModifiers=[],Mi.call(this,t)}function Vi(t){return/[\u0600-\u065F\u066A-\u06D2\u06FA-\u06FF]/.test(t)}function Bi(t){return/[\u0630\u0690\u0621\u0631\u0661\u0671\u0622\u0632\u0672\u0692\u06C2\u0623\u0673\u0693\u06C3\u0624\u0694\u06C4\u0625\u0675\u0695\u06C5\u06E5\u0676\u0696\u06C6\u0627\u0677\u0697\u06C7\u0648\u0688\u0698\u06C8\u0689\u0699\u06C9\u068A\u06CA\u066B\u068B\u06CB\u068C\u068D\u06CD\u06FD\u068E\u06EE\u06FE\u062F\u068F\u06CF\u06EF]/.test(t)}function Ai(t){return/[\u0600-\u0605\u060C-\u060E\u0610-\u061B\u061E\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED]/.test(t)}function Ri(t){return/[A-z]/.test(t)}function Pi(t){this.font=t,this.features={}}function Li(t){this.id=t.id,this.tag=t.tag,this.substitution=t.substitution}function Ui(t,e){if(!t)return-1;switch(e.format){case 1:return e.glyphs.indexOf(t);case 2:for(var i=e.ranges,n=0;n<i.length;n++){var r=i[n];if(t>=r.start&&t<=r.end){var s=t-r.start;return r.index+s}}break;default:return-1}return-1}function ki(t,e){return-1===Ui(t,e.coverage)?null:t+e.deltaGlyphId}function Xi(t,e){var i=Ui(t,e.coverage);return-1===i?null:e.substitute[i]}function zi(t,e){for(var i=[],n=0;n<t.length;n++){var r=t[n],s=e.current,o=Ui(s=Array.isArray(s)?s[0]:s,r);-1!==o&&i.push(o)}return i.length!==t.length?-1:i}function ji(t,e){var i=e.inputCoverage.length+e.lookaheadCoverage.length+e.backtrackCoverage.length;if(t.context.length<i)return[];var n=zi(e.inputCoverage,t);if(-1===n)return[];var r=e.inputCoverage.length-1;if(t.lookahead.length<e.lookaheadCoverage.length)return[];for(var s=t.lookahead.slice(r);s.length&&Ai(s[0].char);)s.shift();var o=new Ei(s,0),a=zi(e.lookaheadCoverage,o),u=[].concat(t.backtrack);for(u.reverse();u.length&&Ai(u[0].char);)u.shift();if(u.length<e.backtrackCoverage.length)return[];var l=new Ei(u,0),c=zi(e.backtrackCoverage,l),h=[];if(n.length===e.inputCoverage.length&&a.length===e.lookaheadCoverage.length&&c.length===e.backtrackCoverage.length)for(var d=0;d<e.lookupRecords.length;d++)for(var p=e.lookupRecords[d].lookupListIndex,f=this.getLookupByIndex(p),g=0;g<f.subtables.length;g++){var m=f.subtables[g],_=this.getLookupMethod(f,m);if("12"===this.getSubstitutionType(f,m))for(var y=0;y<n.length;y++){var x=_(t.get(y));x&&h.push(x)}}return h}function Gi(t,e){var i,n=Ui(t.current,e.coverage);if(-1===n)return null;for(var r=e.ligatureSets[n],s=0;s<r.length;s++){i=r[s];for(var o=0;o<i.components.length;o++){if(t.lookahead[o]!==i.components[o])break;if(o===i.components.length-1)return i}}return null}function qi(t,e){var i=Ui(t,e.coverage);return-1===i?null:e.sequences[i]}ke.prototype.exec=function(e,i){if("number"!=typeof i)throw new Error("Point size is not a number!");if(!(this._errorState>2)){var n=this.font,r=this._prepState;if(!r||r.ppem!==i){var s=this._fpgmState;if(!s){ei.prototype=ti,(s=this._fpgmState=new ei("fpgm",n.tables.fpgm)).funcs=[],s.font=n,t.DEBUG&&(console.log("---EXEC FPGM---"),s.step=-1);try{Re(s)}catch(t){return console.log("Hinting error in FPGM:"+t),void(this._errorState=3)}}ei.prototype=s,(r=this._prepState=new ei("prep",n.tables.prep)).ppem=i;var o=n.tables.cvt;if(o)for(var a=r.cvt=new Array(o.length),u=i/n.unitsPerEm,l=0;l<o.length;l++)a[l]=o[l]*u;else r.cvt=[];t.DEBUG&&(console.log("---EXEC PREP---"),r.step=-1);try{Re(r)}catch(t){this._errorState<2&&console.log("Hinting error in PREP:"+t),this._errorState=2}}if(!(this._errorState>1))try{return Pe(e,r)}catch(t){return this._errorState<1&&(console.log("Hinting error:"+t),console.log("Note: further hinting errors are silenced")),void(this._errorState=1)}}},Pe=function(e,i){var n,r,s,o=i.ppem/i.font.unitsPerEm,a=o,u=e.components;if(ei.prototype=i,u){var l=i.font;r=[],n=[];for(var c=0;c<u.length;c++){var h=u[c],d=l.glyphs.get(h.glyphIndex);s=new ei("glyf",d.instructions),t.DEBUG&&(console.log("---EXEC COMP "+c+"---"),s.step=-1),Le(d,s,o,a);for(var p=Math.round(h.dx*o),f=Math.round(h.dy*a),g=s.gZone,m=s.contours,_=0;_<g.length;_++){var y=g[_];y.xTouched=y.yTouched=!1,y.xo=y.x=y.x+p,y.yo=y.y=y.y+f}var x=r.length;r.push.apply(r,g);for(var w=0;w<m.length;w++)n.push(m[w]+x)}e.instructions&&!s.inhibitGridFit&&((s=new ei("glyf",e.instructions)).gZone=s.z0=s.z1=s.z2=r,s.contours=n,r.push(new $e(0,0),new $e(Math.round(e.advanceWidth*o),0)),t.DEBUG&&(console.log("---EXEC COMPOSITE---"),s.step=-1),Re(s),r.length-=2)}else s=new ei("glyf",e.instructions),t.DEBUG&&(console.log("---EXEC GLYPH---"),s.step=-1),Le(e,s,o,a),r=s.gZone;return r},Le=function(e,i,n,r){for(var s,o,a,u=e.points||[],l=u.length,c=i.gZone=i.z0=i.z1=i.z2=[],h=i.contours=[],d=0;d<l;d++)s=u[d],c[d]=new $e(s.x*n,s.y*r,s.lastPointOfContour,s.onCurve);for(var p=0;p<l;p++)s=c[p],o||(o=s,h.push(p)),s.lastPointOfContour?(s.nextPointOnContour=o,o.prevPointOnContour=s,o=void 0):(a=c[p+1],s.nextPointOnContour=a,a.prevPointOnContour=s);if(!i.inhibitGridFit){if(t.DEBUG){console.log("PROCESSING GLYPH",i.stack);for(var f=0;f<l;f++)console.log(f,c[f].x,c[f].y)}if(c.push(new $e(0,0),new $e(Math.round(e.advanceWidth*n),0)),Re(i),c.length-=2,t.DEBUG){console.log("FINISHED GLYPH",i.stack);for(var g=0;g<l;g++)console.log(g,c[g].x,c[g].y)}}},Re=function(e){var i=e.prog;if(i){var n,r=i.length;for(e.ip=0;e.ip<r;e.ip++){if(t.DEBUG&&e.step++,!(n=Ae[i[e.ip]]))throw new Error("unknown instruction: 0x"+Number(i[e.ip]).toString(16));n(e)}}},Ae=[ri.bind(void 0,Ze),ri.bind(void 0,Ye),si.bind(void 0,Ze),si.bind(void 0,Ye),oi.bind(void 0,Ze),oi.bind(void 0,Ye),ai.bind(void 0,0),ai.bind(void 0,1),ui.bind(void 0,0),ui.bind(void 0,1),function(e){var i=e.stack,n=i.pop(),r=i.pop();t.DEBUG&&console.log(e.step,"SPVFS[]",n,r),e.pv=e.dpv=Qe(r,n)},function(e){var i=e.stack,n=i.pop(),r=i.pop();t.DEBUG&&console.log(e.step,"SPVFS[]",n,r),e.fv=Qe(r,n)},function(e){var i=e.stack,n=e.pv;t.DEBUG&&console.log(e.step,"GPV[]"),i.push(16384*n.x),i.push(16384*n.y)},function(e){var i=e.stack,n=e.fv;t.DEBUG&&console.log(e.step,"GFV[]"),i.push(16384*n.x),i.push(16384*n.y)},function(e){e.fv=e.pv,t.DEBUG&&console.log(e.step,"SFVTPV[]")},function(e){var i=e.stack,n=i.pop(),r=i.pop(),s=i.pop(),o=i.pop(),a=i.pop(),u=e.z0,l=e.z1,c=u[n],h=u[r],d=l[s],p=l[o],f=e.z2[a];t.DEBUG&&console.log("ISECT[], ",n,r,s,o,a);var g=c.x,m=c.y,_=h.x,y=h.y,x=d.x,w=d.y,b=p.x,v=p.y,S=(g-_)*(w-v)-(m-y)*(x-b),T=g*y-m*_,C=x*v-w*b;f.x=(T*(x-b)-C*(g-_))/S,f.y=(T*(w-v)-C*(m-y))/S},function(e){e.rp0=e.stack.pop(),t.DEBUG&&console.log(e.step,"SRP0[]",e.rp0)},function(e){e.rp1=e.stack.pop(),t.DEBUG&&console.log(e.step,"SRP1[]",e.rp1)},function(e){e.rp2=e.stack.pop(),t.DEBUG&&console.log(e.step,"SRP2[]",e.rp2)},function(e){var i=e.stack.pop();switch(t.DEBUG&&console.log(e.step,"SZP0[]",i),e.zp0=i,i){case 0:e.tZone||ii(e),e.z0=e.tZone;break;case 1:e.z0=e.gZone;break;default:throw new Error("Invalid zone pointer")}},function(e){var i=e.stack.pop();switch(t.DEBUG&&console.log(e.step,"SZP1[]",i),e.zp1=i,i){case 0:e.tZone||ii(e),e.z1=e.tZone;break;case 1:e.z1=e.gZone;break;default:throw new Error("Invalid zone pointer")}},function(e){var i=e.stack.pop();switch(t.DEBUG&&console.log(e.step,"SZP2[]",i),e.zp2=i,i){case 0:e.tZone||ii(e),e.z2=e.tZone;break;case 1:e.z2=e.gZone;break;default:throw new Error("Invalid zone pointer")}},function(e){var i=e.stack.pop();switch(t.DEBUG&&console.log(e.step,"SZPS[]",i),e.zp0=e.zp1=e.zp2=i,i){case 0:e.tZone||ii(e),e.z0=e.z1=e.z2=e.tZone;break;case 1:e.z0=e.z1=e.z2=e.gZone;break;default:throw new Error("Invalid zone pointer")}},function(e){e.loop=e.stack.pop(),t.DEBUG&&console.log(e.step,"SLOOP[]",e.loop)},function(e){t.DEBUG&&console.log(e.step,"RTG[]"),e.round=ze},function(e){t.DEBUG&&console.log(e.step,"RTHG[]"),e.round=Ge},function(e){var i=e.stack.pop();t.DEBUG&&console.log(e.step,"SMD[]",i),e.minDis=i/64},function(e){t.DEBUG&&console.log(e.step,"ELSE[]"),ni(e,!1)},function(e){var i=e.stack.pop();t.DEBUG&&console.log(e.step,"JMPR[]",i),e.ip+=i-1},function(e){var i=e.stack.pop();t.DEBUG&&console.log(e.step,"SCVTCI[]",i),e.cvCutIn=i/64},void 0,void 0,function(e){var i=e.stack;t.DEBUG&&console.log(e.step,"DUP[]"),i.push(i[i.length-1])},li,function(e){t.DEBUG&&console.log(e.step,"CLEAR[]"),e.stack.length=0},function(e){var i=e.stack,n=i.pop(),r=i.pop();t.DEBUG&&console.log(e.step,"SWAP[]"),i.push(n),i.push(r)},function(e){var i=e.stack;t.DEBUG&&console.log(e.step,"DEPTH[]"),i.push(i.length)},function(e){var i=e.stack,n=i.pop();t.DEBUG&&console.log(e.step,"CINDEX[]",n),i.push(i[i.length-n])},function(e){var i=e.stack,n=i.pop();t.DEBUG&&console.log(e.step,"MINDEX[]",n),i.push(i.splice(i.length-n,1)[0])},void 0,void 0,void 0,function(e){var i=e.stack,n=i.pop(),r=i.pop();t.DEBUG&&console.log(e.step,"LOOPCALL[]",n,r);var s=e.ip,o=e.prog;e.prog=e.funcs[n];for(var a=0;a<r;a++)Re(e),t.DEBUG&&console.log(++e.step,a+1<r?"next loopcall":"done loopcall",a);e.ip=s,e.prog=o},function(e){var i=e.stack.pop();t.DEBUG&&console.log(e.step,"CALL[]",i);var n=e.ip,r=e.prog;e.prog=e.funcs[i],Re(e),e.ip=n,e.prog=r,t.DEBUG&&console.log(++e.step,"returning from",i)},function(e){if("fpgm"!==e.env)throw new Error("FDEF not allowed here");var i=e.stack,n=e.prog,r=e.ip,s=i.pop(),o=r;for(t.DEBUG&&console.log(e.step,"FDEF[]",s);45!==n[++r];);e.ip=r,e.funcs[s]=n.slice(o+1,r)},void 0,ci.bind(void 0,0),ci.bind(void 0,1),hi.bind(void 0,Ze),hi.bind(void 0,Ye),di.bind(void 0,0),di.bind(void 0,1),pi.bind(void 0,0),pi.bind(void 0,1),fi.bind(void 0,0),fi.bind(void 0,1),function(e){for(var i=e.stack,n=e.loop,r=e.fv,s=i.pop()/64,o=e.z2;n--;){var a=i.pop(),u=o[a];t.DEBUG&&console.log(e.step,(e.loop>1?"loop "+(e.loop-n)+": ":"")+"SHPIX[]",a,s),r.setRelative(u,u,s),r.touch(u)}e.loop=1},function(e){for(var i=e.stack,n=e.rp1,r=e.rp2,s=e.loop,o=e.z0[n],a=e.z1[r],u=e.fv,l=e.dpv,c=e.z2;s--;){var h=i.pop(),d=c[h];t.DEBUG&&console.log(e.step,(e.loop>1?"loop "+(e.loop-s)+": ":"")+"IP[]",h,n,"<->",r),u.interpolate(d,o,a,l),u.touch(d)}e.loop=1},gi.bind(void 0,0),gi.bind(void 0,1),function(e){for(var i=e.stack,n=e.rp0,r=e.z0[n],s=e.loop,o=e.fv,a=e.pv,u=e.z1;s--;){var l=i.pop(),c=u[l];t.DEBUG&&console.log(e.step,(e.loop>1?"loop "+(e.loop-s)+": ":"")+"ALIGNRP[]",l),o.setRelative(c,r,0,a),o.touch(c)}e.loop=1},function(e){t.DEBUG&&console.log(e.step,"RTDG[]"),e.round=je},mi.bind(void 0,0),mi.bind(void 0,1),function(e){var i=e.prog,n=e.ip,r=e.stack,s=i[++n];t.DEBUG&&console.log(e.step,"NPUSHB[]",s);for(var o=0;o<s;o++)r.push(i[++n]);e.ip=n},function(e){var i=e.ip,n=e.prog,r=e.stack,s=n[++i];t.DEBUG&&console.log(e.step,"NPUSHW[]",s);for(var o=0;o<s;o++){var a=n[++i]<<8|n[++i];32768&a&&(a=-(1+(65535^a))),r.push(a)}e.ip=i},function(e){var i=e.stack,n=e.store;n||(n=e.store=[]);var r=i.pop(),s=i.pop();t.DEBUG&&console.log(e.step,"WS",r,s),n[s]=r},function(e){var i=e.stack,n=e.store,r=i.pop();t.DEBUG&&console.log(e.step,"RS",r);var s=n&&n[r]||0;i.push(s)},function(e){var i=e.stack,n=i.pop(),r=i.pop();t.DEBUG&&console.log(e.step,"WCVTP",n,r),e.cvt[r]=n/64},function(e){var i=e.stack,n=i.pop();t.DEBUG&&console.log(e.step,"RCVT",n),i.push(64*e.cvt[n])},_i.bind(void 0,0),_i.bind(void 0,1),void 0,yi.bind(void 0,0),yi.bind(void 0,1),function(e){t.DEBUG&&console.log(e.step,"MPPEM[]"),e.stack.push(e.ppem)},void 0,function(e){t.DEBUG&&console.log(e.step,"FLIPON[]"),e.autoFlip=!0},void 0,void 0,function(e){var i=e.stack,n=i.pop(),r=i.pop();t.DEBUG&&console.log(e.step,"LT[]",n,r),i.push(r<n?1:0)},function(e){var i=e.stack,n=i.pop(),r=i.pop();t.DEBUG&&console.log(e.step,"LTEQ[]",n,r),i.push(r<=n?1:0)},function(e){var i=e.stack,n=i.pop(),r=i.pop();t.DEBUG&&console.log(e.step,"GT[]",n,r),i.push(r>n?1:0)},function(e){var i=e.stack,n=i.pop(),r=i.pop();t.DEBUG&&console.log(e.step,"GTEQ[]",n,r),i.push(r>=n?1:0)},function(e){var i=e.stack,n=i.pop(),r=i.pop();t.DEBUG&&console.log(e.step,"EQ[]",n,r),i.push(n===r?1:0)},function(e){var i=e.stack,n=i.pop(),r=i.pop();t.DEBUG&&console.log(e.step,"NEQ[]",n,r),i.push(n!==r?1:0)},function(e){var i=e.stack,n=i.pop();t.DEBUG&&console.log(e.step,"ODD[]",n),i.push(Math.trunc(n)%2?1:0)},function(e){var i=e.stack,n=i.pop();t.DEBUG&&console.log(e.step,"EVEN[]",n),i.push(Math.trunc(n)%2?0:1)},function(e){var i=e.stack.pop();t.DEBUG&&console.log(e.step,"IF[]",i),i||(ni(e,!0),t.DEBUG&&console.log(e.step,"EIF[]"))},function(e){t.DEBUG&&console.log(e.step,"EIF[]")},function(e){var i=e.stack,n=i.pop(),r=i.pop();t.DEBUG&&console.log(e.step,"AND[]",n,r),i.push(n&&r?1:0)},function(e){var i=e.stack,n=i.pop(),r=i.pop();t.DEBUG&&console.log(e.step,"OR[]",n,r),i.push(n||r?1:0)},function(e){var i=e.stack,n=i.pop();t.DEBUG&&console.log(e.step,"NOT[]",n),i.push(n?0:1)},xi.bind(void 0,1),function(e){var i=e.stack.pop();t.DEBUG&&console.log(e.step,"SDB[]",i),e.deltaBase=i},function(e){var i=e.stack.pop();t.DEBUG&&console.log(e.step,"SDS[]",i),e.deltaShift=Math.pow(.5,i)},function(e){var i=e.stack,n=i.pop(),r=i.pop();t.DEBUG&&console.log(e.step,"ADD[]",n,r),i.push(r+n)},function(e){var i=e.stack,n=i.pop(),r=i.pop();t.DEBUG&&console.log(e.step,"SUB[]",n,r),i.push(r-n)},function(e){var i=e.stack,n=i.pop(),r=i.pop();t.DEBUG&&console.log(e.step,"DIV[]",n,r),i.push(64*r/n)},function(e){var i=e.stack,n=i.pop(),r=i.pop();t.DEBUG&&console.log(e.step,"MUL[]",n,r),i.push(r*n/64)},function(e){var i=e.stack,n=i.pop();t.DEBUG&&console.log(e.step,"ABS[]",n),i.push(Math.abs(n))},function(e){var i=e.stack,n=i.pop();t.DEBUG&&console.log(e.step,"NEG[]",n),i.push(-n)},function(e){var i=e.stack,n=i.pop();t.DEBUG&&console.log(e.step,"FLOOR[]",n),i.push(64*Math.floor(n/64))},function(e){var i=e.stack,n=i.pop();t.DEBUG&&console.log(e.step,"CEILING[]",n),i.push(64*Math.ceil(n/64))},wi.bind(void 0,0),wi.bind(void 0,1),wi.bind(void 0,2),wi.bind(void 0,3),void 0,void 0,void 0,void 0,function(e){var i=e.stack,n=i.pop(),r=i.pop();t.DEBUG&&console.log(e.step,"WCVTF[]",n,r),e.cvt[r]=n*e.ppem/e.font.unitsPerEm},xi.bind(void 0,2),xi.bind(void 0,3),bi.bind(void 0,1),bi.bind(void 0,2),bi.bind(void 0,3),function(e){var i,n=e.stack.pop();switch(t.DEBUG&&console.log(e.step,"SROUND[]",n),e.round=We,192&n){case 0:i=.5;break;case 64:i=1;break;case 128:i=2;break;default:throw new Error("invalid SROUND value")}switch(e.srPeriod=i,48&n){case 0:e.srPhase=0;break;case 16:e.srPhase=.25*i;break;case 32:e.srPhase=.5*i;break;case 48:e.srPhase=.75*i;break;default:throw new Error("invalid SROUND value")}n&=15,e.srThreshold=0===n?0:(n/8-.5)*i},function(e){var i,n=e.stack.pop();switch(t.DEBUG&&console.log(e.step,"S45ROUND[]",n),e.round=We,192&n){case 0:i=Math.sqrt(2)/2;break;case 64:i=Math.sqrt(2);break;case 128:i=2*Math.sqrt(2);break;default:throw new Error("invalid S45ROUND value")}switch(e.srPeriod=i,48&n){case 0:e.srPhase=0;break;case 16:e.srPhase=.25*i;break;case 32:e.srPhase=.5*i;break;case 48:e.srPhase=.75*i;break;default:throw new Error("invalid S45ROUND value")}n&=15,e.srThreshold=0===n?0:(n/8-.5)*i},void 0,void 0,function(e){t.DEBUG&&console.log(e.step,"ROFF[]"),e.round=Xe},void 0,function(e){t.DEBUG&&console.log(e.step,"RUTG[]"),e.round=qe},function(e){t.DEBUG&&console.log(e.step,"RDTG[]"),e.round=He},li,li,void 0,void 0,void 0,void 0,void 0,function(e){var i=e.stack.pop();t.DEBUG&&console.log(e.step,"SCANCTRL[]",i)},vi.bind(void 0,0),vi.bind(void 0,1),function(e){var i=e.stack,n=i.pop(),r=0;t.DEBUG&&console.log(e.step,"GETINFO[]",n),1&n&&(r=35),32&n&&(r|=4096),i.push(r)},void 0,function(e){var i=e.stack,n=i.pop(),r=i.pop(),s=i.pop();t.DEBUG&&console.log(e.step,"ROLL[]"),i.push(r),i.push(n),i.push(s)},function(e){var i=e.stack,n=i.pop(),r=i.pop();t.DEBUG&&console.log(e.step,"MAX[]",n,r),i.push(Math.max(r,n))},function(e){var i=e.stack,n=i.pop(),r=i.pop();t.DEBUG&&console.log(e.step,"MIN[]",n,r),i.push(Math.min(r,n))},function(e){var i=e.stack.pop();t.DEBUG&&console.log(e.step,"SCANTYPE[]",i)},function(e){var i=e.stack.pop(),n=e.stack.pop();switch(t.DEBUG&&console.log(e.step,"INSTCTRL[]",i,n),i){case 1:return void(e.inhibitGridFit=!!n);case 2:return void(e.ignoreCvt=!!n);default:throw new Error("invalid INSTCTRL[] selector")}},void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,Si.bind(void 0,1),Si.bind(void 0,2),Si.bind(void 0,3),Si.bind(void 0,4),Si.bind(void 0,5),Si.bind(void 0,6),Si.bind(void 0,7),Si.bind(void 0,8),Ti.bind(void 0,1),Ti.bind(void 0,2),Ti.bind(void 0,3),Ti.bind(void 0,4),Ti.bind(void 0,5),Ti.bind(void 0,6),Ti.bind(void 0,7),Ti.bind(void 0,8),Ci.bind(void 0,0,0,0,0,0),Ci.bind(void 0,0,0,0,0,1),Ci.bind(void 0,0,0,0,0,2),Ci.bind(void 0,0,0,0,0,3),Ci.bind(void 0,0,0,0,1,0),Ci.bind(void 0,0,0,0,1,1),Ci.bind(void 0,0,0,0,1,2),Ci.bind(void 0,0,0,0,1,3),Ci.bind(void 0,0,0,1,0,0),Ci.bind(void 0,0,0,1,0,1),Ci.bind(void 0,0,0,1,0,2),Ci.bind(void 0,0,0,1,0,3),Ci.bind(void 0,0,0,1,1,0),Ci.bind(void 0,0,0,1,1,1),Ci.bind(void 0,0,0,1,1,2),Ci.bind(void 0,0,0,1,1,3),Ci.bind(void 0,0,1,0,0,0),Ci.bind(void 0,0,1,0,0,1),Ci.bind(void 0,0,1,0,0,2),Ci.bind(void 0,0,1,0,0,3),Ci.bind(void 0,0,1,0,1,0),Ci.bind(void 0,0,1,0,1,1),Ci.bind(void 0,0,1,0,1,2),Ci.bind(void 0,0,1,0,1,3),Ci.bind(void 0,0,1,1,0,0),Ci.bind(void 0,0,1,1,0,1),Ci.bind(void 0,0,1,1,0,2),Ci.bind(void 0,0,1,1,0,3),Ci.bind(void 0,0,1,1,1,0),Ci.bind(void 0,0,1,1,1,1),Ci.bind(void 0,0,1,1,1,2),Ci.bind(void 0,0,1,1,1,3),Ci.bind(void 0,1,0,0,0,0),Ci.bind(void 0,1,0,0,0,1),Ci.bind(void 0,1,0,0,0,2),Ci.bind(void 0,1,0,0,0,3),Ci.bind(void 0,1,0,0,1,0),Ci.bind(void 0,1,0,0,1,1),Ci.bind(void 0,1,0,0,1,2),Ci.bind(void 0,1,0,0,1,3),Ci.bind(void 0,1,0,1,0,0),Ci.bind(void 0,1,0,1,0,1),Ci.bind(void 0,1,0,1,0,2),Ci.bind(void 0,1,0,1,0,3),Ci.bind(void 0,1,0,1,1,0),Ci.bind(void 0,1,0,1,1,1),Ci.bind(void 0,1,0,1,1,2),Ci.bind(void 0,1,0,1,1,3),Ci.bind(void 0,1,1,0,0,0),Ci.bind(void 0,1,1,0,0,1),Ci.bind(void 0,1,1,0,0,2),Ci.bind(void 0,1,1,0,0,3),Ci.bind(void 0,1,1,0,1,0),Ci.bind(void 0,1,1,0,1,1),Ci.bind(void 0,1,1,0,1,2),Ci.bind(void 0,1,1,0,1,3),Ci.bind(void 0,1,1,1,0,0),Ci.bind(void 0,1,1,1,0,1),Ci.bind(void 0,1,1,1,0,2),Ci.bind(void 0,1,1,1,0,3),Ci.bind(void 0,1,1,1,1,0),Ci.bind(void 0,1,1,1,1,1),Ci.bind(void 0,1,1,1,1,2),Ci.bind(void 0,1,1,1,1,3)],Oi.prototype.setState=function(t,e){return this.state[t]=e,this.activeState={key:t,value:this.state[t]},this.activeState},Oi.prototype.getState=function(t){return this.state[t]||null},Ii.prototype.inboundIndex=function(t){return t>=0&&t<this.tokens.length},Ii.prototype.composeRUD=function(t){var e=this,i=t.map((function(t){return e[t[0]].apply(e,t.slice(1).concat(true))})),n=function(t){return"object"==typeof t&&t.hasOwnProperty("FAIL")};if(i.every(n))return{FAIL:"composeRUD: one or more operations hasn't completed successfully",report:i.filter(n)};this.dispatch("composeRUD",[i.filter((function(t){return!n(t)}))])},Ii.prototype.replaceRange=function(t,e,i,n){e=null!==e?e:this.tokens.length;var r=i.every((function(t){return t instanceof Oi}));if(!isNaN(t)&&this.inboundIndex(t)&&r){var s=this.tokens.splice.apply(this.tokens,[t,e].concat(i));return n||this.dispatch("replaceToken",[t,e,i]),[s,i]}return{FAIL:"replaceRange: invalid tokens or startIndex."}},Ii.prototype.replaceToken=function(t,e,i){if(!isNaN(t)&&this.inboundIndex(t)&&e instanceof Oi){var n=this.tokens.splice(t,1,e);return i||this.dispatch("replaceToken",[t,e]),[n[0],e]}return{FAIL:"replaceToken: invalid token or index."}},Ii.prototype.removeRange=function(t,e,i){e=isNaN(e)?this.tokens.length:e;var n=this.tokens.splice(t,e);return i||this.dispatch("removeRange",[n,t,e]),n},Ii.prototype.removeToken=function(t,e){if(!isNaN(t)&&this.inboundIndex(t)){var i=this.tokens.splice(t,1);return e||this.dispatch("removeToken",[i,t]),i}return{FAIL:"removeToken: invalid token index."}},Ii.prototype.insertToken=function(t,e,i){return t.every((function(t){return t instanceof Oi}))?(this.tokens.splice.apply(this.tokens,[e,0].concat(t)),i||this.dispatch("insertToken",[t,e]),t):{FAIL:"insertToken: invalid token(s)."}},Ii.prototype.registerModifier=function(t,e,i){this.events.newToken.subscribe((function(n,r){var s=[n,r],o=[n,r];if(null===e||!0===e.apply(this,s)){var a=i.apply(this,o);n.setState(t,a)}})),this.registeredModifiers.push(t)},Di.prototype.subscribe=function(t){return"function"==typeof t?this.subscribers.push(t)-1:{FAIL:"invalid '"+this.eventId+"' event handler"}},Di.prototype.unsubscribe=function(t){this.subscribers.splice(t,1)},Ei.prototype.setCurrentIndex=function(t){this.index=t,this.current=this.context[t],this.backtrack=this.context.slice(0,t),this.lookahead=this.context.slice(t+1)},Ei.prototype.get=function(t){switch(!0){case 0===t:return this.current;case t<0&&Math.abs(t)<=this.backtrack.length:return this.backtrack.slice(t)[0];case t>0&&t<=this.lookahead.length:return this.lookahead[t-1];default:return null}},Ii.prototype.rangeToText=function(t){if(t instanceof Ni)return this.getRangeTokens(t).map((function(t){return t.char})).join("")},Ii.prototype.getText=function(){return this.tokens.map((function(t){return t.char})).join("")},Ii.prototype.getContext=function(t){var e=this.registeredContexts[t];return e||null},Ii.prototype.on=function(t,e){var i=this.events[t];return i?i.subscribe(e):null},Ii.prototype.dispatch=function(t,e){var i=this,n=this.events[t];n instanceof Di&&n.subscribers.forEach((function(t){t.apply(i,e||[])}))},Ii.prototype.registerContextChecker=function(t,e,i){if(this.getContext(t))return{FAIL:"context name '"+t+"' is already registered."};if("function"!=typeof e)return{FAIL:"missing context start check."};if("function"!=typeof i)return{FAIL:"missing context end check."};var n=new Fi(t,e,i);return this.registeredContexts[t]=n,this.contextCheckers.push(n),n},Ii.prototype.getRangeTokens=function(t){var e=t.startIndex+t.endOffset;return[].concat(this.tokens.slice(t.startIndex,e))},Ii.prototype.getContextRanges=function(t){var e=this.getContext(t);return e?e.ranges:{FAIL:"context checker '"+t+"' is not registered."}},Ii.prototype.resetContextsRanges=function(){var t=this.registeredContexts;for(var e in t){if(t.hasOwnProperty(e))t[e].ranges=[]}},Ii.prototype.updateContextsRanges=function(){this.resetContextsRanges();for(var t=this.tokens.map((function(t){return t.char})),e=0;e<t.length;e++){var i=new Ei(t,e);this.runContextCheck(i)}this.dispatch("updateContextsRanges",[this.registeredContexts])},Ii.prototype.setEndOffset=function(t,e){var i=new Ni(this.getContext(e).openRange.startIndex,t,e),n=this.getContext(e).ranges;return i.rangeId=e+"."+n.length,n.push(i),this.getContext(e).openRange=null,i},Ii.prototype.runContextCheck=function(t){var e=this,i=t.index;this.contextCheckers.forEach((function(n){var r=n.contextName,s=e.getContext(r).openRange;if(!s&&n.checkStart(t)&&(s=new Ni(i,null,r),e.getContext(r).openRange=s,e.dispatch("contextStart",[r,i])),s&&n.checkEnd(t)){var o=i-s.startIndex+1,a=e.setEndOffset(o,r);e.dispatch("contextEnd",[r,a])}}))},Ii.prototype.tokenize=function(t){this.tokens=[],this.resetContextsRanges();var e=Array.from(t);this.dispatch("start");for(var i=0;i<e.length;i++){var n=e[i],r=new Ei(e,i);this.dispatch("next",[r]),this.runContextCheck(r);var s=new Oi(n);this.tokens.push(s),this.dispatch("newToken",[s,r])}return this.dispatch("end",[this.tokens]),this.tokens},Pi.prototype.getDefaultScriptFeaturesIndexes=function(){for(var t=this.font.tables.gsub.scripts,e=0;e<t.length;e++){var i=t[e];if("DFLT"===i.tag)return i.script.defaultLangSys.featureIndexes}return[]},Pi.prototype.getScriptFeaturesIndexes=function(t){if(!this.font.tables.gsub)return[];if(!t)return this.getDefaultScriptFeaturesIndexes();for(var e=this.font.tables.gsub.scripts,i=0;i<e.length;i++){var n=e[i];if(n.tag===t&&n.script.defaultLangSys)return n.script.defaultLangSys.featureIndexes;var r=n.langSysRecords;if(r)for(var s=0;s<r.length;s++){var o=r[s];if(o.tag===t)return o.langSys.featureIndexes}}return this.getDefaultScriptFeaturesIndexes()},Pi.prototype.mapTagsToFeatures=function(t,e){for(var i={},n=0;n<t.length;n++){var r=t[n].tag,s=t[n].feature;i[r]=s}this.features[e].tags=i},Pi.prototype.getScriptFeatures=function(t){var e=this.features[t];if(this.features.hasOwnProperty(t))return e;var i=this.getScriptFeaturesIndexes(t);if(!i)return null;var n=this.font.tables.gsub;return e=i.map((function(t){return n.features[t]})),this.features[t]=e,this.mapTagsToFeatures(e,t),e},Pi.prototype.getSubstitutionType=function(t,e){return t.lookupType.toString()+e.substFormat.toString()},Pi.prototype.getLookupMethod=function(t,e){var i=this;switch(this.getSubstitutionType(t,e)){case"11":return function(t){return ki.apply(i,[t,e])};case"12":return function(t){return Xi.apply(i,[t,e])};case"63":return function(t){return ji.apply(i,[t,e])};case"41":return function(t){return Gi.apply(i,[t,e])};case"21":return function(t){return qi.apply(i,[t,e])};default:throw new Error("lookupType: "+t.lookupType+" - substFormat: "+e.substFormat+" is not yet supported")}},Pi.prototype.lookupFeature=function(t){var e=t.contextParams,i=e.index,n=this.getFeature({tag:t.tag,script:t.script});if(!n)return new Error("font '"+this.font.names.fullName.en+"' doesn't support feature '"+t.tag+"' for script '"+t.script+"'.");for(var r=this.getFeatureLookups(n),s=[].concat(e.context),o=0;o<r.length;o++)for(var a=r[o],u=this.getLookupSubtables(a),l=0;l<u.length;l++){var c=u[l],h=this.getSubstitutionType(a,c),d=this.getLookupMethod(a,c),p=void 0;switch(h){case"11":(p=d(e.current))&&s.splice(i,1,new Li({id:11,tag:t.tag,substitution:p}));break;case"12":(p=d(e.current))&&s.splice(i,1,new Li({id:12,tag:t.tag,substitution:p}));break;case"63":p=d(e),Array.isArray(p)&&p.length&&s.splice(i,1,new Li({id:63,tag:t.tag,substitution:p}));break;case"41":(p=d(e))&&s.splice(i,1,new Li({id:41,tag:t.tag,substitution:p}));break;case"21":(p=d(e.current))&&s.splice(i,1,new Li({id:21,tag:t.tag,substitution:p}))}e=new Ei(s,i),Array.isArray(p)&&!p.length||(p=null)}return s.length?s:null},Pi.prototype.supports=function(t){if(!t.script)return!1;this.getScriptFeatures(t.script);var e=this.features.hasOwnProperty(t.script);if(!t.tag)return e;var i=this.features[t.script].some((function(e){return e.tag===t.tag}));return e&&i},Pi.prototype.getLookupSubtables=function(t){return t.subtables||null},Pi.prototype.getLookupByIndex=function(t){return this.font.tables.gsub.lookups[t]||null},Pi.prototype.getFeatureLookups=function(t){return t.lookupListIndexes.map(this.getLookupByIndex.bind(this))},Pi.prototype.getFeature=function(t){if(!this.font)return{FAIL:"No font was found"};this.features.hasOwnProperty(t.script)||this.getScriptFeatures(t.script);var e=this.features[t.script];return e?e.tags[t.tag]?this.features[t.script].tags[t.tag]:null:{FAIL:"No feature for script "+t.script}};var Hi={startCheck:function(t){var e=t.current,i=t.get(-1);return null===i&&Vi(e)||!Vi(i)&&Vi(e)},endCheck:function(t){var e=t.get(1);return null===e||!Vi(e)}};var Wi={startCheck:function(t){var e=t.current,i=t.get(-1);return(Vi(e)||Ai(e))&&!Vi(i)},endCheck:function(t){var e=t.get(1);switch(!0){case null===e:return!0;case!Vi(e)&&!Ai(e):var i=/\s/.test(e);if(!i)return!0;if(i){var n;if(n=t.lookahead.some((function(t){return Vi(t)||Ai(t)})),!n)return!0}break;default:return!1}}};var Yi={11:function(t,e,i){e[i].setState(t.tag,t.substitution)},12:function(t,e,i){e[i].setState(t.tag,t.substitution)},63:function(t,e,i){t.substitution.forEach((function(n,r){e[i+r].setState(t.tag,n)}))},41:function(t,e,i){var n=e[i];n.setState(t.tag,t.substitution.ligGlyph);for(var r=t.substitution.components.length,s=0;s<r;s++)(n=e[i+s+1]).setState("deleted",!0)}};function Zi(t,e,i){t instanceof Li&&Yi[t.id]&&Yi[t.id](t,e,i)}function Ki(t){var e=this,i="arab",n=this.featuresTags.arab,r=this.tokenizer.getRangeTokens(t);if(1!==r.length){var s=new Ei(r.map((function(t){return t.getState("glyphIndex")})),0),o=new Ei(r.map((function(t){return t.char})),0);r.forEach((function(t,a){if(!Ai(t.char)){s.setCurrentIndex(a),o.setCurrentIndex(a);var u,l=0;switch(function(t){for(var e=[].concat(t.backtrack),i=e.length-1;i>=0;i--){var n=e[i],r=Bi(n),s=Ai(n);if(!r&&!s)return!0;if(r)return!1}return!1}(o)&&(l|=1),function(t){if(Bi(t.current))return!1;for(var e=0;e<t.lookahead.length;e++)if(!Ai(t.lookahead[e]))return!0;return!1}(o)&&(l|=2),l){case 1:u="fina";break;case 2:u="init";break;case 3:u="medi"}if(-1!==n.indexOf(u)){var c=e.query.lookupFeature({tag:u,script:i,contextParams:s});if(c instanceof Error)return console.info(c.message);c.forEach((function(t,e){t instanceof Li&&(Zi(t,r,e),s.context[e]=t.substitution)}))}}}))}}function Qi(t,e){return new Ei(t.map((function(t){return t.activeState.value})),e||0)}function $i(t){var e=this,i=this.tokenizer.getRangeTokens(t),n=Qi(i);n.context.forEach((function(t,r){n.setCurrentIndex(r);var s=e.query.lookupFeature({tag:"rlig",script:"arab",contextParams:n});s.length&&(s.forEach((function(t){return Zi(t,i,r)})),n=Qi(i))}))}var Ji={startCheck:function(t){var e=t.current,i=t.get(-1);return null===i&&Ri(e)||!Ri(i)&&Ri(e)},endCheck:function(t){var e=t.get(1);return null===e||!Ri(e)}};function tn(t,e){return new Ei(t.map((function(t){return t.activeState.value})),e||0)}function en(t){var e=this,i=this.tokenizer.getRangeTokens(t),n=tn(i);n.context.forEach((function(t,r){n.setCurrentIndex(r);var s=e.query.lookupFeature({tag:"liga",script:"latn",contextParams:n});s.length&&(s.forEach((function(t){return Zi(t,i,r)})),n=tn(i))}))}function nn(t){this.baseDir=t||"ltr",this.tokenizer=new Ii,this.featuresTags={}}function rn(t){var e=this.contextChecks[t+"Check"];return this.tokenizer.registerContextChecker(t,e.startCheck,e.endCheck)}function sn(){return rn.call(this,"latinWord"),rn.call(this,"arabicWord"),rn.call(this,"arabicSentence"),this.tokenizer.tokenize(this.text)}function on(){var t=this;this.tokenizer.getContextRanges("arabicSentence").forEach((function(e){var i=t.tokenizer.getRangeTokens(e);t.tokenizer.replaceRange(e.startIndex,e.endOffset,i.reverse())}))}function an(){if(-1===this.tokenizer.registeredModifiers.indexOf("glyphIndex"))throw new Error("glyphIndex modifier is required to apply arabic presentation features.")}function un(){var t=this;this.featuresTags.hasOwnProperty("arab")&&(an.call(this),this.tokenizer.getContextRanges("arabicWord").forEach((function(e){Ki.call(t,e)})))}function ln(){var t=this,e="arab";this.featuresTags.hasOwnProperty(e)&&(-1!==this.featuresTags.arab.indexOf("rlig")&&(an.call(this),this.tokenizer.getContextRanges("arabicWord").forEach((function(e){$i.call(t,e)}))))}function cn(){var t=this,e="latn";this.featuresTags.hasOwnProperty(e)&&(-1!==this.featuresTags.latn.indexOf("liga")&&(an.call(this),this.tokenizer.getContextRanges("latinWord").forEach((function(e){en.call(t,e)}))))}function hn(t){(t=t||{}).tables=t.tables||{},t.empty||(Ee(t.familyName,"When creating a new Font object, familyName is required."),Ee(t.styleName,"When creating a new Font object, styleName is required."),Ee(t.unitsPerEm,"When creating a new Font object, unitsPerEm is required."),Ee(t.ascender,"When creating a new Font object, ascender is required."),Ee(t.descender<=0,"When creating a new Font object, negative descender value is required."),this.names={fontFamily:{en:t.familyName||" "},fontSubfamily:{en:t.styleName||" "},fullName:{en:t.fullName||t.familyName+" "+t.styleName},postScriptName:{en:t.postScriptName||(t.familyName+t.styleName).replace(/\s/g,"")},designer:{en:t.designer||" "},designerURL:{en:t.designerURL||" "},manufacturer:{en:t.manufacturer||" "},manufacturerURL:{en:t.manufacturerURL||" "},license:{en:t.license||" "},licenseURL:{en:t.licenseURL||" "},version:{en:t.version||"Version 0.1"},description:{en:t.description||" "},copyright:{en:t.copyright||" "},trademark:{en:t.trademark||" "}},this.unitsPerEm=t.unitsPerEm||1e3,this.ascender=t.ascender,this.descender=t.descender,this.createdTimestamp=t.createdTimestamp,this.tables=Object.assign(t.tables,{os2:Object.assign({usWeightClass:t.weightClass||this.usWeightClasses.MEDIUM,usWidthClass:t.widthClass||this.usWidthClasses.MEDIUM,fsSelection:t.fsSelection||this.fsSelectionValues.REGULAR},t.tables.os2)})),this.supported=!0,this.glyphs=new bt.GlyphSet(this,t.glyphs||[]),this.encoding=new dt(this),this.position=new Te(this),this.substitution=new Ce(this),this.tables=this.tables||{},this._push=null,this._hmtxTableData={},Object.defineProperty(this,"hinting",{get:function(){return this._hinting?this._hinting:"truetype"===this.outlinesFormat?this._hinting=new ke(this):void 0}})}function dn(t,e){var i=JSON.stringify(t),n=256;for(var r in e){var s=parseInt(r);if(s&&!(s<256)){if(JSON.stringify(e[r])===i)return s;n<=s&&(n=s+1)}}return e[n]=t,n}function pn(t,e,i){var n=dn(e.name,i);return[{name:"tag_"+t,type:"TAG",value:e.tag},{name:"minValue_"+t,type:"FIXED",value:e.minValue<<16},{name:"defaultValue_"+t,type:"FIXED",value:e.defaultValue<<16},{name:"maxValue_"+t,type:"FIXED",value:e.maxValue<<16},{name:"flags_"+t,type:"USHORT",value:0},{name:"nameID_"+t,type:"USHORT",value:n}]}function fn(t,e,i){var n={},r=new st.Parser(t,e);return n.tag=r.parseTag(),n.minValue=r.parseFixed(),n.defaultValue=r.parseFixed(),n.maxValue=r.parseFixed(),r.skip("uShort",1),n.name=i[r.parseUShort()]||{},n}function gn(t,e,i,n){for(var r=[{name:"nameID_"+t,type:"USHORT",value:dn(e.name,n)},{name:"flags_"+t,type:"USHORT",value:0}],s=0;s<i.length;++s){var o=i[s].tag;r.push({name:"axis_"+t+" "+o,type:"FIXED",value:e.coordinates[o]<<16})}return r}function mn(t,e,i,n){var r={},s=new st.Parser(t,e);r.name=n[s.parseUShort()]||{},s.skip("uShort",1),r.coordinates={};for(var o=0;o<i.length;++o)r.coordinates[i[o].tag]=s.parseFixed();return r}nn.prototype.setText=function(t){this.text=t},nn.prototype.contextChecks={latinWordCheck:Ji,arabicWordCheck:Hi,arabicSentenceCheck:Wi},nn.prototype.registerFeatures=function(t,e){var i=this,n=e.filter((function(e){return i.query.supports({script:t,tag:e})}));this.featuresTags.hasOwnProperty(t)?this.featuresTags[t]=this.featuresTags[t].concat(n):this.featuresTags[t]=n},nn.prototype.applyFeatures=function(t,e){if(!t)throw new Error("No valid font was provided to apply features");this.query||(this.query=new Pi(t));for(var i=0;i<e.length;i++){var n=e[i];this.query.supports({script:n.script})&&this.registerFeatures(n.script,n.tags)}},nn.prototype.registerModifier=function(t,e,i){this.tokenizer.registerModifier(t,e,i)},nn.prototype.checkContextReady=function(t){return!!this.tokenizer.getContext(t)},nn.prototype.applyFeaturesToContexts=function(){this.checkContextReady("arabicWord")&&(un.call(this),ln.call(this)),this.checkContextReady("latinWord")&&cn.call(this),this.checkContextReady("arabicSentence")&&on.call(this)},nn.prototype.processText=function(t){this.text&&this.text===t||(this.setText(t),sn.call(this),this.applyFeaturesToContexts())},nn.prototype.getBidiText=function(t){return this.processText(t),this.tokenizer.getText()},nn.prototype.getTextGlyphs=function(t){this.processText(t);for(var e=[],i=0;i<this.tokenizer.tokens.length;i++){var n=this.tokenizer.tokens[i];if(!n.state.deleted){var r=n.activeState.value;e.push(Array.isArray(r)?r[0]:r)}}return e},hn.prototype.hasChar=function(t){return null!==this.encoding.charToGlyphIndex(t)},hn.prototype.charToGlyphIndex=function(t){return this.encoding.charToGlyphIndex(t)},hn.prototype.charToGlyph=function(t){var e=this.charToGlyphIndex(t),i=this.glyphs.get(e);return i||(i=this.glyphs.get(0)),i},hn.prototype.updateFeatures=function(t){return this.defaultRenderOptions.features.map((function(e){return"latn"===e.script?{script:"latn",tags:e.tags.filter((function(e){return t[e]}))}:e}))},hn.prototype.stringToGlyphs=function(t,e){var i=this,n=new nn;n.registerModifier("glyphIndex",null,(function(t){return i.charToGlyphIndex(t.char)}));var r=e?this.updateFeatures(e.features):this.defaultRenderOptions.features;n.applyFeatures(this,r);for(var s=n.getTextGlyphs(t),o=s.length,a=new Array(o),u=this.glyphs.get(0),l=0;l<o;l+=1)a[l]=this.glyphs.get(s[l])||u;return a},hn.prototype.nameToGlyphIndex=function(t){return this.glyphNames.nameToGlyphIndex(t)},hn.prototype.nameToGlyph=function(t){var e=this.nameToGlyphIndex(t),i=this.glyphs.get(e);return i||(i=this.glyphs.get(0)),i},hn.prototype.glyphIndexToName=function(t){return this.glyphNames.glyphIndexToName?this.glyphNames.glyphIndexToName(t):""},hn.prototype.getKerningValue=function(t,e){t=t.index||t,e=e.index||e;var i=this.position.defaultKerningTables;return i?this.position.getKerningValue(i,t,e):this.kerningPairs[t+","+e]||0},hn.prototype.defaultRenderOptions={kerning:!0,features:[{script:"arab",tags:["init","medi","fina","rlig"]},{script:"latn",tags:["liga","rlig"]}]},hn.prototype.forEachGlyph=function(t,e,i,n,r,s){e=void 0!==e?e:0,i=void 0!==i?i:0,n=void 0!==n?n:72,r=Object.assign({},this.defaultRenderOptions,r);var o,a=1/this.unitsPerEm*n,u=this.stringToGlyphs(t,r);if(r.kerning){var l=r.script||this.position.getDefaultScriptName();o=this.position.getKerningTables(l,r.language)}for(var c=0;c<u.length;c+=1){var h=u[c];if(s.call(this,h,e,i,n,r),h.advanceWidth&&(e+=h.advanceWidth*a),r.kerning&&c<u.length-1)e+=(o?this.position.getKerningValue(o,h.index,u[c+1].index):this.getKerningValue(h,u[c+1]))*a;r.letterSpacing?e+=r.letterSpacing*n:r.tracking&&(e+=r.tracking/1e3*n)}return e},hn.prototype.getPath=function(t,e,i,n,r){var s=new O;return this.forEachGlyph(t,e,i,n,r,(function(t,e,i,n){var o=t.getPath(e,i,n,r,this);s.extend(o)})),s},hn.prototype.getPaths=function(t,e,i,n,r){var s=[];return this.forEachGlyph(t,e,i,n,r,(function(t,e,i,n){var o=t.getPath(e,i,n,r,this);s.push(o)})),s},hn.prototype.getAdvanceWidth=function(t,e,i){return this.forEachGlyph(t,0,0,e,i,(function(){}))},hn.prototype.draw=function(t,e,i,n,r,s){this.getPath(e,i,n,r,s).draw(t)},hn.prototype.drawPoints=function(t,e,i,n,r,s){this.forEachGlyph(e,i,n,r,s,(function(e,i,n,r){e.drawPoints(t,i,n,r)}))},hn.prototype.drawMetrics=function(t,e,i,n,r,s){this.forEachGlyph(e,i,n,r,s,(function(e,i,n,r){e.drawMetrics(t,i,n,r)}))},hn.prototype.getEnglishName=function(t){var e=this.names[t];if(e)return e.en},hn.prototype.validate=function(){var t=this;function e(e){var i=t.getEnglishName(e);i&&i.trim().length}e("fontFamily"),e("weightName"),e("manufacturer"),e("copyright"),e("version"),this.unitsPerEm},hn.prototype.toTables=function(){return xe.fontToTable(this)},hn.prototype.toBuffer=function(){return console.warn("Font.toBuffer is deprecated. Use Font.toArrayBuffer instead."),this.toArrayBuffer()},hn.prototype.toArrayBuffer=function(){for(var t=this.toTables().encode(),e=new ArrayBuffer(t.length),i=new Uint8Array(e),n=0;n<t.length;n++)i[n]=t[n];return e},hn.prototype.download=function(t){var e=this.getEnglishName("fontFamily"),i=this.getEnglishName("fontSubfamily");t=t||e.replace(/\s/g,"")+"-"+i+".otf";var n=this.toArrayBuffer();if("undefined"!=typeof window)if(window.URL=window.URL||window.webkitURL,window.URL){var r=new DataView(n),s=new Blob([r],{type:"font/opentype"}),o=document.createElement("a");o.href=window.URL.createObjectURL(s),o.download=t;var a=document.createEvent("MouseEvents");a.initEvent("click",!0,!1),o.dispatchEvent(a)}else console.warn("Font file could not be downloaded. Try using a different browser.");else{var u=require("fs"),l=function(t){for(var e=new Buffer(t.byteLength),i=new Uint8Array(t),n=0;n<e.length;++n)e[n]=i[n];return e}(n);u.writeFileSync(t,l)}},hn.prototype.fsSelectionValues={ITALIC:1,UNDERSCORE:2,NEGATIVE:4,OUTLINED:8,STRIKEOUT:16,BOLD:32,REGULAR:64,USER_TYPO_METRICS:128,WWS:256,OBLIQUE:512},hn.prototype.usWidthClasses={ULTRA_CONDENSED:1,EXTRA_CONDENSED:2,CONDENSED:3,SEMI_CONDENSED:4,MEDIUM:5,SEMI_EXPANDED:6,EXPANDED:7,EXTRA_EXPANDED:8,ULTRA_EXPANDED:9},hn.prototype.usWeightClasses={THIN:100,EXTRA_LIGHT:200,LIGHT:300,NORMAL:400,MEDIUM:500,SEMI_BOLD:600,BOLD:700,EXTRA_BOLD:800,BLACK:900};var _n={make:function(t,e){var i=new Q.Table("fvar",[{name:"version",type:"ULONG",value:65536},{name:"offsetToData",type:"USHORT",value:0},{name:"countSizePairs",type:"USHORT",value:2},{name:"axisCount",type:"USHORT",value:t.axes.length},{name:"axisSize",type:"USHORT",value:20},{name:"instanceCount",type:"USHORT",value:t.instances.length},{name:"instanceSize",type:"USHORT",value:4+4*t.axes.length}]);i.offsetToData=i.sizeOf();for(var n=0;n<t.axes.length;n++)i.fields=i.fields.concat(pn(n,t.axes[n],e));for(var r=0;r<t.instances.length;r++)i.fields=i.fields.concat(gn(r,t.instances[r],t.axes,e));return i},parse:function(t,e,i){var n=new st.Parser(t,e),r=n.parseULong();E.argument(65536===r,"Unsupported fvar table version.");var s=n.parseOffset16();n.skip("uShort",1);for(var o=n.parseUShort(),a=n.parseUShort(),u=n.parseUShort(),l=n.parseUShort(),c=[],h=0;h<o;h++)c.push(fn(t,e+s+h*a,i));for(var d=[],p=e+s+o*a,f=0;f<u;f++)d.push(mn(t,p+f*l,c,i));return{axes:c,instances:d}}},yn=function(){return{coverage:this.parsePointer(nt.coverage),attachPoints:this.parseList(nt.pointer(nt.uShortList))}},xn=function(){var t=this.parseUShort();return E.argument(1===t||2===t||3===t,"Unsupported CaretValue table version."),1===t?{coordinate:this.parseShort()}:2===t?{pointindex:this.parseShort()}:3===t?{coordinate:this.parseShort()}:void 0},wn=function(){return this.parseList(nt.pointer(xn))},bn=function(){return{coverage:this.parsePointer(nt.coverage),ligGlyphs:this.parseList(nt.pointer(wn))}},vn=function(){return this.parseUShort(),this.parseList(nt.pointer(nt.coverage))};var Sn={parse:function(t,e){var i=new nt(t,e=e||0),n=i.parseVersion(1);E.argument(1===n||1.2===n||1.3===n,"Unsupported GDEF table version.");var r={version:n,classDef:i.parsePointer(nt.classDef),attachList:i.parsePointer(yn),ligCaretList:i.parsePointer(bn),markAttachClassDef:i.parsePointer(nt.classDef)};return n>=1.2&&(r.markGlyphSets=i.parsePointer(vn)),r}},Tn=new Array(10);Tn[1]=function(){var t=this.offset+this.relativeOffset,e=this.parseUShort();return 1===e?{posFormat:1,coverage:this.parsePointer(nt.coverage),value:this.parseValueRecord()}:2===e?{posFormat:2,coverage:this.parsePointer(nt.coverage),values:this.parseValueRecordList()}:void E.assert(!1,"0x"+t.toString(16)+": GPOS lookup type 1 format must be 1 or 2.")},Tn[2]=function(){var t=this.offset+this.relativeOffset,e=this.parseUShort();E.assert(1===e||2===e,"0x"+t.toString(16)+": GPOS lookup type 2 format must be 1 or 2.");var i=this.parsePointer(nt.coverage),n=this.parseUShort(),r=this.parseUShort();if(1===e)return{posFormat:e,coverage:i,valueFormat1:n,valueFormat2:r,pairSets:this.parseList(nt.pointer(nt.list((function(){return{secondGlyph:this.parseUShort(),value1:this.parseValueRecord(n),value2:this.parseValueRecord(r)}}))))};if(2===e){var s=this.parsePointer(nt.classDef),o=this.parsePointer(nt.classDef),a=this.parseUShort(),u=this.parseUShort();return{posFormat:e,coverage:i,valueFormat1:n,valueFormat2:r,classDef1:s,classDef2:o,class1Count:a,class2Count:u,classRecords:this.parseList(a,nt.list(u,(function(){return{value1:this.parseValueRecord(n),value2:this.parseValueRecord(r)}})))}}},Tn[3]=function(){return{error:"GPOS Lookup 3 not supported"}},Tn[4]=function(){return{error:"GPOS Lookup 4 not supported"}},Tn[5]=function(){return{error:"GPOS Lookup 5 not supported"}},Tn[6]=function(){return{error:"GPOS Lookup 6 not supported"}},Tn[7]=function(){return{error:"GPOS Lookup 7 not supported"}},Tn[8]=function(){return{error:"GPOS Lookup 8 not supported"}},Tn[9]=function(){return{error:"GPOS Lookup 9 not supported"}};var Cn=new Array(10);var On={parse:function(t,e){var i=new nt(t,e=e||0),n=i.parseVersion(1);return E.argument(1===n||1.1===n,"Unsupported GPOS table version "+n),1===n?{version:n,scripts:i.parseScriptList(),features:i.parseFeatureList(),lookups:i.parseLookupList(Tn)}:{version:n,scripts:i.parseScriptList(),features:i.parseFeatureList(),lookups:i.parseLookupList(Tn),variations:i.parseFeatureVariationsList()}},make:function(t){return new Q.Table("GPOS",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new Q.ScriptList(t.scripts)},{name:"features",type:"TABLE",value:new Q.FeatureList(t.features)},{name:"lookups",type:"TABLE",value:new Q.LookupList(t.lookups,Cn)}])}};var Nn={parse:function(t,e){var i=new st.Parser(t,e),n=i.parseUShort();if(0===n)return function(t){var e={};t.skip("uShort");var i=t.parseUShort();E.argument(0===i,"Unsupported kern sub-table version."),t.skip("uShort",2);var n=t.parseUShort();t.skip("uShort",3);for(var r=0;r<n;r+=1){var s=t.parseUShort(),o=t.parseUShort(),a=t.parseShort();e[s+","+o]=a}return e}(i);if(1===n)return function(t){var e={};t.skip("uShort"),t.parseULong()>1&&console.warn("Only the first kern subtable is supported."),t.skip("uLong");var i=255&t.parseUShort();if(t.skip("uShort"),0===i){var n=t.parseUShort();t.skip("uShort",3);for(var r=0;r<n;r+=1){var s=t.parseUShort(),o=t.parseUShort(),a=t.parseShort();e[s+","+o]=a}}return e}(i);throw new Error("Unsupported kern table version ("+n+").")}};var Fn={parse:function(t,e,i,n){for(var r=new st.Parser(t,e),s=n?r.parseUShort:r.parseULong,o=[],a=0;a<i+1;a+=1){var u=s.call(r);n&&(u*=2),o.push(u)}return o}};function En(t,e){require("fs").readFile(t,(function(t,i){if(t)return e(t.message);e(null,Fe(i))}))}function Dn(t,e){var i=new XMLHttpRequest;i.open("get",t,!0),i.responseType="arraybuffer",i.onload=function(){return i.response?e(null,i.response):e("Font could not be loaded: "+i.statusText)},i.onerror=function(){e("Font could not be loaded")},i.send()}function Mn(t,e){for(var i=[],n=12,r=0;r<e;r+=1){var s=st.getTag(t,n),o=st.getULong(t,n+4),a=st.getULong(t,n+8),u=st.getULong(t,n+12);i.push({tag:s,checksum:o,offset:a,length:u,compression:!1}),n+=16}return i}function In(t,e){if("WOFF"===e.compression){var i=new Uint8Array(t.buffer,e.offset+2,e.compressedLength-2),n=new Uint8Array(e.length);if(S(i,n),n.byteLength!==e.length)throw new Error("Decompression error: "+e.tag+" decompressed length doesn't match recorded length");return{data:new DataView(n.buffer,0),offset:0}}return{data:t,offset:e.offset}}function Vn(t,e){var i,n;e=null==e?{}:e;var r,s,o,a,u,l,c,h,d,p,f,g,m,_=new hn({empty:!0}),y=new DataView(t,0),x=[],w=st.getTag(y,0);if(w===String.fromCharCode(0,1,0,0)||"true"===w||"typ1"===w)_.outlinesFormat="truetype",x=Mn(y,r=st.getUShort(y,4));else if("OTTO"===w)_.outlinesFormat="cff",x=Mn(y,r=st.getUShort(y,4));else{if("wOFF"!==w)throw new Error("Unsupported OpenType signature "+w);var b=st.getTag(y,4);if(b===String.fromCharCode(0,1,0,0))_.outlinesFormat="truetype";else{if("OTTO"!==b)throw new Error("Unsupported OpenType flavor "+w);_.outlinesFormat="cff"}x=function(t,e){for(var i=[],n=44,r=0;r<e;r+=1){var s=st.getTag(t,n),o=st.getULong(t,n+4),a=st.getULong(t,n+8),u=st.getULong(t,n+12),l=void 0;l=a<u&&"WOFF",i.push({tag:s,offset:o,compression:l,compressedLength:a,length:u}),n+=20}return i}(y,r=st.getUShort(y,12))}for(var v=0;v<r;v+=1){var S=x[v],T=void 0;switch(S.tag){case"cmap":T=In(y,S),_.tables.cmap=at.parse(T.data,T.offset),_.encoding=new pt(_.tables.cmap);break;case"cvt ":T=In(y,S),m=new st.Parser(T.data,T.offset),_.tables.cvt=m.parseShortList(S.length/2);break;case"fvar":o=S;break;case"fpgm":T=In(y,S),m=new st.Parser(T.data,T.offset),_.tables.fpgm=m.parseByteList(S.length);break;case"head":T=In(y,S),_.tables.head=Xt.parse(T.data,T.offset),_.unitsPerEm=_.tables.head.unitsPerEm,i=_.tables.head.indexToLocFormat;break;case"hhea":T=In(y,S),_.tables.hhea=zt.parse(T.data,T.offset),_.ascender=_.tables.hhea.ascender,_.descender=_.tables.hhea.descender,_.numberOfHMetrics=_.tables.hhea.numberOfHMetrics;break;case"hmtx":h=S;break;case"ltag":T=In(y,S),n=Gt.parse(T.data,T.offset);break;case"maxp":T=In(y,S),_.tables.maxp=qt.parse(T.data,T.offset),_.numGlyphs=_.tables.maxp.numGlyphs;break;case"name":f=S;break;case"OS/2":T=In(y,S),_.tables.os2=oe.parse(T.data,T.offset);break;case"post":T=In(y,S),_.tables.post=ae.parse(T.data,T.offset),_.glyphNames=new gt(_.tables.post);break;case"prep":T=In(y,S),m=new st.Parser(T.data,T.offset),_.tables.prep=m.parseByteList(S.length);break;case"glyf":a=S;break;case"loca":p=S;break;case"CFF ":s=S;break;case"kern":d=S;break;case"GDEF":u=S;break;case"GPOS":l=S;break;case"GSUB":c=S;break;case"meta":g=S}}var C=In(y,f);if(_.tables.name=re.parse(C.data,C.offset,n),_.names=_.tables.name,a&&p){var O=0===i,N=In(y,p),F=Fn.parse(N.data,N.offset,_.numGlyphs,O),E=In(y,a);_.glyphs=Ue.parse(E.data,E.offset,F,_,e)}else{if(!s)throw new Error("Font doesn't contain TrueType or CFF outlines.");var D=In(y,s);kt.parse(D.data,D.offset,_,e)}var M=In(y,h);if(jt.parse(_,M.data,M.offset,_.numberOfHMetrics,_.numGlyphs,_.glyphs,e),mt(_,e),d){var I=In(y,d);_.kerningPairs=Nn.parse(I.data,I.offset)}else _.kerningPairs={};if(u){var V=In(y,u);_.tables.gdef=Sn.parse(V.data,V.offset)}if(l){var B=In(y,l);_.tables.gpos=On.parse(B.data,B.offset),_.position.init()}if(c){var A=In(y,c);_.tables.gsub=he.parse(A.data,A.offset)}if(o){var R=In(y,o);_.tables.fvar=_n.parse(R.data,R.offset,_.names)}if(g){var P=In(y,g);_.tables.meta=de.parse(P.data,P.offset),_.metas=_.tables.meta}return _}function Bn(t,e,i){i=null==i?{}:i;var n="undefined"==typeof window&&!i.isUrl?En:Dn;return new Promise((function(r,s){n(t,(function(t,n){if(t){if(e)return e(t);s(t)}var o;try{o=Vn(n,i)}catch(t){if(e)return e(t,null);s(t)}if(e)return e(null,o);r(o)}))}))}function An(t,e){return Vn(Fe(require("fs").readFileSync(t)),e)}var Rn=Object.freeze({__proto__:null,Font:hn,Glyph:yt,Path:O,BoundingBox:C,_parse:st,parse:Vn,load:Bn,loadSync:An});t.BoundingBox=C,t.Font=hn,t.Glyph=yt,t.Path=O,t._parse=st,t.default=Rn,t.load=Bn,t.loadSync=An,t.parse=Vn,Object.defineProperty(t,"__esModule",{value:!0})})),define("opentype",["opentype/dist/opentype"],(function(t){return t})),define("x_ite/Browser/Text/X3DTextContext",["jquery","x_ite/Components/Text/FontStyle","opentype"],(function(t,e,i){"use strict";const n=Symbol(),r=Symbol(),s=Symbol();function o(){this[r]=new Map,this[s]=new Map}return o.prototype={initialize:function(){},getDefaultFontStyle:function(){return this[n]=new e(this.getPrivateScene()),this[n].setup(),this.getDefaultFontStyle=function(){return this[n]},Object.defineProperty(this,"getDefaultFontStyle",{enumerable:!1}),this[n]},getFont:function(e){e=e.toString();let n=this[r].get(e);return void 0===n&&(this[r].set(e,n=t.Deferred()),i.load(e,this.setFont.bind(this,n))),n},setFont:function(t,e,i){e?t.reject(e):t.resolve(i)},getGlyph:function(t,e,i){let n=this[s].get(t);n||this[s].set(t,n=[]);let r=n[e];r||(r=n[e]=[]);let o=r[i];return o||(o=r[i]={}),o}},o})),define("x_ite/Components/Texturing/X3DTextureTransformNode",["x_ite/Components/Shape/X3DAppearanceChildNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Matrix4"],(function(t,e,i){"use strict";function n(n){t.call(this,n),this.addType(e.X3DTextureTransformNode),this.matrixArray=new Float32Array(i.Identity)}return n.prototype=Object.assign(Object.create(t.prototype),{constructor:n,setMatrix:function(t){this.matrixArray.set(t)},setShaderUniformsToChannel:function(t,e,i){t.uniformMatrix4fv(e.x3d_TextureMatrix[i],!1,this.matrixArray)}}),n})),define("x_ite/Components/Texturing/X3DSingleTextureTransformNode",["x_ite/Components/Texturing/X3DTextureTransformNode","x_ite/Base/X3DConstants"],(function(t,e){"use strict";function i(i){t.call(this,i),this.addType(e.X3DSingleTextureTransformNode)}return i.prototype=Object.assign(Object.create(t.prototype),{constructor:i,getTextureMapping:function(t,e=0){this._mapping.getValue()&&t.set(this._mapping.getValue(),e)},setShaderUniforms:function(t,e){for(let i=0,n=e.x3d_MaxTextures;i<n;++i)this.setShaderUniformsToChannel(t,e,i)}}),i})),define("x_ite/Components/Texturing/TextureTransform",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Texturing/X3DSingleTextureTransformNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector2","standard/Math/Numbers/Matrix3","standard/Math/Numbers/Matrix4"],(function(t,e,i,n,r,s,o,a){"use strict";function u(t){n.call(this,t),this.addType(r.TextureTransform),this._rotation.setUnit("angle"),this.matrix=new a}return u.prototype=Object.assign(Object.create(n.prototype),{constructor:u,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"mapping",new t.SFString),new e(r.inputOutput,"translation",new t.SFVec2f),new e(r.inputOutput,"rotation",new t.SFFloat),new e(r.inputOutput,"scale",new t.SFVec2f(1,1)),new e(r.inputOutput,"center",new t.SFVec2f)]),getTypeName:function(){return"TextureTransform"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"textureTransform"},initialize:function(){n.prototype.initialize.call(this),this.addInterest("eventsProcessed",this),this.eventsProcessed()},getMatrix:function(){return this.matrix},eventsProcessed:function(){const t=new s(0,0),e=new o;return function(){const i=this._translation.getValue(),n=this._rotation.getValue(),r=this._scale.getValue(),o=this._center.getValue(),a=this.matrix;e.identity(),o.equals(s.Zero)||e.translate(t.assign(o).negate()),r.equals(s.One)||e.scale(r),0!==n&&e.rotate(n),o.equals(s.Zero)||e.translate(o),i.equals(s.Zero)||e.translate(i),a[0]=e[0],a[1]=e[1],a[4]=e[3],a[5]=e[4],a[12]=e[6],a[13]=e[7],this.setMatrix(a)}}()}),u})),define("x_ite/Browser/Texturing/X3DTexturingContext",["x_ite/Components/Texturing/TextureProperties","x_ite/Components/Texturing/TextureTransform","x_ite/Components/Texturing/TextureCoordinate","x_ite/Browser/Core/TextureQuality"],(function(t,e,i,n){"use strict";const r=Symbol(),s=Symbol(),o=Symbol(),a=Symbol(),u=Symbol(),l=Symbol(),c=Symbol(),h=Symbol(),d=Symbol(),p=Symbol(),f=Symbol(),g=Symbol(),m=Symbol(),_=Symbol(),y=Symbol(),x=Symbol(),w=Symbol(),b=Symbol(),v=Symbol();function S(){const t=this.getContext(),e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this[r]=e>8?2:1,this[s]=e>8,this[o]=e>8}return S.prototype={initialize:function(){const t=this.getContext();t.pixelStorei(t.UNPACK_ALIGNMENT,1),this[a]=t.getParameter(t.MAX_TEXTURE_SIZE),this[u]=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS),this[l]=NaN,this[c]=[...Array(this[u]).keys()],this[h]=[this[c].pop()],this[d]=[this[c].pop()],this[p]=[this[c].pop()];const e=new Uint8Array([255,255,255,255]);this[_]=t.createTexture(),t.activeTexture(t.TEXTURE0+this[h][0]),t.bindTexture(t.TEXTURE_2D,this[_]),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,e),t.getVersion()>=2&&(this[y]=t.createTexture(),t.activeTexture(t.TEXTURE0+this[d][0]),t.bindTexture(t.TEXTURE_3D,this[y]),t.texImage3D(t.TEXTURE_3D,0,t.RGBA,1,1,1,0,t.RGBA,t.UNSIGNED_BYTE,e)),this[x]=t.createTexture(),t.activeTexture(t.TEXTURE0+this[p][0]),t.bindTexture(t.TEXTURE_CUBE_MAP,this[x]),t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_Z,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,e),t.texImage2D(t.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,e),t.texImage2D(t.TEXTURE_CUBE_MAP_NEGATIVE_X,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,e),t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,e),t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_Y,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,e),t.texImage2D(t.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,e),this.resetTextureUnits(),this.setTextureQuality(this.getBrowserOptions().getTextureQuality())},getMaxTextures:function(){return this[r]},getMinTextureSize:function(){return 16},getMaxTextureSize:function(){return this[a]},getMaxCombinedTextureUnits:function(){return this[u]},popTexture2DUnit:function(){return this[f]>0?(--this[f],this[h].pop()):this[c].pop()},pushTexture2DUnit:function(t){void 0!==t&&(++this[f],this[h].push(t))},getTexture2DUnit:function(){if(this[f]>0)return this[h][--this[f]];const t=this[c].pop();return void 0!==t&&this[h].push(t),t},getTexture3DUnit:function(){if(this[g]>0)return this[d][--this[g]];const t=this[c].pop();return void 0!==t&&this[d].push(t),t},getTextureCubeUnit:function(){if(this[m]>0)return this[p][--this[m]];const t=this[c].pop();return void 0!==t&&this[p].push(t),t},getTextureUnit:function(t){switch(t){case 2:return this.getTexture2DUnit();case 3:return this.getTexture3DUnit();case 4:return this.getTextureCubeUnit()}},resetTextureUnits:function(){this[f]=this[h].length,this[g]=this[d].length,this[m]=this[p].length},getDefaultTexture2DUnit:function(){return this[h][0]},getDefaultTexture3DUnit:function(){return this[d][0]},getDefaultTextureCubeUnit:function(){return this[p][0]},getTextureMemory:function(){return this[l]},getMultiTexturing:function(){return this[s]},getProjectiveTextureMapping:function(){return this[o]},getDefaultTextureProperties:function(){return this[w]=new t(this.getPrivateScene()),this[w]._magnificationFilter="NICEST",this[w]._minificationFilter="NEAREST_PIXEL_AVG_MIPMAP",this[w]._textureCompression="NICEST",this[w]._generateMipMaps=!0,this[w].setup(),this.getDefaultTextureProperties=function(){return this[w]},Object.defineProperty(this,"getDefaultTextureProperties",{enumerable:!1}),this[w]},getDefaultTextureTransform:function(){return this[b]=new e(this.getPrivateScene()),this[b].setup(),this.getDefaultTextureTransform=function(){return this[b]},Object.defineProperty(this,"getDefaultTextureTransform",{enumerable:!1}),this[b]},getDefaultTextureCoordinate:function(){return this[v]=new i(this.getPrivateScene()),this[v].setup(),this.getDefaultTextureCoordinate=function(){return this[v]},Object.defineProperty(this,"getDefaultTextureCoordinate",{enumerable:!1}),this[v]},setTextureQuality:function(t){const e=this.getDefaultTextureProperties();switch(t){case n.LOW:e._magnificationFilter="AVG_PIXEL",e._minificationFilter="AVG_PIXEL",e._textureCompression="FASTEST",e._generateMipMaps=!0;break;case n.MEDIUM:e._magnificationFilter="NICEST",e._minificationFilter="NEAREST_PIXEL_AVG_MIPMAP",e._textureCompression="NICEST",e._generateMipMaps=!0;break;case n.HIGH:e._magnificationFilter="NICEST",e._minificationFilter="NICEST",e._textureCompression="NICEST",e._generateMipMaps=!0}}},S})),define("x_ite/Browser/Time/X3DTimeContext",["standard/Math/Numbers/Vector3"],(function(t){"use strict";const e=Symbol(),i=Symbol(),n=Symbol(),r=Symbol();function s(){this[e]=0,this[i]=60,this[n]=new t(0,0,0),this[r]=0}return s.prototype={initialize:function(){this.advanceTime(performance.now())},getCurrentTime:function(){return this[e]},getCurrentFrameRate:function(){return this[i]},getCurrentSpeed:function(){return this[r]},advanceTime:function(){const s=new t(0,0,0);return function(t){const o=(performance.timeOrigin+t)/1e3,a=o-this[e];if(this[e]=o,this[i]=a?1/a:60,this.getWorld()&&this.getActiveLayer()){const t=this.getActiveLayer().getViewpoint().getCameraSpaceMatrix();s.assign(this[n]),this[n].set(t[12],t[13],t[14]),this[r]=s.subtract(this[n]).magnitude()*this[i]}else this[r]=0}}()},s})),define("x_ite/Browser/X3DBrowserContext",["jquery","x_ite/Fields/SFTime","x_ite/Base/X3DBaseNode","x_ite/Browser/Core/X3DCoreContext","x_ite/Routing/X3DRoutingContext","x_ite/Browser/Scripting/X3DScriptingContext","x_ite/Browser/Networking/X3DNetworkingContext","x_ite/Browser/Shaders/X3DShadersContext","x_ite/Browser/Rendering/X3DRenderingContext","x_ite/Browser/Shape/X3DShapeContext","x_ite/Browser/Grouping/X3DGroupingContext","x_ite/Browser/Geometry3D/X3DGeometry3DContext","x_ite/Browser/PointingDeviceSensor/X3DPointingDeviceSensorContext","x_ite/Browser/Navigation/X3DNavigationContext","x_ite/Browser/Layering/X3DLayeringContext","x_ite/Browser/EnvironmentalEffects/X3DEnvironmentalEffectsContext","x_ite/Browser/Lighting/X3DLightingContext","x_ite/Browser/Picking/X3DPickingContext","x_ite/Browser/Sound/X3DSoundContext","x_ite/Browser/Text/X3DTextContext","x_ite/Browser/Texturing/X3DTexturingContext","x_ite/Browser/Time/X3DTimeContext","x_ite/Execution/X3DWorld","x_ite/Rendering/TraverseType"],(function(t,e,i,n,r,s,o,a,u,l,c,h,d,p,f,g,m,_,y,x,w,b,v,S){"use strict";const T=Symbol(),C=Symbol(),O=Symbol(),N=Symbol(),F=Symbol(),E=Symbol(),D=Symbol(),M=Symbol(),I=Symbol(),V=Symbol(),B=[];function A(t){i.call(this,this),r.call(this),n.call(this,t),s.call(this),o.call(this),a.call(this),u.call(this),l.call(this),c.call(this),h.call(this),d.call(this),p.call(this),f.call(this),g.call(this),m.call(this),_.call(this),y.call(this),x.call(this),w.call(this),b.call(this);for(const t of B)t.call(this);this.addChildObjects("initialized",new e,"shutdown",new e,"prepareEvents",new e,"timeEvents",new e,"sensorEvents",new e,"finished",new e),this[C]=0,this[N]=0,this[O]=this.traverse.bind(this),this[F]=0,this[E]=0,this[D]=0,this[M]=0,this[I]=0,this[V]=0}A.prototype=Object.assign(Object.create(i.prototype),r.prototype,n.prototype,s.prototype,o.prototype,a.prototype,u.prototype,l.prototype,c.prototype,h.prototype,d.prototype,p.prototype,f.prototype,g.prototype,m.prototype,_.prototype,y.prototype,x.prototype,w.prototype,b.prototype,{constructor:A,initialize:function(){i.prototype.initialize.call(this),r.prototype.initialize.call(this),n.prototype.initialize.call(this),s.prototype.initialize.call(this),o.prototype.initialize.call(this),a.prototype.initialize.call(this),u.prototype.initialize.call(this),l.prototype.initialize.call(this),c.prototype.initialize.call(this),h.prototype.initialize.call(this),d.prototype.initialize.call(this),p.prototype.initialize.call(this),f.prototype.initialize.call(this),g.prototype.initialize.call(this),m.prototype.initialize.call(this),_.prototype.initialize.call(this),y.prototype.initialize.call(this),x.prototype.initialize.call(this),w.prototype.initialize.call(this),b.prototype.initialize.call(this);for(const t of B)t.prototype.initialize&&t.prototype.initialize.call(this);this.processEvents()},initialized:function(){return this._initialized},shutdown:function(){return this._shutdown},prepareEvents:function(){return this._prepareEvents},timeEvents:function(){return this._timeEvents},sensorEvents:function(){return this._sensorEvents},finished:function(){return this._finished},getBrowser:function(){return this},getWorld:function(){return this[T]},setExecutionContext:function(t){this[T]=new v(t),this[T].setup()},getExecutionContext:function(){return this[T].getExecutionContext()},addBrowserEvent:function(){this[C]!==this.getCurrentTime()&&(this[C]=this.getCurrentTime(),requestAnimationFrame(this[O]))},limitFrameRate:function(t){return t===this[N]?(requestAnimationFrame(this[O]),!0):(this[N]=t,!1)},traverse:function(t){if(this.limitFrameRate(t))return;const e=this.getContext(),i=performance.now();this[F]=i-this[E],this.advanceTime(t),this._prepareEvents.processInterests(),this.processEvents(),this._timeEvents.processInterests(),this.processEvents();const n=performance.now();this[T].traverse(S.CAMERA,null),this[M]=performance.now()-n;const r=performance.now();this.getCollisionCount()&&this[T].traverse(S.COLLISION,null),this[I]=performance.now()-r,this._sensorEvents.processInterests(),this.processEvents();const s=performance.now();e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),this[T].traverse(S.DISPLAY,null),this[V]=performance.now()-s,this[D]=performance.now()-i,this[E]=performance.now(),this._finished.processInterests()},getSystemTime:function(){return this[F]},getBrowserTime:function(){return this[D]},getCameraTime:function(){return this[M]},getCollisionTime:function(){return this[I]},getDisplayTime:function(){return this[V]}});for(const t of Reflect.ownKeys(A.prototype))Object.defineProperty(A.prototype,t,{enumerable:!1});return Object.assign(A,{addContext:function(e){const i=require("x_ite/X3D");B.push(e);for(const t of Object.keys(e.prototype).concat(Object.getOwnPropertySymbols(e.prototype)))A.prototype.hasOwnProperty(t)||Object.defineProperty(A.prototype,t,{value:e.prototype[t],enumerable:!1,writable:!0});t("x3d-canvas, X3DCanvas").each((function(t,n){const r=i.getBrowser(n);e.call(r),e.prototype.initialize&&e.prototype.initialize.call(r),r.processEvents()}))}}),A})),define("x_ite/Components/Core/X3DMetadataObject",["x_ite/Base/X3DConstants"],(function(t){"use strict";function e(e){this.addType(t.X3DMetadataObject)}return e.prototype={constructor:e,initialize:function(){}},e})),define("x_ite/Components/Core/MetadataBoolean",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Components/Core/X3DMetadataObject","x_ite/Base/X3DConstants"],(function(t,e,i,n,r,s){"use strict";function o(t){n.call(this,t),r.call(this,t),this.addType(s.MetadataBoolean)}return o.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:o,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.inputOutput,"name",new t.SFString),new e(s.inputOutput,"reference",new t.SFString),new e(s.inputOutput,"value",new t.MFBool)]),getTypeName:function(){return"MetadataBoolean"},getComponentName:function(){return"Core"},getContainerField:function(){return"metadata"}}),o})),define("x_ite/Components/Core/MetadataDouble",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Components/Core/X3DMetadataObject","x_ite/Base/X3DConstants"],(function(t,e,i,n,r,s){"use strict";function o(t){n.call(this,t),r.call(this,t),this.addType(s.MetadataDouble)}return o.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:o,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.inputOutput,"name",new t.SFString),new e(s.inputOutput,"reference",new t.SFString),new e(s.inputOutput,"value",new t.MFDouble)]),getTypeName:function(){return"MetadataDouble"},getComponentName:function(){return"Core"},getContainerField:function(){return"metadata"}}),o})),define("x_ite/Components/Core/MetadataFloat",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Components/Core/X3DMetadataObject","x_ite/Base/X3DConstants"],(function(t,e,i,n,r,s){"use strict";function o(t){n.call(this,t),r.call(this,t),this.addType(s.MetadataFloat)}return o.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:o,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.inputOutput,"name",new t.SFString),new e(s.inputOutput,"reference",new t.SFString),new e(s.inputOutput,"value",new t.MFFloat)]),getTypeName:function(){return"MetadataFloat"},getComponentName:function(){return"Core"},getContainerField:function(){return"metadata"}}),o})),define("x_ite/Components/Core/MetadataInteger",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Components/Core/X3DMetadataObject","x_ite/Base/X3DConstants"],(function(t,e,i,n,r,s){"use strict";function o(t){n.call(this,t),r.call(this,t),this.addType(s.MetadataInteger)}return o.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:o,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.inputOutput,"name",new t.SFString),new e(s.inputOutput,"reference",new t.SFString),new e(s.inputOutput,"value",new t.MFInt32)]),getTypeName:function(){return"MetadataInteger"},getComponentName:function(){return"Core"},getContainerField:function(){return"metadata"}}),o})),define("x_ite/Components/Core/MetadataSet",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Components/Core/X3DMetadataObject","x_ite/Base/X3DConstants"],(function(t,e,i,n,r,s){"use strict";function o(t){n.call(this,t),r.call(this,t),this.addType(s.MetadataSet)}return o.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:o,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.inputOutput,"name",new t.SFString),new e(s.inputOutput,"reference",new t.SFString),new e(s.inputOutput,"value",new t.MFNode)]),getTypeName:function(){return"MetadataSet"},getComponentName:function(){return"Core"},getContainerField:function(){return"metadata"}}),o})),define("x_ite/Components/Core/MetadataString",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Components/Core/X3DMetadataObject","x_ite/Base/X3DConstants"],(function(t,e,i,n,r,s){"use strict";function o(t){n.call(this,t),r.call(this,t),this.addType(s.MetadataString)}return o.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:o,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.inputOutput,"name",new t.SFString),new e(s.inputOutput,"reference",new t.SFString),new e(s.inputOutput,"value",new t.MFString)]),getTypeName:function(){return"MetadataString"},getComponentName:function(){return"Core"},getContainerField:function(){return"metadata"}}),o})),define("x_ite/Components/Core/X3DInfoNode",["x_ite/Components/Core/X3DChildNode","x_ite/Base/X3DConstants"],(function(t,e){"use strict";function i(i){t.call(this,i),this.addType(e.X3DInfoNode)}return i.prototype=Object.assign(Object.create(t.prototype),{constructor:i}),i})),define("x_ite/Components/Core/WorldInfo",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Core/X3DInfoNode","x_ite/Base/X3DConstants"],(function(t,e,i,n,r){"use strict";function s(t){n.call(this,t),this.addType(r.WorldInfo)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"title",new t.SFString),new e(r.inputOutput,"info",new t.MFString)]),getTypeName:function(){return"WorldInfo"},getComponentName:function(){return"Core"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.getExecutionContext().addWorldInfo(this)},dispose:function(){this.getExecutionContext().removeWorldInfo(this),n.prototype.dispose.call(this)}}),s})),define("x_ite/Components/Core",["x_ite/Configuration/SupportedNodes","x_ite/Components/Core/MetadataBoolean","x_ite/Components/Core/MetadataDouble","x_ite/Components/Core/MetadataFloat","x_ite/Components/Core/MetadataInteger","x_ite/Components/Core/MetadataSet","x_ite/Components/Core/MetadataString","x_ite/Components/Core/WorldInfo","x_ite/Components/Core/X3DBindableNode","x_ite/Components/Core/X3DChildNode","x_ite/Components/Core/X3DInfoNode","x_ite/Components/Core/X3DMetadataObject","x_ite/Components/Core/X3DNode","x_ite/Components/Core/X3DPrototypeInstance","x_ite/Components/Core/X3DSensorNode"],(function(t,e,i,n,r,s,o,a,u,l,c,h,d,p,f){"use strict";const g={MetadataBoolean:e,MetadataDouble:i,MetadataFloat:n,MetadataInteger:r,MetadataSet:s,MetadataString:o,WorldInfo:a},m={X3DBindableNode:u,X3DChildNode:l,X3DInfoNode:c,X3DMetadataObject:h,X3DNode:d,X3DPrototypeInstance:p,X3DSensorNode:f};for(const e in g)t.addType(e,g[e]);for(const e in m)t.addAbstractType(e,m[e])})),define("x_ite/Components/EnvironmentalEffects/FogCoordinate",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometricPropertyNode","x_ite/Base/X3DConstants"],(function(t,e,i,n,r){"use strict";function s(t){n.call(this,t),this.addType(r.FogCoordinate),this._depth.setUnit("length")}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"depth",new t.MFFloat)]),getTypeName:function(){return"FogCoordinate"},getComponentName:function(){return"EnvironmentalEffects"},getContainerField:function(){return"fogCoord"},initialize:function(){n.prototype.initialize.call(this),this._depth.addInterest("set_depth__",this),this.set_depth__()},set_depth__:function(){this.depth=this._depth.getValue(),this.length=this._depth.length},isEmpty:function(){return 0===this.length},getSize:function(){return this.length},addDepth:function(t,e){t<this.length?e.push(this.depth[t]):this.length?e.push(this.depth[this.length-1]):e.push(0)},addDepths:function(t,e){const i=this.length;if(i){const n=this.depth;for(let e=0;e<i;++e)t.push(n[e]);const r=n[i-1];for(let n=i;n<e;++n)t.push(r)}else for(let i=0;i<e;++i)t.push(0)}}),s})),define("x_ite/Components/EnvironmentalEffects/LocalFog",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Core/X3DChildNode","x_ite/Components/EnvironmentalEffects/X3DFogObject","x_ite/Base/X3DConstants"],(function(t,e,i,n,r,s){"use strict";function o(t){n.call(this,t),r.call(this,t),this.addType(s.LocalFog)}return o.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:o,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.inputOutput,"enabled",new t.SFBool(!0)),new e(s.inputOutput,"fogType",new t.SFString("LINEAR")),new e(s.inputOutput,"color",new t.SFColor(1,1,1)),new e(s.inputOutput,"visibilityRange",new t.SFFloat)]),getTypeName:function(){return"LocalFog"},getComponentName:function(){return"EnvironmentalEffects"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),r.prototype.initialize.call(this)},push:function(t){if(this._enabled.getValue()&&this.getFogType()){const e=this.getFogs().pop();e.set(this,t.getModelViewMatrix().get()),t.getLocalFogs().push(e)}},pop:function(t){this._enabled.getValue()&&this.getFogType()&&this.getBrowser().getLocalObjects().push(t.getLocalFogs().pop())}}),o})),define("x_ite/Components/EnvironmentalEffects/TextureBackground",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/EnvironmentalEffects/X3DBackgroundNode","x_ite/Base/X3DCast","x_ite/Base/X3DConstants"],(function(t,e,i,n,r,s){"use strict";function o(t){n.call(this,t),this.addType(s.TextureBackground)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.inputOnly,"set_bind",new t.SFBool),new e(s.inputOutput,"skyAngle",new t.MFFloat),new e(s.inputOutput,"skyColor",new t.MFColor(new t.SFColor)),new e(s.inputOutput,"groundAngle",new t.MFFloat),new e(s.inputOutput,"groundColor",new t.MFColor),new e(s.inputOutput,"transparency",new t.SFFloat),new e(s.outputOnly,"isBound",new t.SFBool),new e(s.outputOnly,"bindTime",new t.SFTime),new e(s.inputOutput,"frontTexture",new t.SFNode),new e(s.inputOutput,"backTexture",new t.SFNode),new e(s.inputOutput,"leftTexture",new t.SFNode),new e(s.inputOutput,"rightTexture",new t.SFNode),new e(s.inputOutput,"topTexture",new t.SFNode),new e(s.inputOutput,"bottomTexture",new t.SFNode)]),getTypeName:function(){return"TextureBackground"},getComponentName:function(){return"EnvironmentalEffects"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this._frontTexture.addInterest("set_frontTexture__",this),this._backTexture.addInterest("set_backTexture__",this),this._leftTexture.addInterest("set_leftTexture__",this),this._rightTexture.addInterest("set_rightTexture__",this),this._topTexture.addInterest("set_topTexture__",this),this._bottomTexture.addInterest("set_bottomTexture__",this),this.set_frontTexture__(this._frontTexture),this.set_backTexture__(this._backTexture),this.set_leftTexture__(this._leftTexture),this.set_rightTexture__(this._rightTexture),this.set_topTexture__(this._topTexture),this.set_bottomTexture__(this._bottomTexture)},set_frontTexture__:function(){n.prototype.set_frontTexture__.call(this,r(s.X3DTextureNode,this._frontTexture))},set_backTexture__:function(){n.prototype.set_backTexture__.call(this,r(s.X3DTextureNode,this._backTexture))},set_leftTexture__:function(){n.prototype.set_leftTexture__.call(this,r(s.X3DTextureNode,this._leftTexture))},set_rightTexture__:function(){n.prototype.set_rightTexture__.call(this,r(s.X3DTextureNode,this._rightTexture))},set_topTexture__:function(){n.prototype.set_topTexture__.call(this,r(s.X3DTextureNode,this._topTexture))},set_bottomTexture__:function(){n.prototype.set_bottomTexture__.call(this,r(s.X3DTextureNode,this._bottomTexture))}}),o})),define("x_ite/Components/EnvironmentalEffects",["x_ite/Configuration/SupportedNodes","x_ite/Components/EnvironmentalEffects/Background","x_ite/Components/EnvironmentalEffects/Fog","x_ite/Components/EnvironmentalEffects/FogCoordinate","x_ite/Components/EnvironmentalEffects/LocalFog","x_ite/Components/EnvironmentalEffects/TextureBackground","x_ite/Components/EnvironmentalEffects/X3DBackgroundNode","x_ite/Components/EnvironmentalEffects/X3DFogObject"],(function(t,e,i,n,r,s,o,a){"use strict";const u={Background:e,Fog:i,FogCoordinate:n,LocalFog:r,TextureBackground:s},l={X3DBackgroundNode:o,X3DFogObject:a};for(const e in u)t.addType(e,u[e]);for(const e in l)t.addAbstractType(e,l[e])})),define("x_ite/Components/EnvironmentalSensor/X3DEnvironmentalSensorNode",["x_ite/Fields","x_ite/Components/Core/X3DSensorNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3"],(function(t,e,i,n){"use strict";function r(n){e.call(this,n),this.addType(i.X3DEnvironmentalSensorNode),this.addChildObjects("traversed",new t.SFBool(!0)),this._size.setUnit("length"),this._center.setUnit("length"),this.zeroTest=!1,this.currentTraversed=!0}return r.prototype=Object.assign(Object.create(e.prototype),{constructor:r,initialize:function(){e.prototype.initialize.call(this),this.isLive().addInterest("set_live__",this),this._enabled.addInterest("set_live__",this),this._size.addInterest("set_live__",this),this._traversed.addInterest("set_live__",this),this.set_live__()},set_live__:function(){!(this._traversed.getValue()&&this.isLive().getValue()&&this._enabled.getValue())||this.zeroTest&&this._size.getValue().equals(n.Zero)?(this.getBrowser().sensorEvents().removeInterest("update",this),this._isActive.getValue()&&(this._isActive=!1,this._exitTime=this.getBrowser().getCurrentTime())):this.getBrowser().sensorEvents().addInterest("update",this)},setZeroTest:function(t){this.zeroTest=t},getZeroTest:function(){return this.zeroTest},setTraversed:function(t){t?!1===this._traversed.getValue()&&(this._traversed=!0):this.currentTraversed!==this._traversed.getValue()&&(this._traversed=this.currentTraversed),this.currentTraversed=t},getTraversed:function(){return this.currentTraversed},update:function(){}}),r})),define("x_ite/Components/EnvironmentalSensor/ProximitySensor",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/EnvironmentalSensor/X3DEnvironmentalSensorNode","x_ite/Rendering/TraverseType","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4"],(function(t,e,i,n,r,s,o,a,u){"use strict";function l(t){n.call(this,t),this.addType(s.ProximitySensor),this.setCameraObject(!0),this._centerOfRotation_changed.setUnit("length"),this._position_changed.setUnit("length"),this.setZeroTest(!0),this.min=new o(0,0,0),this.max=new o(0,0,0),this.viewpointNode=null,this.modelMatrix=new u,this.inside=!1}return l.prototype=Object.assign(Object.create(n.prototype),{constructor:l,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.inputOutput,"enabled",new t.SFBool(!0)),new e(s.inputOutput,"size",new t.SFVec3f),new e(s.inputOutput,"center",new t.SFVec3f),new e(s.outputOnly,"enterTime",new t.SFTime),new e(s.outputOnly,"exitTime",new t.SFTime),new e(s.outputOnly,"isActive",new t.SFBool),new e(s.outputOnly,"position_changed",new t.SFVec3f),new e(s.outputOnly,"orientation_changed",new t.SFRotation),new e(s.outputOnly,"centerOfRotation_changed",new t.SFVec3f)]),getTypeName:function(){return"ProximitySensor"},getComponentName:function(){return"EnvironmentalSensor"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this._enabled.addInterest("set_enabled__",this),this._size.addInterest("set_extents__",this),this._center.addInterest("set_extents__",this),this._traversed.addFieldInterest(this._isCameraObject),this.set_enabled__(),this.set_extents__()},set_enabled__:function(){this.setCameraObject(this._enabled.getValue()),this._enabled.getValue()?delete this.traverse:this.traverse=Function.prototype},set_extents__:function(){const t=this._size.getValue(),e=this._center.getValue(),i=t.x/2,n=t.y/2,r=t.z/2,s=e.x,o=e.y,a=e.z;this.min.set(s-i,o-n,a-r),this.max.set(s+i,o+n,a+r)},update:function(){const t=new u,e=new u,i=new o(0,0,0),n=new a(0,0,1,0),r=new o(0,0,0);return function(){if(this.inside&&this.getTraversed()){if(this.viewpointNode){const s=this.modelMatrix;e.assign(this.viewpointNode.getModelMatrix()),e.translate(this.viewpointNode.getUserCenterOfRotation()),e.multRight(t.assign(s).inverse()),s.multRight(this.viewpointNode.getViewMatrix()),s.get(null,n),s.inverse(),i.set(s[12],s[13],s[14]),n.inverse(),r.set(e[12],e[13],e[14]),this._isActive.getValue()?(this._position_changed.getValue().equals(i)||(this._position_changed=i),this._orientation_changed.getValue().equals(n)||(this._orientation_changed=n),this._centerOfRotation_changed.getValue().equals(r)||(this._centerOfRotation_changed=r)):(this._isActive=!0,this._enterTime=this.getBrowser().getCurrentTime(),this._position_changed=i,this._orientation_changed=n,this._centerOfRotation_changed=r)}}else this._isActive.getValue()&&(this._isActive=!1,this._exitTime=this.getBrowser().getCurrentTime());this.inside=!1,this.viewpointNode=null,this.setTraversed(!1)}}(),traverse:function(){const t=new u,e=new o(-1,-1,-1);return function(i,n){switch(i){case r.CAMERA:return this.viewpointNode=n.getViewpoint(),void this.modelMatrix.assign(n.getModelViewMatrix().get());case r.DISPLAY:if(this.setTraversed(!0),this.inside)return;return void(this._size.getValue().equals(e)?this.inside=!0:(t.assign(n.getModelViewMatrix().get()).inverse(),this.inside=this.containsPoint(t.origin)))}}}(),containsPoint:function(t){const e=this.min,i=this.max;return e.x<=t.x&&i.x>=t.x&&e.y<=t.y&&i.y>=t.y&&e.z<=t.z&&i.z>=t.z}}),l})),define("x_ite/Components/EnvironmentalSensor/TransformSensor",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/EnvironmentalSensor/X3DEnvironmentalSensorNode","x_ite/Rendering/TraverseType","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Utility/ObjectCache"],(function(t,e,i,n,r,s,o,a,u,l){"use strict";const c=l(u),h=l(u);function d(t){n.call(this,t),this.addType(s.TransformSensor),this._position_changed.setUnit("length"),this.setZeroTest(!0),this.min=new o,this.max=new o,this.targetObjectNode=null,this.modelMatrices=[],this.targetMatrices=[]}return d.prototype=Object.assign(Object.create(n.prototype),{constructor:d,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.inputOutput,"enabled",new t.SFBool(!0)),new e(s.inputOutput,"size",new t.SFVec3f),new e(s.inputOutput,"center",new t.SFVec3f),new e(s.outputOnly,"enterTime",new t.SFTime),new e(s.outputOnly,"exitTime",new t.SFTime),new e(s.outputOnly,"isActive",new t.SFBool),new e(s.outputOnly,"position_changed",new t.SFVec3f),new e(s.outputOnly,"orientation_changed",new t.SFRotation),new e(s.inputOutput,"targetObject",new t.SFNode)]),getTypeName:function(){return"TransformSensor"},getComponentName:function(){return"EnvironmentalSensor"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.isLive().addInterest("set_enabled__",this),this._enabled.addInterest("set_enabled__",this),this._size.addInterest("set_enabled__",this),this._size.addInterest("set_extents__",this),this._center.addInterest("set_extents__",this),this._targetObject.addInterest("set_targetObject__",this),this.set_extents__(),this.set_targetObject__()},set_live__:function(){},set_enabled__:function(){this.isLive().getValue()&&this.targetObjectNode&&this._enabled.getValue()&&!this._size.getValue().equals(o.Zero)?(this.setPickableObject(!0),this.getBrowser().addTransformSensor(this),this.targetObjectNode.addTransformSensor(this)):(this.setPickableObject(!1),this.getBrowser().removeTransformSensor(this),this.targetObjectNode&&this.targetObjectNode.removeTransformSensor(this),this._isActive.getValue()&&(this._isActive=!1,this._exitTime=this.getBrowser().getCurrentTime()))},set_extents__:function(){const t=this._size.getValue(),e=this._center.getValue(),i=t.x/2,n=t.y/2,r=t.z/2,s=e.x,o=e.y,a=e.z;this.min.set(s-i,o-n,a-r),this.max.set(s+i,o+n,a+r)},set_targetObject__:function(){this.targetObjectNode=null;try{const t=this._targetObject.getValue().getInnerNode(),e=t.getType();for(let i=e.length-1;i>=0;--i){switch(e[i]){case s.X3DGroupingNode:case s.X3DShapeNode:this.targetObjectNode=t;break;default:continue}break}}catch(t){}this.set_enabled__()},traverse:function(t,e){t===r.PICKING&&this.getPickableObject()&&this.modelMatrices.push(c.pop().assign(e.getModelViewMatrix().get()))},collect:function(t){this.targetMatrices.push(h.pop().assign(t))},process:function(){const t=new o(0,0,0),e=new a(0,0,1,0);return function(){const i=this.modelMatrices,n=this.targetMatrices,r=this.intersects();r?(r.get(t,e),this._isActive.getValue()?(this._position_changed.getValue().equals(t)||(this._position_changed=t),this._orientation_changed.getValue().equals(e)||(this._orientation_changed=e)):(this._isActive=!0,this._enterTime=this.getBrowser().getCurrentTime(),this._position_changed=t,this._orientation_changed=e)):this._isActive.getValue()&&(this._isActive=!1,this._exitTime=this.getBrowser().getCurrentTime());for(const t of i)c.push(t);for(const t of n)h.push(t);i.length=0,n.length=0}}(),intersects:function(){const t=new o(-1,-1,-1);return function(){const e=this.modelMatrices,i=this.targetMatrices,n=this._size.getValue().equals(t);for(const t of e){const e=t.inverse();for(const t of i){const i=t.multRight(e);if(n||this.containsPoint(i.origin))return i}}return null}}(),containsPoint:function(t){const e=this.min,i=this.max;return e.x<=t.x&&i.x>=t.x&&e.y<=t.y&&i.y>=t.y&&e.z<=t.z&&i.z>=t.z}}),d})),define("x_ite/Components/EnvironmentalSensor/VisibilitySensor",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/EnvironmentalSensor/X3DEnvironmentalSensorNode","x_ite/Rendering/TraverseType","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Geometry/Box3"],(function(t,e,i,n,r,s,o,a){"use strict";function u(t){n.call(this,t),this.addType(s.VisibilitySensor),this.setZeroTest(!1),this.visible=!1}return u.prototype=Object.assign(Object.create(n.prototype),{constructor:u,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.inputOutput,"enabled",new t.SFBool(!0)),new e(s.inputOutput,"size",new t.SFVec3f),new e(s.inputOutput,"center",new t.SFVec3f),new e(s.outputOnly,"enterTime",new t.SFTime),new e(s.outputOnly,"exitTime",new t.SFTime),new e(s.outputOnly,"isActive",new t.SFBool)]),getTypeName:function(){return"VisibilitySensor"},getComponentName:function(){return"EnvironmentalSensor"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this._enabled.addInterest("set_enabled__",this),this.set_enabled__()},set_enabled__:function(){this._enabled.getValue()?delete this.traverse:this.traverse=Function.prototype},update:function(){this.visible&&this.getTraversed()?(this._isActive.getValue()||(this._isActive=!0,this._enterTime=this.getBrowser().getCurrentTime()),this.visible=!1):this._isActive.getValue()&&(this._isActive=!1,this._exitTime=this.getBrowser().getCurrentTime()),this.setTraversed(!1)},traverse:function(){const t=new a,e=new o(-1,-1,-1);return function(i,n){i===r.DISPLAY&&(this.setTraversed(!0),this.visible||(this._size.getValue().equals(e)?this.visible=!0:(t.set(this._size.getValue(),this._center.getValue()).multRight(n.getModelViewMatrix().get()),this.visible=n.getViewVolume().intersectsBox(t))))}}()}),u})),define("x_ite/Components/EnvironmentalSensor",["x_ite/Configuration/SupportedNodes","x_ite/Components/EnvironmentalSensor/ProximitySensor","x_ite/Components/EnvironmentalSensor/TransformSensor","x_ite/Components/EnvironmentalSensor/VisibilitySensor","x_ite/Components/EnvironmentalSensor/X3DEnvironmentalSensorNode"],(function(t,e,i,n,r){"use strict";const s={ProximitySensor:e,TransformSensor:i,VisibilitySensor:n},o={X3DEnvironmentalSensorNode:r};for(const e in s)t.addType(e,s[e]);for(const e in o)t.addAbstractType(e,o[e])})),define("x_ite/Components/Followers/ColorChaser",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Followers/X3DChaserNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Color3","standard/Math/Numbers/Vector3"],(function(t,e,i,n,r,s,o){"use strict";var a=new o(0,0,0),u=new o(0,0,0),l=new o(0,0,0),c=new o(0,0,0);function h(t){n.call(this,t),this.addType(r.ColorChaser)}return h.prototype=Object.assign(Object.create(n.prototype),{constructor:h,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOnly,"set_value",new t.SFColor),new e(r.inputOnly,"set_destination",new t.SFColor),new e(r.initializeOnly,"initialValue",new t.SFColor(.8,.8,.8)),new e(r.initializeOnly,"initialDestination",new t.SFColor(.8,.8,.8)),new e(r.initializeOnly,"duration",new t.SFTime(1)),new e(r.outputOnly,"isActive",new t.SFBool),new e(r.outputOnly,"value_changed",new t.SFColor)]),getTypeName:function(){return"ColorChaser"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new o(0,0,0)},getValue:function(){return this._set_value.getValue().getHSV(c)},getDestination:function(){return this._set_destination.getValue().getHSV(c)},getInitialValue:function(){return this._initialValue.getValue().getHSV(a)},getInitialDestination:function(){return this._initialDestination.getValue().getHSV(u)},setValue:function(t){this._value_changed.setHSV(t.x,t.y,t.z)},interpolate:function(t,e,i){return s.lerp(t,e,i,c)},step:function(t,e,i){l.assign(this.output).add(t).subtract(e),s.lerp(this.output,l,i,this.output)}}),h})),define("x_ite/Components/Followers/X3DDamperNode",["x_ite/Components/Followers/X3DFollowerNode","x_ite/Base/X3DConstants","standard/Math/Algorithm"],(function(t,e,i){"use strict";function n(i){t.call(this,i),this.addType(e.X3DDamperNode)}return n.prototype=Object.assign(Object.create(t.prototype),{constructor:n,initialize:function(){t.prototype.initialize.call(this),this._order.addInterest("set_order__",this),this._set_value.addInterest("set_value__",this),this._set_destination.addInterest("set_destination__",this);var e=this.getBuffer(),i=this.getInitialValue(),n=this.getInitialDestination();e[0]=this.duplicate(n);for(var r=1,s=this.getOrder()+1;r<s;++r)e[r]=this.duplicate(i);this.equals(n,i,this.getTolerance())?this.setValue(n):this.set_active(!0)},getOrder:function(){return i.clamp(this._order.getValue(),0,5)},getTolerance:function(){return this._tolerance.getValue()<0?1e-4:this._tolerance.getValue()},prepareEvents:function(){var t=this.getBuffer(),e=t.length-1;if(this._tau.getValue()){for(var i=1/this.getBrowser().currentFrameRate,n=Math.exp(-i/this._tau.getValue()),r=0;r<e;++r)this.assign(t,r+1,this.interpolate(t[r],t[r+1],n));if(this.setValue(t[e]),!this.equals(t[e],t[0],this.getTolerance()))return}else this.setValue(t[0]),e=0;r=1;for(var s=t.length;r<s;++r)this.assign(t,r,t[e]);this.set_active(!1)},set_value__:function(){for(var t=this.getBuffer(),e=this.getValue(),i=1,n=t.length;i<n;++i)this.assign(t,i,e);this.setValue(e),this.set_active(!0)},set_destination__:function(){this.assign(this.getBuffer(),0,this.getDestination()),this.set_active(!0)},set_order__:function(){for(var t=this.getBuffer(),e=t[t.length-1],i=t.length,n=this.getOrder()+1;i<n;++i)t[i]=this.duplicate(e);t.length=n}}),n})),define("x_ite/Components/Followers/ColorDamper",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Followers/X3DDamperNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Color3","standard/Math/Numbers/Vector3"],(function(t,e,i,n,r,s,o){"use strict";var a=new o(0,0,0),u=new o(0,0,0),l=new o(0,0,0),c=new o(0,0,0);function h(t){n.call(this,t),this.addType(r.ColorDamper)}return h.prototype=Object.assign(Object.create(n.prototype),{constructor:h,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOnly,"set_value",new t.SFColor),new e(r.inputOnly,"set_destination",new t.SFColor),new e(r.initializeOnly,"initialValue",new t.SFColor(.8,.8,.8)),new e(r.initializeOnly,"initialDestination",new t.SFColor(.8,.8,.8)),new e(r.initializeOnly,"order",new t.SFInt32(3)),new e(r.inputOutput,"tau",new t.SFTime(.3)),new e(r.inputOutput,"tolerance",new t.SFFloat(-1)),new e(r.outputOnly,"isActive",new t.SFBool),new e(r.outputOnly,"value_changed",new t.SFColor)]),getTypeName:function(){return"ColorDamper"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new o(0,0,0)},getValue:function(){return this._set_value.getValue().getHSV(c)},getDestination:function(){return this._set_destination.getValue().getHSV(c)},getInitialValue:function(){return this._initialValue.getValue().getHSV(u)},getInitialDestination:function(){return this._initialDestination.getValue().getHSV(l)},setValue:function(t){this._value_changed.setHSV(t.x,t.y,t.z)},equals:function(t,e,i){return a.assign(t).subtract(e).magnitude()<i},interpolate:function(t,e,i){return s.lerp(t,e,i,c)}}),h})),define("x_ite/Browser/Followers/X3DArrayFollowerTemplate",[],(function(){"use strict";return function(t){function e(){this.array=this.getArray(),this.zero=this.getVector()}return e.prototype={getArray:function(){const t=[];return t.assign=function(t){if(Array.isArray(t)){for(var e=0,i=Math.min(this.length,t.length);e<i;++e)this[e].assign(t[e]);for(e=i,i=t.length;e<i;++e)this[e]=t[e].copy();this.length=i}else{for(e=0,i=Math.min(this.length,t.length);e<i;++e)this[e].assign(t[e].getValue());for(e=i,i=t.length;e<i;++e)this[e]=t[e].getValue().copy();this.length=i}},t},getValue:function(){return this._set_value},getDestination:function(){return this._set_destination},getInitialValue:function(){return this._initialValue},getInitialDestination:function(){return this._initialDestination},setValue:function(t){if(Array.isArray(t)){const n=this._value_changed;for(var e=0,i=t.length;e<i;++e)n[e]=t[e];n.length=i}else this._value_changed=t},duplicate:function(t){const e=this.getArray();return e.assign(t),e},equals:function(t,e,i){if(t.length!==e.length)return!1;const n=this.a;let r=0;for(let i=0,s=t.length;i<s;++i)r=Math.max(n.assign(t[i]).subtract(e[i]).magnitude());return r<i},interpolate:function(t,e,i){const n=this.array;n.assign(t);for(let t=0,r=n.length;t<r;++t)n[t].lerp(e[t]||this.zero,i);return n},set_destination__:function(){const e=this.getBuffer(),i=this._set_destination.length;for(let t=0,n=e.length;t<n;++t){const n=e[t];for(let t=n.length;t<i;++t)n[t]=this.getVector();n.length=i}t.prototype.set_destination__.call(this)}},e}})),define("x_ite/Browser/Followers/X3DArrayChaserTemplate",["x_ite/Browser/Followers/X3DArrayFollowerTemplate"],(function(t){"use strict";return function(e){const i=t(e);function n(){i.call(this),this.array=this.getArray()}return Object.assign(n.prototype,i.prototype,{step:function(t,e,i){const n=this.output,r=this.deltaOut;for(let s=0,o=n.length;s<o;++s)n[s].add(r.assign(t[s]||this.zero).subtract(e[s]||this.zero).multiply(i))}}),n}})),define("x_ite/Components/Followers/CoordinateChaser",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Followers/X3DChaserNode","x_ite/Browser/Followers/X3DArrayChaserTemplate","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3"],(function(t,e,i,n,r,s,o){"use strict";var a=r(n);function u(t){n.call(this,t),a.call(this,t),this.addType(s.CoordinateChaser)}return u.prototype=Object.assign(Object.create(n.prototype),a.prototype,{constructor:u,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.inputOnly,"set_value",new t.MFVec3f),new e(s.inputOnly,"set_destination",new t.MFVec3f),new e(s.initializeOnly,"initialValue",new t.MFVec3f(new o(0,0,0))),new e(s.initializeOnly,"initialDestination",new t.MFVec3f(new o(0,0,0))),new e(s.initializeOnly,"duration",new t.SFTime(1)),new e(s.outputOnly,"isActive",new t.SFBool),new e(s.outputOnly,"value_changed",new t.MFVec3f)]),getTypeName:function(){return"CoordinateChaser"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new o(0,0,0)}}),u})),define("x_ite/Components/Followers/CoordinateDamper",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Followers/X3DDamperNode","x_ite/Browser/Followers/X3DArrayFollowerTemplate","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3"],(function(t,e,i,n,r,s,o){"use strict";var a=r(n);function u(t){n.call(this,t),a.call(this,t),this.addType(s.CoordinateDamper)}return u.prototype=Object.assign(Object.create(n.prototype),a.prototype,{constructor:u,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.inputOnly,"set_value",new t.MFVec3f),new e(s.inputOnly,"set_destination",new t.MFVec3f),new e(s.initializeOnly,"initialValue",new t.MFVec3f(new o(0,0,0))),new e(s.initializeOnly,"initialDestination",new t.MFVec3f(new o(0,0,0))),new e(s.initializeOnly,"order",new t.SFInt32(3)),new e(s.inputOutput,"tau",new t.SFTime(.3)),new e(s.inputOutput,"tolerance",new t.SFFloat(-1)),new e(s.outputOnly,"isActive",new t.SFBool),new e(s.outputOnly,"value_changed",new t.MFVec3f)]),getTypeName:function(){return"CoordinateDamper"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new o(0,0,0)}}),u})),define("x_ite/Components/Followers/OrientationDamper",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Followers/X3DDamperNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Rotation4"],(function(t,e,i,n,r,s){"use strict";var o=new s(0,0,1,0),a=new s(0,0,1,0);function u(t){n.call(this,t),this.addType(r.OrientationDamper),this._set_value.setUnit("angle"),this._set_destination.setUnit("angle"),this._initialValue.setUnit("angle"),this._initialDestination.setUnit("angle"),this._value_changed.setUnit("angle")}return u.prototype=Object.assign(Object.create(n.prototype),{constructor:u,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOnly,"set_value",new t.SFRotation),new e(r.inputOnly,"set_destination",new t.SFRotation),new e(r.initializeOnly,"initialValue",new t.SFRotation),new e(r.initializeOnly,"initialDestination",new t.SFRotation),new e(r.initializeOnly,"order",new t.SFInt32(3)),new e(r.inputOutput,"tau",new t.SFTime(.3)),new e(r.inputOutput,"tolerance",new t.SFFloat(-1)),new e(r.outputOnly,"isActive",new t.SFBool),new e(r.outputOnly,"value_changed",new t.SFRotation)]),getTypeName:function(){return"OrientationDamper"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new s(0,0,1,0)},equals:function(t,e,i){return o.assign(t).inverse().multRight(e),Math.abs(o.angle)<i},interpolate:function(t,e,i){return a.assign(t).slerp(e,i)}}),u})),define("x_ite/Components/Followers/PositionChaser2D",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Followers/X3DChaserNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector2"],(function(t,e,i,n,r,s){"use strict";function o(t){n.call(this,t),this.addType(r.PositionChaser2D)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOnly,"set_value",new t.SFVec2f),new e(r.inputOnly,"set_destination",new t.SFVec2f),new e(r.initializeOnly,"initialValue",new t.SFVec2f),new e(r.initializeOnly,"initialDestination",new t.SFVec2f),new e(r.initializeOnly,"duration",new t.SFTime(1)),new e(r.outputOnly,"isActive",new t.SFBool),new e(r.outputOnly,"value_changed",new t.SFVec2f)]),getTypeName:function(){return"PositionChaser2D"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new s(0,0)}}),o})),define("x_ite/Components/Followers/PositionDamper",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Followers/X3DDamperNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3"],(function(t,e,i,n,r,s){"use strict";function o(t){n.call(this,t),this.addType(r.PositionDamper)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOnly,"set_value",new t.SFVec3f),new e(r.inputOnly,"set_destination",new t.SFVec3f),new e(r.initializeOnly,"initialValue",new t.SFVec3f),new e(r.initializeOnly,"initialDestination",new t.SFVec3f),new e(r.initializeOnly,"order",new t.SFInt32(3)),new e(r.inputOutput,"tolerance",new t.SFFloat(-1)),new e(r.inputOutput,"tau",new t.SFTime(.3)),new e(r.outputOnly,"value_changed",new t.SFVec3f),new e(r.outputOnly,"isActive",new t.SFBool)]),getTypeName:function(){return"PositionDamper"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new s(0,0,0)}}),o})),define("x_ite/Components/Followers/PositionDamper2D",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Followers/X3DDamperNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector2"],(function(t,e,i,n,r,s){"use strict";function o(t){n.call(this,t),this.addType(r.PositionDamper2D)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOnly,"set_value",new t.SFVec2f),new e(r.inputOnly,"set_destination",new t.SFVec2f),new e(r.initializeOnly,"initialValue",new t.SFVec2f),new e(r.initializeOnly,"initialDestination",new t.SFVec2f),new e(r.initializeOnly,"order",new t.SFInt32(3)),new e(r.inputOutput,"tau",new t.SFTime(.3)),new e(r.inputOutput,"tolerance",new t.SFFloat(-1)),new e(r.outputOnly,"isActive",new t.SFBool),new e(r.outputOnly,"value_changed",new t.SFVec2f)]),getTypeName:function(){return"PositionDamper2D"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new s(0,0)}}),o})),define("x_ite/Components/Followers/ScalarChaser",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Followers/X3DChaserNode","x_ite/Base/X3DConstants","standard/Math/Algorithm"],(function(t,e,i,n,r,s){"use strict";function o(t){n.call(this,t),this.addType(r.ScalarChaser)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOnly,"set_value",new t.SFFloat),new e(r.inputOnly,"set_destination",new t.SFFloat),new e(r.initializeOnly,"initialValue",new t.SFFloat),new e(r.initializeOnly,"initialDestination",new t.SFFloat),new e(r.initializeOnly,"duration",new t.SFTime(1)),new e(r.outputOnly,"isActive",new t.SFBool),new e(r.outputOnly,"value_changed",new t.SFFloat)]),getTypeName:function(){return"ScalarChaser"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return 0},setPreviousValue:function(t){this.previousValue=t},setDestination:function(t){this.destination=t},duplicate:function(t){return t},assign:function(t,e,i){t[e]=i},equals:function(t,e,i){return Math.abs(t-e)<i},interpolate:function(t,e,i){return s.lerp(t,e,i)},step:function(t,e,i){this.output+=(t-e)*i}}),o})),define("x_ite/Components/Followers/ScalarDamper",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Followers/X3DDamperNode","x_ite/Base/X3DConstants","standard/Math/Algorithm"],(function(t,e,i,n,r,s){"use strict";function o(t){n.call(this,t),this.addType(r.ScalarDamper)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOnly,"set_value",new t.SFFloat),new e(r.inputOnly,"set_destination",new t.SFFloat),new e(r.initializeOnly,"initialValue",new t.SFFloat),new e(r.initializeOnly,"initialDestination",new t.SFFloat),new e(r.initializeOnly,"order",new t.SFInt32(3)),new e(r.inputOutput,"tau",new t.SFTime(.3)),new e(r.inputOutput,"tolerance",new t.SFFloat(-1)),new e(r.outputOnly,"isActive",new t.SFBool),new e(r.outputOnly,"value_changed",new t.SFFloat)]),getTypeName:function(){return"ScalarDamper"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return 0},duplicate:function(t){return t},assign:function(t,e,i){t[e]=i},equals:function(t,e,i){return Math.abs(t-e)<i},interpolate:function(t,e,i){return s.lerp(t,e,i)}}),o})),define("x_ite/Components/Followers/TexCoordChaser2D",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Followers/X3DChaserNode","x_ite/Browser/Followers/X3DArrayChaserTemplate","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector2"],(function(t,e,i,n,r,s,o){"use strict";var a=r(n);function u(t){n.call(this,t),a.call(this,t),this.addType(s.TexCoordChaser2D)}return u.prototype=Object.assign(Object.create(n.prototype),a.prototype,{constructor:u,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.inputOnly,"set_value",new t.MFVec2f),new e(s.inputOnly,"set_destination",new t.MFVec2f),new e(s.initializeOnly,"initialValue",new t.MFVec2f),new e(s.initializeOnly,"initialDestination",new t.MFVec2f),new e(s.initializeOnly,"duration",new t.SFTime(1)),new e(s.outputOnly,"isActive",new t.SFBool),new e(s.outputOnly,"value_changed",new t.MFVec2f)]),getTypeName:function(){return"TexCoordChaser2D"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new o(0,0)}}),u})),define("x_ite/Components/Followers/TexCoordDamper2D",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Followers/X3DDamperNode","x_ite/Browser/Followers/X3DArrayFollowerTemplate","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector2"],(function(t,e,i,n,r,s,o){"use strict";var a=r(n);function u(t){n.call(this,t),a.call(this,t),this.addType(s.TexCoordDamper2D)}return u.prototype=Object.assign(Object.create(n.prototype),a.prototype,{constructor:u,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.inputOnly,"set_value",new t.MFVec2f),new e(s.inputOnly,"set_destination",new t.MFVec2f),new e(s.initializeOnly,"initialValue",new t.MFVec2f),new e(s.initializeOnly,"initialDestination",new t.MFVec2f),new e(s.initializeOnly,"order",new t.SFInt32(3)),new e(s.inputOutput,"tau",new t.SFTime(.3)),new e(s.inputOutput,"tolerance",new t.SFFloat(-1)),new e(s.outputOnly,"isActive",new t.SFBool),new e(s.outputOnly,"value_changed",new t.MFVec2f)]),getTypeName:function(){return"TexCoordDamper2D"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new o(0,0,0)}}),u})),define("x_ite/Components/Followers",["x_ite/Configuration/SupportedNodes","x_ite/Components/Followers/ColorChaser","x_ite/Components/Followers/ColorDamper","x_ite/Components/Followers/CoordinateChaser","x_ite/Components/Followers/CoordinateDamper","x_ite/Components/Followers/OrientationChaser","x_ite/Components/Followers/OrientationDamper","x_ite/Components/Followers/PositionChaser","x_ite/Components/Followers/PositionChaser2D","x_ite/Components/Followers/PositionDamper","x_ite/Components/Followers/PositionDamper2D","x_ite/Components/Followers/ScalarChaser","x_ite/Components/Followers/ScalarDamper","x_ite/Components/Followers/TexCoordChaser2D","x_ite/Components/Followers/TexCoordDamper2D","x_ite/Components/Followers/X3DChaserNode","x_ite/Components/Followers/X3DDamperNode","x_ite/Components/Followers/X3DFollowerNode"],(function(t,e,i,n,r,s,o,a,u,l,c,h,d,p,f,g,m,_){"use strict";const y={ColorChaser:e,ColorDamper:i,CoordinateChaser:n,CoordinateDamper:r,OrientationChaser:s,OrientationDamper:o,PositionChaser:a,PositionChaser2D:u,PositionDamper:l,PositionDamper2D:c,ScalarChaser:h,ScalarDamper:d,TexCoordChaser2D:p,TexCoordDamper2D:f},x={X3DChaserNode:g,X3DDamperNode:m,X3DFollowerNode:_};for(const e in y)t.addType(e,y[e]);for(const e in x)t.addAbstractType(e,x[e])})),define("x_ite/Components/Geometry3D/Box",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3"],(function(t,e,i,n,r,s){"use strict";function o(t){n.call(this,t),this.addType(r.Box),this._size.setUnit("length")}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.initializeOnly,"size",new t.SFVec3f(2,2,2)),new e(r.initializeOnly,"solid",new t.SFBool(!0))]),getTypeName:function(){return"Box"},getComponentName:function(){return"Geometry3D"},getContainerField:function(){return"geometry"},build:function(){const t=new s(2,2,2);return function(){const e=this.getBrowser().getBoxOptions().getGeometry(),i=this._size.getValue();if(this.setMultiTexCoords(e.getMultiTexCoords()),this.setNormals(e.getNormals()),i.equals(t))this.setVertices(e.getVertices()),this.getMin().assign(e.getMin()),this.getMax().assign(e.getMax());else{const t=s.divide(i,2),n=e.getVertices().getValue(),r=this.getVertices();let o=t.x,a=t.y,u=t.z;for(let t=0,e=n.length;t<e;t+=4)r.push(o*n[t],a*n[t+1],u*n[t+2],1);o=Math.abs(o),a=Math.abs(a),u=Math.abs(u),this.getMin().set(-o,-a,-u),this.getMax().set(o,a,u)}this.setSolid(this._solid.getValue())}}()}),o})),define("x_ite/Components/Geometry3D/Cone",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Complex","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3"],(function(t,e,i,n,r,s,o,a){"use strict";function u(t){n.call(this,t),this.addType(r.Cone),this._height.setUnit("length"),this._bottomRadius.setUnit("length")}return u.prototype=Object.assign(Object.create(n.prototype),{constructor:u,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.initializeOnly,"side",new t.SFBool(!0)),new e(r.initializeOnly,"bottom",new t.SFBool(!0)),new e(r.initializeOnly,"height",new t.SFFloat(2)),new e(r.initializeOnly,"bottomRadius",new t.SFFloat(1)),new e(r.initializeOnly,"solid",new t.SFBool(!0))]),getTypeName:function(){return"Cone"},getComponentName:function(){return"Geometry3D"},getContainerField:function(){return"geometry"},set_live__:function(){n.prototype.set_live__.call(this),this.isLive().getValue()?this.getBrowser().getConeOptions().addInterest("requestRebuild",this):this.getBrowser().getConeOptions().removeInterest("requestRebuild",this)},build:function(){const t=this.getBrowser().getConeOptions()._xDimension.getValue(),e=this._height.getValue(),i=this._bottomRadius.getValue(),n=this.getTexCoords(),r=this.getNormals(),u=this.getVertices();this.getMultiTexCoords().push(n);const l=e/2,c=-l,h=s.Polar(1,-Math.PI/2+Math.atan(i/e));if(this._side.getValue())for(let e=0;e<t;++e){const o=(e+.5)/t,a=2*Math.PI*o,d=s.Polar(h.imag,a),p=e/t,f=2*Math.PI*p,g=s.Polar(-i,f),m=s.Polar(h.imag,f),_=(e+1)/t,y=2*Math.PI*_,x=s.Polar(-i,y),w=s.Polar(h.imag,y);n.push(o,1,0,1),r.push(d.imag,h.real,d.real),u.push(0,l,0,1),n.push(p,0,0,1),r.push(m.imag,h.real,m.real),u.push(g.imag,c,g.real,1),n.push(_,0,0,1),r.push(w.imag,h.real,w.real),u.push(x.imag,c,x.real,1)}if(this._bottom.getValue()){const e=[],l=[];for(let n=t-1;n>-1;--n){const r=n/t,u=2*Math.PI*r,h=s.Polar(-1,u),d=s.multiply(h,i);e.push(new o((h.imag+1)/2,(h.real+1)/2)),l.push(new a(d.imag,c,d.real))}const h=e[0],d=l[0];for(let t=1,i=l.length-1;t<i;++t){const i=e[t],s=e[t+1],o=l[t],a=l[t+1];n.push(h.x,h.y,0,1),r.push(0,-1,0),u.push(d.x,d.y,d.z,1),n.push(i.x,i.y,0,1),r.push(0,-1,0),u.push(o.x,o.y,o.z,1),n.push(s.x,s.y,0,1),r.push(0,-1,0),u.push(a.x,a.y,a.z,1)}}this.setSolid(this._solid.getValue()),this.setExtents()},setExtents:function(){const t=this._bottomRadius.getValue(),e=this._height.getValue()/2,i=-e;this._side.getValue()||this._bottom.getValue()?this._side.getValue()?(this.getMin().set(-t,i,-t),this.getMax().set(t,e,t)):(this.getMin().set(-t,i,-t),this.getMax().set(t,i,t)):(this.getMin().set(0,0,0),this.getMax().set(0,0,0))}}),u})),define("x_ite/Components/Geometry3D/Cylinder",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Complex","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3"],(function(t,e,i,n,r,s,o,a){"use strict";function u(t){n.call(this,t),this.addType(r.Cylinder),this._height.setUnit("length"),this._radius.setUnit("length")}return u.prototype=Object.assign(Object.create(n.prototype),{constructor:u,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.initializeOnly,"top",new t.SFBool(!0)),new e(r.initializeOnly,"side",new t.SFBool(!0)),new e(r.initializeOnly,"bottom",new t.SFBool(!0)),new e(r.initializeOnly,"height",new t.SFFloat(2)),new e(r.initializeOnly,"radius",new t.SFFloat(1)),new e(r.initializeOnly,"solid",new t.SFBool(!0))]),getTypeName:function(){return"Cylinder"},getComponentName:function(){return"Geometry3D"},getContainerField:function(){return"geometry"},set_live__:function(){n.prototype.set_live__.call(this),this.isLive().getValue()?this.getBrowser().getCylinderOptions().addInterest("requestRebuild",this):this.getBrowser().getCylinderOptions().removeInterest("requestRebuild",this)},build:function(){const t=this.getBrowser().getCylinderOptions()._xDimension.getValue(),e=this.getTexCoords(),i=this.getNormals(),n=this.getVertices();this.getMultiTexCoords().push(e);const r=this._radius.getValue(),u=this._height.getValue()/2,l=-u;if(this._side.getValue())for(let o=0;o<t;++o){const a=o/t,c=2*Math.PI*a,h=s.Polar(-1,c),d=s.multiply(h,r),p=(o+1)/t,f=2*Math.PI*p,g=s.Polar(-1,f),m=s.multiply(g,r);e.push(a,1,0,1),i.push(h.imag,0,h.real),n.push(d.imag,u,d.real,1),e.push(a,0,0,1),i.push(h.imag,0,h.real),n.push(d.imag,l,d.real,1),e.push(p,0,0,1),i.push(g.imag,0,g.real),n.push(m.imag,l,m.real,1),e.push(a,1,0,1),i.push(h.imag,0,h.real),n.push(d.imag,u,d.real,1),e.push(p,0,0,1),i.push(g.imag,0,g.real),n.push(m.imag,l,m.real,1),e.push(p,1,0,1),i.push(g.imag,0,g.real),n.push(m.imag,u,m.real,1)}if(this._top.getValue()){const l=[],c=[];for(let e=0;e<t;++e){const i=e/t,n=2*Math.PI*i,h=s.Polar(-1,n);l.push(new o((h.imag+1)/2,-(h.real-1)/2)),c.push(new a(h.imag*r,u,h.real*r))}const h=l[0],d=c[0];for(let t=1,r=c.length-1;t<r;++t){const r=l[t],s=l[t+1],o=c[t],a=c[t+1];e.push(h.x,h.y,0,1),i.push(0,1,0),n.push(d.x,d.y,d.z,1),e.push(r.x,r.y,0,1),i.push(0,1,0),n.push(o.x,o.y,o.z,1),e.push(s.x,s.y,0,1),i.push(0,1,0),n.push(a.x,a.y,a.z,1)}}if(this._bottom.getValue()){const u=[],c=[];for(let e=t-1;e>-1;--e){const i=e/t,n=2*Math.PI*i,h=s.Polar(-1,n);u.push(new o((h.imag+1)/2,(h.real+1)/2)),c.push(new a(h.imag*r,l,h.real*r))}const h=u[0],d=c[0];for(let t=1,r=c.length-1;t<r;++t){const r=u[t],s=u[t+1],o=c[t],a=c[t+1];e.push(h.x,h.y,0,1),i.push(0,-1,0),n.push(d.x,d.y,d.z,1),e.push(r.x,r.y,0,1),i.push(0,-1,0),n.push(o.x,o.y,o.z,1),e.push(s.x,s.y,0,1),i.push(0,-1,0),n.push(a.x,a.y,a.z,1)}}this.setSolid(this._solid.getValue()),this.setExtents()},setExtents:function(){const t=this._radius.getValue(),e=this._height.getValue()/2,i=-e;this._top.getValue()||this._side.getValue()||this._bottom.getValue()?this._top.getValue()||this._side.getValue()?this._bottom.getValue()||this._side.getValue()?(this.getMin().set(-t,i,-t),this.getMax().set(t,e,t)):(this.getMin().set(-t,e,-t),this.getMax().set(t,e,t)):(this.getMin().set(-t,i,-t),this.getMax().set(t,i,t)):(this.getMin().set(0,0,0),this.getMax().set(0,0,0))}}),u})),define("x_ite/Components/Geometry3D/ElevationGrid",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Base/X3DCast","x_ite/Base/X3DConstants","standard/Math/Geometry/Triangle3","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3"],(function(t,e,i,n,r,s,o,a,u){"use strict";function l(t){n.call(this,t),this.addType(s.ElevationGrid),this._xSpacing.setUnit("length"),this._zSpacing.setUnit("length"),this._creaseAngle.setUnit("angle"),this._height.setUnit("length"),this.fogCoordNode=null,this.colorNode=null,this.texCoordNode=null,this.normalNode=null,this.coordNode=null}return l.prototype=Object.assign(Object.create(n.prototype),{constructor:l,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.inputOnly,"set_height",new t.MFFloat),new e(s.initializeOnly,"xDimension",new t.SFInt32),new e(s.initializeOnly,"zDimension",new t.SFInt32),new e(s.initializeOnly,"xSpacing",new t.SFFloat(1)),new e(s.initializeOnly,"zSpacing",new t.SFFloat(1)),new e(s.initializeOnly,"solid",new t.SFBool(!0)),new e(s.initializeOnly,"ccw",new t.SFBool(!0)),new e(s.initializeOnly,"creaseAngle",new t.SFFloat),new e(s.initializeOnly,"colorPerVertex",new t.SFBool(!0)),new e(s.initializeOnly,"normalPerVertex",new t.SFBool(!0)),new e(s.inputOutput,"attrib",new t.MFNode),new e(s.inputOutput,"fogCoord",new t.SFNode),new e(s.inputOutput,"color",new t.SFNode),new e(s.inputOutput,"texCoord",new t.SFNode),new e(s.inputOutput,"normal",new t.SFNode),new e(s.initializeOnly,"height",new t.MFFloat)]),getTypeName:function(){return"ElevationGrid"},getComponentName:function(){return"Geometry3D"},getContainerField:function(){return"geometry"},initialize:function(){n.prototype.initialize.call(this),this._set_height.addFieldInterest(this._height),this._attrib.addInterest("set_attrib__",this),this._fogCoord.addInterest("set_fogCoord__",this),this._color.addInterest("set_color__",this),this._texCoord.addInterest("set_texCoord__",this),this._normal.addInterest("set_normal__",this),this.set_attrib__(),this.set_fogCoord__(),this.set_color__(),this.set_texCoord__(),this.set_normal__()},set_attrib__:function(){const t=this.getAttrib();for(const e of t)e.removeInterest("requestRebuild",this),e._attribute_changed.removeInterest("updateVertexArrays",this);t.length=0;for(const e of this._attrib){const i=r(s.X3DVertexAttributeNode,e);i&&t.push(i)}for(const e of t)e.addInterest("requestRebuild",this),e._attribute_changed.addInterest("updateVertexArrays",this);this.updateVertexArrays()},set_fogCoord__:function(){this.fogCoordNode&&this.fogCoordNode.removeInterest("requestRebuild",this),this.fogCoordNode=r(s.FogCoordinate,this._fogCoord),this.fogCoordNode&&this.fogCoordNode.addInterest("requestRebuild",this)},set_color__:function(){this.colorNode&&(this.colorNode.removeInterest("requestRebuild",this),this.colorNode._transparent.removeInterest("set_transparent__",this)),this.colorNode=r(s.X3DColorNode,this._color),this.colorNode?(this.colorNode.addInterest("requestRebuild",this),this.colorNode._transparent.addInterest("set_transparent__",this),this.set_transparent__()):this.setTransparent(!1)},set_transparent__:function(){this.setTransparent(this.colorNode.getTransparent())},set_texCoord__:function(){this.texCoordNode&&this.texCoordNode.removeInterest("requestRebuild",this),this.texCoordNode=r(s.X3DTextureCoordinateNode,this._texCoord),this.texCoordNode&&this.texCoordNode.addInterest("requestRebuild",this),this.setTextureCoordinate(this.texCoordNode)},set_normal__:function(){this.normalNode&&this.normalNode.removeInterest("requestRebuild",this),this.normalNode=r(s.X3DNormalNode,this._normal),this.normalNode&&this.normalNode.addInterest("requestRebuild",this)},getColor:function(){return this.colorNode},getTexCoord:function(){return this.texCoordNode},getNormal:function(){return this.normalNode},getHeight:function(t){return t<this._height.length?this._height[t]:0},createTexCoords:function(){const t=[],e=this._xDimension.getValue(),i=this._zDimension.getValue(),n=e-1,r=i-1;for(let s=0;s<i;++s)for(let i=0;i<e;++i)t.push(new a(i/n,s/r));return t},createNormals:function(t,e,i){const n=!this._ccw.getValue(),r=[],s=[];for(let e=0,i=t.length;e<i;++e)r[e]=[];for(let i=0,a=e.length;i<a;i+=3){const a=e[i],l=e[i+1],c=e[i+2];r[a].push(s.length),r[l].push(s.length+1),r[c].push(s.length+2);const h=o.normal(t[a],t[l],t[c],new u(0,0,0));n&&h.negate(),s.push(h),s.push(h),s.push(h)}return this.refineNormals(r,s,this._creaseAngle.getValue())},createCoordIndex:function(){const t=[],e=this._xDimension.getValue(),i=e-1,n=this._zDimension.getValue()-1;for(let r=0;r<n;++r)for(let n=0;n<i;++n){const i=r*e+n,s=(r+1)*e+n,o=(r+1)*e+(n+1),a=r*e+(n+1);t.push(i),t.push(s),t.push(o),t.push(i),t.push(o),t.push(a)}return t},createPoints:function(){const t=[],e=this._xDimension.getValue(),i=this._zDimension.getValue(),n=this._xSpacing.getValue(),r=this._zSpacing.getValue();for(let s=0;s<i;++s)for(let i=0;i<e;++i)t.push(new u(n*i,this.getHeight(i+s*e),r*s));return t},build:function(){if(this._xDimension.getValue()<2||this._zDimension.getValue()<2)return;const t=this._colorPerVertex.getValue(),e=this._normalPerVertex.getValue(),i=this.createCoordIndex(),n=this.getAttrib(),r=n.length,s=this.getAttribs(),o=this.fogCoordNode,a=this.getColor(),u=this.getTexCoord(),l=this.getNormal(),c=this.createPoints(),h=this.getFogDepths(),d=this.getColors(),p=this.getMultiTexCoords(),f=this.getNormals(),g=this.getVertices();let m=0;if(u)u.init(p);else{var _=this.createTexCoords(),y=this.getTexCoords();p.push(y)}for(let x=0,w=i.length;x<w;++m)for(let w=0;w<6;++w,++x){const w=i[x],b=c[w];for(let t=0;t<r;++t)n[t].addValue(w,s[t]);if(o&&o.addDepth(w,h),a&&(t?a.addColor(w,d):a.addColor(m,d)),u)u.addTexCoord(w,p);else{const t=_[w];y.push(t.x,t.y,0,1)}l&&(e?l.addVector(w,f):l.addVector(m,f)),g.push(b.x,b.y,b.z,1)}if(!l){const t=this.createNormals(c,i);for(const e of t)f.push(e.x,e.y,e.z)}this.setSolid(this._solid.getValue()),this.setCCW(this._ccw.getValue())}}),l})),define("x_ite/Components/Geometry3D/Extrusion",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Base/X3DConstants","standard/Math/Geometry/Triangle3","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4"],(function(t,e,i,n,r,s,o,a,u,l){"use strict";function c(t){n.call(this,t),this.addType(r.Extrusion),this._creaseAngle.setUnit("angle"),this._crossSection.setUnit("length"),this._spine.setUnit("length")}return c.prototype=Object.assign(Object.create(n.prototype),{constructor:c,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOnly,"set_crossSection",new t.MFVec2f),new e(r.inputOnly,"set_orientation",new t.MFRotation),new e(r.inputOnly,"set_scale",new t.MFVec2f),new e(r.inputOnly,"set_spine",new t.MFVec3f),new e(r.initializeOnly,"beginCap",new t.SFBool(!0)),new e(r.initializeOnly,"endCap",new t.SFBool(!0)),new e(r.initializeOnly,"solid",new t.SFBool(!0)),new e(r.initializeOnly,"ccw",new t.SFBool(!0)),new e(r.initializeOnly,"convex",new t.SFBool(!0)),new e(r.initializeOnly,"creaseAngle",new t.SFFloat),new e(r.initializeOnly,"crossSection",new t.MFVec2f(new o(1,1),new o(1,-1),new o(-1,-1),new o(-1,1),new o(1,1))),new e(r.initializeOnly,"orientation",new t.MFRotation(new u)),new e(r.initializeOnly,"scale",new t.MFVec2f(new o(1,1))),new e(r.initializeOnly,"spine",new t.MFVec3f(new a(0,0,0),new a(0,1,0)))]),getTypeName:function(){return"Extrusion"},getComponentName:function(){return"Geometry3D"},getContainerField:function(){return"geometry"},initialize:function(){n.prototype.initialize.call(this),this._set_crossSection.addFieldInterest(this._crossSection),this._set_orientation.addFieldInterest(this._orientation),this._set_scale.addFieldInterest(this._scale),this._set_spine.addFieldInterest(this._spine)},getClosedOrientation:function(){const t=this._orientation;if(t.length){const e=t[0].getValue(),i=t[t.length-1].getValue();return e.equals(i)}return!0},createPoints:function(){const t=new a(1,1,1);return function(){const e=this._crossSection,i=this._orientation,n=this._scale,r=this._spine,s=[],o=this.createRotations();for(let u=0,l=r.length;u<l;++u){const r=o[u];if(i.length&&r.rotate(i[Math.min(u,i.length-1)].getValue()),n.length){const e=n[Math.min(u,n.length-1)].getValue();r.scale(t.set(e.x,1,e.y))}for(let t=0,i=e.length;t<i;++t){const i=e[t].getValue();s.push(r.multVecMatrix(new a(i.x,0,i.y)))}}return s}}(),createRotations:function(){const t=[],e=new a(0,0,0),i=new a(0,0,0),n=new a(0,0,0),r=new a(0,0,0),s=new a(0,0,0),o=new a(0,0,0),c=new u(0,0,1,0);return function(){const u=this._spine,h=u.length,d=u[0].getValue(),p=u[u.length-1].getValue(),f=d.equals(p)&&this.getClosedOrientation();for(let e=t.length;e<h;++e)t[e]=new l;if(t.length=h,e.set(0,0,0),i.set(0,0,0),n.set(0,0,0),f){const t=d;for(let e=1,n=h-2;e<n&&(i.assign(u[e].getValue()).subtract(t).normalize().subtract(o.assign(u[n].getValue()).subtract(t).normalize()).normalize(),i.equals(a.Zero));++e);for(let t=0,e=h-2;t<e&&(n.assign(u[t+1].getValue()).subtract(u[t].getValue()).cross(o.assign(u[e].getValue()).subtract(u[t].getValue())).normalize(),n.equals(a.Zero));++t);}else{for(let t=0,e=h-1;t<e&&(i.assign(u[t+1].getValue()).subtract(u[t].getValue()).normalize(),i.equals(a.Zero));++t);for(let t=1,e=h-1;t<e&&(n.assign(u[t+1].getValue()).subtract(u[t].getValue()).cross(o.assign(u[t-1].getValue()).subtract(u[t].getValue())).normalize(),n.equals(a.Zero));++t);}i.equals(a.Zero)&&i.set(0,1,0),n.equals(a.Zero)&&c.setFromToVec(a.yAxis,i).multVecRot(n.assign(a.zAxis)),e.assign(i).cross(n);const g=d;t[0].set(e.x,e.y,e.z,0,i.x,i.y,i.z,0,n.x,n.y,n.z,0,g.x,g.y,g.z,1),r.assign(i),s.assign(n);for(let l=1,c=h-1;l<c;++l){const c=u[l].getValue();i.assign(u[l+1].getValue()).subtract(c).normalize().subtract(o.assign(u[l-1].getValue()).subtract(c).normalize()).normalize(),n.assign(u[l+1].getValue()).subtract(c).cross(o.assign(u[l-1].getValue()).subtract(c)).normalize(),s.dot(n)<0&&n.negate(),i.equals(a.Zero)?i.assign(r):r.assign(i),n.equals(a.Zero)?n.assign(s):s.assign(n),e.assign(i).cross(n),t[l].set(e.x,e.y,e.z,0,i.x,i.y,i.z,0,n.x,n.y,n.z,0,c.x,c.y,c.z,1)}if(f)t[h-1].assign(t[0]);else{const l=p;i.assign(l).subtract(u[h-2].getValue()).normalize(),h>2&&n.assign(l).subtract(u[h-2].getValue()).cross(o.assign(u[h-3].getValue()).subtract(u[h-2].getValue())).normalize(),s.dot(n)<0&&n.negate(),i.equals(a.Zero)&&i.assign(r),n.equals(a.Zero)&&n.assign(s),e.assign(i).cross(n),t[h-1].set(e.x,e.y,e.z,0,i.x,i.y,i.z,0,n.x,n.y,n.z,0,l.x,l.y,l.z,1)}return t}}(),build:function(){const t=new o(0,0,0),e=new o(0,0,0),i=new o(0,0,0);return function(){const n=!this._ccw.getValue(),r=this._crossSection,u=this._spine,l=u.length,c=this.getTexCoords();if(l<2||r.length<2)return;this.getMultiTexCoords().push(c);const h=r.length;function d(t,e){return t*h+e}const p=u[0].getValue(),f=u[l-1].getValue(),g=p.equals(f)&&this.getClosedOrientation(),m=r[0].getValue(),_=r[r.length-1].getValue(),y=m.equals(_);t.assign(r[0].getValue()),e.assign(r[0].getValue());for(let i=1,n=r.length;i<n;++i)t.min(r[i].getValue()),e.max(r[i].getValue());const x=i.assign(e).subtract(t),w=Math.max(x.x,x.y),b=y?r.length-1:r.length,v=[],S=[],T=this.createPoints();for(let t=0,e=T.length;t<e;++t)v[t]=[];const C=this.getNormals(),O=this.getVertices(),N=r.length-1,F=l-1;let E=d(0,0),D=d(0,y?0:N);for(let t=0;t<F;++t)for(let e=0;e<N;++e){const i=g&&t===l-2?0:t+1,o=y&&e===r.length-2?0:e+1;let u=d(t,e),h=d(t,o),p=d(i,o),f=d(i,e),m=T[u],_=T[h],x=T[p],w=T[f],b=_.distance(x)>=1e-7,C=w.distance(m)>=1e-7;if(n)var M=s.normal(x,_,m,new a(0,0,0)),I=s.normal(w,x,m,new a(0,0,0));else M=s.normal(m,_,x,new a(0,0,0)),I=s.normal(m,x,w,new a(0,0,0));if(0==e&&(C?E=u:(u=E,m=T[u])),e==r.length-2&&(b?D=h:(p=D,x=T[p])),b){if(C)c.push(e/N,t/F,0,1);else{const i=(t/F+(t+1)/F)/2;c.push(e/N,i,0,1)}v[u].push(S.length),S.push(M),O.push(m.x,m.y,m.z,1),c.push((e+1)/N,t/F,0,1),v[h].push(S.length),S.push(M),O.push(_.x,_.y,_.z,1),c.push((e+1)/N,(t+1)/F,0,1),v[p].push(S.length),S.push(M),O.push(x.x,x.y,x.z,1)}if(C){if(c.push(e/N,t/F,0,1),v[u].push(S.length),S.push(I),O.push(m.x,m.y,m.z,1),b)c.push((e+1)/N,(t+1)/F,0,1);else{const i=((t+1)/F+t/F)/2;c.push((e+1)/N,i,0,1)}v[p].push(S.length),S.push(I),O.push(x.x,x.y,x.z,1),c.push(e/N,(t+1)/F,0,1),v[f].push(S.length),S.push(I),O.push(w.x,w.y,w.z,1)}}const V=this.refineNormals(v,S,this._creaseAngle.getValue());for(const t of V)C.push(t.x,t.y,t.z);if(w&&b>2){if(this._beginCap.getValue()){const e=0,i=[],u=[];for(let n=0;n<b;++n){const s=d(e,b-1-n),a=T[s].copy();a.index=s,a.texCoord=o.subtract(r[b-1-n].getValue(),t).divide(w),i.push(a)}if(this._convex.getValue()?s.triangulateConvexPolygon(i,u):s.triangulatePolygon(i,u),u.length>=3){const t=s.normal(T[u[0].index],T[u[1].index],T[u[2].index],new a(0,0,0));n&&t.negate(),this.addCap(c,t,T,u)}}if(this._endCap.getValue()){const e=l-1,i=[],u=[];for(let n=0;n<b;++n){const s=d(e,n),a=T[s].copy();a.index=s,a.texCoord=o.subtract(r[n].getValue(),t).divide(w),i.push(a)}if(this._convex.getValue()?s.triangulateConvexPolygon(i,u):s.triangulatePolygon(i,u),u.length>=3){const t=s.normal(T[u[0].index],T[u[1].index],T[u[2].index],new a(0,0,0));n&&t.negate(),this.addCap(c,t,T,u)}}}this.setSolid(this._solid.getValue()),this.setCCW(this._ccw.getValue())}}(),addCap:function(t,e,i,n){const r=this.getNormals(),s=this.getVertices();for(let o=0,a=n.length;o<a;o+=3){const a=i[n[o].index],u=i[n[o+1].index],l=i[n[o+2].index],c=n[o].texCoord,h=n[o+1].texCoord,d=n[o+2].texCoord;t.push(c.x,c.y,0,1),t.push(h.x,h.y,0,1),t.push(d.x,d.y,0,1),r.push(e.x,e.y,e.z,e.x,e.y,e.z,e.x,e.y,e.z),s.push(a.x,a.y,a.z,1,u.x,u.y,u.z,1,l.x,l.y,l.z,1)}}}),c})),define("x_ite/Components/Geometry3D/Sphere",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Base/X3DConstants"],(function(t,e,i,n,r){"use strict";function s(t){n.call(this,t),this.addType(r.Sphere),this._radius.setUnit("length")}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.initializeOnly,"radius",new t.SFFloat(1)),new e(r.initializeOnly,"solid",new t.SFBool(!0))]),getTypeName:function(){return"Sphere"},getComponentName:function(){return"Geometry3D"},getContainerField:function(){return"geometry"},set_live__:function(){n.prototype.set_live__.call(this),this.isLive().getValue()?this.getBrowser().getSphereOptions().addInterest("requestRebuild",this):this.getBrowser().getSphereOptions().removeInterest("requestRebuild",this)},build:function(){const t=this.getBrowser().getSphereOptions().getGeometry(),e=Math.abs(this._radius.getValue());if(this.setMultiTexCoords(t.getMultiTexCoords()),this.setNormals(t.getNormals()),1===e)this.setVertices(t.getVertices()),this.getMin().assign(t.getMin()),this.getMax().assign(t.getMax());else{const i=t.getVertices().getValue(),n=this.getVertices();for(let t=0,r=i.length;t<r;t+=4)n.push(e*i[t],e*i[t+1],e*i[t+2],1);this.getMin().set(-e,-e,-e),this.getMax().set(e,e,e)}this.setSolid(this._solid.getValue())}}),s})),define("x_ite/Components/Geometry3D",["x_ite/Configuration/SupportedNodes","x_ite/Components/Geometry3D/Box","x_ite/Components/Geometry3D/Cone","x_ite/Components/Geometry3D/Cylinder","x_ite/Components/Geometry3D/ElevationGrid","x_ite/Components/Geometry3D/Extrusion","x_ite/Components/Geometry3D/IndexedFaceSet","x_ite/Components/Geometry3D/Sphere"],(function(t,e,i,n,r,s,o,a){"use strict";const u={Box:e,Cone:i,Cylinder:n,ElevationGrid:r,Extrusion:s,IndexedFaceSet:o,Sphere:a},l={};for(const e in u)t.addType(e,u[e]);for(const e in l)t.addAbstractType(e,l[e])})),define("x_ite/Components/Grouping/StaticGroup",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Core/X3DChildNode","x_ite/Components/Grouping/X3DBoundedObject","x_ite/Components/Grouping/Group","x_ite/Base/X3DConstants","x_ite/Rendering/TraverseType","standard/Math/Geometry/Box3","standard/Math/Geometry/ViewVolume"],(function(t,e,i,n,r,s,o,a,u,l){"use strict";function c(t){n.call(this,t),r.call(this,t),this.addType(o.StaticGroup),this.group=new s(this.getExecutionContext()),this.collisionShapes=null,this.depthShapes=null,this.opaqueShapes=null,this.transparentShapes=null,this.bbox=new u,this.shadowBBox=new u}return c.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:c,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.inputOutput,"visible",new t.SFBool(!0)),new e(o.inputOutput,"bboxDisplay",new t.SFBool),new e(o.initializeOnly,"bboxSize",new t.SFVec3f(-1,-1,-1)),new e(o.initializeOnly,"bboxCenter",new t.SFVec3f),new e(o.initializeOnly,"children",new t.MFNode)]),getTypeName:function(){return"StaticGroup"},getComponentName:function(){return"Grouping"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),r.prototype.initialize.call(this),this._bboxSize.addFieldInterest(this.group._bboxSize),this._bboxCenter.addFieldInterest(this.group._bboxCenter),this._children.addFieldInterest(this.group._children),this.group._bboxSize=this._bboxSize,this.group._bboxCenter=this._bboxCenter,this.group._children=this._children,this.group.setPrivate(!0),this.group.setup(),this.group._isCameraObject.addFieldInterest(this._isCameraObject),this.group._isPickableObject.addFieldInterest(this._isPickableObject),this.group._children.addInterest("set_children__",this),this.setCameraObject(this.group.getCameraObject()),this.setPickableObject(this.group.getPickableObject()),this.set_children__()},getBBox:function(t,e){return t.assign(e?this.shadowBBox:this.bbox)},set_children__:function(){this.group.getBBox(this.bbox),this.group.getBBox(this.shadowBBox,!0),this.collisionShapes=null,this.depthShapes=null,this.opaqueShapes=null,this.transparentShapes=null},traverse:function(){const t=new l;return t.intersectsSphere=function(){return!0},function(e,i){switch(e){case a.CAMERA:return;case a.POINTER:case a.COLLISION:{if(!this.collisionShapes){const n=i.getViewVolumes(),r=i.getViewport(),s=i.getProjectionMatrix(),o=i.getModelViewMatrix(),a=i.getNumCollisionShapes();n.push(t.set(s,r,r)),o.push(),o.identity(),this.group.traverse(e,i),o.pop(),n.pop();const u=i.getNumCollisionShapes();this.collisionShapes=i.getCollisionShapes().splice(a,u-a),i.setNumCollisionShapes(a)}const n=i.getModelViewMatrix();for(const t of this.collisionShapes)n.push(),n.multLeft(t.modelViewMatrix),t.shapeNode.traverse(e,i),n.pop();return}case a.SHADOW:{if(!this.depthShapes){const n=i.getViewVolumes(),r=i.getViewport(),s=i.getProjectionMatrix(),o=i.getModelViewMatrix(),a=i.getNumDepthShapes();n.push(t.set(s,r,r)),o.push(),o.identity(),this.group.traverse(e,i),o.pop(),n.pop();const u=i.getNumDepthShapes();this.depthShapes=i.getDepthShapes().splice(a,u-a),i.setNumDepthShapes(a)}const n=i.getModelViewMatrix();for(const t of this.depthShapes)n.push(),n.multLeft(t.modelViewMatrix),t.shapeNode.traverse(e,i),n.pop();return}case a.DISPLAY:{if(!this.opaqueShapes){const n=i.getViewVolumes(),r=i.getViewport(),s=i.getProjectionMatrix(),o=i.getModelViewMatrix(),a=i.getNumOpaqueShapes(),u=i.getNumTransparentShapes();n.push(t.set(s,r,r)),o.push(),o.identity(),this.group.traverse(e,i),o.pop(),n.pop();const l=i.getNumOpaqueShapes(),c=i.getNumTransparentShapes();this.opaqueShapes=i.getOpaqueShapes().splice(a,l-a),this.transparentShapes=i.getTransparentShapes().splice(u,c-u),i.setNumOpaqueShapes(a),i.setNumTransparentShapes(u)}const n=i.getModelViewMatrix();for(const t of this.opaqueShapes)n.push(),n.multLeft(t.modelViewMatrix),t.shapeNode.traverse(e,i),n.pop();for(const t of this.transparentShapes)n.push(),n.multLeft(t.modelViewMatrix),t.shapeNode.traverse(e,i),n.pop();return}}}}()}),c})),define("x_ite/Components/Grouping/Switch",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Rendering/TraverseType","x_ite/Base/X3DCast","x_ite/Base/X3DConstants"],(function(t,e,i,n,r,s,o){"use strict";function a(t){n.call(this,t),this.addType(o.Switch),"2.0"===t.getSpecificationVersion()&&this.addAlias("choice",this._children),this.childNode=null,this.visibleNode=null,this.boundedObject=null}return a.prototype=Object.assign(Object.create(n.prototype),{constructor:a,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.inputOutput,"whichChoice",new t.SFInt32(-1)),new e(o.inputOutput,"visible",new t.SFBool(!0)),new e(o.inputOutput,"bboxDisplay",new t.SFBool),new e(o.initializeOnly,"bboxSize",new t.SFVec3f(-1,-1,-1)),new e(o.initializeOnly,"bboxCenter",new t.SFVec3f),new e(o.inputOnly,"addChildren",new t.MFNode),new e(o.inputOnly,"removeChildren",new t.MFNode),new e(o.inputOutput,"children",new t.MFNode)]),getTypeName:function(){return"Switch"},getComponentName:function(){return"Grouping"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this._whichChoice.addInterest("set_child__",this),this._children.addInterest("set_child__",this),this.set_child__()},getSubBBox:function(t,e){if(this._bboxSize.getValue().equals(this.getDefaultBBoxSize())){const i=s(o.X3DBoundedObject,this.visibleNode);return i?i.getBBox(t,e):t.set()}return t.set(this._bboxSize.getValue(),this._bboxCenter.getValue())},clear:function(){},add:function(){},remove:function(){},set_child__:function(){this.childNode&&(this.childNode._isCameraObject.removeInterest("set_cameraObject__",this),this.childNode._isPickableObject.removeInterest("set_transformSensors__",this)),s(o.X3DBoundedObject,this.childNode)&&(this.childNode._visible.removeInterest("set_visible__",this),this.childNode._bboxDisplay.removeInterest("set_bboxDisplay__",this));const t=this._whichChoice.getValue();t>=0&&t<this._children.length?(this.childNode=s(o.X3DChildNode,this._children[t]),this.childNode&&(this.childNode._isCameraObject.addInterest("set_cameraObject__",this),this.childNode._isPickableObject.addInterest("set_transformSensors__",this),s(o.X3DBoundedObject,this.childNode)&&(this.childNode._visible.addInterest("set_visible__",this),this.childNode._bboxDisplay.addInterest("set_bboxDisplay__",this)),delete this.traverse)):(this.childNode=null,this.traverse=Function.prototype),this.set_transformSensors__(),this.set_visible__(),this.set_bboxDisplay__()},set_cameraObject__:function(){this.childNode&&this.childNode.getCameraObject()?s(o.X3DBoundedObject,this.childNode)?this.setCameraObject(this.childNode._visible.getValue()):this.setCameraObject(!0):this.setCameraObject(!1)},set_transformSensors__:function(){this.setPickableObject(Boolean(this.getTransformSensors().size||this.childNode&&this.childNode.getPickableObject()))},set_visible__:function(){s(o.X3DBoundedObject,this.childNode)?this.visibleNode=this.childNode._visible.getValue()?this.childNode:null:this.visibleNode=this.childNode,this.set_cameraObject__()},set_bboxDisplay__:function(){s(o.X3DBoundedObject,this.childNode)?this.boundedObject=this.childNode._bboxDisplay.getValue()?this.childNode:null:this.boundedObject=null},traverse:function(t,e){switch(t){case r.POINTER:case r.CAMERA:case r.SHADOW:{const i=this.visibleNode;return void(i&&i.traverse(t,e))}case r.PICKING:{if(this.getTransformSensors().size){const t=e.getModelViewMatrix().get();for(const e of this.getTransformSensors())e.collect(t)}const i=this.childNode;if(i){const n=this.getBrowser().getPickingHierarchy();n.push(this),i.traverse(t,e),n.pop()}return}case r.COLLISION:{const i=this.childNode;return void(i&&i.traverse(t,e))}case r.DISPLAY:{const i=this.visibleNode;i&&i.traverse(t,e);const n=this.boundedObject;return void(n&&n.displayBBox(t,e))}}}}),a})),define("x_ite/Components/Grouping/X3DTransformMatrix3DNode",["x_ite/Components/Grouping/X3DGroupingNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4"],(function(t,e,i,n,r){"use strict";function s(i){t.call(this,i),this.addType(e.X3DTransformMatrix3DNode),this.matrix=new r,this.getBBox=this.getGetGroupBBox(),this.traverse=this.getGroupTraverse()}return s.prototype=Object.assign(Object.create(t.prototype),{constructor:s,setMatrix:function(t){t.equals(r.Identity)?(this.matrix.identity(),this.getBBox=this.getGetGroupBBox(),this.traverse=this.getGroupTraverse()):(this.matrix.assign(t),this.getBBox=this.getGetBBox(),this.traverse=this.getTraverse())},getMatrix:function(){return this.matrix},setTransform:function(t,e,r,s,o){t.equals(i.Zero)&&e.equals(n.Identity)&&r.equals(i.One)?(this.matrix.identity(),this.getBBox=this.getGetGroupBBox(),this.traverse=this.getGroupTraverse()):(this.matrix.set(t,e,r,s,o),this.getBBox=this.getGetBBox(),this.traverse=this.getTraverse())},getGetBBox:function(){function t(t,e){return this.getSubBBox(t,e).multRight(this.matrix)}return function(){return t}}(),getGetGroupBBox:function(){return t.prototype.getBBox},getTraverse:function(){function e(e,i){const n=i.getModelViewMatrix();n.push(),n.multLeft(this.matrix),t.prototype.traverse.call(this,e,i),n.pop()}return function(){return e}}(),getGroupTraverse:function(){return t.prototype.traverse}}),s})),define("x_ite/Components/Grouping/X3DTransformNode",["x_ite/Components/Grouping/X3DTransformMatrix3DNode","x_ite/Base/X3DConstants"],(function(t,e){"use strict";function i(i){t.call(this,i),this.addType(e.X3DTransformNode),this._translation.setUnit("length"),this._center.setUnit("length")}return i.prototype=Object.assign(Object.create(t.prototype),{constructor:i,initialize:function(){t.prototype.initialize.call(this),this.addInterest("eventsProcessed",this),this.eventsProcessed()},eventsProcessed:function(){this.setTransform(this._translation.getValue(),this._rotation.getValue(),this._scale.getValue(),this._scaleOrientation.getValue(),this._center.getValue())}}),i})),define("x_ite/Components/Grouping/Transform",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Grouping/X3DTransformNode","x_ite/Base/X3DConstants"],(function(t,e,i,n,r){"use strict";function s(t){n.call(this,t),this.addType(r.Transform)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"translation",new t.SFVec3f),new e(r.inputOutput,"rotation",new t.SFRotation),new e(r.inputOutput,"scale",new t.SFVec3f(1,1,1)),new e(r.inputOutput,"scaleOrientation",new t.SFRotation),new e(r.inputOutput,"center",new t.SFVec3f),new e(r.inputOutput,"visible",new t.SFBool(!0)),new e(r.inputOutput,"bboxDisplay",new t.SFBool),new e(r.initializeOnly,"bboxSize",new t.SFVec3f(-1,-1,-1)),new e(r.initializeOnly,"bboxCenter",new t.SFVec3f),new e(r.inputOnly,"addChildren",new t.MFNode),new e(r.inputOnly,"removeChildren",new t.MFNode),new e(r.inputOutput,"children",new t.MFNode)]),getTypeName:function(){return"Transform"},getComponentName:function(){return"Grouping"},getContainerField:function(){return"children"}}),s})),define("x_ite/Components/Grouping",["x_ite/Configuration/SupportedNodes","x_ite/Components/Grouping/Group","x_ite/Components/Grouping/StaticGroup","x_ite/Components/Grouping/Switch","x_ite/Components/Grouping/Transform","x_ite/Components/Grouping/X3DBoundedObject","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Components/Grouping/X3DTransformMatrix3DNode","x_ite/Components/Grouping/X3DTransformNode"],(function(t,e,i,n,r,s,o,a,u){"use strict";const l={Group:e,StaticGroup:i,Switch:n,Transform:r},c={X3DBoundedObject:s,X3DGroupingNode:o,X3DTransformMatrix3DNode:a,X3DTransformNode:u};for(const e in l)t.addType(e,l[e]);for(const e in c)t.addAbstractType(e,c[e])})),define("x_ite/Components/Interpolation/ColorInterpolator",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Color3"],(function(t,e,i,n,r,s){"use strict";function o(t){n.call(this,t),this.addType(r.ColorInterpolator),this.hsv=[]}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOnly,"set_fraction",new t.SFFloat),new e(r.inputOutput,"key",new t.MFFloat),new e(r.inputOutput,"keyValue",new t.MFColor),new e(r.outputOnly,"value_changed",new t.SFColor)]),getTypeName:function(){return"ColorInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this._keyValue.addInterest("set_keyValue__",this)},set_keyValue__:function(){const e=this._keyValue;e.length<this._key.length&&this._keyValue.resize(this._key.length,e.length?e[this._keyValue.length-1]:new t.SFColor),this.hsv.length=0;for(const t of e)this.hsv.push(t.getHSV([]))},interpolate:function(){const t=[];return function(e,i,n){s.lerp(this.hsv[e],this.hsv[i],n,t),this._value_changed.setHSV(t[0],t[1],t[2])}}()}),o})),define("x_ite/Components/Interpolation/CoordinateInterpolator",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Base/X3DConstants","standard/Math/Algorithm"],(function(t,e,i,n,r,s){"use strict";function o(t){n.call(this,t),this.addType(r.CoordinateInterpolator)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOnly,"set_fraction",new t.SFFloat),new e(r.inputOutput,"key",new t.MFFloat),new e(r.inputOutput,"keyValue",new t.MFVec3f),new e(r.outputOnly,"value_changed",new t.MFVec3f)]),getTypeName:function(){return"CoordinateInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},set_keyValue__:function(){},interpolate:function(t,e,i){const n=this._keyValue.getValue();let r=this._key.length?Math.floor(this._keyValue.length/this._key.length):0;this._value_changed.length=r;const o=this._value_changed.getValue();e=(t*=r)+(this._key.length>1?r:0),t*=3,e*=3,r*=3;for(let a=0;a<r;a+=3){const r=a+1,u=a+2;o[a]=s.lerp(n[t+a],n[e+a],i),o[r]=s.lerp(n[t+r],n[e+r],i),o[u]=s.lerp(n[t+u],n[e+u],i)}this._value_changed.addEvent()}}),o})),define("x_ite/Components/Interpolation/CoordinateInterpolator2D",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Base/X3DConstants","standard/Math/Algorithm"],(function(t,e,i,n,r,s){"use strict";function o(t){n.call(this,t),this.addType(r.CoordinateInterpolator2D)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOnly,"set_fraction",new t.SFFloat),new e(r.inputOutput,"key",new t.MFFloat),new e(r.inputOutput,"keyValue",new t.MFVec2f),new e(r.outputOnly,"value_changed",new t.MFVec2f)]),getTypeName:function(){return"CoordinateInterpolator2D"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},set_keyValue__:function(){},interpolate:function(t,e,i){const n=this._keyValue.getValue();let r=this._key.length?Math.floor(this._keyValue.length/this._key.length):0;this._value_changed.length=r;const o=this._value_changed.getValue();e=(t*=r)+(this._key.length>1?r:0),t*=2,e*=2,r*=2;for(let a=0;a<r;a+=2){const r=a+1;o[a]=s.lerp(n[t+a],n[e+a],i),o[r]=s.lerp(n[t+r],n[e+r],i)}this._value_changed.addEvent()}}),o})),define("x_ite/Components/Interpolation/NormalInterpolator",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Algorithm"],(function(t,e,i,n,r,s,o){"use strict";function a(t){n.call(this,t),this.addType(r.NormalInterpolator)}return a.prototype=Object.assign(Object.create(n.prototype),{constructor:a,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOnly,"set_fraction",new t.SFFloat),new e(r.inputOutput,"key",new t.MFFloat),new e(r.inputOutput,"keyValue",new t.MFVec3f),new e(r.outputOnly,"value_changed",new t.MFVec3f)]),getTypeName:function(){return"NormalInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this._keyValue.addInterest("set_keyValue__",this)},set_keyValue__:function(){},interpolate:function(){const t=new s(0,0,0),e=new s(0,0,0);return function(i,n,r){const s=this._keyValue.getValue();let a=this._key.length>1?Math.floor(this._keyValue.length/this._key.length):0;this._value_changed.length=a;const u=this._value_changed.getValue();n=(i*=a)+a,i*=3,n*=3,a*=3;for(let l=0;l<a;l+=3)try{const a=l+1,c=l+2;t.set(s[i+l],s[i+a],s[i+c]),e.set(s[n+l],s[n+a],s[n+c]);const h=o.simpleSlerp(t,e,r);u[l]=h[0],u[a]=h[1],u[c]=h[2]}catch(t){}this._value_changed.addEvent()}}()}),a})),define("x_ite/Components/Interpolation/PositionInterpolator2D",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector2"],(function(t,e,i,n,r,s){"use strict";function o(t){n.call(this,t),this.addType(r.PositionInterpolator2D)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOnly,"set_fraction",new t.SFFloat),new e(r.inputOutput,"key",new t.MFFloat),new e(r.inputOutput,"keyValue",new t.MFVec2f),new e(r.outputOnly,"value_changed",new t.SFVec2f)]),getTypeName:function(){return"PositionInterpolator2D"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this._keyValue.addInterest("set_keyValue__",this)},set_keyValue__:function(){const e=this._key,i=this._keyValue;i.length<e.length&&i.resize(e.length,i.length?i[i.length-1]:new t.SFVec2f)},interpolate:function(){const t=new s(0,0);return function(e,i,n){this._value_changed=t.assign(this._keyValue[e].getValue()).lerp(this._keyValue[i].getValue(),n)}}()}),o})),define("x_ite/Browser/Interpolation/CatmullRomSplineInterpolator",["standard/Math/Numbers/Vector4","standard/Math/Numbers/Matrix4"],(function(t,e){"use strict";const i=[],n=[],r=[],s=new t(0,0,0,0),o=new e(2,-2,1,1,-3,3,-2,-1,0,0,1,0,1,0,0,0);function a(){this.T0=[],this.T1=[]}return a.prototype={constructor:a,generate:function(t,e,s,o,a){const u=this.T0,l=this.T1;if(u.length=0,l.length=0,i.length=0,n.length=0,r.length=0,e.length>1){if(0===o.length){t?i.push(this.divide(this.subtract(s[1],s[s.length-2]),2)):i.push(this.create());for(let t=1,e=s.length-1;t<e;++t)i.push(this.divide(this.subtract(s[t+1],s[t-1]),2));i.push(this.copy(i[0]))}else{for(let t=0,e=o.length;t<e;++t)i.push(this.copy(o[t]));if(a){let t=0;for(let e=0,i=s.length-1;e<i;++e)t+=this.abs(this.subtract(s[e],s[e+1]));for(let e=0,n=i.length-1;e<n;++e){const n=this.abs(i[e]);n&&(i[e]=this.multiply(i[e],t/n))}}}if(t){const t=e.length-1,i=e.length-2,s=e[1]-e[0]+e[t]-e[i];r.push(2*(e[1]-e[0])/s),n.push(2*(e[t]-e[i])/s)}else r.push(1),n.push(1);for(let t=1,i=e.length-1;t<i;++t){const i=e[t+1]-e[t-1];r.push(2*(e[t+1]-e[t])/i),n.push(2*(e[t]-e[t-1])/i)}r.push(r[0]),n.push(n[0]);for(let t=0,e=i.length;t<e;++t)u.push(this.multiply(i[t],n[t])),l.push(this.multiply(i[t],r[t]))}else u.push(this.create()),l.push(this.create())},interpolate:function(t,e,i,n){return s.set(Math.pow(i,3),Math.pow(i,2),i,1),this.dot(o.multVecMatrix(s),n[t],n[e],this.T0[t],this.T1[e])}},a})),define("x_ite/Browser/Interpolation/CatmullRomSplineInterpolatorTemplate",["x_ite/Browser/Interpolation/CatmullRomSplineInterpolator"],(function(t){"use strict";return function(e){const i=new e(0,0,0,0),n=new e(0,0,0,0),r=new e(0,0,0,0),s=new e(0,0,0,0);function o(){this.T0=[],this.T1=[]}return o.prototype=Object.assign(Object.create(t.prototype),{constructor:o,create:function(){return new e(0,0,0,0)},copy:function(t){return t.copy()},subtract:function(t,i){return e.subtract(t,i)},multiply:function(t,i){return e.multiply(t,i)},divide:function(t,i){return e.divide(t,i)},abs:function(t){return t.magnitude()},dot:function(t,e,o,a,u){return i.assign(e).multiply(t[0]),n.assign(o).multiply(t[1]),r.assign(a).multiply(t[2]),s.assign(u).multiply(t[3]),i.add(n).add(r).add(s)}}),o}})),define("x_ite/Browser/Interpolation/CatmullRomSplineInterpolator3",["x_ite/Browser/Interpolation/CatmullRomSplineInterpolatorTemplate","standard/Math/Numbers/Vector3"],(function(t,e){"use strict";return t(e)})),define("x_ite/Components/Interpolation/SplinePositionInterpolator",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Browser/Interpolation/CatmullRomSplineInterpolator3","x_ite/Base/X3DConstants"],(function(t,e,i,n,r,s){"use strict";function o(t){n.call(this,t),this.addType(s.SplinePositionInterpolator),this.spline=new r}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.inputOnly,"set_fraction",new t.SFFloat),new e(s.inputOutput,"closed",new t.SFBool),new e(s.inputOutput,"key",new t.MFFloat),new e(s.inputOutput,"keyValue",new t.MFVec3f),new e(s.inputOutput,"keyVelocity",new t.MFVec3f),new e(s.inputOutput,"normalizeVelocity",new t.SFBool),new e(s.outputOnly,"value_changed",new t.SFVec3f)]),getTypeName:function(){return"SplinePositionInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this._keyValue.addInterest("set_keyValue__",this),this._keyVelocity.addInterest("set_keyVelocity__",this),this._normalizeVelocity.addInterest("set_normalizeVelocity__",this)},set_keyValue__:function(){const e=this._key,i=this._keyValue;i.length<e.length&&i.resize(e.length,i.length?i[i.length-1]:new t.SFVec3f),this.set_keyVelocity__()},set_keyVelocity__:function(){this._keyVelocity.length&&this._keyVelocity.length<this._key.length&&this._keyVelocity.resize(this._key.length,new t.SFVec3f),this.set_normalizeVelocity__()},set_normalizeVelocity__:function(){this.spline.generate(this._closed.getValue(),this._key,this._keyValue,this._keyVelocity,this._normalizeVelocity.getValue())},interpolate:function(t,e,i){this._value_changed=this.spline.interpolate(t,e,i,this._keyValue)}}),o})),define("x_ite/Browser/Interpolation/CatmullRomSplineInterpolator2",["x_ite/Browser/Interpolation/CatmullRomSplineInterpolatorTemplate","standard/Math/Numbers/Vector2"],(function(t,e){"use strict";return t(e)})),define("x_ite/Components/Interpolation/SplinePositionInterpolator2D",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Browser/Interpolation/CatmullRomSplineInterpolator2","x_ite/Base/X3DConstants"],(function(t,e,i,n,r,s){"use strict";function o(t){n.call(this,t),this.addType(s.SplinePositionInterpolator2D),this.spline=new r}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.inputOnly,"set_fraction",new t.SFFloat),new e(s.inputOutput,"closed",new t.SFBool),new e(s.inputOutput,"key",new t.MFFloat),new e(s.inputOutput,"keyValue",new t.MFVec2f),new e(s.inputOutput,"keyVelocity",new t.MFVec2f),new e(s.inputOutput,"normalizeVelocity",new t.SFBool),new e(s.outputOnly,"value_changed",new t.SFVec2f)]),getTypeName:function(){return"SplinePositionInterpolator2D"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this._keyValue.addInterest("set_keyValue__",this),this._keyVelocity.addInterest("set_keyVelocity__",this),this._normalizeVelocity.addInterest("set_normalizeVelocity__",this)},set_keyValue__:function(){const e=this._key,i=this._keyValue;i.length<e.length&&i.resize(e.length,i.length?i[i.length-1]:new t.SFVec2f),this.set_keyVelocity__()},set_keyVelocity__:function(){this._keyVelocity.length&&this._keyVelocity.length<this._key.length&&this._keyVelocity.resize(this._key.length,new t.SFVec2f),this.set_normalizeVelocity__()},set_normalizeVelocity__:function(){this.spline.generate(this._closed.getValue(),this._key,this._keyValue,this._keyVelocity,this._normalizeVelocity.getValue())},interpolate:function(t,e,i){this._value_changed=this.spline.interpolate(t,e,i,this._keyValue)}}),o})),define("x_ite/Browser/Interpolation/CatmullRomSplineInterpolator1",["x_ite/Browser/Interpolation/CatmullRomSplineInterpolator"],(function(t){"use strict";function e(){this.T0=[],this.T1=[]}return e.prototype=Object.assign(Object.create(t.prototype),{constructor:e,create:function(){return 0},copy:function(t){return t},subtract:function(t,e){return t-e},multiply:function(t,e){return t*e},divide:function(t,e){return t/e},abs:function(t){return Math.abs(t)},dot:function(t,e,i,n,r){return e*t[0]+i*t[1]+n*t[2]+r*t[3]}}),e})),define("x_ite/Components/Interpolation/SplineScalarInterpolator",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Browser/Interpolation/CatmullRomSplineInterpolator1","x_ite/Base/X3DConstants"],(function(t,e,i,n,r,s){"use strict";function o(t){n.call(this,t),this.addType(s.SplineScalarInterpolator),this.spline=new r}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.inputOnly,"set_fraction",new t.SFFloat),new e(s.inputOutput,"closed",new t.SFBool),new e(s.inputOutput,"key",new t.MFFloat),new e(s.inputOutput,"keyValue",new t.MFFloat),new e(s.inputOutput,"keyVelocity",new t.MFFloat),new e(s.inputOutput,"normalizeVelocity",new t.SFBool),new e(s.outputOnly,"value_changed",new t.SFFloat)]),getTypeName:function(){return"SplineScalarInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this._keyValue.addInterest("set_keyValue__",this),this._keyVelocity.addInterest("set_keyVelocity__",this),this._normalizeVelocity.addInterest("set_normalizeVelocity__",this)},set_keyValue__:function(){const e=this._key,i=this._keyValue;i.length<e.length&&i.resize(e.length,i.length?i[i.length-1]:new t.SFFloat),this.set_keyVelocity__()},set_keyVelocity__:function(){this._keyVelocity.length&&this._keyVelocity.length<this._key.length&&this._keyVelocity.resize(this._key.length,new t.SFFloat),this.set_normalizeVelocity__()},set_normalizeVelocity__:function(){this.spline.generate(this._closed.getValue(),this._key,this._keyValue,this._keyVelocity,this._normalizeVelocity.getValue())},interpolate:function(t,e,i){this._value_changed=this.spline.interpolate(t,e,i,this._keyValue)}}),o})),define("x_ite/Browser/Interpolation/SquatInterpolator",["standard/Math/Numbers/Rotation4"],(function(t){"use strict";const e=new t(0,0,1,0);function i(){this.s=[]}return i.prototype={constructor:i,generate:function(e,i,n){const r=this.s;if(r.length=0,i.length>1){e?r.push(t.spline(n[i.length-2].getValue(),n[0].getValue(),n[1].getValue())):r.push(n[0].getValue());for(let e=1,s=i.length-1;e<s;++e)r.push(t.spline(n[e-1].getValue(),n[e].getValue(),n[e+1].getValue()));e?r.push(t.spline(n[i.length-2].getValue(),n[i.length-1].getValue(),n[1].getValue())):r.push(n[i.length-1].getValue())}else i.length>0&&r.push(n[0].getValue().copy())},interpolate:function(t,i,n,r){return e.assign(r[t].getValue()).squad(this.s[t],this.s[i],r[i].getValue(),n)}},i})),define("x_ite/Components/Interpolation/SquadOrientationInterpolator",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Browser/Interpolation/SquatInterpolator","x_ite/Base/X3DConstants"],(function(t,e,i,n,r,s){"use strict";function o(t){n.call(this,t),this.addType(s.SquadOrientationInterpolator),this._keyValue.setUnit("angle"),this._value_changed.setUnit("angle"),this.squad=new r}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.inputOnly,"set_fraction",new t.SFFloat),new e(s.inputOutput,"closed",new t.SFBool),new e(s.inputOutput,"key",new t.MFFloat),new e(s.inputOutput,"keyValue",new t.MFRotation),new e(s.outputOnly,"value_changed",new t.SFRotation)]),getTypeName:function(){return"SquadOrientationInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this._keyValue.addInterest("set_keyValue__",this)},set_keyValue__:function(){const e=this._key,i=this._keyValue;i.length<e.length&&i.resize(e.length,i.length?i[i.length-1]:new t.SFRotation),this.squad.generate(this._closed.getValue(),this._key,this._keyValue)},interpolate:function(t,e,i){try{this._value_changed=this.squad.interpolate(t,e,i,this._keyValue)}catch(t){console.error(t)}}}),o})),define("x_ite/Components/Interpolation",["x_ite/Configuration/SupportedNodes","x_ite/Components/Interpolation/ColorInterpolator","x_ite/Components/Interpolation/CoordinateInterpolator","x_ite/Components/Interpolation/CoordinateInterpolator2D","x_ite/Components/Interpolation/EaseInEaseOut","x_ite/Components/Interpolation/NormalInterpolator","x_ite/Components/Interpolation/OrientationInterpolator","x_ite/Components/Interpolation/PositionInterpolator","x_ite/Components/Interpolation/PositionInterpolator2D","x_ite/Components/Interpolation/ScalarInterpolator","x_ite/Components/Interpolation/SplinePositionInterpolator","x_ite/Components/Interpolation/SplinePositionInterpolator2D","x_ite/Components/Interpolation/SplineScalarInterpolator","x_ite/Components/Interpolation/SquadOrientationInterpolator","x_ite/Components/Interpolation/X3DInterpolatorNode"],(function(t,e,i,n,r,s,o,a,u,l,c,h,d,p,f){"use strict";const g={ColorInterpolator:e,CoordinateInterpolator:i,CoordinateInterpolator2D:n,EaseInEaseOut:r,NormalInterpolator:s,OrientationInterpolator:o,PositionInterpolator:a,PositionInterpolator2D:u,ScalarInterpolator:l,SplinePositionInterpolator:c,SplinePositionInterpolator2D:h,SplineScalarInterpolator:d,SquadOrientationInterpolator:p},m={X3DInterpolatorNode:f};for(const e in g)t.addType(e,g[e]);for(const e in m)t.addAbstractType(e,m[e])})),define("x_ite/Components/Layering",["x_ite/Configuration/SupportedNodes","x_ite/Components/Layering/Layer","x_ite/Components/Layering/LayerSet","x_ite/Components/Layering/Viewport","x_ite/Components/Layering/X3DLayerNode","x_ite/Components/Layering/X3DViewportNode"],(function(t,e,i,n,r,s){"use strict";const o={Layer:e,LayerSet:i,Viewport:n},a={X3DLayerNode:r,X3DViewportNode:s};for(const e in o)t.addType(e,o[e]);for(const e in a)t.addAbstractType(e,a[e])})),define("x_ite/Components/Lighting/PointLight",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Lighting/X3DLightNode","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Rendering/TraverseType","x_ite/Base/X3DConstants","standard/Math/Geometry/Camera","standard/Math/Geometry/ViewVolume","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix3","standard/Math/Numbers/Matrix4","standard/Math/Utility/MatrixStack","standard/Math/Algorithm","standard/Utility/ObjectCache"],(function(t,e,i,n,r,s,o,a,u,l,c,h,d,p,f,g,m){"use strict";const _=[(new p).setRotation(new h(new l(1,0,0),l.zAxis)),(new p).setRotation(new h(new l(-1,0,0),l.zAxis)),(new p).setRotation(new h(new l(0,0,-1),l.zAxis)),(new p).setRotation(new h(new l(0,0,1),l.zAxis)),(new p).setRotation(new h(new l(0,1,0),l.zAxis)),(new p).setRotation(new h(new l(0,-1,0),l.zAxis))],y=[new c(0,.5,.25,.5),new c(.5,.5,.25,.5),new c(.75,.5,.25,.5),new c(.25,.5,.25,.5),new c(0,0,.5,.5),new c(.5,0,.5,.5)],x=m(w);function w(){this.location=new l(0,0,0),this.matrixArray=new Float32Array(9),this.shadowBuffer=null,this.viewVolume=new u,this.viewport=new c(0,0,0,0),this.projectionMatrix=new p,this.modelViewMatrix=new f(p),this.modelMatrix=new p,this.invLightSpaceMatrix=new p,this.invLightSpaceProjectionMatrix=new p,this.shadowMatrix=new p,this.shadowMatrixArray=new Float32Array(16),this.rotation=new h,this.rotationMatrix=new p,this.textureUnit=void 0}function b(t){n.call(this,t),this.addType(o.PointLight),this._location.setUnit("length"),this._radius.setUnit("length")}return w.prototype={constructor:w,getModelViewMatrix:function(){return this.modelViewMatrix},set:function(t,e,i,n){const r=e.getShadowMapSize();this.browser=t,this.lightNode=e,this.groupNode=i,this.matrixArray.set(n.submatrix.inverse()),this.modelViewMatrix.pushMatrix(n),e.getShadowIntensity()>0&&r>0&&(this.shadowBuffer=t.popShadowBuffer(r),this.shadowBuffer||console.warn("Couldn't create shadow buffer."))},renderShadowMap:function(t){if(!this.shadowBuffer)return;const e=this.lightNode,i=t.getCameraSpaceMatrix().get(),n=this.modelMatrix.assign(this.modelViewMatrix.get()).multRight(i),o=this.invLightSpaceMatrix.assign(e.getGlobal()?n:p.Identity);o.translate(e.getLocation()),o.inverse();const u=e.getShadowMapSize();this.shadowBuffer.bind();for(let e=0;e<6;++e){const i=y[e],n=this.viewport.set(i[0]*u,i[1]*u,i[2]*u,i[3]*u),l=a.perspective2(g.radians(90),.125,1e4,n[2],n[3],this.projectionMatrix);t.getViewVolumes().push(this.viewVolume.set(l,n,n)),t.getProjectionMatrix().pushMatrix(this.projectionMatrix),t.getModelViewMatrix().pushMatrix(_[e]),t.getModelViewMatrix().multLeft(o),t.render(s.SHADOW,r.prototype.traverse,this.groupNode),t.getModelViewMatrix().pop(),t.getProjectionMatrix().pop(),t.getViewVolumes().pop()}this.shadowBuffer.unbind(),e.getGlobal()||o.multLeft(n.inverse()),this.invLightSpaceProjectionMatrix.assign(o)},setGlobalVariables:function(t){this.modelViewMatrix.get().multVecMatrix(this.location.assign(this.lightNode._location.getValue())),this.shadowMatrix.assign(t.getCameraSpaceMatrix().get()).multRight(this.invLightSpaceProjectionMatrix),this.shadowMatrixArray.set(this.shadowMatrix)},setShaderUniforms:function(t,e){const i=e.numLights++;if(e.hasLight(i,this))return;const n=this.lightNode,r=n.getColor(),s=n.getAttenuation(),o=this.location;if(t.uniform1i(e.x3d_LightType[i],2),t.uniform3f(e.x3d_LightColor[i],r.r,r.g,r.b),t.uniform1f(e.x3d_LightIntensity[i],n.getIntensity()),t.uniform1f(e.x3d_LightAmbientIntensity[i],n.getAmbientIntensity()),t.uniform3f(e.x3d_LightAttenuation[i],Math.max(0,s.x),Math.max(0,s.y),Math.max(0,s.z)),t.uniform3f(e.x3d_LightLocation[i],o.x,o.y,o.z),t.uniform1f(e.x3d_LightRadius[i],n.getRadius()),t.uniformMatrix3fv(e.x3d_LightMatrix[i],!1,this.matrixArray),this.shadowBuffer){const r=this.browser,s=n.getShadowColor();t.uniform3f(e.x3d_ShadowColor[i],s.r,s.g,s.b),t.uniform1f(e.x3d_ShadowIntensity[i],n.getShadowIntensity()),t.uniform1f(e.x3d_ShadowBias[i],n.getShadowBias()),t.uniformMatrix4fv(e.x3d_ShadowMatrix[i],!1,this.shadowMatrixArray),t.uniform1i(e.x3d_ShadowMapSize[i],n.getShadowMapSize()),this.textureUnit=n.getGlobal()?void 0===this.textureUnit?r.popTexture2DUnit():this.textureUnit:r.getTexture2DUnit(),void 0!==this.textureUnit?(t.activeTexture(t.TEXTURE0+this.textureUnit),t.getVersion()>=2||t.getExtension("WEBGL_depth_texture")?t.bindTexture(t.TEXTURE_2D,this.shadowBuffer.getDepthTexture()):t.bindTexture(t.TEXTURE_2D,this.shadowBuffer.getColorTexture()),t.uniform1i(e.x3d_ShadowMap[i],this.textureUnit)):console.warn("Not enough combined texture units for shadow map available.")}},dispose:function(){this.browser.pushShadowBuffer(this.shadowBuffer),this.lightNode.getGlobal()&&this.browser.pushTexture2DUnit(this.textureUnit),this.modelViewMatrix.clear(),this.browser=null,this.lightNode=null,this.groupNode=null,this.shadowBuffer=null,this.textureUnit=void 0,x.push(this)}},b.prototype=Object.assign(Object.create(n.prototype),{constructor:b,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.inputOutput,"global",new t.SFBool(!0)),new e(o.inputOutput,"on",new t.SFBool(!0)),new e(o.inputOutput,"color",new t.SFColor(1,1,1)),new e(o.inputOutput,"intensity",new t.SFFloat(1)),new e(o.inputOutput,"ambientIntensity",new t.SFFloat),new e(o.inputOutput,"attenuation",new t.SFVec3f(1,0,0)),new e(o.inputOutput,"location",new t.SFVec3f),new e(o.inputOutput,"radius",new t.SFFloat(100)),new e(o.inputOutput,"shadows",new t.SFBool),new e(o.inputOutput,"shadowColor",new t.SFColor),new e(o.inputOutput,"shadowIntensity",new t.SFFloat(1)),new e(o.inputOutput,"shadowBias",new t.SFFloat(.005)),new e(o.initializeOnly,"shadowMapSize",new t.SFInt32(1024))]),getTypeName:function(){return"PointLight"},getComponentName:function(){return"Lighting"},getContainerField:function(){return"children"},getAttenuation:function(){return this._attenuation.getValue()},getLocation:function(){return this._location.getValue()},getRadius:function(){return Math.max(0,this._radius.getValue())},getLights:function(){return x}}),b})),define("x_ite/Components/Lighting/SpotLight",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Lighting/X3DLightNode","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Rendering/TraverseType","x_ite/Base/X3DConstants","standard/Math/Geometry/Box3","standard/Math/Geometry/Camera","standard/Math/Geometry/ViewVolume","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix3","standard/Math/Numbers/Matrix4","standard/Math/Utility/MatrixStack","standard/Math/Algorithm","standard/Utility/ObjectCache"],(function(t,e,i,n,r,s,o,a,u,l,c,h,d,p,f,g,m,_){"use strict";const y=_(x);function x(){this.location=new c(0,0,0),this.direction=new c(0,0,0),this.matrixArray=new Float32Array(9),this.renderShadow=!0,this.shadowBuffer=null,this.bbox=new a,this.viewVolume=new l,this.viewport=new h(0,0,0,0),this.projectionMatrix=new f,this.modelViewMatrix=new g(f),this.modelMatrix=new f,this.invLightSpaceMatrix=new f,this.invLightSpaceProjectionMatrix=new f,this.shadowMatrix=new f,this.shadowMatrixArray=new Float32Array(16),this.rotation=new d,this.lightBBoxMin=new c(0,0,0),this.lightBBoxMax=new c(0,0,0),this.textureUnit=void 0}function w(t){switch(n.call(this,t),this.addType(o.SpotLight),t.getSpecificationVersion()){case"2.0":case"3.0":case"3.1":case"3.2":this._beamWidth=1.5708,this._cutOffAngle=.785398}this._location.setUnit("length"),this._radius.setUnit("length"),this._beamWidth.setUnit("angle"),this._cutOffAngle.setUnit("angle")}return x.prototype={constructor:x,getModelViewMatrix:function(){return this.modelViewMatrix},set:function(t,e,i,n){const r=e.getShadowMapSize();this.browser=t,this.lightNode=e,this.groupNode=i,this.matrixArray.set(n.submatrix.inverse()),this.modelViewMatrix.pushMatrix(n),e.getShadowIntensity()>0&&r>0&&(this.shadowBuffer=t.popShadowBuffer(r),this.shadowBuffer||console.warn("Couldn't create shadow buffer."))},renderShadowMap:function(t){if(!this.shadowBuffer)return;const e=this.lightNode,i=t.getCameraSpaceMatrix().get(),n=this.modelMatrix.assign(this.modelViewMatrix.get()).multRight(i),o=this.invLightSpaceMatrix.assign(e.getGlobal()?n:f.Identity);o.translate(e.getLocation()),o.rotate(this.rotation.setFromToVec(c.zAxis,this.direction.assign(e.getDirection()).negate())),o.inverse();this.groupNode.getSubBBox(this.bbox,!0).multRight(o).getExtents(this.lightBBoxMin,this.lightBBoxMax);const a=e.getShadowMapSize(),l=Math.min(e.getRadius(),-this.lightBBoxMin.z),h=this.viewport.set(0,0,a,a),d=u.perspective(2*e.getCutOffAngle(),.125,Math.max(1e4,l),a,a,this.projectionMatrix);this.renderShadow=l>0,this.shadowBuffer.bind(),t.getViewVolumes().push(this.viewVolume.set(d,h,h)),t.getProjectionMatrix().pushMatrix(d),t.getModelViewMatrix().pushMatrix(o),t.render(s.SHADOW,r.prototype.traverse,this.groupNode),t.getModelViewMatrix().pop(),t.getProjectionMatrix().pop(),t.getViewVolumes().pop(),this.shadowBuffer.unbind(),e.getGlobal()||o.multLeft(n.inverse()),this.invLightSpaceProjectionMatrix.assign(o).multRight(d).multRight(e.getBiasMatrix())},setGlobalVariables:function(t){const e=this.lightNode,i=this.modelViewMatrix.get();i.multVecMatrix(this.location.assign(e._location.getValue())),i.multDirMatrix(this.direction.assign(e._direction.getValue())).normalize(),this.shadowMatrix.assign(t.getCameraSpaceMatrix().get()).multRight(this.invLightSpaceProjectionMatrix),this.shadowMatrixArray.set(this.shadowMatrix)},setShaderUniforms:function(t,e){const i=e.numLights++;if(e.hasLight(i,this))return;const n=this.lightNode,r=n.getColor(),s=n.getAttenuation(),o=this.location,a=this.direction;if(t.uniform1i(e.x3d_LightType[i],3),t.uniform3f(e.x3d_LightColor[i],r.r,r.g,r.b),t.uniform1f(e.x3d_LightIntensity[i],n.getIntensity()),t.uniform1f(e.x3d_LightAmbientIntensity[i],n.getAmbientIntensity()),t.uniform3f(e.x3d_LightAttenuation[i],Math.max(0,s.x),Math.max(0,s.y),Math.max(0,s.z)),t.uniform3f(e.x3d_LightLocation[i],o.x,o.y,o.z),t.uniform3f(e.x3d_LightDirection[i],a.x,a.y,a.z),t.uniform1f(e.x3d_LightRadius[i],n.getRadius()),t.uniform1f(e.x3d_LightBeamWidth[i],n.getBeamWidth()),t.uniform1f(e.x3d_LightCutOffAngle[i],n.getCutOffAngle()),t.uniformMatrix3fv(e.x3d_LightMatrix[i],!1,this.matrixArray),this.renderShadow&&this.shadowBuffer){const r=this.browser,s=n.getShadowColor();t.uniform3f(e.x3d_ShadowColor[i],s.r,s.g,s.b),t.uniform1f(e.x3d_ShadowIntensity[i],n.getShadowIntensity()),t.uniform1f(e.x3d_ShadowBias[i],n.getShadowBias()),t.uniformMatrix4fv(e.x3d_ShadowMatrix[i],!1,this.shadowMatrixArray),t.uniform1i(e.x3d_ShadowMapSize[i],n.getShadowMapSize()),this.textureUnit=n.getGlobal()?void 0===this.textureUnit?r.popTexture2DUnit():this.textureUnit:r.getTexture2DUnit(),void 0!==this.textureUnit?(t.activeTexture(t.TEXTURE0+this.textureUnit),t.getVersion()>=2||t.getExtension("WEBGL_depth_texture")?t.bindTexture(t.TEXTURE_2D,this.shadowBuffer.getDepthTexture()):t.bindTexture(t.TEXTURE_2D,this.shadowBuffer.getColorTexture()),t.uniform1i(e.x3d_ShadowMap[i],this.textureUnit)):console.warn("Not enough combined texture units for shadow map available.")}},dispose:function(){this.browser.pushShadowBuffer(this.shadowBuffer),this.lightNode.getGlobal()&&this.browser.pushTexture2DUnit(this.textureUnit),this.modelViewMatrix.clear(),this.browser=null,this.lightNode=null,this.groupNode=null,this.shadowBuffer=null,this.textureUnit=void 0,y.push(this)}},w.prototype=Object.assign(Object.create(n.prototype),{constructor:w,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.inputOutput,"global",new t.SFBool(!0)),new e(o.inputOutput,"on",new t.SFBool(!0)),new e(o.inputOutput,"color",new t.SFColor(1,1,1)),new e(o.inputOutput,"intensity",new t.SFFloat(1)),new e(o.inputOutput,"ambientIntensity",new t.SFFloat),new e(o.inputOutput,"attenuation",new t.SFVec3f(1,0,0)),new e(o.inputOutput,"location",new t.SFVec3f),new e(o.inputOutput,"direction",new t.SFVec3f(0,0,-1)),new e(o.inputOutput,"radius",new t.SFFloat(100)),new e(o.inputOutput,"beamWidth",new t.SFFloat(.785398)),new e(o.inputOutput,"cutOffAngle",new t.SFFloat(1.5708)),new e(o.inputOutput,"shadows",new t.SFBool),new e(o.inputOutput,"shadowColor",new t.SFColor),new e(o.inputOutput,"shadowIntensity",new t.SFFloat(1)),new e(o.inputOutput,"shadowBias",new t.SFFloat(.005)),new e(o.initializeOnly,"shadowMapSize",new t.SFInt32(1024))]),getTypeName:function(){return"SpotLight"},getComponentName:function(){return"Lighting"},getContainerField:function(){return"children"},getAttenuation:function(){return this._attenuation.getValue()},getLocation:function(){return this._location.getValue()},getRadius:function(){return Math.max(0,this._radius.getValue())},getBeamWidth:function(){const t=this._beamWidth.getValue(),e=this.getCutOffAngle();return t>e?e:m.clamp(t,0,Math.PI/2)},getCutOffAngle:function(){return m.clamp(this._cutOffAngle.getValue(),0,Math.PI/2)},getLights:function(){return y}}),w})),define("x_ite/Components/Lighting",["x_ite/Configuration/SupportedNodes","x_ite/Components/Lighting/DirectionalLight","x_ite/Components/Lighting/PointLight","x_ite/Components/Lighting/SpotLight","x_ite/Components/Lighting/X3DLightNode"],(function(t,e,i,n,r){"use strict";const s={DirectionalLight:e,PointLight:i,SpotLight:n},o={X3DLightNode:r};for(const e in s)t.addType(e,s[e]);for(const e in o)t.addAbstractType(e,o[e])})),define("x_ite/Components/Navigation/Billboard",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Base/X3DConstants","x_ite/Rendering/TraverseType","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4"],(function(t,e,i,n,r,s,o,a,u){"use strict";function l(t){n.call(this,t),this.addType(r.Billboard),this.matrix=new u}return l.prototype=Object.assign(Object.create(n.prototype),{constructor:l,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"axisOfRotation",new t.SFVec3f(0,1,0)),new e(r.inputOutput,"visible",new t.SFBool(!0)),new e(r.inputOutput,"bboxDisplay",new t.SFBool),new e(r.initializeOnly,"bboxSize",new t.SFVec3f(-1,-1,-1)),new e(r.initializeOnly,"bboxCenter",new t.SFVec3f),new e(r.inputOnly,"addChildren",new t.MFNode),new e(r.inputOnly,"removeChildren",new t.MFNode),new e(r.inputOutput,"children",new t.MFNode)]),getTypeName:function(){return"Billboard"},getComponentName:function(){return"Navigation"},getContainerField:function(){return"children"},getBBox:function(t,e){return n.prototype.getBBox.call(this,t,e).multRight(this.matrix)},getMatrix:function(){return this.matrix},rotate:function(){const t=new u,e=new o(0,0,0),i=new o(0,0,0),n=new o(0,0,0),r=new o(0,0,0),s=new a(0,0,1,0);return function(a){t.assign(a).inverse();const u=t.origin.normalize();if(this._axisOfRotation.getValue().equals(o.Zero)){t.multDirMatrix(e.assign(o.yAxis)).normalize();const n=e.cross(u);i.assign(u).cross(n);const r=u;n.normalize(),i.normalize(),this.matrix.set(n.x,n.y,n.z,0,i.x,i.y,i.z,0,r.x,r.y,r.z,0,0,0,0,1)}else n.assign(this._axisOfRotation.getValue()).cross(u),r.assign(this._axisOfRotation.getValue()).cross(o.zAxis),this.matrix.setRotation(s.setFromToVec(r,n));return this.matrix}}(),traverse:function(t,e){const i=e.getModelViewMatrix();switch(i.push(),t){case s.CAMERA:case s.PICKING:case s.SHADOW:i.multLeft(this.matrix);break;default:i.multLeft(this.rotate(i.get()))}n.prototype.traverse.call(this,t,e),i.pop()}}),l})),define("x_ite/Components/Navigation/Collision",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Components/Core/X3DSensorNode","x_ite/Base/X3DCast","x_ite/Rendering/TraverseType","x_ite/Base/X3DConstants"],(function(t,e,i,n,r,s,o,a){"use strict";function u(t){n.call(this,t),r.call(this,t),this.addType(a.Collision),"2.0"===t.getSpecificationVersion()&&this.addAlias("collide",this._enabled)}return u.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:u,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(a.inputOutput,"metadata",new t.SFNode),new e(a.inputOutput,"enabled",new t.SFBool(!0)),new e(a.outputOnly,"isActive",new t.SFBool),new e(a.outputOnly,"collideTime",new t.SFTime),new e(a.inputOutput,"visible",new t.SFBool(!0)),new e(a.inputOutput,"bboxDisplay",new t.SFBool),new e(a.initializeOnly,"bboxSize",new t.SFVec3f(-1,-1,-1)),new e(a.initializeOnly,"bboxCenter",new t.SFVec3f),new e(a.initializeOnly,"proxy",new t.SFNode),new e(a.inputOnly,"addChildren",new t.MFNode),new e(a.inputOnly,"removeChildren",new t.MFNode),new e(a.inputOutput,"children",new t.MFNode)]),getTypeName:function(){return"Collision"},getComponentName:function(){return"Navigation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.isLive().addInterest("set_live__",this),this._enabled.addInterest("set_live__",this),this._proxy.addInterest("set_proxy__",this),this.set_live__(),this.set_proxy__()},set_live__:function(){this.isLive().getValue()&&this._enabled.getValue()?this.getBrowser().addCollision(this):this.getBrowser().removeCollision(this)},set_active:function(t){this._isActive.getValue()!==t&&(this._isActive=t,t&&(this._collideTime=this.getBrowser().getCurrentTime()))},set_proxy__:function(){this.proxyNode=s(a.X3DChildNode,this._proxy)},traverse:function(t,e){if(t!==o.COLLISION)n.prototype.traverse.call(this,t,e);else if(this._enabled.getValue()){const i=e.getCollisions();i.push(this),this.proxyNode?this.proxyNode.traverse(t,e):n.prototype.traverse.call(this,t,e),i.pop()}}}),u})),define("x_ite/Components/Navigation/LOD",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Base/X3DCast","x_ite/Rendering/TraverseType","x_ite/Base/X3DConstants","standard/Math/Numbers/Matrix4","standard/Math/Algorithm"],(function(t,e,i,n,r,s,o,a,u){"use strict";function l(t){n.call(this,t),this.addType(o.LOD),"2.0"===t.getSpecificationVersion()&&this.addAlias("level",this._children),this._center.setUnit("length"),this._range.setUnit("length"),this.frameRate=60,this.keepCurrentLevel=!1,this.childNode=null,this.visibleNode=null,this.boundedObject=null}return l.prototype=Object.assign(Object.create(n.prototype),{constructor:l,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.initializeOnly,"forceTransitions",new t.SFBool),new e(o.initializeOnly,"center",new t.SFVec3f),new e(o.initializeOnly,"range",new t.MFFloat),new e(o.outputOnly,"level_changed",new t.SFInt32(-1)),new e(o.inputOutput,"visible",new t.SFBool(!0)),new e(o.inputOutput,"bboxDisplay",new t.SFBool),new e(o.initializeOnly,"bboxSize",new t.SFVec3f(-1,-1,-1)),new e(o.initializeOnly,"bboxCenter",new t.SFVec3f),new e(o.inputOnly,"addChildren",new t.MFNode),new e(o.inputOnly,"removeChildren",new t.MFNode),new e(o.inputOutput,"children",new t.MFNode)]),getTypeName:function(){return"LOD"},getComponentName:function(){return"Navigation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this._children.addInterest("set_child__",this)},getSubBBox:function(t,e){if(this._bboxSize.getValue().equals(this.getDefaultBBoxSize())){const i=r(o.X3DBoundedObject,this.visibleNode);return i?i.getBBox(t,e):t.set()}return t.set(this._bboxSize.getValue(),this._bboxCenter.getValue())},clear:function(){},add:function(){},remove:function(){},set_child__:function(){this.set_level__(Math.min(this._level_changed.getValue(),this._children.length-1))},set_level__:function(t){this.childNode&&(this.childNode._isCameraObject.removeInterest("set_cameraObject__",this),this.childNode._isPickableObject.removeInterest("set_transformSensors__",this)),r(o.X3DBoundedObject,this.childNode)&&(this.childNode._visible.removeInterest("set_visible__",this),this.childNode._bboxDisplay.removeInterest("set_bboxDisplay__",this)),t>=0&&t<this._children.length?(this.childNode=r(o.X3DChildNode,this._children[t]),this.childNode&&(this.childNode._isCameraObject.addInterest("set_cameraObject__",this),this.childNode._isPickableObject.addInterest("set_transformSensors__",this),r(o.X3DBoundedObject,this.childNode)&&(this.childNode._visible.addInterest("set_visible__",this),this.childNode._bboxDisplay.addInterest("set_bboxDisplay__",this)))):this.childNode=null,this.set_transformSensors__(),this.set_visible__(),this.set_bboxDisplay__()},set_cameraObject__:function(){this.childNode&&this.childNode.getCameraObject()?r(o.X3DBoundedObject,this.childNode)?this.setCameraObject(this.childNode._visible.getValue()):this.setCameraObject(!0):this.setCameraObject(!1)},set_transformSensors__:function(){this.setPickableObject(Boolean(this.getTransformSensors().size||this.childNode&&this.childNode.getPickableObject()))},set_visible__:function(){r(o.X3DBoundedObject,this.childNode)?this.visibleNode=this.childNode._visible.getValue()?this.childNode:null:this.visibleNode=this.childNode,this.set_cameraObject__()},set_bboxDisplay__:function(){r(o.X3DBoundedObject,this.childNode)?this.boundedObject=this.childNode._bboxDisplay.getValue()?this.childNode:null:this.boundedObject=null},getLevel:function(t,e){if(0===this._range.length){this.frameRate=(179*this.frameRate+t.currentFrameRate)/180;const e=this._children.length;switch(e){case 0:return-1;case 1:return 0;case 2:return+(this.frameRate>55);default:{const t=1-u.clamp((this.frameRate-20)/35,0,1);return Math.min(Math.floor(t*e),e-1)}}}const i=e.translate(this._center.getValue()).origin.magnitude();return u.upperBound(this._range,0,this._range.length,i)},traverse:function(){const t=new a;return function(e,i){switch(e){case s.POINTER:case s.CAMERA:case s.SHADOW:{const t=this.visibleNode;return void(t&&t.traverse(e,i))}case s.PICKING:{if(this.getTransformSensors().size){const t=i.getModelViewMatrix().get();for(const e of this.getTransformSensors())e.collect(t)}const t=this.childNode;if(t){const n=this.getBrowser().getPickingHierarchy();n.push(this),t.traverse(e,i),n.pop()}return}case s.COLLISION:{const t=this.childNode;return void(t&&t.traverse(e,i))}case s.DISPLAY:{if(!this.keepCurrentLevel){let e=this.getLevel(this.getBrowser(),t.assign(i.getModelViewMatrix().get())),n=this._level_changed.getValue();this._forceTransitions.getValue()&&(e>n?e=n+1:e<n&&(e=n-1)),e!==n&&(this._level_changed=e,this.set_level__(Math.min(e,this._children.length-1)))}const n=this.visibleNode;n&&n.traverse(e,i);const r=this.boundedObject;return void(r&&r.displayBBox(e,i))}}}}()}),l})),define("x_ite/Components/Navigation/ViewpointGroup",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Core/X3DChildNode","x_ite/Components/EnvironmentalSensor/ProximitySensor","x_ite/Rendering/TraverseType","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3"],(function(t,e,i,n,r,s,o,a){"use strict";function u(t){n.call(this,t),this.addType(o.ViewpointGroup),this._size.setUnit("length"),this._center.setUnit("length"),this.proximitySensor=new r(t),this.cameraObjects=[],this.viewpointGroups=[]}function l(t,e){switch(t){case s.CAMERA:if(this.proximitySensor.traverse(t,e),this.proximitySensor._isActive.getValue())for(var i=0,n=this.cameraObjects.length;i<n;++i)this.cameraObjects[i].traverse(t,e);return;case s.DISPLAY:if(this.proximitySensor.traverse(t,e),this.proximitySensor._isActive.getValue())for(i=0,n=this.viewpointGroups.length;i<n;++i)this.viewpointGroups[i].traverse(t,e);return}}function c(t,e){switch(t){case s.CAMERA:for(var i=0,n=this.cameraObjects.length;i<n;++i)this.cameraObjects[i].traverse(t,e);return;case s.DISPLAY:for(i=0,n=this.viewpointGroups.length;i<n;++i)this.viewpointGroups[i].traverse(t,e);return}}return u.prototype=Object.assign(Object.create(n.prototype),{constructor:u,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.inputOutput,"description",new t.SFString),new e(o.inputOutput,"displayed",new t.SFBool(!0)),new e(o.inputOutput,"retainUserOffsets",new t.SFBool),new e(o.inputOutput,"size",new t.SFVec3f),new e(o.inputOutput,"center",new t.SFVec3f),new e(o.inputOutput,"children",new t.MFNode)]),getTypeName:function(){return"ViewpointGroup"},getComponentName:function(){return"Navigation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.proximitySensor.setup(),this._size.addFieldInterest(this.proximitySensor._size),this._center.addFieldInterest(this.proximitySensor._center),this.proximitySensor._size=this._size,this.proximitySensor._center=this._center,this._displayed.addInterest("set_displayed__",this),this._size.addInterest("set_displayed__",this),this._children.addInterest("set_children__",this),this.set_displayed__(),this.set_children__()},isActive:function(){return this.proximitySensor._isActive.getValue()},set_displayed__:function(){var t=!this._size.getValue().equals(a.Zero),e=this._displayed.getValue();this.proximitySensor._enabled=e&&t,e&&t?(this.proximitySensor._isCameraObject.addFieldInterest(this._isCameraObject),this.proximitySensor._isPickableObject.addFieldInterest(this._isPickableObject),this.setCameraObject(this.proximitySensor.getCameraObject()),this.setPickableObject(this.proximitySensor.getPickableObject()),this.traverse=l):(this.proximitySensor._isCameraObject.removeFieldInterest(this._isCameraObject),this.proximitySensor._isPickableObject.removeFieldInterest(this._isPickableObject),this.setCameraObject(e),this.setPickableObject(!1),e?this.traverse=c:delete this.traverse)},set_children__:function(){this.cameraObjects.length=0,this.viewpointGroups.length=0;for(var t=this._children,e=0,i=t.length;e<i;++e)try{for(var n=t[e].getValue().getInnerNode(),r=n.getType(),s=r.length-1;s>=0;--s)switch(r[s]){case o.X3DViewpointNode:this.cameraObjects.push(n);break;case o.ViewpointGroup:this.cameraObjects.push(n),this.viewpointGroups.push(n)}}catch(t){}},traverse:function(){}}),u})),define("x_ite/Components/Navigation",["x_ite/Configuration/SupportedNodes","x_ite/Components/Navigation/Billboard","x_ite/Components/Navigation/Collision","x_ite/Components/Navigation/LOD","x_ite/Components/Navigation/NavigationInfo","x_ite/Components/Navigation/OrthoViewpoint","x_ite/Components/Navigation/Viewpoint","x_ite/Components/Navigation/ViewpointGroup","x_ite/Components/Navigation/X3DViewpointNode"],(function(t,e,i,n,r,s,o,a,u){"use strict";const l={Billboard:e,Collision:i,LOD:n,NavigationInfo:r,OrthoViewpoint:s,Viewpoint:o,ViewpointGroup:a},c={X3DViewpointNode:u};for(const e in l)t.addType(e,l[e]);for(const e in c)t.addAbstractType(e,c[e])})),define("x_ite/Browser/PointingDeviceSensor/PointingDeviceSensorContainer",["standard/Math/Numbers/Vector4","standard/Math/Numbers/Matrix4"],(function(t,e){"use strict";function i(i,n,r,s){this.node=null,this.modelViewMatrix=new e,this.projectionMatrix=new e,this.viewport=new t(0,0,0,0),this.set(i,n,r,s)}return i.prototype={set:function(t,e,i,n){this.node=t,this.modelViewMatrix.assign(e),this.projectionMatrix.assign(i),this.viewport.assign(n)},set_over__:function(t,e){this.node.set_over__(t,e,this.modelViewMatrix,this.projectionMatrix,this.viewport)},set_active__:function(t,e){this.node.set_active__(t,e,this.modelViewMatrix,this.projectionMatrix,this.viewport)},set_motion__:function(t){this.node.set_motion__(t,this.modelViewMatrix,this.projectionMatrix,this.viewport)}},i})),define("x_ite/Components/PointingDeviceSensor/X3DPointingDeviceSensorNode",["x_ite/Components/Core/X3DSensorNode","x_ite/Browser/PointingDeviceSensor/PointingDeviceSensorContainer","x_ite/Base/X3DConstants"],(function(t,e,i){"use strict";function n(e){t.call(this,e),this.addType(i.X3DPointingDeviceSensorNode)}return n.prototype=Object.assign(Object.create(t.prototype),{constructor:n,initialize:function(){t.prototype.initialize.call(this),this._enabled.addInterest("set_enabled__",this)},getMatrices:function(){return this.matrices},set_enabled__:function(){this._enabled.getValue()||(this._isActive.getValue()&&(this._isActive=!1),this._isOver.getValue()&&(this._isOver=!1))},set_over__:function(t,e){t!==this._isOver.getValue()&&(this._isOver=t,t&&(this.getBrowser().getNotification()._string=this._description))},set_active__:function(t,e){t!==this._isActive.getValue()&&(this._isActive=t)},set_motion__:function(t){},push:function(t,i){this._enabled.getValue()&&i.set(this,new e(this,t.getModelViewMatrix().get(),t.getProjectionMatrix().get(),t.getViewVolume().getViewport()))}}),n})),define("x_ite/Components/PointingDeviceSensor/X3DTouchSensorNode",["x_ite/Components/PointingDeviceSensor/X3DPointingDeviceSensorNode","x_ite/Base/X3DConstants"],(function(t,e){"use strict";function i(i){t.call(this,i),this.addType(e.X3DTouchSensorNode)}return i.prototype=Object.assign(Object.create(t.prototype),{constructor:i,set_active__:function(e,i){t.prototype.set_active__.call(this,e,i),this._enabled.getValue()&&this._isOver.getValue()&&!e&&(this._touchTime=this.getBrowser().getCurrentTime())}}),i})),define("x_ite/Components/PointingDeviceSensor/TouchSensor",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/PointingDeviceSensor/X3DTouchSensorNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Matrix4"],(function(t,e,i,n,r,s){"use strict";var o=new s;function a(t){n.call(this,t),this.addType(r.TouchSensor),this._hitPoint_changed.setUnit("length")}return a.prototype=Object.assign(Object.create(n.prototype),{constructor:a,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"description",new t.SFString),new e(r.inputOutput,"enabled",new t.SFBool(!0)),new e(r.outputOnly,"hitTexCoord_changed",new t.SFVec2f),new e(r.outputOnly,"hitNormal_changed",new t.SFVec3f),new e(r.outputOnly,"hitPoint_changed",new t.SFVec3f),new e(r.outputOnly,"isOver",new t.SFBool),new e(r.outputOnly,"isActive",new t.SFBool),new e(r.outputOnly,"touchTime",new t.SFTime)]),getTypeName:function(){return"TouchSensor"},getComponentName:function(){return"PointingDeviceSensor"},getContainerField:function(){return"children"},set_over__:function(t,e,i,r,s){if(n.prototype.set_over__.call(this,t,e,i,r,s),this._isOver.getValue()){var a=e.intersection;o.assign(i).inverse(),this._hitTexCoord_changed=a.texCoord,this._hitNormal_changed=i.multMatrixDir(a.normal.copy()).normalize(),this._hitPoint_changed=o.multVecMatrix(a.point.copy())}}}),a})),define("x_ite/Components/Networking/Anchor",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Components/Networking/X3DUrlObject","x_ite/Components/PointingDeviceSensor/TouchSensor","x_ite/Rendering/TraverseType","x_ite/Base/X3DConstants","x_ite/InputOutput/FileLoader"],(function(t,e,i,n,r,s,o,a,u){"use strict";function l(t){n.call(this,t),r.call(this,t),this.addType(a.Anchor),this.touchSensorNode=new s(t),this.anchorSensors=new Map}return l.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:l,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(a.inputOutput,"metadata",new t.SFNode),new e(a.inputOutput,"description",new t.SFString),new e(a.inputOutput,"load",new t.SFBool(!0)),new e(a.inputOutput,"url",new t.MFString),new e(a.inputOutput,"parameter",new t.MFString),new e(a.inputOutput,"autoRefresh",new t.SFTime),new e(a.inputOutput,"autoRefreshTimeLimit",new t.SFTime(3600)),new e(a.inputOutput,"visible",new t.SFBool(!0)),new e(a.inputOutput,"bboxDisplay",new t.SFBool),new e(a.initializeOnly,"bboxSize",new t.SFVec3f(-1,-1,-1)),new e(a.initializeOnly,"bboxCenter",new t.SFVec3f),new e(a.inputOnly,"addChildren",new t.MFNode),new e(a.inputOnly,"removeChildren",new t.MFNode),new e(a.inputOutput,"children",new t.MFNode)]),getTypeName:function(){return"Anchor"},getComponentName:function(){return"Networking"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),r.prototype.initialize.call(this),this._description.addFieldInterest(this.touchSensorNode._description),this._load.addFieldInterest(this.touchSensorNode._enabled),this.touchSensorNode._description=this._description,this.touchSensorNode._enabled=this._load,this.touchSensorNode.setup();const t=this,e=this.touchSensorNode.set_active__;this.touchSensorNode.set_active__=function(i,n){e.call(this,i,n),this._isOver.getValue()&&!i&&t.requestImmediateLoad()}},set_load__:function(){},set_url__:function(){},requestImmediateLoad:function(t=!0){this.setCache(t),this.setLoadState(a.IN_PROGRESS_STATE,!1),new u(this).createX3DFromURL(this._url,this._parameter,function(t){t?(this.getBrowser().replaceWorld(t),this.setLoadState(a.COMPLETE_STATE,!1)):this.setLoadState(a.FAILED_STATE,!1)}.bind(this),function(t){this.getBrowser().changeViewpoint(t),this.setLoadState(a.COMPLETE_STATE,!1)}.bind(this),function(t,e){e?window.open(t,e):location=t,this.setLoadState(a.COMPLETE_STATE,!1)}.bind(this))},requestUnload(){},traverse:function(t,e){if(t===o.POINTER){const i=this.getBrowser().getSensors(),r=this.anchorSensors;r.clear(),this.touchSensorNode.push(e,r),r.size?(i.push(r),n.prototype.traverse.call(this,t,e),i.pop()):n.prototype.traverse.call(this,t,e)}else n.prototype.traverse.call(this,t,e)}}),l})),define("x_ite/Components/Networking/Inline",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Core/X3DChildNode","x_ite/Components/Networking/X3DUrlObject","x_ite/Components/Grouping/X3DBoundedObject","x_ite/Components/Grouping/Group","x_ite/Rendering/TraverseType","x_ite/Base/X3DConstants","x_ite/InputOutput/FileLoader"],(function(t,e,i,n,r,s,o,a,u,l){"use strict";function c(t){n.call(this,t),r.call(this,t),s.call(this,t),this.addType(u.Inline),this.scene=this.getBrowser().getDefaultScene(),this.group=new o(t),this.group.addParent(this)}return c.prototype=Object.assign(Object.create(n.prototype),r.prototype,s.prototype,{constructor:c,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(u.inputOutput,"metadata",new t.SFNode),new e(u.inputOutput,"load",new t.SFBool(!0)),new e(u.inputOutput,"url",new t.MFString),new e(u.inputOutput,"autoRefresh",new t.SFTime),new e(u.inputOutput,"autoRefreshTimeLimit",new t.SFTime(3600)),new e(u.inputOutput,"visible",new t.SFBool(!0)),new e(u.inputOutput,"bboxDisplay",new t.SFBool),new e(u.initializeOnly,"bboxSize",new t.SFVec3f(-1,-1,-1)),new e(u.initializeOnly,"bboxCenter",new t.SFVec3f)]),getTypeName:function(){return"Inline"},getComponentName:function(){return"Networking"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),r.prototype.initialize.call(this),s.prototype.initialize.call(this),this.group.setPrivate(!0),this.group.setup(),this.group._isCameraObject.addFieldInterest(this._isCameraObject),this.group._isPickableObject.addFieldInterest(this._isPickableObject),this.requestImmediateLoad()},getBBox:function(t,e){return this._bboxSize.getValue().equals(this.getDefaultBBoxSize())?this.group.getBBox(t,e):t.set(this._bboxSize.getValue(),this._bboxCenter.getValue())},set_live__:function(){r.prototype.set_live__.call(this),this.getPrivate()||this.scene.setLive(this.isLive().getValue())},unloadNow:function(){this.setInternalScene(this.getBrowser().getDefaultScene())},loadNow:function(){new l(this).createX3DFromURL(this._url,null,this.setInternalSceneAsync.bind(this))},setInternalSceneAsync:function(t){t?(this.setLoadState(u.COMPLETE_STATE),this.setInternalScene(t)):(this.setLoadState(u.FAILED_STATE),this.setInternalScene(this.getBrowser().getDefaultScene()))},setInternalScene:function(t){this.scene.setLive(!1),this.scene.rootNodes.removeFieldInterest(this.group._children),this.scene=t,this.scene.setExecutionContext(this.getExecutionContext()),this.scene.setPrivate(this.getExecutionContext().getPrivate()),this.scene.rootNodes.addFieldInterest(this.group._children),this.group._children=this.scene.rootNodes,this.set_live__(),this.getBrowser().addBrowserEvent()},getInternalScene:function(){return this.scene},traverse:function(t,e){if(t===a.PICKING){const i=this.getBrowser().getPickingHierarchy();return i.push(this),this.group.traverse(t,e),void i.pop()}this.group.traverse(t,e)}}),c})),define("x_ite/Components/Networking",["x_ite/Configuration/SupportedNodes","x_ite/Components/Networking/Anchor","x_ite/Components/Networking/Inline","x_ite/Components/Networking/LoadSensor","x_ite/Components/Networking/X3DNetworkSensorNode","x_ite/Components/Networking/X3DUrlObject"],(function(t,e,i,n,r,s){"use strict";const o={Anchor:e,Inline:i,LoadSensor:n},a={X3DNetworkSensorNode:r,X3DUrlObject:s};for(const e in o)t.addType(e,o[e]);for(const e in a)t.addAbstractType(e,a[e])})),define("x_ite/Components/PointingDeviceSensor/X3DDragSensorNode",["x_ite/Components/PointingDeviceSensor/X3DPointingDeviceSensorNode","x_ite/Base/X3DConstants"],(function(t,e){"use strict";function i(i){t.call(this,i),this.addType(e.X3DDragSensorNode),this._trackPoint_changed.setUnit("length")}return i.prototype=Object.assign(Object.create(t.prototype),{constructor:i}),i})),define("standard/Math/Geometry/Cylinder3",["standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Line3"],(function(t,e,i,n){"use strict";function r(t,e){this.axis=t.copy(),this.radius=e}return r.prototype={constructor:r,intersectsLine:function(r,s,o){const a=new e(this.axis.direction,new t(0,1,0)),u=i.Rotation(a),l=1/this.radius,c=new i;c.scale(new t(l,l,l)),c.multLeft(u);const h=t.subtract(r.point,this.axis.point),d=new n(h,r.direction).multLineMatrix(c),p=this.unitCylinderIntersectsLine(d,s,o);if(p){const t=c.inverse();t.multVecMatrix(s),s.add(this.axis.point),t.multVecMatrix(o),o.add(this.axis.point)}return p},unitCylinderIntersectsLine:function(t,e,i){let n,r;const s=t.point,o=t.direction,a=o[0]*o[0]+o[2]*o[2],u=2*(s[0]*o[0]+s[2]*o[2]),l=s[0]*s[0]+s[2]*s[2]-1,c=u*u-4*a*l;if(c<0)return!1;const h=Math.sqrt(c);return u>0?(n=-2*l/(h+u),r=-(h+u)/(2*a)):(n=2*l/(h-u),r=(h-u)/(2*a)),e.assign(o).multiply(n).add(s),i.assign(o).multiply(r).add(s),!0},toString:function(){return this.axis.toString()+" "+this.radius}},r})),define("x_ite/Components/PointingDeviceSensor/CylinderSensor",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/PointingDeviceSensor/X3DDragSensorNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Line3","standard/Math/Geometry/Plane3","standard/Math/Geometry/Cylinder3","standard/Math/Algorithm"],(function(t,e,i,n,r,s,o,a,u,l,c,h){"use strict";function d(t){n.call(this,t),this.addType(r.CylinderSensor),this._diskAngle.setUnit("angle"),this._minAngle.setUnit("angle"),this._maxAngle.setUnit("angle"),this._offset.setUnit("angle")}return d.prototype=Object.assign(Object.create(n.prototype),{constructor:d,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"description",new t.SFString),new e(r.inputOutput,"enabled",new t.SFBool(!0)),new e(r.inputOutput,"axisRotation",new t.SFRotation),new e(r.inputOutput,"diskAngle",new t.SFFloat(.261792)),new e(r.inputOutput,"minAngle",new t.SFFloat),new e(r.inputOutput,"maxAngle",new t.SFFloat(-1)),new e(r.inputOutput,"offset",new t.SFFloat),new e(r.inputOutput,"autoOffset",new t.SFBool(!0)),new e(r.outputOnly,"trackPoint_changed",new t.SFVec3f),new e(r.outputOnly,"rotation_changed",new t.SFRotation),new e(r.outputOnly,"isOver",new t.SFBool),new e(r.outputOnly,"isActive",new t.SFBool)]),getTypeName:function(){return"CylinderSensor"},getComponentName:function(){return"PointingDeviceSensor"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.modelViewMatrix=new a,this.invModelViewMatrix=new a,this.cylinder=new c(new u(new s(0,0,0),new s(0,0,0)),0),this.disk=!1,this.yPlane=null,this.zPlane=null,this.sxPlane=null,this.szNormal=null,this.behind=!1,this.fromVector=new s(0,0,0),this.startOffset=new o(0,0,1,0)},isBehind:function(t,e){const i=new s(0,0,0),n=new s(0,0,0);return this.cylinder.intersectsLine(t,i,n),s.subtract(e,i).magnitude()>s.subtract(e,n).magnitude()},getTrackPoint:function(t,e){const i=new s(0,0,0);this.zPlane.intersectsLine(t,i);const n=s.add(i,this.cylinder.axis.getPerpendicularVectorToPoint(i,new s(0,0,0))),r=this.sxPlane.getDistanceToPoint(i)/this.cylinder.radius,a=Math.floor((r+1)/2),u=h.interval(r,-1,1),l=(0===a?Math.asin(u):u*Math.PI/2)+a*Math.PI;new o(this.cylinder.axis.direction,l).multVecRot(e.assign(this.szNormal).multiply(this.cylinder.radius)),e.add(n)},getAngle:function(t){return s.dot(t.getAxis(),this.cylinder.axis.direction)>0?t.angle:-t.angle},set_active__:function(t,e,i,r,a){if(n.prototype.set_active__.call(this,t,e,i,r,a),this._isActive.getValue()){this.modelViewMatrix.assign(i),this.invModelViewMatrix.assign(i).inverse();const t=e.hitRay.copy().multLineMatrix(this.invModelViewMatrix),n=this.invModelViewMatrix.multVecMatrix(e.intersection.point.copy()),r=this._axisRotation.getValue().multVecRot(new s(0,1,0)),a=this.invModelViewMatrix.multDirMatrix(new s(0,0,1)).normalize(),h=new u(new s(0,0,0),r),d=h.getPerpendicularVectorToPoint(n,new s(0,0,0)).magnitude();this.cylinder=new c(h,d),this.disk=Math.abs(s.dot(a,r))>Math.cos(this._diskAngle.getValue()),this.behind=this.isBehind(t,n),this.yPlane=new l(n,r),this.zPlane=new l(n,a);const p=this.invModelViewMatrix.origin,f=s.cross(r,p).normalize();this.sxPlane=new l(new s(0,0,0),f),this.szNormal=s.cross(f,r).normalize();const g=new s(0,0,0);this.disk?this.yPlane.intersectsLine(t,g):this.getTrackPoint(t,g),this.fromVector=this.cylinder.axis.getPerpendicularVectorToPoint(g,new s(0,0,0)).negate(),this.startOffset=new o(r,this._offset.getValue()),this._trackPoint_changed=g,this._rotation_changed=this.startOffset,this.angle=this._offset.getValue(),this.startVector=this._rotation_changed.getValue().multVecRot(this._axisRotation.getValue().multVecRot(new s(0,0,1)))}else this._autoOffset.getValue()&&(this._offset=this.getAngle(this._rotation_changed.getValue()))},set_motion__:function(t){const e=t.hitRay.copy().multLineMatrix(this.invModelViewMatrix),i=new s(0,0,0);this.disk?this.yPlane.intersectsLine(e,i):this.getTrackPoint(e,i),this._trackPoint_changed=i;const n=this.cylinder.axis.getPerpendicularVectorToPoint(i,new s(0,0,0)).negate(),r=new o(this.fromVector,n);if(this.disk){this.modelViewMatrix.multVecMatrix(i.copy()).z>0&&r.multRight(new o(this.yPlane.normal,Math.PI))}else this.behind&&r.inverse();if(r.multLeft(this.startOffset),this._minAngle.getValue()>this._maxAngle.getValue())this._rotation_changed=r;else{const t=r.multVecRot(this._axisRotation.getValue().multVecRot(new s(0,0,1))),e=new o(this.startVector,t),i=this._axisRotation.getValue().multVecRot(new s(0,1,0)).dot(e.getAxis())>0?1:-1,n=this._minAngle.getValue(),a=this._maxAngle.getValue();this.angle+=i*e.angle,this.startVector.assign(t),this.angle<n?r.setAxisAngle(this.cylinder.axis.direction,n):this.angle>a?r.setAxisAngle(this.cylinder.axis.direction,a):r.setAxisAngle(this.cylinder.axis.direction,this.angle),this._rotation_changed.getValue().equals(r)||(this._rotation_changed=r)}}}),d})),define("x_ite/Components/PointingDeviceSensor/PlaneSensor",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/PointingDeviceSensor/X3DDragSensorNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Line2","standard/Math/Geometry/Line3","standard/Math/Geometry/Plane3","standard/Math/Geometry/ViewVolume","standard/Math/Algorithm"],(function(t,e,i,n,r,s,o,a,u,l,c,h,d,p,f){"use strict";const g=new c(o.Zero,o.Zero),m=new o(0,0,0),_=new h(a.Zero,a.Zero);function y(t){n.call(this,t),this.addType(r.PlaneSensor),this._offset.setUnit("length"),this._minPosition.setUnit("length"),this._maxPosition.setUnit("length"),this._translation_changed.setUnit("length")}return y.prototype=Object.assign(Object.create(n.prototype),{constructor:y,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"description",new t.SFString),new e(r.inputOutput,"enabled",new t.SFBool(!0)),new e(r.inputOutput,"axisRotation",new t.SFRotation),new e(r.inputOutput,"autoOffset",new t.SFBool(!0)),new e(r.inputOutput,"offset",new t.SFVec3f),new e(r.inputOutput,"minPosition",new t.SFVec2f),new e(r.inputOutput,"maxPosition",new t.SFVec2f(-1,-1)),new e(r.outputOnly,"trackPoint_changed",new t.SFVec3f),new e(r.outputOnly,"translation_changed",new t.SFVec3f),new e(r.outputOnly,"isOver",new t.SFBool),new e(r.outputOnly,"isActive",new t.SFBool)]),getTypeName:function(){return"PlaneSensor"},getComponentName:function(){return"PointingDeviceSensor"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.modelViewMatrix=new l,this.invModelViewMatrix=new l,this.projectionMatrix=new l,this.viewport=new u,this.planeSensor=!0,this.plane=null,this.line=null,this.startOffset=new a(0,0,0),this.startPoint=new a(0,0,0)},getLineTrackPoint:function(t,e,i){return p.projectLine(e,this.modelViewMatrix,this.projectionMatrix,this.viewport,g),g.getClosestPointToPoint(t.pointer,m),p.unProjectRay(m.x,m.y,this.modelViewMatrix,this.projectionMatrix,this.viewport,_),e.getClosestPointToLine(_,i)},set_active__:function(t,e,i,r,s){if(n.prototype.set_active__.call(this,t,e,i,r,s),this._isActive.getValue()){this.modelViewMatrix.assign(i),this.projectionMatrix.assign(r),this.viewport.assign(s),this.invModelViewMatrix.assign(i).inverse();var o=e.hitRay.copy().multLineMatrix(this.invModelViewMatrix),u=this.invModelViewMatrix.multVecMatrix(e.intersection.point.copy()),l=this._axisRotation.getValue();if(this._minPosition.x===this._maxPosition.x){this.planeSensor=!1;var c=l.multVecRot(new a(0,Math.abs(this._maxPosition.y-this._minPosition.y),0));this.line=new h(u,c.normalize())}else if(this._minPosition.y===this._maxPosition.y){this.planeSensor=!1;c=l.multVecRot(new a(Math.abs(this._maxPosition.x-this._minPosition.x),0,0));this.line=new h(u,c.normalize())}else this.planeSensor=!0,this.plane=new d(u,l.multVecRot(new a(0,0,1)));if(this.planeSensor)this.plane.intersectsLine(o,this.startPoint)&&this.trackStart(this.startPoint);else if(this.getLineTrackPoint(e,this.line,this.startPoint)){var p=new a(0,0,0);try{this.getLineTrackPoint(e,new h(this.line.direction,this.line.direction),p)}catch(t){p=this.startPoint}this.trackStart(p)}}else this._autoOffset.getValue()&&(this._offset=this._translation_changed)},trackStart:function(t){this.startOffset.assign(this._offset.getValue()),this._trackPoint_changed=t,this._translation_changed=this._offset.getValue()},set_motion__:function(t){try{if(this.planeSensor){var e=t.hitRay.copy().multLineMatrix(this.invModelViewMatrix),i=new a(0,0,0);if(!this.plane.intersectsLine(e,i))throw new Error("Plane and line are parallel.");this.track(i,i.copy())}else{i=new a(0,0,0);var n=new a(0,0,0);if(!this.getLineTrackPoint(t,this.line,i))throw new Error("Lines are parallel.");try{this.getLineTrackPoint(t,new h(a.Zero,this.line.direction),n)}catch(t){n.assign(i)}this.track(i,n)}}catch(t){this._trackPoint_changed.addEvent(),this._translation_changed.addEvent()}},track:function(t,e){var i=this._axisRotation.getValue(),n=s.inverse(i).multVecRot(t.add(this.startOffset).subtract(this.startPoint));this._minPosition.x>this._maxPosition.x||(n.x=f.clamp(n.x,this._minPosition.x,this._maxPosition.x)),this._minPosition.y>this._maxPosition.y||(n.y=f.clamp(n.y,this._minPosition.y,this._maxPosition.y)),i.multVecRot(n),this._trackPoint_changed.getValue().equals(e)||(this._trackPoint_changed=e),this._translation_changed.getValue().equals(n)||(this._translation_changed=n)}}),y})),define("standard/Math/Geometry/Sphere3",["standard/Math/Numbers/Vector3"],(function(t){"use strict";function e(t,e){this.radius=t,this.center=e.copy()}return e.prototype={constructor:e,set:function(t,e){this.radius=t,this.center.assign(e)},intersectsLine:function(t,e,i){const n=t.point,r=t.direction,s=this.center,o=this.radius,a=2*(n.dot(r)-s.dot(r)),u=a*a-4*(n.x*n.x+n.y*n.y+n.z*n.z+(s.x*s.x+s.y*s.y+s.z*s.z)-2*n.dot(s)-o*o);if(u>=0){let t=(-a+Math.sqrt(u))/2,s=(-a-Math.sqrt(u))/2;if(t>s){const e=t;t=s,s=e}return e.assign(r).multiply(t).add(n),i.assign(r).multiply(s).add(n),!0}return!1},intersectsTriangle:function(){const e=new t(0,0,0),i=new t(0,0,0),n=new t(0,0,0),r=new t(0,0,0),s=new t(0,0,0),o=new t(0,0,0),a=new t(0,0,0);return function(u,l,c){const h=this.center,d=this.radius;u.subtract(h),l.subtract(h),c.subtract(h),e.assign(l).subtract(u),i.assign(c).subtract(u);const p=d*d,f=e.cross(i),g=t.dot(u,f);if(g*g>p*t.dot(f,f))return!1;const m=t.dot(u,u),_=t.dot(u,l),y=t.dot(u,c),x=t.dot(l,l),w=t.dot(l,c),b=t.dot(c,c);if(m>p&&_>m&&y>m||x>p&&_>x&&w>x||b>p&&y>b&&w>b)return!1;e.assign(l).subtract(u),n.assign(c).subtract(l),r.assign(u).subtract(c);const v=_-m,S=w-x,T=y-b,C=t.dot(e,e),O=t.dot(n,n),N=t.dot(r,r);s.assign(u).multiply(C).subtract(e.multiply(v)),o.assign(l).multiply(O).subtract(n.multiply(S)),a.assign(c).multiply(N).subtract(r.multiply(T));const F=c.multiply(C).subtract(s),E=u.multiply(O).subtract(o),D=l.multiply(N).subtract(a),M=t.dot(s,s)>p*C*C&&t.dot(s,F)>0,I=t.dot(o,o)>p*O*O&&t.dot(o,E)>0,V=t.dot(a,a)>p*N*N&&t.dot(a,D)>0;return!(M||I||V)}}(),toString:function(){return this.radius+" "+this.center.toString()}},e})),define("x_ite/Components/PointingDeviceSensor/SphereSensor",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/PointingDeviceSensor/X3DDragSensorNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Triangle3","standard/Math/Geometry/Line3","standard/Math/Geometry/Plane3","standard/Math/Geometry/Sphere3"],(function(t,e,i,n,r,s,o,a,u,l,c,h){"use strict";function d(t){n.call(this,t),this.addType(r.SphereSensor)}return d.prototype=Object.assign(Object.create(n.prototype),{constructor:d,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"description",new t.SFString),new e(r.inputOutput,"enabled",new t.SFBool(!0)),new e(r.inputOutput,"autoOffset",new t.SFBool(!0)),new e(r.inputOutput,"offset",new t.SFRotation),new e(r.outputOnly,"trackPoint_changed",new t.SFVec3f),new e(r.outputOnly,"rotation_changed",new t.SFRotation),new e(r.outputOnly,"isOver",new t.SFBool),new e(r.outputOnly,"isActive",new t.SFBool)]),getTypeName:function(){return"SphereSensor"},getComponentName:function(){return"PointingDeviceSensor"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.modelViewMatrix=new a,this.invModelViewMatrix=new a,this.sphere=null,this.zPlane=null,this.behind=!1,this.fromVector=new s(0,0,0),this.startPoint=new s(0,0,0),this.startOffset=new o(0,0,1,0)},getTrackPoint:function(t,e,i){var n=new s(0,0,0);return!!this.sphere.intersectsLine(t,e,n)&&((s.subtract(t.point,n).magnitude()<s.subtract(t.point,e).magnitude())-i&&e.assign(n),!0)},set_active__:function(t,e,i,r,o){if(n.prototype.set_active__.call(this,t,e,i,r,o),this._isActive.getValue()){this.modelViewMatrix.assign(i),this.invModelViewMatrix.assign(i).inverse();var a=this.invModelViewMatrix.multVecMatrix(e.intersection.point.copy()),u=new s(0,0,0);this.zPlane=new c(u,this.invModelViewMatrix.multDirMatrix(new s(0,0,1)).normalize()),this.sphere=new h(a.magnitude(),u),this.behind=this.zPlane.getDistanceToPoint(a)<0,this.fromVector.assign(a),this.startPoint.assign(a),this.startOffset.assign(this._offset.getValue()),this._trackPoint_changed=a,this._rotation_changed=this._offset.getValue()}else this._autoOffset.getValue()&&(this._offset=this._rotation_changed)},set_motion__:function(t){var e=t.hitRay.copy().multLineMatrix(this.invModelViewMatrix),i=new s(0,0,0);if(this.getTrackPoint(e,i,this.behind)){var n=this.invModelViewMatrix.multDirMatrix(new s(0,0,1)).normalize();this.zPlane=new c(i,n)}else{var r=new s(0,0,0);this.zPlane.intersectsLine(e,r),e=new l(r,s.subtract(this.sphere.center,r).normalize()),this.getTrackPoint(e,i,!1);var a=u.normal(this.sphere.center,i,this.startPoint,new s(0,0,0)),h=s.subtract(i,this.sphere.center).normalize(),d=s.cross(a,h).normalize(),p=s.subtract(i,d.multiply(s.subtract(r,i).magnitude()));e=new l(p,s.subtract(this.sphere.center,p).normalize()),this.getTrackPoint(e,i,!1)}this._trackPoint_changed=i;var f=s.subtract(i,this.sphere.center),g=new o(this.fromVector,f);this.behind&&g.inverse(),this._rotation_changed=o.multRight(this.startOffset,g)}}),d})),define("x_ite/Components/PointingDeviceSensor",["x_ite/Configuration/SupportedNodes","x_ite/Components/PointingDeviceSensor/CylinderSensor","x_ite/Components/PointingDeviceSensor/PlaneSensor","x_ite/Components/PointingDeviceSensor/SphereSensor","x_ite/Components/PointingDeviceSensor/TouchSensor","x_ite/Components/PointingDeviceSensor/X3DDragSensorNode","x_ite/Components/PointingDeviceSensor/X3DPointingDeviceSensorNode","x_ite/Components/PointingDeviceSensor/X3DTouchSensorNode"],(function(t,e,i,n,r,s,o,a){"use strict";const u={CylinderSensor:e,PlaneSensor:i,SphereSensor:n,TouchSensor:r},l={X3DDragSensorNode:s,X3DPointingDeviceSensorNode:o,X3DTouchSensorNode:a};for(const e in u)t.addType(e,u[e]);for(const e in l)t.addAbstractType(e,l[e])})),define("x_ite/Components/Rendering/ClipPlane",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Core/X3DChildNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Geometry/Plane3","standard/Utility/ObjectCache"],(function(t,e,i,n,r,s,o,a,u){"use strict";const l=u(c);function c(){this.plane=new a(s.Zero,s.Zero)}function h(t){n.call(this,t),this.addType(r.ClipPlane),this.enabled=!1,this.plane=new o(0,0,0,0)}return c.prototype={constructor:c,isClipped:function(t){return this.plane.getDistanceToPoint(t)<0},set:function(t,e){const i=this.plane,n=t.plane;i.normal.assign(n),i.distanceFromOrigin=-n.w,i.multRight(e)},setShaderUniforms:function(t,e){const i=this.plane,n=i.normal;t.uniform4f(e.x3d_ClipPlane[e.numClipPlanes++],n.x,n.y,n.z,i.distanceFromOrigin)},dispose:function(){l.push(this)}},h.prototype=Object.assign(Object.create(n.prototype),{constructor:h,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"enabled",new t.SFBool(!0)),new e(r.inputOutput,"plane",new t.SFVec4f(0,1,0,0))]),getTypeName:function(){return"ClipPlane"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this._enabled.addInterest("set_enabled__",this),this._plane.addInterest("set_enabled__",this),this.set_enabled__()},set_enabled__:function(){this.plane.assign(this._plane.getValue()),this.enabled=this._enabled.getValue()&&!this.plane.equals(o.Zero)},push:function(t){if(this.enabled){const e=l.pop();e.set(this,t.getModelViewMatrix().get()),t.getLocalObjects().push(e)}},pop:function(t){this.enabled&&this.getBrowser().getLocalObjects().push(t.getLocalObjects().pop())}}),h})),define("x_ite/Components/Rendering/ColorRGBA",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Rendering/X3DColorNode","x_ite/Base/X3DConstants"],(function(t,e,i,n,r){"use strict";function s(t){n.call(this,t),this.addType(r.ColorRGBA),this.setTransparent(!0)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"color",new t.MFColorRGBA)]),getTypeName:function(){return"ColorRGBA"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"color"},initialize:function(){n.prototype.initialize.call(this),this._color.addInterest("set_color__",this),this.set_color__()},set_color__:function(){this.color=this._color.getValue(),this.length=this._color.length},addColor:function(t,e){if(t>=0&&t<this.length){const i=this.color;t*=4,e.push(i[t],i[t+1],i[t+2],i[t+3])}else if(this.length){const i=this.color;t=4*(this.length-1),e.push(i[t],i[t+1],i[t+2],i[t+3])}else e.push(1,1,1,1)},addColors:function(t,e){if(this.length){const r=this.color;for(var i=0,n=4*Math.min(e,this.length);i<n;i+=4)t.push(r[i],r[i+1],r[i+2],r[i+3]);if(this.length<e){const s=r[i=4*(this.length-1)],o=r[i+1],a=r[i+2],u=r[i+2];for(i=n,n=4*e;i<n;i+=4)t.push(s,o,a,u)}}else for(let i=0;i<e;++i)t.push(1,1,1,1);return t}}),s})),define("x_ite/Components/Rendering/IndexedTriangleFanSet",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Rendering/X3DComposedGeometryNode","x_ite/Base/X3DConstants"],(function(t,e,i,n,r){"use strict";function s(t){n.call(this,t),this.addType(r.IndexedTriangleFanSet),this.triangleIndex=[]}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOnly,"set_index",new t.MFInt32),new e(r.initializeOnly,"solid",new t.SFBool(!0)),new e(r.initializeOnly,"ccw",new t.SFBool(!0)),new e(r.initializeOnly,"colorPerVertex",new t.SFBool(!0)),new e(r.initializeOnly,"normalPerVertex",new t.SFBool(!0)),new e(r.initializeOnly,"index",new t.MFInt32),new e(r.inputOutput,"attrib",new t.MFNode),new e(r.inputOutput,"fogCoord",new t.SFNode),new e(r.inputOutput,"color",new t.SFNode),new e(r.inputOutput,"texCoord",new t.SFNode),new e(r.inputOutput,"normal",new t.SFNode),new e(r.inputOutput,"coord",new t.SFNode)]),getTypeName:function(){return"IndexedTriangleFanSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},initialize:function(){n.prototype.initialize.call(this),this._set_index.addFieldInterest(this._index),this._index.addInterest("set_index__",this),this.set_index__()},set_index__:function(){const t=this._index,e=this.triangleIndex;e.length=0;for(let i=0,n=t.length;i<n;++i){const r=t[i];if(!(r<0)&&++i<n){let s=t[i];if(s<0)continue;for(++i;i<n;++i){const n=t[i];if(n<0)break;e.push(r,s,n),s=n}}}},getPolygonIndex:function(t){return this.triangleIndex[t]},build:function(){n.prototype.build.call(this,3,this.triangleIndex.length,3,this.triangleIndex.length)}}),s})),define("x_ite/Components/Rendering/IndexedTriangleSet",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Rendering/X3DComposedGeometryNode","x_ite/Base/X3DConstants"],(function(t,e,i,n,r){"use strict";function s(t){n.call(this,t),this.addType(r.IndexedTriangleSet)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOnly,"set_index",new t.MFInt32),new e(r.initializeOnly,"solid",new t.SFBool(!0)),new e(r.initializeOnly,"ccw",new t.SFBool(!0)),new e(r.initializeOnly,"colorPerVertex",new t.SFBool(!0)),new e(r.initializeOnly,"normalPerVertex",new t.SFBool(!0)),new e(r.initializeOnly,"index",new t.MFInt32),new e(r.inputOutput,"attrib",new t.MFNode),new e(r.inputOutput,"fogCoord",new t.SFNode),new e(r.inputOutput,"color",new t.SFNode),new e(r.inputOutput,"texCoord",new t.SFNode),new e(r.inputOutput,"normal",new t.SFNode),new e(r.inputOutput,"coord",new t.SFNode)]),getTypeName:function(){return"IndexedTriangleSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},getPolygonIndex:function(t){return this._index[t]},initialize:function(){n.prototype.initialize.call(this),this._set_index.addFieldInterest(this._index)},build:function(){n.prototype.build.call(this,3,this._index.length,3,this._index.length)}}),s})),define("x_ite/Components/Rendering/IndexedTriangleStripSet",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Rendering/X3DComposedGeometryNode","x_ite/Base/X3DConstants"],(function(t,e,i,n,r){"use strict";function s(t){n.call(this,t),this.addType(r.IndexedTriangleStripSet),this.triangleIndex=[]}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOnly,"set_index",new t.MFInt32),new e(r.initializeOnly,"solid",new t.SFBool(!0)),new e(r.initializeOnly,"ccw",new t.SFBool(!0)),new e(r.initializeOnly,"colorPerVertex",new t.SFBool(!0)),new e(r.initializeOnly,"normalPerVertex",new t.SFBool(!0)),new e(r.initializeOnly,"index",new t.MFInt32),new e(r.inputOutput,"attrib",new t.MFNode),new e(r.inputOutput,"fogCoord",new t.SFNode),new e(r.inputOutput,"color",new t.SFNode),new e(r.inputOutput,"texCoord",new t.SFNode),new e(r.inputOutput,"normal",new t.SFNode),new e(r.inputOutput,"coord",new t.SFNode)]),getTypeName:function(){return"IndexedTriangleStripSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},initialize:function(){n.prototype.initialize.call(this),this._set_index.addFieldInterest(this._index),this._index.addInterest("set_index__",this),this.set_index__()},set_index__:function(){const t=this._index,e=this.triangleIndex;e.length=0;for(let i=0,n=t.length;i<n;++i){let r=t[i];if(!(r<0)&&++i<n){let s=t[i];if(s<0)continue;++i;for(let o=0;i<n;++i,++o){const n=t[i];if(n<0)break;e.push(r,s,n),1&o?s=n:r=n}}}},getPolygonIndex:function(t){return this.triangleIndex[t]},build:function(){n.prototype.build.call(this,3,this.triangleIndex.length,3,this.triangleIndex.length)}}),s})),define("x_ite/Components/Rendering/LineSet",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Rendering/X3DLineGeometryNode","x_ite/Base/X3DCast","x_ite/Base/X3DConstants"],(function(t,e,i,n,r,s){"use strict";function o(t){n.call(this,t),this.addType(s.LineSet),this.fogCoordNode=null,this.colorNode=null,this.normalNode=null,this.coordNode=null}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.inputOutput,"vertexCount",new t.MFInt32),new e(s.inputOutput,"attrib",new t.MFNode),new e(s.inputOutput,"fogCoord",new t.SFNode),new e(s.inputOutput,"color",new t.SFNode),new e(s.inputOutput,"normal",new t.SFNode),new e(s.inputOutput,"coord",new t.SFNode)]),getTypeName:function(){return"LineSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},initialize:function(){n.prototype.initialize.call(this),this._attrib.addInterest("set_attrib__",this),this._fogCoord.addInterest("set_fogCoord__",this),this._color.addInterest("set_color__",this),this._normal.addInterest("set_normal__",this),this._coord.addInterest("set_coord__",this),this.set_attrib__(),this.set_fogCoord__(),this.set_color__(),this.set_normal__(),this.set_coord__()},set_attrib__:function(){const t=this.getAttrib();for(const e of t)e.removeInterest("requestRebuild",this),e._attribute_changed.removeInterest("updateVertexArrays",this);t.length=0;for(const e of this._attrib){const i=r(s.X3DVertexAttributeNode,e);i&&t.push(i)}for(const e of t)e.addInterest("requestRebuild",this),e._attribute_changed.addInterest("updateVertexArrays",this);this.updateVertexArrays()},set_fogCoord__:function(){this.fogCoordNode&&this.fogCoordNode.removeInterest("requestRebuild",this),this.fogCoordNode=r(s.FogCoordinate,this._fogCoord),this.fogCoordNode&&this.fogCoordNode.addInterest("requestRebuild",this)},set_color__:function(){this.colorNode&&(this.colorNode.removeInterest("requestRebuild",this),this.colorNode._transparent.removeInterest("set_transparent__",this)),this.colorNode=r(s.X3DColorNode,this._color),this.colorNode?(this.colorNode.addInterest("requestRebuild",this),this.colorNode._transparent.addInterest("set_transparent__",this),this.set_transparent__()):this.setTransparent(!1)},set_transparent__:function(){this.setTransparent(this.colorNode.getTransparent())},set_normal__:function(){this.normalNode&&this.normalNode.removeInterest("requestRebuild",this),this.normalNode=r(s.X3DNormalNode,this._normal),this.normalNode&&this.normalNode.addInterest("requestRebuild",this)},set_coord__:function(){this.coordNode&&this.coordNode.removeInterest("requestRebuild",this),this.coordNode=r(s.X3DCoordinateNode,this._coord),this.coordNode&&this.coordNode.addInterest("requestRebuild",this)},build:function(){if(!this.coordNode||this.coordNode.isEmpty())return;const t=this._vertexCount,e=this.getAttrib(),i=e.length,n=this.getAttribs(),r=this.fogCoordNode,s=this.colorNode,o=this.coordNode,a=this.getFogDepths(),u=this.getColors(),l=this.getVertices(),c=o.getSize();let h=0;for(let d of t){if(h+d>c)break;if(d>1){d=2*d-2;for(let t=0;t<d;++t,h+=1&t){for(let t=0;t<i;++t)e[t].addValue(h,n[t]);r&&r.addDepth(h,a),s&&s.addColor(h,u),o.addPoint(h,l)}++h}else h+=d}}}),o})),define("x_ite/Components/Rendering/X3DNormalNode",["x_ite/Components/Rendering/X3DGeometricPropertyNode","x_ite/Base/X3DConstants"],(function(t,e){"use strict";function i(i){t.call(this,i),this.addType(e.X3DNormalNode)}return i.prototype=Object.assign(Object.create(t.prototype),{constructor:i}),i})),define("x_ite/Components/Rendering/Normal",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Rendering/X3DNormalNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3"],(function(t,e,i,n,r,s){"use strict";function o(t){n.call(this,t),this.addType(r.Normal)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"vector",new t.MFVec3f)]),getTypeName:function(){return"Normal"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"normal"},initialize:function(){n.prototype.initialize.call(this),this._vector.addInterest("set_vector__",this),this.set_vector__()},set_vector__:function(){this.vector=this._vector.getValue(),this.length=this._vector.length},set1Vector:function(t,e){this._vector[t]=e},get1Vector:function(t,e){if(t>=0&&t<this.length){const i=this.vector;return t*=3,e.set(i[t],i[t+1],i[t+2])}if(t>=0&&this.length){const i=this.vector;return t%=this.length,t*=3,e.set(i[t],i[t+1],i[t+2])}return e.set(0,0,0)},addVector:function(t,e){if(t>=0&&t<this.length){const i=this.vector;t*=3,e.push(i[t],i[t+1],i[t+2])}else{if(!(t>=0&&this.length))return e.push(0,0,0);{const i=this.vector;t%=this.length,t*=3,e.push(i[t],i[t+1],i[t+2])}}}}),o})),define("x_ite/Components/Rendering/X3DPointGeometryNode",["x_ite/Components/Rendering/X3DGeometryNode","standard/Math/Geometry/ViewVolume","standard/Math/Geometry/Box3","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4"],(function(t,e,i,n,r,s){"use strict";function o(e){t.call(this,e);const i=this.getBrowser();this.setGeometryType(0),this.setPrimitiveMode(i.getContext().POINTS),this.setSolid(!1),this.setTransparent(!0)}return o.prototype=Object.assign(Object.create(t.prototype),{constructor:o,intersectsLine:function(){const t=new i,o=new r(0,0,0),a=new r(0,0,0),u=new r(0,0,0),l=new r(0,0,0),c=new r(0,0,0),h=new r(0,0,0),d=new s,p=new n(0,0),f=new r(0,0,0);return function(i,r,s,g,m){const _=r.getModelViewMatrix().get(),y=r.getViewVolume().getViewport(),x=(t.assign(this.getBBox()).multRight(_).getExtents(o,a),g.getPointProperties()),w=Math.max(1.5,x?x.getPointSize(o)/2:1),b=r.getViewpoint().getScreenScale(o,y,u),v=s.multDirMatrix(b.multiply(w)),S=Math.max(1.5,x?x.getPointSize(a)/2:1),T=r.getViewpoint().getScreenScale(a,y,l),C=s.multDirMatrix(T.multiply(S));if(this.intersectsBBox(i,v.abs().max(C.abs()))){const t=this.getBrowser().getPointer(),i=r.getProjectionMatrix().get(),s=r.getLocalObjects(),o=this.getVertices(),a=o.length;d.assign(_).multRight(i);for(let i=0;i<a;i+=4){c.set(o[i+0],o[i+1],o[i+2]),e.projectPointMatrix(c,d,y,p);const r=Math.max(1.5,x?x.getPointSize(_.multVecMatrix(h.assign(c)))/2:1);if(p.distance(t)<=r){if(s.length&&this.isClipped(_.multVecMatrix(f.assign(c)),s))continue;const e=t.copy().subtract(p).divide(r).add(n.One).divide(2),i=_.submatrix.transpose().z.copy().normalize();m.push({texCoord:e,normal:i,point:c.copy()})}}}return m.length}}(),intersectsLineWithGeometry:function(){return!1},intersectsBox:function(t,e,i){return!1},buildTexCoords:function(){},display:function(t,e){const i=e.appearanceNode,n=i.getShader(this,e),r=i.getBlendMode(),s=this.getAttrib(),o=this.getAttribBuffers();if(r&&r.enable(t),n.enable(t),n.setUniforms(t,e),this.vertexArrayObject.enable(t,n)){for(let e=0,i=s.length;e<i;++e)s[e].enable(t,n,o[e]);this.hasFogCoords&&n.enableFogDepthAttribute(t,this.fogDepthBuffer,0,0),this.colorMaterial&&n.enableColorAttribute(t,this.colorBuffer,0,0),n.enableVertexAttribute(t,this.vertexBuffer,0,0)}t.drawArrays(this.primitiveMode,0,this.vertexCount),r&&r.disable(t)},displayParticles:function(t,e,i){const n=e.appearanceNode,r=n.getShader(this,e),s=n.getBlendMode(),o=this.getAttrib(),a=this.getAttribBuffers();s&&s.enable(t),r.enable(t),r.setUniforms(t,e);const u=i.outputParticles;if(u.vertexArrayObject.update(this.updateParticles).enable(t,r)){const e=i.particleStride;r.enableParticleAttribute(t,u,e,i.particleOffset,1),r.enableParticleMatrixAttribute(t,u,e,i.matrixOffset,1);for(let e=0,i=o.length;e<i;++e)o[e].enable(t,r,a[e]);this.hasFogCoords&&r.enableFogDepthAttribute(t,this.fogDepthBuffer,0,0),this.colorMaterial&&r.enableColorAttribute(t,this.colorBuffer,0,0),r.enableVertexAttribute(t,this.vertexBuffer,0,0),this.updateParticles=!1}t.drawArraysInstanced(this.primitiveMode,0,this.vertexCount,i.numParticles),s&&s.disable(t)}}),o})),define("x_ite/Components/Rendering/PointSet",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Rendering/X3DPointGeometryNode","x_ite/Base/X3DCast","x_ite/Base/X3DConstants"],(function(t,e,i,n,r,s){"use strict";function o(t){n.call(this,t),this.addType(s.PointSet),this.fogCoordNode=null,this.colorNode=null,this.normalNode=null,this.coordNode=null}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.inputOutput,"attrib",new t.MFNode),new e(s.inputOutput,"fogCoord",new t.SFNode),new e(s.inputOutput,"color",new t.SFNode),new e(s.inputOutput,"normal",new t.SFNode),new e(s.inputOutput,"coord",new t.SFNode)]),getTypeName:function(){return"PointSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},initialize:function(){n.prototype.initialize.call(this),this._attrib.addInterest("set_attrib__",this),this._fogCoord.addInterest("set_fogCoord__",this),this._color.addInterest("set_color__",this),this._normal.addInterest("set_normal__",this),this._coord.addInterest("set_coord__",this),this.set_attrib__(),this.set_fogCoord__(),this.set_color__(),this.set_normal__(),this.set_coord__()},getCoord:function(){return this.coordNode},set_attrib__:function(){const t=this.getAttrib();for(const e of t)e.removeInterest("requestRebuild",this),e._attribute_changed.removeInterest("updateVertexArrays",this);t.length=0;for(const e of this._attrib){const i=r(s.X3DVertexAttributeNode,e);i&&t.push(i)}for(const e of t)e.addInterest("requestRebuild",this),e._attribute_changed.addInterest("updateVertexArrays",this);this.updateVertexArrays()},set_fogCoord__:function(){this.fogCoordNode&&this.fogCoordNode.removeInterest("requestRebuild",this),this.fogCoordNode=r(s.FogCoordinate,this._fogCoord),this.fogCoordNode&&this.fogCoordNode.addInterest("requestRebuild",this)},set_color__:function(){this.colorNode&&this.colorNode.removeInterest("requestRebuild",this),this.colorNode=r(s.X3DColorNode,this._color),this.colorNode&&this.colorNode.addInterest("requestRebuild",this)},set_normal__:function(){this.normalNode&&this.normalNode.removeInterest("requestRebuild",this),this.normalNode=r(s.X3DNormalNode,this._normal),this.normalNode&&this.normalNode.addInterest("requestRebuild",this)},set_coord__:function(){this.coordNode&&this.coordNode.removeInterest("requestRebuild",this),this.coordNode=r(s.X3DCoordinateNode,this._coord),this.coordNode&&this.coordNode.addInterest("requestRebuild",this)},build:function(){if(!this.coordNode||this.coordNode.isEmpty())return;const t=this.getAttrib(),e=t.length,i=this.getAttribs(),n=this.fogCoordNode,r=this.getFogDepths(),s=this.colorNode,o=this.getColors(),a=this.coordNode,u=this.getVertices(),l=a._point.length;for(let n=0;n<e;++n)for(let e=0;e<l;++e)t[n].addValue(e,i[n]);n&&n.addDepths(r,l),s&&s.addColors(o,l),a.addPoints(u,l)}}),o})),define("x_ite/Components/Rendering/TriangleFanSet",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Rendering/X3DComposedGeometryNode","x_ite/Base/X3DConstants"],(function(t,e,i,n,r){"use strict";function s(t){n.call(this,t),this.addType(r.TriangleFanSet),this.triangleIndex=[]}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.initializeOnly,"solid",new t.SFBool(!0)),new e(r.initializeOnly,"ccw",new t.SFBool(!0)),new e(r.initializeOnly,"colorPerVertex",new t.SFBool(!0)),new e(r.initializeOnly,"normalPerVertex",new t.SFBool(!0)),new e(r.inputOutput,"fanCount",new t.MFInt32),new e(r.inputOutput,"attrib",new t.MFNode),new e(r.inputOutput,"fogCoord",new t.SFNode),new e(r.inputOutput,"color",new t.SFNode),new e(r.inputOutput,"texCoord",new t.SFNode),new e(r.inputOutput,"normal",new t.SFNode),new e(r.inputOutput,"coord",new t.SFNode)]),getTypeName:function(){return"TriangleFanSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},initialize:function(){n.prototype.initialize.call(this),this._fanCount.addInterest("set_fanCount__",this),this.set_fanCount__()},set_fanCount__:function(){const t=this._fanCount,e=this.triangleIndex;e.length=0;let i=0;for(const n of t){for(let t=1,r=n-1;t<r;++t)e.push(i,i+t,i+t+1);i+=n}},getPolygonIndex:function(t){return this.triangleIndex[t]},build:function(){n.prototype.build.call(this,3,this.triangleIndex.length,3,this.triangleIndex.length)}}),s})),define("x_ite/Components/Rendering/TriangleSet",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Rendering/X3DComposedGeometryNode","x_ite/Base/X3DConstants"],(function(t,e,i,n,r){"use strict";function s(t){n.call(this,t),this.addType(r.TriangleSet)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.initializeOnly,"solid",new t.SFBool(!0)),new e(r.initializeOnly,"ccw",new t.SFBool(!0)),new e(r.initializeOnly,"colorPerVertex",new t.SFBool(!0)),new e(r.initializeOnly,"normalPerVertex",new t.SFBool(!0)),new e(r.inputOutput,"attrib",new t.MFNode),new e(r.inputOutput,"fogCoord",new t.SFNode),new e(r.inputOutput,"color",new t.SFNode),new e(r.inputOutput,"texCoord",new t.SFNode),new e(r.inputOutput,"normal",new t.SFNode),new e(r.inputOutput,"coord",new t.SFNode)]),getTypeName:function(){return"TriangleSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},build:function(){this.getCoord()&&n.prototype.build.call(this,3,this.getCoord().getSize(),3,this.getCoord().getSize())},createNormals:function(t,e){return this.createFaceNormals(t,e)}}),s})),define("x_ite/Components/Rendering/TriangleStripSet",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Rendering/X3DComposedGeometryNode","x_ite/Base/X3DConstants"],(function(t,e,i,n,r){"use strict";function s(t){n.call(this,t),this.addType(r.TriangleStripSet),this.triangleIndex=[]}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.initializeOnly,"solid",new t.SFBool(!0)),new e(r.initializeOnly,"ccw",new t.SFBool(!0)),new e(r.initializeOnly,"colorPerVertex",new t.SFBool(!0)),new e(r.initializeOnly,"normalPerVertex",new t.SFBool(!0)),new e(r.inputOutput,"stripCount",new t.MFInt32),new e(r.inputOutput,"attrib",new t.MFNode),new e(r.inputOutput,"fogCoord",new t.SFNode),new e(r.inputOutput,"color",new t.SFNode),new e(r.inputOutput,"texCoord",new t.SFNode),new e(r.inputOutput,"normal",new t.SFNode),new e(r.inputOutput,"coord",new t.SFNode)]),getTypeName:function(){return"TriangleStripSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},initialize:function(){n.prototype.initialize.call(this),this._stripCount.addInterest("set_stripCount__",this),this.set_stripCount__()},set_stripCount__:function(){const t=this._stripCount,e=this.triangleIndex;e.length=0;let i=0;for(const n of t){for(let t=0,r=n-2;t<r;++t){const n=1&t;e.push(i+(n?t+1:t),i+(n?t:t+1),i+(t+2))}i+=n}},getPolygonIndex:function(t){return this.triangleIndex[t]},build:function(){n.prototype.build.call(this,3,this.triangleIndex.length,3,this.triangleIndex.length)}}),s})),define("x_ite/Components/Rendering",["x_ite/Configuration/SupportedNodes","x_ite/Components/Rendering/ClipPlane","x_ite/Components/Rendering/Color","x_ite/Components/Rendering/ColorRGBA","x_ite/Components/Rendering/Coordinate","x_ite/Components/Rendering/IndexedLineSet","x_ite/Components/Rendering/IndexedTriangleFanSet","x_ite/Components/Rendering/IndexedTriangleSet","x_ite/Components/Rendering/IndexedTriangleStripSet","x_ite/Components/Rendering/LineSet","x_ite/Components/Rendering/Normal","x_ite/Components/Rendering/PointSet","x_ite/Components/Rendering/TriangleFanSet","x_ite/Components/Rendering/TriangleSet","x_ite/Components/Rendering/TriangleStripSet","x_ite/Components/Rendering/X3DColorNode","x_ite/Components/Rendering/X3DComposedGeometryNode","x_ite/Components/Rendering/X3DCoordinateNode","x_ite/Components/Rendering/X3DGeometricPropertyNode","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Components/Rendering/X3DLineGeometryNode","x_ite/Components/Rendering/X3DNormalNode"],(function(t,e,i,n,r,s,o,a,u,l,c,h,d,p,f,g,m,_,y,x,w,b){"use strict";const v={ClipPlane:e,Color:i,ColorRGBA:n,Coordinate:r,IndexedLineSet:s,IndexedTriangleFanSet:o,IndexedTriangleSet:a,IndexedTriangleStripSet:u,LineSet:l,Normal:c,PointSet:h,TriangleFanSet:d,TriangleSet:p,TriangleStripSet:f},S={X3DColorNode:g,X3DComposedGeometryNode:m,X3DCoordinateNode:_,X3DGeometricPropertyNode:y,X3DGeometryNode:x,X3DLineGeometryNode:w,X3DNormalNode:b};for(const e in v)t.addType(e,v[e]);for(const e in S)t.addAbstractType(e,S[e])})),define("x_ite/Components/Shaders/X3DVertexAttributeNode",["x_ite/Fields","x_ite/Components/Rendering/X3DGeometricPropertyNode","x_ite/Base/X3DConstants"],(function(t,e,i){"use strict";function n(n){e.call(this,n),this.addType(i.X3DVertexAttributeNode),this.addChildObjects("attribute_changed",new t.SFTime)}return n.prototype=Object.assign(Object.create(e.prototype),{constructor:n,initialize:function(){e.prototype.initialize.call(this),this._name.addInterest("set_attribute__",this)},set_attribute__:function(){this._attribute_changed=this.getBrowser().getCurrentTime()}}),n})),define("x_ite/Components/Shaders/FloatVertexAttribute",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Shaders/X3DVertexAttributeNode","x_ite/Base/X3DConstants","standard/Math/Algorithm"],(function(t,e,i,n,r,s){"use strict";function o(t){n.call(this,t),this.addType(r.FloatVertexAttribute)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.initializeOnly,"name",new t.SFString),new e(r.initializeOnly,"numComponents",new t.SFInt32(4)),new e(r.inputOutput,"value",new t.MFFloat)]),getTypeName:function(){return"FloatVertexAttribute"},getComponentName:function(){return"Shaders"},getContainerField:function(){return"attrib"},initialize:function(){n.prototype.initialize.call(this),this._numComponents.addInterest("set_numComponents__",this),this._numComponents.addInterest("set_attribute__",this),this._value.addInterest("set_value__",this),this.set_numComponents__(),this.set_value__()},set_numComponents__:function(){this.numComponents=s.clamp(this._numComponents.getValue(),1,4)},set_value__:function(){this.value=this._value.getValue(),this.length=this._value.length},addValue:function(t,e){const i=this.value;let n=t*this.numComponents,r=n+this.numComponents;if(r<=this.length)for(;n<r;++n)e.push(i[n]);else if(this.numComponents<=this.length)for(r=i.length,n=r-this.numComponents;n<r;++n)e.push(i[n]);else for(;n<r;++n)e.push(0)},enable:function(t,e,i){e.enableFloatAttrib(t,this._name.getValue(),i,this.numComponents,0,0)}}),o})),define("x_ite/Components/Shaders/Matrix3VertexAttribute",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Shaders/X3DVertexAttributeNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Matrix3"],(function(t,e,i,n,r,s){"use strict";function o(t){n.call(this,t),this.addType(r.Matrix3VertexAttribute)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.initializeOnly,"name",new t.SFString),new e(r.inputOutput,"value",new t.MFMatrix3f)]),getTypeName:function(){return"Matrix3VertexAttribute"},getComponentName:function(){return"Shaders"},getContainerField:function(){return"attrib"},initialize:function(){n.prototype.initialize.call(this),this._value.addInterest("set_value__",this),this.set_value__()},set_value__:function(){this.value=this._value.getValue(),this.length=this._value.length},addValue:function(t,e){if(t<this.length){const i=this.value;for(let n=9*t,r=n+9;n<r;++n)e.push(i[n])}else if(this.length){const i=this.value;for(let n=9*(t=this.length-1),r=n+9;n<r;++n)e.push(i[n])}else{const t=s.Identity;for(let i=0;i<9;++i)e.push(t[i])}},enable:function(t,e,i){e.enableMatrix3Attrib(t,this._name.getValue(),i,0,0)}}),o})),define("x_ite/Components/Shaders/Matrix4VertexAttribute",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Shaders/X3DVertexAttributeNode","x_ite/Base/X3DConstants"],(function(t,e,i,n,r){"use strict";function s(t){n.call(this,t),this.addType(r.Matrix4VertexAttribute)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.initializeOnly,"name",new t.SFString),new e(r.inputOutput,"value",new t.MFMatrix4f)]),getTypeName:function(){return"Matrix4VertexAttribute"},getComponentName:function(){return"Shaders"},getContainerField:function(){return"attrib"},initialize:function(){n.prototype.initialize.call(this),this._value.addInterest("set_value__",this),this.set_value__()},set_value__:function(){this.value=this._value.getValue(),this.length=this._value.length},addValue:function(t,e){if(t<this.length){const i=this.value;for(let n=16*t,r=n+16;n<r;++n)e.push(i[n])}else if(this.length){const i=this.value;for(let n=16*(t=this.length-1),r=n+16;n<r;++n)e.push(i[n])}else{const t=Matrix4.Identity;for(let i=0;i<16;++i)e.push(t[i])}},enable:function(t,e,i){e.enableMatrix4Attrib(t,this._name.getValue(),i,0,0)}}),s})),define("x_ite/Components/Shaders/PackagedShader",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Shaders/X3DShaderNode","x_ite/Components/Networking/X3DUrlObject","x_ite/Components/Shaders/X3DProgrammableShaderObject","x_ite/Base/X3DConstants"],(function(t,e,i,n,r,s,o){"use strict";function a(t){n.call(this,t),r.call(this,t),s.call(this,t),this.addType(o.PackagedShader)}return a.prototype=Object.assign(Object.create(n.prototype),r.prototype,s.prototype,{constructor:a,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.inputOnly,"activate",new t.SFBool),new e(o.outputOnly,"isSelected",new t.SFBool),new e(o.outputOnly,"isValid",new t.SFBool),new e(o.initializeOnly,"language",new t.SFString),new e(o.inputOutput,"load",new t.SFBool(!0)),new e(o.inputOutput,"url",new t.MFString),new e(o.inputOutput,"autoRefresh",new t.SFTime),new e(o.inputOutput,"autoRefreshTimeLimit",new t.SFTime(3600))]),getTypeName:function(){return"PackagedShader"},getComponentName:function(){return"Shaders"},getContainerField:function(){return"shaders"},getSourceText:function(){return this._url},requestImmediateLoad:function(t=!0){},requestUnload:function(){}}),a})),define("x_ite/Components/Shaders/ProgramShader",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Shaders/X3DShaderNode","x_ite/Base/X3DConstants"],(function(t,e,i,n,r){"use strict";function s(t){n.call(this,t),this.addType(r.ProgramShader)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOnly,"activate",new t.SFBool),new e(r.outputOnly,"isSelected",new t.SFBool),new e(r.outputOnly,"isValid",new t.SFBool),new e(r.initializeOnly,"language",new t.SFString),new e(r.inputOutput,"programs",new t.MFNode)]),getTypeName:function(){return"ProgramShader"},getComponentName:function(){return"Shaders"},getContainerField:function(){return"shaders"}}),s})),define("x_ite/Components/Shaders/ShaderProgram",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Components/Networking/X3DUrlObject","x_ite/Components/Shaders/X3DProgrammableShaderObject","x_ite/Base/X3DConstants"],(function(t,e,i,n,r,s,o){"use strict";function a(t){n.call(this,t),r.call(this,t),s.call(this,t),this.addType(o.ShaderProgram)}return a.prototype=Object.assign(Object.create(n.prototype),r.prototype,s.prototype,{constructor:a,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.initializeOnly,"type",new t.SFString("VERTEX")),new e(o.inputOutput,"load",new t.SFBool(!0)),new e(o.inputOutput,"url",new t.MFString),new e(o.inputOutput,"autoRefresh",new t.SFTime),new e(o.inputOutput,"autoRefreshTimeLimit",new t.SFTime(3600))]),getTypeName:function(){return"ShaderProgram"},getComponentName:function(){return"Shaders"},getContainerField:function(){return"programs"},getSourceText:function(){return this._url},requestImmediateLoad:function(t=!0){},requestUnload:function(){}}),a})),define("x_ite/Components/Shaders",["x_ite/Configuration/SupportedNodes","x_ite/Components/Shaders/ComposedShader","x_ite/Components/Shaders/FloatVertexAttribute","x_ite/Components/Shaders/Matrix3VertexAttribute","x_ite/Components/Shaders/Matrix4VertexAttribute","x_ite/Components/Shaders/PackagedShader","x_ite/Components/Shaders/ProgramShader","x_ite/Components/Shaders/ShaderPart","x_ite/Components/Shaders/ShaderProgram","x_ite/Components/Shaders/X3DProgrammableShaderObject","x_ite/Components/Shaders/X3DShaderNode","x_ite/Components/Shaders/X3DVertexAttributeNode"],(function(t,e,i,n,r,s,o,a,u,l,c,h){"use strict";const d={ComposedShader:e,FloatVertexAttribute:i,Matrix3VertexAttribute:n,Matrix4VertexAttribute:r,PackagedShader:s,ProgramShader:o,ShaderPart:a,ShaderProgram:u},p={X3DProgrammableShaderObject:l,X3DShaderNode:c,X3DVertexAttributeNode:h};for(const e in d)t.addType(e,d[e]);for(const e in p)t.addAbstractType(e,p[e])})),define("x_ite/Components/Shape/AcousticProperties",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Shape/X3DAppearanceChildNode","x_ite/Base/X3DConstants"],(function(t,e,i,n,r){"use strict";function s(t){n.call(this,t),this.addType(r.AcousticProperties)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"description",new t.SFString),new e(r.inputOutput,"enabled",new t.SFBool(!0)),new e(r.inputOutput,"absorption",new t.SFFloat),new e(r.inputOutput,"refraction",new t.SFFloat),new e(r.inputOutput,"diffuse",new t.SFFloat),new e(r.inputOutput,"specular",new t.SFFloat)]),getTypeName:function(){return"AcousticProperties"},getComponentName:function(){return"Shape"},getContainerField:function(){return"AcousticProperties"}}),s})),define("x_ite/Components/Shape/FillProperties",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Shape/X3DAppearanceChildNode","x_ite/Base/X3DConstants"],(function(t,e,i,n,r){"use strict";function s(e){n.call(this,e),this.addType(r.FillProperties),this.addChildObjects("transparent",new t.SFBool),this._transparent.setAccessType(r.outputOnly),this.hatchColor=new Float32Array(3)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"filled",new t.SFBool(!0)),new e(r.inputOutput,"hatched",new t.SFBool(!0)),new e(r.inputOutput,"hatchColor",new t.SFColor(1,1,1)),new e(r.inputOutput,"hatchStyle",new t.SFInt32(1))]),getTypeName:function(){return"FillProperties"},getComponentName:function(){return"Shape"},getContainerField:function(){return"fillProperties"},initialize:function(){n.prototype.initialize.call(this),this._filled.addInterest("set_filled__",this),this._hatched.addInterest("set_hatched__",this),this._hatchColor.addInterest("set_hatchColor__",this),this._hatchStyle.addInterest("set_hatchStyle__",this),this.set_filled__(),this.set_hatched__(),this.set_hatchColor__(),this.set_hatchStyle__()},set_filled__:function(){this.filled=this._filled.getValue(),this.setTransparent(!this.filled)},set_hatched__:function(){this.hatched=this._hatched.getValue()},set_hatchColor__:function(){this.hatchColor[0]=this._hatchColor[0],this.hatchColor[1]=this._hatchColor[1],this.hatchColor[2]=this._hatchColor[2]},set_hatchStyle__:function(){let t=this._hatchStyle.getValue();(t<1||t>19)&&(t=1),this.hatchStyle=t},setTransparent:function(t){t!==this._transparent.getValue()&&(this._transparent=t)},getTransparent:function(){return this._transparent.getValue()},setShaderUniforms:function(t,e){const i=this.hatched;if(t.uniform1i(e.x3d_FillPropertiesFilled,this.filled),t.uniform1i(e.x3d_FillPropertiesHatched,i),i){const i=e.getBrowser(),n=i.getHatchStyleTexture(this.hatchStyle),r=i.getTexture2DUnit();t.uniform3fv(e.x3d_FillPropertiesHatchColor,this.hatchColor),t.activeTexture(t.TEXTURE0+r),t.bindTexture(t.TEXTURE_2D,n.getTexture()),t.uniform1i(e.x3d_FillPropertiesTexture,r)}}}),s})),define("x_ite/Components/Shape/LineProperties",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Shape/X3DAppearanceChildNode","x_ite/Base/X3DConstants"],(function(t,e,i,n,r){"use strict";function s(t){n.call(this,t),this.addType(r.LineProperties)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"applied",new t.SFBool(!0)),new e(r.inputOutput,"linetype",new t.SFInt32(1)),new e(r.inputOutput,"linewidthScaleFactor",new t.SFFloat)]),getTypeName:function(){return"LineProperties"},getComponentName:function(){return"Shape"},getContainerField:function(){return"lineProperties"},initialize:function(){n.prototype.initialize.call(this),this._applied.addInterest("set_applied__",this),this._linetype.addInterest("set_linetype__",this),this._linewidthScaleFactor.addInterest("set_linewidthScaleFactor__",this),this.set_applied__(),this.set_linetype__(),this.set_linewidthScaleFactor__(),this.mustTransformLines&&this.getBrowser().getLineTransformShader()},getApplied:function(){return this.applied},getLinetype:function(){return this.linetype},getLinewidthScaleFactor:function(){return this.linewidthScaleFactor},getMustTransformLines:function(){return this.mustTransformLines},set_applied__:function(){this.applied=this._applied.getValue()},set_linetype__:function(){let t=this._linetype.getValue();(t<1||t>16)&&(t=1),this.linetype=t},set_linewidthScaleFactor__:function(){const t=this.getBrowser().getContext();this.linewidthScaleFactor=Math.max(1,this._linewidthScaleFactor.getValue()),this.mustTransformLines=t.MUST_TRANSFORM_LINES&&this.linewidthScaleFactor>1},setShaderUniforms:function(t,e){if(this.applied){const i=e.getBrowser(),n=i.getTexture2DUnit();t.lineWidth(this.linewidthScaleFactor),t.uniform1i(e.x3d_LinePropertiesApplied,!0),t.uniform1i(e.x3d_LinePropertiesLinetype,this.linetype),t.activeTexture(t.TEXTURE0+n),t.bindTexture(t.TEXTURE_2D,i.getLinetypeTexture().getTexture()),t.uniform1i(e.x3d_LinePropertiesTexture,n)}else t.lineWidth(1),t.uniform1i(e.x3d_LinePropertiesApplied,!1)}}),s})),define("x_ite/Components/Shape/Material",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Shape/X3DOneSidedMaterialNode","x_ite/Browser/Core/Shading","x_ite/Base/X3DCast","x_ite/Base/X3DConstants","standard/Math/Algorithm"],(function(t,e,i,n,r,s,o,a){"use strict";function u(t){n.call(this,t),this.addType(o.Material),this.diffuseColor=new Float32Array(3),this.specularColor=new Float32Array(3)}return u.prototype=Object.assign(Object.create(n.prototype),{constructor:u,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.inputOutput,"ambientIntensity",new t.SFFloat(.2)),new e(o.inputOutput,"ambientTexture",new t.SFNode),new e(o.inputOutput,"ambientTextureMapping",new t.SFString),new e(o.inputOutput,"diffuseColor",new t.SFColor(.8,.8,.8)),new e(o.inputOutput,"diffuseTexture",new t.SFNode),new e(o.inputOutput,"diffuseTextureMapping",new t.SFString),new e(o.inputOutput,"specularColor",new t.SFColor),new e(o.inputOutput,"specularTexture",new t.SFNode),new e(o.inputOutput,"specularTextureMapping",new t.SFString),new e(o.inputOutput,"emissiveColor",new t.SFColor),new e(o.inputOutput,"emissiveTexture",new t.SFNode),new e(o.inputOutput,"emissiveTextureMapping",new t.SFString),new e(o.inputOutput,"shininess",new t.SFFloat(.2)),new e(o.inputOutput,"shininessTexture",new t.SFNode),new e(o.inputOutput,"shininessTextureMapping",new t.SFString),new e(o.inputOutput,"occlusionStrength",new t.SFFloat(1)),new e(o.inputOutput,"occlusionTexture",new t.SFNode),new e(o.inputOutput,"occlusionTextureMapping",new t.SFString),new e(o.inputOutput,"normalScale",new t.SFFloat(1)),new e(o.inputOutput,"normalTexture",new t.SFNode),new e(o.inputOutput,"normalTextureMapping",new t.SFString),new e(o.inputOutput,"transparency",new t.SFFloat)]),getTypeName:function(){return"Material"},getComponentName:function(){return"Shape"},getContainerField:function(){return"material"},initialize:function(){n.prototype.initialize.call(this),this._ambientIntensity.addInterest("set_ambientIntensity__",this),this._ambientTexture.addInterest("set_ambientTexture__",this),this._diffuseColor.addInterest("set_diffuseColor__",this),this._diffuseTexture.addInterest("set_diffuseTexture__",this),this._specularColor.addInterest("set_specularColor__",this),this._specularTexture.addInterest("set_specularTexture__",this),this._shininess.addInterest("set_shininess__",this),this._shininessTexture.addInterest("set_shininessTexture__",this),this._occlusionStrength.addInterest("set_occlusionStrength__",this),this._occlusionTexture.addInterest("set_occlusionTexture__",this),this.set_ambientIntensity__(),this.set_ambientTexture__(),this.set_diffuseColor__(),this.set_diffuseTexture__(),this.set_specularColor__(),this.set_specularTexture__(),this.set_shininess__(),this.set_shininessTexture__(),this.set_occlusionStrength__(),this.set_occlusionTexture__(),this.set_transparent__()},set_ambientIntensity__:function(){this.ambientIntensity=a.clamp(this._ambientIntensity.getValue(),0,1)},set_ambientTexture__:function(){this.ambientTextureNode=s(o.X3DSingleTextureNode,this._ambientTexture),this.setTexture(this.getTextureIndices().AMBIENT_TEXTURE,this.ambientTextureNode)},set_diffuseColor__:function(){const t=this.diffuseColor,e=this._diffuseColor.getValue();t[0]=e.r,t[1]=e.g,t[2]=e.b},set_diffuseTexture__:function(){this.diffuseTextureNode&&this.diffuseTextureNode._transparent.removeInterest("set_transparent__",this),this.diffuseTextureNode=s(o.X3DSingleTextureNode,this._diffuseTexture),this.diffuseTextureNode&&this.diffuseTextureNode._transparent.addInterest("set_transparent__",this),this.setTexture(this.getTextureIndices().DIFFUSE_TEXTURE,this.diffuseTextureNode)},set_specularColor__:function(){const t=this.specularColor,e=this._specularColor.getValue();t[0]=e.r,t[1]=e.g,t[2]=e.b},set_specularTexture__:function(){this.specularTextureNode=s(o.X3DSingleTextureNode,this._specularTexture),this.setTexture(this.getTextureIndices().SPECULAR_TEXTURE,this.specularTextureNode)},set_shininess__:function(){this.shininess=a.clamp(this._shininess.getValue(),0,1)},set_shininessTexture__:function(){this.shininessTextureNode=s(o.X3DSingleTextureNode,this._shininessTexture),this.setTexture(this.getTextureIndices().SHININESS_TEXTURE,this.shininessTextureNode)},set_occlusionStrength__:function(){this.occlusionStrength=a.clamp(this._occlusionStrength.getValue(),0,1)},set_occlusionTexture__:function(){this.occlusionTextureNode=s(o.X3DSingleTextureNode,this._occlusionTexture),this.setTexture(this.getTextureIndices().OCCLUSION_TEXTURE,this.occlusionTextureNode)},set_transparent__:function(){this.setTransparent(Boolean(this.getTransparency()||this.diffuseTextureNode&&this.diffuseTextureNode.getTransparent()))},getTextureIndices:function(){const t={AMBIENT_TEXTURE:0,DIFFUSE_TEXTURE:1,SPECULAR_TEXTURE:2,EMISSIVE_TEXTURE:3,SHININESS_TEXTURE:4,OCCLUSION_TEXTURE:5,NORMAL_TEXTURE:6};return function(){return t}}(),getMaterialType:function(t){return t||+this.getTextureBits()||this.getBrowser().getBrowserOptions().getShading()===r.PHONG?2:1},createShader:function(t,e,i){const n=this.getBrowser(),r=i.appearanceNode.getStyleProperties(e.geometryType),s=[];if(!e.hasNormals)return n.getDefaultMaterial().createShader(t,e,i);switch(s.push(this.getGeometryType(e.geometryType)),i.shadows&&s.push("X3D_SHADOWS","X3D_PCF_FILTERING"),i.fogNode&&s.push("X3D_FOG"),e.hasFogCoords&&s.push("X3D_FOG_COORDS"),e.colorMaterial&&s.push("X3D_COLOR_MATERIAL"),s.push("X3D_NORMALS"),r&&s.push("X3D_STYLE_PROPERTIES"),+this.getTextureBits()&&(s.push("X3D_MATERIAL_TEXTURES"),this.ambientTextureNode&&s.push("X3D_AMBIENT_TEXTURE","X3D_AMBIENT_TEXTURE_"+this.ambientTextureNode.getTextureTypeString()),this.diffuseTextureNode&&s.push("X3D_DIFFUSE_TEXTURE","X3D_DIFFUSE_TEXTURE_"+this.diffuseTextureNode.getTextureTypeString()),this.specularTextureNode&&s.push("X3D_SPECULAR_TEXTURE","X3D_SPECULAR_TEXTURE_"+this.specularTextureNode.getTextureTypeString()),this.getEmissiveTexture()&&s.push("X3D_EMISSIVE_TEXTURE","X3D_EMISSIVE_TEXTURE_"+this.getEmissiveTexture().getTextureTypeString()),this.shininessTextureNode&&s.push("X3D_SHININESS_TEXTURE","X3D_SHININESS_TEXTURE_"+this.shininessTextureNode.getTextureTypeString()),this.occlusionTextureNode&&s.push("X3D_OCCLUSION_TEXTURE","X3D_OCCLUSION_TEXTURE_"+this.occlusionTextureNode.getTextureTypeString()),this.getNormalTexture()&&s.push("X3D_NORMAL_TEXTURE","X3D_NORMAL_TEXTURE_"+this.getNormalTexture().getTextureTypeString())),this.getMaterialType(i.shadows)){case 1:s.push("X3D_GOURAUD");var o=n.createShader("GouraudShader","Gouraud","Gouraud",s);break;case 2:s.push("X3D_PHONG");o=n.createShader("PhongShader","Default","Phong",s)}return n.getShaders().set(t,o),o},setShaderUniforms:function(t,e,i,r,s){if(n.prototype.setShaderUniforms.call(this,t,e,i,r,s),t.uniform1f(e.x3d_AmbientIntensity,this.ambientIntensity),t.uniform3fv(e.x3d_DiffuseColor,this.diffuseColor),t.uniform3fv(e.x3d_SpecularColor,this.specularColor),t.uniform1f(e.x3d_Shininess,this.shininess),+this.getTextureBits()){const n=e.x3d_AmbientTexture,o=e.x3d_DiffuseTexture,a=e.x3d_SpecularTexture,u=e.x3d_ShininessTexture,l=e.x3d_OcclusionTexture;this.ambientTextureNode&&(this.ambientTextureNode.setShaderUniformsToChannel(t,e,i,n),t.uniform1i(n.textureTransformMapping,r.get(this._ambientTextureMapping.getValue())||0),t.uniform1i(n.textureCoordinateMapping,s.get(this._ambientTextureMapping.getValue())||0)),this.diffuseTextureNode&&(this.diffuseTextureNode.setShaderUniformsToChannel(t,e,i,o),t.uniform1i(o.textureTransformMapping,r.get(this._diffuseTextureMapping.getValue())||0),t.uniform1i(o.textureCoordinateMapping,s.get(this._diffuseTextureMapping.getValue())||0)),this.specularTextureNode&&(this.specularTextureNode.setShaderUniformsToChannel(t,e,i,a),t.uniform1i(a.textureTransformMapping,r.get(this._specularTextureMapping.getValue())||0),t.uniform1i(a.textureCoordinateMapping,s.get(this._specularTextureMapping.getValue())||0)),this.shininessTextureNode&&(this.shininessTextureNode.setShaderUniformsToChannel(t,e,i,u),t.uniform1i(u.textureTransformMapping,r.get(this._shininessTextureMapping.getValue())||0),t.uniform1i(u.textureCoordinateMapping,s.get(this._shininessTextureMapping.getValue())||0)),this.occlusionTextureNode&&(t.uniform1f(e.x3d_OcclusionStrength,this.occlusionStrength),this.occlusionTextureNode.setShaderUniformsToChannel(t,e,i,l),t.uniform1i(l.textureTransformMapping,r.get(this._occlusionTextureMapping.getValue())||0),t.uniform1i(l.textureCoordinateMapping,s.get(this._occlusionTextureMapping.getValue())||0))}}}),u})),define("x_ite/Components/Shape/PhysicalMaterial",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Shape/X3DOneSidedMaterialNode","x_ite/Base/X3DCast","x_ite/Base/X3DConstants","standard/Math/Algorithm"],(function(t,e,i,n,r,s,o){"use strict";function a(t){n.call(this,t),this.addType(s.PhysicalMaterial),this.baseColor=new Float32Array(3)}return a.prototype=Object.assign(Object.create(n.prototype),{constructor:a,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.inputOutput,"baseColor",new t.SFColor(1,1,1)),new e(s.inputOutput,"baseTexture",new t.SFNode),new e(s.inputOutput,"baseTextureMapping",new t.SFString),new e(s.inputOutput,"emissiveColor",new t.SFColor(0,0,0)),new e(s.inputOutput,"emissiveTexture",new t.SFNode),new e(s.inputOutput,"emissiveTextureMapping",new t.SFString),new e(s.inputOutput,"metallic",new t.SFFloat(1)),new e(s.inputOutput,"roughness",new t.SFFloat(1)),new e(s.inputOutput,"metallicRoughnessTexture",new t.SFNode),new e(s.inputOutput,"metallicRoughnessTextureMapping",new t.SFString),new e(s.inputOutput,"occlusionStrength",new t.SFFloat(1)),new e(s.inputOutput,"occlusionTexture",new t.SFNode),new e(s.inputOutput,"occlusionTextureMapping",new t.SFString),new e(s.inputOutput,"normalScale",new t.SFFloat(1)),new e(s.inputOutput,"normalTexture",new t.SFNode),new e(s.inputOutput,"normalTextureMapping",new t.SFString),new e(s.inputOutput,"transparency",new t.SFFloat)]),getTypeName:function(){return"PhysicalMaterial"},getComponentName:function(){return"Shape"},getContainerField:function(){return"material"},initialize:function(){n.prototype.initialize.call(this),this._baseColor.addInterest("set_baseColor__",this),this._baseTexture.addInterest("set_baseTexture__",this),this._metallic.addInterest("set_metallic__",this),this._roughness.addInterest("set_roughness__",this),this._metallicRoughnessTexture.addInterest("set_metallicRoughnessTexture__",this),this._occlusionStrength.addInterest("set_occlusionStrength__",this),this._occlusionTexture.addInterest("set_occlusionTexture__",this),this.set_baseColor__(),this.set_baseTexture__(),this.set_metallic__(),this.set_roughness__(),this.set_metallicRoughnessTexture__(),this.set_occlusionStrength__(),this.set_occlusionTexture__(),this.set_transparent__()},set_baseColor__:function(){const t=this.baseColor,e=this._baseColor.getValue();t[0]=e.r,t[1]=e.g,t[2]=e.b},set_baseTexture__:function(){this.baseTextureNode&&this.baseTextureNode._transparent.removeInterest("set_transparent__",this),this.baseTextureNode=r(s.X3DSingleTextureNode,this._baseTexture),this.setTexture(this.getTextureIndices().BASE_TEXTURE,this.baseTextureNode),this.baseTextureNode&&this.baseTextureNode._transparent.addInterest("set_transparent__",this)},set_metallic__:function(){this.metallic=o.clamp(this._metallic.getValue(),0,1)},set_roughness__:function(){this.roughness=o.clamp(this._roughness.getValue(),0,1)},set_metallicRoughnessTexture__:function(){this.metallicRoughnessTextureNode=r(s.X3DSingleTextureNode,this._metallicRoughnessTexture),this.setTexture(this.getTextureIndices().METALLIC_ROUGHNESS_TEXTURE,this.metallicRoughnessTextureNode)},set_occlusionStrength__:function(){this.occlusionStrength=o.clamp(this._occlusionStrength.getValue(),0,1)},set_occlusionTexture__:function(){this.occlusionTextureNode=r(s.X3DSingleTextureNode,this._occlusionTexture),this.setTexture(this.getTextureIndices().OCCLUSION_TEXTURE,this.occlusionTextureNode)},set_transparent__:function(){this.setTransparent(Boolean(this.getTransparency()||this.baseTextureNode&&this.baseTextureNode.getTransparent()))},getTextureIndices:function(){const t={BASE_TEXTURE:0,EMISSIVE_TEXTURE:1,METALLIC_ROUGHNESS_TEXTURE:2,OCCLUSION_TEXTURE:3,NORMAL_TEXTURE:4};return function(){return t}}(),getMaterialType:function(){return 3},createShader:function(t,e,i){const n=this.getBrowser(),r=i.appearanceNode.getStyleProperties(e.geometryType),s=[];if(!e.hasNormals)return n.getDefaultMaterial().createShader(t,e,i);s.push("X3D_PHYSICAL",this.getGeometryType(e.geometryType)),i.shadows&&s.push("X3D_SHADOWS","X3D_PCF_FILTERING"),i.fogNode&&s.push("X3D_FOG"),e.hasFogCoords&&s.push("X3D_FOG_COORDS"),e.colorMaterial&&s.push("X3D_COLOR_MATERIAL"),s.push("X3D_NORMALS"),r&&s.push("X3D_STYLE_PROPERTIES"),+this.getTextureBits()&&(s.push("X3D_MATERIAL_TEXTURES"),this.baseTextureNode&&s.push("X3D_BASE_TEXTURE","X3D_BASE_TEXTURE_"+this.baseTextureNode.getTextureTypeString()),this.getEmissiveTexture()&&s.push("X3D_EMISSIVE_TEXTURE","X3D_EMISSIVE_TEXTURE_"+this.getEmissiveTexture().getTextureTypeString()),this.metallicRoughnessTextureNode&&s.push("X3D_METALLIC_ROUGHNESS_TEXTURE","X3D_METALLIC_ROUGHNESS_TEXTURE_"+this.metallicRoughnessTextureNode.getTextureTypeString()),this.occlusionTextureNode&&s.push("X3D_OCCLUSION_TEXTURE","X3D_OCCLUSION_TEXTURE_"+this.occlusionTextureNode.getTextureTypeString()),this.getNormalTexture()&&s.push("X3D_NORMAL_TEXTURE","X3D_NORMAL_TEXTURE_"+this.getNormalTexture().getTextureTypeString()));const o=n.createShader("PhysicalMaterialShader","Default","PBR",s);return n.getShaders().set(t,o),o},setShaderUniforms:function(t,e,i,r,s){if(n.prototype.setShaderUniforms.call(this,t,e,i,r,s),t.uniform3fv(e.x3d_BaseColor,this.baseColor),t.uniform1f(e.x3d_Metallic,this.metallic),t.uniform1f(e.x3d_Roughness,this.roughness),+this.getTextureBits()){const n=e.x3d_BaseTexture,o=e.x3d_MetallicRoughnessTexture,a=e.x3d_OcclusionTexture;this.baseTextureNode&&(this.baseTextureNode.setShaderUniformsToChannel(t,e,i,n),t.uniform1i(n.textureTransformMapping,r.get(this._baseTextureMapping.getValue())||0),t.uniform1i(n.textureCoordinateMapping,s.get(this._baseTextureMapping.getValue())||0)),this.metallicRoughnessTextureNode&&(this.metallicRoughnessTextureNode.setShaderUniformsToChannel(t,e,i,o),t.uniform1i(o.textureTransformMapping,r.get(this._metallicRoughnessTextureMapping.getValue())||0),t.uniform1i(o.textureCoordinateMapping,s.get(this._metallicRoughnessTextureMapping.getValue())||0)),this.occlusionTextureNode&&(t.uniform1f(e.x3d_OcclusionStrength,this.occlusionStrength),this.occlusionTextureNode.setShaderUniformsToChannel(t,e,i,a),t.uniform1i(a.textureTransformMapping,r.get(this._occlusionTextureMapping.getValue())||0),t.uniform1i(a.textureCoordinateMapping,s.get(this._occlusionTextureMapping.getValue())||0))}}}),a})),define("x_ite/Components/Shape/PointProperties",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Shape/X3DAppearanceChildNode","x_ite/Base/X3DConstants","standard/Math/Algorithm","standard/Math/Numbers/Vector3"],(function(t,e,i,n,r,s,o){"use strict";function a(t){n.call(this,t),this.addType(r.PointProperties),this.pointSizeAttenuation=new Float32Array(3)}return a.prototype=Object.assign(Object.create(n.prototype),{constructor:a,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"pointSizeScaleFactor",new t.SFFloat(1)),new e(r.inputOutput,"pointSizeMinValue",new t.SFFloat(1)),new e(r.inputOutput,"pointSizeMaxValue",new t.SFFloat(1)),new e(r.inputOutput,"pointSizeAttenuation",new t.MFFloat(1,0,0)),new e(r.inputOutput,"markerType",new t.SFInt32(1))]),getTypeName:function(){return"PointProperties"},getComponentName:function(){return"Shape"},getContainerField:function(){return"pointProperties"},initialize:function(){n.prototype.initialize.call(this);const t=this.getBrowser().getContext();this.pointSizeRange=t.getParameter(t.ALIASED_POINT_SIZE_RANGE),this._pointSizeScaleFactor.addInterest("set_pointSizeScaleFactor__",this),this._pointSizeMinValue.addInterest("set_pointSizeMinValue__",this),this._pointSizeMaxValue.addInterest("set_pointSizeMaxValue__",this),this._pointSizeAttenuation.addInterest("set_pointSizeAttenuation__",this),this._markerType.addInterest("set_markerType__",this),this.set_pointSizeScaleFactor__(),this.set_pointSizeMinValue__(),this.set_pointSizeMaxValue__(),this.set_pointSizeAttenuation__(),this.set_markerType__()},getPointSize:function(t){const e=this.pointSizeAttenuation,i=t.magnitude();let n=this.pointSizeScaleFactor;return n/=e[0]+e[1]*i+e[2]*(i*i),n=s.clamp(n,this.pointSizeMinValue,this.pointSizeMaxValue),n},set_pointSizeScaleFactor__:function(){this.pointSizeScaleFactor=Math.max(1,this._pointSizeScaleFactor.getValue())},set_pointSizeMinValue__:function(){this.pointSizeMinValue=s.clamp(this._pointSizeMinValue.getValue(),this.pointSizeRange[0],this.pointSizeRange[1])},set_pointSizeMaxValue__:function(){this.pointSizeMaxValue=s.clamp(this._pointSizeMaxValue.getValue(),this.pointSizeRange[0],this.pointSizeRange[1])},set_pointSizeAttenuation__:function(){const t=this._pointSizeAttenuation.length;this.pointSizeAttenuation[0]=t>0?Math.max(0,this._pointSizeAttenuation[0]):1,this.pointSizeAttenuation[1]=t>1?Math.max(0,this._pointSizeAttenuation[1]):0,this.pointSizeAttenuation[2]=t>2?Math.max(0,this._pointSizeAttenuation[2]):0},set_markerType__:function(){},setShaderUniforms:function(t,e){t.uniform1f(e.x3d_PointPropertiesPointSizeScaleFactor,this.pointSizeScaleFactor),t.uniform1f(e.x3d_PointPropertiesPointSizeMinValue,this.pointSizeMinValue),t.uniform1f(e.x3d_PointPropertiesPointSizeMaxValue,this.pointSizeMaxValue),t.uniform3fv(e.x3d_PointPropertiesPointSizeAttenuation,this.pointSizeAttenuation)}}),a})),define("x_ite/Components/Shape/TwoSidedMaterial",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Shape/X3DMaterialNode","x_ite/Components/Shape/Material","x_ite/Base/X3DConstants","standard/Math/Algorithm"],(function(t,e,i,n,r,s,o){"use strict";function a(t){console.warn("TwoSidedMaterial is depreciated, please use Appearance backMaterial field."),n.call(this,t),this.addType(s.TwoSidedMaterial),this.diffuseColor=new Float32Array(3),this.specularColor=new Float32Array(3),this.emissiveColor=new Float32Array(3),this.backDiffuseColor=new Float32Array(3),this.backSpecularColor=new Float32Array(3),this.backEmissiveColor=new Float32Array(3)}return a.prototype=Object.assign(Object.create(n.prototype),{constructor:a,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.inputOutput,"separateBackColor",new t.SFBool),new e(s.inputOutput,"ambientIntensity",new t.SFFloat(.2)),new e(s.inputOutput,"diffuseColor",new t.SFColor(.8,.8,.8)),new e(s.inputOutput,"specularColor",new t.SFColor),new e(s.inputOutput,"emissiveColor",new t.SFColor),new e(s.inputOutput,"shininess",new t.SFFloat(.2)),new e(s.inputOutput,"transparency",new t.SFFloat),new e(s.inputOutput,"backAmbientIntensity",new t.SFFloat(.2)),new e(s.inputOutput,"backDiffuseColor",new t.SFColor(.8,.8,.8)),new e(s.inputOutput,"backSpecularColor",new t.SFColor),new e(s.inputOutput,"backEmissiveColor",new t.SFColor),new e(s.inputOutput,"backShininess",new t.SFFloat(.2)),new e(s.inputOutput,"backTransparency",new t.SFFloat)]),getTypeName:function(){return"TwoSidedMaterial"},getComponentName:function(){return"Shape"},getContainerField:function(){return"material"},initialize:function(){n.prototype.initialize.call(this),this._ambientIntensity.addInterest("set_ambientIntensity__",this),this._diffuseColor.addInterest("set_diffuseColor__",this),this._specularColor.addInterest("set_specularColor__",this),this._emissiveColor.addInterest("set_emissiveColor__",this),this._shininess.addInterest("set_shininess__",this),this._transparency.addInterest("set_transparency__",this),this._backAmbientIntensity.addInterest("set_backAmbientIntensity__",this),this._backDiffuseColor.addInterest("set_backDiffuseColor__",this),this._backSpecularColor.addInterest("set_backSpecularColor__",this),this._backEmissiveColor.addInterest("set_backEmissiveColor__",this),this._backShininess.addInterest("set_backShininess__",this),this._backTransparency.addInterest("set_backTransparency__",this),this._separateBackColor.addInterest("set_transparent__",this),this._transparency.addInterest("set_transparent__",this),this._backTransparency.addInterest("set_transparent__",this),this.set_ambientIntensity__(),this.set_diffuseColor__(),this.set_specularColor__(),this.set_emissiveColor__(),this.set_shininess__(),this.set_transparency__(),this.set_backAmbientIntensity__(),this.set_backDiffuseColor__(),this.set_backSpecularColor__(),this.set_backEmissiveColor__(),this.set_backShininess__(),this.set_backTransparency__(),this.set_transparent__()},set_ambientIntensity__:function(){this.ambientIntensity=Math.max(this._ambientIntensity.getValue(),0)},set_diffuseColor__:function(){const t=this.diffuseColor,e=this._diffuseColor.getValue();t[0]=e.r,t[1]=e.g,t[2]=e.b},set_specularColor__:function(){const t=this.specularColor,e=this._specularColor.getValue();t[0]=e.r,t[1]=e.g,t[2]=e.b},set_emissiveColor__:function(){const t=this.emissiveColor,e=this._emissiveColor.getValue();t[0]=e.r,t[1]=e.g,t[2]=e.b},set_shininess__:function(){this.shininess=o.clamp(this._shininess.getValue(),0,1)},set_transparency__:function(){this.transparency=o.clamp(this._transparency.getValue(),0,1)},set_backAmbientIntensity__:function(){this.backAmbientIntensity=Math.max(this._backAmbientIntensity.getValue(),0)},set_backDiffuseColor__:function(){const t=this.backDiffuseColor,e=this._backDiffuseColor.getValue();t[0]=e.r,t[1]=e.g,t[2]=e.b},set_backSpecularColor__:function(){const t=this.backSpecularColor,e=this._backSpecularColor.getValue();t[0]=e.r,t[1]=e.g,t[2]=e.b},set_backEmissiveColor__:function(){const t=this.backEmissiveColor,e=this._backEmissiveColor.getValue();t[0]=e.r,t[1]=e.g,t[2]=e.b},set_backShininess__:function(){this.backShininess=o.clamp(this._backShininess.getValue(),0,1)},set_backTransparency__:function(){this.backTransparency=o.clamp(this._backTransparency.getValue(),0,1)},set_transparent__:function(){this.setTransparent(Boolean(this._transparency.getValue()||this._separateBackColor.getValue()&&this._backTransparency.getValue()))},getMaterialType:r.prototype.getMaterialType,createShader:r.prototype.createShader,setShaderUniforms:function(t,e,i,n,r,s){!s&&this._separateBackColor.getValue()?(t.uniform1f(e.x3d_AmbientIntensity,this.backAmbientIntensity),t.uniform3fv(e.x3d_DiffuseColor,this.backDiffuseColor),t.uniform3fv(e.x3d_SpecularColor,this.backSpecularColor),t.uniform3fv(e.x3d_EmissiveColor,this.backEmissiveColor),t.uniform1f(e.x3d_Shininess,this.backShininess),t.uniform1f(e.x3d_Transparency,this.backTransparency)):(t.uniform1f(e.x3d_AmbientIntensity,this.ambientIntensity),t.uniform3fv(e.x3d_DiffuseColor,this.diffuseColor),t.uniform3fv(e.x3d_SpecularColor,this.specularColor),t.uniform3fv(e.x3d_EmissiveColor,this.emissiveColor),t.uniform1f(e.x3d_Shininess,this.shininess),t.uniform1f(e.x3d_Transparency,this.transparency))}}),a})),define("x_ite/Components/Shape",["x_ite/Configuration/SupportedNodes","x_ite/Components/Shape/AcousticProperties","x_ite/Components/Shape/Appearance","x_ite/Components/Shape/FillProperties","x_ite/Components/Shape/LineProperties","x_ite/Components/Shape/Material","x_ite/Components/Shape/PhysicalMaterial","x_ite/Components/Shape/PointProperties","x_ite/Components/Shape/Shape","x_ite/Components/Shape/TwoSidedMaterial","x_ite/Components/Shape/UnlitMaterial","x_ite/Components/Shape/X3DAppearanceChildNode","x_ite/Components/Shape/X3DAppearanceNode","x_ite/Components/Shape/X3DMaterialNode","x_ite/Components/Shape/X3DOneSidedMaterialNode","x_ite/Components/Shape/X3DShapeNode"],(function(t,e,i,n,r,s,o,a,u,l,c,h,d,p,f,g){"use strict";const m={AcousticProperties:e,Appearance:i,FillProperties:n,LineProperties:r,Material:s,PhysicalMaterial:o,PointProperties:a,Shape:u,TwoSidedMaterial:l,UnlitMaterial:c},_={X3DAppearanceChildNode:h,X3DAppearanceNode:d,X3DMaterialNode:p,X3DOneSidedMaterialNode:f,X3DShapeNode:g};for(const e in m)t.addType(e,m[e]);for(const e in _)t.addAbstractType(e,_[e])})),define("x_ite/Components/Sound/X3DSoundSourceNode",["x_ite/Fields","x_ite/Components/Core/X3DChildNode","x_ite/Components/Time/X3DTimeDependentNode","x_ite/Base/X3DConstants","standard/Math/Algorithm"],(function(t,e,i,n,r){"use strict";function s(t){e.call(this,t),i.call(this,t),this.addType(n.X3DSoundSourceNode),this.volume=0,this.media=null}return s.prototype=Object.assign(Object.create(e.prototype),i.prototype,{constructor:s,initialize:function(){e.prototype.initialize.call(this),i.prototype.initialize.call(this)},set_live__:function(){i.prototype.set_live__.call(this),this.getDisabled()?(this.getBrowser()._volume.removeInterest("set_volume__",this),this.getBrowser()._mute.removeInterest("set_volume__",this)):(this.getBrowser()._volume.addInterest("set_volume__",this),this.getBrowser()._mute.addInterest("set_volume__",this),this.set_volume__())},setMedia:function(t){if(this.media){const t=this.media[0];t.muted=!0,t.pause()}if(this.media=t,t){const e=t[0];e.muted=!1,e.volume=0,e.loop=this._loop.getValue(),this.setVolume(0),this._duration_changed=e.duration,this.resetElapsedTime(),this._isActive.getValue()?this._isPaused.getValue()?this.set_pause():this.getLiveState()?this.set_start():this.set_pause():this.set_stop()}},getMedia:function(){return this.media},setVolume:function(t){this.volume=r.clamp(t,0,1),this.set_volume__()},set_loop:function(){this.media&&(this.media[0].loop=this._loop.getValue())},set_volume__:function(){if(!this.media)return;const t=!this.getBrowser()._mute.getValue()*r.clamp(this.getBrowser()._volume.getValue(),0,1)*this.volume;this.media[0].volume=t},set_speed:function(){},set_pitch:function(){},set_start:function(){this.media&&this._speed.getValue()&&(this.media[0].currentTime=0,this.media[0].play().catch(Function.prototype))},set_pause:function(){this.media&&this.media[0].pause()},set_resume:function(){this.media&&this._speed.getValue()&&this.media[0].play().catch(Function.prototype)},set_stop:function(){this.media&&this.media[0].pause()},set_ended:function(){if(this.media){const t=this.media[0];if(t.currentTime<t.duration)return;this._loop.getValue()||this.stop()}},set_time:function(){this.media&&(this._elapsedTime=this.getElapsedTime()),this.set_ended()}}),s})),define("x_ite/Components/Sound/AudioClip",["jquery","x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Sound/X3DSoundSourceNode","x_ite/Components/Networking/X3DUrlObject","x_ite/Base/X3DConstants","x_ite/DEBUG"],(function(t,e,i,n,r,s,o,a){"use strict";function u(i){r.call(this,i),s.call(this,i),this.addType(o.AudioClip),this.addChildObjects("speed",new e.SFFloat(1)),this.audio=t("<audio></audio>"),this.urlStack=new e.MFString}return u.prototype=Object.assign(Object.create(r.prototype),s.prototype,{constructor:u,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new n([new i(o.inputOutput,"metadata",new e.SFNode),new i(o.inputOutput,"description",new e.SFString),new i(o.inputOutput,"enabled",new e.SFBool(!0)),new i(o.inputOutput,"load",new e.SFBool(!0)),new i(o.inputOutput,"url",new e.MFString),new i(o.inputOutput,"autoRefresh",new e.SFTime),new i(o.inputOutput,"autoRefreshTimeLimit",new e.SFTime(3600)),new i(o.inputOutput,"gain",new e.SFFloat(1)),new i(o.inputOutput,"pitch",new e.SFFloat(1)),new i(o.inputOutput,"loop",new e.SFBool),new i(o.inputOutput,"startTime",new e.SFTime),new i(o.inputOutput,"resumeTime",new e.SFTime),new i(o.inputOutput,"pauseTime",new e.SFTime),new i(o.inputOutput,"stopTime",new e.SFTime),new i(o.outputOnly,"isPaused",new e.SFBool),new i(o.outputOnly,"isActive",new e.SFBool),new i(o.outputOnly,"elapsedTime",new e.SFTime),new i(o.outputOnly,"duration_changed",new e.SFTime(-1))]),getTypeName:function(){return"AudioClip"},getComponentName:function(){return"Sound"},getContainerField:function(){return"source"},initialize:function(){r.prototype.initialize.call(this),s.prototype.initialize.call(this),this.audio.on("abort error",this.setError.bind(this)),this.audio.on("suspend stalled",this.setTimeout.bind(this)),this.audio[0].crossOrigin="Anonymous",this.audio[0].preload="auto",this.audio[0].muted=!0,this.requestImmediateLoad()},getElement:function(){return this.audio[0]},set_live__:function(){r.prototype.set_live__.call(this),s.prototype.set_live__.call(this)},unloadNow:function(){this.setMedia(null)},loadNow:function(){this.setMedia(null),this.urlStack.setValue(this._url),this.audio.on("canplaythrough",this.setAudio.bind(this)),this.loadNext()},loadNext:function(){if(0===this.urlStack.length)return this.audio.off("canplaythrough"),this._duration_changed=-1,void this.setLoadState(o.FAILED_STATE);this.URL=new URL(this.urlStack.shift(),this.getExecutionContext().getWorldURL()),"data:"!==this.URL.protocol&&(this.getBrowser().getBrowserOptions().getCache()&&this.getCache()||this.URL.searchParams.set("_",Date.now())),this.audio.attr("src",this.URL.href),this.audio.get(0).load()},setTimeout:function(t){setTimeout(function(){this.checkLoadState()===o.IN_PROGRESS_STATE&&this.setError(t)}.bind(this),3e3)},setError:function(t){"data:"!==this.URL.protocol&&console.warn("Error loading audio:",decodeURI(this.URL.href),t.type),this.loadNext()},setAudio:function(){a&&"data:"!==this.URL.protocol&&console.info("Done loading audio:",decodeURI(this.URL.href)),this.audio.unbind("canplaythrough"),this.setMedia(this.audio),this.setLoadState(o.COMPLETE_STATE)}}),u})),define("x_ite/Components/Sound/X3DSoundNode",["x_ite/Components/Core/X3DChildNode","x_ite/Base/X3DConstants"],(function(t,e){"use strict";function i(i){t.call(this,i),this.addType(e.X3DSoundNode)}return i.prototype=Object.assign(Object.create(t.prototype),{constructor:i}),i})),define("x_ite/Components/Sound/Sound",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Sound/X3DSoundNode","x_ite/Base/X3DCast","x_ite/Rendering/TraverseType","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Line3","standard/Math/Geometry/Sphere3","standard/Math/Algorithm"],(function(t,e,i,n,r,s,o,a,u,l,c,h,d){"use strict";function p(e){n.call(this,e),this.addType(o.Sound),this.addChildObjects("traversed",new t.SFBool(!0)),this._location.setUnit("length"),this._minBack.setUnit("length"),this._minFront.setUnit("length"),this._maxBack.setUnit("length"),this._maxFront.setUnit("length"),this.currentTraversed=!0}return p.prototype=Object.assign(Object.create(n.prototype),{constructor:p,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(o.inputOutput,"metadata",new t.SFNode),new e(o.inputOutput,"intensity",new t.SFFloat(1)),new e(o.initializeOnly,"spatialize",new t.SFBool(!0)),new e(o.inputOutput,"location",new t.SFVec3f),new e(o.inputOutput,"direction",new t.SFVec3f(0,0,1)),new e(o.inputOutput,"minBack",new t.SFFloat(1)),new e(o.inputOutput,"minFront",new t.SFFloat(1)),new e(o.inputOutput,"maxBack",new t.SFFloat(10)),new e(o.inputOutput,"maxFront",new t.SFFloat(10)),new e(o.inputOutput,"priority",new t.SFFloat),new e(o.inputOutput,"source",new t.SFNode)]),getTypeName:function(){return"Sound"},getComponentName:function(){return"Sound"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.isLive().addInterest("set_live__",this),this._traversed.addInterest("set_live__",this),this._source.addInterest("set_source__",this),this.set_live__(),this.set_source__()},setTraversed:function(t){t?!1===this._traversed.getValue()&&(this._traversed=!0):this.currentTraversed!==this._traversed.getValue()&&(this._traversed=this.currentTraversed),this.currentTraversed=t},getTraversed:function(){return this.currentTraversed},set_live__:function(){this.isLive().getValue()&&this._traversed.getValue()?this.getBrowser().sensorEvents().addInterest("update",this):this.getBrowser().sensorEvents().removeInterest("update",this)},set_source__:function(){this.sourceNode&&this.sourceNode.setVolume(0),this.sourceNode=r(o.X3DSoundSourceNode,this._source)},update:function(){this.getTraversed()||this.sourceNode&&this.sourceNode.setVolume(0),this.setTraversed(!1)},traverse:function(){const t={distance:0,intersection:new a(0,0,0)},e={distance:0,intersection:new a(0,0,0)};return function(i,n){if(i!==s.DISPLAY)return;if(!this.sourceNode)return;if(!this.sourceNode._isActive.getValue()||this.sourceNode._isPaused.getValue())return;this.setTraversed(!0);const r=n.getModelViewMatrix().get();if(this.getEllipsoidParameter(r,Math.max(this._maxBack.getValue(),0),Math.max(this._maxFront.getValue(),0),e),e.distance<1)if(this.getEllipsoidParameter(r,Math.max(this._minBack.getValue(),0),Math.max(this._minFront.getValue(),0),t),t.distance<1)this.sourceNode.setVolume(this._intensity.getValue());else{const i=e.intersection.magnitude(),n=e.intersection.distance(t.intersection),r=Math.min(i/n,1),s=d.clamp(this._intensity.getValue(),0,1)*r;this.sourceNode.setVolume(s)}else this.sourceNode.setVolume(0)}}(),getEllipsoidParameter:function(){const t=new a(0,0,0),e=new l,i=new l,n=new u,r=new a(1,1,1),s=new h(1,a.Zero),o=new a(0,0,0),d=new c(a.Zero,a.zAxis),p=new a(0,0,0),f=new a(0,0,0);return function(u,l,c,h){if(0==l||0==c)return e.multVecMatrix(h.intersection.assign(this._location.getValue())),void(h.distance=1);const g=(l+c)/2,m=g-l,_=Math.sqrt(g*g-m*m);t.set(0,0,m),r.set(_,_,g),n.setFromToVec(a.zAxis,this._direction.getValue()),e.assign(u).translate(this._location.getValue()).rotate(n).translate(t).scale(r),i.assign(e).inverse();const y=i.origin;t.negate().divVec(r),o.assign(t).subtract(y).normalize(),d.set(y,o),s.intersectsLine(d,p,f),h.intersection.assign(e.multVecMatrix(p)),h.distance=y.magnitude()}}()}),p})),define("x_ite/Components/Sound",["x_ite/Configuration/SupportedNodes","x_ite/Components/Sound/AudioClip","x_ite/Components/Sound/Sound","x_ite/Components/Sound/X3DSoundNode","x_ite/Components/Sound/X3DSoundSourceNode"],(function(t,e,i,n,r){"use strict";const s={AudioClip:e,Sound:i},o={X3DSoundNode:n,X3DSoundSourceNode:r};for(const e in s)t.addType(e,s[e]);for(const e in o)t.addAbstractType(e,o[e])})),define("x_ite/Components/Text/Text",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Base/X3DCast","x_ite/Base/X3DConstants"],(function(t,e,i,n,r,s){"use strict";function o(t){n.call(this,t),this.addType(s.Text),this._length.setUnit("length"),this._maxExtent.setUnit("length"),this._origin.setUnit("length"),this._textBounds.setUnit("length"),this._lineBounds.setUnit("length")}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(s.inputOutput,"metadata",new t.SFNode),new e(s.inputOutput,"string",new t.MFString),new e(s.inputOutput,"length",new t.MFFloat),new e(s.inputOutput,"maxExtent",new t.SFFloat),new e(s.initializeOnly,"solid",new t.SFBool),new e(s.outputOnly,"origin",new t.SFVec3f),new e(s.outputOnly,"textBounds",new t.SFVec2f),new e(s.outputOnly,"lineBounds",new t.MFVec2f),new e(s.inputOutput,"fontStyle",new t.SFNode)]),getTypeName:function(){return"Text"},getComponentName:function(){return"Text"},getContainerField:function(){return"geometry"},initialize:function(){n.prototype.initialize.call(this),this._fontStyle.addInterest("set_fontStyle__",this),this.set_fontStyle__()},getMatrix:function(){return this.textGeometry.getMatrix()},getLength:function(t){return t<this._length.length?Math.max(0,this._length[t]):0},set_live__:function(){n.prototype.set_live__.call(this),this.isLive().getValue()?this.getBrowser().getBrowserOptions()._PrimitiveQuality.addInterest("requestRebuild",this):this.getBrowser().getBrowserOptions()._PrimitiveQuality.removeInterest("requestRebuild",this)},set_fontStyle__:function(){this.fontStyleNode&&this.fontStyleNode.removeInterest("requestRebuild",this),this.fontStyleNode=r(s.X3DFontStyleNode,this._fontStyle),this.fontStyleNode||(this.fontStyleNode=this.getBrowser().getDefaultFontStyle()),this.fontStyleNode.addInterest("requestRebuild",this),this.textGeometry=this.fontStyleNode.getTextGeometry(this),this.setTransparent(this.textGeometry.getTransparent())},build:function(){this.textGeometry.update(),this.textGeometry.build(),this.setSolid(this._solid.getValue())},traverse:function(t,e){this.textGeometry.traverse(t,e),n.prototype.traverse.call(this,t,e)},display:function(t,e){this.textGeometry.display(t,e),n.prototype.display.call(this,t,e)},transformLine:function(t){return this.textGeometry.transformLine(t)},transformMatrix:function(t){return this.textGeometry.transformMatrix(t)}}),o})),define("x_ite/Components/Text",["x_ite/Configuration/SupportedNodes","x_ite/Components/Text/FontStyle","x_ite/Components/Text/Text","x_ite/Components/Text/X3DFontStyleNode"],(function(t,e,i,n){"use strict";const r={FontStyle:e,Text:i},s={X3DFontStyleNode:n};for(const e in r)t.addType(e,r[e]);for(const e in s)t.addAbstractType(e,s[e])})),define("x_ite/Components/Texturing/MovieTexture",["jquery","x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Texturing/X3DTexture2DNode","x_ite/Components/Sound/X3DSoundSourceNode","x_ite/Components/Networking/X3DUrlObject","x_ite/Base/X3DConstants","standard/Math/Algorithm","x_ite/DEBUG"],(function(t,e,i,n,r,s,o,a,u,l){"use strict";function c(i){r.call(this,i),s.call(this,i),o.call(this,i),this.addType(a.MovieTexture),this.canvas=t("<canvas></canvas>"),this.video=t("<video></video>"),this.urlStack=new e.MFString}return c.prototype=Object.assign(Object.create(r.prototype),s.prototype,o.prototype,{constructor:c,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new n([new i(a.inputOutput,"metadata",new e.SFNode),new i(a.inputOutput,"description",new e.SFString),new i(a.inputOutput,"enabled",new e.SFBool(!0)),new i(a.inputOutput,"load",new e.SFBool(!0)),new i(a.inputOutput,"url",new e.MFString),new i(a.inputOutput,"autoRefresh",new e.SFTime),new i(a.inputOutput,"autoRefreshTimeLimit",new e.SFTime(3600)),new i(a.inputOutput,"gain",new e.SFFloat(1)),new i(a.inputOutput,"speed",new e.SFFloat(1)),new i(a.inputOutput,"pitch",new e.SFFloat(1)),new i(a.inputOutput,"loop",new e.SFBool),new i(a.inputOutput,"startTime",new e.SFTime),new i(a.inputOutput,"resumeTime",new e.SFTime),new i(a.inputOutput,"pauseTime",new e.SFTime),new i(a.inputOutput,"stopTime",new e.SFTime),new i(a.outputOnly,"isPaused",new e.SFBool),new i(a.outputOnly,"isActive",new e.SFBool),new i(a.outputOnly,"elapsedTime",new e.SFTime),new i(a.outputOnly,"duration_changed",new e.SFTime(-1)),new i(a.initializeOnly,"repeatS",new e.SFBool(!0)),new i(a.initializeOnly,"repeatT",new e.SFBool(!0)),new i(a.initializeOnly,"textureProperties",new e.SFNode)]),getTypeName:function(){return"MovieTexture"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"texture"},initialize:function(){r.prototype.initialize.call(this),s.prototype.initialize.call(this),o.prototype.initialize.call(this),this.video.on("abort error",this.setError.bind(this)),this.video.on("suspend stalled",this.setTimeout.bind(this)),this.video[0].crossOrigin="Anonymous",this.video[0].preload="auto",this.video[0].muted=!0,this.requestImmediateLoad()},getElement:function(){return this.video[0]},set_live__:function(){s.prototype.set_live__.call(this),o.prototype.set_live__.call(this)},unloadNow:function(){this.clearTexture()},loadNow:function(){this.setMedia(null),this.urlStack.setValue(this._url),this.video.on("canplaythrough",this.setVideo.bind(this)),this.loadNext()},loadNext:function(){if(0===this.urlStack.length)return this.video.off("canplaythrough"),this._duration_changed=-1,this.clearTexture(),void this.setLoadState(a.FAILED_STATE);this.URL=new URL(this.urlStack.shift(),this.getExecutionContext().getWorldURL()),"data:"!==this.URL.protocol&&(this.getBrowser().getBrowserOptions().getCache()&&this.getCache()||this.URL.searchParams.set("_",Date.now())),this.video.attr("src",this.URL.href),this.video.get(0).load()},setTimeout:function(t){setTimeout(function(){this.checkLoadState()===a.IN_PROGRESS_STATE&&this.setError(t)}.bind(this),3e3)},setError:function(t){"data:"!==this.URL.protocol&&console.warn("Error loading movie:",decodeURI(this.URL.href),t.type),this.loadNext()},setVideo:function(){l&&"data:"!==this.URL.protocol&&console.info("Done loading movie:",decodeURI(this.URL.href));try{this.video.unbind("canplaythrough");const t=this.video[0],e=t.videoWidth,i=t.videoHeight,n=this.canvas[0],r=n.getContext("2d",{willReadFrequently:!0});if(!u.isPowerOfTwo(e)||!u.isPowerOfTwo(i))throw new Error("The movie texture is a non power-of-two texture.");n.width=e,n.height=i,r.drawImage(t,0,0);const s=r.getImageData(0,0,e,i).data;this.setMedia(this.video),this.setTexture(e,i,!1,new Uint8Array(s.buffer),!0),this.setLoadState(a.COMPLETE_STATE)}catch(t){console.log(t.message),this.setError()}},set_time:function(){s.prototype.set_time.call(this),this.checkLoadState()===a.COMPLETE_STATE&&this.updateTexture(this.getMedia()[0],!0)},traverse:r.prototype.traverse}),c})),define("x_ite/Components/Texturing/MultiTexture",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Texturing/X3DTextureNode","x_ite/Base/X3DConstants","x_ite/Base/X3DCast","x_ite/Browser/Texturing/MultiTextureModeType","x_ite/Browser/Texturing/MultiTextureSourceType","x_ite/Browser/Texturing/MultiTextureFunctionType"],(function(t,e,i,n,r,s,o,a,u){"use strict";function l(e){n.call(this,e),this.addType(r.MultiTexture),this.addChildObjects("loadState",new t.SFInt32(r.NOT_STARTED_STATE)),this.color=new Float32Array(4),this.modes=[],this.alphaModes=[],this.sources=[],this.functions=[],this.textureNodes=[]}return l.prototype=Object.assign(Object.create(n.prototype),{constructor:l,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"description",new t.SFString),new e(r.inputOutput,"color",new t.SFColor(1,1,1)),new e(r.inputOutput,"alpha",new t.SFFloat(1)),new e(r.inputOutput,"mode",new t.MFString),new e(r.inputOutput,"source",new t.MFString),new e(r.inputOutput,"function",new t.MFString),new e(r.inputOutput,"texture",new t.MFNode)]),getTypeName:function(){return"MultiTexture"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"texture"},initialize:function(){n.prototype.initialize.call(this),this._color.addInterest("set_color__",this),this._alpha.addInterest("set_alpha__",this),this._mode.addInterest("set_mode__",this),this._source.addInterest("set_source__",this),this._function.addInterest("set_function__",this),this._texture.addInterest("set_texture__",this),this.set_color__(),this.set_alpha__(),this.set_mode__(),this.set_source__(),this.set_function__(),this.set_texture__(),this._loadState=r.COMPLETE_STATE},getMode:function(t){return t<this.modes.length?this.modes[t]:o.MODULATE},getAlphaMode:function(t){return t<this.alphaModes.length?this.alphaModes[t]:o.MODULATE},getSource:function(t){return t<this.sources.length?this.sources[t]:a.DEFAULT},getFunction:function(t){return t<this.functions.length?this.functions[t]:u.DEFAULT},set_color__:function(){this.color[0]=this._color.r,this.color[1]=this._color.g,this.color[2]=this._color.b},set_alpha__:function(){this.color[3]=this._alpha},set_mode__:function(){const t=new Map([["REPLACE",o.REPLACE],["MODULATE",o.MODULATE],["MODULATE2X",o.MODULATE2X],["MODULATE4X",o.MODULATE4X],["ADD",o.ADD],["ADDSIGNED",o.ADDSIGNED],["ADDSIGNED2X",o.ADDSIGNED2X],["ADDSMOOTH",o.ADDSMOOTH],["SUBTRACT",o.SUBTRACT],["BLENDDIFFUSEALPHA",o.BLENDDIFFUSEALPHA],["BLENDTEXTUREALPHA",o.BLENDTEXTUREALPHA],["BLENDFACTORALPHA",o.BLENDFACTORALPHA],["BLENDCURRENTALPHA",o.BLENDCURRENTALPHA],["MODULATEALPHA_ADDCOLOR",o.MODULATEALPHA_ADDCOLOR],["MODULATEINVALPHA_ADDCOLOR",o.MODULATEINVALPHA_ADDCOLOR],["MODULATEINVCOLOR_ADDALPHA",o.MODULATEINVCOLOR_ADDALPHA],["DOTPRODUCT3",o.DOTPRODUCT3],["SELECTARG1",o.SELECTARG1],["SELECTARG2",o.SELECTARG2],["OFF",o.OFF]]);return function(){this.modes.length=0,this.alphaModes.length=0;for(const e of this._mode){const i=e.split(",");for(let t=0,e=i.length;t<e;++t)i[t]=i[t].trim();0===i.length&&i.push("MODULATE"),i.length<2&&i.push(i[0]);const n=t.get(i[0]);void 0!==n?this.modes.push(n):this.modes.push(o.MODULATE);const r=t.get(i[1]);void 0!==r?this.alphaModes.push(r):this.alphaModes.push(o.MODULATE)}}}(),set_source__:function(){const t=new Map([["DIFFUSE",a.DIFFUSE],["SPECULAR",a.SPECULAR],["FACTOR",a.FACTOR]]);return function(){this.sources.length=0;for(const e of this._source){const i=t.get(e);void 0!==i?this.sources.push(i):this.sources.push(a.DEFAULT)}}}(),set_function__:function(){const t=new Map([["COMPLEMENT",u.COMPLEMENT],["ALPHAREPLICATE",u.ALPHAREPLICATE]]);return function(){this.functions.length=0;for(const e of this._function){const i=t.get(e);void 0!==i?this.functions.push(i):this.functions.push(u.DEFAULT)}}}(),set_texture__:function(){this.textureNodes.length=0;for(const t of this._texture){const e=s(r.X3DSingleTextureNode,t);e&&this.textureNodes.push(e)}},traverse:function(t,e){for(const i of this.textureNodes)i.traverse(t,e)},setShaderUniforms:function(t,e,i){const n=this.textureNodes,r=Math.min(e.getBrowser().getMaxTextures(),n.length);t.uniform1i(e.x3d_NumTextures,r),t.uniform4fv(e.x3d_MultiTextureColor,this.color);for(let s=0;s<r;++s)n[s].setShaderUniformsToChannel(t,e,i,e.x3d_Textures[s]),t.uniform1i(e.x3d_MultiTextureMode[s],this.getMode(s)),t.uniform1i(e.x3d_MultiTextureAlphaMode[s],this.getAlphaMode(s)),t.uniform1i(e.x3d_MultiTextureSource[s],this.getSource(s)),t.uniform1i(e.x3d_MultiTextureFunction[s],this.getFunction(s))}}),l})),define("x_ite/Components/Texturing/MultiTextureCoordinate",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Texturing/X3DTextureCoordinateNode","x_ite/Base/X3DConstants","x_ite/Base/X3DCast"],(function(t,e,i,n,r,s){"use strict";function o(t){n.call(this,t),this.addType(r.MultiTextureCoordinate),this.textureCoordinateNodes=[]}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"texCoord",new t.MFNode)]),getTypeName:function(){return"MultiTextureCoordinate"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"texCoord"},initialize:function(){n.prototype.initialize.call(this),this._texCoord.addInterest("set_texCoord__",this),this.set_texCoord__()},set_texCoord__:function(){const t=this.textureCoordinateNodes;for(const e of t)e.removeInterest("addNodeEvent",this);t.length=0;for(const e of this._texCoord){const i=s(r.X3DSingleTextureCoordinateNode,e);i&&t.push(i)}for(const e of t)e.addInterest("addNodeEvent",this)},isEmpty:function(){return!0},getSize:function(){return 0},get1Point:function(t,e){for(const i of this.textureCoordinateNodes)return i.get1Point(t,e);return e.set(0,0,0,1)},init:function(t){for(const e of this.textureCoordinateNodes)e.init(t)},addTexCoord:function(t,e){const i=this.textureCoordinateNodes;for(let n=0,r=i.length;n<r;++n)i[n].addTexCoordToChannel(t,e[n])},addTexCoordToChannel:function(t,e){},getTexCoord:function(t){for(const e of this.textureCoordinateNodes)return e.getTexCoord(t);return t},getTextureMapping:function(t){const e=this.textureCoordinateNodes,i=Math.min(this.getBrowser().getMaxTextures(),e.length);for(let n=0;n<i;++n)e[n].getTextureMapping(t,n)},setShaderUniforms:function(t,e){const i=this.textureCoordinateNodes,n=Math.min(e.x3d_MaxTextures,i.length);for(let r=0;r<n;++r)i[r].setShaderUniformsToChannel(t,e,r);const r=n?i.at(-1):this;for(let i=n,s=e.x3d_MaxTextures;i<s;++i)r.setShaderUniformsToChannel(t,e,i)}}),o})),define("x_ite/Components/Texturing/MultiTextureTransform",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Texturing/X3DTextureTransformNode","x_ite/Base/X3DConstants","x_ite/Base/X3DCast"],(function(t,e,i,n,r,s){"use strict";function o(t){n.call(this,t),this.addType(r.MultiTextureTransform),this.textureTransformNodes=[]}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"textureTransform",new t.MFNode)]),getTypeName:function(){return"MultiTextureTransform"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"textureTransform"},initialize:function(){n.prototype.initialize.call(this),this._textureTransform.addInterest("set_textureTransform__",this),this.set_textureTransform__()},set_textureTransform__:function(){const t=this.textureTransformNodes;t.length=0;for(const e of this._textureTransform){const i=s(r.X3DSingleTextureTransformNode,e);i&&t.push(i)}},getTextureMapping:function(t){const e=this.textureTransformNodes,i=Math.min(this.getBrowser().getMaxTextures(),e.length);for(let n=0;n<i;++n)e[n].getTextureMapping(t,n)},setShaderUniforms:function(t,e){const i=this.textureTransformNodes,n=Math.min(e.x3d_MaxTextures,i.length);for(let r=0;r<n;++r)i[r].setShaderUniformsToChannel(t,e,r);const r=n?i.at(-1):this;for(let i=n,s=e.x3d_MaxTextures;i<s;++i)r.setShaderUniformsToChannel(t,e,i)}}),o})),define("x_ite/Components/Texturing/PixelTexture",["jquery","x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Texturing/X3DTexture2DNode","x_ite/Base/X3DConstants","standard/Math/Algorithm","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix3"],(function(t,e,i,n,r,s,o){"use strict";function a(t){r.call(this,t),this.addType(s.PixelTexture),this.addChildObjects("loadState",new e.SFInt32(s.NOT_STARTED_STATE))}return a.prototype=Object.assign(Object.create(r.prototype),{constructor:a,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new n([new i(s.inputOutput,"metadata",new e.SFNode),new i(s.inputOutput,"description",new e.SFString),new i(s.inputOutput,"image",new e.SFImage(0,0,0,new e.MFInt32)),new i(s.initializeOnly,"repeatS",new e.SFBool(!0)),new i(s.initializeOnly,"repeatT",new e.SFBool(!0)),new i(s.initializeOnly,"textureProperties",new e.SFNode)]),getTypeName:function(){return"PixelTexture"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"texture"},initialize:function(){r.prototype.initialize.call(this),this._image.addInterest("set_image__",this),this.canvas1=t("<canvas></canvas>"),this.canvas2=t("<canvas></canvas>"),this.set_image__()},checkLoadState:function(){return this._loadState.getValue()},convert:function(t,e,i,n){switch(e){case 1:for(let e=0,r=0;e<n;++e,r+=4){const n=i[e];t[r]=t[r+1]=t[r+2]=255&n,t[r+3]=255}break;case 2:for(let e=0,r=0;e<n;++e,r+=4){const n=i[e];t[r]=t[r+1]=t[r+2]=n>>>8&255,t[r+3]=255&n}break;case 3:for(let e=0,r=0;e<n;++e,r+=4){const n=i[e];t[r]=n>>>16&255,t[r+1]=n>>>8&255,t[r+2]=255&n,t[r+3]=255}break;case 4:for(let e=0,r=0;e<n;++e,r+=4){const n=i[e];t[r]=n>>>24,t[r+1]=n>>>16&255,t[r+2]=n>>>8&255,t[r+3]=255&n}}},resize:function(t,e,i,n,r){const s=new Uint8Array(n*r*4),o=n/e,a=r/i;for(let i=0;i<r;++i){const r=Math.floor(i/a)*e,u=i*n;for(let e=0;e<n;++e){const i=4*(r+Math.floor(e/o)),n=4*(u+e);s[n]=t[i],s[n+1]=t[i+1],s[n+2]=t[i+2],s[n+3]=t[i+3]}}return s},set_image__:function(){const t=this.getBrowser().getContext(),e=this._image.comp,i=this._image.array,n=!(e%2);let r=this._image.width,a=this._image.height,u=null;if(r>0&&a>0&&e>0&&e<5){if(t.getVersion()>=2||o.isPowerOfTwo(r)&&o.isPowerOfTwo(a))u=new Uint8Array(r*a*4),this.convert(u,e,i.getValue(),i.length);else if(Math.max(r,a)<this.getBrowser().getMinTextureSize()&&!this._textureProperties.getValue()){u=new Uint8Array(r*a*4),this.convert(u,e,i.getValue(),i.length);const t=r,n=a;r=4*o.nextPowerOfTwo(t),a=4*o.nextPowerOfTwo(n),u=this.resize(u,t,n,r,a)}else{const t=this.canvas1[0],n=this.canvas2[0],s=t.getContext("2d",{willReadFrequently:!0}),l=n.getContext("2d",{willReadFrequently:!0}),c=s.createImageData(r,a);t.width=r,t.height=a,this.convert(c.data,e,i,i.length),s.putImageData(c,0,0),r=o.nextPowerOfTwo(r),a=o.nextPowerOfTwo(a),n.width=r,n.height=a,l.clearRect(0,0,r,a),l.drawImage(t,0,0,t.width,t.height,0,0,r,a),u=l.getImageData(0,0,r,a).data}this.setTexture(r,a,n,new Uint8Array(u.buffer),!1),this._loadState=s.COMPLETE_STATE}else this.clearTexture(),this._loadState=s.FAILED_STATE}}),a})),define("x_ite/Components/Texturing/TextureCoordinateGenerator",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Texturing/X3DSingleTextureCoordinateNode","x_ite/Base/X3DConstants","x_ite/Browser/Texturing/TextureCoordinateGeneratorModeType"],(function(t,e,i,n,r,s){"use strict";function o(t){n.call(this,t),this.addType(r.TextureCoordinateGenerator),this.mode=s.SPHERE,this.parameter=new Float32Array(6)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new i([new e(r.inputOutput,"metadata",new t.SFNode),new e(r.inputOutput,"mapping",new t.SFString),new e(r.inputOutput,"mode",new t.SFString("SPHERE")),new e(r.inputOutput,"parameter",new t.MFFloat)]),getTypeName:function(){return"TextureCoordinateGenerator"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"texCoord"},initialize:function(){n.prototype.initialize.call(this),this._mode.addInterest("set_mode__",this),this._parameter.addInterest("set_parameter__",this),this.set_mode__(),this.set_parameter__()},set_mode__:function(){const t=new Map([["SPHERE",s.SPHERE],["CAMERASPACENORMAL",s.CAMERASPACENORMAL],["CAMERASPACEPOSITION",s.CAMERASPACEPOSITION],["CAMERASPACEREFLECTIONVECTOR",s.CAMERASPACEREFLECTIONVECTOR],["SPHERE-LOCAL",s.SPHERE_LOCAL],["COORD",s.COORD],["COORD-EYE",s.COORD_EYE],["NOISE",s.NOISE],["NOISE-EYE",s.NOISE_EYE],["SPHERE-REFLECT",s.SPHERE_REFLECT],["SPHERE-REFLECT-LOCAL",s.SPHERE_REFLECT_LOCAL]]);return function(){this.mode=t.get(this._mode.getValue()),void 0===this.mode&&(this.mode=s.SPHERE)}}(),set_parameter__:function(){const t=Math.min(this.parameter.length,this._parameter.length);for(let e=0;e<t;++e)this.parameter[e]=this._parameter[e];this.parameter.fill(0,t)},get1Point:function(t,e){return e},addTexCoordToChannel:function(t,e){e.push(0,0,0,1)},getTexCoord:function(t){return arrray},setShaderUniformsToChannel:function(t,e,i){t.uniform1i(e.x3d_TextureCoordinateGeneratorMode[i],this.mode),t.uniform1fv(e.x3d_TextureCoordinateGeneratorParameter[i],this.parameter)}}),o})),define("x_ite/Components/Texturing",["x_ite/Configuration/SupportedNodes","x_ite/Components/Texturing/ImageTexture","x_ite/Components/Texturing/MovieTexture","x_ite/Components/Texturing/MultiTexture","x_ite/Components/Texturing/MultiTextureCoordinate","x_ite/Components/Texturing/MultiTextureTransform","x_ite/Components/Texturing/PixelTexture","x_ite/Components/Texturing/TextureCoordinate","x_ite/Components/Texturing/TextureCoordinateGenerator","x_ite/Components/Texturing/TextureProperties","x_ite/Components/Texturing/TextureTransform","x_ite/Components/Texturing/X3DSingleTextureCoordinateNode","x_ite/Components/Texturing/X3DSingleTextureNode","x_ite/Components/Texturing/X3DSingleTextureTransformNode","x_ite/Components/Texturing/X3DTexture2DNode","x_ite/Components/Texturing/X3DTextureCoordinateNode","x_ite/Components/Texturing/X3DTextureNode","x_ite/Components/Texturing/X3DTextureTransformNode"],(function(t,e,i,n,r,s,o,a,u,l,c,h,d,p,f,g,m,_){"use strict";const y={ImageTexture:e,MovieTexture:i,MultiTexture:n,MultiTextureCoordinate:r,MultiTextureTransform:s,PixelTexture:o,TextureCoordinate:a,TextureCoordinateGenerator:u,TextureProperties:l,TextureTransform:c},x={X3DSingleTextureCoordinateNode:h,X3DSingleTextureNode:d,X3DSingleTextureTransformNode:p,X3DTexture2DNode:f,X3DTextureCoordinateNode:g,X3DTextureNode:m,X3DTextureTransformNode:_};for(const e in y)t.addType(e,y[e]);for(const e in x)t.addAbstractType(e,x[e])})),define("x_ite/Components/Time",["x_ite/Configuration/SupportedNodes","x_ite/Components/Time/TimeSensor","x_ite/Components/Time/X3DTimeDependentNode"],(function(t,e,i){"use strict";const n={TimeSensor:e},r={X3DTimeDependentNode:i};for(const e in n)t.addType(e,n[e]);for(const e in r)t.addAbstractType(e,r[e])})),define("x_ite/Components",["x_ite/DEBUG","x_ite/Browser/X3DBrowserContext","x_ite/Configuration/SupportedNodes","x_ite/Components/Core","x_ite/Components/EnvironmentalEffects","x_ite/Components/EnvironmentalSensor","x_ite/Components/Followers","x_ite/Components/Geometry3D","x_ite/Components/Grouping","x_ite/Components/Interpolation","x_ite/Components/Layering","x_ite/Components/Lighting","x_ite/Components/Navigation","x_ite/Components/Networking","x_ite/Components/PointingDeviceSensor","x_ite/Components/Rendering","x_ite/Components/Shaders","x_ite/Components/Shape","x_ite/Components/Sound","x_ite/Components/Text","x_ite/Components/Texturing","x_ite/Components/Time"],(function(t,e,i){"use strict";function n(){}return n.prototype={addComponent:function(n){if(n.types)for(const t in n.types)i.addType(t,n.types[t]);if(n.abstractTypes)for(const t in n.abstractTypes)i.addAbstractType(t,n.abstractTypes[t]);n.context&&e.addContext(n.context),n.name&&t&&console.info("Done loading external component '"+n.name+"'.")}},new n})),define("x_ite/Configuration/ProfileInfo",["x_ite/Base/X3DObject"],(function(t){"use strict";function e(t,e,i,n){this.name=t,this.title=e,this.providerUrl=i,this.components=n}e.prototype=Object.assign(Object.create(t.prototype),{constructor:e,getTypeName:function(){return"ProfileInfo"},toVRMLStream:function(t){t.string+="PROFILE",t.string+=" ",t.string+=this.name},toXMLStream:function(t){t.string+=this.name}});for(const t of Reflect.ownKeys(e.prototype))Object.defineProperty(e.prototype,t,{enumerable:!1});return e})),define("x_ite/Configuration/ProfileInfoArray",["x_ite/Configuration/ComponentInfoArray","x_ite/Configuration/ProfileInfo","x_ite/Base/X3DInfoArray"],(function(t,e,i){"use strict";function n(t){return i.call(this,t)}n.prototype=Object.assign(Object.create(i.prototype),{constructor:n,getTypeName:function(){return"ProfileInfoArray"},addProfile:function(i){this.add(i.name,new e(i.name,i.title,i.providerUrl,new t(i.components)))}});for(const t of Reflect.ownKeys(n.prototype))Object.defineProperty(n.prototype,t,{enumerable:!1});return n})),define("x_ite/Configuration/SupportedComponents",["x_ite/Configuration/ComponentInfoArray","x_ite/Browser/Networking/urls"],(function(t,e){"use strict";const i=new t([]);return i.addComponent({title:"Annotation",name:"Annotation",level:2,providerUrl:e.getProviderUrl("annotation")}),i.addComponent({title:"Computer-Aided Design (CAD) model geometry",name:"CADGeometry",level:2,providerUrl:e.getProviderUrl("cad-geometry")}),i.addComponent({title:"Core",name:"Core",level:2,providerUrl:e.getProviderUrl()}),i.addComponent({title:"Cube map environmental texturing",name:"CubeMapTexturing",level:3,providerUrl:e.getProviderUrl("cube-map-texturing")}),i.addComponent({title:"Distributed interactive simulation (DIS)",name:"DIS",level:2,providerUrl:e.getProviderUrl("dis")}),i.addComponent({title:"Environmental effects",name:"EnvironmentalEffects",level:4,providerUrl:e.getProviderUrl()}),i.addComponent({title:"Environmental sensor",name:"EnvironmentalSensor",level:4,providerUrl:e.getProviderUrl()}),i.addComponent({title:"Event utilities",name:"EventUtilities",level:4,providerUrl:e.getProviderUrl("event-utilities")}),i.addComponent({title:"Followers",name:"Followers",level:4,providerUrl:e.getProviderUrl()}),i.addComponent({title:"Geometry2D",name:"Geometry2D",level:2,providerUrl:e.getProviderUrl("geometry2d")}),i.addComponent({title:"Geometry3D",name:"Geometry3D",level:4,providerUrl:e.getProviderUrl()}),i.addComponent({title:"Geospatial",name:"Geospatial",level:2,providerUrl:e.getProviderUrl("geospatial")}),i.addComponent({title:"Grouping",name:"Grouping",level:3,providerUrl:e.getProviderUrl()}),i.addComponent({title:"Humanoid animation (HAnim)",name:"HAnim",level:3,providerUrl:e.getProviderUrl("h-anim")}),i.addAlias("H-Anim","HAnim"),i.addComponent({title:"Interpolation",name:"Interpolation",level:5,providerUrl:e.getProviderUrl()}),i.addComponent({title:"Key device sensor",name:"KeyDeviceSensor",level:2,providerUrl:e.getProviderUrl("key-device-sensor")}),i.addComponent({title:"Layering",name:"Layering",level:1,providerUrl:e.getProviderUrl()}),i.addComponent({title:"Layout",name:"Layout",level:2,providerUrl:e.getProviderUrl("layout")}),i.addComponent({title:"Lighting",name:"Lighting",level:3,providerUrl:e.getProviderUrl()}),i.addComponent({title:"Navigation",name:"Navigation",level:3,providerUrl:e.getProviderUrl()}),i.addComponent({title:"Networking",name:"Networking",level:4,providerUrl:e.getProviderUrl()}),i.addComponent({title:"Non-uniform Rational B-Spline (NURBS)",name:"NURBS",level:4,providerUrl:e.getProviderUrl("nurbs")}),i.addComponent({title:"Particle systems",name:"ParticleSystems",level:3,providerUrl:e.getProviderUrl("particle-systems")}),i.addComponent({title:"Picking sensor",name:"Picking",level:3,providerUrl:e.getProviderUrl("picking")}),i.addComponent({title:"Pointing device sensor",name:"PointingDeviceSensor",level:1,providerUrl:e.getProviderUrl()}),i.addComponent({title:"Projective Texture Mapping",name:"ProjectiveTextureMapping",level:2,providerUrl:e.getProviderUrl("projective-texture-mapping")}),i.addComponent({title:"Programmable shaders",name:"Shaders",level:1,providerUrl:e.getProviderUrl()}),i.addComponent({title:"Rendering",name:"Rendering",level:5,providerUrl:e.getProviderUrl()}),i.addComponent({title:"Rigid body physics",name:"RigidBodyPhysics",level:5,providerUrl:e.getProviderUrl("rigid-body-physics")}),i.addComponent({title:"Scripting",name:"Scripting",level:1,providerUrl:e.getProviderUrl("scripting")}),i.addComponent({title:"Shape",name:"Shape",level:5,providerUrl:e.getProviderUrl()}),i.addComponent({title:"Sound",name:"Sound",level:1,providerUrl:e.getProviderUrl()}),i.addComponent({title:"Text",name:"Text",level:1,providerUrl:e.getProviderUrl()}),i.addComponent({title:"Texturing",name:"Texturing",level:3,providerUrl:e.getProviderUrl()}),i.addComponent({title:"Texturing3D",name:"Texturing3D",level:3,providerUrl:e.getProviderUrl("texturing-3d")}),i.addComponent({title:"Time",name:"Time",level:2,providerUrl:e.getProviderUrl()}),i.addComponent({title:"Volume rendering",name:"VolumeRendering",level:2,providerUrl:e.getProviderUrl("volume-rendering")}),i.addComponent({title:"X_ITE",name:"X_ITE",level:1,providerUrl:e.getProviderUrl("x_ite")}),i})),define("x_ite/Configuration/SupportedProfiles",["x_ite/Configuration/ProfileInfo","x_ite/Configuration/ProfileInfoArray","x_ite/Configuration/ComponentInfoArray","x_ite/Configuration/SupportedComponents","x_ite/Browser/Networking/urls"],(function(t,e,i,n,r){"use strict";const s=new e;return s.addProfile({title:"Computer-Aided Design (CAD) interchange",name:"CADInterchange",providerUrl:r.getProviderUrl(),components:[n.get("CADGeometry"),n.get("Core"),n.get("Grouping"),n.get("Lighting"),n.get("Navigation"),n.get("Networking"),n.get("Rendering"),n.get("Shaders"),n.get("Shape"),n.get("Texturing")]}),s.addProfile({title:"Core",name:"Core",providerUrl:r.getProviderUrl(),components:[n.get("Core")]}),s.addProfile({title:"Full",name:"Full",providerUrl:r.getProviderUrl(),components:[n.get("CADGeometry"),n.get("Core"),n.get("CubeMapTexturing"),n.get("DIS"),n.get("EnvironmentalEffects"),n.get("EnvironmentalSensor"),n.get("EventUtilities"),n.get("Followers"),n.get("Geometry2D"),n.get("Geometry3D"),n.get("Geospatial"),n.get("Grouping"),n.get("HAnim"),n.get("Interpolation"),n.get("KeyDeviceSensor"),n.get("Layering"),n.get("Layout"),n.get("Lighting"),n.get("Navigation"),n.get("Networking"),n.get("NURBS"),n.get("ParticleSystems"),n.get("Picking"),n.get("PointingDeviceSensor"),n.get("ProjectiveTextureMapping"),n.get("Rendering"),n.get("RigidBodyPhysics"),n.get("Scripting"),n.get("Shaders"),n.get("Shape"),n.get("Sound"),n.get("Text"),n.get("Texturing"),n.get("Texturing3D"),n.get("Time"),n.get("VolumeRendering")]}),s.addProfile({title:"Immersive",name:"Immersive",providerUrl:r.getProviderUrl(),components:[n.get("Core"),n.get("EnvironmentalEffects"),n.get("EnvironmentalSensor"),n.get("EventUtilities"),n.get("Geometry2D"),n.get("Geometry3D"),n.get("Grouping"),n.get("Interpolation"),n.get("KeyDeviceSensor"),n.get("Lighting"),n.get("Navigation"),n.get("Networking"),n.get("PointingDeviceSensor"),n.get("Rendering"),n.get("Scripting"),n.get("Shape"),n.get("Sound"),n.get("Text"),n.get("Texturing"),n.get("Time")]}),s.addProfile({title:"Interactive",name:"Interactive",providerUrl:r.getProviderUrl(),components:[n.get("Core"),n.get("EnvironmentalEffects"),n.get("EnvironmentalSensor"),n.get("EventUtilities"),n.get("Geometry3D"),n.get("Grouping"),n.get("Interpolation"),n.get("KeyDeviceSensor"),n.get("Lighting"),n.get("Navigation"),n.get("Networking"),n.get("PointingDeviceSensor"),n.get("Rendering"),n.get("Shape"),n.get("Texturing"),n.get("Time")]}),s.addProfile({title:"Interchange",name:"Interchange",providerUrl:r.getProviderUrl(),components:[n.get("Core"),n.get("EnvironmentalEffects"),n.get("Geometry3D"),n.get("Grouping"),n.get("Interpolation"),n.get("Lighting"),n.get("Navigation"),n.get("Networking"),n.get("Rendering"),n.get("Shape"),n.get("Texturing"),n.get("Time")]}),s.addProfile({title:"Medical interchange",name:"MedicalInterchange",providerUrl:r.getProviderUrl(),components:[n.get("Core"),n.get("EnvironmentalEffects"),n.get("EventUtilities"),n.get("Geometry2D"),n.get("Geometry3D"),n.get("Grouping"),n.get("Interpolation"),n.get("Lighting"),n.get("Navigation"),n.get("Networking"),n.get("Rendering"),n.get("Shape"),n.get("Text"),n.get("Texturing"),n.get("Texturing3D"),n.get("Time"),n.get("VolumeRendering")]}),s.addProfile({title:"MPEG-4 interactive",name:"MPEG-4",providerUrl:r.getProviderUrl(),components:[n.get("Core"),n.get("EnvironmentalEffects"),n.get("EnvironmentalSensor"),n.get("Geometry3D"),n.get("Grouping"),n.get("Interpolation"),n.get("Lighting"),n.get("Navigation"),n.get("Networking"),n.get("PointingDeviceSensor"),n.get("Rendering"),n.get("Shape"),n.get("Texturing"),n.get("Time")]}),s})),define("x_ite/Browser/X3DBrowser",["jquery","x_ite/Browser/VERSION","x_ite/Fields","x_ite/Components","x_ite/Components/Layering/X3DLayerNode","x_ite/Browser/X3DBrowserContext","x_ite/Configuration/ProfileInfo","x_ite/Configuration/ComponentInfo","x_ite/Configuration/SupportedProfiles","x_ite/Configuration/SupportedComponents","x_ite/Configuration/SupportedNodes","x_ite/Execution/Scene","x_ite/Execution/X3DScene","x_ite/InputOutput/FileLoader","x_ite/Parser/XMLParser","x_ite/Parser/JSONParser","x_ite/Base/X3DCast","x_ite/Base/X3DConstants","standard/Utility/MapUtilities","locale/gettext"],(function(t,e,i,n,r,s,o,a,u,l,c,h,d,p,f,g,m,_,y,x){"use strict";const w=Symbol(),b=Symbol();function v(t){s.call(this,t),this[b]=new Map,this.replaceWorld(this.createScene())}v.prototype=Object.assign(Object.create(s.prototype),{constructor:v,getTypeName:function(){return"X3DBrowser"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"browser"},initialize:function(){s.prototype.initialize.call(this);let t=this.getElement().attr("src");t=t?'"'+t+'"':this.getElement().attr("url"),t?(this.initialized().set(this.getCurrentTime()),this.load(t)):(this.initialized().setValue(this.getCurrentTime()),this.callBrowserCallbacks(_.INITIALIZED_EVENT),this.callBrowserEventHandler("onload")),this.getNumber()>1||this.print("Welcome to "+this.name+" X3D Browser "+this.version+":\n   Current Graphics Renderer\n      Name: "+this.getVendor()+" "+this.getRenderer()+"\n      WebGL version: "+this.getWebGLVersion()+"\n      Shading language: "+this.getShadingLanguageVersion()+"\n   Rendering Properties\n      Antialiased: "+this.getAntialiased()+"\n      Depth size: "+this.getDepthSize()+" bits\n      Color depth: "+this.getColorDepth()+" bits\n      Max clip planes: "+this.getMaxClipPlanes()+"\n      Max global lights: "+this.getMaxLights()+"\n      Max textures: "+this.getMaxTextures()+"\n      Texture units: "+this.getMaxCombinedTextureUnits()+"\n      Max texture size: "+this.getMaxTextureSize()+" × "+this.getMaxTextureSize()+" pixel\n      Texture memory: "+this.getTextureMemory()+"\n      Max vertex uniform vectors: "+this.getMaxVertexUniformVectors()+"\n      Max fragment uniform vectors: "+this.getMaxFragmentUniformVectors()+"\n      Max vertex attribs: "+this.getMaxVertexAttribs()+"\n")},getName:function(){return"X_ITE"},getVersion:function(){return e},getDescription:function(){return this.getNotification()._string.getValue()},setDescription:function(t){this.getNotification()._string=t},getWorldURL:function(){return this.currentScene.worldURL},getProfile:function(t){t=String(t);const e=u.get(t);if(e)return e;throw Error("Profile '"+t+"' is not supported.")},getSupportedProfiles:function(){return u},getComponent:function(t,e){t=String(t),e=~~e;const i=l.get(t);if(i)return i.level,new a(t,e,i.title,i.providerUrl);throw Error("Component '"+t+"' at level '"+e+"' is not supported.")},getSupportedComponents:function(){return l},getSupportedNode:function(t){return c.getType(String(t))},getSupportedNodes:function(){return c.getTypes()},createScene:function(t,e){const i=new h(this);if(arguments.length){if(!(t instanceof o))throw new Error("Couldn't create scene: profile must be of type ProfileInfo.");i.setProfile(t);for(let t=1,e=arguments.length;t<e;++t){const e=arguments[t];if(!(e instanceof a))throw new Error("Couldn't create scene: component must be of type ComponentInfo.");i.addComponent(e)}}return i.setup(),i},replaceWorld:function(t){if(this[w]&&this[w].abort(),this.getWorld()&&(this.getExecutionContext().setLive(!1),this.shutdown().processInterests(),this.callBrowserCallbacks(_.SHUTDOWN_EVENT),this.callBrowserEventHandler("onshutdown")),t instanceof i.MFNode){const e=t;t=this.createScene();for(const i of e)t.isLive().addInterest(i.getValue().getExecutionContext().isLive());t.setRootNodes(e)}t instanceof d||(t=this.createScene()),t.getExecutionContext().isLive().removeInterest("setLive",t),t.setExecutionContext(t),this.setDescription(""),this.getBrowserOptions().configure(),this.setBrowserLoading(!0),this.prepareEvents().removeInterest("bind",this),this._loadCount.addInterest("set_loadCount__",this);for(const e of t.getLoadingObjects())this.addLoadCount(e);this.setExecutionContext(t),this.getWorld().bind(),t.setLive(this.isLive().getValue())},set_loadCount__:function(t){t.getValue()||(this._loadCount.removeInterest("set_loadCount__",this),this.prepareEvents().addInterest("bind",this),this.addBrowserEvent())},bind:function(){this.prepareEvents().removeInterest("bind",this),this.setBrowserLoading(!1),this.initialized().getValue()&&(this.initialized().setValue(this.getCurrentTime()),this.callBrowserCallbacks(_.INITIALIZED_EVENT),this.callBrowserEventHandler("onload"))},createVrmlFromString:function(t){return this.createX3DFromString(t).rootNodes},createX3DFromString:function(t){t=String(t);const e=this.currentScene,i=this.isExternal(),n=new p(this.getWorld()).createX3DFromString(e.getWorldURL(),t);return i||(e.isLive().addInterest("setLive",n),n.setExecutionContext(e),n.setLive(e.getLive())),n},createVrmlFromURL:function(t,e,n){if(e=m(_.X3DNode,e,!1),n=String(n),!(t instanceof i.MFString))throw new Error("Browser.createVrmlFromURL: url must be of type MFString.");if(!e)throw new Error("Browser.createVrmlFromURL: node must be of type X3DNode.");const r=e.getField(n);if(!r.isInput())throw new Error("Browser.createVrmlFromURL: event named '"+n+"' must be a input field.");if(r.getType()!==_.MFNode)throw new Error("Browser.createVrmlFromURL: event named '"+n+"' must be of type MFNode.");const s=this.currentScene,o=this.isExternal(),a=new p(this.getWorld());this.addLoadCount(a),a.createX3DFromURL(t,null,function(t){this.removeLoadCount(a),t&&(o||(s.isLive().addInterest("setLive",t),t.setExecutionContext(s),t.setLive(s.getLive())),r.setValue(t.rootNodes))}.bind(this))},createX3DFromURL:function(t,e,n){if(3===arguments.length)return this.createVrmlFromURL(t,e,n);if(!(t instanceof i.MFString))throw new Error("Browser.createX3DFromURL: url must be of type MFString.");const r=this.currentScene,s=this.isExternal(),o=new p(this.getWorld()),a=o.createX3DFromURL(t,null);return s||(r.isLive().addInterest("setLive",a),a.setExecutionContext(r),a.setLive(r.getLive())),a},loadURL:function(t,e=new i.MFString){return new Promise(function(n,r){if(!(t instanceof i.MFString))throw new Error("Browser.loadURL: url must be of type MFString.");if(!(e instanceof i.MFString))throw new Error("Browser.loadURL: parameter must be of type MFString.");this._loadCount.removeInterest("set_loadCount__",this),this.prepareEvents().removeInterest("bind",this),this[w]&&this[w].abort(),this.setBrowserLoading(!0),this.addLoadCount(this);const s=this[w]=new p(this.getWorld());s.createX3DFromURL(t,e,function(t){s===this[w]?(this.getBrowserOptions().getSplashScreen()||this.getCanvas().show(),t?(this.replaceWorld(t),this.removeLoadCount(this),n()):(this.callBrowserCallbacks(_.CONNECTION_ERROR),this.callBrowserEventHandler("onerror"),setTimeout(function(){this.getSplashScreen().find(".x_ite-private-spinner-text").text(x("Failed loading world."))}.bind(this),31),r("Couldn't load X3D file."))):r("Loading of X3D file aborted.")}.bind(this),function(t){s===this[w]?(this.changeViewpoint(t),this.removeLoadCount(this),this.setBrowserLoading(!1),n()):r("Change viewpoint aborted.")}.bind(this),function(t,e){s===this[w]?(e?window.open(t,e):location=t,this.removeLoadCount(this),this.setBrowserLoading(!1),n()):r("Loading of file aborted.")}.bind(this))}.bind(this))},addBrowserListener:function(t,e){},removeBrowserListener:function(t){},addBrowserCallback:function(t,e){this[b].set(t,e)},removeBrowserCallback:function(t){this[b].delete(t)},getBrowserCallbacks:function(){return this[b]},callBrowserCallbacks:function(){const t=[];return function(e){if(this[b].size)for(const i of y.values(t,this[b]))i(e)}}(),importDocument:function(t,e,i){const n=this.currentScene,r=this.createScene(),s=this.isExternal();s||(n.isLive().addInterest("setLive",r),r.setExecutionContext(n),r.setLive(n.getLive()));const o=new f(r);if(o.setInput(t),o.parseIntoScene(e,i),1===arguments.length)return r},importJS:function(t,e,i){const n=this.currentScene,r=this.createScene(),s=this.isExternal();s||(n.isLive().addInterest("setLive",r),r.setExecutionContext(n),r.setLive(n.getLive()));const o=new g(r);if(o.setInput(t),o.parseIntoScene(e,i),1===arguments.length)return r},getBrowserProperty:function(t){return this.getBrowserProperties().getField(t).getValue()},setBrowserOption:function(t,e){this.getBrowserOptions().getField(t).setValue(e)},getBrowserOption:function(t){return this.getBrowserOptions().getField(t).getValue()},getRenderingProperty:function(t){return this.getRenderingProperties().getField(t).getValue()},firstViewpoint:function(t){(t=m(_.X3DLayerNode,t,!1))||(t=this.getActiveLayer());const e=t.getUserViewpoints();e.length&&this.bindViewpoint(t,e[0])},previousViewpoint:function(t){(t=m(_.X3DLayerNode,t,!1))||(t=this.getActiveLayer());const e=t.getUserViewpoints();if(0!==e.length){for(var i=0,n=e.length;i<n&&!e[i]._isBound.getValue();++i);i<e.length?0===i?this.bindViewpoint(t,e.at(-1)):this.bindViewpoint(t,e[i-1]):this.bindViewpoint(t,e.at(-1))}},nextViewpoint:function(t){(t=m(_.X3DLayerNode,t,!1))||(t=this.getActiveLayer());const e=t.getUserViewpoints();if(0!==e.length){for(var i=0,n=e.length;i<n&&!e[i]._isBound.getValue();++i);i<e.length?i===e.length-1?this.bindViewpoint(t,e[0]):this.bindViewpoint(t,e[i+1]):this.bindViewpoint(t,e[0])}},lastViewpoint:function(t){(t=m(_.X3DLayerNode,t,!1))||(t=this.getActiveLayer());const e=t.getUserViewpoints();e.length&&this.bindViewpoint(t,e.at(-1))},changeViewpoint:function(t,e){if(1===arguments.length&&(e=String(t),t=this.getActiveLayer()),(t=m(_.X3DLayerNode,t,!1))||(t=this.getActiveLayer()),t instanceof r)for(const i of t.getViewpoints().get())if(i.getName()===e){this.bindViewpoint(t,i);break}},bindViewpoint:function(t,e){if(t=m(_.X3DLayerNode,t,!1),e=m(_.X3DViewpointNode,e,!1),!t)throw new Error("Browser.bindViewpoint: layerNode must be of type X3DLayerNode.");if(!e)throw new Error("Browser.bindViewpoint: viewpointNode must be of type X3DViewpointNode.");e.setVRMLTransition(!0),e._isBound.getValue()?e.transitionStart(t,e,e):e._set_bind=!0},addRoute:function(t,e,i,n){this.currentScene.addRoute(t,e,i,n)},deleteRoute:function(t,e,i,n){try{const r=this.currentScene.getRoute(t,e,i,n);r&&this.currentScene.deleteRoute(r)}catch(t){console.error(t)}},beginUpdate:function(){this.setLive(!0),this.getExecutionContext().setLive(!0),this.advanceTime(performance.now()),this.addBrowserEvent()},endUpdate:function(){this.setLive(!1),this.getExecutionContext().setLive(!1)},print:function(){const e=Array.prototype.join.call(arguments,"");console.log(e);const i=t(".x_ite-console");i.length&&i.append(document.createTextNode(e))},println:function(){const e=Array.prototype.join.call(arguments,"");console.log(e);const i=t(".x_ite-console");i.length&&i.append(document.createTextNode(e+"\n"))},toVRMLStream:function(t){this.currentScene.toVRMLStream(t)},toXMLStream:function(t){this.currentScene.toXMLStream(t)},toJSONStream:function(t){this.currentScene.toJSONStream(t)}});for(const t of Reflect.ownKeys(v.prototype))Object.defineProperty(v.prototype,t,{enumerable:!1});return Object.defineProperty(v.prototype,"name",{get:function(){return this.getName()},enumerable:!0,configurable:!1}),Object.defineProperty(v.prototype,"version",{get:function(){return this.getVersion()},enumerable:!0,configurable:!1}),Object.defineProperty(v.prototype,"currentFrameRate",{get:function(){return this.getCurrentFrameRate()},enumerable:!0,configurable:!1}),Object.defineProperty(v.prototype,"currentSpeed",{get:function(){return this.getCurrentSpeed()},enumerable:!0,configurable:!1}),Object.defineProperty(v.prototype,"description",{get:function(){return this.getDescription()},set:function(t){this.setDescription(t)},enumerable:!0,configurable:!1}),Object.defineProperty(v.prototype,"currentScene",{get:function(){return this.getScriptStack().at(-1).getExecutionContext()},enumerable:!0,configurable:!1}),Object.defineProperty(v.prototype,"supportedProfiles",{get:function(){return u},enumerable:!0,configurable:!1}),Object.defineProperty(v.prototype,"supportedComponents",{get:function(){return l},enumerable:!0,configurable:!1}),v})),define("x_ite/Fallback",["jquery"],(function(t){"use strict";return{error:function(e,i){t(function(){const n=t("x3d-canvas, X3DCanvas");this.show(n,e);for(const t of i)"function"==typeof t&&t(n,e)}.bind(this))},show:function(e,i){console.error(i);const n=t(".x_ite-console");n.length&&n.append(document.createTextNode(i)),e.children(".x_ite-private-browser").hide(),e.children(":not(.x_ite-private-browser)").show(),e.each((function(t,e){e.shadowRoot&&e.shadowRoot.appendChild(document.createElement("slot"))}))}}})),define("standard/Time/MicroTime",[],(function(){"use strict";performance.now=function(){const t=performance.now;let e=0,i=0;return function(){const n=t.call(this);return n>i?(e=0,i=n,n):i=n+ ++e/1e3}}()})),define("x_ite/X3D",["jquery","x_ite/Base/X3DBaseNode","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Base/X3DField","x_ite/Base/X3DArrayField","x_ite/Fields","x_ite/Browser/X3DBrowser","x_ite/Configuration/ComponentInfo","x_ite/Configuration/ComponentInfoArray","x_ite/Configuration/ProfileInfo","x_ite/Configuration/ProfileInfoArray","x_ite/Configuration/UnitInfo","x_ite/Configuration/UnitInfoArray","x_ite/Execution/X3DExecutionContext","x_ite/Execution/X3DScene","x_ite/Execution/X3DImportedNode","x_ite/Execution/X3DExportedNode","x_ite/Prototype/ExternProtoDeclarationArray","x_ite/Prototype/ProtoDeclarationArray","x_ite/Prototype/X3DExternProtoDeclaration","x_ite/Prototype/X3DProtoDeclaration","x_ite/Prototype/X3DProtoDeclarationNode","x_ite/Routing/RouteArray","x_ite/Routing/X3DRoute","x_ite/Base/X3DConstants","x_ite/Browser/Networking/urls","x_ite/Fallback","standard/Time/MicroTime"],(function(t,e,i,n,r,s,o,a,u,l,c,h,d,p,f,g,m,_,y,x,w,b,v,S,T,C,O,N,F){"use strict";function E(e){try{if((e=t(e)).find(".x_ite-private-browser").length)return;const i=new a(e);return e.data("browser",i),i.setup(),setTimeout((function(){D.resolve()}),1),i}catch(e){N.show(t("x3d-canvas, X3DCanvas"),e),M.resolve(e)}}t.noConflict(!0);const D=t.Deferred(),M=t.Deferred();let I=!1;function V(e,i){"function"==typeof e&&D.done(e),"function"==typeof i&&M.done(i),I||(I=!0,t((function(){const e=t("X3DCanvas");e.length&&console.warn("Use of <X3DCanvas> element is depreciated, please use <x3d-canvas> element instead."),t.map(e,E)})))}return require.getComponentUrl=function(t){const e=O.getProviderUrl(t);return"function"==typeof __global_require__&&"string"==typeof __filename&&__global_require__(__global_require__("url").fileURLToPath(e)),e},Object.assign(V,{hidden:["hidden","createBrowserFromElement"],require:require,define:define,getBrowser:function(e){return t(e||"x3d-canvas, X3DCanvas").data("browser")},createBrowser:function(e,i){const n=t("<x3d-canvas></x3d-canvas>");return e instanceof o.MFString&&n.attr("url",e.toString()),n.get(0)},createBrowserFromElement:E,X3DConstants:C,X3DBrowser:a,X3DExecutionContext:f,X3DScene:g,ComponentInfo:u,ComponentInfoArray:l,ProfileInfo:c,ProfileInfoArray:h,UnitInfo:d,UnitInfoArray:p,ExternProtoDeclarationArray:y,ProtoDeclarationArray:x,X3DExternProtoDeclaration:w,X3DProtoDeclaration:b,RouteArray:S,X3DRoute:T,X3DBaseNode:e,X3DExportedNode:_,X3DImportedNode:m,X3DProtoDeclarationNode:v,X3DFieldDefinition:i,FieldDefinitionArray:n,X3DField:r,X3DArrayField:s,SFColor:o.SFColor,SFColorRGBA:o.SFColorRGBA,SFImage:o.SFImage,SFMatrix3d:o.SFMatrix3d,SFMatrix3f:o.SFMatrix3f,SFMatrix4d:o.SFMatrix4d,SFMatrix4f:o.SFMatrix4f,SFNode:o.SFNode,SFRotation:o.SFRotation,SFVec2d:o.SFVec2d,SFVec2f:o.SFVec2f,SFVec3d:o.SFVec3d,SFVec3f:o.SFVec3f,SFVec4d:o.SFVec4d,SFVec4f:o.SFVec4f,VrmlMatrix:o.VrmlMatrix,MFBool:o.MFBool,MFColor:o.MFColor,MFColorRGBA:o.MFColorRGBA,MFDouble:o.MFDouble,MFFloat:o.MFFloat,MFImage:o.MFImage,MFInt32:o.MFInt32,MFMatrix3d:o.MFMatrix3d,MFMatrix3f:o.MFMatrix3f,MFMatrix4d:o.MFMatrix4d,MFMatrix4f:o.MFMatrix4f,MFNode:o.MFNode,MFRotation:o.MFRotation,MFString:o.MFString,MFTime:o.MFTime,MFVec2d:o.MFVec2d,MFVec2f:o.MFVec2f,MFVec3d:o.MFVec3d,MFVec3f:o.MFVec3f,MFVec4d:o.MFVec4d,MFVec4f:o.MFVec4f}),V})),require.config({waitSeconds:0}),define.show=function(){this.define=window.define,window.define=this},define.hide=function(){void 0===this.define?delete window.define:window.define=this.define,delete this.define};const getScriptURL=function(){if(document.currentScript)var t=document.currentScript.src;else if("function"==typeof __global_require__&&"string"==typeof __filename)t=__global_require__("url").pathToFileURL(__filename).href;return function(){return t}}();!function(){"use strict";function t(t,e){return new Promise((function(i,n){require(["x_ite/X3D"],(function(r){r(t,e),r(i,n)}),(function(t){"function"==typeof e&&e(t),n(t)}))}))}t.noConflict=function(){return window.X3D===t&&(void 0===e?delete window.X3D:window.X3D=e),t},t.require=require,t.define=define;const e=window.X3D;window.X3D=t,window[Symbol.for("X_ITE.X3D-6.1.0")]=t,"object"==typeof __global_module__&&"object"==typeof __global_module__.exports&&(__global_module__.exports=t),document.createElement("X3DCanvas");class i extends HTMLElement{constructor(){super();const t=this.attachShadow({mode:"open"}),e=document.createElement("link");t.loaded=new Promise((function(t,i){e.onload=t,e.onerror=i})),e.setAttribute("rel","stylesheet"),e.setAttribute("type","text/css"),e.setAttribute("href",new URL("x_ite.css",getScriptURL()).href),t.appendChild(e),require(["x_ite/X3D"],function(t){t.createBrowserFromElement(this)}.bind(this))}}customElements.define("x3d-canvas",i),t.X3DCanvas=i,require(["x_ite/X3D"],(function(e){Object.assign(t,e);for(const i of e.hidden)delete t[i];e()}))}(),function(){function t(t){if((t=Math.trunc(t)||0)<0&&(t+=this.length),!(t<0||t>=this.length))return this[t]}const e=Reflect.getPrototypeOf(Int8Array);for(const i of[Array,String,e])void 0===i.prototype.at&&Object.defineProperty(i.prototype,"at",{value:t,writable:!0,enumerable:!1,configurable:!0})}(),define("x_ite",(function(){})),define("x_ite/Browser/Shaders/ShaderCompiler",[],(function(){"use strict";function t(){}return t.prototype={getSourceFileName:function(){},process:function(t){return t}},t}))}));
