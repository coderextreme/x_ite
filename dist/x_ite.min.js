/* X_ITE X3D v5.0.0a-1141
 * See LICENSE.txt for a detailed listing of used licences. */
!function(globalModule,globalRequire){"undefined"==typeof __filename&&(globalModule=void 0,globalRequire=void 0);var module,exports,process,requirejs,require,define;!function(global,setTimeout){function commentReplace(e,t){return t||""}function isFunction(e){return"[object Function]"===ostring.call(e)}function isArray(e){return"[object Array]"===ostring.call(e)}function each(e,t){if(e){var i;for(i=0;i<e.length&&(!e[i]||!t(e[i],i,e));i+=1);}}function eachReverse(e,t){if(e){var i;for(i=e.length-1;i>-1&&(!e[i]||!t(e[i],i,e));i-=1);}}function hasProp(e,t){return hasOwn.call(e,t)}function getOwn(e,t){return hasProp(e,t)&&e[t]}function eachProp(e,t){var i;for(i in e)if(hasProp(e,i)&&t(e[i],i))break}function mixin(e,t,i,n){return t&&eachProp(t,function(t,r){!i&&hasProp(e,r)||(!n||"object"!=typeof t||!t||isArray(t)||isFunction(t)||t instanceof RegExp?e[r]=t:(e[r]||(e[r]={}),mixin(e[r],t,i,n)))}),e}function bind(e,t){return function(){return t.apply(e,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(e){throw e}function getGlobal(e){if(!e)return e;var t=global;return each(e.split("."),function(e){t=t[e]}),t}function makeError(e,t,i,n){var r=new Error(t+"\nhttps://requirejs.org/docs/errors.html#"+e);return r.requireType=e,r.requireModules=n,i&&(r.originalError=i),r}function newContext(e){function t(e){var t,i;for(t=0;t<e.length;t++)if("."===(i=e[t]))e.splice(t,1),t-=1;else if(".."===i){if(0===t||1===t&&".."===e[2]||".."===e[t-1])continue;t>0&&(e.splice(t-1,2),t-=2)}}function i(e,i,n){var r,o,s,a,u,l,c,h,d,p,f,g,m=i&&i.split("/"),y=S.map,_=y&&y["*"];if(e&&(e=e.split("/"),c=e.length-1,S.nodeIdCompat&&jsSuffixRegExp.test(e[c])&&(e[c]=e[c].replace(jsSuffixRegExp,"")),"."===e[0].charAt(0)&&m&&(g=m.slice(0,m.length-1),e=g.concat(e)),t(e),e=e.join("/")),n&&y&&(m||_)){s=e.split("/");e:for(a=s.length;a>0;a-=1){if(l=s.slice(0,a).join("/"),m)for(u=m.length;u>0;u-=1)if((o=getOwn(y,m.slice(0,u).join("/")))&&(o=getOwn(o,l))){h=o,d=a;break e}!p&&_&&getOwn(_,l)&&(p=getOwn(_,l),f=a)}!h&&p&&(h=p,d=f),h&&(s.splice(0,d,h),e=s.join("/"))}return r=getOwn(S.pkgs,e),r?r:e}function n(e){isBrowser&&each(scripts(),function(t){if(t.getAttribute("data-requiremodule")===e&&t.getAttribute("data-requirecontext")===w.contextName)return t.parentNode.removeChild(t),!0})}function r(e){var t=getOwn(S.paths,e);if(t&&isArray(t)&&t.length>1)return t.shift(),w.require.undef(e),w.makeRequire(null,{skipMap:!0})([e]),!0}function o(e){var t,i=e?e.indexOf("!"):-1;return i>-1&&(t=e.substring(0,i),e=e.substring(i+1,e.length)),[t,e]}function s(e,t,n,r){var s,a,u,l,c=null,h=t?t.name:null,d=e,p=!0,f="";return e||(p=!1,e="_@r"+(M+=1)),l=o(e),c=l[0],e=l[1],c&&(c=i(c,h,r),a=getOwn(N,c)),e&&(c?f=n?e:a&&a.normalize?a.normalize(e,function(e){return i(e,h,r)}):e.indexOf("!")===-1?i(e,h,r):e:(f=i(e,h,r),l=o(f),c=l[0],f=l[1],n=!0,s=w.nameToUrl(f))),u=!c||a||n?"":"_unnormalized"+(V+=1),{prefix:c,name:f,parentMap:t,unnormalized:!!u,url:s,originalName:d,isDefine:p,id:(c?c+"!"+f:f)+u}}function a(e){var t=e.id,i=getOwn(T,t);return i||(i=T[t]=new w.Module(e)),i}function u(e,t,i){var n=e.id,r=getOwn(T,n);!hasProp(N,n)||r&&!r.defineEmitComplete?(r=a(e),r.error&&"error"===t?i(r.error):r.on(t,i)):"defined"===t&&i(N[n])}function l(e,t){var i=e.requireModules,n=!1;t?t(e):(each(i,function(t){var i=getOwn(T,t);i&&(i.error=e,i.events.error&&(n=!0,i.emit("error",e)))}),n||req.onError(e))}function c(){globalDefQueue.length&&(each(globalDefQueue,function(e){var t=e[0];"string"==typeof t&&(w.defQueueMap[t]=!0),O.push(e)}),globalDefQueue=[])}function h(e){delete T[e],delete C[e]}function d(e,t,i){var n=e.map.id;e.error?e.emit("error",e.error):(t[n]=!0,each(e.depMaps,function(n,r){var o=n.id,s=getOwn(T,o);!s||e.depMatched[r]||i[o]||(getOwn(t,o)?(e.defineDep(r,N[o]),e.check()):d(s,t,i))}),i[n]=!0)}function p(){var e,t,i=1e3*S.waitSeconds,o=i&&w.startTime+i<(new Date).getTime(),s=[],a=[],u=!1,c=!0;if(!_){if(_=!0,eachProp(C,function(e){var i=e.map,l=i.id;if(e.enabled&&(i.isDefine||a.push(e),!e.error))if(!e.inited&&o)r(l)?(t=!0,u=!0):(s.push(l),n(l));else if(!e.inited&&e.fetched&&i.isDefine&&(u=!0,!i.prefix))return c=!1}),o&&s.length)return e=makeError("timeout","Load timeout for modules: "+s,null,s),e.contextName=w.contextName,l(e);c&&each(a,function(e){d(e,{},{})}),o&&!t||!u||!isBrowser&&!isWebWorker||v||(v=setTimeout(function(){v=0,p()},50)),_=!1}}function f(e){hasProp(N,e[0])||a(s(e[0],null,!0)).init(e[1],e[2])}function g(e,t,i,n){e.detachEvent&&!isOpera?n&&e.detachEvent(n,t):e.removeEventListener(i,t,!1)}function m(e){var t=e.currentTarget||e.srcElement;return g(t,w.onScriptLoad,"load","onreadystatechange"),g(t,w.onScriptError,"error"),{node:t,id:t&&t.getAttribute("data-requiremodule")}}function y(){var e;for(c();O.length;){if(e=O.shift(),null===e[0])return l(makeError("mismatch","Mismatched anonymous define() module: "+e[e.length-1]));f(e)}w.defQueueMap={}}var _,x,w,b,v,S={waitSeconds:7,baseUrl:"./",paths:{},bundles:{},pkgs:{},shim:{},config:{}},T={},C={},F={},O=[],N={},E={},D={},M=1,V=1;return b={require:function(e){return e.require?e.require:e.require=w.makeRequire(e.map)},exports:function(e){if(e.usingExports=!0,e.map.isDefine)return e.exports?N[e.map.id]=e.exports:e.exports=N[e.map.id]={}},module:function(e){return e.module?e.module:e.module={id:e.map.id,uri:e.map.url,config:function(){return getOwn(S.config,e.map.id)||{}},exports:e.exports||(e.exports={})}}},x=function(e){this.events=getOwn(F,e.id)||{},this.map=e,this.shim=getOwn(S.shim,e.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},x.prototype={init:function(e,t,i,n){n=n||{},this.inited||(this.factory=t,i?this.on("error",i):this.events.error&&(i=bind(this,function(e){this.emit("error",e)})),this.depMaps=e&&e.slice(0),this.errback=i,this.inited=!0,this.ignore=n.ignore,n.enabled||this.enabled?this.enable():this.check())},defineDep:function(e,t){this.depMatched[e]||(this.depMatched[e]=!0,this.depCount-=1,this.depExports[e]=t)},fetch:function(){if(!this.fetched){this.fetched=!0,w.startTime=(new Date).getTime();var e=this.map;if(!this.shim)return e.prefix?this.callPlugin():this.load();w.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return e.prefix?this.callPlugin():this.load()}))}},load:function(){var e=this.map.url;E[e]||(E[e]=!0,w.load(this.map.id,e))},check:function(){if(this.enabled&&!this.enabling){var e,t,i=this.map.id,n=this.depExports,r=this.exports,o=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(o)){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)try{r=w.execCb(i,o,n,r)}catch(t){e=t}else r=w.execCb(i,o,n,r);if(this.map.isDefine&&void 0===r&&(t=this.module,t?r=t.exports:this.usingExports&&(r=this.exports)),e)return e.requireMap=this.map,e.requireModules=this.map.isDefine?[this.map.id]:null,e.requireType=this.map.isDefine?"define":"require",l(this.error=e)}else r=o;if(this.exports=r,this.map.isDefine&&!this.ignore&&(N[i]=r,req.onResourceLoad)){var s=[];each(this.depMaps,function(e){s.push(e.normalizedMap||e)}),req.onResourceLoad(w,this.map,s)}h(i),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else hasProp(w.defQueueMap,i)||this.fetch()}},callPlugin:function(){var e=this.map,t=e.id,n=s(e.prefix);this.depMaps.push(n),u(n,"defined",bind(this,function(n){var r,o,c,d=getOwn(D,this.map.id),p=this.map.name,f=this.map.parentMap?this.map.parentMap.name:null,g=w.makeRequire(e.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(n.normalize&&(p=n.normalize(p,function(e){return i(e,f,!0)})||""),o=s(e.prefix+"!"+p,this.map.parentMap,!0),u(o,"defined",bind(this,function(e){this.map.normalizedMap=o,this.init([],function(){return e},null,{enabled:!0,ignore:!0})})),void((c=getOwn(T,o.id))&&(this.depMaps.push(o),this.events.error&&c.on("error",bind(this,function(e){this.emit("error",e)})),c.enable()))):d?(this.map.url=w.nameToUrl(d),void this.load()):(r=bind(this,function(e){this.init([],function(){return e},null,{enabled:!0})}),r.error=bind(this,function(e){this.inited=!0,this.error=e,e.requireModules=[t],eachProp(T,function(e){0===e.map.id.indexOf(t+"_unnormalized")&&h(e.map.id)}),l(e)}),r.fromText=bind(this,function(i,n){var o=e.name,u=s(o),c=useInteractive;n&&(i=n),c&&(useInteractive=!1),a(u),hasProp(S.config,t)&&(S.config[o]=S.config[t]);try{req.exec(i)}catch(e){return l(makeError("fromtexteval","fromText eval for "+t+" failed: "+e,e,[t]))}c&&(useInteractive=!0),this.depMaps.push(u),w.completeLoad(o),g([o],r)}),void n.load(e.name,g,r,S))})),w.enable(n,this),this.pluginMaps[n.id]=n},enable:function(){C[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(e,t){var i,n,r;if("string"==typeof e){if(e=s(e,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[t]=e,r=getOwn(b,e.id))return void(this.depExports[t]=r(this));this.depCount+=1,u(e,"defined",bind(this,function(e){this.undefed||(this.defineDep(t,e),this.check())})),this.errback?u(e,"error",bind(this,this.errback)):this.events.error&&u(e,"error",bind(this,function(e){this.emit("error",e)}))}i=e.id,n=T[i],hasProp(b,i)||!n||n.enabled||w.enable(e,this)})),eachProp(this.pluginMaps,bind(this,function(e){var t=getOwn(T,e.id);t&&!t.enabled&&w.enable(e,this)})),this.enabling=!1,this.check()},on:function(e,t){var i=this.events[e];i||(i=this.events[e]=[]),i.push(t)},emit:function(e,t){each(this.events[e],function(e){e(t)}),"error"===e&&delete this.events[e]}},w={config:S,contextName:e,registry:T,defined:N,urlFetched:E,defQueue:O,defQueueMap:{},Module:x,makeModuleMap:s,nextTick:req.nextTick,onError:l,configure:function(e){if(e.baseUrl&&"/"!==e.baseUrl.charAt(e.baseUrl.length-1)&&(e.baseUrl+="/"),"string"==typeof e.urlArgs){var t=e.urlArgs;e.urlArgs=function(e,i){return(i.indexOf("?")===-1?"?":"&")+t}}var i=S.shim,n={paths:!0,bundles:!0,config:!0,map:!0};eachProp(e,function(e,t){n[t]?(S[t]||(S[t]={}),mixin(S[t],e,!0,!0)):S[t]=e}),e.bundles&&eachProp(e.bundles,function(e,t){each(e,function(e){e!==t&&(D[e]=t)})}),e.shim&&(eachProp(e.shim,function(e,t){isArray(e)&&(e={deps:e}),!e.exports&&!e.init||e.exportsFn||(e.exportsFn=w.makeShimExports(e)),i[t]=e}),S.shim=i),e.packages&&each(e.packages,function(e){var t,i;e="string"==typeof e?{name:e}:e,i=e.name,t=e.location,t&&(S.paths[i]=e.location),S.pkgs[i]=e.name+"/"+(e.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}),eachProp(T,function(e,t){e.inited||e.map.unnormalized||(e.map=s(t,null,!0))}),(e.deps||e.callback)&&w.require(e.deps||[],e.callback)},makeShimExports:function(e){function t(){var t;return e.init&&(t=e.init.apply(global,arguments)),t||e.exports&&getGlobal(e.exports)}return t},makeRequire:function(t,r){function o(i,n,u){var c,h,d;return r.enableBuildCallback&&n&&isFunction(n)&&(n.__requireJsBuild=!0),"string"==typeof i?isFunction(n)?l(makeError("requireargs","Invalid require call"),u):t&&hasProp(b,i)?b[i](T[t.id]):req.get?req.get(w,i,t,o):(h=s(i,t,!1,!0),c=h.id,hasProp(N,c)?N[c]:l(makeError("notloaded",'Module name "'+c+'" has not been loaded yet for context: '+e+(t?"":". Use require([])")))):(y(),w.nextTick(function(){y(),d=a(s(null,t)),d.skipMap=r.skipMap,d.init(i,n,u,{enabled:!0}),p()}),o)}return r=r||{},mixin(o,{isBrowser:isBrowser,toUrl:function(e){var n,r=e.lastIndexOf("."),o=e.split("/")[0],s="."===o||".."===o;return r!==-1&&(!s||r>1)&&(n=e.substring(r,e.length),e=e.substring(0,r)),w.nameToUrl(i(e,t&&t.id,!0),n,!0)},defined:function(e){return hasProp(N,s(e,t,!1,!0).id)},specified:function(e){return e=s(e,t,!1,!0).id,hasProp(N,e)||hasProp(T,e)}}),t||(o.undef=function(e){c();var i=s(e,t,!0),r=getOwn(T,e);r.undefed=!0,n(e),delete N[e],delete E[i.url],delete F[e],eachReverse(O,function(t,i){t[0]===e&&O.splice(i,1)}),delete w.defQueueMap[e],r&&(r.events.defined&&(F[e]=r.events),h(e))}),o},enable:function(e){getOwn(T,e.id)&&a(e).enable()},completeLoad:function(e){var t,i,n,o=getOwn(S.shim,e)||{},s=o.exports;for(c();O.length;){if(i=O.shift(),null===i[0]){if(i[0]=e,t)break;t=!0}else i[0]===e&&(t=!0);f(i)}if(w.defQueueMap={},n=getOwn(T,e),!t&&!hasProp(N,e)&&n&&!n.inited){if(!(!S.enforceDefine||s&&getGlobal(s)))return r(e)?void 0:l(makeError("nodefine","No define call for "+e,null,[e]));f([e,o.deps||[],o.exportsFn])}p()},nameToUrl:function(e,t,i){var n,r,o,s,a,u,l,c=getOwn(S.pkgs,e);if(c&&(e=c),l=getOwn(D,e))return w.nameToUrl(l,t,i);if(req.jsExtRegExp.test(e))a=e+(t||"");else{for(n=S.paths,r=e.split("/"),o=r.length;o>0;o-=1)if(s=r.slice(0,o).join("/"),u=getOwn(n,s)){isArray(u)&&(u=u[0]),r.splice(0,o,u);break}a=r.join("/"),a+=t||(/^data\:|^blob\:|\?/.test(a)||i?"":".js"),a=("/"===a.charAt(0)||a.match(/^[\w\+\.\-]+:/)?"":S.baseUrl)+a}return S.urlArgs&&!/^blob\:/.test(a)?a+S.urlArgs(e,a):a},load:function(e,t){req.load(w,e,t)},execCb:function(e,t,i,n){return t.apply(n,i)},onScriptLoad:function(e){if("load"===e.type||readyRegExp.test((e.currentTarget||e.srcElement).readyState)){interactiveScript=null;var t=m(e);w.completeLoad(t.id)}},onScriptError:function(e){var t=m(e);if(!r(t.id)){var i=[];return eachProp(T,function(e,n){0!==n.indexOf("_@r")&&each(e.depMaps,function(e){if(e.id===t.id)return i.push(n),!0})}),l(makeError("scripterror",'Script error for "'+t.id+(i.length?'", needed by: '+i.join(", "):'"'),e,[t.id]))}}},w.require=w.makeRequire(),w}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState?interactiveScript:(eachReverse(scripts(),function(e){if("interactive"===e.readyState)return interactiveScript=e}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.3.6",commentRegExp=/\/\*[\s\S]*?\*\/|([^:"'=]|^)\/\/.*$/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,isBrowser=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if(void 0===define){if(void 0!==requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}void 0===require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(e,t,i,n){var r,o,s="_";return isArray(e)||"string"==typeof e||(o=e,isArray(t)?(e=t,t=i,i=n):e=[]),o&&o.context&&(s=o.context),r=getOwn(contexts,s),r||(r=contexts[s]=req.s.newContext(s)),o&&r.configure(o),r.require(e,t,i)},req.config=function(e){return req(e)},req.nextTick=void 0!==setTimeout?function(e){setTimeout(e,4)}:function(e){e()},require||(require=req),req.version="2.3.6",req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(e){req[e]=function(){var t=contexts._;return t.require[e].apply(t,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],(baseElement=document.getElementsByTagName("base")[0])&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.createNode=function(e,t,i){var n=e.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return n.type=e.scriptType||"text/javascript",n.charset="utf-8",n.async=!0,n},req.load=function(e,t,i){var n,r=e&&e.config||{};if(isBrowser)return n=req.createNode(r,t,i),n.setAttribute("data-requirecontext",e.contextName),n.setAttribute("data-requiremodule",t),!n.attachEvent||n.attachEvent.toString&&n.attachEvent.toString().indexOf("[native code")<0||isOpera?(n.addEventListener("load",e.onScriptLoad,!1),n.addEventListener("error",e.onScriptError,!1)):(useInteractive=!0,n.attachEvent("onreadystatechange",e.onScriptLoad)),n.src=i,r.onNodeCreated&&r.onNodeCreated(n,r,t,i),currentlyAddingScript=n,baseElement?head.insertBefore(n,baseElement):head.appendChild(n),currentlyAddingScript=null,n;if(isWebWorker)try{setTimeout(function(){},0),importScripts(i),e.completeLoad(t)}catch(n){e.onError(makeError("importscripts","importScripts failed for "+t+" at "+i,n,[t]))}},isBrowser&&!cfg.skipDataMain&&eachReverse(scripts(),function(e){if(head||(head=e.parentNode),dataMain=e.getAttribute("data-main"))return mainScript=dataMain,cfg.baseUrl||mainScript.indexOf("!")!==-1||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0}),define=function(e,t,i){var n,r;"string"!=typeof e&&(i=t,t=e,e=null),isArray(t)||(i=t,t=null),!t&&isFunction(i)&&(t=[],i.length&&(i.toString().replace(/\/\*[\s\S]*?\*\/|([^:"'=]|^)\/\/.*$/gm,commentReplace).replace(/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,function(e,i){t.push(i)}),t=(1===i.length?["require"]:["require","exports","module"]).concat(t))),useInteractive&&(n=currentlyAddingScript||getInteractiveScript())&&(e||(e=n.getAttribute("data-requiremodule")),r=contexts[n.getAttribute("data-requirecontext")]),r?(r.defQueue.push([e,t,i]),r.defQueueMap[e]=!0):globalDefQueue.push([e,t,i])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}}(this,"undefined"==typeof setTimeout?void 0:setTimeout),define("../node_modules/requirejs/require.js",function(){}),function(e,t){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){function i(e,t,i){i=i||be;var n,r,o=i.createElement("script");if(o.text=e,t)for(n in ve)(r=t[n]||t.getAttribute&&t.getAttribute(n))&&o.setAttribute(n,r);i.head.appendChild(o).parentNode.removeChild(o)}function n(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?pe[fe.call(e)]||"object":typeof e}function r(e){var t=!!e&&"length"in e&&e.length,i=n(e);return!xe(e)&&!we(e)&&("array"===i||0===t||"number"==typeof t&&t>0&&t-1 in e)}function o(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}function s(e,t,i){return xe(t)?Se.grep(e,function(e,n){return!!t.call(e,n,e)!==i}):t.nodeType?Se.grep(e,function(e){return e===t!==i}):"string"!=typeof t?Se.grep(e,function(e){return de.call(t,e)>-1!==i}):Se.filter(t,e,i)}function a(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}function u(e){var t={};return Se.each(e.match(Ie)||[],function(e,i){t[i]=!0}),t}function l(e){return e}function c(e){throw e}function h(e,t,i,n){var r;try{e&&xe(r=e.promise)?r.call(e).done(t).fail(i):e&&xe(r=e.then)?r.call(e,t,i):t.apply(void 0,[e].slice(n))}catch(e){i.apply(void 0,[e])}}function d(){be.removeEventListener("DOMContentLoaded",d),e.removeEventListener("load",d),Se.ready()}function p(e,t){return t.toUpperCase()}function f(e){return e.replace(Re,"ms-").replace(Le,p)}function g(){this.expando=Se.expando+g.uid++}function m(e){return"true"===e||"false"!==e&&("null"===e?null:e===+e+""?+e:ze.test(e)?JSON.parse(e):e)}function y(e,t,i){var n;if(void 0===i&&1===e.nodeType)if(n="data-"+t.replace(je,"-$&").toLowerCase(),"string"==typeof(i=e.getAttribute(n))){try{i=m(i)}catch(e){}Xe.set(e,t,i)}else i=void 0;return i}function _(e,t,i,n){var r,o,s=20,a=n?function(){return n.cur()}:function(){return Se.css(e,t,"")},u=a(),l=i&&i[3]||(Se.cssNumber[t]?"":"px"),c=e.nodeType&&(Se.cssNumber[t]||"px"!==l&&+u)&&qe.exec(Se.css(e,t));if(c&&c[3]!==l){for(u/=2,l=l||c[3],c=+u||1;s--;)Se.style(e,t,c+l),(1-o)*(1-(o=a()/u||.5))<=0&&(s=0),c/=o;c*=2,Se.style(e,t,c+l),i=i||[]}return i&&(c=+c||+u||0,r=i[1]?c+(i[1]+1)*i[2]:+i[2],n&&(n.unit=l,n.start=c,n.end=r)),r}function x(e){var t,i=e.ownerDocument,n=e.nodeName,r=Ke[n];return r?r:(t=i.body.appendChild(i.createElement(n)),r=Se.css(t,"display"),t.parentNode.removeChild(t),"none"===r&&(r="block"),Ke[n]=r,r)}function w(e,t){for(var i,n,r=[],o=0,s=e.length;o<s;o++)n=e[o],n.style&&(i=n.style.display,t?("none"===i&&(r[o]=Ue.get(n,"display")||null,r[o]||(n.style.display="")),""===n.style.display&&Ze(n)&&(r[o]=x(n))):"none"!==i&&(r[o]="none",Ue.set(n,"display",i)));for(o=0;o<s;o++)null!=r[o]&&(e[o].style.display=r[o]);return e}function b(e,t){var i;return i=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&o(e,t)?Se.merge([e],i):i}function v(e,t){for(var i=0,n=e.length;i<n;i++)Ue.set(e[i],"globalEval",!t||Ue.get(t[i],"globalEval"))}function S(e,t,i,r,o){for(var s,a,u,l,c,h,d=t.createDocumentFragment(),p=[],f=0,g=e.length;f<g;f++)if((s=e[f])||0===s)if("object"===n(s))Se.merge(p,s.nodeType?[s]:s);else if(it.test(s)){for(a=a||d.appendChild(t.createElement("div")),u=(Je.exec(s)||["",""])[1].toLowerCase(),l=tt[u]||tt._default,a.innerHTML=l[1]+Se.htmlPrefilter(s)+l[2],h=l[0];h--;)a=a.lastChild;Se.merge(p,a.childNodes),a=d.firstChild,a.textContent=""}else p.push(t.createTextNode(s));for(d.textContent="",f=0;s=p[f++];)if(r&&Se.inArray(s,r)>-1)o&&o.push(s);else if(c=Ye(s),a=b(d.appendChild(s),"script"),c&&v(a),i)for(h=0;s=a[h++];)et.test(s.type||"")&&i.push(s);return d}function T(){return!0}function C(){return!1}function F(e,t){return e===O()==("focus"===t)}function O(){try{return be.activeElement}catch(e){}}function N(e,t,i,n,r,o){var s,a;if("object"==typeof t){"string"!=typeof i&&(n=n||i,i=void 0);for(a in t)N(e,a,i,n,t[a],o);return e}if(null==n&&null==r?(r=i,n=i=void 0):null==r&&("string"==typeof i?(r=n,n=void 0):(r=n,n=i,i=void 0)),r===!1)r=C;else if(!r)return e;return 1===o&&(s=r,r=function(e){return Se().off(e),s.apply(this,arguments)},r.guid=s.guid||(s.guid=Se.guid++)),e.each(function(){Se.event.add(this,t,r,n,i)})}function E(e,t,i){if(!i)return void(void 0===Ue.get(e,t)&&Se.event.add(e,t,T));Ue.set(e,t,!1),Se.event.add(e,t,{namespace:!1,handler:function(e){var n,r,o=Ue.get(this,t);if(1&e.isTrigger&&this[t]){if(o.length)(Se.event.special[t]||{}).delegateType&&e.stopPropagation();else if(o=le.call(arguments),Ue.set(this,t,o),n=i(this,t),this[t](),r=Ue.get(this,t),o!==r||n?Ue.set(this,t,!1):r={},o!==r)return e.stopImmediatePropagation(),e.preventDefault(),r&&r.value}else o.length&&(Ue.set(this,t,{value:Se.event.trigger(Se.extend(o[0],Se.Event.prototype),o.slice(1),this)}),e.stopImmediatePropagation())}})}function D(e,t){return o(e,"table")&&o(11!==t.nodeType?t:t.firstChild,"tr")?Se(e).children("tbody")[0]||e:e}function M(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function V(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function I(e,t){var i,n,r,o,s,a,u;if(1===t.nodeType){if(Ue.hasData(e)&&(o=Ue.get(e),u=o.events)){Ue.remove(t,"handle events");for(r in u)for(i=0,n=u[r].length;i<n;i++)Se.event.add(t,r,u[r][i])}Xe.hasData(e)&&(s=Xe.access(e),a=Se.extend({},s),Xe.set(t,a))}}function B(e,t){var i=t.nodeName.toLowerCase();"input"===i&&Qe.test(e.type)?t.checked=e.checked:"input"!==i&&"textarea"!==i||(t.defaultValue=e.defaultValue)}function A(e,t,n,r){t=ce(t);var o,s,a,u,l,c,h=0,d=e.length,p=d-1,f=t[0],g=xe(f);if(g||d>1&&"string"==typeof f&&!_e.checkClone&&ot.test(f))return e.each(function(i){var o=e.eq(i);g&&(t[0]=f.call(this,i,o.html())),A(o,t,n,r)});if(d&&(o=S(t,e[0].ownerDocument,!1,e,r),s=o.firstChild,1===o.childNodes.length&&(o=s),s||r)){for(a=Se.map(b(o,"script"),M),u=a.length;h<d;h++)l=o,h!==p&&(l=Se.clone(l,!0,!0),u&&Se.merge(a,b(l,"script"))),n.call(e[h],l,h);if(u)for(c=a[a.length-1].ownerDocument,Se.map(a,V),h=0;h<u;h++)l=a[h],et.test(l.type||"")&&!Ue.access(l,"globalEval")&&Se.contains(c,l)&&(l.src&&"module"!==(l.type||"").toLowerCase()?Se._evalUrl&&!l.noModule&&Se._evalUrl(l.src,{nonce:l.nonce||l.getAttribute("nonce")},c):i(l.textContent.replace(st,""),l,c))}return e}function P(e,t,i){for(var n,r=t?Se.filter(t,e):e,o=0;null!=(n=r[o]);o++)i||1!==n.nodeType||Se.cleanData(b(n)),n.parentNode&&(i&&Ye(n)&&v(b(n,"script")),n.parentNode.removeChild(n));return e}function R(e,t,i){var n,r,o,s,a=e.style;return i=i||ut(e),i&&(s=i.getPropertyValue(t)||i[t],""!==s||Ye(e)||(s=Se.style(e,t)),!_e.pixelBoxStyles()&&at.test(s)&&ct.test(t)&&(n=a.width,r=a.minWidth,o=a.maxWidth,a.minWidth=a.maxWidth=a.width=s,s=i.width,a.width=n,a.minWidth=r,a.maxWidth=o)),void 0!==s?s+"":s}function L(e,t){return{get:function(){return e()?void delete this.get:(this.get=t).apply(this,arguments)}}}function k(e){for(var t=e[0].toUpperCase()+e.slice(1),i=ht.length;i--;)if((e=ht[i]+t)in dt)return e}function U(e){var t=Se.cssProps[e]||pt[e];return t?t:e in dt?e:pt[e]=k(e)||e}function X(e,t,i){var n=qe.exec(t);return n?Math.max(0,n[2]-(i||0))+(n[3]||"px"):t}function z(e,t,i,n,r,o){var s="width"===t?1:0,a=0,u=0;if(i===(n?"border":"content"))return 0;for(;s<4;s+=2)"margin"===i&&(u+=Se.css(e,i+He[s],!0,r)),n?("content"===i&&(u-=Se.css(e,"padding"+He[s],!0,r)),"margin"!==i&&(u-=Se.css(e,"border"+He[s]+"Width",!0,r))):(u+=Se.css(e,"padding"+He[s],!0,r),"padding"!==i?u+=Se.css(e,"border"+He[s]+"Width",!0,r):a+=Se.css(e,"border"+He[s]+"Width",!0,r));return!n&&o>=0&&(u+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-o-u-a-.5))||0),u}function j(e,t,i){var n=ut(e),r=!_e.boxSizingReliable()||i,s=r&&"border-box"===Se.css(e,"boxSizing",!1,n),a=s,u=R(e,t,n),l="offset"+t[0].toUpperCase()+t.slice(1);if(at.test(u)){if(!i)return u;u="auto"}return(!_e.boxSizingReliable()&&s||!_e.reliableTrDimensions()&&o(e,"tr")||"auto"===u||!parseFloat(u)&&"inline"===Se.css(e,"display",!1,n))&&e.getClientRects().length&&(s="border-box"===Se.css(e,"boxSizing",!1,n),(a=l in e)&&(u=e[l])),(u=parseFloat(u)||0)+z(e,t,i||(s?"border":"content"),a,n,u)+"px"}function G(e,t,i,n,r){return new G.prototype.init(e,t,i,n,r)}function q(){xt&&(be.hidden===!1&&e.requestAnimationFrame?e.requestAnimationFrame(q):e.setTimeout(q,Se.fx.interval),Se.fx.tick())}function H(){return e.setTimeout(function(){_t=void 0}),_t=Date.now()}function W(e,t){var i,n=0,r={height:e};for(t=t?1:0;n<4;n+=2-t)i=He[n],r["margin"+i]=r["padding"+i]=e;return t&&(r.opacity=r.width=e),r}function Y(e,t,i){for(var n,r=(K.tweeners[t]||[]).concat(K.tweeners["*"]),o=0,s=r.length;o<s;o++)if(n=r[o].call(i,t,e))return n}function $(e,t,i){var n,r,o,s,a,u,l,c,h="width"in t||"height"in t,d=this,p={},f=e.style,g=e.nodeType&&Ze(e),m=Ue.get(e,"fxshow");i.queue||(s=Se._queueHooks(e,"fx"),null==s.unqueued&&(s.unqueued=0,a=s.empty.fire,s.empty.fire=function(){s.unqueued||a()}),s.unqueued++,d.always(function(){d.always(function(){s.unqueued--,Se.queue(e,"fx").length||s.empty.fire()})}));for(n in t)if(r=t[n],wt.test(r)){if(delete t[n],o=o||"toggle"===r,r===(g?"hide":"show")){if("show"!==r||!m||void 0===m[n])continue;g=!0}p[n]=m&&m[n]||Se.style(e,n)}if((u=!Se.isEmptyObject(t))||!Se.isEmptyObject(p)){h&&1===e.nodeType&&(i.overflow=[f.overflow,f.overflowX,f.overflowY],l=m&&m.display,null==l&&(l=Ue.get(e,"display")),c=Se.css(e,"display"),"none"===c&&(l?c=l:(w([e],!0),l=e.style.display||l,c=Se.css(e,"display"),w([e]))),("inline"===c||"inline-block"===c&&null!=l)&&"none"===Se.css(e,"float")&&(u||(d.done(function(){f.display=l}),null==l&&(c=f.display,l="none"===c?"":c)),f.display="inline-block")),i.overflow&&(f.overflow="hidden",d.always(function(){f.overflow=i.overflow[0],f.overflowX=i.overflow[1],f.overflowY=i.overflow[2]})),u=!1;for(n in p)u||(m?"hidden"in m&&(g=m.hidden):m=Ue.access(e,"fxshow",{display:l}),o&&(m.hidden=!g),g&&w([e],!0),d.done(function(){g||w([e]),Ue.remove(e,"fxshow");for(n in p)Se.style(e,n,p[n])})),u=Y(g?m[n]:0,n,d),n in m||(m[n]=u.start,g&&(u.end=u.start,u.start=0))}}function Z(e,t){var i,n,r,o,s;for(i in e)if(n=f(i),r=t[n],o=e[i],Array.isArray(o)&&(r=o[1],o=e[i]=o[0]),i!==n&&(e[n]=o,delete e[i]),(s=Se.cssHooks[n])&&"expand"in s){o=s.expand(o),delete e[n];for(i in o)i in e||(e[i]=o[i],t[i]=r)}else t[n]=r}function K(e,t,i){var n,r,o=0,s=K.prefilters.length,a=Se.Deferred().always(function(){delete u.elem}),u=function(){if(r)return!1;for(var t=_t||H(),i=Math.max(0,l.startTime+l.duration-t),n=i/l.duration||0,o=1-n,s=0,u=l.tweens.length;s<u;s++)l.tweens[s].run(o);return a.notifyWith(e,[l,o,i]),o<1&&u?i:(u||a.notifyWith(e,[l,1,0]),a.resolveWith(e,[l]),!1)},l=a.promise({elem:e,props:Se.extend({},t),opts:Se.extend(!0,{specialEasing:{},easing:Se.easing._default},i),originalProperties:t,originalOptions:i,startTime:_t||H(),duration:i.duration,tweens:[],createTween:function(t,i){var n=Se.Tween(e,l.opts,t,i,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(n),n},stop:function(t){var i=0,n=t?l.tweens.length:0;if(r)return this;for(r=!0;i<n;i++)l.tweens[i].run(1);return t?(a.notifyWith(e,[l,1,0]),a.resolveWith(e,[l,t])):a.rejectWith(e,[l,t]),this}}),c=l.props;for(Z(c,l.opts.specialEasing);o<s;o++)if(n=K.prefilters[o].call(l,e,c,l.opts))return xe(n.stop)&&(Se._queueHooks(l.elem,l.opts.queue).stop=n.stop.bind(n)),n;return Se.map(c,Y,l),xe(l.opts.start)&&l.opts.start.call(e,l),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always),Se.fx.timer(Se.extend(u,{elem:e,anim:l,queue:l.opts.queue})),l}function Q(e){return(e.match(Ie)||[]).join(" ")}function J(e){return e.getAttribute&&e.getAttribute("class")||""}function ee(e){return Array.isArray(e)?e:"string"==typeof e?e.match(Ie)||[]:[]}function te(e,t,i,r){var o;if(Array.isArray(t))Se.each(t,function(t,n){i||Mt.test(e)?r(e,n):te(e+"["+("object"==typeof n&&null!=n?t:"")+"]",n,i,r)});else if(i||"object"!==n(t))r(e,t);else for(o in t)te(e+"["+o+"]",t[o],i,r)}function ie(e){return function(t,i){"string"!=typeof t&&(i=t,t="*");var n,r=0,o=t.toLowerCase().match(Ie)||[];if(xe(i))for(;n=o[r++];)"+"===n[0]?(n=n.slice(1)||"*",(e[n]=e[n]||[]).unshift(i)):(e[n]=e[n]||[]).push(i)}}function ne(e,t,i,n){function r(a){var u;return o[a]=!0,Se.each(e[a]||[],function(e,a){var l=a(t,i,n);return"string"!=typeof l||s||o[l]?s?!(u=l):void 0:(t.dataTypes.unshift(l),r(l),!1)}),u}var o={},s=e===Lt;return r(t.dataTypes[0])||!o["*"]&&r("*")}function re(e,t){var i,n,r=Se.ajaxSettings.flatOptions||{};for(i in t)void 0!==t[i]&&((r[i]?e:n||(n={}))[i]=t[i]);return n&&Se.extend(!0,e,n),e}function oe(e,t,i){for(var n,r,o,s,a=e.contents,u=e.dataTypes;"*"===u[0];)u.shift(),void 0===n&&(n=e.mimeType||t.getResponseHeader("Content-Type"));if(n)for(r in a)if(a[r]&&a[r].test(n)){u.unshift(r);break}if(u[0]in i)o=u[0];else{for(r in i){if(!u[0]||e.converters[r+" "+u[0]]){o=r;break}s||(s=r)}o=o||s}if(o)return o!==u[0]&&u.unshift(o),i[o]}function se(e,t,i,n){var r,o,s,a,u,l={},c=e.dataTypes.slice();if(c[1])for(s in e.converters)l[s.toLowerCase()]=e.converters[s];for(o=c.shift();o;)if(e.responseFields[o]&&(i[e.responseFields[o]]=t),!u&&n&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u=o,o=c.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(!(s=l[u+" "+o]||l["* "+o]))for(r in l)if(a=r.split(" "),a[1]===o&&(s=l[u+" "+a[0]]||l["* "+a[0]])){s===!0?s=l[r]:l[r]!==!0&&(o=a[0],c.unshift(a[1]));break}if(s!==!0)if(s&&e.throws)t=s(t);else try{t=s(t)}catch(e){return{state:"parsererror",error:s?e:"No conversion from "+u+" to "+o}}}return{state:"success",data:t}}var ae=[],ue=Object.getPrototypeOf,le=ae.slice,ce=ae.flat?function(e){return ae.flat.call(e)}:function(e){return ae.concat.apply([],e)},he=ae.push,de=ae.indexOf,pe={},fe=pe.toString,ge=pe.hasOwnProperty,me=ge.toString,ye=me.call(Object),_e={},xe=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType&&"function"!=typeof e.item},we=function(e){return null!=e&&e===e.window},be=e.document,ve={type:!0,src:!0,nonce:!0,noModule:!0},Se=function(e,t){return new Se.fn.init(e,t)};Se.fn=Se.prototype={jquery:"3.6.0",constructor:Se,
length:0,toArray:function(){return le.call(this)},get:function(e){return null==e?le.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=Se.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return Se.each(this,e)},map:function(e){return this.pushStack(Se.map(this,function(t,i){return e.call(t,i,t)}))},slice:function(){return this.pushStack(le.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(Se.grep(this,function(e,t){return(t+1)%2}))},odd:function(){return this.pushStack(Se.grep(this,function(e,t){return t%2}))},eq:function(e){var t=this.length,i=+e+(e<0?t:0);return this.pushStack(i>=0&&i<t?[this[i]]:[])},end:function(){return this.prevObject||this.constructor()},push:he,sort:ae.sort,splice:ae.splice},Se.extend=Se.fn.extend=function(){var e,t,i,n,r,o,s=arguments[0]||{},a=1,u=arguments.length,l=!1;for("boolean"==typeof s&&(l=s,s=arguments[a]||{},a++),"object"==typeof s||xe(s)||(s={}),a===u&&(s=this,a--);a<u;a++)if(null!=(e=arguments[a]))for(t in e)n=e[t],"__proto__"!==t&&s!==n&&(l&&n&&(Se.isPlainObject(n)||(r=Array.isArray(n)))?(i=s[t],o=r&&!Array.isArray(i)?[]:r||Se.isPlainObject(i)?i:{},r=!1,s[t]=Se.extend(l,o,n)):void 0!==n&&(s[t]=n));return s},Se.extend({expando:"jQuery"+("3.6.0"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,i;return!(!e||"[object Object]"!==fe.call(e))&&(!(t=ue(e))||"function"==typeof(i=ge.call(t,"constructor")&&t.constructor)&&me.call(i)===ye)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e,t,n){i(e,{nonce:t&&t.nonce},n)},each:function(e,t){var i,n=0;if(r(e))for(i=e.length;n<i&&t.call(e[n],n,e[n])!==!1;n++);else for(n in e)if(t.call(e[n],n,e[n])===!1)break;return e},makeArray:function(e,t){var i=t||[];return null!=e&&(r(Object(e))?Se.merge(i,"string"==typeof e?[e]:e):he.call(i,e)),i},inArray:function(e,t,i){return null==t?-1:de.call(t,e,i)},merge:function(e,t){for(var i=+t.length,n=0,r=e.length;n<i;n++)e[r++]=t[n];return e.length=r,e},grep:function(e,t,i){for(var n=[],r=0,o=e.length,s=!i;r<o;r++)!t(e[r],r)!==s&&n.push(e[r]);return n},map:function(e,t,i){var n,o,s=0,a=[];if(r(e))for(n=e.length;s<n;s++)null!=(o=t(e[s],s,i))&&a.push(o);else for(s in e)null!=(o=t(e[s],s,i))&&a.push(o);return ce(a)},guid:1,support:_e}),"function"==typeof Symbol&&(Se.fn[Symbol.iterator]=ae[Symbol.iterator]),Se.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){pe["[object "+t+"]"]=t.toLowerCase()});var Te=function(e){function t(e,t,i,n){var r,o,s,a,u,c,d,p=t&&t.ownerDocument,f=t?t.nodeType:9;if(i=i||[],"string"!=typeof e||!e||1!==f&&9!==f&&11!==f)return i;if(!n&&(D(t),t=t||M,I)){if(11!==f&&(u=ye.exec(e)))if(r=u[1]){if(9===f){if(!(s=t.getElementById(r)))return i;if(s.id===r)return i.push(s),i}else if(p&&(s=p.getElementById(r))&&R(t,s)&&s.id===r)return i.push(s),i}else{if(u[2])return K.apply(i,t.getElementsByTagName(e)),i;if((r=u[3])&&w.getElementsByClassName&&t.getElementsByClassName)return K.apply(i,t.getElementsByClassName(r)),i}if(w.qsa&&!q[e+" "]&&(!B||!B.test(e))&&(1!==f||"object"!==t.nodeName.toLowerCase())){if(d=e,p=t,1===f&&(le.test(e)||ue.test(e))){for(p=_e.test(e)&&l(t.parentNode)||t,p===t&&w.scope||((a=t.getAttribute("id"))?a=a.replace(be,ve):t.setAttribute("id",a=L)),c=T(e),o=c.length;o--;)c[o]=(a?"#"+a:":scope")+" "+h(c[o]);d=c.join(",")}try{return K.apply(i,p.querySelectorAll(d)),i}catch(t){q(e,!0)}finally{a===L&&t.removeAttribute("id")}}}return F(e.replace(se,"$1"),t,i,n)}function i(){function e(i,n){return t.push(i+" ")>b.cacheLength&&delete e[t.shift()],e[i+" "]=n}var t=[];return e}function n(e){return e[L]=!0,e}function r(e){var t=M.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function o(e,t){for(var i=e.split("|"),n=i.length;n--;)b.attrHandle[i[n]]=t}function s(e,t){var i=t&&e,n=i&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(n)return n;if(i)for(;i=i.nextSibling;)if(i===t)return-1;return e?1:-1}function a(e){return function(t){return"form"in t?t.parentNode&&t.disabled===!1?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&Te(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function u(e){return n(function(t){return t=+t,n(function(i,n){for(var r,o=e([],i.length,t),s=o.length;s--;)i[r=o[s]]&&(i[r]=!(n[r]=i[r]))})})}function l(e){return e&&void 0!==e.getElementsByTagName&&e}function c(){}function h(e){for(var t=0,i=e.length,n="";t<i;t++)n+=e[t].value;return n}function d(e,t,i){var n=t.dir,r=t.next,o=r||n,s=i&&"parentNode"===o,a=X++;return t.first?function(t,i,r){for(;t=t[n];)if(1===t.nodeType||s)return e(t,i,r);return!1}:function(t,i,u){var l,c,h,d=[U,a];if(u){for(;t=t[n];)if((1===t.nodeType||s)&&e(t,i,u))return!0}else for(;t=t[n];)if(1===t.nodeType||s)if(h=t[L]||(t[L]={}),c=h[t.uniqueID]||(h[t.uniqueID]={}),r&&r===t.nodeName.toLowerCase())t=t[n]||t;else{if((l=c[o])&&l[0]===U&&l[1]===a)return d[2]=l[2];if(c[o]=d,d[2]=e(t,i,u))return!0}return!1}}function p(e){return e.length>1?function(t,i,n){for(var r=e.length;r--;)if(!e[r](t,i,n))return!1;return!0}:e[0]}function f(e,i,n){for(var r=0,o=i.length;r<o;r++)t(e,i[r],n);return n}function g(e,t,i,n,r){for(var o,s=[],a=0,u=e.length,l=null!=t;a<u;a++)(o=e[a])&&(i&&!i(o,n,r)||(s.push(o),l&&t.push(a)));return s}function m(e,t,i,r,o,s){return r&&!r[L]&&(r=m(r)),o&&!o[L]&&(o=m(o,s)),n(function(n,s,a,u){var l,c,h,d=[],p=[],m=s.length,y=n||f(t||"*",a.nodeType?[a]:a,[]),_=!e||!n&&t?y:g(y,d,e,a,u),x=i?o||(n?e:m||r)?[]:s:_;if(i&&i(_,x,a,u),r)for(l=g(x,p),r(l,[],a,u),c=l.length;c--;)(h=l[c])&&(x[p[c]]=!(_[p[c]]=h));if(n){if(o||e){if(o){for(l=[],c=x.length;c--;)(h=x[c])&&l.push(_[c]=h);o(null,x=[],l,u)}for(c=x.length;c--;)(h=x[c])&&(l=o?J(n,h):d[c])>-1&&(n[l]=!(s[l]=h))}}else x=g(x===s?x.splice(m,x.length):x),o?o(null,s,x,u):K.apply(s,x)})}function y(e){for(var t,i,n,r=e.length,o=b.relative[e[0].type],s=o||b.relative[" "],a=o?1:0,u=d(function(e){return e===t},s,!0),l=d(function(e){return J(t,e)>-1},s,!0),c=[function(e,i,n){var r=!o&&(n||i!==O)||((t=i).nodeType?u(e,i,n):l(e,i,n));return t=null,r}];a<r;a++)if(i=b.relative[e[a].type])c=[d(p(c),i)];else{if(i=b.filter[e[a].type].apply(null,e[a].matches),i[L]){for(n=++a;n<r&&!b.relative[e[n].type];n++);return m(a>1&&p(c),a>1&&h(e.slice(0,a-1).concat({value:" "===e[a-2].type?"*":""})).replace(se,"$1"),i,a<n&&y(e.slice(a,n)),n<r&&y(e=e.slice(n)),n<r&&h(e))}c.push(i)}return p(c)}function _(e,i){var r=i.length>0,o=e.length>0,s=function(n,s,a,u,l){var c,h,d,p=0,f="0",m=n&&[],y=[],_=O,x=n||o&&b.find.TAG("*",l),w=U+=null==_?1:Math.random()||.1,v=x.length;for(l&&(O=s==M||s||l);f!==v&&null!=(c=x[f]);f++){if(o&&c){for(h=0,s||c.ownerDocument==M||(D(c),a=!I);d=e[h++];)if(d(c,s||M,a)){u.push(c);break}l&&(U=w)}r&&((c=!d&&c)&&p--,n&&m.push(c))}if(p+=f,r&&f!==p){for(h=0;d=i[h++];)d(m,y,s,a);if(n){if(p>0)for(;f--;)m[f]||y[f]||(y[f]=$.call(u));y=g(y)}K.apply(u,y),l&&!n&&y.length>0&&p+i.length>1&&t.uniqueSort(u)}return l&&(U=w,O=_),m};return r?n(s):s}var x,w,b,v,S,T,C,F,O,N,E,D,M,V,I,B,A,P,R,L="sizzle"+1*new Date,k=e.document,U=0,X=0,z=i(),j=i(),G=i(),q=i(),H=function(e,t){return e===t&&(E=!0),0},W={}.hasOwnProperty,Y=[],$=Y.pop,Z=Y.push,K=Y.push,Q=Y.slice,J=function(e,t){for(var i=0,n=e.length;i<n;i++)if(e[i]===t)return i;return-1},ee="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",te="[\\x20\\t\\r\\n\\f]",ie="(?:\\\\[\\da-fA-F]{1,6}"+te+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",ne="\\["+te+"*("+ie+")(?:"+te+"*([*^$|!~]?=)"+te+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+ie+"))|)"+te+"*\\]",re=":("+ie+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+ne+")*)|.*)\\)|)",oe=new RegExp(te+"+","g"),se=new RegExp("^"+te+"+|((?:^|[^\\\\])(?:\\\\.)*)"+te+"+$","g"),ae=new RegExp("^"+te+"*,"+te+"*"),ue=new RegExp("^"+te+"*([>+~]|"+te+")"+te+"*"),le=new RegExp(te+"|>"),ce=new RegExp(re),he=new RegExp("^"+ie+"$"),de={ID:new RegExp("^#("+ie+")"),CLASS:new RegExp("^\\.("+ie+")"),TAG:new RegExp("^("+ie+"|[*])"),ATTR:new RegExp("^"+ne),PSEUDO:new RegExp("^"+re),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+te+"*(even|odd|(([+-]|)(\\d*)n|)"+te+"*(?:([+-]|)"+te+"*(\\d+)|))"+te+"*\\)|)","i"),bool:new RegExp("^(?:"+ee+")$","i"),needsContext:new RegExp("^"+te+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+te+"*((?:-\\d)?\\d*)"+te+"*\\)|)(?=[^-]|$)","i")},pe=/HTML$/i,fe=/^(?:input|select|textarea|button)$/i,ge=/^h\d$/i,me=/^[^{]+\{\s*\[native \w/,ye=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,_e=/[+~]/,xe=new RegExp("\\\\[\\da-fA-F]{1,6}"+te+"?|\\\\([^\\r\\n\\f])","g"),we=function(e,t){var i="0x"+e.slice(1)-65536;return t?t:i<0?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)},be=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ve=function(e,t){return t?"\0"===e?"�":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},Se=function(){D()},Te=d(function(e){return e.disabled===!0&&"fieldset"===e.nodeName.toLowerCase()},{dir:"parentNode",next:"legend"});try{K.apply(Y=Q.call(k.childNodes),k.childNodes),Y[k.childNodes.length].nodeType}catch(e){K={apply:Y.length?function(e,t){Z.apply(e,Q.call(t))}:function(e,t){for(var i=e.length,n=0;e[i++]=t[n++];);e.length=i-1}}}w=t.support={},S=t.isXML=function(e){var t=e&&e.namespaceURI,i=e&&(e.ownerDocument||e).documentElement;return!pe.test(t||i&&i.nodeName||"HTML")},D=t.setDocument=function(e){var t,i,n=e?e.ownerDocument||e:k;return n!=M&&9===n.nodeType&&n.documentElement?(M=n,V=M.documentElement,I=!S(M),k!=M&&(i=M.defaultView)&&i.top!==i&&(i.addEventListener?i.addEventListener("unload",Se,!1):i.attachEvent&&i.attachEvent("onunload",Se)),w.scope=r(function(e){return V.appendChild(e).appendChild(M.createElement("div")),void 0!==e.querySelectorAll&&!e.querySelectorAll(":scope fieldset div").length}),w.attributes=r(function(e){return e.className="i",!e.getAttribute("className")}),w.getElementsByTagName=r(function(e){return e.appendChild(M.createComment("")),!e.getElementsByTagName("*").length}),w.getElementsByClassName=me.test(M.getElementsByClassName),w.getById=r(function(e){return V.appendChild(e).id=L,!M.getElementsByName||!M.getElementsByName(L).length}),w.getById?(b.filter.ID=function(e){var t=e.replace(xe,we);return function(e){return e.getAttribute("id")===t}},b.find.ID=function(e,t){if(void 0!==t.getElementById&&I){var i=t.getElementById(e);return i?[i]:[]}}):(b.filter.ID=function(e){var t=e.replace(xe,we);return function(e){var i=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return i&&i.value===t}},b.find.ID=function(e,t){if(void 0!==t.getElementById&&I){var i,n,r,o=t.getElementById(e);if(o){if((i=o.getAttributeNode("id"))&&i.value===e)return[o];for(r=t.getElementsByName(e),n=0;o=r[n++];)if((i=o.getAttributeNode("id"))&&i.value===e)return[o]}return[]}}),b.find.TAG=w.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):w.qsa?t.querySelectorAll(e):void 0}:function(e,t){var i,n=[],r=0,o=t.getElementsByTagName(e);if("*"===e){for(;i=o[r++];)1===i.nodeType&&n.push(i);return n}return o},b.find.CLASS=w.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&I)return t.getElementsByClassName(e)},A=[],B=[],(w.qsa=me.test(M.querySelectorAll))&&(r(function(e){var t;V.appendChild(e).innerHTML="<a id='"+L+"'></a><select id='"+L+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&B.push("[*^$]="+te+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||B.push("\\["+te+"*(?:value|"+ee+")"),e.querySelectorAll("[id~="+L+"-]").length||B.push("~="),t=M.createElement("input"),t.setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||B.push("\\["+te+"*name"+te+"*="+te+"*(?:''|\"\")"),e.querySelectorAll(":checked").length||B.push(":checked"),e.querySelectorAll("a#"+L+"+*").length||B.push(".#.+[+~]"),e.querySelectorAll("\\\f"),B.push("[\\r\\n\\f]")}),r(function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=M.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&B.push("name"+te+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&B.push(":enabled",":disabled"),V.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&B.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),B.push(",.*:")})),(w.matchesSelector=me.test(P=V.matches||V.webkitMatchesSelector||V.mozMatchesSelector||V.oMatchesSelector||V.msMatchesSelector))&&r(function(e){w.disconnectedMatch=P.call(e,"*"),P.call(e,"[s!='']:x"),A.push("!=",re)}),B=B.length&&new RegExp(B.join("|")),A=A.length&&new RegExp(A.join("|")),t=me.test(V.compareDocumentPosition),R=t||me.test(V.contains)?function(e,t){var i=9===e.nodeType?e.documentElement:e,n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},H=t?function(e,t){if(e===t)return E=!0,0;var i=!e.compareDocumentPosition-!t.compareDocumentPosition;return i?i:(i=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1,1&i||!w.sortDetached&&t.compareDocumentPosition(e)===i?e==M||e.ownerDocument==k&&R(k,e)?-1:t==M||t.ownerDocument==k&&R(k,t)?1:N?J(N,e)-J(N,t):0:4&i?-1:1)}:function(e,t){if(e===t)return E=!0,0;var i,n=0,r=e.parentNode,o=t.parentNode,a=[e],u=[t];if(!r||!o)return e==M?-1:t==M?1:r?-1:o?1:N?J(N,e)-J(N,t):0;if(r===o)return s(e,t);for(i=e;i=i.parentNode;)a.unshift(i);for(i=t;i=i.parentNode;)u.unshift(i);for(;a[n]===u[n];)n++;return n?s(a[n],u[n]):a[n]==k?-1:u[n]==k?1:0},M):M},t.matches=function(e,i){return t(e,null,null,i)},t.matchesSelector=function(e,i){if(D(e),w.matchesSelector&&I&&!q[i+" "]&&(!A||!A.test(i))&&(!B||!B.test(i)))try{var n=P.call(e,i);if(n||w.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){q(i,!0)}return t(i,M,null,[e]).length>0},t.contains=function(e,t){return(e.ownerDocument||e)!=M&&D(e),R(e,t)},t.attr=function(e,t){(e.ownerDocument||e)!=M&&D(e);var i=b.attrHandle[t.toLowerCase()],n=i&&W.call(b.attrHandle,t.toLowerCase())?i(e,t,!I):void 0;return void 0!==n?n:w.attributes||!I?e.getAttribute(t):(n=e.getAttributeNode(t))&&n.specified?n.value:null},t.escape=function(e){return(e+"").replace(be,ve)},t.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},t.uniqueSort=function(e){var t,i=[],n=0,r=0;if(E=!w.detectDuplicates,N=!w.sortStable&&e.slice(0),e.sort(H),E){for(;t=e[r++];)t===e[r]&&(n=i.push(r));for(;n--;)e.splice(i[n],1)}return N=null,e},v=t.getText=function(e){var t,i="",n=0,r=e.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)i+=v(e)}else if(3===r||4===r)return e.nodeValue}else for(;t=e[n++];)i+=v(t);return i},b=t.selectors={cacheLength:50,createPseudo:n,match:de,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(xe,we),e[3]=(e[3]||e[4]||e[5]||"").replace(xe,we),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||t.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&t.error(e[0]),e},PSEUDO:function(e){var t,i=!e[6]&&e[2];return de.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":i&&ce.test(i)&&(t=T(i,!0))&&(t=i.indexOf(")",i.length-t)-i.length)&&(e[0]=e[0].slice(0,t),e[2]=i.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(xe,we).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=z[e+" "];return t||(t=new RegExp("(^|"+te+")"+e+"("+te+"|$)"))&&z(e,function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,i,n){return function(r){var o=t.attr(r,e);return null==o?"!="===i:!i||(o+="","="===i?o===n:"!="===i?o!==n:"^="===i?n&&0===o.indexOf(n):"*="===i?n&&o.indexOf(n)>-1:"$="===i?n&&o.slice(-n.length)===n:"~="===i?(" "+o.replace(oe," ")+" ").indexOf(n)>-1:"|="===i&&(o===n||o.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,i,n,r){var o="nth"!==e.slice(0,3),s="last"!==e.slice(-4),a="of-type"===t;return 1===n&&0===r?function(e){return!!e.parentNode}:function(t,i,u){var l,c,h,d,p,f,g=o!==s?"nextSibling":"previousSibling",m=t.parentNode,y=a&&t.nodeName.toLowerCase(),_=!u&&!a,x=!1;if(m){if(o){for(;g;){for(d=t;d=d[g];)if(a?d.nodeName.toLowerCase()===y:1===d.nodeType)return!1;f=g="only"===e&&!f&&"nextSibling"}return!0}if(f=[s?m.firstChild:m.lastChild],s&&_){for(d=m,h=d[L]||(d[L]={}),c=h[d.uniqueID]||(h[d.uniqueID]={}),l=c[e]||[],p=l[0]===U&&l[1],x=p&&l[2],d=p&&m.childNodes[p];d=++p&&d&&d[g]||(x=p=0)||f.pop();)if(1===d.nodeType&&++x&&d===t){c[e]=[U,p,x];break}}else if(_&&(d=t,h=d[L]||(d[L]={}),c=h[d.uniqueID]||(h[d.uniqueID]={}),l=c[e]||[],p=l[0]===U&&l[1],x=p),x===!1)for(;(d=++p&&d&&d[g]||(x=p=0)||f.pop())&&((a?d.nodeName.toLowerCase()!==y:1!==d.nodeType)||!++x||(_&&(h=d[L]||(d[L]={}),c=h[d.uniqueID]||(h[d.uniqueID]={}),c[e]=[U,x]),d!==t)););return(x-=r)===n||x%n==0&&x/n>=0}}},PSEUDO:function(e,i){var r,o=b.pseudos[e]||b.setFilters[e.toLowerCase()]||t.error("unsupported pseudo: "+e);return o[L]?o(i):o.length>1?(r=[e,e,"",i],b.setFilters.hasOwnProperty(e.toLowerCase())?n(function(e,t){for(var n,r=o(e,i),s=r.length;s--;)n=J(e,r[s]),e[n]=!(t[n]=r[s])}):function(e){return o(e,0,r)}):o}},pseudos:{not:n(function(e){var t=[],i=[],r=C(e.replace(se,"$1"));return r[L]?n(function(e,t,i,n){for(var o,s=r(e,null,n,[]),a=e.length;a--;)(o=s[a])&&(e[a]=!(t[a]=o))}):function(e,n,o){return t[0]=e,r(t,null,o,i),t[0]=null,!i.pop()}}),has:n(function(e){return function(i){return t(e,i).length>0}}),contains:n(function(e){return e=e.replace(xe,we),function(t){return(t.textContent||v(t)).indexOf(e)>-1}}),lang:n(function(e){return he.test(e||"")||t.error("unsupported lang: "+e),e=e.replace(xe,we).toLowerCase(),function(t){var i;do if(i=I?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(i=i.toLowerCase())===e||0===i.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType)return!1}}),target:function(t){var i=e.location&&e.location.hash;return i&&i.slice(1)===t.id},root:function(e){return e===V},focus:function(e){return e===M.activeElement&&(!M.hasFocus||M.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:a(!1),disabled:a(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!b.pseudos.empty(e)},header:function(e){return ge.test(e.nodeName)},input:function(e){return fe.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:u(function(){return[0]}),last:u(function(e,t){return[t-1]}),eq:u(function(e,t,i){return[i<0?i+t:i]}),even:u(function(e,t){for(var i=0;i<t;i+=2)e.push(i);return e}),odd:u(function(e,t){for(var i=1;i<t;i+=2)e.push(i);return e}),lt:u(function(e,t,i){for(var n=i<0?i+t:i>t?t:i;--n>=0;)e.push(n);return e}),gt:u(function(e,t,i){for(var n=i<0?i+t:i;++n<t;)e.push(n);return e})}},b.pseudos.nth=b.pseudos.eq;for(x in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})b.pseudos[x]=function(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}(x);for(x in{submit:!0,reset:!0})b.pseudos[x]=function(e){return function(t){var i=t.nodeName.toLowerCase();return("input"===i||"button"===i)&&t.type===e}}(x);return c.prototype=b.filters=b.pseudos,b.setFilters=new c,T=t.tokenize=function(e,i){var n,r,o,s,a,u,l,c=j[e+" "];if(c)return i?0:c.slice(0);for(a=e,u=[],l=b.preFilter;a;){n&&!(r=ae.exec(a))||(r&&(a=a.slice(r[0].length)||a),u.push(o=[])),n=!1,(r=ue.exec(a))&&(n=r.shift(),o.push({value:n,type:r[0].replace(se," ")}),a=a.slice(n.length));for(s in b.filter)!(r=de[s].exec(a))||l[s]&&!(r=l[s](r))||(n=r.shift(),o.push({value:n,type:s,matches:r}),a=a.slice(n.length));if(!n)break}return i?a.length:a?t.error(e):j(e,u).slice(0)},C=t.compile=function(e,t){var i,n=[],r=[],o=G[e+" "];if(!o){for(t||(t=T(e)),i=t.length;i--;)o=y(t[i]),o[L]?n.push(o):r.push(o);o=G(e,_(r,n)),o.selector=e}return o},F=t.select=function(e,t,i,n){var r,o,s,a,u,c="function"==typeof e&&e,d=!n&&T(e=c.selector||e);if(i=i||[],1===d.length){if(o=d[0]=d[0].slice(0),o.length>2&&"ID"===(s=o[0]).type&&9===t.nodeType&&I&&b.relative[o[1].type]){if(!(t=(b.find.ID(s.matches[0].replace(xe,we),t)||[])[0]))return i;c&&(t=t.parentNode),e=e.slice(o.shift().value.length)}for(r=de.needsContext.test(e)?0:o.length;r--&&(s=o[r],!b.relative[a=s.type]);)if((u=b.find[a])&&(n=u(s.matches[0].replace(xe,we),_e.test(o[0].type)&&l(t.parentNode)||t))){if(o.splice(r,1),!(e=n.length&&h(o)))return K.apply(i,n),i;break}}return(c||C(e,d))(n,t,!I,i,!t||_e.test(e)&&l(t.parentNode)||t),i},w.sortStable=L.split("").sort(H).join("")===L,w.detectDuplicates=!!E,D(),w.sortDetached=r(function(e){return 1&e.compareDocumentPosition(M.createElement("fieldset"))}),r(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||o("type|href|height|width",function(e,t,i){if(!i)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),w.attributes&&r(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||o("value",function(e,t,i){if(!i&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),r(function(e){return null==e.getAttribute("disabled")})||o(ee,function(e,t,i){var n;if(!i)return e[t]===!0?t.toLowerCase():(n=e.getAttributeNode(t))&&n.specified?n.value:null}),t}(e);Se.find=Te,Se.expr=Te.selectors,Se.expr[":"]=Se.expr.pseudos,Se.uniqueSort=Se.unique=Te.uniqueSort,Se.text=Te.getText,Se.isXMLDoc=Te.isXML,Se.contains=Te.contains,Se.escapeSelector=Te.escape;var Ce=function(e,t,i){for(var n=[],r=void 0!==i;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(r&&Se(e).is(i))break;n.push(e)}return n},Fe=function(e,t){for(var i=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&i.push(e);return i},Oe=Se.expr.match.needsContext,Ne=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;Se.filter=function(e,t,i){var n=t[0];return i&&(e=":not("+e+")"),1===t.length&&1===n.nodeType?Se.find.matchesSelector(n,e)?[n]:[]:Se.find.matches(e,Se.grep(t,function(e){return 1===e.nodeType}))},Se.fn.extend({find:function(e){var t,i,n=this.length,r=this;if("string"!=typeof e)return this.pushStack(Se(e).filter(function(){for(t=0;t<n;t++)if(Se.contains(r[t],this))return!0}));for(i=this.pushStack([]),t=0;t<n;t++)Se.find(e,r[t],i);return n>1?Se.uniqueSort(i):i},filter:function(e){return this.pushStack(s(this,e||[],!1))},not:function(e){return this.pushStack(s(this,e||[],!0))},is:function(e){return!!s(this,"string"==typeof e&&Oe.test(e)?Se(e):e||[],!1).length}});var Ee,De=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(Se.fn.init=function(e,t,i){var n,r;if(!e)return this;if(i=i||Ee,"string"==typeof e){if(!(n="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:De.exec(e))||!n[1]&&t)return!t||t.jquery?(t||i).find(e):this.constructor(t).find(e);if(n[1]){if(t=t instanceof Se?t[0]:t,Se.merge(this,Se.parseHTML(n[1],t&&t.nodeType?t.ownerDocument||t:be,!0)),Ne.test(n[1])&&Se.isPlainObject(t))for(n in t)xe(this[n])?this[n](t[n]):this.attr(n,t[n]);return this}return r=be.getElementById(n[2]),r&&(this[0]=r,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):xe(e)?void 0!==i.ready?i.ready(e):e(Se):Se.makeArray(e,this)}).prototype=Se.fn,Ee=Se(be);var Me=/^(?:parents|prev(?:Until|All))/,Ve={children:!0,contents:!0,next:!0,prev:!0};Se.fn.extend({has:function(e){var t=Se(e,this),i=t.length;return this.filter(function(){for(var e=0;e<i;e++)if(Se.contains(this,t[e]))return!0})},closest:function(e,t){var i,n=0,r=this.length,o=[],s="string"!=typeof e&&Se(e);if(!Oe.test(e))for(;n<r;n++)for(i=this[n];i&&i!==t;i=i.parentNode)if(i.nodeType<11&&(s?s.index(i)>-1:1===i.nodeType&&Se.find.matchesSelector(i,e))){o.push(i);break}return this.pushStack(o.length>1?Se.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?de.call(Se(e),this[0]):de.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(Se.uniqueSort(Se.merge(this.get(),Se(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),Se.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return Ce(e,"parentNode")},parentsUntil:function(e,t,i){return Ce(e,"parentNode",i)},next:function(e){return a(e,"nextSibling")},prev:function(e){return a(e,"previousSibling")},nextAll:function(e){return Ce(e,"nextSibling")},prevAll:function(e){return Ce(e,"previousSibling")},nextUntil:function(e,t,i){return Ce(e,"nextSibling",i)},prevUntil:function(e,t,i){return Ce(e,"previousSibling",i)},siblings:function(e){return Fe((e.parentNode||{}).firstChild,e)},children:function(e){return Fe(e.firstChild)},contents:function(e){return null!=e.contentDocument&&ue(e.contentDocument)?e.contentDocument:(o(e,"template")&&(e=e.content||e),Se.merge([],e.childNodes))}},function(e,t){Se.fn[e]=function(i,n){var r=Se.map(this,t,i);return"Until"!==e.slice(-5)&&(n=i),n&&"string"==typeof n&&(r=Se.filter(n,r)),this.length>1&&(Ve[e]||Se.uniqueSort(r),Me.test(e)&&r.reverse()),this.pushStack(r)}});var Ie=/[^\x20\t\r\n\f]+/g;Se.Callbacks=function(e){e="string"==typeof e?u(e):Se.extend({},e);var t,i,r,o,s=[],a=[],l=-1,c=function(){for(o=o||e.once,r=t=!0;a.length;l=-1)for(i=a.shift();++l<s.length;)s[l].apply(i[0],i[1])===!1&&e.stopOnFalse&&(l=s.length,i=!1);e.memory||(i=!1),t=!1,o&&(s=i?[]:"")},h={add:function(){return s&&(i&&!t&&(l=s.length-1,a.push(i)),function t(i){Se.each(i,function(i,r){xe(r)?e.unique&&h.has(r)||s.push(r):r&&r.length&&"string"!==n(r)&&t(r)})}(arguments),i&&!t&&c()),this},remove:function(){return Se.each(arguments,function(e,t){for(var i;(i=Se.inArray(t,s,i))>-1;)s.splice(i,1),i<=l&&l--}),this},has:function(e){return e?Se.inArray(e,s)>-1:s.length>0},empty:function(){return s&&(s=[]),this},disable:function(){return o=a=[],s=i="",this},disabled:function(){return!s},lock:function(){return o=a=[],i||t||(s=i=""),this},locked:function(){return!!o},fireWith:function(e,i){return o||(i=i||[],i=[e,i.slice?i.slice():i],a.push(i),t||c()),this},fire:function(){return h.fireWith(this,arguments),this},fired:function(){return!!r}};return h},Se.extend({Deferred:function(t){var i=[["notify","progress",Se.Callbacks("memory"),Se.Callbacks("memory"),2],["resolve","done",Se.Callbacks("once memory"),Se.Callbacks("once memory"),0,"resolved"],["reject","fail",Se.Callbacks("once memory"),Se.Callbacks("once memory"),1,"rejected"]],n="pending",r={state:function(){return n},always:function(){return o.done(arguments).fail(arguments),this},catch:function(e){return r.then(null,e)},pipe:function(){var e=arguments;return Se.Deferred(function(t){Se.each(i,function(i,n){var r=xe(e[n[4]])&&e[n[4]];o[n[1]](function(){var e=r&&r.apply(this,arguments);e&&xe(e.promise)?e.promise().progress(t.notify).done(t.resolve).fail(t.reject):t[n[0]+"With"](this,r?[e]:arguments)})}),e=null}).promise()},then:function(t,n,r){function o(t,i,n,r){return function(){var a=this,u=arguments,h=function(){var e,h;if(!(t<s)){if((e=n.apply(a,u))===i.promise())throw new TypeError("Thenable self-resolution");h=e&&("object"==typeof e||"function"==typeof e)&&e.then,xe(h)?r?h.call(e,o(s,i,l,r),o(s,i,c,r)):(s++,h.call(e,o(s,i,l,r),o(s,i,c,r),o(s,i,l,i.notifyWith))):(n!==l&&(a=void 0,u=[e]),(r||i.resolveWith)(a,u))}},d=r?h:function(){try{h()}catch(e){Se.Deferred.exceptionHook&&Se.Deferred.exceptionHook(e,d.stackTrace),t+1>=s&&(n!==c&&(a=void 0,u=[e]),i.rejectWith(a,u))}};t?d():(Se.Deferred.getStackHook&&(d.stackTrace=Se.Deferred.getStackHook()),e.setTimeout(d))}}var s=0;return Se.Deferred(function(e){i[0][3].add(o(0,e,xe(r)?r:l,e.notifyWith)),i[1][3].add(o(0,e,xe(t)?t:l)),i[2][3].add(o(0,e,xe(n)?n:c))}).promise()},promise:function(e){return null!=e?Se.extend(e,r):r}},o={};return Se.each(i,function(e,t){var s=t[2],a=t[5];r[t[1]]=s.add,a&&s.add(function(){n=a},i[3-e][2].disable,i[3-e][3].disable,i[0][2].lock,i[0][3].lock),s.add(t[3].fire),o[t[0]]=function(){return o[t[0]+"With"](this===o?void 0:this,arguments),this},o[t[0]+"With"]=s.fireWith}),r.promise(o),t&&t.call(o,o),o},when:function(e){var t=arguments.length,i=t,n=Array(i),r=le.call(arguments),o=Se.Deferred(),s=function(e){return function(i){n[e]=this,r[e]=arguments.length>1?le.call(arguments):i,--t||o.resolveWith(n,r)}};if(t<=1&&(h(e,o.done(s(i)).resolve,o.reject,!t),"pending"===o.state()||xe(r[i]&&r[i].then)))return o.then();for(;i--;)h(r[i],s(i),o.reject);return o.promise()}});var Be=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;Se.Deferred.exceptionHook=function(t,i){e.console&&e.console.warn&&t&&Be.test(t.name)&&e.console.warn("jQuery.Deferred exception: "+t.message,t.stack,i)},Se.readyException=function(t){e.setTimeout(function(){throw t})};var Ae=Se.Deferred();Se.fn.ready=function(e){return Ae.then(e).catch(function(e){Se.readyException(e)}),this},Se.extend({isReady:!1,readyWait:1,ready:function(e){(e===!0?--Se.readyWait:Se.isReady)||(Se.isReady=!0,e!==!0&&--Se.readyWait>0||Ae.resolveWith(be,[Se]))}}),Se.ready.then=Ae.then,"complete"===be.readyState||"loading"!==be.readyState&&!be.documentElement.doScroll?e.setTimeout(Se.ready):(be.addEventListener("DOMContentLoaded",d),e.addEventListener("load",d));var Pe=function(e,t,i,r,o,s,a){var u=0,l=e.length,c=null==i;if("object"===n(i)){o=!0;for(u in i)Pe(e,t,u,i[u],!0,s,a)}else if(void 0!==r&&(o=!0,xe(r)||(a=!0),c&&(a?(t.call(e,r),t=null):(c=t,t=function(e,t,i){return c.call(Se(e),i)})),t))for(;u<l;u++)t(e[u],i,a?r:r.call(e[u],u,t(e[u],i)));return o?e:c?t.call(e):l?t(e[0],i):s},Re=/^-ms-/,Le=/-([a-z])/g,ke=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};g.uid=1,g.prototype={cache:function(e){var t=e[this.expando];return t||(t={},ke(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,i){var n,r=this.cache(e);if("string"==typeof t)r[f(t)]=i;else for(n in t)r[f(n)]=t[n];return r},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][f(t)]},access:function(e,t,i){return void 0===t||t&&"string"==typeof t&&void 0===i?this.get(e,t):(this.set(e,t,i),void 0!==i?i:t)},remove:function(e,t){var i,n=e[this.expando];if(void 0!==n){if(void 0!==t){Array.isArray(t)?t=t.map(f):(t=f(t),t=t in n?[t]:t.match(Ie)||[]),i=t.length;for(;i--;)delete n[t[i]]}(void 0===t||Se.isEmptyObject(n))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!Se.isEmptyObject(t)}};var Ue=new g,Xe=new g,ze=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,je=/[A-Z]/g;Se.extend({hasData:function(e){return Xe.hasData(e)||Ue.hasData(e)},data:function(e,t,i){return Xe.access(e,t,i)},removeData:function(e,t){Xe.remove(e,t)},_data:function(e,t,i){return Ue.access(e,t,i)},_removeData:function(e,t){Ue.remove(e,t)}}),Se.fn.extend({data:function(e,t){
var i,n,r,o=this[0],s=o&&o.attributes;if(void 0===e){if(this.length&&(r=Xe.get(o),1===o.nodeType&&!Ue.get(o,"hasDataAttrs"))){for(i=s.length;i--;)s[i]&&(n=s[i].name,0===n.indexOf("data-")&&(n=f(n.slice(5)),y(o,n,r[n])));Ue.set(o,"hasDataAttrs",!0)}return r}return"object"==typeof e?this.each(function(){Xe.set(this,e)}):Pe(this,function(t){var i;if(o&&void 0===t){if(void 0!==(i=Xe.get(o,e)))return i;if(void 0!==(i=y(o,e)))return i}else this.each(function(){Xe.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){Xe.remove(this,e)})}}),Se.extend({queue:function(e,t,i){var n;if(e)return t=(t||"fx")+"queue",n=Ue.get(e,t),i&&(!n||Array.isArray(i)?n=Ue.access(e,t,Se.makeArray(i)):n.push(i)),n||[]},dequeue:function(e,t){t=t||"fx";var i=Se.queue(e,t),n=i.length,r=i.shift(),o=Se._queueHooks(e,t),s=function(){Se.dequeue(e,t)};"inprogress"===r&&(r=i.shift(),n--),r&&("fx"===t&&i.unshift("inprogress"),delete o.stop,r.call(e,s,o)),!n&&o&&o.empty.fire()},_queueHooks:function(e,t){var i=t+"queueHooks";return Ue.get(e,i)||Ue.access(e,i,{empty:Se.Callbacks("once memory").add(function(){Ue.remove(e,[t+"queue",i])})})}}),Se.fn.extend({queue:function(e,t){var i=2;return"string"!=typeof e&&(t=e,e="fx",i--),arguments.length<i?Se.queue(this[0],e):void 0===t?this:this.each(function(){var i=Se.queue(this,e,t);Se._queueHooks(this,e),"fx"===e&&"inprogress"!==i[0]&&Se.dequeue(this,e)})},dequeue:function(e){return this.each(function(){Se.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var i,n=1,r=Se.Deferred(),o=this,s=this.length,a=function(){--n||r.resolveWith(o,[o])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";s--;)(i=Ue.get(o[s],e+"queueHooks"))&&i.empty&&(n++,i.empty.add(a));return a(),r.promise(t)}});var Ge=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,qe=new RegExp("^(?:([+-])=|)("+Ge+")([a-z%]*)$","i"),He=["Top","Right","Bottom","Left"],We=be.documentElement,Ye=function(e){return Se.contains(e.ownerDocument,e)},$e={composed:!0};We.getRootNode&&(Ye=function(e){return Se.contains(e.ownerDocument,e)||e.getRootNode($e)===e.ownerDocument});var Ze=function(e,t){return e=t||e,"none"===e.style.display||""===e.style.display&&Ye(e)&&"none"===Se.css(e,"display")},Ke={};Se.fn.extend({show:function(){return w(this,!0)},hide:function(){return w(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){Ze(this)?Se(this).show():Se(this).hide()})}});var Qe=/^(?:checkbox|radio)$/i,Je=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,et=/^$|^module$|\/(?:java|ecma)script/i;!function(){var e=be.createDocumentFragment(),t=e.appendChild(be.createElement("div")),i=be.createElement("input");i.setAttribute("type","radio"),i.setAttribute("checked","checked"),i.setAttribute("name","t"),t.appendChild(i),_e.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,t.innerHTML="<textarea>x</textarea>",_e.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue,t.innerHTML="<option></option>",_e.option=!!t.lastChild}();var tt={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};tt.tbody=tt.tfoot=tt.colgroup=tt.caption=tt.thead,tt.th=tt.td,_e.option||(tt.optgroup=tt.option=[1,"<select multiple='multiple'>","</select>"]);var it=/<|&#?\w+;/,nt=/^([^.]*)(?:\.(.+)|)/;Se.event={global:{},add:function(e,t,i,n,r){var o,s,a,u,l,c,h,d,p,f,g,m=Ue.get(e);if(ke(e))for(i.handler&&(o=i,i=o.handler,r=o.selector),r&&Se.find.matchesSelector(We,r),i.guid||(i.guid=Se.guid++),(u=m.events)||(u=m.events=Object.create(null)),(s=m.handle)||(s=m.handle=function(t){return void 0!==Se&&Se.event.triggered!==t.type?Se.event.dispatch.apply(e,arguments):void 0}),t=(t||"").match(Ie)||[""],l=t.length;l--;)a=nt.exec(t[l])||[],p=g=a[1],f=(a[2]||"").split(".").sort(),p&&(h=Se.event.special[p]||{},p=(r?h.delegateType:h.bindType)||p,h=Se.event.special[p]||{},c=Se.extend({type:p,origType:g,data:n,handler:i,guid:i.guid,selector:r,needsContext:r&&Se.expr.match.needsContext.test(r),namespace:f.join(".")},o),(d=u[p])||(d=u[p]=[],d.delegateCount=0,h.setup&&h.setup.call(e,n,f,s)!==!1||e.addEventListener&&e.addEventListener(p,s)),h.add&&(h.add.call(e,c),c.handler.guid||(c.handler.guid=i.guid)),r?d.splice(d.delegateCount++,0,c):d.push(c),Se.event.global[p]=!0)},remove:function(e,t,i,n,r){var o,s,a,u,l,c,h,d,p,f,g,m=Ue.hasData(e)&&Ue.get(e);if(m&&(u=m.events)){for(t=(t||"").match(Ie)||[""],l=t.length;l--;)if(a=nt.exec(t[l])||[],p=g=a[1],f=(a[2]||"").split(".").sort(),p){for(h=Se.event.special[p]||{},p=(n?h.delegateType:h.bindType)||p,d=u[p]||[],a=a[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=o=d.length;o--;)c=d[o],!r&&g!==c.origType||i&&i.guid!==c.guid||a&&!a.test(c.namespace)||n&&n!==c.selector&&("**"!==n||!c.selector)||(d.splice(o,1),c.selector&&d.delegateCount--,h.remove&&h.remove.call(e,c));s&&!d.length&&(h.teardown&&h.teardown.call(e,f,m.handle)!==!1||Se.removeEvent(e,p,m.handle),delete u[p])}else for(p in u)Se.event.remove(e,p+t[l],i,n,!0);Se.isEmptyObject(u)&&Ue.remove(e,"handle events")}},dispatch:function(e){var t,i,n,r,o,s,a=new Array(arguments.length),u=Se.event.fix(e),l=(Ue.get(this,"events")||Object.create(null))[u.type]||[],c=Se.event.special[u.type]||{};for(a[0]=u,t=1;t<arguments.length;t++)a[t]=arguments[t];if(u.delegateTarget=this,!c.preDispatch||c.preDispatch.call(this,u)!==!1){for(s=Se.event.handlers.call(this,u,l),t=0;(r=s[t++])&&!u.isPropagationStopped();)for(u.currentTarget=r.elem,i=0;(o=r.handlers[i++])&&!u.isImmediatePropagationStopped();)u.rnamespace&&o.namespace!==!1&&!u.rnamespace.test(o.namespace)||(u.handleObj=o,u.data=o.data,void 0!==(n=((Se.event.special[o.origType]||{}).handle||o.handler).apply(r.elem,a))&&(u.result=n)===!1&&(u.preventDefault(),u.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,u),u.result}},handlers:function(e,t){var i,n,r,o,s,a=[],u=t.delegateCount,l=e.target;if(u&&l.nodeType&&!("click"===e.type&&e.button>=1))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==e.type||l.disabled!==!0)){for(o=[],s={},i=0;i<u;i++)n=t[i],r=n.selector+" ",void 0===s[r]&&(s[r]=n.needsContext?Se(r,this).index(l)>-1:Se.find(r,this,null,[l]).length),s[r]&&o.push(n);o.length&&a.push({elem:l,handlers:o})}return l=this,u<t.length&&a.push({elem:l,handlers:t.slice(u)}),a},addProp:function(e,t){Object.defineProperty(Se.Event.prototype,e,{enumerable:!0,configurable:!0,get:xe(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(e){return e[Se.expando]?e:new Se.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){var t=this||e;return Qe.test(t.type)&&t.click&&o(t,"input")&&E(t,"click",T),!1},trigger:function(e){var t=this||e;return Qe.test(t.type)&&t.click&&o(t,"input")&&E(t,"click"),!0},_default:function(e){var t=e.target;return Qe.test(t.type)&&t.click&&o(t,"input")&&Ue.get(t,"click")||o(t,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},Se.removeEvent=function(e,t,i){e.removeEventListener&&e.removeEventListener(t,i)},Se.Event=function(e,t){if(!(this instanceof Se.Event))return new Se.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&e.returnValue===!1?T:C,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&Se.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[Se.expando]=!0},Se.Event.prototype={constructor:Se.Event,isDefaultPrevented:C,isPropagationStopped:C,isImmediatePropagationStopped:C,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=T,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=T,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=T,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},Se.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},Se.event.addProp),Se.each({focus:"focusin",blur:"focusout"},function(e,t){Se.event.special[e]={setup:function(){return E(this,e,F),!1},trigger:function(){return E(this,e),!0},_default:function(){return!0},delegateType:t}}),Se.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){Se.event.special[e]={delegateType:t,bindType:t,handle:function(e){var i,n=this,r=e.relatedTarget,o=e.handleObj;return r&&(r===n||Se.contains(n,r))||(e.type=o.origType,i=o.handler.apply(this,arguments),e.type=t),i}}}),Se.fn.extend({on:function(e,t,i,n){return N(this,e,t,i,n)},one:function(e,t,i,n){return N(this,e,t,i,n,1)},off:function(e,t,i){var n,r;if(e&&e.preventDefault&&e.handleObj)return n=e.handleObj,Se(e.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof e){for(r in e)this.off(r,t,e[r]);return this}return t!==!1&&"function"!=typeof t||(i=t,t=void 0),i===!1&&(i=C),this.each(function(){Se.event.remove(this,e,i,t)})}});var rt=/<script|<style|<link/i,ot=/checked\s*(?:[^=]|=\s*.checked.)/i,st=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;Se.extend({htmlPrefilter:function(e){return e},clone:function(e,t,i){var n,r,o,s,a=e.cloneNode(!0),u=Ye(e);if(!(_e.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||Se.isXMLDoc(e)))for(s=b(a),o=b(e),n=0,r=o.length;n<r;n++)B(o[n],s[n]);if(t)if(i)for(o=o||b(e),s=s||b(a),n=0,r=o.length;n<r;n++)I(o[n],s[n]);else I(e,a);return s=b(a,"script"),s.length>0&&v(s,!u&&b(e,"script")),a},cleanData:function(e){for(var t,i,n,r=Se.event.special,o=0;void 0!==(i=e[o]);o++)if(ke(i)){if(t=i[Ue.expando]){if(t.events)for(n in t.events)r[n]?Se.event.remove(i,n):Se.removeEvent(i,n,t.handle);i[Ue.expando]=void 0}i[Xe.expando]&&(i[Xe.expando]=void 0)}}}),Se.fn.extend({detach:function(e){return P(this,e,!0)},remove:function(e){return P(this,e)},text:function(e){return Pe(this,function(e){return void 0===e?Se.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return A(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){D(this,e).appendChild(e)}})},prepend:function(){return A(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=D(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return A(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return A(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(Se.cleanData(b(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return Se.clone(this,e,t)})},html:function(e){return Pe(this,function(e){var t=this[0]||{},i=0,n=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!rt.test(e)&&!tt[(Je.exec(e)||["",""])[1].toLowerCase()]){e=Se.htmlPrefilter(e);try{for(;i<n;i++)t=this[i]||{},1===t.nodeType&&(Se.cleanData(b(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=[];return A(this,arguments,function(t){var i=this.parentNode;Se.inArray(this,e)<0&&(Se.cleanData(b(this)),i&&i.replaceChild(t,this))},e)}}),Se.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){Se.fn[e]=function(e){for(var i,n=[],r=Se(e),o=r.length-1,s=0;s<=o;s++)i=s===o?this:this.clone(!0),Se(r[s])[t](i),he.apply(n,i.get());return this.pushStack(n)}});var at=new RegExp("^("+Ge+")(?!px)[a-z%]+$","i"),ut=function(t){var i=t.ownerDocument.defaultView;return i&&i.opener||(i=e),i.getComputedStyle(t)},lt=function(e,t,i){var n,r,o={};for(r in t)o[r]=e.style[r],e.style[r]=t[r];n=i.call(e);for(r in t)e.style[r]=o[r];return n},ct=new RegExp(He.join("|"),"i");!function(){function t(){if(c){l.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",c.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",We.appendChild(l).appendChild(c);var t=e.getComputedStyle(c);n="1%"!==t.top,u=12===i(t.marginLeft),c.style.right="60%",s=36===i(t.right),r=36===i(t.width),c.style.position="absolute",o=12===i(c.offsetWidth/3),We.removeChild(l),c=null}}function i(e){return Math.round(parseFloat(e))}var n,r,o,s,a,u,l=be.createElement("div"),c=be.createElement("div");c.style&&(c.style.backgroundClip="content-box",c.cloneNode(!0).style.backgroundClip="",_e.clearCloneStyle="content-box"===c.style.backgroundClip,Se.extend(_e,{boxSizingReliable:function(){return t(),r},pixelBoxStyles:function(){return t(),s},pixelPosition:function(){return t(),n},reliableMarginLeft:function(){return t(),u},scrollboxSize:function(){return t(),o},reliableTrDimensions:function(){var t,i,n,r;return null==a&&(t=be.createElement("table"),i=be.createElement("tr"),n=be.createElement("div"),t.style.cssText="position:absolute;left:-11111px;border-collapse:separate",i.style.cssText="border:1px solid",i.style.height="1px",n.style.height="9px",n.style.display="block",We.appendChild(t).appendChild(i).appendChild(n),r=e.getComputedStyle(i),a=parseInt(r.height,10)+parseInt(r.borderTopWidth,10)+parseInt(r.borderBottomWidth,10)===i.offsetHeight,We.removeChild(t)),a}}))}();var ht=["Webkit","Moz","ms"],dt=be.createElement("div").style,pt={},ft=/^(none|table(?!-c[ea]).+)/,gt=/^--/,mt={position:"absolute",visibility:"hidden",display:"block"},yt={letterSpacing:"0",fontWeight:"400"};Se.extend({cssHooks:{opacity:{get:function(e,t){if(t){var i=R(e,"opacity");return""===i?"1":i}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(e,t,i,n){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var r,o,s,a=f(t),u=gt.test(t),l=e.style;if(u||(t=U(a)),s=Se.cssHooks[t]||Se.cssHooks[a],void 0===i)return s&&"get"in s&&void 0!==(r=s.get(e,!1,n))?r:l[t];o=typeof i,"string"===o&&(r=qe.exec(i))&&r[1]&&(i=_(e,t,r),o="number"),null!=i&&i===i&&("number"!==o||u||(i+=r&&r[3]||(Se.cssNumber[a]?"":"px")),_e.clearCloneStyle||""!==i||0!==t.indexOf("background")||(l[t]="inherit"),s&&"set"in s&&void 0===(i=s.set(e,i,n))||(u?l.setProperty(t,i):l[t]=i))}},css:function(e,t,i,n){var r,o,s,a=f(t);return gt.test(t)||(t=U(a)),s=Se.cssHooks[t]||Se.cssHooks[a],s&&"get"in s&&(r=s.get(e,!0,i)),void 0===r&&(r=R(e,t,n)),"normal"===r&&t in yt&&(r=yt[t]),""===i||i?(o=parseFloat(r),i===!0||isFinite(o)?o||0:r):r}}),Se.each(["height","width"],function(e,t){Se.cssHooks[t]={get:function(e,i,n){if(i)return!ft.test(Se.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?j(e,t,n):lt(e,mt,function(){return j(e,t,n)})},set:function(e,i,n){var r,o=ut(e),s=!_e.scrollboxSize()&&"absolute"===o.position,a=s||n,u=a&&"border-box"===Se.css(e,"boxSizing",!1,o),l=n?z(e,t,n,u,o):0;return u&&s&&(l-=Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-parseFloat(o[t])-z(e,t,"border",!1,o)-.5)),l&&(r=qe.exec(i))&&"px"!==(r[3]||"px")&&(e.style[t]=i,i=Se.css(e,t)),X(e,i,l)}}}),Se.cssHooks.marginLeft=L(_e.reliableMarginLeft,function(e,t){if(t)return(parseFloat(R(e,"marginLeft"))||e.getBoundingClientRect().left-lt(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),Se.each({margin:"",padding:"",border:"Width"},function(e,t){Se.cssHooks[e+t]={expand:function(i){for(var n=0,r={},o="string"==typeof i?i.split(" "):[i];n<4;n++)r[e+He[n]+t]=o[n]||o[n-2]||o[0];return r}},"margin"!==e&&(Se.cssHooks[e+t].set=X)}),Se.fn.extend({css:function(e,t){return Pe(this,function(e,t,i){var n,r,o={},s=0;if(Array.isArray(t)){for(n=ut(e),r=t.length;s<r;s++)o[t[s]]=Se.css(e,t[s],!1,n);return o}return void 0!==i?Se.style(e,t,i):Se.css(e,t)},e,t,arguments.length>1)}}),Se.Tween=G,G.prototype={constructor:G,init:function(e,t,i,n,r,o){this.elem=e,this.prop=i,this.easing=r||Se.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=n,this.unit=o||(Se.cssNumber[i]?"":"px")},cur:function(){var e=G.propHooks[this.prop];return e&&e.get?e.get(this):G.propHooks._default.get(this)},run:function(e){var t,i=G.propHooks[this.prop];return this.options.duration?this.pos=t=Se.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):G.propHooks._default.set(this),this}},G.prototype.init.prototype=G.prototype,G.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=Se.css(e.elem,e.prop,""),t&&"auto"!==t?t:0)},set:function(e){Se.fx.step[e.prop]?Se.fx.step[e.prop](e):1!==e.elem.nodeType||!Se.cssHooks[e.prop]&&null==e.elem.style[U(e.prop)]?e.elem[e.prop]=e.now:Se.style(e.elem,e.prop,e.now+e.unit)}}},G.propHooks.scrollTop=G.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},Se.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},Se.fx=G.prototype.init,Se.fx.step={};var _t,xt,wt=/^(?:toggle|show|hide)$/,bt=/queueHooks$/;Se.Animation=Se.extend(K,{tweeners:{"*":[function(e,t){var i=this.createTween(e,t);return _(i.elem,e,qe.exec(t),i),i}]},tweener:function(e,t){xe(e)?(t=e,e=["*"]):e=e.match(Ie);for(var i,n=0,r=e.length;n<r;n++)i=e[n],K.tweeners[i]=K.tweeners[i]||[],K.tweeners[i].unshift(t)},prefilters:[$],prefilter:function(e,t){t?K.prefilters.unshift(e):K.prefilters.push(e)}}),Se.speed=function(e,t,i){var n=e&&"object"==typeof e?Se.extend({},e):{complete:i||!i&&t||xe(e)&&e,duration:e,easing:i&&t||t&&!xe(t)&&t};return Se.fx.off?n.duration=0:"number"!=typeof n.duration&&(n.duration in Se.fx.speeds?n.duration=Se.fx.speeds[n.duration]:n.duration=Se.fx.speeds._default),null!=n.queue&&n.queue!==!0||(n.queue="fx"),n.old=n.complete,n.complete=function(){xe(n.old)&&n.old.call(this),n.queue&&Se.dequeue(this,n.queue)},n},Se.fn.extend({fadeTo:function(e,t,i,n){return this.filter(Ze).css("opacity",0).show().end().animate({opacity:t},e,i,n)},animate:function(e,t,i,n){var r=Se.isEmptyObject(e),o=Se.speed(t,i,n),s=function(){var t=K(this,Se.extend({},e),o);(r||Ue.get(this,"finish"))&&t.stop(!0)};return s.finish=s,r||o.queue===!1?this.each(s):this.queue(o.queue,s)},stop:function(e,t,i){var n=function(e){var t=e.stop;delete e.stop,t(i)};return"string"!=typeof e&&(i=t,t=e,e=void 0),t&&this.queue(e||"fx",[]),this.each(function(){var t=!0,r=null!=e&&e+"queueHooks",o=Se.timers,s=Ue.get(this);if(r)s[r]&&s[r].stop&&n(s[r]);else for(r in s)s[r]&&s[r].stop&&bt.test(r)&&n(s[r]);for(r=o.length;r--;)o[r].elem!==this||null!=e&&o[r].queue!==e||(o[r].anim.stop(i),t=!1,o.splice(r,1));!t&&i||Se.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,i=Ue.get(this),n=i[e+"queue"],r=i[e+"queueHooks"],o=Se.timers,s=n?n.length:0;for(i.finish=!0,Se.queue(this,e,[]),r&&r.stop&&r.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;t<s;t++)n[t]&&n[t].finish&&n[t].finish.call(this);delete i.finish})}}),Se.each(["toggle","show","hide"],function(e,t){var i=Se.fn[t];Se.fn[t]=function(e,n,r){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(W(t,!0),e,n,r)}}),Se.each({slideDown:W("show"),slideUp:W("hide"),slideToggle:W("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){Se.fn[e]=function(e,i,n){return this.animate(t,e,i,n)}}),Se.timers=[],Se.fx.tick=function(){var e,t=0,i=Se.timers;for(_t=Date.now();t<i.length;t++)(e=i[t])()||i[t]!==e||i.splice(t--,1);i.length||Se.fx.stop(),_t=void 0},Se.fx.timer=function(e){Se.timers.push(e),Se.fx.start()},Se.fx.interval=13,Se.fx.start=function(){xt||(xt=!0,q())},Se.fx.stop=function(){xt=null},Se.fx.speeds={slow:600,fast:200,_default:400},Se.fn.delay=function(t,i){return t=Se.fx?Se.fx.speeds[t]||t:t,i=i||"fx",this.queue(i,function(i,n){var r=e.setTimeout(i,t);n.stop=function(){e.clearTimeout(r)}})},function(){var e=be.createElement("input"),t=be.createElement("select"),i=t.appendChild(be.createElement("option"));e.type="checkbox",_e.checkOn=""!==e.value,_e.optSelected=i.selected,e=be.createElement("input"),e.value="t",e.type="radio",_e.radioValue="t"===e.value}();var vt,St=Se.expr.attrHandle;Se.fn.extend({attr:function(e,t){return Pe(this,Se.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){Se.removeAttr(this,e)})}}),Se.extend({attr:function(e,t,i){var n,r,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return void 0===e.getAttribute?Se.prop(e,t,i):(1===o&&Se.isXMLDoc(e)||(r=Se.attrHooks[t.toLowerCase()]||(Se.expr.match.bool.test(t)?vt:void 0)),void 0!==i?null===i?void Se.removeAttr(e,t):r&&"set"in r&&void 0!==(n=r.set(e,i,t))?n:(e.setAttribute(t,i+""),i):r&&"get"in r&&null!==(n=r.get(e,t))?n:(n=Se.find.attr(e,t),null==n?void 0:n))},attrHooks:{type:{set:function(e,t){if(!_e.radioValue&&"radio"===t&&o(e,"input")){var i=e.value;return e.setAttribute("type",t),i&&(e.value=i),t}}}},removeAttr:function(e,t){var i,n=0,r=t&&t.match(Ie);if(r&&1===e.nodeType)for(;i=r[n++];)e.removeAttribute(i)}}),vt={set:function(e,t,i){return t===!1?Se.removeAttr(e,i):e.setAttribute(i,i),i}},Se.each(Se.expr.match.bool.source.match(/\w+/g),function(e,t){var i=St[t]||Se.find.attr;St[t]=function(e,t,n){var r,o,s=t.toLowerCase();return n||(o=St[s],St[s]=r,r=null!=i(e,t,n)?s:null,St[s]=o),r}});var Tt=/^(?:input|select|textarea|button)$/i,Ct=/^(?:a|area)$/i;Se.fn.extend({prop:function(e,t){return Pe(this,Se.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[Se.propFix[e]||e]})}}),Se.extend({prop:function(e,t,i){var n,r,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&Se.isXMLDoc(e)||(t=Se.propFix[t]||t,r=Se.propHooks[t]),void 0!==i?r&&"set"in r&&void 0!==(n=r.set(e,i,t))?n:e[t]=i:r&&"get"in r&&null!==(n=r.get(e,t))?n:e[t]},propHooks:{tabIndex:{get:function(e){var t=Se.find.attr(e,"tabindex");return t?parseInt(t,10):Tt.test(e.nodeName)||Ct.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),_e.optSelected||(Se.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),Se.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){Se.propFix[this.toLowerCase()]=this}),Se.fn.extend({addClass:function(e){var t,i,n,r,o,s,a,u=0;if(xe(e))return this.each(function(t){Se(this).addClass(e.call(this,t,J(this)))});if(t=ee(e),t.length)for(;i=this[u++];)if(r=J(i),n=1===i.nodeType&&" "+Q(r)+" "){for(s=0;o=t[s++];)n.indexOf(" "+o+" ")<0&&(n+=o+" ");a=Q(n),r!==a&&i.setAttribute("class",a)}return this},removeClass:function(e){var t,i,n,r,o,s,a,u=0;if(xe(e))return this.each(function(t){Se(this).removeClass(e.call(this,t,J(this)))});if(!arguments.length)return this.attr("class","");if(t=ee(e),t.length)for(;i=this[u++];)if(r=J(i),n=1===i.nodeType&&" "+Q(r)+" "){for(s=0;o=t[s++];)for(;n.indexOf(" "+o+" ")>-1;)n=n.replace(" "+o+" "," ");a=Q(n),r!==a&&i.setAttribute("class",a)}return this},toggleClass:function(e,t){var i=typeof e,n="string"===i||Array.isArray(e);return"boolean"==typeof t&&n?t?this.addClass(e):this.removeClass(e):xe(e)?this.each(function(i){Se(this).toggleClass(e.call(this,i,J(this),t),t)}):this.each(function(){var t,r,o,s;if(n)for(r=0,o=Se(this),s=ee(e);t=s[r++];)o.hasClass(t)?o.removeClass(t):o.addClass(t);else void 0!==e&&"boolean"!==i||(t=J(this),t&&Ue.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",t||e===!1?"":Ue.get(this,"__className__")||""))})},hasClass:function(e){var t,i,n=0;for(t=" "+e+" ";i=this[n++];)if(1===i.nodeType&&(" "+Q(J(i))+" ").indexOf(t)>-1)return!0;return!1}});Se.fn.extend({val:function(e){var t,i,n,r=this[0];if(arguments.length)return n=xe(e),this.each(function(i){var r;1===this.nodeType&&(r=n?e.call(this,i,Se(this).val()):e,null==r?r="":"number"==typeof r?r+="":Array.isArray(r)&&(r=Se.map(r,function(e){return null==e?"":e+""})),(t=Se.valHooks[this.type]||Se.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,r,"value")||(this.value=r))});if(r)return(t=Se.valHooks[r.type]||Se.valHooks[r.nodeName.toLowerCase()])&&"get"in t&&void 0!==(i=t.get(r,"value"))?i:(i=r.value,"string"==typeof i?i.replace(/\r/g,""):null==i?"":i)}}),Se.extend({valHooks:{option:{get:function(e){var t=Se.find.attr(e,"value");return null!=t?t:Q(Se.text(e))}},select:{get:function(e){var t,i,n,r=e.options,s=e.selectedIndex,a="select-one"===e.type,u=a?null:[],l=a?s+1:r.length;for(n=s<0?l:a?s:0;n<l;n++)if(i=r[n],(i.selected||n===s)&&!i.disabled&&(!i.parentNode.disabled||!o(i.parentNode,"optgroup"))){if(t=Se(i).val(),a)return t;u.push(t)}return u},set:function(e,t){for(var i,n,r=e.options,o=Se.makeArray(t),s=r.length;s--;)n=r[s],(n.selected=Se.inArray(Se.valHooks.option.get(n),o)>-1)&&(i=!0);return i||(e.selectedIndex=-1),o}}}}),Se.each(["radio","checkbox"],function(){Se.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=Se.inArray(Se(e).val(),t)>-1}},_e.checkOn||(Se.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),_e.focusin="onfocusin"in e;var Ft=/^(?:focusinfocus|focusoutblur)$/,Ot=function(e){e.stopPropagation()};Se.extend(Se.event,{trigger:function(t,i,n,r){var o,s,a,u,l,c,h,d,p=[n||be],f=ge.call(t,"type")?t.type:t,g=ge.call(t,"namespace")?t.namespace.split("."):[];if(s=d=a=n=n||be,3!==n.nodeType&&8!==n.nodeType&&!Ft.test(f+Se.event.triggered)&&(f.indexOf(".")>-1&&(g=f.split("."),f=g.shift(),g.sort()),l=f.indexOf(":")<0&&"on"+f,t=t[Se.expando]?t:new Se.Event(f,"object"==typeof t&&t),t.isTrigger=r?2:3,t.namespace=g.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=n),i=null==i?[t]:Se.makeArray(i,[t]),h=Se.event.special[f]||{},r||!h.trigger||h.trigger.apply(n,i)!==!1)){if(!r&&!h.noBubble&&!we(n)){for(u=h.delegateType||f,Ft.test(u+f)||(s=s.parentNode);s;s=s.parentNode)p.push(s),a=s;a===(n.ownerDocument||be)&&p.push(a.defaultView||a.parentWindow||e)}for(o=0;(s=p[o++])&&!t.isPropagationStopped();)d=s,t.type=o>1?u:h.bindType||f,c=(Ue.get(s,"events")||Object.create(null))[t.type]&&Ue.get(s,"handle"),c&&c.apply(s,i),(c=l&&s[l])&&c.apply&&ke(s)&&(t.result=c.apply(s,i),t.result===!1&&t.preventDefault());return t.type=f,r||t.isDefaultPrevented()||h._default&&h._default.apply(p.pop(),i)!==!1||!ke(n)||l&&xe(n[f])&&!we(n)&&(a=n[l],a&&(n[l]=null),Se.event.triggered=f,t.isPropagationStopped()&&d.addEventListener(f,Ot),n[f](),t.isPropagationStopped()&&d.removeEventListener(f,Ot),Se.event.triggered=void 0,a&&(n[l]=a)),t.result}},simulate:function(e,t,i){var n=Se.extend(new Se.Event,i,{type:e,isSimulated:!0});Se.event.trigger(n,null,t)}}),Se.fn.extend({trigger:function(e,t){return this.each(function(){Se.event.trigger(e,t,this)})},triggerHandler:function(e,t){var i=this[0];if(i)return Se.event.trigger(e,t,i,!0)}}),_e.focusin||Se.each({focus:"focusin",blur:"focusout"},function(e,t){var i=function(e){Se.event.simulate(t,e.target,Se.event.fix(e))};Se.event.special[t]={setup:function(){var n=this.ownerDocument||this.document||this,r=Ue.access(n,t);r||n.addEventListener(e,i,!0),Ue.access(n,t,(r||0)+1)},teardown:function(){var n=this.ownerDocument||this.document||this,r=Ue.access(n,t)-1;r?Ue.access(n,t,r):(n.removeEventListener(e,i,!0),Ue.remove(n,t))}}});var Nt=e.location,Et={guid:Date.now()},Dt=/\?/;Se.parseXML=function(t){var i,n;if(!t||"string"!=typeof t)return null;try{i=(new e.DOMParser).parseFromString(t,"text/xml")}catch(e){}return n=i&&i.getElementsByTagName("parsererror")[0],i&&!n||Se.error("Invalid XML: "+(n?Se.map(n.childNodes,function(e){return e.textContent}).join("\n"):t)),i};var Mt=/\[\]$/,Vt=/^(?:submit|button|image|reset|file)$/i,It=/^(?:input|select|textarea|keygen)/i;Se.param=function(e,t){var i,n=[],r=function(e,t){var i=xe(t)?t():t;n[n.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==i?"":i)};if(null==e)return"";if(Array.isArray(e)||e.jquery&&!Se.isPlainObject(e))Se.each(e,function(){r(this.name,this.value)});else for(i in e)te(i,e[i],t,r);return n.join("&")},Se.fn.extend({serialize:function(){return Se.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=Se.prop(this,"elements");return e?Se.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!Se(this).is(":disabled")&&It.test(this.nodeName)&&!Vt.test(e)&&(this.checked||!Qe.test(e))}).map(function(e,t){var i=Se(this).val();return null==i?null:Array.isArray(i)?Se.map(i,function(e){return{name:t.name,value:e.replace(/\r?\n/g,"\r\n")}}):{name:t.name,value:i.replace(/\r?\n/g,"\r\n")}}).get()}});var Bt=/^(.*?):[ \t]*([^\r\n]*)$/gm,At=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Pt=/^(?:GET|HEAD)$/,Rt={},Lt={},kt="*/".concat("*"),Ut=be.createElement("a");Ut.href=Nt.href,Se.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Nt.href,type:"GET",isLocal:At.test(Nt.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":kt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":Se.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?re(re(e,Se.ajaxSettings),t):re(Se.ajaxSettings,e)},ajaxPrefilter:ie(Rt),ajaxTransport:ie(Lt),ajax:function(t,i){function n(t,i,n,a){var l,d,p,w,b,v=i;c||(c=!0,u&&e.clearTimeout(u),r=void 0,s=a||"",S.readyState=t>0?4:0,l=t>=200&&t<300||304===t,n&&(w=oe(f,S,n)),!l&&Se.inArray("script",f.dataTypes)>-1&&Se.inArray("json",f.dataTypes)<0&&(f.converters["text script"]=function(){}),w=se(f,w,S,l),l?(f.ifModified&&(b=S.getResponseHeader("Last-Modified"),b&&(Se.lastModified[o]=b),(b=S.getResponseHeader("etag"))&&(Se.etag[o]=b)),204===t||"HEAD"===f.type?v="nocontent":304===t?v="notmodified":(v=w.state,d=w.data,p=w.error,l=!p)):(p=v,!t&&v||(v="error",t<0&&(t=0))),S.status=t,S.statusText=(i||v)+"",l?y.resolveWith(g,[d,v,S]):y.rejectWith(g,[S,v,p]),S.statusCode(x),x=void 0,h&&m.trigger(l?"ajaxSuccess":"ajaxError",[S,f,l?d:p]),_.fireWith(g,[S,v]),h&&(m.trigger("ajaxComplete",[S,f]),--Se.active||Se.event.trigger("ajaxStop")))}"object"==typeof t&&(i=t,t=void 0),i=i||{};var r,o,s,a,u,l,c,h,d,p,f=Se.ajaxSetup({},i),g=f.context||f,m=f.context&&(g.nodeType||g.jquery)?Se(g):Se.event,y=Se.Deferred(),_=Se.Callbacks("once memory"),x=f.statusCode||{},w={},b={},v="canceled",S={
readyState:0,getResponseHeader:function(e){var t;if(c){if(!a)for(a={};t=Bt.exec(s);)a[t[1].toLowerCase()+" "]=(a[t[1].toLowerCase()+" "]||[]).concat(t[2]);t=a[e.toLowerCase()+" "]}return null==t?null:t.join(", ")},getAllResponseHeaders:function(){return c?s:null},setRequestHeader:function(e,t){return null==c&&(e=b[e.toLowerCase()]=b[e.toLowerCase()]||e,w[e]=t),this},overrideMimeType:function(e){return null==c&&(f.mimeType=e),this},statusCode:function(e){var t;if(e)if(c)S.always(e[S.status]);else for(t in e)x[t]=[x[t],e[t]];return this},abort:function(e){var t=e||v;return r&&r.abort(t),n(0,t),this}};if(y.promise(S),f.url=((t||f.url||Nt.href)+"").replace(/^\/\//,Nt.protocol+"//"),f.type=i.method||i.type||f.method||f.type,f.dataTypes=(f.dataType||"*").toLowerCase().match(Ie)||[""],null==f.crossDomain){l=be.createElement("a");try{l.href=f.url,l.href=l.href,f.crossDomain=Ut.protocol+"//"+Ut.host!=l.protocol+"//"+l.host}catch(e){f.crossDomain=!0}}if(f.data&&f.processData&&"string"!=typeof f.data&&(f.data=Se.param(f.data,f.traditional)),ne(Rt,f,i,S),c)return S;h=Se.event&&f.global,h&&0==Se.active++&&Se.event.trigger("ajaxStart"),f.type=f.type.toUpperCase(),f.hasContent=!Pt.test(f.type),o=f.url.replace(/#.*$/,""),f.hasContent?f.data&&f.processData&&0===(f.contentType||"").indexOf("application/x-www-form-urlencoded")&&(f.data=f.data.replace(/%20/g,"+")):(p=f.url.slice(o.length),f.data&&(f.processData||"string"==typeof f.data)&&(o+=(Dt.test(o)?"&":"?")+f.data,delete f.data),f.cache===!1&&(o=o.replace(/([?&])_=[^&]*/,"$1"),p=(Dt.test(o)?"&":"?")+"_="+Et.guid+++p),f.url=o+p),f.ifModified&&(Se.lastModified[o]&&S.setRequestHeader("If-Modified-Since",Se.lastModified[o]),Se.etag[o]&&S.setRequestHeader("If-None-Match",Se.etag[o])),(f.data&&f.hasContent&&f.contentType!==!1||i.contentType)&&S.setRequestHeader("Content-Type",f.contentType),S.setRequestHeader("Accept",f.dataTypes[0]&&f.accepts[f.dataTypes[0]]?f.accepts[f.dataTypes[0]]+("*"!==f.dataTypes[0]?", "+kt+"; q=0.01":""):f.accepts["*"]);for(d in f.headers)S.setRequestHeader(d,f.headers[d]);if(f.beforeSend&&(f.beforeSend.call(g,S,f)===!1||c))return S.abort();if(v="abort",_.add(f.complete),S.done(f.success),S.fail(f.error),r=ne(Lt,f,i,S)){if(S.readyState=1,h&&m.trigger("ajaxSend",[S,f]),c)return S;f.async&&f.timeout>0&&(u=e.setTimeout(function(){S.abort("timeout")},f.timeout));try{c=!1,r.send(w,n)}catch(e){if(c)throw e;n(-1,e)}}else n(-1,"No Transport");return S},getJSON:function(e,t,i){return Se.get(e,t,i,"json")},getScript:function(e,t){return Se.get(e,void 0,t,"script")}}),Se.each(["get","post"],function(e,t){Se[t]=function(e,i,n,r){return xe(i)&&(r=r||n,n=i,i=void 0),Se.ajax(Se.extend({url:e,type:t,dataType:r,data:i,success:n},Se.isPlainObject(e)&&e))}}),Se.ajaxPrefilter(function(e){var t;for(t in e.headers)"content-type"===t.toLowerCase()&&(e.contentType=e.headers[t]||"")}),Se._evalUrl=function(e,t,i){return Se.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){Se.globalEval(e,t,i)}})},Se.fn.extend({wrapAll:function(e){var t;return this[0]&&(xe(e)&&(e=e.call(this[0])),t=Se(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(e){return xe(e)?this.each(function(t){Se(this).wrapInner(e.call(this,t))}):this.each(function(){var t=Se(this),i=t.contents();i.length?i.wrapAll(e):t.append(e)})},wrap:function(e){var t=xe(e);return this.each(function(i){Se(this).wrapAll(t?e.call(this,i):e)})},unwrap:function(e){return this.parent(e).not("body").each(function(){Se(this).replaceWith(this.childNodes)}),this}}),Se.expr.pseudos.hidden=function(e){return!Se.expr.pseudos.visible(e)},Se.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},Se.ajaxSettings.xhr=function(){try{return new e.XMLHttpRequest}catch(e){}};var Xt={0:200,1223:204},zt=Se.ajaxSettings.xhr();_e.cors=!!zt&&"withCredentials"in zt,_e.ajax=zt=!!zt,Se.ajaxTransport(function(t){var i,n;if(_e.cors||zt&&!t.crossDomain)return{send:function(r,o){var s,a=t.xhr();if(a.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(s in t.xhrFields)a[s]=t.xhrFields[s];t.mimeType&&a.overrideMimeType&&a.overrideMimeType(t.mimeType),t.crossDomain||r["X-Requested-With"]||(r["X-Requested-With"]="XMLHttpRequest");for(s in r)a.setRequestHeader(s,r[s]);i=function(e){return function(){i&&(i=n=a.onload=a.onerror=a.onabort=a.ontimeout=a.onreadystatechange=null,"abort"===e?a.abort():"error"===e?"number"!=typeof a.status?o(0,"error"):o(a.status,a.statusText):o(Xt[a.status]||a.status,a.statusText,"text"!==(a.responseType||"text")||"string"!=typeof a.responseText?{binary:a.response}:{text:a.responseText},a.getAllResponseHeaders()))}},a.onload=i(),n=a.onerror=a.ontimeout=i("error"),void 0!==a.onabort?a.onabort=n:a.onreadystatechange=function(){4===a.readyState&&e.setTimeout(function(){i&&n()})},i=i("abort");try{a.send(t.hasContent&&t.data||null)}catch(e){if(i)throw e}},abort:function(){i&&i()}}}),Se.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),Se.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return Se.globalEval(e),e}}}),Se.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),Se.ajaxTransport("script",function(e){if(e.crossDomain||e.scriptAttrs){var t,i;return{send:function(n,r){t=Se("<script>").attr(e.scriptAttrs||{}).prop({charset:e.scriptCharset,src:e.url}).on("load error",i=function(e){t.remove(),i=null,e&&r("error"===e.type?404:200,e.type)}),be.head.appendChild(t[0])},abort:function(){i&&i()}}}});var jt=[],Gt=/(=)\?(?=&|$)|\?\?/;Se.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=jt.pop()||Se.expando+"_"+Et.guid++;return this[e]=!0,e}}),Se.ajaxPrefilter("json jsonp",function(t,i,n){var r,o,s,a=t.jsonp!==!1&&(Gt.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Gt.test(t.data)&&"data");if(a||"jsonp"===t.dataTypes[0])return r=t.jsonpCallback=xe(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace(Gt,"$1"+r):t.jsonp!==!1&&(t.url+=(Dt.test(t.url)?"&":"?")+t.jsonp+"="+r),t.converters["script json"]=function(){return s||Se.error(r+" was not called"),s[0]},t.dataTypes[0]="json",o=e[r],e[r]=function(){s=arguments},n.always(function(){void 0===o?Se(e).removeProp(r):e[r]=o,t[r]&&(t.jsonpCallback=i.jsonpCallback,jt.push(r)),s&&xe(o)&&o(s[0]),s=o=void 0}),"script"}),_e.createHTMLDocument=function(){var e=be.implementation.createHTMLDocument("").body;return e.innerHTML="<form></form><form></form>",2===e.childNodes.length}(),Se.parseHTML=function(e,t,i){if("string"!=typeof e)return[];"boolean"==typeof t&&(i=t,t=!1);var n,r,o;return t||(_e.createHTMLDocument?(t=be.implementation.createHTMLDocument(""),n=t.createElement("base"),n.href=be.location.href,t.head.appendChild(n)):t=be),r=Ne.exec(e),o=!i&&[],r?[t.createElement(r[1])]:(r=S([e],t,o),o&&o.length&&Se(o).remove(),Se.merge([],r.childNodes))},Se.fn.load=function(e,t,i){var n,r,o,s=this,a=e.indexOf(" ");return a>-1&&(n=Q(e.slice(a)),e=e.slice(0,a)),xe(t)?(i=t,t=void 0):t&&"object"==typeof t&&(r="POST"),s.length>0&&Se.ajax({url:e,type:r||"GET",dataType:"html",data:t}).done(function(e){o=arguments,s.html(n?Se("<div>").append(Se.parseHTML(e)).find(n):e)}).always(i&&function(e,t){s.each(function(){i.apply(this,o||[e.responseText,t,e])})}),this},Se.expr.pseudos.animated=function(e){return Se.grep(Se.timers,function(t){return e===t.elem}).length},Se.offset={setOffset:function(e,t,i){var n,r,o,s,a,u,l,c=Se.css(e,"position"),h=Se(e),d={};"static"===c&&(e.style.position="relative"),a=h.offset(),o=Se.css(e,"top"),u=Se.css(e,"left"),l=("absolute"===c||"fixed"===c)&&(o+u).indexOf("auto")>-1,l?(n=h.position(),s=n.top,r=n.left):(s=parseFloat(o)||0,r=parseFloat(u)||0),xe(t)&&(t=t.call(e,i,Se.extend({},a))),null!=t.top&&(d.top=t.top-a.top+s),null!=t.left&&(d.left=t.left-a.left+r),"using"in t?t.using.call(e,d):h.css(d)}},Se.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){Se.offset.setOffset(this,e,t)});var t,i,n=this[0];if(n)return n.getClientRects().length?(t=n.getBoundingClientRect(),i=n.ownerDocument.defaultView,{top:t.top+i.pageYOffset,left:t.left+i.pageXOffset}):{top:0,left:0}},position:function(){if(this[0]){var e,t,i,n=this[0],r={top:0,left:0};if("fixed"===Se.css(n,"position"))t=n.getBoundingClientRect();else{for(t=this.offset(),i=n.ownerDocument,e=n.offsetParent||i.documentElement;e&&(e===i.body||e===i.documentElement)&&"static"===Se.css(e,"position");)e=e.parentNode;e&&e!==n&&1===e.nodeType&&(r=Se(e).offset(),r.top+=Se.css(e,"borderTopWidth",!0),r.left+=Se.css(e,"borderLeftWidth",!0))}return{top:t.top-r.top-Se.css(n,"marginTop",!0),left:t.left-r.left-Se.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent;e&&"static"===Se.css(e,"position");)e=e.offsetParent;return e||We})}}),Se.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var i="pageYOffset"===t;Se.fn[e]=function(n){return Pe(this,function(e,n,r){var o;if(we(e)?o=e:9===e.nodeType&&(o=e.defaultView),void 0===r)return o?o[t]:e[n];o?o.scrollTo(i?o.pageXOffset:r,i?r:o.pageYOffset):e[n]=r},e,n,arguments.length)}}),Se.each(["top","left"],function(e,t){Se.cssHooks[t]=L(_e.pixelPosition,function(e,i){if(i)return i=R(e,t),at.test(i)?Se(e).position()[t]+"px":i})}),Se.each({Height:"height",Width:"width"},function(e,t){Se.each({padding:"inner"+e,content:t,"":"outer"+e},function(i,n){Se.fn[n]=function(r,o){var s=arguments.length&&(i||"boolean"!=typeof r),a=i||(r===!0||o===!0?"margin":"border");return Pe(this,function(t,i,r){var o;return we(t)?0===n.indexOf("outer")?t["inner"+e]:t.document.documentElement["client"+e]:9===t.nodeType?(o=t.documentElement,Math.max(t.body["scroll"+e],o["scroll"+e],t.body["offset"+e],o["offset"+e],o["client"+e])):void 0===r?Se.css(t,i,a):Se.style(t,i,r,a)},t,s?r:void 0,s)}})}),Se.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){Se.fn[t]=function(e){return this.on(t,e)}}),Se.fn.extend({bind:function(e,t,i){return this.on(e,null,t,i)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,i,n){return this.on(t,e,i,n)},undelegate:function(e,t,i){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",i)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),Se.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,t){Se.fn[t]=function(e,i){return arguments.length>0?this.on(t,null,e,i):this.trigger(t)}});Se.proxy=function(e,t){var i,n,r;if("string"==typeof t&&(i=e[t],t=e,e=i),xe(e))return n=le.call(arguments,2),r=function(){return e.apply(t||this,n.concat(le.call(arguments)))},r.guid=e.guid=e.guid||Se.guid++,r},Se.holdReady=function(e){e?Se.readyWait++:Se.ready(!0)},Se.isArray=Array.isArray,Se.parseJSON=JSON.parse,Se.nodeName=o,Se.isFunction=xe,Se.isWindow=we,Se.camelCase=f,Se.type=n,Se.now=Date.now,Se.isNumeric=function(e){var t=Se.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},Se.trim=function(e){return null==e?"":(e+"").replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},"function"==typeof define&&define.amd&&define("jquery",[],function(){return Se});var qt=e.jQuery,Ht=e.$;return Se.noConflict=function(t){return e.$===Se&&(e.$=Ht),t&&e.jQuery===Se&&(e.jQuery=qt),Se},void 0===t&&(e.jQuery=e.$=Se),Se}),define("jquery/dist/jquery",function(){}),define("x_ite/Fallback",["jquery"],function(e){"use strict";return{error:function(t,i){e(function(){const n=e("X3DCanvas");this.show(n,t);for(const e of i)"function"==typeof e&&e(n,t)}.bind(this))},show:function(t,i){console.log(i);const n=e(".x_ite-console");n.length&&n.append(document.createTextNode(i)),t.addClass("x_ite-browser-fallback"),t.children(".x_ite-private-browser").hide(),t.children(":not(.x_ite-private-browser)").addClass("x_ite-fallback"),t.children(":not(.x_ite-private-browser)").show()}}}),define("x_ite/Base/X3DConstants",[],function(){"use strict";let e=0,t=0,i=0;return{CONNECTION_ERROR:e++,BROWSER_EVENT:e++,INITIALIZED_EVENT:e++,SHUTDOWN_EVENT:e++,INITIALIZED_ERROR:e++,NOT_STARTED_STATE:t++,IN_PROGRESS_STATE:t++,COMPLETE_STATE:t++,FAILED_STATE:t++,initializeOnly:parseInt("001",2),inputOnly:parseInt("010",2),outputOnly:parseInt("100",2),inputOutput:parseInt("111",2),SFBool:i++,SFColor:i++,SFColorRGBA:i++,SFDouble:i++,SFFloat:i++,SFImage:i++,SFInt32:i++,SFMatrix3d:i++,SFMatrix3f:i++,SFMatrix4d:i++,SFMatrix4f:i++,SFNode:i++,SFRotation:i++,SFString:i++,SFTime:i++,SFVec2d:i++,SFVec2f:i++,SFVec3d:i++,SFVec3f:i++,SFVec4d:i++,SFVec4f:i++,VrmlMatrix:i++,MFBool:i++,MFColor:i++,MFColorRGBA:i++,MFDouble:i++,MFFloat:i++,MFImage:i++,MFInt32:i++,MFMatrix3d:i++,MFMatrix3f:i++,MFMatrix4d:i++,MFMatrix4f:i++,MFNode:i++,MFRotation:i++,MFString:i++,MFTime:i++,MFVec2d:i++,MFVec2f:i++,MFVec3d:i++,MFVec3f:i++,MFVec4d:i++,MFVec4f:i++,X3DBaseNode:0}}),define("x_ite/InputOutput/Generator",["x_ite/Base/X3DConstants"],function(e){"use strict";function t(){this.indent="",this.indentChar="  ",this.precision=6,this.doublePrecision=14,this.removeTrailingZeros=/\.?0*(?=$|[eE])/,this.executionContextStack=[null],this.importedNodesIndex=new Map,this.exportedNodesIndex=new Map,this.nodes=new Set,this.names=new Map,this.namesByNode=new Map,this.importedNames=new Map,this.routeNodes=new Set,this.level=0,this.newName=0,this.containerFields=[],this.units=!0,this.unitCategories=[],this.names.set(null,new Map)}t.prototype={constructor:t,Indent:function(){return this.indent},IncIndent:function(){this.indent+=this.indentChar},DecIndent:function(){this.indent=this.indent.substr(0,this.indent.length-this.indentChar.length)},PadRight:function(e,t){for(let i=0,n=t-e.length;i<n;++i)e+=" ";return e},Precision:function(e){return Math.fround(e).toPrecision(this.precision).replace(this.removeTrailingZeros,"")},DoublePrecision:function(e){return e.toPrecision(this.doublePrecision).replace(this.removeTrailingZeros,"")},PushExecutionContext:function(e){this.executionContextStack.push(e),this.names.has(e)||this.names.set(e,new Map),this.importedNodesIndex.has(e)||this.importedNodesIndex.set(e,new Set),this.exportedNodesIndex.has(e)||this.exportedNodesIndex.set(e,new Set)},PopExecutionContext:function(){this.executionContextStack.pop(),this.ExecutionContext()||(this.importedNodesIndex.clear(),this.exportedNodesIndex.clear())},ExecutionContext:function(){return this.executionContextStack.at(-1)},EnterScope:function(){0===this.level&&(this.newName=0),++this.level},LeaveScope:function(){0===--this.level&&(this.nodes.clear(),this.namesByNode.clear(),this.importedNames.clear())},ExportedNodes:function(e){const t=this.exportedNodesIndex.get(this.ExecutionContext());e.forEach(function(e){try{t.add(e.getLocalNode())}catch(e){}})},ImportedNodes:function(e){const t=this.importedNodesIndex.get(this.ExecutionContext());e.forEach(function(e){try{t.add(e.getInlineNode())}catch(e){}})},AddImportedNode:function(e,t){this.importedNames.set(e,t)},AddRouteNode:function(e){this.routeNodes.add(e)},ExistsRouteNode:function(e){return this.routeNodes.has(e)},IsSharedNode:function(e){return this.ExecutionContext()!==e.getExecutionContext()},AddNode:function(e){this.nodes.add(e),this.AddRouteNode(e)},ExistsNode:function(e){return this.nodes.has(e)},Name:function(){return function(e){const t=this.namesByNode.get(e);if(void 0!==t)return t;{const t=this.names.get(this.ExecutionContext());if(0===e.getName().length){if(this.NeedsName(e)){const i=this.UniqueName();return t.set(i,e),this.namesByNode.set(e,i),i}return e.getName()}let i=e.getName();const n=null!==i.match(/_\d+$/);if(i=i.replace(/_\d+$/,""),0===i.length){if(!this.NeedsName(e))return"";i=this.UniqueName()}else{let e=0,r=n?i+"_"+ ++e:i;for(;t.has(r);)r=i+"_"+ ++e;i=r}return t.set(i,e),this.namesByNode.set(e,i),i}}}(),NeedsName:function(e){if(e.getCloneCount()>1)return!0;if(e.hasRoutes())return!0;const t=e.getExecutionContext(),i=this.importedNodesIndex.get(t);if(!i){const i=this.exportedNodesIndex.get(t);return!(!i||!i.has(e))}return!!i.has(e)||void 0},UniqueName:function(){const e=this.names.get(this.ExecutionContext());for(;;){const t="_"+ ++this.newName;if(!e.has(t))return t}},LocalName:function(e){const t=this.importedNames.get(e);if(void 0!==t)return t;if(this.ExistsNode(e))return this.Name(e);throw new Error("Couldn't get local name for node '"+e.getTypeName()+"'.")},PushContainerField:function(e){this.containerFields.push(e)},PopContainerField:function(){this.containerFields.pop()},ContainerField:function(){return this.containerFields.length?this.containerFields[this.containerFields.length-1]:null},AccessType:function(t){switch(t){case e.initializeOnly:return"initializeOnly";case e.inputOnly:return"inputOnly";case e.outputOnly:return"outputOnly";case e.inputOutput:return"inputOutput"}},SetUnits:function(e){this.units=e},GetUnits:function(){return this.units},PushUnitCategory:function(e){this.unitCategories.push(e)},PopUnitCategory:function(){this.unitCategories.pop()},Unit:function(e){return 0==this.unitCategories.length?e:this.unitCategories.at(-1)},ToUnit:function(e,t){if(this.units){const i=this.ExecutionContext();if(i)return i.toUnit(e,t)}return t},XMLEncode:function(e){return e.replace(/&/g,"&amp;").replace(/\\/g,"&#92;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;").replace(/"/g,'\\"')},escapeCDATA:function(e){return e.replace(/\]\]\>/g,"\\]\\]\\>")}};for(const e of Reflect.ownKeys(t.prototype))Object.defineProperty(t.prototype,e,{enumerable:!1});return t.Get=function(e){return e.generator||(e.generator=new t),e.generator},t}),define("standard/Utility/MapUtilities",["require"],function(e){"use strict";return{assign:function(e,t){return e.clear(),t.forEach(function(t,i){e.set(i,t)}),e},values:function(e,t){let i=0;return t.forEach(function(t){e[i++]=t}),e.length=t.size,e}}}),define("x_ite/Base/X3DObject",["x_ite/InputOutput/Generator","standard/Utility/MapUtilities"],function(e,t){"use strict";function i(){}const n=Symbol(),r=Symbol(),o=Symbol();i.prototype={constructor:i,[n]:"",[r]:new Map,[o]:[],getId:function(){return i.getId(this)},getTypeName:function(){return"X3DObject"},setName:function(e){this[n]=e},getName:function(){return this[n]},getDisplayName:function(){return this[n]},getInterestId:function(e,t){return i.getId(t)+"."+String(e)},hasInterest:function(e,t){return this[r].has(this.getInterestId(e,t))},addInterest:function(e,t){this[r]===i.prototype[r]&&(this[r]=new Map,this[o]=[]);const n=this.getInterestId(e,t),s=t[e];if(arguments.length>2){const e=Array.from(arguments);e[0]=t,e[1]=this,this[r].set(n,Function.prototype.bind.apply(s,e))}else this[r].set(n,s.bind(t,this))},removeInterest:function(e,t){this[r].delete(this.getInterestId(e,t))},getInterests:function(){return this[r]},processInterests:function(){if(this[r].size)for(const e of t.values(this[o],this[r]))e()},toString:function(t){const i={string:""};return t&&e.Get(i).PushExecutionContext(t),this.toStream(i),i.string},toVRMLString:function(){const e={string:""};return this.toVRMLStream(e),e.string},toXMLString:function(){const e={string:""};return this.toXMLStream(e),e.string},toJSONString:function(){const e={string:""};return this.toJSONStream(e),e.string},toStream:function(e){e.string="[_object "+this.getTypeName()+"]"},dispose:function(){}};for(const e of Reflect.ownKeys(i.prototype))Object.defineProperty(i.prototype,e,{enumerable:!1});return i.getId=function(){const e=new WeakMap;let t=0;return function(i){const n=e.get(i);return void 0!==n?n:(e.set(i,++t),t)}}(),i}),define("x_ite/Base/X3DChildObject",["x_ite/Base/X3DObject"],function(e){"use strict";function t(){e.call(this)}const i=Symbol(),n=Symbol(),r=Symbol();t.prototype=Object.assign(Object.create(e.prototype),{constructor:t,[i]:0,[n]:!1,[r]:new Set,setModificationTime:function(e){this[i]=e},getModificationTime:function(){return this[i]},setTainted:function(e){this[n]=e},isTainted:function(){return this[n]},addEvent:function(){this.setModificationTime(performance.now());for(const e of this[r])e.addEvent(this)},addEventObject:function(e,t){this.setModificationTime(performance.now());for(const e of this[r])e.addEventObject(this,t)},addParent:function(e){this[r]===t.prototype[r]&&(this[r]=new Set),this[r].add(e)},removeParent:function(e){this[r].delete(e)},getParents:function(){return this[r]},dispose:function(){this[r].clear(),e.prototype.dispose.call(this)}});for(const e of Reflect.ownKeys(t.prototype))Object.defineProperty(t.prototype,e,{enumerable:!1});return t}),define("x_ite/Base/Events",[],function(){"use strict";function e(){this[t]=[]}const t=Symbol();e.prototype={create:function(e){if(this[t].length){const i=this[t].pop();return i.field=e,i.clear(),i}const i=new Set;return i.field=e,i},copy:function(e){if(this[t].length){const i=this[t].pop();i.field=e.field,i.clear();for(const t of e)i.add(t);return i}const i=new Set(e);return i.field=e.field,i},push:function(e){this[t].push(e)},clear:function(){this[t].length=0}};for(const t of Reflect.ownKeys(e.prototype))Object.defineProperty(e.prototype,t,{enumerable:!1});return new e}),define("x_ite/Base/X3DEventObject",["x_ite/Base/X3DChildObject","x_ite/Base/Events"],function(e,t){"use strict";function i(t){e.call(this),this[n]=t}const n=Symbol.for("X3DEventObject.browser");i.prototype=Object.assign(Object.create(e.prototype),{constructor:i,getBrowser:function(){return this[n]},getExtendedEventHandling:function(){return!0},addEvent:function(e){e.isTainted()||(e.setTainted(!0),this.addEventObject(e,t.create(e)))},addEventObject:function(e,t){const i=this.getBrowser();i.addBrowserEvent(),i.addTaintedField(e,t),this.isTainted()||(e.isInput()||this.getExtendedEventHandling()&&!e.isOutput())&&this.addNodeEvent()},addNodeEvent:function(){if(!this.isTainted()){const e=this.getBrowser();this.setTainted(!0),e.addTaintedNode(this),e.addBrowserEvent()}},processEvents:function(){this.setTainted(!1),this.processInterests()}});for(const e of Reflect.ownKeys(i.prototype))Object.defineProperty(i.prototype,e,{enumerable:!1});return i}),define("x_ite/Base/X3DFieldDefinition",["x_ite/Base/X3DObject"],function(e){"use strict";function t(e,t,i){this.accessType=e,this.dataType=i.getType(),this.name=t,this.value=i}t.prototype=Object.assign(Object.create(e.prototype),{constructor:t,getTypeName:function(){return"X3DFieldDefinition"}});for(const e of Reflect.ownKeys(t.prototype))Object.defineProperty(t.prototype,e,{enumerable:!1});return t}),define("x_ite/Base/X3DInfoArray",["x_ite/Base/X3DObject"],function(e){"use strict";function t(){return this[i]=[],this[n]=new Map,this[Symbol.iterator]=this[i][Symbol.iterator],new Proxy(this,r)}const i=Symbol(),n=Symbol(),r={get:function(e,t){const n=e[t];if(void 0!==n)return n;if("string"!=typeof t);else{const n=+t;if(Number.isInteger(n))return e[i][n]}},set:function(e,t,i){return!1},has:function(e,t){return Number.isInteger(+t)?t<e[i].length:t in e},ownKeys:function(e){return Object.keys(e[i])},getOwnPropertyDescriptor:function(e,t){if("string"==typeof t){const n=+t;if(Number.isInteger(n)&&n<e[i].length){const n=Object.getOwnPropertyDescriptor(e[i],t);return n&&(n.writable=!1),n}}}};t.prototype=Object.assign(Object.create(e.prototype),{constructor:t,has:function(e){return this[n].has(e)},get:function(e){return this[n].get(e)},add:function(e,t){this[i].push(t),this[n].set(e,t),this.processInterests()},addAlias:function(e,t){this[n].set(e,this[n].get(t)),this.processInterests()},update:function(e,t,r){const o=this[n].get(e);if(e!==t&&this.remove(t),this[n].delete(e),this[n].set(t,r),void 0!==o){const e=this[i].indexOf(o);e>-1&&(this[i][e]=r)}else this[i].push(r);this.processInterests()},remove:function(e){const t=this[n].get(e);if(void 0!==t){const r=this[i].indexOf(t);this[n].delete(e),r>-1&&this[i].splice(r,1),this.processInterests()}},toVRMLStream:function(e){const t=require("x_ite/Base/X3DBaseNode");for(const n of this[i])try{n.toVRMLStream(e),e.string+="\n",n instanceof t&&(e.string+="\n")}catch(e){console.log(e)}},toXMLStream:function(e){for(const t of this[i])try{t.toXMLStream(e),e.string+="\n"}catch(e){console.log(e)}}});for(const e of Reflect.ownKeys(t.prototype))Object.defineProperty(t.prototype,e,{enumerable:!1});return Object.defineProperty(t.prototype,"length",{get:function(){return this[i].length},enumerable:!1,configurable:!1}),t}),define("x_ite/Base/FieldDefinitionArray",["x_ite/Base/X3DInfoArray"],function(e){"use strict";function t(t){const i=e.call(this);for(const e of t)this.add(e.name,e);return i}t.prototype=Object.assign(Object.create(e.prototype),{constructor:t,getTypeName:function(){return"FieldDefinitionArray"}});for(const e of Reflect.ownKeys(t.prototype))Object.defineProperty(t.prototype,e,{enumerable:!1});return t}),define("x_ite/Base/FieldArray",["x_ite/Base/X3DInfoArray"],function(e){"use strict";function t(){return e.call(this)}t.prototype=Object.assign(Object.create(e.prototype),{constructor:t,getTypeName:function(){return"FieldArray"}});for(const e of Reflect.ownKeys(t.prototype))Object.defineProperty(t.prototype,e,{enumerable:!1});return t}),define("x_ite/Base/X3DField",["jquery","x_ite/Base/X3DChildObject","x_ite/Base/X3DConstants","x_ite/Base/Events","standard/Utility/MapUtilities"],function(e,t,i,n,r){"use strict";function o(e){return t.call(this),this[s]=e,this}const s=Symbol(),a=Symbol(),u=Symbol(),l=Symbol(),c=Symbol(),h=Symbol(),d=Symbol(),p=Symbol(),f=Symbol(),g=Symbol(),m=Symbol.for("X3DField.uniformLocation");o.prototype=Object.assign(Object.create(t.prototype),{constructor:o,[s]:null,[a]:i.initializeOnly,[u]:null,[m]:null,[l]:new Set,[c]:new Map,[h]:new Set,[d]:new Map,[p]:new Set,[f]:new Set,[g]:new Map,equals:function(e){return this[s]===e.valueOf()},assign:function(e){this.set(e.getValue()),this.addEvent()},set:function(e){this[s]=e},setValue:function(e){this.set(e instanceof this.constructor?e.getValue():e),this.addEvent()},getValue:function(){return this[s]},setAccessType:function(e){this[a]=e},getAccessType:function(){return this[a]},isInitializable:function(){return this[a]&i.initializeOnly},isInput:function(){return this[a]&i.inputOnly},isOutput:function(){return this[a]&i.outputOnly},isReadable:function(){return this[a]!==i.inputOnly},isWritable:function(){return this[a]!==i.initializeOnly},setUnit:function(e){this[u]=e},getUnit:function(){return this[u]},hasReferences:function(){return 0!==this[l].size},isReference:function(e){return e===this[a]||e===i.inputOutput},addReference:function(e){const t=this.getReferences();if(!t.has(e)){switch(t.add(e),this.getAccessType()&e.getAccessType()){case i.initializeOnly:e.addFieldInterest(this),this.set(e.getValue(),e.length);break;case i.inputOnly:e.addFieldInterest(this);break;case i.outputOnly:this.addFieldInterest(e);break;case i.inputOutput:e.addFieldInterest(this),this.addFieldInterest(e),this.set(e.getValue(),e.length)}this.processReferencesCallbacks()}},removeReference:function(e){switch(this.getReferences().delete(e),this.getAccessType()&e.getAccessType()){case i.initializeOnly:e.removeFieldInterest(this);break;case i.inputOnly:e.removeFieldInterest(this);break;case i.outputOnly:this.removeFieldInterest(e);break;case i.inputOutput:e.removeFieldInterest(this),this.removeFieldInterest(e)}this.processReferencesCallbacks()},getReferences:function(){return this[l]===o.prototype[l]&&(this[l]=new Set),this[l]},addReferencesCallback:function(e,t){this[c]===o.prototype[c]&&(this[c]=new Map),this[c].set(e,t)},removeReferencesCallback:function(e){this[c].delete(e)},getReferencesCallbacks:function(){return this[c]},processReferencesCallbacks:function(){const e=[];return function(){if(this[c].size)for(const t of r.values(e,this[c]))t()}}(),addFieldInterest:function(e){this[h]===o.prototype[h]&&(this[h]=new Set),this[h].add(e)},removeFieldInterest:function(e){this[h].delete(e)},getFieldInterests:function(){return this[h]},addFieldCallback:function(e,t){this[d]===o.prototype[d]&&(this[d]=new Map),this[d].set(e,t)},removeFieldCallback:function(e){this[d].delete(e)},getFieldCallbacks:function(){return this[d]},addInputRoute:function(e){this[p]===o.prototype[p]&&(this[p]=new Set),this[p].add(e),this.processRouteCallbacks()},removeInputRoute:function(e){this[p].delete(e),this.processRouteCallbacks()},getInputRoutes:function(){return this[p]},addOutputRoute:function(e){this[f]===o.prototype[f]&&(this[f]=new Set),this[f].add(e),this.processRouteCallbacks()},removeOutputRoute:function(e){this[f].delete(e),this.processRouteCallbacks()},getOutputRoutes:function(){return this[f]},addRouteCallback:function(e,t){this[g]===o.prototype[g]&&(this[g]=new Map),this[g].set(e,t)},removeRouteCallback:function(e){this[g].delete(e)},getRouteCallbacks:function(){return this[g]},processRouteCallbacks:function(){const e=[];return function(){if(this[g].size)for(const t of r.values(e,this[g]))t()}}(),processEvent:function(){const e=[];return function(t){if(!t.has(this)){t.add(this),this.setTainted(!1);const i=t.field;i!==this&&this.set(i.getValue(),i.length),this.processInterests();let o=!0;if(this[h].size)for(const e of this[h].values())o?(o=!1,e.addEventObject(this,t)):e.addEventObject(this,n.copy(t));if(o&&n.push(t),this[d].size)for(const t of r.values(e,this[d]))t(this.valueOf())}}}(),addCloneCount:Function.prototype,removeCloneCount:Function.prototype,valueOf:function(){return this},fromString:function(e,t){const i=require("x_ite/Parser/Parser"),n=new i(t);if(n.setUnits(!!t),n.setInput(e),!n.fieldValue(this))throw new Error("Couldn't read value for field '"+this.getName()+"'.")},dispose:function(){for(const e of new Set(this[p]))e.dispose();for(const e of new Set(this[f]))e.dispose();t.prototype.dispose.call(this)}});for(const e of Reflect.ownKeys(o.prototype))Object.defineProperty(o.prototype,e,{enumerable:!1});return o}),define("x_ite/Fields/SFBool",["x_ite/Base/X3DField","x_ite/Base/X3DConstants"],function(e,t){"use strict";function i(t){return e.call(this,!!t)}i.prototype=Object.assign(Object.create(e.prototype),{constructor:i,copy:function(){return new i(this.getValue())},isDefaultValue:function(){return this.getValue()===!1},set:function(t){e.prototype.set.call(this,!!t)},getTypeName:function(){return"SFBool"},getType:function(){return t.SFBool},valueOf:function(){return this.getValue()},toStream:function(e){e.string+=this.getValue()?"TRUE":"FALSE"},toVRMLStream:function(e){this.toStream(e)},toXMLStream:function(e){e.string+=this.getValue()?"true":"false"}});for(const e of Reflect.ownKeys(i.prototype))Object.defineProperty(i.prototype,e,{enumerable:!1});return i}),define("standard/Math/Algorithm",[],function(){"use strict";function e(){}return e.prototype={constructor:e,radians:function(e){return e*(Math.PI/180)},degrees:function(e){return e*(180/Math.PI)},random:function(e,t){return e+Math.random()*(t-e)},fract:function(e){return e>0?e-Math.floor(e):e-Math.ceil(e)},clamp:function(e,t,i){return Math.min(Math.max(e,t),i)},interval:function(e,t,i){return e>=i?(e-t)%(i-t)+t:e<t?(e-i)%(i-t)+i:e},lerp:function(e,t,i){return e+i*(t-e)},slerp:function(e,t,i){let n=e.dot(t);if(n<=-1)throw new Error("slerp is not possible: vectors are inverse collinear.");if(n>=1)return e;n<0&&(n=-n,t.negate());const r=Math.acos(n),o=Math.sin(r),s=Math.sin((1-i)*r)/o,a=Math.sin(i*r)/o;return e.x=e.x*s+t.x*a,e.y=e.y*s+t.y*a,e.z=e.z*s+t.z*a,e.w=e.w*s+t.w*a,e},simpleSlerp:function(e,t,i){const n=e.dot(t);if(n<=-1)throw new Error("slerp is not possible: vectors are inverse collinear.")
;if(n>=1)return e;const r=Math.acos(n),o=Math.sin(r),s=Math.sin((1-i)*r)/o,a=Math.sin(i*r)/o;return e.x=e.x*s+t.x*a,e.y=e.y*s+t.y*a,e.z=e.z*s+t.z*a,e.w=e.w*s+t.w*a,e},isPowerOfTwo:function(e){return 0==(e-1&e)},nextPowerOfTwo:function(e){return this.isPowerOfTwo(e)?e:1<<32-Math.clz32(e)},cmp:function(e,t){return e>t?1:e<t?-1:0},less:function(e,t){return e<t},greater:function(e,t){return e>t},lowerBound:function(e,t,i,n,r){let o=0,s=0,a=i-t;for(;a>0;)s=a>>>1,o=t+s,r(e[o],n)?(t=++o,a-=s+1):a=s;return t},upperBound:function(e,t,i,n,r){let o=0,s=0,a=i-t;for(;a>0;)s=a>>>1,o=t+s,r(n,e[o])?a=s:(t=++o,a-=s+1);return t},set_difference:function(e,t,i){for(const n of e)t.has(n)||i.add(n);return i},map_difference:function(e,t,i){for(const[n,r]of e)t.has(n)||i.set(n,r);return i}},new e}),define("standard/Math/Numbers/Color3",["standard/Math/Algorithm"],function(e){"use strict";function t(e,t,n){arguments.length?(this.r_=i(e,0,1),this.g_=i(t,0,1),this.b_=i(n,0,1)):(this.r_=0,this.g_=0,this.b_=0)}const i=e.clamp;t.prototype={constructor:t,length:3,copy:function(){const e=Object.create(t.prototype);return e.r_=this.r_,e.g_=this.g_,e.b_=this.b_,e},assign:function(e){this.r_=e.r_,this.g_=e.g_,this.b_=e.b_},set:function(e,t,n){this.r_=i(e,0,1),this.g_=i(t,0,1),this.b_=i(n,0,1)},equals:function(e){return this.r_===e.r_&&this.g_===e.g_&&this.b_===e.b_},getHSV:function(e){let t,i,n;const r=Math.min(this.r_,this.g_,this.b_),o=Math.max(this.r_,this.g_,this.b_);n=o;const s=o-r;return 0!==o&&0!==s?(i=s/o,t=this.r_===o?(this.g_-this.b_)/s:this.g_===o?2+(this.b_-this.r_)/s:4+(this.r_-this.g_)/s,(t*=Math.PI/3)<0&&(t+=2*Math.PI)):i=t=0,e[0]=t,e[1]=i,e[2]=n,e},setHSV:function(t,n,r){if(n=i(n,0,1),r=i(r,0,1),0===n)this.r_=this.g_=this.b_=r;else{const i=e.degrees(e.interval(t,0,2*Math.PI))/60,o=Math.floor(i),s=i-o,a=r*(1-n),u=r*(1-n*s),l=r*(1-n*(1-s));switch(o%6){case 0:this.r_=r,this.g_=l,this.b_=a;break;case 1:this.r_=u,this.g_=r,this.b_=a;break;case 2:this.r_=a,this.g_=r,this.b_=l;break;case 3:this.r_=a,this.g_=u,this.b_=r;break;case 4:this.r_=l,this.g_=a,this.b_=r;break;default:this.r_=r,this.g_=a,this.b_=u}}},toString:function(){return this.r_+" "+this.g_+" "+this.b_}};const n={get:function(){return this.r_},set:function(e){this.r_=i(e,0,1)},enumerable:!0,configurable:!1},r={get:function(){return this.g_},set:function(e){this.g_=i(e,0,1)},enumerable:!0,configurable:!1},o={get:function(){return this.b_},set:function(e){this.b_=i(e,0,1)},enumerable:!0,configurable:!1};return Object.defineProperty(t.prototype,"r",n),Object.defineProperty(t.prototype,"g",r),Object.defineProperty(t.prototype,"b",o),n.enumerable=!1,r.enumerable=!1,o.enumerable=!1,Object.defineProperty(t.prototype,"0",n),Object.defineProperty(t.prototype,"1",r),Object.defineProperty(t.prototype,"2",o),Object.assign(t,{HSV:function(e,t,i){const n=Object.create(this.prototype);return n.setHSV(e,t,i),n},lerp:function(e,t,i,n){let r=e[0],o=t[0];const s=e[1],a=t[1],u=e[2],l=t[2];0===s&&(r=o),0===a&&(o=r);const c=Math.abs(o-r);if(c<=Math.PI)return n[0]=r+i*(o-r),n[1]=s+i*(a-s),n[2]=u+i*(l-u),n;const h=2*Math.PI,d=(h-c)*i;let p=r<o?r-d:r+d;return p<0?p+=h:p>h&&(p-=h),n[0]=p,n[1]=s+i*(a-s),n[2]=u+i*(l-u),n}}),t}),define("x_ite/Fields/SFColor",["standard/Math/Numbers/Color3","x_ite/Base/X3DField","x_ite/Base/X3DConstants","x_ite/InputOutput/Generator"],function(e,t,i,n){"use strict";function r(i,n,r){switch(arguments.length){case 0:return t.call(this,new e);case 1:return t.call(this,arguments[0]);case 3:return t.call(this,new e(+i,+n,+r))}throw new Error("Invalid arguments.")}r.prototype=Object.assign(Object.create(t.prototype),{constructor:r,copy:function(){return new r(this.getValue().copy())},getTypeName:function(){return"SFColor"},getType:function(){return i.SFColor},equals:function(e){return this.getValue().equals(e.getValue())},isDefaultValue:function(){return 0===this.getValue().r&&0===this.getValue().g&&0===this.getValue().b},set:function(e){this.getValue().assign(e)},getHSV:function(){return this.getValue().getHSV([])},setHSV:function(e,t,i){this.getValue().setHSV(e,t,i),this.addEvent()},lerp:function(){const t=[],i=[],n=[];return function(o,s){const a=new r;return this.getValue().getHSV(t),o.getValue().getHSV(i),e.lerp(t,i,s,n),a.setHSV(n[0],n[1],n[2],n[3]),a}}(),toStream:function(e){const t=n.Get(e),i=this.getValue(),r=i.length-1;for(let n=0;n<r;++n)e.string+=t.Precision(i[n]),e.string+=" ";e.string+=t.Precision(i[r])},toVRMLStream:function(e){this.toStream(e)},toXMLStream:function(e){this.toStream(e)}});for(const e of Reflect.ownKeys(r.prototype))Object.defineProperty(r.prototype,e,{enumerable:!1});const o={get:function(){return this.getValue().r},set:function(e){this.getValue().r=+e,this.addEvent()},enumerable:!0,configurable:!1},s={get:function(){return this.getValue().g},set:function(e){this.getValue().g=+e,this.addEvent()},enumerable:!0,configurable:!1},a={get:function(){return this.getValue().b},set:function(e){this.getValue().b=+e,this.addEvent()},enumerable:!0,configurable:!1};return Object.defineProperty(r.prototype,"r",o),Object.defineProperty(r.prototype,"g",s),Object.defineProperty(r.prototype,"b",a),o.enumerable=!1,s.enumerable=!1,a.enumerable=!1,Object.defineProperty(r.prototype,"0",o),Object.defineProperty(r.prototype,"1",s),Object.defineProperty(r.prototype,"2",a),r}),define("standard/Math/Numbers/Color4",["standard/Math/Numbers/Color3","standard/Math/Algorithm"],function(e,t){"use strict";function i(e,t,i,r){arguments.length?(this.r_=n(e,0,1),this.g_=n(t,0,1),this.b_=n(i,0,1),this.a_=n(r,0,1)):(this.r_=0,this.g_=0,this.b_=0,this.a_=0)}const n=t.clamp;i.prototype={constructor:i,length:4,copy:function(){const e=Object.create(i.prototype);return e.r_=this.r_,e.g_=this.g_,e.b_=this.b_,e.a_=this.a_,e},assign:function(e){this.r_=e.r_,this.g_=e.g_,this.b_=e.b_,this.a_=e.a_},set:function(e,t,i,r){this.r_=n(e,0,1),this.g_=n(t,0,1),this.b_=n(i,0,1),this.a_=n(r,0,1)},equals:function(e){return this.r_===e.r_&&this.g_===e.g_&&this.b_===e.b_&&this.a_===e.a_},getHSVA:function(t){return e.prototype.getHSV.call(this,t),t[3]=this.a_,t},setHSVA:function(t,i,r,o){e.prototype.setHSV.call(this,t,i,r),this.a_=n(o,0,1)},toString:function(){return this.r_+" "+this.g_+" "+this.b_+" "+this.a_}};const r={get:function(){return this.r_},set:function(e){this.r_=n(e,0,1)},enumerable:!0,configurable:!1},o={get:function(){return this.g_},set:function(e){this.g_=n(e,0,1)},enumerable:!0,configurable:!1},s={get:function(){return this.b_},set:function(e){this.b_=n(e,0,1)},enumerable:!0,configurable:!1},a={get:function(){return this.a_},set:function(e){this.a_=n(e,0,1)},enumerable:!0,configurable:!1};return Object.defineProperty(i.prototype,"r",r),Object.defineProperty(i.prototype,"g",o),Object.defineProperty(i.prototype,"b",s),Object.defineProperty(i.prototype,"a",a),r.enumerable=!1,o.enumerable=!1,s.enumerable=!1,a.enumerable=!1,Object.defineProperty(i.prototype,"0",r),Object.defineProperty(i.prototype,"1",o),Object.defineProperty(i.prototype,"2",s),Object.defineProperty(i.prototype,"3",a),Object.assign(i,{HSVA:function(e,t,i,n){const r=Object.create(this.prototype);return r.setHSVA(e,t,i,n),r},lerp:function(t,i,n,r){const o=t[3];return e.lerp(t,i,n,r),r[3]=o+n*(i[3]-o),r}}),i}),define("x_ite/Fields/SFColorRGBA",["x_ite/Base/X3DField","x_ite/Fields/SFColor","x_ite/Base/X3DConstants","standard/Math/Numbers/Color4"],function(e,t,i,n){"use strict";function r(t,i,r,o){switch(arguments.length){case 0:return e.call(this,new n);case 1:return e.call(this,arguments[0]);case 4:return e.call(this,new n(+t,+i,+r,+o))}throw new Error("Invalid arguments.")}r.prototype=Object.assign(Object.create(e.prototype),{constructor:r,copy:function(){return new r(this.getValue().copy())},getTypeName:function(){return"SFColorRGBA"},getType:function(){return i.SFColorRGBA},equals:t.prototype.equals,isDefaultValue:function(){return 0===this.getValue().r&&0===this.getValue().g&&0===this.getValue().b&&0===this.getValue().a},set:t.prototype.set,getHSVA:function(){return this.getValue().getHSVA([])},setHSVA:function(e,t,i,n){this.getValue().setHSVA(e,t,i,n),this.addEvent()},lerp:function(){const e=[],t=[],i=[];return function(o,s){const a=new r;return this.getValue().getHSVA(e),o.getValue().getHSVA(t),n.lerp(e,t,s,i),a.setHSVA(i[0],i[1],i[2],i[3]),a}}(),toStream:t.prototype.toStream,toVRMLStream:t.prototype.toVRMLStream,toXMLStream:t.prototype.toXMLStream});for(const e of Reflect.ownKeys(r.prototype))Object.defineProperty(r.prototype,e,{enumerable:!1});const o={get:function(){return this.getValue().r},set:function(e){this.getValue().r=+e,this.addEvent()},enumerable:!0,configurable:!1},s={get:function(){return this.getValue().g},set:function(e){this.getValue().g=+e,this.addEvent()},enumerable:!0,configurable:!1},a={get:function(){return this.getValue().b},set:function(e){this.getValue().b=+e,this.addEvent()},enumerable:!0,configurable:!1},u={get:function(){return this.getValue().a},set:function(e){this.getValue().a=+e,this.addEvent()},enumerable:!0,configurable:!1};return Object.defineProperty(r.prototype,"r",o),Object.defineProperty(r.prototype,"g",s),Object.defineProperty(r.prototype,"b",a),Object.defineProperty(r.prototype,"a",u),o.enumerable=!1,s.enumerable=!1,a.enumerable=!1,u.enumerable=!1,Object.defineProperty(r.prototype,"0",o),Object.defineProperty(r.prototype,"1",s),Object.defineProperty(r.prototype,"2",a),Object.defineProperty(r.prototype,"3",u),r}),define("x_ite/Fields/SFDouble",["x_ite/Base/X3DField","x_ite/Base/X3DConstants","x_ite/InputOutput/Generator"],function(e,t,i){"use strict";function n(t){return e.call(this,arguments.length?+t:0)}n.prototype=Object.assign(Object.create(e.prototype),{constructor:n,copy:function(){return new n(this.getValue())},getTypeName:function(){return"SFDouble"},getType:function(){return t.SFDouble},isDefaultValue:function(){return 0===this.getValue()},set:function(t){e.prototype.set.call(this,+t)},valueOf:e.prototype.getValue,toStream:function(e){const t=i.Get(e),n=t.Unit(this.getUnit());e.string+=t.DoublePrecision(t.ToUnit(n,this.getValue()))},toVRMLStream:function(e){this.toStream(e)},toXMLStream:function(e){this.toStream(e)}});for(const e of Reflect.ownKeys(n.prototype))Object.defineProperty(n.prototype,e,{enumerable:!1});return n}),define("x_ite/Fields/SFFloat",["x_ite/Base/X3DField","x_ite/Base/X3DConstants","x_ite/InputOutput/Generator"],function(e,t,i){"use strict";function n(t){return e.call(this,arguments.length?+t:0)}n.prototype=Object.assign(Object.create(e.prototype),{constructor:n,copy:function(){return new n(this.getValue())},getTypeName:function(){return"SFFloat"},getType:function(){return t.SFFloat},isDefaultValue:function(){return 0===this.getValue()},set:function(t){e.prototype.set.call(this,+t)},valueOf:e.prototype.getValue,toStream:function(e){const t=i.Get(e),n=t.Unit(this.getUnit());e.string+=t.Precision(t.ToUnit(n,this.getValue()))},toVRMLStream:function(e){this.toStream(e)},toXMLStream:function(e){this.toStream(e)}});for(const e of Reflect.ownKeys(n.prototype))Object.defineProperty(n.prototype,e,{enumerable:!1});return n}),define("x_ite/Fields/SFInt32",["x_ite/Base/X3DField","x_ite/Base/X3DConstants"],function(e,t){"use strict";function i(t){return e.call(this,~~t)}i.prototype=Object.assign(Object.create(e.prototype),{constructor:i,copy:function(){return new i(this.getValue())},getTypeName:function(){return"SFInt32"},getType:function(){return t.SFInt32},isDefaultValue:function(){return 0===this.getValue()},set:function(t){e.prototype.set.call(this,~~t)},valueOf:e.prototype.getValue,toStream:function(e,t){e.string+=this.getValue().toString(t)},toVRMLStream:function(e){this.toStream(e)},toXMLStream:function(e){e.string+=this.getValue().toString()}});for(const e of Reflect.ownKeys(i.prototype))Object.defineProperty(i.prototype,e,{enumerable:!1});return i}),define("x_ite/Fields/SFImage",["x_ite/Base/X3DField","x_ite/Fields/SFInt32","x_ite/Base/X3DConstants"],function(e,t,i){"use strict";function n(e,t,i,n){const r=require("x_ite/Fields/ArrayFields").MFInt32;this.width=~~e,this.height=~~t,this.comp=~~i,this.array=new r,this.array.setValue(n),this.array.length=this.width*this.height}function r(t,i,r,o){const s=require("x_ite/Fields/ArrayFields").MFInt32;return arguments[0]instanceof n?e.call(this,arguments[0]):4===arguments.length?e.call(this,new n(t,i,r,o)):e.call(this,new n(0,0,0,new s)),this.getValue().getArray().addParent(this),this.addInterest("set_size__",this),this}n.prototype={constructor:n,copy:function(){return new n(this.width,this.height,this.comp,this.array)},equals:function(e){return this.width===e.width&&this.height===e.height&&this.comp===e.comp&&this.array.equals(e.array)},assign:function(e){this.width=e.width,this.height=e.height,this.comp=e.comp,this.array.assign(e.array)},set:function(e,t,i,n){this.width=~~e,this.height=~~t,this.comp=~~i,this.array.assign(n)},setWidth:function(e){this.width=~~e,this.array.length=this.width*this.height},getWidth:function(){return this.width},setHeight:function(e){this.height=~~e,this.array.length=this.width*this.height},getHeight:function(){return this.height},setComp:function(e){this.comp=~~e},getComp:function(){return this.comp},setArray:function(e){this.array.assign(e),this.array.length=this.width*this.height},getArray:function(){return this.array}},r.prototype=Object.assign(Object.create(e.prototype),{constructor:r,set_size__:function(){this.getValue().getArray().length=this.width*this.height},copy:function(){return new r(this.getValue().copy())},equals:function(e){return this.getValue().equals(e.getValue())},isDefaultValue:function(){return 0===this.width&&0===this.height&&0===this.comp},set:function(e){this.getValue().assign(e)},getTypeName:function(){return"SFImage"},getType:function(){return i.SFImage},toStream:function(e){const i=this.array,n=new t;e.string+=this.width+" "+this.height+" "+this.comp;for(let t=0,r=this.width*this.height;t<r;++t)e.string+=" 0x",n.set(i[t]),n.toXMLStream(e)},toVRMLStream:function(e){this.toStream(e)},toXMLStream:function(e){this.toStream(e)}});for(const e of Reflect.ownKeys(r.prototype))Object.defineProperty(r.prototype,e,{enumerable:!1});const o={get:function(){return this.getValue().getWidth()},set:function(e){this.getValue().setWidth(e),this.addEvent()},enumerable:!0,configurable:!1},s={get:function(){return this.getValue().getHeight()},set:function(e){this.getValue().setHeight(e),this.addEvent()},enumerable:!0,configurable:!1},a={get:function(){return this.getValue().getComp()},set:function(e){this.getValue().setComp(e),this.addEvent()},enumerable:!0,configurable:!1},u={get:function(){return this.getValue().getArray()},set:function(e){this.getValue().setArray(e),this.addEvent()},enumerable:!0,configurable:!1};return Object.defineProperty(r.prototype,"width",o),Object.defineProperty(r.prototype,"height",s),Object.defineProperty(r.prototype,"comp",a),Object.defineProperty(r.prototype,"array",u),o.enumerable=!1,s.enumerable=!1,Object.defineProperty(r.prototype,"x",o),Object.defineProperty(r.prototype,"y",s),r}),define("x_ite/Fields/SFMatrixPrototypeTemplate",["x_ite/Base/X3DField"],function(e){"use strict";return function(t,i,n){return Object.assign(Object.create(e.prototype),{copy:function(){return new this.constructor(this.getValue().copy())},equals:function(e){return this.getValue().equals(e.getValue())},isDefaultValue:function(){return this.getValue().equals(t.Identity)},set:function(e){this.getValue().assign(e)},setTransform:function(e,t,i,n,r){e=e?e.getValue():null,t=t?t.getValue():null,i=i?i.getValue():null,n=n?n.getValue():null,r=r?r.getValue():null,this.getValue().set(e,t,i,n,r)},getTransform:function(e,t,i,n,r){e=e?e.getValue():null,t=t?t.getValue():null,i=i?i.getValue():null,n=n?n.getValue():null,r=r?r.getValue():null,this.getValue().get(e,t,i,n,r)},determinant:function(){return this.getValue().determinant()},transpose:function(){return new this.constructor(t.transpose(this.getValue()))},inverse:function(){return new this.constructor(t.inverse(this.getValue()))},multLeft:function(e){return new this.constructor(t.multLeft(this.getValue(),e.getValue()))},multRight:function(e){return new this.constructor(t.multRight(this.getValue(),e.getValue()))},multVecMatrix:function(e){return new i(this.getValue().multVecMatrix(e.getValue().copy()))},multMatrixVec:function(e){return new i(this.getValue().multMatrixVec(e.getValue().copy()))},multDirMatrix:function(e){return new i(this.getValue().multDirMatrix(e.getValue().copy()))},multMatrixDir:function(e){return new i(this.getValue().multMatrixDir(e.getValue().copy()))},toStream:function(e){const t=Generator.Get(e),i=this.getValue(),r=i.length-1;for(let o=0;o<r;++o)e.string+=n?t.DoublePrecision(i[o]):t.Precision(i[o]),e.string+=" ";e.string+=n?t.DoublePrecision(i[r]):t.Precision(i[r])},toVRMLStream:function(e){this.toStream(e)},toXMLStream:function(e){this.toStream(e)}})}}),define("x_ite/Fields/SFVecPrototypeTemplate",["x_ite/Base/X3DField","x_ite/InputOutput/Generator"],function(e,t){"use strict";return function(i,n){return Object.assign(Object.create(e.prototype),{copy:function(){return new this.constructor(this.getValue().copy())},equals:function(e){return this.getValue().equals(e.getValue())},isDefaultValue:function(){return this.getValue().equals(i.Zero)},set:function(e){this.getValue().assign(e)},add:function(e){return new this.constructor(i.add(this.getValue(),e.getValue()))},distance:function(e){return this.getValue().distance(e.getValue())},divide:function(e){return new this.constructor(i.divide(this.getValue(),e))},divVec:function(e){return new this.constructor(i.divVec(this.getValue(),e.getValue()))},dot:function(e){return this.getValue().dot(e.getValue())},length:function(){return this.getValue().abs()},lerp:function(e,t){return new this.constructor(i.lerp(this.getValue(),e,t))},multiply:function(e){return new this.constructor(i.multiply(this.getValue(),e))},multVec:function(e){return new this.constructor(i.multVec(this.getValue(),e.getValue()))},negate:function(){return new this.constructor(i.negate(this.getValue().copy()))},normalize:function(e){return new this.constructor(i.normalize(this.getValue()))},subtract:function(e){return new this.constructor(i.subtract(this.getValue(),e.getValue()))},toStream:function(e){const i=t.Get(e),r=this.getValue(),o=i.Unit(this.getUnit()),s=r.length-1;for(let t=0;t<s;++t)e.string+=n?i.DoublePrecision(i.ToUnit(o,r[t])):i.Precision(i.ToUnit(o,r[t])),e.string+=" ";e.string+=n?i.DoublePrecision(i.ToUnit(o,r[s])):i.Precision(i.ToUnit(o,r[s]))},toVRMLStream:function(e){this.toStream(e)},toXMLStream:function(e){this.toStream(e)}})}}),define("standard/Math/Numbers/Vector2",["standard/Math/Algorithm"],function(e){"use strict";function t(e,t){this.x=e,this.y=t}return t.prototype={constructor:t,length:2,copy:function(){const e=Object.create(t.prototype);return e.x=this.x,e.y=this.y,e},assign:function(e){return this.x=e.x,this.y=e.y,this},set:function(e,t){return this.x=e,this.y=t,this},equals:function(e){return this.x===e.x&&this.y===e.y},negate:function(){return this.x=-this.x,this.y=-this.y,this},add:function(e){return this.x+=e.x,this.y+=e.y,this},subtract:function(e){return this.x-=e.x,this.y-=e.y,this},multiply:function(e){return this.x*=e,this.y*=e,this},multVec:function(e){return this.x*=e.x,this.y*=e.y,this},divide:function(e){return this.x/=e,this.y/=e,this},divVec:function(e){return this.x/=e.x,this.y/=e.y,this},normalize:function(){let e=Math.hypot(this.x,this.y);return e&&(e=1/e,this.x*=e,this.y*=e),this},dot:function(e){return this.x*e.x+this.y*e.y},norm:function(){const e=this.x,t=this.y;return e*e+t*t},abs:function(){return Math.hypot(this.x,this.y)},distance:function(e){return Math.hypot(this.x-e.x,this.y-e.y)},lerp:function(e,t){const i=this.x,n=this.y;return this.x=i+t*(e.x-i),this.y=n+t*(e.y-n),this},min:function(e){let t=this.x,i=this.y;for(const e of arguments)t=Math.min(t,e.x),i=Math.min(i,e.y);return this.x=t,this.y=i,this},max:function(e){let t=this.x,i=this.y;for(const e of arguments)t=Math.max(t,e.x),i=Math.max(i,e.y);return this.x=t,this.y=i,this},toString:function(){return this.x+" "+this.y}},Object.defineProperty(t.prototype,"0",{get:function(){return this.x},set:function(e){this.x=e},enumerable:!1,configurable:!1}),Object.defineProperty(t.prototype,"1",{get:function(){return this.y},set:function(e){this.y=e},enumerable:!1,configurable:!1}),Object.assign(t,{Zero:new t(0,0),One:new t(1,1),negate:function(e){return e.copy().negate()},add:function(e,t){return e.copy().add(t)},subtract:function(e,t){return e.copy().subtract(t)},multiply:function(e,t){return e.copy().multiply(t)},multVec:function(e,t){return e.copy().multVec(t)},divide:function(e,t){return e.copy().divide(t)},divVec:function(e,t){return e.copy().divVec(t)},normalize:function(e){return e.copy().normalize()},dot:function(e,t){return e.copy().dot(t)},lerp:function(e,t,i){return e.copy().lerp(t,i)},min:function(e,i){return t.prototype.min.apply(e.copy(),arguments)},max:function(e,i){return t.prototype.max.apply(e.copy(),arguments)}}),t}),define("x_ite/Fields/SFVec2",["x_ite/Base/X3DField","x_ite/Fields/SFVecPrototypeTemplate","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector2"],function(e,t,i,n){"use strict";function r(i,r,o){function s(t,i){switch(arguments.length){case 0:return e.call(this,new n(0,0));case 1:return e.call(this,arguments[0]);case 2:return e.call(this,new n(+t,+i))}throw new Error("Invalid arguments.")}s.prototype=Object.assign(Object.create(e.prototype),t(n,o),{constructor:s,getTypeName:function(){return i},getType:function(){return r}});for(const e of Reflect.ownKeys(s.prototype))Object.defineProperty(s.prototype,e,{enumerable:!1});const a={get:function(){return this.getValue().x},set:function(e){this.getValue().x=+e,this.addEvent()},enumerable:!0,configurable:!1},u={get:function(){return this.getValue().y},set:function(e){this.getValue().y=+e,this.addEvent()},enumerable:!0,configurable:!1};return Object.defineProperty(s.prototype,"x",a),Object.defineProperty(s.prototype,"y",u),a.enumerable=!1,u.enumerable=!1,Object.defineProperty(s.prototype,"0",a),Object.defineProperty(s.prototype,"1",u),s}return{SFVec2d:r("SFVec2d",i.SFVec2d,!0),SFVec2f:r("SFVec2f",i.SFVec2f,!1)}}),define("standard/Math/Numbers/Vector3",["standard/Math/Algorithm"],function(e){"use strict";function t(e,t,i){this.x=e,this.y=t,this.z=i}return t.prototype={constructor:t,length:3,copy:function(){const e=Object.create(t.prototype);return e.x=this.x,e.y=this.y,e.z=this.z,e},assign:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},set:function(e,t,i){return this.x=e,this.y=t,this.z=i,this},equals:function(e){return this.x===e.x&&this.y===e.y&&this.z===e.z},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},add:function(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this},subtract:function(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this},multiply:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multVec:function(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this},divide:function(e){return this.x/=e,this.y/=e,this.z/=e,this},divVec:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},cross:function(e){const t=this.x,i=this.y,n=this.z;return this.x=i*e.z-n*e.y,this.y=n*e.x-t*e.z,this.z=t*e.y-i*e.x,this},normalize:function(){let e=Math.hypot(this.x,this.y,this.z);return e&&(e=1/e,this.x*=e,this.y*=e,this.z*=e),this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},norm:function(){let e=this.x,t=this.y,i=this.z;return e*e+t*t+i*i},abs:function(){return Math.hypot(this.x,this.y,this.z)},distance:function(e){return Math.hypot(this.x-e.x,this.y-e.y,this.z-e.z)},lerp:function(e,t){const i=this.x,n=this.y,r=this.z;return this.x=i+t*(e.x-i),this.y=n+t*(e.y-n),this.z=r+t*(e.z-r),this},slerp:function(){const i=new t(0,0,0);return function(t,n){return e.simpleSlerp(this,i.assign(t),n)}}(),min:function(e){let t=this.x,i=this.y,n=this.z;for(const e of arguments)t=Math.min(t,e.x),i=Math.min(i,e.y),n=Math.min(n,e.z);return this.x=t,this.y=i,this.z=n,this},max:function(e){let t=this.x,i=this.y,n=this.z;for(const e of arguments)t=Math.max(t,e.x),i=Math.max(i,e.y),n=Math.max(n,e.z);return this.x=t,this.y=i,this.z=n,this},toString:function(){return this.x+" "+this.y+" "+this.z}},Object.defineProperty(t.prototype,"0",{get:function(){return this.x},set:function(e){this.x=e},enumerable:!1,configurable:!1}),Object.defineProperty(t.prototype,"1",{get:function(){return this.y},set:function(e){this.y=e},enumerable:!1,configurable:!1}),Object.defineProperty(t.prototype,"2",{get:function(){return this.z},set:function(e){this.z=e},enumerable:!1,configurable:!1}),Object.assign(t,{Zero:new t(0,0,0),One:new t(1,1,1),xAxis:new t(1,0,0),yAxis:new t(0,1,0),zAxis:new t(0,0,1),negate:function(e){return e.copy().negate()},add:function(e,t){return e.copy().add(t)},subtract:function(e,t){return e.copy().subtract(t)},multiply:function(e,t){return e.copy().multiply(t)},multVec:function(e,t){return e.copy().multVec(t)},divide:function(e,t){return e.copy().divide(t)},divVec:function(e,t){return e.copy().divVec(t)},cross:function(e,t){return e.copy().cross(t)},normalize:function(e){return e.copy().normalize()},dot:function(e,t){return e.copy().dot(t)},lerp:function(e,t,i){return e.copy().lerp(t,i)},slerp:function(e,t,i){return e.copy().slerp(t,i)},min:function(e,i){return t.prototype.min.apply(e.copy(),arguments)},max:function(e,i){return t.prototype.max.apply(e.copy(),arguments)}}),t}),define("standard/Math/Numbers/Matrix2",["standard/Math/Numbers/Vector2","standard/Math/Algorithm"],function(e,t){"use strict";function i(){arguments.length?(this[0]=arguments[0],this[1]=arguments[1],this[2]=arguments[2],this[3]=arguments[3]):this.identity()}return i.prototype={constructor:i,order:2,length:4,copy:function(){const e=Object.create(i.prototype);return e[0]=this[0],e[1]=this[1],e[2]=this[2],e[3]=this[3],e},assign:function(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this},equals:function(e){return this[0]===e[0]&&this[1]===e[1]&&this[2]===e[2]&&this[3]===e[3]},set1:function(e,t,i){this[e*this.order+t]=i},get1:function(e,t){return this[e*this.order+t]},set:function(){switch(arguments.length){case 0:this.identity();break;case 4:this[0]=arguments[0],this[1]=arguments[1],this[2]=arguments[2],this[3]=arguments[3]}},determinant1:function(){return this[0]},determinant:function(){return this[0]*this[3]-this[1]*this[2]},transpose:function(){const e=this[1];return this[1]=this[2],this[2]=e,this},inverse:function(){const e=this[0],t=this[1],i=this[2],n=this[3],r=e*n-t*i;if(0===r)throw new Error("Matrix2 .inverse: determinant is 0.");return this[0]=n/r,this[1]=-t/r,this[2]=-i/r,this[3]=e/r,this},multLeft:function(e){const t=this[0],i=this[1],n=this[2],r=this[3],o=e[0],s=e[1],a=e[2],u=e[3];return this[0]=t*o+n*s,this[1]=i*o+r*s,this[2]=t*a+n*u,this[3]=i*a+r*u,this},multRight:function(e){const t=this[0],i=this[1],n=this[2],r=this[3],o=e[0],s=e[1],a=e[2],u=e[3];return this[0]=o*t+a*i,this[1]=s*t+u*i,this[2]=o*n+a*r,this[3]=s*n+u*r,this},identity:function(){this[0]=1,this[1]=0,this[2]=0,this[3]=1},toString:function(){return this[0]+" "+this[1]+" "+this[2]+" "+this[3]}},Object.defineProperty(i.prototype,"x",{get:function(){const t=new e(0,0);return function(){return t.set(this[0],this[1])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(i.prototype,"xAxis",{get:function(){return this[0]},enumerable:!1,configurable:!1}),Object.defineProperty(i.prototype,"origin",{get:function(){return this[2]},enumerable:!1,configurable:!1}),Object.defineProperty(i.prototype,"submatrix",{get:function(){return this[0]},enumerable:!1,configurable:!1}),Object.assign(i,{Identity:new i}),i}),define("standard/Math/Algorithms/eigendecomposition",[],function(){"use strict";const e=[],t=[],i=[];return function(n,r){const o=n.order,s=r.values,a=r.vectors;let u,l,c,h,d,p,f,g,m,y,_,x,w,b=n.length;for(x=0;x<o;++x)for(e[x]=e[x]||new Array(o),t[x]=s[x]=n.get1(x,x),i[x]=0,w=0;w<o;++w)a[x][w]=x===w?1:0,e[x][w]=n.get1(w,x);for(x=0;x<50;++x){for(u=0,y=0;y<o-1;++y)for(_=y+1;_<o;++_)u+=Math.abs(e[y][_]);if(0===u)break;for(m=x<3?.2*u/b:0,y=0;y<o-1;++y)for(_=y+1;_<o;++_)if(g=100*Math.abs(e[y][_]),x>3&&Math.abs(s[y])+g===Math.abs(s[y])&&Math.abs(s[_])+g===Math.abs(s[_]))e[y][_]=0;else if(Math.abs(e[y][_])>m){for(f=s[_]-s[y],Math.abs(f)+g===Math.abs(f)?d=e[y][_]/f:(l=.5*f/e[y][_],d=1/(Math.abs(l)+Math.sqrt(1+l*l)),l<0&&(d=-d)),c=1/Math.sqrt(1+d*d),h=d*c,p=h/(1+c),f=d*e[y][_],i[y]-=f,i[_]+=f,s[y]-=f,s[_]+=f,e[y][_]=0,w=0;w<y;++w)g=e[w][y],f=e[w][_],e[w][y]=g-h*(f+g*p),e[w][_]=f+h*(g-f*p);for(w=y+1;w<_;++w)g=e[y][w],f=e[w][_],e[y][w]=g-h*(f+g*p),e[w][_]=f+h*(g-f*p);for(w=_+1;w<o;++w)g=e[y][w],f=e[_][w],e[y][w]=g-h*(f+g*p),e[_][w]=f+h*(g-f*p);for(w=0;w<o;++w)g=a[w][y],f=a[w][_],a[w][y]=g-h*(f+g*p),a[w][_]=f+h*(g-f*p)}for(y=0;y<o;++y)s[y]=t[y]+=i[y],i[y]=0}return r}}),define("standard/Math/Numbers/Matrix3",["standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix2","standard/Math/Algorithms/eigendecomposition"],function(e,t,i,n){"use strict";function r(){arguments.length?(this[0]=arguments[0],this[1]=arguments[1],this[2]=arguments[2],this[3]=arguments[3],this[4]=arguments[4],this[5]=arguments[5],this[6]=arguments[6],this[7]=arguments[7],this[8]=arguments[8]):this.identity()}return r.prototype={constructor:r,order:3,length:9,copy:function(){const e=Object.create(r.prototype);return e[0]=this[0],e[1]=this[1],e[2]=this[2],e[3]=this[3],e[4]=this[4],e[5]=this[5],e[6]=this[6],e[7]=this[7],e[8]=this[8],e},assign:function(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this},equals:function(e){return this[0]===e[0]&&this[1]===e[1]&&this[2]===e[2]&&this[3]===e[3]&&this[4]===e[4]&&this[5]===e[5]&&this[6]===e[6]&&this[7]===e[7]&&this[8]===e[8]},rotation:function(){return math.atan2(this[1],this[0])},set1:function(e,t,i){return this[e*this.order+t]=i,this},get1:function(e,t){return this[e*this.order+t]},set:function(t,i,n,r,o){switch(arguments.length){case 0:this.identity();break;case 1:null===t&&(t=e.Zero),this.identity(),this.translate(t);break;case 2:null===t&&(t=e.Zero),null===i&&(i=0),this.identity(),this.translate(t),0!==i&&this.rotate(i);break;case 3:null===t&&(t=e.Zero),null===i&&(i=0),null===n&&(n=e.One),this.identity(),this.translate(t),0!==i&&this.rotate(i),n.equals(e.One)||this.scale(n);break;case 4:if(null===t&&(t=e.Zero),null===i&&(i=0),null===n&&(n=e.One),null===r&&(r=0),this.identity(),this.translate(t),0!==i&&this.rotate(i),!n.equals(e.One)){const e=0!==r;e?(this.rotate(r),this.scale(n),this.rotate(-r)):this.scale(n)}break;case 5:{null===t&&(t=e.Zero),null===i&&(i=0),null===n&&(n=e.One),null===r&&(r=0),null===o&&(o=e.Zero),this.identity(),this.translate(t);const s=!o.equals(e.Zero);s&&this.translate(o),0!==i&&this.rotate(i),n.equals(e.One)||(0!==r?(this.rotate(r),this.scale(n),this.rotate(-r)):this.scale(n)),s&&this.translate(e.negate(o));break}case 9:this[0]=arguments[0],this[1]=arguments[1],this[2]=arguments[2],this[3]=arguments[3],this[4]=arguments[4],this[5]=arguments[5],this[6]=arguments[6],this[7]=arguments[7],this[8]=arguments[8]}return this},get:function(){const n=new e(0,0),o=new t(0,0,0),s=new e(0,0),a=new t(0,0,0),u=new e(0,0),l=new i,c=new i,h=new e(0,0);return function(e,t,i,d,p){switch(null===e&&(e=n),null===t&&(t=o),null===i&&(i=s),null===d&&(d=a),null===p&&(p=u),arguments.length){case 1:e.set(this[6],this[7]);break;case 2:this.factor(e,l,s,c),t[0]=l[0],t[1]=l[1],t[2]=Math.atan2(l[1],l[0]);break;case 3:this.factor(e,l,i,c),t[0]=l[0],t[1]=l[1],t[2]=Math.atan2(l[1],l[0]);break;case 4:this.factor(e,l,i,c),t[0]=l[0],t[1]=l[1],t[2]=Math.atan2(l[1],l[0]),d[0]=c[0],d[1]=c[1],d[2]=Math.atan2(c[1],c[0]);break;case 5:{const n=new r;n.set(h.assign(p).negate()),n.multLeft(this),n.translate(p),n.get(e,t,i,d);break}}}}(),factor:function(){const e=new i,t=new i,r=new i,o={values:[],vectors:[[],[]]}
;return function(i,s,a,u){i.set(this[6],this[7]);const l=this.submatrix,c=l.determinant(),h=c<0?-1:1;if(0===c)throw new Error("Matrix3 .factor: determinant is 0.");r.assign(l).transpose().multLeft(l);const d=n(r,o);u.set(d.vectors[0][0],d.vectors[1][0],d.vectors[0][1],d.vectors[1][1]),a.x=h*Math.sqrt(d.values[0]),a.y=h*Math.sqrt(d.values[1]),e[0]=1/a.x,e[3]=1/a.y,s.assign(t.assign(u).transpose().multRight(e).multRight(u).multRight(l))}}(),determinant2:function(){return this[0]*this[4]-this[1]*this[3]},determinant:function(){const e=this[0],t=this[1],i=this[2],n=this[3],r=this[4],o=this[5],s=this[6],a=this[7],u=this[8];return e*(r*u-o*a)-t*(n*u-o*s)+i*(n*a-r*s)},transpose:function(){let e;return e=this[1],this[1]=this[3],this[3]=e,e=this[2],this[2]=this[6],this[6]=e,e=this[5],this[5]=this[7],this[7]=e,this},inverse:function(){const e=this[0],t=this[1],i=this[2],n=this[3],r=this[4],o=this[5],s=this[6],a=this[7],u=this[8],l=e*r,c=e*a,h=n*t,d=n*a,p=s*t,f=s*r;let g=l*u-c*o-h*u+d*i+p*o-f*i;if(0===g)throw new Error("Matrix3 .inverse: determinant is 0.");g=1/g;const m=(r*u-a*o)*g,y=-(t*u-a*i)*g,_=(t*o-r*i)*g,x=-(n*u-s*o)*g,w=(e*u-s*i)*g,b=-(e*o-n*i)*g;return this[0]=m,this[1]=y,this[2]=_,this[3]=x,this[4]=w,this[5]=b,this[6]=(d-f)*g,this[7]=-(c-p)*g,this[8]=(l-h)*g,this},multLeft:function(e){const t=this[0],i=this[1],n=this[2],r=this[3],o=this[4],s=this[5],a=this[6],u=this[7],l=this[8],c=e[0],h=e[1],d=e[2],p=e[3],f=e[4],g=e[5],m=e[6],y=e[7],_=e[8];return this[0]=t*c+r*h+a*d,this[1]=i*c+o*h+u*d,this[2]=n*c+s*h+l*d,this[3]=t*p+r*f+a*g,this[4]=i*p+o*f+u*g,this[5]=n*p+s*f+l*g,this[6]=t*m+r*y+a*_,this[7]=i*m+o*y+u*_,this[8]=n*m+s*y+l*_,this},multRight:function(e){const t=this[0],i=this[1],n=this[2],r=this[3],o=this[4],s=this[5],a=this[6],u=this[7],l=this[8],c=e[0],h=e[1],d=e[2],p=e[3],f=e[4],g=e[5],m=e[6],y=e[7],_=e[8];return this[0]=t*c+i*p+n*m,this[1]=t*h+i*f+n*y,this[2]=t*d+i*g+n*_,this[3]=r*c+o*p+s*m,this[4]=r*h+o*f+s*y,this[5]=r*d+o*g+s*_,this[6]=a*c+u*p+l*m,this[7]=a*h+u*f+l*y,this[8]=a*d+u*g+l*_,this},multVecMatrix:function(e){if(2===e.length){const t=e.x,i=e.y,n=t*this[2]+i*this[5]+this[8];return e.x=(t*this[0]+i*this[3]+this[6])/n,e.y=(t*this[1]+i*this[4]+this[7])/n,e}const t=e.x,i=e.y,n=e.z;return e.x=t*this[0]+i*this[3]+n*this[6],e.y=t*this[1]+i*this[4]+n*this[7],e.z=t*this[2]+i*this[5]+n*this[8],e},multMatrixVec:function(e){if(2===e.length){const t=e.x,i=e.y,n=t*this[6]+i*this[7]+this[8];return e.x=(t*this[0]+i*this[1]+this[2])/n,e.y=(t*this[3]+i*this[4]+this[5])/n,e}const t=e.x,i=e.y,n=e.z;return e.x=t*this[0]+i*this[1]+n*this[2],e.y=t*this[3]+i*this[4]+n*this[5],e.z=t*this[6]+i*this[7]+n*this[8],e},multDirMatrix:function(e){const t=e.x,i=e.y;return e.x=t*this[0]+i*this[3],e.y=t*this[1]+i*this[4],e},multMatrixDir:function(e){const t=e.x,i=e.y;return e.x=t*this[0]+i*this[1],e.y=t*this[3]+i*this[4],e},identity:function(){this[0]=1,this[1]=0,this[2]=0,this[3]=0,this[4]=1,this[5]=0,this[6]=0,this[7]=0,this[8]=1},translate:function(e){const t=e.x,i=e.y;return this[6]+=this[0]*t+this[3]*i,this[7]+=this[1]*t+this[4]*i,this},rotate:function(e){return this.multLeft(r.Rotation(e)),this},scale:function(e){const t=e.x,i=e.y;return this[0]*=t,this[3]*=i,this[1]*=t,this[4]*=i,this},toString:function(){return this[0]+" "+this[1]+" "+this[2]+" "+this[3]+" "+this[4]+" "+this[5]+" "+this[6]+" "+this[7]+" "+this[8]}},Object.defineProperty(r.prototype,"x",{get:function(){const e=new t(0,0,0);return function(){return e.set(this[0],this[1],this[2])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(r.prototype,"y",{get:function(){const e=new t(0,0,0);return function(){return e.set(this[3],this[4],this[5])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(r.prototype,"xAxis",{get:function(){const t=new e(0,0);return function(){return t.set(this[0],this[1])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(r.prototype,"yAxis",{get:function(){const t=new e(0,0);return function(){return t.set(this[3],this[4])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(r.prototype,"origin",{get:function(){const t=new e(0,0);return function(){return t.set(this[6],this[7])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(r.prototype,"submatrix",{get:function(){const e=new i;return function(){return e[0]=this[0],e[1]=this[1],e[2]=this[3],e[3]=this[4],e}}(),enumerable:!1,configurable:!1}),Object.assign(r,{Identity:new r,Rotation:function(e){const t=Math.sin(e),i=Math.cos(e);return new r(i,t,0,-t,i,0,0,0,1)},Matrix2:function(e){return new r(e[0],e[1],0,e[2],e[3],0,0,0,1)},transpose:function(e){return e.copy().transpose()},inverse:function(e){return e.copy().inverse()},multLeft:function(e,t){return e.copy().multLeft(t)},multRight:function(e,t){return e.copy().multRight(t)}}),r}),define("x_ite/Fields/SFMatrix3",["x_ite/Base/X3DField","x_ite/Fields/SFMatrixPrototypeTemplate","x_ite/Fields/SFVec2","x_ite/Base/X3DConstants","standard/Math/Numbers/Matrix3"],function(e,t,i,n,r){"use strict";function o(i,n,o,s){function a(t,i,n,o,s,a,u,l,c){switch(arguments.length){case 0:return e.call(this,new r);case 1:return e.call(this,arguments[0]);case 9:return e.call(this,new r(+t,+i,+n,+o,+s,+a,+u,+l,+c))}throw new Error("Invalid arguments.")}a.prototype=Object.assign(Object.create(e.prototype),t(r,o,s),{constructor:a,getTypeName:function(){return i},getType:function(){return n},setTransform:function(e,t,i,n,r){e=e?e.getValue():null,t=t?t:0,i=i?i.getValue():null,n=n?n:0,r=r?r.getValue():null,this.getValue().set(e,t,i,n,r)}});for(const e of Reflect.ownKeys(a.prototype))Object.defineProperty(a.prototype,e,{enumerable:!1});for(let e=0,t=r.prototype.length;e<t;++e)!function(e){Object.defineProperty(a.prototype,e,{get:function(){return this.getValue()[e]},set:function(t){this.getValue()[e]=+t,this.addEvent()},enumerable:!0,configurable:!1})}(e);return a}return{SFMatrix3d:o("SFMatrix3d",n.SFMatrix3d,i.SFVec2d,!0),SFMatrix3f:o("SFMatrix3f",n.SFMatrix3f,i.SFVec2f,!1)}}),define("x_ite/Fields/SFVec3",["x_ite/Base/X3DField","x_ite/Fields/SFVecPrototypeTemplate","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,i,n){"use strict";function r(i,r,o){function s(t,i,r){switch(arguments.length){case 0:return e.call(this,new n(0,0,0));case 1:return e.call(this,arguments[0]);case 3:return e.call(this,new n(+t,+i,+r))}throw new Error("Invalid arguments.")}s.prototype=Object.assign(Object.create(e.prototype),t(n,o),{constructor:s,getTypeName:function(){return i},getType:function(){return r},cross:function(e){return new this.constructor(n.cross(this.getValue(),e.getValue()))}});for(const e of Reflect.ownKeys(s.prototype))Object.defineProperty(s.prototype,e,{enumerable:!1});const a={get:function(){return this.getValue().x},set:function(e){this.getValue().x=+e,this.addEvent()},enumerable:!0,configurable:!1},u={get:function(){return this.getValue().y},set:function(e){this.getValue().y=+e,this.addEvent()},enumerable:!0,configurable:!1},l={get:function(){return this.getValue().z},set:function(e){this.getValue().z=+e,this.addEvent()},enumerable:!0,configurable:!1};return Object.defineProperty(s.prototype,"x",a),Object.defineProperty(s.prototype,"y",u),Object.defineProperty(s.prototype,"z",l),a.enumerable=!1,u.enumerable=!1,l.enumerable=!1,Object.defineProperty(s.prototype,"0",a),Object.defineProperty(s.prototype,"1",u),Object.defineProperty(s.prototype,"2",l),s}return{SFVec3d:r("SFVec3d",i.SFVec3d,!0),SFVec3f:r("SFVec3f",i.SFVec3f,!1)}}),define("standard/Math/Numbers/Vector4",["standard/Math/Algorithm"],function(e){"use strict";function t(e,t,i,n){this.x=e,this.y=t,this.z=i,this.w=n}return t.prototype={constructor:t,length:4,copy:function(){const e=Object.create(t.prototype);return e.x=this.x,e.y=this.y,e.z=this.z,e.w=this.w,e},assign:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this},set:function(e,t,i,n){return this.x=e,this.y=t,this.z=i,this.w=n,this},equals:function(e){return this.x===e.x&&this.y===e.y&&this.z===e.z&&this.w===e.w},getReal:function(e){e.x=this.x/this.w,e.y=this.y/this.w,e.z=this.z/this.w},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},add:function(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this},subtract:function(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this},multiply:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},multVec:function(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this},divide:function(e){return this.x/=e,this.y/=e,this.z/=e,this.w/=e,this},divVec:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this},normalize:function(){let e=Math.hypot(this.x,this.y,this.z,this.w);return e&&(e=1/e,this.x*=e,this.y*=e,this.z*=e,this.w*=e),this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},norm:function(){const e=this.x,t=this.y,i=this.z,n=this.w;return e*e+t*t+i*i+n*n},abs:function(){return Math.hypot(this.x,this.y,this.z,this.w)},distance:function(e){return Math.hypot(this.x-e.x,this.y-e.y,this.z-e.z,this.w-e.w)},lerp:function(e,t){const i=this.x,n=this.y,r=this.z,o=this.w;return this.x=i+t*(e.x-i),this.y=n+t*(e.y-n),this.z=r+t*(e.z-r),this.w=o+t*(e.w-o),this},min:function(e){let t=this.x,i=this.y,n=this.z,r=this.w;for(const e of arguments)t=Math.min(t,e.x),i=Math.min(i,e.y),n=Math.min(n,e.z),r=Math.min(r,e.w);return this.x=t,this.y=i,this.z=n,this.w=r,this},max:function(e){let t=this.x,i=this.y,n=this.z,r=this.w;for(const e of arguments)t=Math.max(t,e.x),i=Math.max(i,e.y),n=Math.max(n,e.z),r=Math.max(r,e.w);return this.x=t,this.y=i,this.z=n,this.w=r,this},toString:function(){return this.x+" "+this.y+" "+this.z+" "+this.w}},Object.defineProperty(t.prototype,"0",{get:function(){return this.x},set:function(e){this.x=e},enumerable:!1,configurable:!1}),Object.defineProperty(t.prototype,"1",{get:function(){return this.y},set:function(e){this.y=e},enumerable:!1,configurable:!1}),Object.defineProperty(t.prototype,"2",{get:function(){return this.z},set:function(e){this.z=e},enumerable:!1,configurable:!1}),Object.defineProperty(t.prototype,"3",{get:function(){return this.w},set:function(e){this.w=e},enumerable:!1,configurable:!1}),Object.assign(t,{Zero:new t(0,0,0,0),One:new t(1,1,1,1),xAxis:new t(1,0,0,0),yAxis:new t(0,1,0,0),zAxis:new t(0,0,1,0),wAxis:new t(0,0,0,1),negate:function(e){return e.copy().negate()},add:function(e,t){return e.copy().add(t)},subtract:function(e,t){return e.copy().subtract(t)},multiply:function(e,t){return e.copy().multiply(t)},multVec:function(e,t){return e.copy().multVec(t)},divide:function(e,t){return e.copy().divide(t)},divVec:function(e,t){return e.copy().divVec(t)},normalize:function(e){return e.copy().normalize()},dot:function(e,t){return e.copy().dot(t)},lerp:function(e,t,i){return e.copy().lerp(t,i)},min:function(e,i){return t.prototype.min.apply(e.copy(),arguments)},max:function(e,i){return t.prototype.max.apply(e.copy(),arguments)}}),t}),define("standard/Math/Numbers/Quaternion",["standard/Math/Numbers/Vector3","standard/Math/Algorithm"],function(t,i){"use strict";function n(e,t,i,n){this.x=e,this.y=t,this.z=i,this.w=n}n.prototype={constructor:n,length:4,copy:function(){const e=Object.create(n.prototype);return e.x=this.x,e.y=this.y,e.z=this.z,e.w=this.w,e},assign:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this},set:function(e,t,i,n){return this.x=e,this.y=t,this.z=i,this.w=n,this},setMatrix:function(e){let t;t=e[0]>e[4]?e[0]>e[8]?0:2:e[4]>e[8]?1:2;const i=e[0]+e[4]+e[8];if(i>e[3*t+t]){this[3]=Math.sqrt(i+1)/2;const t=4*this[3];this[0]=(e[5]-e[7])/t,this[1]=(e[6]-e[2])/t,this[2]=(e[1]-e[3])/t}else{const i=(t+1)%3,n=(t+2)%3;this[t]=Math.sqrt(e[3*t+t]-e[3*i+i]-e[3*n+n]+1)/2;const r=4*this[t];this[i]=(e[3*t+i]+e[3*i+t])/r,this[n]=(e[3*t+n]+e[3*n+t])/r,this[3]=(e[3*i+n]-e[3*n+i])/r}return this},getMatrix:function(e){const t=this.x,i=this.y,n=this.z,r=this.w,o=t*t,s=t*i,a=i*i,u=i*n,l=n*t,c=n*n,h=r*t,d=r*i,p=r*n;return e[0]=1-2*(a+c),e[1]=2*(s+p),e[2]=2*(l-d),e[3]=2*(s-p),e[4]=1-2*(c+o),e[5]=2*(u+h),e[6]=2*(l+d),e[7]=2*(u-h),e[8]=1-2*(a+o),e},isReal:function(){return!(this.x||this.y||this.z)},isImag:function(){return!this.w},equals:function(e){return this.x===e.x&&this.y===e.y&&this.z===e.z&&this.w===e.w},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},inverse:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},add:function(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this},subtract:function(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this},multiply:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},multLeft:function(e){const t=this.x,i=this.y,n=this.z,r=this.w,o=e.x,s=e.y,a=e.z,u=e.w;return this.x=r*o+t*u+i*a-n*s,this.y=r*s+i*u+n*o-t*a,this.z=r*a+n*u+t*s-i*o,this.w=r*u-t*o-i*s-n*a,this},multRight:function(e){const t=this.x,i=this.y,n=this.z,r=this.w,o=e.x,s=e.y,a=e.z,u=e.w;return this.x=u*t+o*r+s*n-a*i,this.y=u*i+s*r+a*t-o*n,this.z=u*n+a*r+o*i-s*t,this.w=u*r-o*t-s*i-a*n,this},divide:function(e){return this.x/=e,this.y/=e,this.z/=e,this.w/=e,this},multVecQuat:function(e){const t=this.x,i=this.y,n=this.z,r=this.w,o=e.x,s=e.y,a=e.z,u=r*r-t*t-i*i-n*n,l=2*(o*t+s*i+a*n),c=2*r;return e.x=u*o+l*t+c*(i*a-n*s),e.y=u*s+l*i+c*(n*o-t*a),e.z=u*a+l*n+c*(t*s-i*o),e},multQuatVec:function(e){const t=this.x,i=this.y,n=this.z,r=this.w,o=e.x,s=e.y,a=e.z,u=r*r-t*t-i*i-n*n,l=2*(o*t+s*i+a*n),c=2*r;return e.x=u*o+l*t-c*(i*a-n*s),e.y=u*s+l*i-c*(n*o-t*a),e.z=u*a+l*n-c*(t*s-i*o),e},normalize:function(){let e=Math.hypot(this.x,this.y,this.z,this.w);return e&&(e=1/e,this.x*=e,this.y*=e,this.z*=e,this.w*=e),this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},norm:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},abs:function(){return Math.hypot(this.x,this.y,this.z,this.w)},pow:function(t){if(t instanceof n)return this.assign(e.assign(t).multRight(this.log()).exp());if(this.isReal())return this.set(0,0,0,Math.pow(this.w,t));const i=this.abs(),r=Math.acos(this.w/i),o=this.imag.abs(),s=Math.pow(i,t),a=t*r,u=s/o*Math.sin(a);return this.x*=u,this.y*=u,this.z*=u,this.w=s*Math.cos(a),this},log:function(){if(this.isReal())return this.w>0?this.set(0,0,0,Math.log(this.w)):this.set(Math.PI,0,0,Math.log(-this.w));const e=this.abs(),t=this.imag.normalize().multiply(Math.acos(this.w/e)),i=Math.log(e);return this.x=t.x,this.y=t.y,this.z=t.z,this.w=i,this},exp:function(){if(this.isReal())return this.set(0,0,0,Math.exp(this.w));const e=this.imag,t=e.abs(),i=Math.exp(this.w),n=i*Math.cos(t),r=e.multiply(i*Math.sin(t)/t);return this.x=r.x,this.y=r.y,this.z=r.z,this.w=n,this},slerp:function(e,t){return i.slerp(this,r.assign(e),t)},squad:function(e,t,n,a){return i.slerp(i.slerp(this,r.assign(n),a),i.slerp(o.assign(e),s.assign(t),a),2*a*(1-a))},toString:function(){return this.x+" "+this.y+" "+this.z+" "+this.w}},Object.defineProperty(n.prototype,"0",{get:function(){return this.x},set:function(e){this.x=e},enumerable:!1,configurable:!1}),Object.defineProperty(n.prototype,"1",{get:function(){return this.y},set:function(e){this.y=e},enumerable:!1,configurable:!1}),Object.defineProperty(n.prototype,"2",{get:function(){return this.z},set:function(e){this.z=e},enumerable:!1,configurable:!1}),Object.defineProperty(n.prototype,"3",{get:function(){return this.w},set:function(e){this.w=e},enumerable:!1,configurable:!1}),Object.defineProperty(n.prototype,"real",{get:function(){return this.w},enumerable:!1,configurable:!1}),Object.defineProperty(n.prototype,"imag",{get:function(){const e=new t(0,0,0);return function(){return e.set(this.x,this.y,this.z)}}(),enumerable:!1,configurable:!1}),Object.assign(n,{negate:function(e){return e.copy().negate()},inverse:function(e){return e.copy().inverse()},add:function(e,t){return e.copy().add(t)},subtract:function(e,t){return e.copy().subtract(t)},multiply:function(e,t){return e.copy().multiply(t)},multLeft:function(e,t){return e.copy().multLeft(t)},multRight:function(e,t){return e.copy().multRight(t)},divide:function(e,t){return e.copy().divide(t)},normalize:function(e){return e.copy().normalize()},slerp:function(e,t,i){return e.copy().slerp(t,i)},squad:function(e,t,i,n,r){return e.copy().squad(t,i,n,r)},spline:function(e,t,i){return a.assign(e),u.assign(t),l.assign(i),a.dot(u)<0&&a.negate(),l.dot(u)<0&&l.negate(),c.assign(u).inverse(),u.multRight(r.assign(c).multRight(a).log().add(o.assign(c).multRight(l).log()).divide(-4).exp()).normalize().copy()}});const r=new n(0,0,0,1),o=new n(0,0,0,1),s=new n(0,0,0,1),a=new n(0,0,0,1),u=new n(0,0,0,1),l=new n(0,0,0,1),c=new n(0,0,0,1);return n}),define("standard/Math/Numbers/Rotation4",["standard/Math/Numbers/Quaternion","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Algorithm"],function(e,t,i,n){"use strict";function r(i,n,r,o){switch(this.x_=0,this.y_=0,this.z_=1,this.angle_=0,arguments.length){case 0:return void(this.value=new e(0,0,0,1));case 1:return this.value=arguments[0],void this.update();case 2:{const i=arguments[0],n=arguments[1];return this.value=new e(0,0,0,1),n instanceof t?this.setFromToVec(i,n):void this.set(i.x,i.y,i.z,n)}case 4:return this.value=new e(0,0,0,1),void this.set(i,n,r,o)}}r.prototype={constructor:r,length:4,update:function(){const e=this.get();return this.x_=e.x,this.y_=e.y,this.z_=e.z,this.angle_=e.w,this},copy:function(){const e=Object.create(r.prototype);return e.x_=this.x_,e.y_=this.y_,e.z_=this.z_,e.angle_=this.angle_,e.value=this.value.copy(),e},assign:function(e){return this.x_=e.x_,this.y_=e.y_,this.z_=e.z_,this.angle_=e.angle_,this.value.assign(e.value),this},set:function(e,t,i,r){this.x_=e,this.y_=t,this.z_=i,this.angle_=r;const o=Math.hypot(e,t,i);if(0===o)return this.value.set(0,0,0,1),this;const s=n.interval(r/2,0,Math.PI),a=Math.sin(s)/o;return this.value.set(e*a,t*a,i*a,Math.cos(s)),this},get:function(){const e=new i(0,0,0,0);return function(){const t=this.value;if(Math.abs(t.w)>1)return i.zAxis;{const n=2*Math.acos(t.w),r=Math.sin(n/2);if(0===r)return i.zAxis;{const i=t.imag.divide(r);return e.set(i.x,i.y,i.z,n)}}}}(),setAxisAngle:function(e,t){return this.set(e.x,e.y,e.z,t)},setFromToVec:function(){const e=new t(0,0,0),i=new t(0,0,0),r=new t(0,0,0),o=new t(0,0,0);return function(s,a){e.assign(s).normalize(),i.assign(a).normalize();const u=n.clamp(e.dot(i),-1,1),l=r.assign(e).cross(i).normalize();return 0===l.abs()?u>0?this.value.set(0,0,0,1):(o.assign(e).cross(t.xAxis),0===o.norm()&&o.assign(e).cross(t.yAxis),o.normalize(),this.value.set(o.x,o.y,o.z,0)):(l.multiply(Math.sqrt(Math.abs(1-u)/2)),this.value.set(l.x,l.y,l.z,Math.sqrt(Math.abs(1+u)/2))),this.update(),this}}(),setAxis:function(e){this.set(e.x,e.y,e.z,this.angle_)},getAxis:function(){const e=new t(0,0,0);return function(){return e.set(this.x_,this.y_,this.z_)}}(),setMatrix:function(e){return this.value.setMatrix(e).normalize(),this.update(),this},getMatrix:function(e){return this.value.getMatrix(e)},equals:function(e){return this.value.equals(e.value)},inverse:function(){return this.value.inverse(),this.update(),this},multLeft:function(e){return this.value.multLeft(e.value).normalize(),this.update(),this},multRight:function(e){return this.value.multRight(e.value).normalize(),this.update(),this},multVecRot:function(e){return this.value.multVecQuat(e)},multRotVec:function(e){return this.value.multQuatVec(e)},normalize:function(){return this.value.normalize(),this.update(),this},pow:function(e){return this.value.pow(e),this.update(),this},slerp:function(e,t){return this.value.slerp(e.value,t),this.update(),this},squad:function(e,t,i,n){return this.value.squad(e.value,t.value,i.value,n),this.update(),this},toString:function(){return this.x_+" "+this.y_+" "+this.z_+" "+this.angle_}};const o={get:function(){return this.x_},set:function(e){this.x_=e,this.set(e,this.y_,this.z_,this.angle_)},enumerable:!0,configurable:!1},s={get:function(){return this.y_},set:function(e){this.y_=e,this.set(this.x_,e,this.z_,this.angle_)},enumerable:!0,configurable:!1},a={get:function(){return this.z_},set:function(e){this.z_=e,this.set(this.x_,this.y_,e,this.angle_)},enumerable:!0,configurable:!1},u={get:function(){return this.angle_},set:function(e){this.angle_=e,this.set(this.x_,this.y_,this.z_,e)},enumerable:!0,configurable:!1};return Object.defineProperty(r.prototype,"x",o),Object.defineProperty(r.prototype,"y",s),Object.defineProperty(r.prototype,"z",a),Object.defineProperty(r.prototype,"angle",u),o.enumerable=!1,s.enumerable=!1,a.enumerable=!1,u.enumerable=!1,Object.defineProperty(r.prototype,"0",o),Object.defineProperty(r.prototype,"1",s),Object.defineProperty(r.prototype,"2",a),Object.defineProperty(r.prototype,"3",u),Object.assign(r,{Identity:new r,inverse:function(e){return e.copy().inverse()},multRight:function(e,t){return e.copy().multRight(t)},normalize:function(e){return e.copy().normalize()},slerp:function(e,t,i){return e.copy().slerp(t,i)},squad:function(e,t,i,n,r){return e.copy().squad(t,i,n,r)},spline:function(t,i,n){const r=Object.create(this.prototype);return r.value=e.spline(t.value,i.value,n.value),r.update(),r}}),r}),define("standard/Math/Numbers/Matrix4",["standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix3","standard/Math/Algorithms/eigendecomposition"],function(e,t,i,n,r){"use strict";function o(){arguments.length?(this[0]=arguments[0],this[1]=arguments[1],this[2]=arguments[2],this[3]=arguments[3],this[4]=arguments[4],this[5]=arguments[5],this[6]=arguments[6],this[7]=arguments[7],this[8]=arguments[8],this[9]=arguments[9],this[10]=arguments[10],this[11]=arguments[11],this[12]=arguments[12],this[13]=arguments[13],this[14]=arguments[14],this[15]=arguments[15]):this.identity()}o.prototype={constructor:o,order:4,length:16,copy:function(){const e=Object.create(o.prototype);return e[0]=this[0],e[1]=this[1],e[2]=this[2],e[3]=this[3],e[4]=this[4],e[5]=this[5],e[6]=this[6],e[7]=this[7],e[8]=this[8],e[9]=this[9],e[10]=this[10],e[11]=this[11],e[12]=this[12],e[13]=this[13],e[14]=this[14],e[15]=this[15],e},assign:function(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this},equals:function(e){return this[0]===e[0]&&this[1]===e[1]&&this[2]===e[2]&&this[3]===e[3]&&this[4]===e[4]&&this[5]===e[5]&&this[6]===e[6]&&this[7]===e[7]&&this[8]===e[8]&&this[9]===e[9]&&this[10]===e[10]&&this[11]===e[11]&&this[12]===e[12]&&this[13]===e[13]&&this[14]===e[14]&&this[15]===e[15]},set1:function(e,t,i){return this[e*this.order+t]=i,this},get1:function(e,t){return this[e*this.order+t]},set:function(t,n,r,o,s){switch(arguments.length){case 0:this.identity();break;case 1:null===t&&(t=e.Zero),this.identity(),this.translate(t);break;case 2:null===t&&(t=e.Zero),null===n&&(n=i.Identity),this.identity(),this.translate(t),n.equals(i.Identity)||this.rotate(n);break;case 3:null===t&&(t=e.Zero),null===n&&(n=i.Identity),null===r&&(r=e.One),this.identity(),this.translate(t),n.equals(i.Identity)||this.rotate(n),r.equals(e.One)||this.scale(r);break;case 4:if(null===t&&(t=e.Zero),null===n&&(n=i.Identity),null===r&&(r=e.One),null===o&&(o=i.Identity),this.identity(),this.translate(t),n.equals(i.Identity)||this.rotate(n),!r.equals(e.One)){const e=!o.equals(i.Identity);e?(this.rotate(o),this.scale(r),this.rotate(i.inverse(o))):this.scale(r)}break;case 5:{null===t&&(t=e.Zero),null===n&&(n=i.Identity),null===r&&(r=e.One),null===o&&(o=i.Identity),null===s&&(s=e.Zero),this.identity(),this.translate(t);const a=!s.equals(e.Zero);a&&this.translate(s),n.equals(i.Identity)||this.rotate(n),r.equals(e.One)||(o.equals(i.Identity)?this.scale(r):(this.rotate(o),this.scale(r),this.rotate(i.inverse(o)))),a&&this.translate(e.negate(s));break}case 16:this[0]=arguments[0],this[1]=arguments[1],this[2]=arguments[2],this[3]=arguments[3],this[4]=arguments[4],this[5]=arguments[5],this[6]=arguments[6],this[7]=arguments[7],this[8]=arguments[8],this[9]=arguments[9],this[10]=arguments[10],this[11]=arguments[11],this[12]=arguments[12],this[13]=arguments[13],this[14]=arguments[14],this[15]=arguments[15]}return this},get:function(){const t=new e(0,0,0),r=new i,s=new e(0,0,0),a=new i,u=new e(0,0,0),l=new n,c=new n,h=new e(0,0,0);return function(e,i,n,d,p){switch(null===e&&(e=t),null===i&&(i=r),null===n&&(n=s),null===d&&(d=a),null===p&&(p=u),arguments.length){case 1:e.set(this[12],this[13],this[14]);break;case 2:this.factor(e,l,s,c),i.setMatrix(l);break;case 3:this.factor(e,l,n,c),i.setMatrix(l);break;case 4:this.factor(e,l,n,c),i.setMatrix(l),d.setMatrix(c);break;case 5:{const t=new o;t.set(h.assign(p).negate()),t.multLeft(this),t.translate(p),t.get(e,i,n,d);break}}}}(),setRotation:function(e){return this.setQuaternion(e.value)},setQuaternion:function(e){const t=e.x,i=e.y,n=e.z,r=e.w,o=i*i,s=n*n,a=t*i,u=n*r,l=n*t,c=i*r,h=t*t,d=i*n,p=t*r;return this[0]=1-2*(o+s),this[1]=2*(a+u),this[2]=2*(l-c),this[3]=0,this[4]=2*(a-u),this[5]=1-2*(s+h),this[6]=2*(d+p),this[7]=0,this[8]=2*(l+c),this[9]=2*(d-p),this[10]=1-2*(o+h),this[11]=0,this[12]=0,this[13]=0,this[14]=0,this[15]=1,this},factor:function(){const e=new n,t=new n,i=new n,o={values:[],vectors:[[],[],[]]};return function(n,s,a,u){n.set(this[12],this[13],this[14]);const l=this.submatrix,c=l.determinant(),h=c<0?-1:1;if(0===c)throw new Error("Matrix4 .factor: determinant is 0.");i.assign(l).transpose().multLeft(l);const d=r(i,o);u.set(d.vectors[0][0],d.vectors[1][0],d.vectors[2][0],d.vectors[0][1],d.vectors[1][1],d.vectors[2][1],d.vectors[0][2],d.vectors[1][2],d.vectors[2][2]),a.x=h*Math.sqrt(d.values[0]),a.y=h*Math.sqrt(d.values[1]),a.z=h*Math.sqrt(d.values[2]),e[0]=1/a.x,e[4]=1/a.y,e[8]=1/a.z,s.assign(t.assign(u).transpose().multRight(e).multRight(u).multRight(l))}}(),determinant3:function(){const e=this[0],t=this[1],i=this[2],n=this[4],r=this[5],o=this[6],s=this[8],a=this[9],u=this[10];return e*(r*u-o*a)-t*(n*u-o*s)+i*(n*a-r*s)},determinant:function(){const e=this[0],t=this[1],i=this[2],n=this[3],r=this[4],o=this[5],s=this[6],a=this[7],u=this[8],l=this[9],c=this[10],h=this[11],d=this[12],p=this[13],f=this[14],g=this[15],m=c*g,y=f*h,_=s*g,x=f*a,w=s*h,b=c*a,v=i*g,S=f*n,T=i*h,C=c*n,F=i*a,O=s*n;return e*(m*o+x*l+w*p-y*o-_*l-b*p)+r*(y*t+v*l+C*p-m*t-S*l-T*p)+u*(_*t+S*o+F*p-x*t-v*o-O*p)+d*(b*t+T*o+O*l-w*t-C*o-F*l)},transpose:function(){let e;return e=this[1],this[1]=this[4],this[4]=e,e=this[2],this[2]=this[8],this[8]=e,e=this[3],this[3]=this[12],this[12]=e,e=this[6],this[6]=this[9],this[9]=e,e=this[7],this[7]=this[13],this[13]=e,e=this[11],this[11]=this[14],this[14]=e,this},inverse:function(){const e=this[0],t=this[1],i=this[2],n=this[3],r=this[4],o=this[5],s=this[6],a=this[7],u=this[8],l=this[9],c=this[10],h=this[11],d=this[12],p=this[13],f=this[14],g=this[15],m=c*g,y=f*h,_=s*g,x=f*a,w=s*h,b=c*a,v=i*g,S=f*n,T=i*h,C=c*n,F=i*a,O=s*n,N=u*p,E=d*l,D=r*p,M=d*o,V=r*l,I=u*o,B=e*p,A=d*t,P=e*l,R=u*t,L=e*o,k=r*t,U=m*o+x*l+w*p-(y*o+_*l+b*p),X=y*t+v*l+C*p-(m*t+S*l+T*p),z=_*t+S*o+F*p-(x*t+v*o+O*p),j=b*t+T*o+O*l-(w*t+C*o+F*l);let G=e*U+r*X+u*z+d*j;if(0===G)throw new Error("Matrix4 .inverse: determinant is 0.");return G=1/G,this[0]=G*U,this[1]=G*X,this[2]=G*z,this[3]=G*j,this[4]=G*(y*r+_*u+b*d-m*r-x*u-w*d),this[5]=G*(m*e+S*u+T*d-y*e-v*u-C*d),this[6]=G*(x*e+v*r+O*d-_*e-S*r-F*d),this[7]=G*(w*e+C*r+F*u-b*e-T*r-O*u),this[8]=G*(N*a+M*h+V*g-E*a-D*h-I*g),this[9]=G*(E*n+B*h+R*g-N*n-A*h-P*g),this[10]=G*(D*n+A*a+L*g-M*n-B*a-k*g),this[11]=G*(I*n+P*a+k*h-V*n-R*a-L*h),this[12]=G*(D*c+I*f+E*s-V*f-N*s-M*c),this[13]=G*(P*f+N*i+A*c-B*c-R*f-E*i),this[14]=G*(B*s+k*f+M*i-L*f-D*i-A*s),this[15]=G*(L*c+V*i+R*s-P*s-k*c-I*i),this},multLeft:function(e){const t=this[0],i=this[1],n=this[2],r=this[3],o=this[4],s=this[5],a=this[6],u=this[7],l=this[8],c=this[9],h=this[10],d=this[11],p=this[12],f=this[13],g=this[14],m=this[15],y=e[0],_=e[1],x=e[2],w=e[3],b=e[4],v=e[5],S=e[6],T=e[7],C=e[8],F=e[9],O=e[10],N=e[11],E=e[12],D=e[13],M=e[14],V=e[15];return this[0]=t*y+o*_+l*x+p*w,this[1]=i*y+s*_+c*x+f*w,this[2]=n*y+a*_+h*x+g*w,this[3]=r*y+u*_+d*x+m*w,this[4]=t*b+o*v+l*S+p*T,this[5]=i*b+s*v+c*S+f*T,this[6]=n*b+a*v+h*S+g*T,this[7]=r*b+u*v+d*S+m*T,this[8]=t*C+o*F+l*O+p*N,this[9]=i*C+s*F+c*O+f*N,this[10]=n*C+a*F+h*O+g*N,this[11]=r*C+u*F+d*O+m*N,this[12]=t*E+o*D+l*M+p*V,this[13]=i*E+s*D+c*M+f*V,this[14]=n*E+a*D+h*M+g*V,this[15]=r*E+u*D+d*M+m*V,this},multRight:function(e){const t=this[0],i=this[1],n=this[2],r=this[3],o=this[4],s=this[5],a=this[6],u=this[7],l=this[8],c=this[9],h=this[10],d=this[11],p=this[12],f=this[13],g=this[14],m=this[15],y=e[0],_=e[1],x=e[2],w=e[3],b=e[4],v=e[5],S=e[6],T=e[7],C=e[8],F=e[9],O=e[10],N=e[11],E=e[12],D=e[13],M=e[14],V=e[15];return this[0]=t*y+i*b+n*C+r*E,this[1]=t*_+i*v+n*F+r*D,this[2]=t*x+i*S+n*O+r*M,this[3]=t*w+i*T+n*N+r*V,this[4]=o*y+s*b+a*C+u*E,this[5]=o*_+s*v+a*F+u*D,this[6]=o*x+s*S+a*O+u*M,this[7]=o*w+s*T+a*N+u*V,this[8]=l*y+c*b+h*C+d*E,this[9]=l*_+c*v+h*F+d*D,this[10]=l*x+c*S+h*O+d*M,this[11]=l*w+c*T+h*N+d*V,this[12]=p*y+f*b+g*C+m*E,this[13]=p*_+f*v+g*F+m*D,this[14]=p*x+f*S+g*O+m*M,this[15]=p*w+f*T+g*N+m*V,this},multVecMatrix:function(e){if(3===e.length){const t=e.x,i=e.y,n=e.z,r=1/(t*this[3]+i*this[7]+n*this[11]+this[15]);return e.x=(t*this[0]+i*this[4]+n*this[8]+this[12])*r,e.y=(t*this[1]+i*this[5]+n*this[9]+this[13])*r,e.z=(t*this[2]+i*this[6]+n*this[10]+this[14])*r,e}const t=e.x,i=e.y,n=e.z,r=e.w;return e.x=t*this[0]+i*this[4]+n*this[8]+r*this[12],e.y=t*this[1]+i*this[5]+n*this[9]+r*this[13],e.z=t*this[2]+i*this[6]+n*this[10]+r*this[14],e.w=t*this[3]+i*this[7]+n*this[11]+r*this[15],e},multMatrixVec:function(e){if(3===e.length){const t=e.x,i=e.y,n=e.z,r=1/(t*this[12]+i*this[13]+n*this[14]+this[15]);return e.x=(t*this[0]+i*this[1]+n*this[2]+this[3])*r,e.y=(t*this[4]+i*this[5]+n*this[6]+this[7])*r,e.z=(t*this[8]+i*this[9]+n*this[10]+this[11])*r,e}const t=e.x,i=e.y,n=e.z,r=e.w;return e.x=t*this[0]+i*this[1]+n*this[2]+r*this[3],e.y=t*this[4]+i*this[5]+n*this[6]+r*this[7],e.z=t*this[8]+i*this[9]+n*this[10]+r*this[11],e.w=t*this[12]+i*this[13]+n*this[14]+r*this[15],e},multDirMatrix:function(e){const t=e.x,i=e.y,n=e.z;return e.x=t*this[0]+i*this[4]+n*this[8],e.y=t*this[1]+i*this[5]+n*this[9],e.z=t*this[2]+i*this[6]+n*this[10],e},multMatrixDir:function(e){const t=e.x,i=e.y,n=e.z;return e.x=t*this[0]+i*this[1]+n*this[2],e.y=t*this[4]+i*this[5]+n*this[6],e.z=t*this[8]+i*this[9]+n*this[10],e},identity:function(){this[0]=1,this[1]=0,this[2]=0,this[3]=0,this[4]=0,this[5]=1,this[6]=0,this[7]=0,this[8]=0,this[9]=0,this[10]=1,this[11]=0,this[12]=0,this[13]=0,this[14]=0,this[15]=1},translate:function(e){const t=e.x,i=e.y,n=e.z;return this[12]+=this[0]*t+this[4]*i+this[8]*n,this[13]+=this[1]*t+this[5]*i+this[9]*n,this[14]+=this[2]*t+this[6]*i+this[10]*n,this},rotate:function(e){return this.multLeft(s.setQuaternion(e.value)),this},scale:function(e){const t=e.x,i=e.y,n=e.z;return this[0]*=t,this[4]*=i,this[8]*=n,this[1]*=t,this[5]*=i,this[9]*=n,this[2]*=t,this[6]*=i,this[10]*=n,this},getDepth:function(e){const t=e.x,i=e.y,n=e.z,r=1/(t*this[3]+i*this[7]+n*this[11]+this[15]);return(t*this[2]+i*this[6]+n*this[10]+this[14])*r},toString:function(){return this[0]+" "+this[1]+" "+this[2]+" "+this[3]+" "+this[4]+" "+this[5]+" "+this[6]+" "+this[7]+" "+this[8]+" "+this[9]+" "+this[10]+" "+this[11]+" "+this[12]+" "+this[13]+" "+this[14]+" "+this[15]}},Object.defineProperty(o.prototype,"x",{get:function(){const e=new t(0,0,0,0);return function(){return e.set(this[0],this[1],this[2],this[3])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(o.prototype,"y",{get:function(){const e=new t(0,0,0,0);return function(){return e.set(this[4],this[5],this[6],this[7])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(o.prototype,"z",{get:function(){const e=new t(0,0,0,0);return function(){return e.set(this[8],this[9],this[10],this[11])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(o.prototype,"xAxis",{
get:function(){const t=new e(0,0,0);return function(){return t.set(this[0],this[1],this[2])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(o.prototype,"yAxis",{get:function(){const t=new e(0,0,0);return function(){return t.set(this[4],this[5],this[6])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(o.prototype,"zAxis",{get:function(){const t=new e(0,0,0);return function(){return t.set(this[8],this[9],this[10])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(o.prototype,"origin",{get:function(){const t=new e(0,0,0);return function(){return t.set(this[12],this[13],this[14])}}(),enumerable:!1,configurable:!1}),Object.defineProperty(o.prototype,"submatrix",{get:function(){const e=new n;return function(){return e[0]=this[0],e[1]=this[1],e[2]=this[2],e[3]=this[4],e[4]=this[5],e[5]=this[6],e[6]=this[8],e[7]=this[9],e[8]=this[10],e}}(),enumerable:!1,configurable:!1}),Object.assign(o,{Identity:new o,Rotation:function(e){return Object.create(this.prototype).setQuaternion(e.value)},Quaternion:function(e){return Object.create(this.prototype).setQuaternion(e)},Matrix3:function(e){return new o(e[0],e[1],e[2],0,e[3],e[4],e[5],0,e[6],e[7],e[8],0,0,0,0,1)},transpose:function(e){return e.copy().transpose()},inverse:function(e){return e.copy().inverse()},multLeft:function(e,t){return e.copy().multLeft(t)},multRight:function(e,t){return e.copy().multRight(t)}});const s=new o;return o}),define("x_ite/Fields/SFMatrix4",["x_ite/Base/X3DField","x_ite/Fields/SFMatrixPrototypeTemplate","x_ite/Fields/SFVec3","x_ite/Base/X3DConstants","standard/Math/Numbers/Matrix4"],function(e,t,i,n,r){"use strict";function o(i,n,o,s){function a(t,i,n,o,s,a,u,l,c,h,d,p,f,g,m,y){switch(arguments.length){case 0:return e.call(this,new r);case 1:return e.call(this,arguments[0]);case 16:return e.call(this,new r(+t,+i,+n,+o,+s,+a,+u,+l,+c,+h,+d,+p,+f,+g,+m,+y))}throw new Error("Invalid arguments.")}a.prototype=Object.assign(Object.create(e.prototype),t(r,o,s),{constructor:a,getTypeName:function(){return i},getType:function(){return n}});for(const e of Reflect.ownKeys(a.prototype))Object.defineProperty(a.prototype,e,{enumerable:!1});for(let e=0,t=r.prototype.length;e<t;++e)!function(e){Object.defineProperty(a.prototype,e,{get:function(){return this.getValue()[e]},set:function(t){this.getValue()[e]=t,this.addEvent()},enumerable:!0,configurable:!1})}(e);return a}return{SFMatrix4d:o("SFMatrix4d",n.SFMatrix4d,i.SFVec3d,!0),SFMatrix4f:o("SFMatrix4f",n.SFMatrix4f,i.SFVec3f,!1),VrmlMatrix:o("VrmlMatrix",n.VrmlMatrix,i.SFVec3f,!1)}}),define("x_ite/Fields/SFNodeCache",["x_ite/Fields/SFNode"],function(){"use strict";function e(){}const t=new WeakMap;return e.prototype={get:function(e){const i=t.get(e);if(i)return i;{const i=require("x_ite/Fields/SFNode"),n=new i(e);return t.set(e,n),n}}},new e}),define("x_ite/Fields/SFNode",["x_ite/Base/X3DField","x_ite/Base/X3DConstants","x_ite/InputOutput/Generator","x_ite/Fields/SFNodeCache"],function(e,t,i,n){"use strict";function r(t){const i=new Proxy(this,u);return this[o]=this,this[s]=i,t?(t.addParent(i),e.call(this,t)):e.call(this,null),i}const o=Symbol(),s=Symbol(),a=Symbol(),u={get:function(e,i){try{const n=e[i];if(void 0!==n)return n;const r=e.getValue().getField(i),o=r.getAccessType();if(o===t.inputOnly)return;return r.valueOf()}catch(e){return}},set:function(e,i,n){if(i in e)return e[i]=n,!0;try{const r=e.getValue().getField(i),o=r.getAccessType();return o!==t.outputOnly&&r.setValue(n),!0}catch(t){return console.error(e,i,t),!1}},has:function(e,t){try{return Boolean(e.getValue().getField(t))}catch(i){return t in e}},ownKeys:function(e){const t=e.getValue(),i=[];if(t)for(const e of t.getFieldDefinitions())i.push(e.name);return i},getOwnPropertyDescriptor:function(e,i){const n=e.getValue();if(n){const r=n.getFieldDefinitions().get(i);if(r)return{value:this.get(e,i),writable:r.accessType!==t.outputOnly,enumerable:!0,configurable:!0}}}};r.prototype=Object.assign(Object.create(e.prototype),{constructor:r,[o]:null,[s]:null,[a]:0,copy:function(e){const t=this[o],i=t.getValue();return i?new r(e?i.copy(e):i):new r},getTypeName:function(){return"SFNode"},getType:function(){return t.SFNode},equals:function(e){const t=this[o];return e?t.getValue()===e.getValue():null===t.getValue()},isDefaultValue:function(){return null===this[o].getValue()},set:function(t){const i=this[o],n=i.getValue();n&&(n.removeCloneCount(i[a]),n.removeParent(i[s])),t?(t.addParent(i[s]),t.addCloneCount(i[a]),e.prototype.set.call(i,t)):e.prototype.set.call(i,null)},getNodeTypeName:function(){const e=this[o],t=e.getValue();if(t)return t.getTypeName();throw new Error("SFNode.getNodeTypeName: node is null.")},getNodeName:function(){const e=this[o],t=e.getValue();if(t)return t.getName();throw new Error("SFNode.getNodeName: node is null.")},getNodeDisplayName:function(){const e=this[o],t=e.getValue();if(t)return t.getDisplayName();throw new Error("SFNode.getNodeDisplayName: node is null.")},getNodeType:function(){const e=this[o],t=e.getValue();if(t)return t.getType().slice();throw new Error("SFNode.getNodeType: node is null.")},getFieldDefinitions:function(){const e=this[o],t=e.getValue();if(t)return t.getFieldDefinitions();throw new Error("SFNode.getFieldDefinitions: node is null.")},addFieldCallback:function(t,i,n){const r=this[o];switch(arguments.length){case 2:return e.prototype.addFieldCallback.apply(r,arguments);case 3:{const e=r.getValue();if(e)return e.getField(t).addFieldCallback(i,n);throw new Error("SFNode.addFieldCallback: node is null.")}}},removeFieldCallback:function(t,i){const n=this[o];switch(arguments.length){case 1:return e.prototype.removeFieldCallback.apply(n,arguments);case 2:{const e=n.getValue();if(e)return e.getField(t).removeFieldCallback(i);throw new Error("SFNode.removeFieldCallback: node is null.")}}},addCloneCount:function(e){const t=this[o],i=t.getValue();t[a]+=e,i&&i.addCloneCount(e)},removeCloneCount:function(e){const t=this[o],i=t.getValue();t[a]-=e,i&&i.removeCloneCount(e)},valueOf:function(){const e=this[o],t=e.getValue();return t?n.get(t):null},toStream:function(e){const t=this[o],i=t.getValue();i?i.toStream(e):e.string+="NULL"},toVRMLStream:function(e){const t=this[o],i=t.getValue();i?i.toVRMLStream(e):e.string+="NULL"},toXMLString:function(){const e=this[o],t={string:""},n=i.Get(t),r=e.getValue();return n.PushExecutionContext(r.getExecutionContext()),e.toXMLStream(t),n.PopExecutionContext(),t.string},toXMLStream:function(e){const t=this[o],i=t.getValue();i?i.toXMLStream(e):e.string+="<!-- NULL -->"},dispose:function(){const t=this[o],i=t.getValue();i&&i.dispose(),e.prototype.dispose.call(t)}});for(const e of Reflect.ownKeys(r.prototype))Object.defineProperty(r.prototype,e,{enumerable:!1});return r}),define("x_ite/Fields/SFRotation",["x_ite/Fields/SFVec3","x_ite/Base/X3DField","x_ite/Base/X3DConstants","x_ite/InputOutput/Generator","standard/Math/Numbers/Rotation4"],function(e,t,i,n,r){"use strict";function o(e,i,n,o){switch(arguments.length){case 0:return t.call(this,new r);case 1:return t.call(this,arguments[0]);case 2:return arguments[1]instanceof s?t.call(this,new r(arguments[0].getValue(),arguments[1].getValue())):t.call(this,new r(arguments[0].getValue(),+arguments[1]));case 4:return t.call(this,new r(+e,+i,+n,+o))}throw new Error("Invalid arguments.")}const s=e.SFVec3f;o.prototype=Object.assign(Object.create(t.prototype),{constructor:o,copy:function(){return new o(this.getValue().copy())},equals:function(e){return this.getValue().equals(e.getValue())},isDefaultValue:function(){return this.getValue().equals(r.Identity)},getTypeName:function(){return"SFRotation"},getType:function(){return i.SFRotation},set:function(e){this.getValue().assign(e)},setAxis:function(e){this.getValue().setAxis(e.getValue()),this.addEvent()},getAxis:function(){return new s(this.getValue().getAxis().copy())},inverse:function(){return new o(r.inverse(this.getValue()))},multiply:function(e){return new o(r.multRight(this.getValue(),e.getValue()))},multVec:function(e){return new s(this.getValue().multVecRot(e.getValue().copy()))},slerp:function(e,t){return new o(r.slerp(this.getValue(),e.getValue(),t))},toStream:function(e){const t=n.Get(e),i=this.getValue();e.string+=t.DoublePrecision(i.x)+" "+t.DoublePrecision(i.y)+" "+t.DoublePrecision(i.z)+" "+t.DoublePrecision(t.ToUnit("angle",i.angle))},toVRMLStream:function(e){this.toStream(e)},toXMLStream:function(e){this.toStream(e)}});for(const e of Reflect.ownKeys(o.prototype))Object.defineProperty(o.prototype,e,{enumerable:!1});const a={get:function(){return this.getValue().x},set:function(e){this.getValue().x=+e,this.addEvent()},enumerable:!0,configurable:!1},u={get:function(){return this.getValue().y},set:function(e){this.getValue().y=+e,this.addEvent()},enumerable:!0,configurable:!1},l={get:function(){return this.getValue().z},set:function(e){this.getValue().z=+e,this.addEvent()},enumerable:!0,configurable:!1},c={get:function(){return this.getValue().angle},set:function(e){this.getValue().angle=+e,this.addEvent()},enumerable:!0,configurable:!1};return Object.defineProperty(o.prototype,"x",a),Object.defineProperty(o.prototype,"y",u),Object.defineProperty(o.prototype,"z",l),Object.defineProperty(o.prototype,"angle",c),a.enumerable=!1,u.enumerable=!1,l.enumerable=!1,c.enumerable=!1,Object.defineProperty(o.prototype,"0",a),Object.defineProperty(o.prototype,"1",u),Object.defineProperty(o.prototype,"2",l),Object.defineProperty(o.prototype,"3",c),o}),define("x_ite/Fields/SFString",["x_ite/Base/X3DField","x_ite/Base/X3DConstants","x_ite/InputOutput/Generator"],function(e,t,i){"use strict";function n(t){return e.call(this,arguments.length?""+t:"")}Object.assign(n,{unescape:function(e){return e.replace(/\\(.)/g,"$1")},escape:function(e){return e.replace(/([\\"])/g,"\\$1")}}),n.prototype=Object.assign(Object.create(e.prototype),{constructor:n,copy:function(){return new n(this.getValue())},getTypeName:function(){return"SFString"},getType:function(){return t.SFString},isDefaultValue:function(){return""===this.getValue()},set:function(t){e.prototype.set.call(this,""+t)},valueOf:e.prototype.getValue,toStream:function(e){e.string+='"'+n.escape(this.getValue())+'"'},toVRMLStream:function(e){this.toStream(e)},toXMLStream:function(e){e.string+=i.Get(e).XMLEncode(this.getValue())}});for(const e of Reflect.ownKeys(n.prototype))Object.defineProperty(n.prototype,e,{enumerable:!1});return Object.defineProperty(n.prototype,"length",{get:function(){return this.getValue().length},enumerable:!0,configurable:!1}),n}),define("x_ite/Fields/SFTime",["x_ite/Base/X3DField","x_ite/Base/X3DConstants"],function(e,t){"use strict";function i(t){return e.call(this,arguments.length?+t:0)}i.prototype=Object.assign(Object.create(e.prototype),{constructor:i,copy:function(){return new i(this.getValue())},getTypeName:function(){return"SFTime"},getType:function(){return t.SFTime},isDefaultValue:function(){return 0===this.getValue()},set:function(t){e.prototype.set.call(this,+t)},valueOf:e.prototype.getValue,toStream:function(e){e.string+=this.getValue()},toVRMLStream:function(e){this.toStream(e)},toXMLStream:function(e){this.toStream(e)}});for(const e of Reflect.ownKeys(i.prototype))Object.defineProperty(i.prototype,e,{enumerable:!1});return i}),define("x_ite/Fields/SFVec4",["x_ite/Base/X3DField","x_ite/Fields/SFVecPrototypeTemplate","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector4"],function(e,t,i,n){"use strict";function r(i,r,o){function s(t,i,r,o){switch(arguments.length){case 0:return e.call(this,new n(0,0,0,0));case 1:return e.call(this,arguments[0]);case 4:return e.call(this,new n(+t,+i,+r,+o))}throw new Error("Invalid arguments.")}s.prototype=Object.assign(Object.create(e.prototype),t(n,o),{constructor:s,getTypeName:function(){return i},getType:function(){return r}});for(const e of Reflect.ownKeys(s.prototype))Object.defineProperty(s.prototype,e,{enumerable:!1});const a={get:function(){return this.getValue().x},set:function(e){this.getValue().x=+e,this.addEvent()},enumerable:!0,configurable:!1},u={get:function(){return this.getValue().y},set:function(e){this.getValue().y=+e,this.addEvent()},enumerable:!0,configurable:!1},l={get:function(){return this.getValue().z},set:function(e){this.getValue().z=+e,this.addEvent()},enumerable:!0,configurable:!1},c={get:function(){return this.getValue().w},set:function(e){this.getValue().w=+e,this.addEvent()},enumerable:!0,configurable:!1};return Object.defineProperty(s.prototype,"x",a),Object.defineProperty(s.prototype,"y",u),Object.defineProperty(s.prototype,"z",l),Object.defineProperty(s.prototype,"w",c),a.enumerable=!1,u.enumerable=!1,l.enumerable=!1,c.enumerable=!1,Object.defineProperty(s.prototype,"0",a),Object.defineProperty(s.prototype,"1",u),Object.defineProperty(s.prototype,"2",l),Object.defineProperty(s.prototype,"3",c),s}return{SFVec4d:r("SFVec4d",i.SFVec4d,!0),SFVec4f:r("SFVec4f",i.SFVec4f,!1)}}),define("x_ite/Base/X3DArrayField",["x_ite/Base/X3DField"],function(e){"use strict";function t(t){e.call(this,t)}t.prototype=Object.assign(Object.create(e.prototype),{constructor:t});for(const e of Reflect.ownKeys(t.prototype))Object.defineProperty(t.prototype,e,{enumerable:!1});return t}),define("x_ite/Base/X3DObjectArrayField",["jquery","x_ite/Base/X3DField","x_ite/Base/X3DArrayField","x_ite/InputOutput/Generator"],function(e,t,i,n){"use strict";function r(e){const t=new Proxy(this,a);return i.call(this,[]),this[o]=this,this[s]=t,e[0]instanceof Array&&(e=e[0]),r.prototype.push.apply(this,e),t}const o=Symbol(),s=Symbol(),a={get:function(e,t){const i=e[t];if(void 0!==i)return i;if("string"==typeof t){const i=e.getValue(),n=+t;return Number.isInteger(n)?(n>=i.length&&e.resize(n+1),i[n].valueOf()):e[t]}},set:function(e,t,i){if(t in e)return e[t]=i,!0;const n=e.getValue(),r=+t;return r>=n.length&&e.resize(r+1),n[r].setValue(i),!0},has:function(e,t){return Number.isInteger(+t)?t<e.getValue().length:t in e},ownKeys:function(e){return Object.keys(e.getValue())},getOwnPropertyDescriptor:function(e,t){if("string"==typeof t){const i=+t;return Number.isInteger(i)&&i<e.getValue().length?Object.getOwnPropertyDescriptor(e.getValue(),t):void 0}}};r.prototype=Object.assign(Object.create(i.prototype),{constructor:r,[o]:null,[s]:null,[Symbol.iterator]:function*(){const e=this[o],t=e.getValue();for(const e of t)yield e.valueOf()},getTarget:function(){return this[o]},copy:function(){const e=this[o],t=new e.constructor,i=e.getValue();return r.prototype.push.apply(t,i),t.setModificationTime(0),t},equals:function(e){const t=this[o],i=t.getValue(),n=e.getValue(),r=i.length;if(i===n)return!0;if(r!==n.length)return!1;for(let e=0;e<r;++e)if(!i[e].equals(n[e]))return!1;return!0},set:function(e){const i=this[o];i.resize(e.length,void 0,!0);const n=i.getValue();for(let i=0,r=e.length;i<r;++i)n[i].set(e[i]instanceof t?e[i].getValue():e[i])},isDefaultValue:function(){return 0===this.length},setValue:function(e){const t=this[o];t.set(e instanceof r?e.getValue():e),t.addEvent()},unshift:function(e){const t=this[o],i=t.getValue();for(let e=arguments.length-1;e>=0;--e){const n=new(t.getSingleType());n.setValue(arguments[e]),t.addChildObject(n),i.unshift(n)}return t.addEvent(),i.length},shift:function(){const e=this[o],t=e.getValue();if(t.length){const i=t.shift();return e.removeChildObject(i),e.addEvent(),i.valueOf()}},push:function(e){const t=this[o],i=t.getValue();for(const e of arguments){const n=new(t.getSingleType());n.setValue(e),t.addChildObject(n),i.push(n)}return t.addEvent(),i.length},pop:function(){const e=this[o],t=e.getValue();if(t.length){const i=t.pop();return e.removeChildObject(i),e.addEvent(),i.valueOf()}},splice:function(e,t){const i=this[o],n=i.getValue();e>n.length&&(e=n.length),e+t>n.length&&(t=n.length-e);const r=i.erase(e,e+t);return arguments.length>2&&i.insert(e,arguments,2,arguments.length),r},insert:function(e,t,i,n){const r=this[o],s=[e,0];for(let e=i;e<n;++e){const i=new(r.getSingleType());i.setValue(t[e]),r.addChildObject(i),s.push(i)}Array.prototype.splice.apply(r.getValue(),s),r.addEvent()},find:function(t,i,n){const r=this[o],s=r.getValue();if(e.isFunction(n)){for(let e=t;e<i;++e)if(n(s[e].valueOf()))return e;return i}for(let e=t;e<i;++e)if(s[e].equals(n))return e;return i},remove:function(t,i,n){const r=this[o],s=r.getValue();if(e.isFunction(n)){if((t=r.find(t,i,n))!==i)for(let e=t;++e<i;){const i=s[e];if(!n(i.valueOf())){const n=s[t];s[t++]=i,s[e]=n}}return t!==i&&r.addEvent(),t}if((t=r.find(t,i,n))!==i)for(let e=t;++e<i;){const i=s[e];if(!i.equals(n)){const n=s[t];s[t++]=i,s[e]=n}}return t!==i&&r.addEvent(),t},erase:function(e,t){const i=this[o],n=i.getValue().splice(e,t-e);for(const e of n)i.removeChildObject(e);return i.addEvent(),new i.constructor(n)},resize:function(e,t,i){const n=this[o],r=n.getValue();if(e<r.length){for(let t=e,i=r.length;t<i;++t)n.removeChildObject(r[t]);r.length=e,i||n.addEvent()}else if(e>r.length){for(let i=r.length;i<e;++i){const e=new(n.getSingleType());void 0!==t&&e.setValue(t),n.addChildObject(e),r.push(e)}i||n.addEvent()}},addChildObject:function(e){e.addParent(this[s])},removeChildObject:function(e){e.removeParent(this[s])},toStream:function(e){const t=this[o],i=t.getValue(),r=n.Get(e);switch(i.length){case 0:e.string+="[ ]";break;case 1:r.PushUnitCategory(t.getUnit()),i[0].toStream(e),r.PopUnitCategory();break;default:r.PushUnitCategory(t.getUnit()),e.string+="[\n",r.IncIndent();for(let t=0,n=i.length-1;t<n;++t)e.string+=r.Indent(),i[t].toStream(e),e.string+=",\n";e.string+=r.Indent(),i.at(-1).toStream(e),e.string+="\n",r.DecIndent(),e.string+=r.Indent(),e.string+="]",r.PopUnitCategory()}},toVRMLStream:function(e){this.toStream(e)},toXMLStream:function(e){const t=this[o];if(t.length){const i=n.Get(e),r=t.getValue();i.PushUnitCategory(t.getUnit());for(const t of r)t.toXMLStream(e),e.string+=", ";r.at(-1).toXMLStream(e),i.PopUnitCategory()}},dispose:function(){const e=this[o],t=e.getValue();for(const i of t)e.removeChildObject(i);t.length=0,i.prototype.dispose.call(e)}});for(const e of Reflect.ownKeys(r.prototype))Object.defineProperty(r.prototype,e,{enumerable:!1});return Object.defineProperty(r.prototype,"length",{get:function(){return this[o].getValue().length},set:function(e){this[o].resize(e)},enumerable:!1,configurable:!1}),r}),define("x_ite/Base/X3DTypedArrayField",["x_ite/Base/X3DArrayField","x_ite/Base/X3DConstants","x_ite/InputOutput/Generator","standard/Math/Algorithm"],function(e,t,i,n){"use strict";function r(t){return e.call(this,new(this.getArrayType())(2)),this[a]=this,this[u]=[],t[0]instanceof Array&&(t=t[0]),r.prototype.push.apply(this,t),new Proxy(this,c)}function o(e,t,i){const n=this.getValue(),r=this[u];for(let t=0;t<i;++t,++e)r[t]=n[e];return t.set.apply(t,r),t}function s(e,t,i){const n=this.getValue();for(let r=0;r<i;++r,++e)n[e]=t[r];this.addEvent()}const a=Symbol(),u=Symbol(),l=Symbol(),c={get:function(e,t){const i=e[t];if(void 0!==i)return i;if("string"==typeof t){const i=+t;if(Number.isInteger(i)){const t=e.getComponents(),n=e.getValueType();let r=e.getValue();if(i>=e[l]&&(r=e.resize(i+1)),1===t)return n(r[i]);{const r=new n,a=r.getValue(),u=i*t;return r.addEvent=s.bind(e,u,a,t),r.getValue=o.bind(e,u,a,t),r}}return e[t]}},set:function(e,t,i){if(t in e)return e[t]=i,!0;const n=e.getComponents();let r=+t,o=e.getValue();if(r>=e[l]&&(o=e.resize(r+1)),1===n)o[r]=i;else{r*=n;for(let e=0;e<n;++e,++r)o[r]=i[e]}return e.addEvent(),!0},has:function(e,t){return Number.isInteger(+t)?t<e[l]:t in e},ownKeys:function(e){const t=[];for(let i=0,n=e[l];i<n;++i)t.push(String(i));return t},getOwnPropertyDescriptor:function(e,t){if("string"==typeof t){const i=+t;return Number.isInteger(i)&&i<e[l]?Object.getOwnPropertyDescriptor(e.getValue(),t):void 0}}};r.prototype=Object.assign(Object.create(e.prototype),{constructor:r,[a]:null,[u]:null,[l]:0,[Symbol.iterator]:function*(){const e=this[a],t=e.getValue(),i=e.getComponents(),n=e.getValueType(),r=e[l];if(1===i)for(let e=0;e<r;++e)yield n(t[e]);else for(let t=0;t<r;++t){const r=new n,a=r.getValue(),u=t*i;r.addEvent=s.bind(e,u,a,i),r.getValue=o.bind(e,u,a,i),yield r}},getTarget:function(){return this[a]},copy:function(){const t=this[a],i=t.getValue(),n=new t.constructor,r=new(t.getArrayType())(i);return n[l]=t[l],e.prototype.set.call(n,r,t[l]),n.setModificationTime(0),n},equals:function(e){if(this===e)return!0;const t=this[a],i=t[l];if(i!==e[l])return!1;const n=t.getValue(),r=e.getValue();for(let e=0,o=i*t.getComponents();e<o;++e)if(n[e]!==r[e])return!1;return!0},assign:function(e){const t=this[a];t.set(e.getValue(),e.length),t.addEvent()},set:function(e,t){const i=this[a],n=i.getComponents(),r=i[l];let o=i.getValue(),s=void 0!==t?t*n:e.length;const u=s%n;u&&(s-=u,console.warn("Array length must be multiple of components size, which is "+n+".")),s/=n,o.length<e.length?(o=i.grow(e.length),o.set(e),u&&o.fill(0,s*n,s*n+u)):(o.set(e),s<r&&o.fill(0,s*n,r*n)),i[l]=s},isDefaultValue:function(){return 0===this[l]},setValue:function(e){const t=this[a];e instanceof t.constructor?t.assign(e):(t.set(e),t.addEvent())},unshift:function(e){const t=this[a],i=t.getComponents(),n=t[l],r=arguments.length,o=t.grow((n+r)*i);if(o.copyWithin(r*i,0,n*i),1===i)o.set(arguments,0);else for(let e=0,t=0;t<r;++t){const n=arguments[t];for(let t=0;t<i;++t,++e)o[e]=n[t]}return t[l]+=r,t.addEvent(),o.length},shift:function(){const e=this[a],t=e[l];if(t){const n=e.getValue(),r=e.getComponents(),o=e.getValueType(),s=t-1;if(1===r)var i=o(n[0]);else{const t=e[u];for(let e=0;e<r;++e)t[e]=n[e];var i=Object.create(o.prototype);o.apply(i,t)}return n.copyWithin(0,r,t*r),n.fill(0,r*s,t*r),e[l]=s,e.addEvent(),i}},push:function(e){const t=this[a],i=t.getComponents(),n=t[l],r=arguments.length,o=t.grow((n+r)*i);if(1===i)o.set(arguments,n);else for(let e=n*i,t=0;t<r;++t){const n=arguments[t];for(let t=0;t<i;++t,++e)o[e]=n[t]}return t[l]+=r,t.addEvent(),t[l]},pop:function(){const e=this[a],t=e[l];if(t){const n=e.getValue(),r=e.getComponents(),o=e.getValueType(),s=t-1;if(1===r)var i=o(n[t-1]);else{const t=e[u];for(let e=0,i=s*r;e<r;++e,++i)t[e]=n[i];var i=Object.create(o.prototype);o.apply(i,t)}return n.fill(0,s*r,t*r),e[l]=s,e.addEvent(),i}},splice:function(e,t){const i=this[a],n=i[l];e>n&&(e=n),e+t>n&&(t=n-e);const r=i.erase(e,e+t);return arguments.length>2&&i.spliceInsert(e,Array.prototype.splice.call(arguments,2)),i.addEvent(),r},spliceInsert:function(e,t){const i=this[a],n=i.getComponents(),r=i[l],o=t.length,s=i.grow((r+o)*n);if(e*=n,s.copyWithin(e+o*n,e,r*n),1===n)s.set(t,e);else for(let i=0,r=e;i<o;++i){const e=t[i];for(let t=0;t<n;++t,++r)s[r]=e[t]}i[l]+=o},insert:function(e,t,i,n){const r=this[a],o=r[l],s=t.getValue(),u=r.getComponents(),c=n-i,h=r.grow((o+c)*u);for(e*=u,i*=u,n*=u,h.copyWithin(e+c*u,e,o*u);i<n;++e,++i)h[e]=s[i];r[l]+=c,r.addEvent()},erase:function(e,t){const i=this[a],n=i.getValue(),r=i.getComponents(),o=t-e,s=i[l],u=s-o,c=new i.constructor,h=c.grow(o*r);e*=r,t*=r;for(let i=0,r=e;r<t;++i,++r)h[i]=n[r];return n.copyWithin(e,t,s*r),n.fill(0,u*r,s*r),i[l]=u,c[l]=o,i.addEvent(),c},resize:function(e,t,i){const n=this[a],r=n[l],o=n.getComponents();let s=n.getValue();if(e<r)s.fill(0,e*o,r*o),i||n.addEvent();else if(e>r){if(s=n.grow(e*o),void 0!==t)if(1===o)s.fill(t,r*o,e*o);else for(let i=r*o,n=e*o;i<n;)for(let e=0;e<o;++e,++i)s[i]=t[e];i||n.addEvent()}return n[l]=e,s},grow:function(t){const i=this[a],r=i.getValue();if(t<r.length)return r;const o=n.nextPowerOfTwo(t),s=new(i.getArrayType())(o);return s.set(r),e.prototype.set.call(i,s),s},shrinkToFit:function(){const t=this[a],i=t.getValue(),n=t[l]*t.getComponents();if(i.length==n)return i;const r=i.subarray(0,n);return e.prototype.set.call(t,r),r},toStream:function(e){const t=this[a],n=i.Get(e),r=t.getValue(),o=t[l],s=t.getComponents(),u=new(t.getSingleType());switch(o){case 0:e.string+="[ ]";break;case 1:if(n.PushUnitCategory(t.getUnit()),1===s)u.set(r[0]),u.toStream(e);else{for(let e=0,t=0;e<s;++e,++t)u[e]=r[t];u.toStream(e)}n.PopUnitCategory();break;default:if(n.PushUnitCategory(t.getUnit()),e.string+="[\n",n.IncIndent(),1===s){for(let t=0,i=o-1;t<i;++t)e.string+=n.Indent(),u.set(r[t*s]),u.toStream(e),e.string+=",\n";e.string+=n.Indent(),u.set(r[(o-1)*s]),u.toStream(e),e.string+="\n"}else{for(let t=0,i=o-1;t<i;++t){e.string+=n.Indent();for(let e=0,i=t*s;e<s;++e,++i)u[e]=r[i];u.toStream(e),e.string+=",\n"}e.string+=n.Indent();for(let e=0,t=(o-1)*s;e<s;++e,++t)u[e]=r[t];u.toStream(e),e.string+="\n"}n.DecIndent(),e.string+=n.Indent(),e.string+="]",n.PopUnitCategory()}},toVRMLStream:function(e){this.toStream(e)},toXMLStream:function(e){const t=this[a],n=t[l];if(n){const r=i.Get(e),o=t.getValue(),s=t.getComponents(),a=new(t.getSingleType());if(r.PushUnitCategory(t.getUnit()),1===s){for(let t=0,i=n-1;t<i;++t)a.set(o[t*s]),a.toXMLStream(e),e.string+=", ";a.set(o[(n-1)*s]),a.toXMLStream(e)}else{for(let t=0,i=n-1;t<i;++t){for(let e=0,i=t*s;e<s;++e,++i)a[e]=o[i];a.toXMLStream(e),e.string+=", "}for(let e=0,t=(n-1)*s;e<s;++e,++t)a[e]=o[t];a.toXMLStream(e)}r.PopUnitCategory()}},dispose:function(){e.prototype.dispose.call(this[a])}});for(const e of Reflect.ownKeys(r.prototype))Object.defineProperty(r.prototype,e,{enumerable:!1});return Object.defineProperty(r.prototype,"length",{get:function(){return this[l]},set:function(e){this[a].resize(e)},enumerable:!1,configurable:!1}),r}),define("x_ite/Fields/ArrayFields",["x_ite/Fields/SFBool","x_ite/Fields/SFColor","x_ite/Fields/SFColorRGBA","x_ite/Fields/SFDouble","x_ite/Fields/SFFloat","x_ite/Fields/SFImage","x_ite/Fields/SFInt32","x_ite/Fields/SFMatrix3","x_ite/Fields/SFMatrix4","x_ite/Fields/SFNode","x_ite/Fields/SFRotation","x_ite/Fields/SFString","x_ite/Fields/SFTime","x_ite/Fields/SFVec2","x_ite/Fields/SFVec3","x_ite/Fields/SFVec4","x_ite/Base/X3DObjectArrayField","x_ite/Base/X3DTypedArrayField","x_ite/Base/X3DConstants","x_ite/InputOutput/Generator"],function(e,t,i,n,r,o,s,a,u,l,c,h,d,p,f,g,m,y,_,x){"use strict";function w(e){return m.call(this,arguments)}function b(e){return m.call(this,arguments)}function v(e,t,i,n,r,o){function s(e){return y.call(this,arguments)}s.prototype=Object.assign(Object.create(y.prototype),{constructor:s,getSingleType:function(){return i},getValueType:function(){return n},getArrayType:function(){return r},getComponents:function(){return o},getTypeName:function(){return e},getType:function(){return t}});for(const e of Reflect.ownKeys(s.prototype))Object.defineProperty(s.prototype,e,{enumerable:!1});return s}function S(e){return e}const T=a.SFMatrix3d,C=a.SFMatrix3f,F=u.SFMatrix4d,O=u.SFMatrix4f,N=p.SFVec2d,E=p.SFVec2f,D=f.SFVec3d,M=f.SFVec3f,V=g.SFVec4d,I=g.SFVec4f,B=Symbol();w.prototype=Object.assign(Object.create(m.prototype),{constructor:w,[B]:0,getSingleType:function(){return l},getValueType:function(){return l},getArrayType:function(){return Array},getComponents:function(){return 1},getTypeName:function(){return"MFNode"},getType:function(){return _.MFNode},copy:function(e){if(e){const t=new w;for(const i of this.getValue())t.push(i.copy(e));return t.setModificationTime(0),t}return m.prototype.copy.call(this)},addCloneCount:function(e){this[B]+=e;for(const t of this.getValue())t.addCloneCount(e)},removeCloneCount:function(e){this[B]-=e;for(const t of this.getValue())t.removeCloneCount(e)},addChildObject:function(e){m.prototype.addChildObject.call(this,e),e.addCloneCount(this[B])},removeChildObject:function(e){m.prototype.removeChildObject.call(this,e),e.removeCloneCount(this[B])},toStream:function(e){const t=this.getTarget(),i=t.getValue(),n=x.Get(e);switch(i.length){case 0:e.string+="[ ]";break;case 1:n.PushUnitCategory(t.getUnit()),i[0].toStream(e),n.PopUnitCategory();break;default:n.PushUnitCategory(t.getUnit()),e.string+="[\n",n.IncIndent();for(let t=0,r=i.length;t<r;++t)e.string+=n.Indent(),i[t].toStream(e),e.string+="\n";n.DecIndent(),e.string+=n.Indent(),e.string+="]",n.PopUnitCategory()}},toVRMLString:function(){this.addCloneCount(1);const e=m.prototype.toVRMLString.call(this);return this.removeCloneCount(1),e},toVRMLStream:function(e){const t=this.getTarget(),i=t.getValue(),n=x.Get(e);switch(i.length){case 0:e.string+="[ ]";break;case 1:n.EnterScope(),i[0].toVRMLStream(e),n.LeaveScope();break;default:n.EnterScope(),e.string+="[\n",n.IncIndent();for(const t of i)e.string+=n.Indent(),t.toVRMLStream(e),e.string+="\n";n.DecIndent(),e.string+=n.Indent(),e.string+="]",n.LeaveScope()}},toXMLString:function(){this.addCloneCount(1);const e=m.prototype.toXMLString.call(this);return this.removeCloneCount(1),e},toXMLStream:function(e){const t=x.Get(e),i=this.length;if(i){t.EnterScope();const n=this.getValue();for(let r=0,o=i-1;r<o;++r){const i=n[r].getValue();if(i)i.toXMLStream(e),e.string+="\n";else{e.string+=t.Indent(),e.string+="<",e.string+="NULL";const i=t.ContainerField();i&&(e.string+=" ",e.string+="containerField='",e.string+=t.XMLEncode(i.getName()),e.string+="'"),e.string+="/>"}}const r=n.at(-1).getValue();if(r)r.toXMLStream(e);else{e.string+=t.Indent(),e.string+="<",e.string+="NULL";const i=t.ContainerField();i&&(e.string+=" ",e.string+="containerField='",e.string+=t.XMLEncode(i.getName()),e.string+="'")}t.LeaveScope()}},dispose:function(){this.resize(0),m.prototype.dispose.call(this)}});for(const e of Reflect.ownKeys(w.prototype))Object.defineProperty(w.prototype,e,{enumerable:!1});b.prototype=Object.assign(Object.create(m.prototype),{constructor:b,getValueType:function(){return String},getSingleType:function(){return h},getArrayType:function(){return Array},getComponents:function(){return 1},getTypeName:function(){return"MFString"},getType:function(){return _.MFString},toXMLStream:function(e){const t=this.length;if(t){const i=this.getValue();for(let n=0,r=t-1;n<r;++n)e.string+='"',i[n].toXMLStream(e),e.string+='"',e.string+=", ";e.string+='"',i.at(-1).toXMLStream(e),e.string+='"'}}});for(const e of Reflect.ownKeys(b.prototype))Object.defineProperty(b.prototype,e,{enumerable:!1});return{MFBool:v("MFBool",_.MFBool,e,Boolean,Uint8Array,1),MFColor:v("MFColor",_.MFColor,t,t,Float32Array,3),MFColorRGBA:v("MFColorRGBA",_.MFColorRGBA,i,i,Float32Array,4),MFDouble:v("MFDouble",_.MFDouble,n,S,Float64Array,1),MFFloat:v("MFFloat",_.MFFloat,r,S,Float32Array,1),MFImage:function(e,t,i,n,r,o){function s(e){return m.call(this,arguments)}s.prototype=Object.assign(Object.create(m.prototype),{constructor:s,getSingleType:function(){return i},getValueType:function(){return n},getArrayType:function(){return r},getComponents:function(){return o},getTypeName:function(){return e},getType:function(){return t}});for(const e of Reflect.ownKeys(s.prototype))Object.defineProperty(s.prototype,e,{enumerable:!1});return s}("MFImage",_.MFImage,o,o,Array,1),MFInt32:v("MFInt32",_.MFInt32,s,S,Int32Array,1),MFMatrix3d:v("MFMatrix3d",_.MFMatrix3d,T,T,Float64Array,9),MFMatrix3f:v("MFMatrix3f",_.MFMatrix3f,C,C,Float32Array,9),MFMatrix4d:v("MFMatrix4d",_.MFMatrix4d,F,F,Float64Array,16),MFMatrix4f:v("MFMatrix4f",_.MFMatrix4f,O,O,Float32Array,16),MFNode:w,MFRotation:v("MFRotation",_.MFRotation,c,c,Float64Array,4),MFString:b,MFTime:v("MFTime",_.MFTime,d,S,Float64Array,1),MFVec2d:v("MFVec2d",_.MFVec2d,N,N,Float64Array,2),MFVec2f:v("MFVec2f",_.MFVec2f,E,E,Float32Array,2),MFVec3d:v("MFVec3d",_.MFVec3d,D,D,Float64Array,3),MFVec3f:v("MFVec3f",_.MFVec3f,M,M,Float32Array,3),MFVec4d:v("MFVec4d",_.MFVec4d,V,V,Float64Array,4),MFVec4f:v("MFVec4f",_.MFVec4f,I,I,Float32Array,4)}}),define("x_ite/Fields",["x_ite/Fields/SFBool","x_ite/Fields/SFColor","x_ite/Fields/SFColorRGBA","x_ite/Fields/SFDouble","x_ite/Fields/SFFloat","x_ite/Fields/SFImage","x_ite/Fields/SFInt32","x_ite/Fields/SFMatrix3","x_ite/Fields/SFMatrix4","x_ite/Fields/SFNode","x_ite/Fields/SFRotation","x_ite/Fields/SFString","x_ite/Fields/SFTime","x_ite/Fields/SFVec2","x_ite/Fields/SFVec3","x_ite/Fields/SFVec4","x_ite/Fields/ArrayFields"],function(e,t,i,n,r,o,s,a,u,l,c,h,d,p,f,g,m){"use strict";return Object.assign({SFBool:e,SFColor:t,SFColorRGBA:i,SFDouble:n,SFFloat:r,SFImage:o,SFInt32:s,SFMatrix3d:a.SFMatrix3d,SFMatrix3f:a.SFMatrix3f,
SFMatrix4d:u.SFMatrix4d,SFMatrix4f:u.SFMatrix4f,SFNode:l,SFRotation:c,SFString:h,SFTime:d,SFVec2d:p.SFVec2d,SFVec2f:p.SFVec2f,SFVec3d:f.SFVec3d,SFVec3f:f.SFVec3f,SFVec4d:g.SFVec4d,SFVec4f:g.SFVec4f,VrmlMatrix:u.VrmlMatrix},m)}),define("x_ite/Base/X3DBaseNode",["x_ite/Base/X3DEventObject","x_ite/Base/Events","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Base/FieldArray","x_ite/Fields","x_ite/Base/X3DConstants"],function(e,t,i,n,r,o,s){"use strict";function a(t){if(!this[u]){e.call(this,t.getBrowser()),this[u]=t,this[l]=[s.X3DBaseNode],this[h]=new r,this[d]=new r,this[p]=new Map,this[f]=new r,this[m]=!0,this[g]=!1,this[_]=!1,this[x]=0,this.canUserDefinedFields()&&(this[c]=new n(this[c]));for(const e of this[c])this.addField(e)}}const u=Symbol(),l=Symbol(),c=Symbol.for("X3DBaseNode.fieldDefinitions"),h=Symbol(),d=Symbol(),p=Symbol(),f=Symbol(),g=Symbol(),m=Symbol(),y=Symbol("X3DBaseNode.set_live__"),_=Symbol(),x=Symbol();a.prototype=Object.assign(Object.create(e.prototype),{constructor:a,[c]:new n([]),getMainScene:function(){let e=this[u].getScene();for(;!e.isMainScene();)e=e.getScene();return e},getScene:function(){const e=require("x_ite/Execution/X3DScene");let t=this[u];for(;!(t instanceof e);)t=t.getExecutionContext();return t},getExecutionContext:function(){return this[u]},setExecutionContext:function(e){this[u]=e},addType:function(e){this[l].push(e)},getType:function(){return this[l]},isType:function(e){return this[l].some(function(t){return e.has(t)})},getInnerNode:function(){return this},isLive:function(){function e(){return this.isLive_}return function(){return Object.defineProperty(this,"isLive",{value:e,enumerable:!1,configurable:!0}),this.addChildObjects("isLive",new o.SFBool(this.getLiveState())),this.isLive_.removeParent(this),this[u]!==this&&this[u].isLive().addInterest(y,this),this.isLive()}}(),setLive:function(e){this[m]=e.valueOf(),this[y]()},getLive:function(){return this[m]},getLiveState:function(){return this!==this[u]?this.getLive()&&this[u].isLive().getValue():this.getLive()},[y]:function(){const e=this.getLiveState(),i=this.isLive();if(e){if(i.getValue())return;i.setValue(!0),i.processEvent(t.create(i))}else i.getValue()&&(i.setValue(!1),i.processEvent(t.create(i)))},setInitialized:function(e){this[g]=e},isInitialized:function(){return this[g]},setup:function(){if(!this[g]){this[g]=!0;for(const e of this[h])e.setTainted(!1);this.initialize()}},initialize:function(){},create:function(e){return new this.constructor(e)},flatCopy:function(e){const t=this.create(e||this.getExecutionContext());for(const e of this[h])t.getField(e.getName()).assign(e);return t.setup(),t},addChildObjects:function(e,t){for(let e=0,t=arguments.length;e<t;e+=2)this.addChildObject(arguments[e],arguments[e+1])},addChildObject:function(e,t){t.addParent(this),t.setName(e),Object.defineProperty(this,e+"_",{get:function(){return t},set:function(e){t.setValue(e)},enumerable:!1,configurable:!1})},getFieldDefinitions:function(){return this[c]},getFieldsAreEnumerable:function(){return!1},addField:function(e){const t=e.accessType,i=e.name,n=e.value.copy();n.setTainted(!0),n.addParent(this),n.setName(i),n.setAccessType(t),this[h].add(i,n),this[d].add(i,n),Object.defineProperty(this,i+"_",{get:function(){return n},set:function(e){n.setValue(e)},enumerable:this.getFieldsAreEnumerable(),configurable:!0}),this.getPrivate()||n.addCloneCount(1)},getField:function(){return function(e){const t=this[h].get(e)||this[p].get(e);if(t)return t;const i=e.match(/^set_(.*?)$/);if(i){const e=this[h].get(i[1])||this[p].get(i[1]);if(e&&e.getAccessType()===s.inputOutput)return e}else{const t=e.match(/^(.*?)_changed$/);if(t){const e=this[h].get(t[1])||this[p].get(t[1]);if(e&&e.getAccessType()===s.inputOutput)return e}}throw new Error("Unknown field '"+e+"' in node class "+this.getTypeName()+".")}}(),addAlias:function(e,t){this[p].set(e,t),Object.defineProperty(this,e+"_",{get:function(){return t},set:function(e){t.setValue(e)},enumerable:!0,configurable:!1})},removeField:function(e){const t=this[d].get(e);t&&(this[h].remove(e),this[d].remove(e),delete this[t.getName()+"_"],this.getPrivate()||t.removeCloneCount(1))},canUserDefinedFields:function(){return!1},addUserDefinedField:function(e,t,n){this[f].has(t)&&this.removeUserDefinedField(t),n.setTainted(!0),n.addParent(this),n.setName(t),n.setAccessType(e),this[c].add(t,new i(e,t,n)),this[h].add(t,n),this[f].add(t,n),this.getPrivate()||n.addCloneCount(1)},removeUserDefinedField:function(e){const t=this[f].get(e);t&&(this[h].remove(e),this[f].remove(e),this[c].remove(e),this.getPrivate()||t.removeCloneCount(1))},getUserDefinedFields:function(){return this[f]},getPredefinedFields:function(){return this[d]},getChangedFields:function(e){const t=[];if(e)for(const e of this[f])t.push(e);for(const i of this[d])if(e&&(i.getInputRoutes().size||i.getOutputRoutes().size))t.push(i);else{if(0===i.getReferences().size){if(!i.isInitializable())continue;if(this.isDefaultValue(i))continue}t.push(i)}return t},isDefaultValue:function(e){const t=this.getFieldDefinitions().get(e.getName());return t?t.value.equals(e):!e.getModificationTime()},getFields:function(){return this[h]},getSourceText:function(){return null},hasRoutes:function(){for(const e of this[h]){if(e.getInputRoutes().size)return!0;if(e.getOutputRoutes().size)return!0}return!1},getPrivate:function(){return this[_]},setPrivate:function(e){if(this[_]=e,e)for(const e of this[h])e.removeCloneCount(1);else for(const e of this[h])e.addCloneCount(1)},getCloneCount:function(){return this[x]},addCloneCount:function(e){0!==e&&(this[x]+=e)},removeCloneCount:function(e){0!==e&&(this[x]-=e)}});for(const e of Reflect.ownKeys(a.prototype))Object.defineProperty(a.prototype,e,{enumerable:!1});return a}),define("x_ite/Browser/VERSION",[],function(){return"5.0.0a"}),define("x_ite/DEBUG",[],function(){"use strict";return!1}),define("text/text",["module"],function(e){"use strict";function t(e,t){return void 0===e||""===e?t:e}function i(e,i,n,r){if(i===r)return!0;if(e===n){if("http"===e)return t(i,"80")===t(r,"80");if("https"===e)return t(i,"443")===t(r,"443")}return!1}var n,r,o,s,a,u=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],l="undefined"!=typeof location&&location.href,c=l&&location.protocol&&location.protocol.replace(/\:/,""),h=l&&location.hostname,d=l&&(location.port||void 0),p={},f=e.config&&e.config()||{};return n={version:"2.0.16",strip:function(e){if(e){e=e.replace(/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,"");var t=e.match(/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:f.createXhr||function(){var e,t,i;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;t<3;t+=1){i=u[t];try{e=new ActiveXObject(i)}catch(e){}if(e){u=[i];break}}return e},parseName:function(e){var t,i,n,r=!1,o=e.lastIndexOf("."),s=0===e.indexOf("./")||0===e.indexOf("../");return o!==-1&&(!s||o>1)?(t=e.substring(0,o),i=e.substring(o+1)):t=e,n=i||t,o=n.indexOf("!"),o!==-1&&(r="strip"===n.substring(o+1),n=n.substring(0,o),i?i=n:t=n),{moduleName:t,ext:i,strip:r}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,t,r,o){var s,a,u,l=n.xdRegExp.exec(e);return!l||(s=l[2],a=l[3],a=a.split(":"),u=a[1],a=a[0],(!s||s===t)&&(!a||a.toLowerCase()===r.toLowerCase())&&(!u&&!a||i(s,u,t,o)))},finishLoad:function(e,t,i,r){i=t?n.strip(i):i,f.isBuild&&(p[e]=i),r(i)},load:function(e,t,i,r){if(r&&r.isBuild&&!r.inlineText)return void i();f.isBuild=r&&r.isBuild;var o=n.parseName(e),s=o.moduleName+(o.ext?"."+o.ext:""),a=t.toUrl(s),u=f.useXhr||n.useXhr;if(0===a.indexOf("empty:"))return void i();!l||u(a,c,h,d)?n.get(a,function(t){n.finishLoad(e,o.strip,t,i)},function(e){i.error&&i.error(e)}):t([s],function(e){n.finishLoad(o.moduleName+"."+o.ext,o.strip,e,i)},function(e){i.error&&i.error(e)})},write:function(e,t,i,r){if(p.hasOwnProperty(t)){var o=n.jsEscape(p[t]);i.asModule(e+"!"+t,"define(function () { return '"+o+"';});\n")}},writeFile:function(e,t,i,r,o){var s=n.parseName(t),a=s.ext?"."+s.ext:"",u=s.moduleName+a,l=i.toUrl(s.moduleName+a)+".js";n.load(u,i,function(t){var i=function(e){return r(l,e)};i.asModule=function(e,t){return r.asModule(e,l,t)},n.write(e,u,i,o)},o)}},"node"!==f.env&&(f.env,1)?"xhr"===f.env||!f.env&&n.createXhr()?n.get=function(e,t,i,r){var o,s=n.createXhr();if(s.open("GET",e,!0),r)for(o in r)r.hasOwnProperty(o)&&s.setRequestHeader(o.toLowerCase(),r[o]);f.onXhr&&f.onXhr(s,e),s.onreadystatechange=function(n){var r,o;4===s.readyState&&(r=s.status||0,r>399&&r<600?(o=new Error(e+" HTTP status: "+r),o.xhr=s,i&&i(o)):t(s.responseText),f.onXhrComplete&&f.onXhrComplete(s,e))},s.send(null)}:"rhino"===f.env||!f.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?n.get=function(e,t){var i,n,r=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),s=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(r),"utf-8")),a="";try{for(i=new java.lang.StringBuffer,n=s.readLine(),n&&n.length()&&65279===n.charAt(0)&&(n=n.substring(1)),null!==n&&i.append(n);null!==(n=s.readLine());)i.append(o),i.append(n);a=String(i.toString())}finally{s.close()}t(a)}:("xpconnect"===f.env||!f.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(o=Components.classes,s=Components.interfaces,Components.utils.import("resource://gre/modules/FileUtils.jsm"),a="@mozilla.org/windows-registry-key;1"in o,n.get=function(e,t){var i,n,r,u={};a&&(e=e.replace(/\//g,"\\")),r=new FileUtils.File(e);try{i=o["@mozilla.org/network/file-input-stream;1"].createInstance(s.nsIFileInputStream),i.init(r,1,0,!1),n=o["@mozilla.org/intl/converter-input-stream;1"].createInstance(s.nsIConverterInputStream),n.init(i,"utf-8",i.available(),s.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),n.readString(i.available(),u),n.close(),i.close(),t(u.value)}catch(e){throw new Error((r&&r.path||"")+": "+e)}}):(r=require.nodeRequire("fs"),n.get=function(e,t,i){try{var n=r.readFileSync(e,"utf8");"\ufeff"===n[0]&&(n=n.substring(1)),t(n)}catch(e){i&&i(e)}}),n}),define("text",["text/text"],function(e){return e}),define("text!locale/de.po",[],function(){return'msgid ""\nmsgstr ""\n"Project-Id-Version: X_ITE\\n"\n"POT-Creation-Date: 2015-12-23 04:56+0100\\n"\n"PO-Revision-Date: 2015-12-23 04:57+0100\\n"\n"Last-Translator: Holger Seelig <holger.seelig@yahoo.de>\\n"\n"Language-Team: \\n"\n"Language: de\\n"\n"MIME-Version: 1.0\\n"\n"Content-Type: text/plain; charset=UTF-8\\n"\n"Content-Transfer-Encoding: 8bit\\n"\n"X-Generator: Poedit 1.8.4\\n"\n"X-Poedit-Basepath: ../x_ite\\n"\n"Plural-Forms: nplurals=2; plural=(n != 1);\\n"\n"X-Poedit-SourceCharset: UTF-8\\n"\n"X-Poedit-SearchPath-0: .\\n"\n\nmsgid "Less Properties"\nmsgstr "Weniger Eigenschaften"\n\nmsgid "More Properties"\nmsgstr "Mehr Eigenschaften"\n\nmsgid "Frame rate"\nmsgstr "Bildrate"\n\nmsgid "fps"\nmsgstr "BpS"\n\nmsgid "Speed"\nmsgstr "Geschwindigkeit"\n\nmsgid "m/s"\nmsgstr ""\n\nmsgid "km/h"\nmsgstr ""\n\nmsgid "Browser"\nmsgstr ""\n\nmsgid "ms"\nmsgstr ""\n\nmsgid "X3D total"\nmsgstr "X3D gesamt"\n\nmsgid "Event Processing"\nmsgstr "Ereignisverarbeitung"\n\nmsgid "Pointer"\nmsgstr "Zeigegerät"\n\nmsgid "Camera"\nmsgstr "Kamera"\n\nmsgid "Collision Detection"\nmsgstr "Kollisionserkennung"\n\nmsgid "Rendering"\nmsgstr "Rendering"\n\nmsgid "Number of Shapes"\nmsgstr "Anzahl der Formen"\n\nmsgid "Number of Sensors"\nmsgstr "Anzahl der Sensoren"\n\nmsgid "Browser Timings"\nmsgstr "Zeitberechnung"\n\nmsgid "X_ITE Browser"\nmsgstr ""\n\nmsgid "Viewpoints"\nmsgstr "Ansichtspunkte"\n\nmsgid "Available Viewers"\nmsgstr "Verfügbare Betrachter"\n\nmsgid "Straighten Horizon"\nmsgstr "Horizont gerade richten"\n\nmsgid "Primitive Quality"\nmsgstr "Qualität der Grundobjekte"\n\nmsgid "High"\nmsgstr "Hoch"\n\nmsgid "high"\nmsgstr "hoch"\n\nmsgid "Medium"\nmsgstr "Mittel"\n\nmsgid "medium"\nmsgstr "mittel"\n\nmsgid "Low"\nmsgstr "Niedrig"\n\nmsgid "low"\nmsgstr "niedrig"\n\nmsgid "Texture Quality"\nmsgstr "Textur Qualität"\n\nmsgid "Display Rubberband"\nmsgstr "Gummiband anzeigen"\n\nmsgid "Rubberband"\nmsgstr "Gummiband"\n\nmsgid "on"\nmsgstr "an"\n\nmsgid "off"\nmsgstr "aus"\n\nmsgid "Mute Browser"\nmsgstr "Browser stumm schalten"\n\nmsgid "Browser muted"\nmsgstr "Browser stumm geschalten"\n\nmsgid "Browser unmuted"\nmsgstr "Browser Ton an"\n\nmsgid "Leave Fullscreen"\nmsgstr "Vollbild verlassen"\n\nmsgid "Fullscreen"\nmsgstr "Vollbild"\n\nmsgid "About X_ITE"\nmsgstr "Über X_ITE"\n\nmsgid "Examine Viewer"\nmsgstr "Untersuchen"\n\nmsgid "Walk Viewer"\nmsgstr "Laufen"\n\nmsgid "Fly Viewer"\nmsgstr "Fliegen"\n\nmsgid "Plane Viewer"\nmsgstr "Ebenen Betrachter"\n\nmsgid "Look At Viewer"\nmsgstr "Auf Objekte zielen"\n\nmsgid "None Viewer"\nmsgstr "Kein Betrachter"\n\nmsgid "Loading %1 file"\nmsgstr "Lade %1 Datei"\n\nmsgid "Loading %1 files"\nmsgstr "Lade %1 Dateien"\n\nmsgid "Loading done"\nmsgstr "Fertig mit Laden"\n\nmsgid "Failed loading world."\nmsgstr "Laden der Dateien fehlgeschlagen."\n\nmsgid "Show World Info"\nmsgstr "World Info anzeigen"\n\nmsgid "Viewpoint is copied to clipboard."\nmsgstr "Ansichtspunkt wurde in die Zwischenablage kopiert."\n'}),define("text!locale/fr.po",[],function(){return'msgid ""\nmsgstr ""\n"Project-Id-Version: X_ITE\\n"\n"POT-Creation-Date: 2015-12-23 04:58+0100\\n"\n"PO-Revision-Date: 2015-12-23 05:07+0100\\n"\n"Last-Translator: Holger Seelig <holger.seelig@yahoo.de>\\n"\n"Language-Team: \\n"\n"Language: fr\\n"\n"MIME-Version: 1.0\\n"\n"Content-Type: text/plain; charset=UTF-8\\n"\n"Content-Transfer-Encoding: 8bit\\n"\n"X-Generator: Poedit 1.8.4\\n"\n"X-Poedit-Basepath: ../x_ite\\n"\n"Plural-Forms: nplurals=2; plural=(n != 1);\\n"\n"X-Poedit-SourceCharset: UTF-8\\n"\n"X-Poedit-SearchPath-0: .\\n"\n\nmsgid "Less Properties"\nmsgstr "Moins de propriétés"\n\nmsgid "More Properties"\nmsgstr "Plus de propriétés"\n\nmsgid "Frame rate"\nmsgstr "Fréquence"\n\nmsgid "fps"\nmsgstr "fps"\n\nmsgid "Speed"\nmsgstr "Vélocité"\n\nmsgid "m/s"\nmsgstr ""\n\nmsgid "km/h"\nmsgstr ""\n\nmsgid "Browser"\nmsgstr "X_ITE Navigateur"\n\nmsgid "ms"\nmsgstr ""\n\nmsgid "X3D total"\nmsgstr "X3D total"\n\nmsgid "Traitement des événements"\nmsgstr "Routes"\n\nmsgid "Pointer"\nmsgstr "Pointeur"\n\nmsgid "Camera"\nmsgstr "Caméra"\n\nmsgid "Collision Detection"\nmsgstr "Détection des collisions"\n\nmsgid "Rendering"\nmsgstr "Rendement"\n\nmsgid "Number of Shapes"\nmsgstr "Nombre de formes"\n\nmsgid "Number of Sensors"\nmsgstr "Nombre de senseurs"\n\nmsgid "Browser Timings"\nmsgstr "Calcul du temps"\n\nmsgid "X_ITE Browser"\nmsgstr "X_ITE Navigateur"\n\nmsgid "Viewpoints"\nmsgstr "Points de vue"\n\nmsgid "Available Viewers"\nmsgstr "Visionneurs disponibles"\n\nmsgid "Straighten Horizon"\nmsgstr "Redresser l\'horizon"\n\nmsgid "Primitive Quality"\nmsgstr "Qualité des objets simples"\n\nmsgid "High"\nmsgstr "Haut"\n\nmsgid "high"\nmsgstr "haut"\n\nmsgid "Medium"\nmsgstr "Moyenne"\n\nmsgid "medium"\nmsgstr "moyenne"\n\nmsgid "Low"\nmsgstr "Faible"\n\nmsgid "low"\nmsgstr "faible"\n\nmsgid "Texture Quality"\nmsgstr "Qualité des textures"\n\nmsgid "Display Rubberband"\nmsgstr "Présenter le bande élastique"\n\nmsgid "Rubberband"\nmsgstr "Bande élastique"\n\nmsgid "on"\nmsgstr "marche"\n\nmsgid "off"\nmsgstr "arrêt"\n\nmsgid "Mute Browser"\nmsgstr "Rendre navigateur muet"\n\nmsgid "Browser muted"\nmsgstr "Navigateur muet"\n\nmsgid "Browser unmuted"\nmsgstr "Son de navigateur réactivé"\n\nmsgid "Leave Fullscreen"\nmsgstr "Sortie en plein écran"\n\nmsgid "Fullscreen"\nmsgstr "Plein écran"\n\nmsgid "About X_ITE"\nmsgstr "À propos de X_ITE"\n\nmsgid "Examine Viewer"\nmsgstr "Examiner"\n\nmsgid "Walk Viewer"\nmsgstr "Aller"\n\nmsgid "Fly Viewer"\nmsgstr "Voler"\n\nmsgid "Plane Viewer"\nmsgstr "Visionneur de la plaine"\n\nmsgid "Look At Viewer"\nmsgstr "Regarder un objet de près"\n\nmsgid "None Viewer"\nmsgstr "Pas de visionneur"\n\nmsgid "Loading %1 file"\nmsgstr "Télécharger %1 fichier"\n\nmsgid "Loading %1 files"\nmsgstr "Télécharger %1 fichiers"\n\nmsgid "Loading done"\nmsgstr "Téléchargement fini"\n\nmsgid "Failed loading world."\nmsgstr "Le chargement des fichiers a échoué."\n\nmsgid "Show World Info"\nmsgstr "Afficher World Info"\n\nmsgid "Viewpoint is copied to clipboard."\nmsgstr "Le point de vue est copié dans le presse-papiers."\n'}),define("locale/gettext",["text!locale/de.po","text!locale/fr.po"],function(e,t){"use strict";function i(e,t){for(var i=null,n=[];i=e.exec(t);)n.push(i);return n}function n(e){var t=r[s];if(void 0===t)return e;var i=t[e];return void 0===i?e:i}var r={en:"C",de:e,fr:t},o=/msgid\s+"(.*?)"\nmsgstr\s+"(.*?)"\n/g,s=function(){for(var e=0;e<navigator.languages;++e){var t=navigator.languages[e].split("-")[0];if(r[t])return t}return(navigator.language||navigator.userLanguage).split("-")[0]}();return function(e){if(r[e])for(var t=i(o,r[e]),n=r[e]={},s=0,a=t.length;s<a;++s)t[s][2].length&&(n[t[s][1]]=t[s][2])}(s),n}),define("x_ite/Browser/Core/BrowserTimings",["jquery","x_ite/Base/X3DBaseNode","locale/gettext"],function(e,t,i){"use strict";function n(e){return e.toFixed(2)}function r(e){t.call(this,e),this.localStorage=this.getBrowser().getLocalStorage().addNameSpace("BrowserTimings."),this.enabled=!1}return r.prototype=Object.assign(Object.create(t.prototype),{constructor:r,getTypeName:function(){return"BrowserTimings"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"browserTimings"},initialize:function(){t.prototype.initialize.call(this),this.localStorage.addDefaultValues({type:"LESS"}),this.localeOptions={minimumFractionDigits:2,maximumFractionDigits:2},this.startTime=0,this.frames=0,this.element=e("<div></div>").addClass("x_ite-private-browser-timings").appendTo(this.getBrowser().getSurface()),this.table=e("<table></table>").appendTo(this.element),this.header=e("<thead></thead>").append(e("<tr></tr>").append(e("<th colspan='2'></th>"))).appendTo(this.table),this.body=e("<tbody></tbody>").appendTo(this.table),this.footer=e("<tfoot></tfoot>").append(e("<tr></tr>").append(e("<td colspan='2'></td>"))).appendTo(this.table),this.button=e("<button></button>").attr("type","button").click(this.set_type__.bind(this)).appendTo(this.footer.find("td")),this.rows=[],this.set_button__()},getEnabled:function(){return this.enabled},setEnabled:function(e){this.enabled!==e&&(this.enabled=e,e?(this.element.fadeIn(),this.getBrowser().prepareEvents().addInterest("update",this),this.update()):(this.element.fadeOut(),this.getBrowser().prepareEvents().removeInterest("update",this)))},set_type__:function(){"MORE"===this.localStorage.type?this.localStorage.type="LESS":this.localStorage.type="MORE",this.set_button__(),this.build()},set_button__:function(){"MORE"===this.localStorage.type?this.button.text(i("Less Properties")):this.button.text(i("More Properties"))},update:function(){const e=this.getBrowser().getCurrentTime();e-this.startTime>1?(this.build(),this.frames=0,this.startTime=e):++this.frames},build:function(){const t=this.getBrowser(),r=t.getCurrentTime(),o=navigator.language||navigator.userLanguage,s=this.localeOptions,a=this.rows;let u=0;if(a[u++]=e("<tr></tr>").append(e("<td></td>").text(i("Frame rate")+":")).append(e("<td></td>").text(n(this.frames/(r-this.startTime)).toLocaleString(o,s)+" "+i("fps"))),a[u++]=e("<tr></tr>").append(e("<td></td>").text(i("Speed")+":")).append(e("<td></td>").text(n(this.getSpeed(t.currentSpeed)).toLocaleString(o,s)+" "+this.getSpeedUnit(t.currentSpeed))),"MORE"===this.localStorage.type){const r=t.getWorld().getLayerSet().getLayers(),l=t.getActiveLayer(),c=t.getSystemTime(),h=l&&t.getCollisionCount()?l.collisionTime:0,d=t.getCollisionTime()+h,p=t.getBrowserTime()-(t.getCameraTime()+t.getCollisionTime()+t.getDisplayTime()+h),f=t.prepareEvents().getInterests().size-1,g=t.sensorEvents().getInterests().size;let m=0,y=0;for(const e of r)m+=e.numOpaqueShapes,y+=e.numTransparentShapes;a[1].addClass("x_ite-private-more"),a[u++]=e("<tr></tr>").append(e("<td></td>").text(i("Browser")+":")).append(e("<td></td>").text(n(c).toLocaleString(o,s)+" "+i("ms"))),a[u++]=e("<tr></tr>").append(e("<td></td>").text(i("X3D total")+":")).append(e("<td></td>").text(n(t.getBrowserTime()).toLocaleString(o,s)+" "+i("ms"))),a[u++]=e("<tr></tr>").append(e("<td></td>").text(i("Event Processing")+":")).append(e("<td></td>").text(n(p).toLocaleString(o,s)+" "+i("ms"))),a[u++]=e("<tr></tr>").append(e("<td></td>").text(i("Pointer")+":")).append(e("<td></td>").text(n(t.getPointerTime()).toLocaleString(o,s)+" "+i("ms"))),a[u++]=e("<tr></tr>").append(e("<td></td>").text(i("Camera")+":")).append(e("<td></td>").text(n(t.getCameraTime()).toLocaleString(o,s)+" "+i("ms"))),a[u++]=e("<tr></tr>").append(e("<td></td>").text(i("Picking")+":")).append(e("<td></td>").text(n(t.getPickingTime()).toLocaleString(o,s)+" "+i("ms"))),a[u++]=e("<tr></tr>").append(e("<td></td>").text(i("Collision Detection")+":")).append(e("<td></td>").text(n(d).toLocaleString(o,s)+" "+i("ms"))),a[u++]=e("<tr></tr>").append(e("<td></td>").text(i("Rendering")+":")).append(e("<td></td>").text(n(t.getDisplayTime()).toLocaleString(o,s)+" "+i("ms"))),a[u++]=e("<tr></tr>").append(e("<td></td>").text(i("Number of Shapes")+":")).append(e("<td></td>").text(m+" + "+y)),a[u++]=e("<tr></tr>").append(e("<td></td>").text(i("Number of Sensors")+":")).append(e("<td></td>").text(f+g))}a.length=u,this.header.find("th").text(i("Browser Timings")),this.body.empty(),this.body.append(a)},getSpeed:function(e){return e<15?e:3.6*e},getSpeedUnit:function(e){return i(e<15?"m/s":"km/h")}}),r}),define("x_ite/Browser/Core/PrimitiveQuality",[],function(){"use strict";let e=0;return{LOW:e++,MEDIUM:e++,HIGH:e++}}),define("x_ite/Browser/Core/Shading",[],function(){"use strict";let e=0;return{POINT:e++,WIREFRAME:e++,FLAT:e++,GOURAUD:e++,PHONG:e++}}),define("x_ite/Browser/Core/TextureQuality",[],function(){"use strict";let e=0;return{LOW:e++,MEDIUM:e++,HIGH:e++}}),define("x_ite/Browser/Core/BrowserOptions",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Base/X3DBaseNode","x_ite/Base/X3DConstants","x_ite/Browser/Core/PrimitiveQuality","x_ite/Browser/Core/Shading","x_ite/Browser/Core/TextureQuality"],function(e,t,i,n,r,o,s,a){"use strict";function u(e,t){return"true"===e||"TRUE"===e||"false"!==e&&"FALSE"!==e&&t}function l(e){n.call(this,e),this.addAlias("AntiAliased",this.Antialiased_);const t=e.getBrowser();this.localStorage=t.getLocalStorage().addNameSpace("BrowserOptions."),this.textureQuality=a.MEDIUM,this.primitiveQuality=o.MEDIUM,this.shading=s.GOURAUD,this.setAttributeSplashScreen()}return l.prototype=Object.assign(Object.create(n.prototype),{constructor:l,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"SplashScreen",new e.SFBool(!0)),new t(r.inputOutput,"Dashboard",new e.SFBool(!0)),new t(r.inputOutput,"Rubberband",new e.SFBool(!0)),new t(r.inputOutput,"EnableInlineViewpoints",new e.SFBool(!0)),new t(r.inputOutput,"Antialiased",new e.SFBool(!0)),new t(r.inputOutput,"TextureQuality",new e.SFString("MEDIUM")),new t(r.inputOutput,"PrimitiveQuality",new e.SFString("MEDIUM")),new t(r.inputOutput,"QualityWhenMoving",new e.SFString("MEDIUM")),new t(r.inputOutput,"Shading",new e.SFString("GOURAUD")),new t(r.inputOutput,"MotionBlur",new e.SFBool),new t(r.inputOutput,"Gravity",new e.SFFloat(9.80665)),new t(r.inputOutput,"StraightenHorizon",new e.SFBool(!0)),new t(r.inputOutput,"LogarithmicDepthBuffer",new e.SFBool(!1)),new t(r.inputOutput,"Timings",new e.SFBool(!1))]),getTypeName:function(){return"BrowserOptions"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"browserOptions"},initialize:function(){n.prototype.initialize.call(this),this.localStorage.addDefaultValues({Rubberband:this.Rubberband_.getValue(),PrimitiveQuality:this.PrimitiveQuality_.getValue(),TextureQuality:this.TextureQuality_.getValue(),StraightenHorizon:this.StraightenHorizon_.getValue(),Timings:this.Timings_.getValue()}),this.SplashScreen_.addInterest("set_splashScreen__",this),this.Rubberband_.addInterest("set_rubberband__",this),this.PrimitiveQuality_.addInterest("set_primitiveQuality__",this),this.TextureQuality_.addInterest("set_textureQuality__",this),this.Shading_.addInterest("set_shading__",this),this.StraightenHorizon_.addInterest("set_straightenHorizon__",this),this.LogarithmicDepthBuffer_.addInterest("set_logarithmicDepthBuffer__",this),this.Timings_.addInterest("set_timings__",this),this.configure()},configure:function(){if(this.isInitialized()){const e=this.localStorage,t=this.getFieldDefinitions();for(const i of t){const t=this.getField(i.name);void 0===e[i.name]&&(t.equals(i.value)||t.setValue(i.value))}const i=e.Rubberband,n=e.PrimitiveQuality,r=e.TextureQuality,o=e.StraightenHorizon,s=e.Timings;this.setAttributeSplashScreen(),i!==this.Rubberband_.getValue()&&(this.Rubberband_=i),n!==this.PrimitiveQuality_.getValue()&&(this.PrimitiveQuality_=n),r!==this.TextureQuality_.getValue()&&(this.TextureQuality_=r),o!==this.StraightenHorizon_.getValue()&&(this.StraightenHorizon_=o),s!==this.Timings_.getValue()&&(this.Timings_=s)}},setAttributeSplashScreen:function(){this.SplashScreen_.set(this.getSplashScreen())},getCache:function(){return u(this.getBrowser().getElement().attr("cache"),!0)},getContextMenu:function(){return u(this.getBrowser().getElement().attr("contextMenu"),!0)},getDebug:function(){return u(this.getBrowser().getElement().attr("debug"),!1)},getNotifications:function(){return u(this.getBrowser().getElement().attr("notifications"),!0)},getSplashScreen:function(){return u(this.getBrowser().getElement().attr("splashScreen"),!0)},getPrimitiveQuality:function(){return this.primitiveQuality},getShading:function(){return this.shading},getTextureQuality:function(){return this.textureQuality},set_splashScreen__:function(e){this.getBrowser().getElement().attr("splashScreen",e.getValue()?"true":"false")},set_rubberband__:function(e){this.localStorage.Rubberband=e.getValue(),this.getBrowser().getViewer().initShaders()},set_primitiveQuality__:function(e){const t=this.getBrowser(),i=e.getValue().toUpperCase();this.localStorage.PrimitiveQuality=i;const n=t.getConeOptions(),r=t.getCylinderOptions(),s=t.getSphereOptions();switch(i){case"LOW":if(this.primitiveQuality===o.LOW)break;this.primitiveQuality=o.LOW,t.setGeometry2DPrimitiveQuality&&t.setGeometry2DPrimitiveQuality(this.primitiveQuality),n.xDimension_=16,r.xDimension_=16,s.xDimension_=20,s.yDimension_=9;break;case"HIGH":if(this.primitiveQuality===o.HIGH)break;this.primitiveQuality=o.HIGH,t.setGeometry2DPrimitiveQuality&&t.setGeometry2DPrimitiveQuality(this.primitiveQuality),n.xDimension_=32,r.xDimension_=32,s.xDimension_=64,s.yDimension_=31;break;default:if(this.primitiveQuality===o.MEDIUM)break;this.primitiveQuality=o.MEDIUM,t.setGeometry2DPrimitiveQuality&&t.setGeometry2DPrimitiveQuality(this.primitiveQuality),n.xDimension_=20,r.xDimension_=20,s.xDimension_=32,s.yDimension_=15}},set_textureQuality__:function(e){const t=this.getBrowser(),i=e.getValue().toUpperCase();this.localStorage.TextureQuality=i;const n=t.getDefaultTextureProperties();switch(i){case"LOW":if(this.textureQuality===a.LOW)break;this.textureQuality=a.LOW,n.magnificationFilter_="AVG_PIXEL",n.minificationFilter_="AVG_PIXEL",n.textureCompression_="FASTEST",n.generateMipMaps_=!0;break;case"HIGH":if(this.textureQuality===a.HIGH)break;this.textureQuality=a.HIGH,n.magnificationFilter_="NICEST",n.minificationFilter_="NICEST",n.textureCompression_="NICEST",n.generateMipMaps_=!0;break;default:if(this.textureQuality===a.MEDIUM)break;this.textureQuality=a.MEDIUM,n.magnificationFilter_="NICEST",n.minificationFilter_="AVG_PIXEL_AVG_MIPMAP",n.textureCompression_="NICEST",n.generateMipMaps_=!0}},set_shading__:function(e){switch(e.getValue().toUpperCase()){case"POINT":case"POINTSET":this.shading=s.POINT;break;case"WIREFRAME":this.shading=s.WIREFRAME;break;case"FLAT":this.shading=s.FLAT;break;case"PHONG":this.shading=s.PHONG;break;default:this.shading=s.GOURAUD}this.getBrowser().setShading(this.shading)},set_straightenHorizon__:function(e){this.localStorage.StraightenHorizon=e.getValue()},set_logarithmicDepthBuffer__:function(e){const t=this.getBrowser(),i=t.getContext();(e=e.getValue()&&(i.getVersion()>=2||Boolean(t.getExtension("EXT_frag_depth"))))!==t.getRenderingProperties().LogarithmicDepthBuffer_.getValue()&&(t.getRenderingProperties().LogarithmicDepthBuffer_=e,t.hasPointShader()&&(t.getPointShader().parts_[0].getValue().url_.addEvent(),t.getPointShader().parts_[1].getValue().url_.addEvent()),t.hasLineShader()&&(t.getLineShader().parts_[0].getValue().url_.addEvent(),t.getLineShader().parts_[1].getValue().url_.addEvent()),t.hasGouraudShader()&&(t.getGouraudShader().parts_[0].getValue().url_.addEvent(),t.getGouraudShader().parts_[1].getValue().url_.addEvent()),t.hasPhongShader()&&(t.getPhongShader().parts_[0].getValue().url_.addEvent(),t.getPhongShader().parts_[1].getValue().url_.addEvent()),t.hasShadowShader()&&(t.getShadowShader().parts_[0].getValue().url_.addEvent(),t.getShadowShader().parts_[1].getValue().url_.addEvent()))},set_timings__:function(e){this.localStorage.Timings=e.getValue(),this.getBrowser().getBrowserTimings().setEnabled(e.getValue())}}),l}),define("x_ite/Browser/Core/BrowserProperties",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Base/X3DBaseNode","x_ite/Base/X3DConstants"],function(e,t,i,n,r){"use strict";function o(e){n.call(this,e)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.initializeOnly,"ABSTRACT_NODES",new e.SFBool(!0)),new t(r.initializeOnly,"CONCRETE_NODES",new e.SFBool(!0)),new t(r.initializeOnly,"EXTERNAL_INTERACTIONS",new e.SFBool(!0)),new t(r.initializeOnly,"PROTOTYPE_CREATE",new e.SFBool(!0)),new t(r.initializeOnly,"DOM_IMPORT",new e.SFBool(!0)),new t(r.initializeOnly,"XML_ENCODING",new e.SFBool(!0)),new t(r.initializeOnly,"CLASSIC_VRML_ENCODING",new e.SFBool(!0)),new t(r.initializeOnly,"BINARY_ENCODING",new e.SFBool)]),getTypeName:function(){return"BrowserProperties"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"browserProperties"}}),o}),define("x_ite/Browser/Core/RenderingProperties",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Base/X3DBaseNode","x_ite/Base/X3DConstants"],function(e,t,i,n,r){"use strict";function o(e){n.call(this,e),this.addAlias("AntiAliased",this.Antialiased_)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.outputOnly,"Shading",new e.SFString),new t(r.outputOnly,"MaxTextureSize",new e.SFInt32),new t(r.outputOnly,"TextureUnits",new e.SFInt32),new t(r.outputOnly,"MaxLights",new e.SFInt32),new t(r.outputOnly,"Antialiased",new e.SFBool(!0)),new t(r.outputOnly,"ColorDepth",new e.SFInt32),new t(r.outputOnly,"TextureMemory",new e.SFDouble),new t(r.outputOnly,"LogarithmicDepthBuffer",new e.SFBool(!1))]),getTypeName:function(){return"RenderingProperties"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"renderingProperties"},initialize:function(){n.prototype.initialize.call(this);const e=this.getBrowser();this.MaxTextureSize_=e.getMaxTextureSize(),this.TextureUnits_=e.getCombinedTextureUnits(),this.MaxLights_=e.getMaxLights(),this.ColorDepth_=e.getColorDepth(),this.TextureMemory_=e.getTextureMemory(),e.getBrowserOptions().Shading_.addInterest("set_shading__",this),this.set_shading__(e.getBrowserOptions().Shading_)},set_shading__:function(e){this.Shading_=e}}),o}),
define("x_ite/Browser/Core/Notification",["jquery","x_ite/Fields/SFString","x_ite/Base/X3DBaseNode"],function(e,t,i){"use strict";function n(e){i.call(this,e),this.addChildObjects("string",new t)}return e.fn.textWidth=function(t){const i=e(this).children(),n=e(this).html(),r="<span>"+n+"</span>";e(this).html(r);const o=e(this).find("span:first").width();return e(this).empty(),e(this).append(i),o},n.prototype=Object.assign(Object.create(i.prototype),{constructor:n,getTypeName:function(){return"Notification"},getComponentName:function(){return"X_ITE"},initialize:function(){i.prototype.initialize.call(this),this.element=e("<div></div>").addClass("x_ite-private-notification").appendTo(this.getBrowser().getSurface()).animate({width:0}),e("<span></span>").appendTo(this.element),this.string_.addInterest("set_string__",this)},set_string__:function(){this.getBrowser().getBrowserOptions().getNotifications()&&0!==this.string_.length&&(this.element.children().text(this.string_.getValue()),this.element.stop(!0,!0).fadeIn(0).animate({width:this.element.textWidth()}).animate({delay:1},5e3).animate({width:0}).fadeOut(0))}}),n}),function(e){"function"==typeof define&&define.amd?define("contextMenu/dist/jquery.contextMenu",["jquery"],e):e(jQuery)}(function(e){"use strict";function t(e){for(var t,i=e.split(/\s+/),n=[],r=0;t=i[r];r++)t=t.charAt(0).toUpperCase(),n.push(t);return n}function i(t){return t.id&&e('label[for="'+t.id+'"]').val()||t.name}function n(t,r,o){return o||(o=0),r.each(function(){var r,s,a=e(this),u=this,l=this.nodeName.toLowerCase();switch("label"===l&&a.find("input, textarea, select").length&&(r=a.text(),a=a.children().first(),u=a.get(0),l=u.nodeName.toLowerCase()),l){case"menu":s={name:a.attr("label"),items:{}},o=n(s.items,a.children(),o);break;case"a":case"button":s={name:a.text(),disabled:!!a.attr("disabled"),callback:function(){return function(){a.get(0).click()}}()};break;case"menuitem":case"command":switch(a.attr("type")){case void 0:case"command":case"menuitem":s={name:a.attr("label"),disabled:!!a.attr("disabled"),icon:a.attr("icon"),callback:function(){return function(){a.get(0).click()}}()};break;case"checkbox":s={type:"checkbox",disabled:!!a.attr("disabled"),name:a.attr("label"),selected:!!a.attr("checked")};break;case"radio":s={type:"radio",disabled:!!a.attr("disabled"),name:a.attr("label"),radio:a.attr("radiogroup"),value:a.attr("id"),selected:!!a.attr("checked")};break;default:s=void 0}break;case"hr":s="-------";break;case"input":switch(a.attr("type")){case"text":s={type:"text",name:r||i(u),disabled:!!a.attr("disabled"),value:a.val()};break;case"checkbox":s={type:"checkbox",name:r||i(u),disabled:!!a.attr("disabled"),selected:!!a.attr("checked")};break;case"radio":s={type:"radio",name:r||i(u),disabled:!!a.attr("disabled"),radio:!!a.attr("name"),value:a.val(),selected:!!a.attr("checked")};break;default:s=void 0}break;case"select":s={type:"select",name:r||i(u),disabled:!!a.attr("disabled"),selected:a.val(),options:{}},a.children().each(function(){s.options[this.value]=e(this).text()});break;case"textarea":s={type:"textarea",name:r||i(u),disabled:!!a.attr("disabled"),value:a.val()};break;case"label":break;default:s={type:"html",html:a.clone(!0)}}s&&(o++,t["key"+o]=s)}),o}e.support.htmlMenuitem="HTMLMenuItemElement"in window,e.support.htmlCommand="HTMLCommandElement"in window,e.support.eventSelectstart="onselectstart"in document.documentElement,e.ui&&e.widget||(e.cleanData=function(t){return function(i){var n,r,o;for(o=0;null!=i[o];o++){r=i[o];try{n=e._data(r,"events"),n&&n.remove&&e(r).triggerHandler("remove")}catch(e){}}t(i)}}(e.cleanData));var r=null,o=!1,s=e(window),a=0,u={},l={},c={},h={selector:null,appendTo:null,trigger:"right",autoHide:!1,delay:200,reposition:!0,hideOnSecondTrigger:!1,selectableSubMenu:!1,classNames:{hover:"context-menu-hover",disabled:"context-menu-disabled",visible:"context-menu-visible",notSelectable:"context-menu-not-selectable",icon:"context-menu-icon",iconEdit:"context-menu-icon-edit",iconCut:"context-menu-icon-cut",iconCopy:"context-menu-icon-copy",iconPaste:"context-menu-icon-paste",iconDelete:"context-menu-icon-delete",iconAdd:"context-menu-icon-add",iconQuit:"context-menu-icon-quit",iconLoadingClass:"context-menu-icon-loading"},determinePosition:function(t){if(e.ui&&e.ui.position)t.css("display","block").position({my:"center top",at:"center bottom",of:this,offset:"0 5",collision:"fit"}).css("display","none");else{var i=this.offset();i.top+=this.outerHeight(),i.left+=this.outerWidth()/2-t.outerWidth()/2,t.css(i)}},position:function(e,t,i){var n;if(!t&&!i)return void e.determinePosition.call(this,e.$menu);if("maintain"===t&&"maintain"===i)n=e.$menu.position();else{var r=e.$menu.offsetParent().offset();n={top:i-r.top,left:t-r.left}}var o=s.scrollTop()+s.height(),a=s.scrollLeft()+s.width(),u=e.$menu.outerHeight(),l=e.$menu.outerWidth();n.top+u>o&&(n.top-=u),n.top<0&&(n.top=0),n.left+l>a&&(n.left-=l),n.left<0&&(n.left=0),e.$menu.css(n)},positionSubmenu:function(t){if(void 0!==t)if(e.ui&&e.ui.position)t.css("display","block").position({my:"left top-5",at:"right top",of:this,collision:"flipfit fit"}).css("display","");else{var i={top:-9,left:this.outerWidth()-5};t.css(i)}},zIndex:1,animation:{duration:50,show:"slideDown",hide:"slideUp"},events:{preShow:e.noop,show:e.noop,hide:e.noop,activated:e.noop},callback:null,items:{}},d={timer:null,pageX:null,pageY:null},p=function(e){for(var t=0,i=e;;)if(t=Math.max(t,parseInt(i.css("z-index"),10)||0),!(i=i.parent())||!i.length||"html body".indexOf(i.prop("nodeName").toLowerCase())>-1)break;return t},f={abortevent:function(e){e.preventDefault(),e.stopImmediatePropagation()},contextmenu:function(t){var i=e(this);if(t.data.events.preShow(i,t)!==!1&&("right"===t.data.trigger&&(t.preventDefault(),t.stopImmediatePropagation()),!("right"!==t.data.trigger&&"demand"!==t.data.trigger&&t.originalEvent||!(void 0===t.mouseButton||!t.data||"left"===t.data.trigger&&0===t.mouseButton||"right"===t.data.trigger&&2===t.mouseButton)||i.hasClass("context-menu-active")||i.hasClass("context-menu-disabled")))){if(r=i,t.data.build){var n=t.data.build(r,t);if(n===!1)return;if(t.data=e.extend(!0,{},h,t.data,n||{}),!t.data.items||e.isEmptyObject(t.data.items))throw window.console&&(console.error||console.log).call(console,"No items specified to show in contextMenu"),new Error("No Items specified");t.data.$trigger=r,g.create(t.data)}g.show.call(i,t.data,t.pageX,t.pageY)}},click:function(t){t.preventDefault(),t.stopImmediatePropagation(),e(this).trigger(e.Event("contextmenu",{data:t.data,pageX:t.pageX,pageY:t.pageY}))},mousedown:function(t){var i=e(this);r&&r.length&&!r.is(i)&&r.data("contextMenu").$menu.trigger("contextmenu:hide"),2===t.button&&(r=i.data("contextMenuActive",!0))},mouseup:function(t){var i=e(this);i.data("contextMenuActive")&&r&&r.length&&r.is(i)&&!i.hasClass("context-menu-disabled")&&(t.preventDefault(),t.stopImmediatePropagation(),r=i,i.trigger(e.Event("contextmenu",{data:t.data,pageX:t.pageX,pageY:t.pageY}))),i.removeData("contextMenuActive")},mouseenter:function(t){var i=e(this),n=e(t.relatedTarget),o=e(document);n.is(".context-menu-list")||n.closest(".context-menu-list").length||r&&r.length||(d.pageX=t.pageX,d.pageY=t.pageY,d.data=t.data,o.on("mousemove.contextMenuShow",f.mousemove),d.timer=setTimeout(function(){d.timer=null,o.off("mousemove.contextMenuShow"),r=i,i.trigger(e.Event("contextmenu",{data:d.data,pageX:d.pageX,pageY:d.pageY}))},t.data.delay))},mousemove:function(e){d.pageX=e.pageX,d.pageY=e.pageY},mouseleave:function(t){var i=e(t.relatedTarget);if(!i.is(".context-menu-list")&&!i.closest(".context-menu-list").length){try{clearTimeout(d.timer)}catch(e){}d.timer=null}},layerClick:function(t){var i,n,r=e(this),o=r.data("contextMenuRoot"),a=t.button,u=t.pageX,l=t.pageY,c=void 0===u;t.preventDefault(),setTimeout(function(){if(c)return void(null!==o&&void 0!==o&&null!==o.$menu&&void 0!==o.$menu&&o.$menu.trigger("contextmenu:hide"));var r,h="left"===o.trigger&&0===a||"right"===o.trigger&&2===a;if(document.elementFromPoint&&o.$layer){if(o.$layer.hide(),null!==(i=document.elementFromPoint(u-s.scrollLeft(),l-s.scrollTop()))&&i.isContentEditable){var d=document.createRange(),p=window.getSelection();d.selectNode(i),d.collapse(!0),p.removeAllRanges(),p.addRange(d)}e(i).trigger(t),o.$layer.show()}if(o.hideOnSecondTrigger&&h&&null!==o.$menu&&void 0!==o.$menu)return void o.$menu.trigger("contextmenu:hide");if(o.reposition&&h)if(document.elementFromPoint){if(o.$trigger.is(i))return void o.position.call(o.$trigger,o,u,l)}else if(n=o.$trigger.offset(),r=e(window),n.top+=r.scrollTop(),n.top<=t.pageY&&(n.left+=r.scrollLeft(),n.left<=t.pageX&&(n.bottom=n.top+o.$trigger.outerHeight(),n.bottom>=t.pageY&&(n.right=n.left+o.$trigger.outerWidth(),n.right>=t.pageX))))return void o.position.call(o.$trigger,o,u,l);i&&h&&o.$trigger.one("contextmenu:hidden",function(){e(i).contextMenu({x:u,y:l,button:a})}),null!==o&&void 0!==o&&null!==o.$menu&&void 0!==o.$menu&&o.$menu.trigger("contextmenu:hide")},50)},keyStop:function(e,t){t.isInput||e.preventDefault(),e.stopPropagation()},key:function(e){var t={};r&&(t=r.data("contextMenu")||{}),void 0===t.zIndex&&(t.zIndex=0);var i=0,n=function(e){""!==e.style.zIndex?i=e.style.zIndex:null!==e.offsetParent&&void 0!==e.offsetParent?n(e.offsetParent):null!==e.parentElement&&void 0!==e.parentElement&&n(e.parentElement)};if(n(e.target),!(t.$menu&&parseInt(i,10)>parseInt(t.$menu.css("zIndex"),10))){switch(e.keyCode){case 9:case 38:if(f.keyStop(e,t),t.isInput){if(9===e.keyCode&&e.shiftKey)return e.preventDefault(),t.$selected&&t.$selected.find("input, textarea, select").blur(),void(null!==t.$menu&&void 0!==t.$menu&&t.$menu.trigger("prevcommand"));if(38===e.keyCode&&"checkbox"===t.$selected.find("input, textarea, select").prop("type"))return void e.preventDefault()}else if(9!==e.keyCode||e.shiftKey)return void(null!==t.$menu&&void 0!==t.$menu&&t.$menu.trigger("prevcommand"));break;case 40:if(f.keyStop(e,t),!t.isInput)return void(null!==t.$menu&&void 0!==t.$menu&&t.$menu.trigger("nextcommand"));if(9===e.keyCode)return e.preventDefault(),t.$selected&&t.$selected.find("input, textarea, select").blur(),void(null!==t.$menu&&void 0!==t.$menu&&t.$menu.trigger("nextcommand"));if(40===e.keyCode&&"checkbox"===t.$selected.find("input, textarea, select").prop("type"))return void e.preventDefault();break;case 37:if(f.keyStop(e,t),t.isInput||!t.$selected||!t.$selected.length)break;if(!t.$selected.parent().hasClass("context-menu-root")){var o=t.$selected.parent().parent();return t.$selected.trigger("contextmenu:blur"),void(t.$selected=o)}break;case 39:if(f.keyStop(e,t),t.isInput||!t.$selected||!t.$selected.length)break;var s=t.$selected.data("contextMenu")||{};if(s.$menu&&t.$selected.hasClass("context-menu-submenu"))return t.$selected=null,s.$selected=null,void s.$menu.trigger("nextcommand");break;case 35:case 36:return t.$selected&&t.$selected.find("input, textarea, select").length?void 0:((t.$selected&&t.$selected.parent()||t.$menu).children(":not(."+t.classNames.disabled+", ."+t.classNames.notSelectable+")")[36===e.keyCode?"first":"last"]().trigger("contextmenu:focus"),void e.preventDefault());case 13:if(f.keyStop(e,t),t.isInput){if(t.$selected&&!t.$selected.is("textarea, select"))return void e.preventDefault();break}return void(void 0!==t.$selected&&null!==t.$selected&&t.$selected.trigger("mouseup"));case 32:case 33:case 34:return void f.keyStop(e,t);case 27:return f.keyStop(e,t),void(null!==t.$menu&&void 0!==t.$menu&&t.$menu.trigger("contextmenu:hide"));default:var a=String.fromCharCode(e.keyCode).toUpperCase();if(t.accesskeys&&t.accesskeys[a])return void t.accesskeys[a].$node.trigger(t.accesskeys[a].$menu?"contextmenu:focus":"mouseup")}e.stopPropagation(),void 0!==t.$selected&&null!==t.$selected&&t.$selected.trigger(e)}},prevItem:function(t){t.stopPropagation();var i=e(this).data("contextMenu")||{},n=e(this).data("contextMenuRoot")||{};if(i.$selected){var r=i.$selected;i=i.$selected.parent().data("contextMenu")||{},i.$selected=r}for(var o=i.$menu.children(),s=i.$selected&&i.$selected.prev().length?i.$selected.prev():o.last(),a=s;s.hasClass(n.classNames.disabled)||s.hasClass(n.classNames.notSelectable)||s.is(":hidden");)if(s=s.prev().length?s.prev():o.last(),s.is(a))return;i.$selected&&f.itemMouseleave.call(i.$selected.get(0),t),f.itemMouseenter.call(s.get(0),t);var u=s.find("input, textarea, select");u.length&&u.focus()},nextItem:function(t){t.stopPropagation();var i=e(this).data("contextMenu")||{},n=e(this).data("contextMenuRoot")||{};if(i.$selected){var r=i.$selected;i=i.$selected.parent().data("contextMenu")||{},i.$selected=r}for(var o=i.$menu.children(),s=i.$selected&&i.$selected.next().length?i.$selected.next():o.first(),a=s;s.hasClass(n.classNames.disabled)||s.hasClass(n.classNames.notSelectable)||s.is(":hidden");)if(s=s.next().length?s.next():o.first(),s.is(a))return;i.$selected&&f.itemMouseleave.call(i.$selected.get(0),t),f.itemMouseenter.call(s.get(0),t);var u=s.find("input, textarea, select");u.length&&u.focus()},focusInput:function(){var t=e(this).closest(".context-menu-item"),i=t.data(),n=i.contextMenu,r=i.contextMenuRoot;r.$selected=n.$selected=t,r.isInput=n.isInput=!0},blurInput:function(){var t=e(this).closest(".context-menu-item"),i=t.data(),n=i.contextMenu;i.contextMenuRoot.isInput=n.isInput=!1},menuMouseenter:function(){e(this).data().contextMenuRoot.hovering=!0},menuMouseleave:function(t){var i=e(this).data().contextMenuRoot;i.$layer&&i.$layer.is(t.relatedTarget)&&(i.hovering=!1)},itemMouseenter:function(t){var i=e(this),n=i.data(),r=n.contextMenu,o=n.contextMenuRoot;if(o.hovering=!0,t&&o.$layer&&o.$layer.is(t.relatedTarget)&&(t.preventDefault(),t.stopImmediatePropagation()),(r.$menu?r:o).$menu.children("."+o.classNames.hover).trigger("contextmenu:blur").children(".hover").trigger("contextmenu:blur"),i.hasClass(o.classNames.disabled)||i.hasClass(o.classNames.notSelectable))return void(r.$selected=null);i.trigger("contextmenu:focus")},itemMouseleave:function(t){var i=e(this),n=i.data(),r=n.contextMenu,o=n.contextMenuRoot;if(o!==r&&o.$layer&&o.$layer.is(t.relatedTarget))return void 0!==o.$selected&&null!==o.$selected&&o.$selected.trigger("contextmenu:blur"),t.preventDefault(),t.stopImmediatePropagation(),void(o.$selected=r.$selected=r.$node);r&&r.$menu&&r.$menu.hasClass("context-menu-visible")||i.trigger("contextmenu:blur")},itemClick:function(t){var i,n=e(this),r=n.data(),o=r.contextMenu,s=r.contextMenuRoot,a=r.contextMenuKey;if(!(!o.items[a]||n.is("."+s.classNames.disabled+", .context-menu-separator, ."+s.classNames.notSelectable)||n.is(".context-menu-submenu")&&s.selectableSubMenu===!1)){if(t.preventDefault(),t.stopImmediatePropagation(),e.isFunction(o.callbacks[a])&&Object.prototype.hasOwnProperty.call(o.callbacks,a))i=o.callbacks[a];else{if(!e.isFunction(s.callback))return;i=s.callback}i.call(s.$trigger,a,s,t)!==!1?s.$menu.trigger("contextmenu:hide"):s.$menu.parent().length&&g.update.call(s.$trigger,s)}},inputClick:function(e){e.stopImmediatePropagation()},hideMenu:function(t,i){var n=e(this).data("contextMenuRoot");g.hide.call(n.$trigger,n,i&&i.force)},focusItem:function(t){t.stopPropagation();var i=e(this),n=i.data(),r=n.contextMenu,o=n.contextMenuRoot;i.hasClass(o.classNames.disabled)||i.hasClass(o.classNames.notSelectable)||(i.addClass([o.classNames.hover,o.classNames.visible].join(" ")).parent().find(".context-menu-item").not(i).removeClass(o.classNames.visible).filter("."+o.classNames.hover).trigger("contextmenu:blur"),r.$selected=o.$selected=i,r&&r.$node&&r.$node.hasClass("context-menu-submenu")&&r.$node.addClass(o.classNames.hover),r.$node&&o.positionSubmenu.call(r.$node,r.$menu))},blurItem:function(t){t.stopPropagation();var i=e(this),n=i.data(),r=n.contextMenu,o=n.contextMenuRoot;r.autoHide&&i.removeClass(o.classNames.visible),i.removeClass(o.classNames.hover),r.$selected=null}},g={show:function(t,i,n){var o=e(this),s={};if(e("#context-menu-layer").trigger("mousedown"),t.$trigger=o,t.events.show.call(o,t)===!1)return void(r=null);if(g.update.call(o,t)===!1)return void(r=null);if(t.position.call(o,t,i,n),t.zIndex){var a=t.zIndex;"function"==typeof t.zIndex&&(a=t.zIndex.call(o,t)),s.zIndex=p(o)+a}g.layer.call(t.$menu,t,s.zIndex),t.$menu.find("ul").css("zIndex",s.zIndex+1),t.$menu.css(s)[t.animation.show](t.animation.duration,function(){o.trigger("contextmenu:visible"),g.activated(t),t.events.activated(t)}),o.data("contextMenu",t).addClass("context-menu-active"),e(document).off("keydown.contextMenu").on("keydown.contextMenu",f.key),t.autoHide&&e(document).on("mousemove.contextMenuAutoHide",function(e){var i=o.offset();i.right=i.left+o.outerWidth(),i.bottom=i.top+o.outerHeight(),!t.$layer||t.hovering||e.pageX>=i.left&&e.pageX<=i.right&&e.pageY>=i.top&&e.pageY<=i.bottom||setTimeout(function(){t.hovering||null===t.$menu||void 0===t.$menu||t.$menu.trigger("contextmenu:hide")},50)})},hide:function(t,i){var n=e(this);if(t||(t=n.data("contextMenu")||{}),i||!t.events||t.events.hide.call(n,t)!==!1){if(n.removeData("contextMenu").removeClass("context-menu-active"),t.$layer){setTimeout(function(e){return function(){e.remove()}}(t.$layer),10);try{delete t.$layer}catch(e){t.$layer=null}}r=null,t.$menu.find("."+t.classNames.hover).trigger("contextmenu:blur"),t.$selected=null,t.$menu.find("."+t.classNames.visible).removeClass(t.classNames.visible),e(document).off(".contextMenuAutoHide").off("keydown.contextMenu"),t.$menu&&t.$menu[t.animation.hide](t.animation.duration,function(){t.build&&(t.$menu.remove(),e.each(t,function(e){switch(e){case"ns":case"selector":case"build":case"trigger":return!0;default:t[e]=void 0;try{delete t[e]}catch(e){}return!0}})),setTimeout(function(){n.trigger("contextmenu:hidden")},10)})}},create:function(i,n){function r(t){var i=e("<span></span>");if(t._accesskey)t._beforeAccesskey&&i.append(document.createTextNode(t._beforeAccesskey)),e("<span></span>").addClass("context-menu-accesskey").text(t._accesskey).appendTo(i),t._afterAccesskey&&i.append(document.createTextNode(t._afterAccesskey));else if(t.isHtmlName){if(void 0!==t.accesskey)throw new Error("accesskeys are not compatible with HTML names and cannot be used together in the same item");i.html(t.name)}else i.text(t.name);return i}void 0===n&&(n=i),i.$menu=e('<ul class="context-menu-list"></ul>').addClass(i.className||"").data({contextMenu:i,contextMenuRoot:n}),i.dataAttr&&e.each(i.dataAttr,function(e,t){i.$menu.attr("data-"+i.key,t)}),e.each(["callbacks","commands","inputs"],function(e,t){i[t]={},n[t]||(n[t]={})}),n.accesskeys||(n.accesskeys={}),e.each(i.items,function(o,s){var a=e('<li class="context-menu-item"></li>').addClass(s.className||""),u=null,l=null;if(a.on("click",e.noop),"string"!=typeof s&&"cm_separator"!==s.type||(s={type:"cm_seperator"}),s.$node=a.data({contextMenu:i,contextMenuRoot:n,contextMenuKey:o}),void 0!==s.accesskey)for(var h,d=t(s.accesskey),p=0;h=d[p];p++)if(!n.accesskeys[h]){n.accesskeys[h]=s;var m=s.name.match(new RegExp("^(.*?)("+h+")(.*)$","i"));m&&(s._beforeAccesskey=m[1],s._accesskey=m[2],s._afterAccesskey=m[3]);break}if(s.type&&c[s.type])c[s.type].call(a,s,i,n),e.each([i,n],function(t,n){n.commands[o]=s,!e.isFunction(s.callback)||void 0!==n.callbacks[o]&&void 0!==i.type||(n.callbacks[o]=s.callback)});else{switch("cm_seperator"===s.type?a.addClass("context-menu-separator "+n.classNames.notSelectable):"html"===s.type?a.addClass("context-menu-html "+n.classNames.notSelectable):"sub"!==s.type&&s.type?(u=e("<label></label>").appendTo(a),r(s).appendTo(u),a.addClass("context-menu-input"),i.hasTypes=!0,e.each([i,n],function(e,t){t.commands[o]=s,t.inputs[o]=s})):s.items&&(s.type="sub"),s.type){case"cm_seperator":break;case"text":l=e('<input type="text" value="1" name="" />').attr("name","context-menu-input-"+o).val(s.value||"").appendTo(u);break;case"textarea":l=e('<textarea name=""></textarea>').attr("name","context-menu-input-"+o).val(s.value||"").appendTo(u),s.height&&l.height(s.height);break;case"checkbox":l=e('<input type="checkbox" value="1" name="" />').attr("name","context-menu-input-"+o).val(s.value||"").prop("checked",!!s.selected).prependTo(u);break;case"radio":l=e('<input type="radio" value="1" name="" />').attr("name","context-menu-input-"+s.radio).val(s.value||"").prop("checked",!!s.selected).prependTo(u);break;case"select":l=e('<select name=""></select>').attr("name","context-menu-input-"+o).appendTo(u),s.options&&(e.each(s.options,function(t,i){e("<option></option>").val(t).text(i).appendTo(l)}),l.val(s.selected));break;case"sub":r(s).appendTo(a),s.appendTo=s.$node,a.data("contextMenu",s).addClass("context-menu-submenu"),s.callback=null,"function"==typeof s.items.then?g.processPromises(s,n,s.items):g.create(s,n);break;case"html":e(s.html).appendTo(a);break;default:e.each([i,n],function(t,n){n.commands[o]=s,!e.isFunction(s.callback)||void 0!==n.callbacks[o]&&void 0!==i.type||(n.callbacks[o]=s.callback)}),r(s).appendTo(a)}s.type&&"sub"!==s.type&&"html"!==s.type&&"cm_seperator"!==s.type&&(l.on("focus",f.focusInput).on("blur",f.blurInput),s.events&&l.on(s.events,i)),s.icon&&(e.isFunction(s.icon)?s._icon=s.icon.call(this,this,a,o,s):"string"!=typeof s.icon||"fab "!==s.icon.substring(0,4)&&"fas "!==s.icon.substring(0,4)&&"fad "!==s.icon.substring(0,4)&&"far "!==s.icon.substring(0,4)&&"fal "!==s.icon.substring(0,4)?"string"==typeof s.icon&&"fa-"===s.icon.substring(0,3)?s._icon=n.classNames.icon+" "+n.classNames.icon+"--fa fa "+s.icon:s._icon=n.classNames.icon+" "+n.classNames.icon+"-"+s.icon:(a.addClass(n.classNames.icon+" "+n.classNames.icon+"--fa5"),s._icon=e('<i class="'+s.icon+'"></i>')),"string"==typeof s._icon?a.addClass(s._icon):a.prepend(s._icon))}s.$input=l,s.$label=u,a.appendTo(i.$menu),!i.hasTypes&&e.support.eventSelectstart&&a.on("selectstart.disableTextSelect",f.abortevent)}),i.$node||i.$menu.css("display","none").addClass("context-menu-root"),i.$menu.appendTo(i.appendTo||document.body)},resize:function(t,i){var n;t.css({position:"absolute",display:"block"}),t.data("width",(n=t.get(0)).getBoundingClientRect?Math.ceil(n.getBoundingClientRect().width):t.outerWidth()+1),t.css({position:"static",minWidth:"0px",maxWidth:"100000px"}),t.find("> li > ul").each(function(){g.resize(e(this),!0)}),i||t.find("ul").addBack().css({position:"",display:"",minWidth:"",maxWidth:""}).outerWidth(function(){return e(this).data("width")})},update:function(t,i){var n=this;void 0===i&&(i=t,g.resize(t.$menu));var r=!1;return t.$menu.children().each(function(){var o,s=e(this),a=s.data("contextMenuKey"),u=t.items[a],l=e.isFunction(u.disabled)&&u.disabled.call(n,a,i)||u.disabled===!0;if(o=e.isFunction(u.visible)?u.visible.call(n,a,i):void 0===u.visible||u.visible===!0,o&&(r=!0),s[o?"show":"hide"](),s[l?"addClass":"removeClass"](i.classNames.disabled),e.isFunction(u.icon)){s.removeClass(u._icon);var c=u.icon.call(this,n,s,a,u);"string"==typeof c?s.addClass(c):s.prepend(c)}if(u.type)switch(s.find("input, select, textarea").prop("disabled",l),u.type){case"text":case"textarea":u.$input.val(u.value||"");break;case"checkbox":case"radio":u.$input.val(u.value||"").prop("checked",!!u.selected);break;case"select":u.$input.val((0===u.selected?"0":u.selected)||"")}if(u.$menu){g.update.call(n,u,i)&&(r=!0)}}),r},layer:function(t,i){var n=t.$layer=e('<div id="context-menu-layer"></div>').css({height:s.height(),width:s.width(),display:"block",position:"fixed","z-index":i-1,top:0,left:0,opacity:0,filter:"alpha(opacity=0)","background-color":"#000"}).data("contextMenuRoot",t).appendTo(document.body).on("contextmenu",f.abortevent).on("mousedown",f.layerClick);return void 0===document.body.style.maxWidth&&n.css({position:"absolute",height:e(document).height()}),n},processPromises:function(e,t,i){function n(e,t,i){void 0===i&&r(void 0),o(e,t,i)}function r(e,t,i){void 0===i?(i={error:{name:"No items and no error item",icon:"context-menu-icon context-menu-icon-quit"}},window.console&&(console.error||console.log).call(console,'When you reject a promise, provide an "items" object, equal to normal sub-menu items')):"string"==typeof i&&(i={error:{name:i}}),o(e,t,i)}function o(e,t,i){void 0!==t.$menu&&t.$menu.is(":visible")&&(e.$node.removeClass(t.classNames.iconLoadingClass),e.items=i,g.create(e,t,!0),g.update(e,t),t.positionSubmenu.call(e.$node,e.$menu))}e.$node.addClass(t.classNames.iconLoadingClass),i.then(n.bind(this,e,t),r.bind(this,e,t))},activated:function(t){var i=t.$menu,n=i.offset(),r=e(window).height(),o=e(window).scrollTop(),s=i.height();s>r?i.css({height:r+"px","overflow-x":"hidden","overflow-y":"auto",top:o+"px"}):(n.top<o||n.top+s>o+r)&&i.css({top:o+"px"})}};e.fn.contextMenu=function(t){var i=this,n=t;if(this.length>0)if(void 0===t)this.first().trigger("contextmenu");else if(void 0!==t.x&&void 0!==t.y)this.first().trigger(e.Event("contextmenu",{pageX:t.x,pageY:t.y,mouseButton:t.button}));else if("hide"===t){var r=this.first().data("contextMenu")?this.first().data("contextMenu").$menu:null;r&&r.trigger("contextmenu:hide")}else"destroy"===t?e.contextMenu("destroy",{context:this}):e.isPlainObject(t)?(t.context=this,e.contextMenu("create",t)):t?this.removeClass("context-menu-disabled"):t||this.addClass("context-menu-disabled");else e.each(l,function(){this.selector===i.selector&&(n.data=this,e.extend(n.data,{trigger:"demand"}))}),f.contextmenu.call(n.target,n);return this},e.contextMenu=function(t,i){"string"!=typeof t&&(i=t,t="create"),"string"==typeof i?i={selector:i}:void 0===i&&(i={});var n=e.extend(!0,{},h,i||{}),r=e(document),s=r,c=!1;switch(n.context&&n.context.length?(s=e(n.context).first(),n.context=s.get(0),c=!e(n.context).is(document)):n.context=document,t){case"update":if(c)g.update(s);else for(var d in l)l.hasOwnProperty(d)&&g.update(l[d]);break;case"create":if(!n.selector)throw new Error("No selector specified");if(n.selector.match(/.context-menu-(list|item|input)($|\s)/))throw new Error('Cannot bind to selector "'+n.selector+'" as it contains a reserved className');if(!n.build&&(!n.items||e.isEmptyObject(n.items)))throw new Error("No Items specified");if(a++,n.ns=".contextMenu"+a,c||(u[n.selector]=n.ns),l[n.ns]=n,n.trigger||(n.trigger="right"),!o){var p="click"===n.itemClickEvent?"click.contextMenu":"mouseup.contextMenu",m={"contextmenu:focus.contextMenu":f.focusItem,"contextmenu:blur.contextMenu":f.blurItem,"contextmenu.contextMenu":f.abortevent,"mouseenter.contextMenu":f.itemMouseenter,"mouseleave.contextMenu":f.itemMouseleave};m[p]=f.itemClick,r.on({"contextmenu:hide.contextMenu":f.hideMenu,"prevcommand.contextMenu":f.prevItem,"nextcommand.contextMenu":f.nextItem,"contextmenu.contextMenu":f.abortevent,"mouseenter.contextMenu":f.menuMouseenter,"mouseleave.contextMenu":f.menuMouseleave},".context-menu-list").on("mouseup.contextMenu",".context-menu-input",f.inputClick).on(m,".context-menu-item"),o=!0}switch(s.on("contextmenu"+n.ns,n.selector,n,f.contextmenu),c&&s.on("remove"+n.ns,function(){e(this).contextMenu("destroy")}),n.trigger){case"hover":s.on("mouseenter"+n.ns,n.selector,n,f.mouseenter).on("mouseleave"+n.ns,n.selector,n,f.mouseleave);break;case"left":s.on("click"+n.ns,n.selector,n,f.click);break;case"touchstart":s.on("touchstart"+n.ns,n.selector,n,f.click)}n.build||g.create(n);break;case"destroy":var y;if(c){var _=n.context;e.each(l,function(t,i){if(!i)return!0;if(!e(_).is(i.selector))return!0;y=e(".context-menu-list").filter(":visible"),y.length&&y.data().contextMenuRoot.$trigger.is(e(i.context).find(i.selector))&&y.trigger("contextmenu:hide",{force:!0});try{l[i.ns].$menu&&l[i.ns].$menu.remove(),delete l[i.ns]}catch(e){l[i.ns]=null}return e(i.context).off(i.ns),!0})}else if(n.selector){if(u[n.selector]){y=e(".context-menu-list").filter(":visible"),y.length&&y.data().contextMenuRoot.$trigger.is(n.selector)&&y.trigger("contextmenu:hide",{force:!0});try{l[u[n.selector]].$menu&&l[u[n.selector]].$menu.remove(),delete l[u[n.selector]]}catch(e){l[u[n.selector]]=null}r.off(u[n.selector])}}else r.off(".contextMenu .contextMenuAutoHide"),e.each(l,function(t,i){e(i.context).off(i.ns)}),u={},l={},a=0,o=!1,e("#context-menu-layer, .context-menu-list").remove();break;case"html5":(!e.support.htmlCommand&&!e.support.htmlMenuitem||"boolean"==typeof i&&i)&&e('menu[type="context"]').each(function(){this.id&&e.contextMenu({selector:"[contextmenu="+this.id+"]",items:e.contextMenu.fromMenu(this)})}).css("display","none");break;default:throw new Error('Unknown operation "'+t+'"')}return this},e.contextMenu.setInputValues=function(t,i){void 0===i&&(i={}),e.each(t.inputs,function(e,t){switch(t.type){case"text":case"textarea":t.value=i[e]||"";break;case"checkbox":t.selected=!!i[e];break;case"radio":t.selected=(i[t.radio]||"")===t.value;break;case"select":t.selected=i[e]||""}})},e.contextMenu.getInputValues=function(t,i){return void 0===i&&(i={}),e.each(t.inputs,function(e,t){switch(t.type){case"text":case"textarea":case"select":i[e]=t.$input.val();break;case"checkbox":i[e]=t.$input.prop("checked");break;case"radio":t.$input.prop("checked")&&(i[t.radio]=t.value)}}),i},e.contextMenu.fromMenu=function(t){var i=e(t),r={};return n(r,i.children()),r},e.contextMenu.defaults=h,e.contextMenu.types=c,e.contextMenu.handle=f,e.contextMenu.op=g,e.contextMenu.menus=l}),define("contextMenu",["contextMenu/dist/jquery.contextMenu"],function(e){return e}),define("lib/jquery.fullscreen-min",["jquery"],function(e){function t(e){var t,i;return this.length?(t=this[0],t.ownerDocument?i=t.ownerDocument:(i=t,t=i.documentElement),null==e?i.exitFullscreen||i.webkitExitFullscreen||i.webkitCancelFullScreen||i.msExitFullscreen||i.mozCancelFullScreen?(e=!!(i.fullscreenElement||i.msFullscreenElement||i.webkitIsFullScreen||i.mozFullScreen),e?i.fullscreenElement||i.webkitFullscreenElement||i.webkitCurrentFullScreenElement||i.msFullscreenElement||i.mozFullScreenElement||e:e):null:(e?(e=t.requestFullscreen||t.webkitRequestFullscreen||t.webkitRequestFullScreen||t.msRequestFullscreen||t.mozRequestFullScreen)&&e.call(t):(e=i.exitFullscreen||i.webkitExitFullscreen||i.webkitCancelFullScreen||i.msExitFullscreen||i.mozCancelFullScreen)&&e.call(i),this)):this}e.fn.fullScreen=t,e.fn.toggleFullScreen=function(){return t.call(this,!t.call(this))};var i,n,r;i=document,i.webkitCancelFullScreen?(n="webkitfullscreenchange",r="webkitfullscreenerror"):i.msExitFullscreen?(n="MSFullscreenChange",r="MSFullscreenError"):i.mozCancelFullScreen?(n="mozfullscreenchange",r="mozfullscreenerror"):(n="fullscreenchange",r="fullscreenerror"),e(document).bind(n,function(){e(document).trigger(new e.Event("fullscreenchange"))}),e(document).bind(r,function(){e(document).trigger(new e.Event("fullscreenerror"))})}),define("x_ite/Browser/Core/ContextMenu",["jquery","x_ite/Base/X3DBaseNode","locale/gettext","contextMenu","lib/jquery.fullscreen-min"],function(e,t,i){"use strict";function n(e){t.call(this,e),this.userMenu=null,this.active=!1}return n.prototype=Object.assign(Object.create(t.prototype),{constructor:n,getTypeName:function(){return"ContextMenu"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"contextMenu"},initialize:function(){t.prototype.initialize.call(this);const i=this.getBrowser();i.getBrowserOptions().getContextMenu()&&e.contextMenu({selector:".x_ite-private-browser-"+i.getNumber(),build:this.build.bind(this),animation:{duration:500,show:"fadeIn",hide:"fadeOut"},hideOnSecondTrigger:!0,events:{show:function(e){this.active=!0,i.getElement().fullScreen()&&(i.getElement().append(e.$menu),setTimeout(function(){i.getElement().append(e.$layer.css({position:"absolute",width:"100%",height:"100%"}))},1))},activated:function(t){t.$menu.hasClass("x_ite-private-menu-submenus-left")?t.$menu.find(".context-menu-list").each(function(t,i){e(i).css("right",e(i).parent().parent().css("width"))}):t.$menu.find(".context-menu-list").each(function(t,i){e(i).css("left",parseInt(e(i).parent().parent().css("width"))-2+"px")}),t.$menu.find(".context-menu-list").each(function(t,i){e(i).height()>e(window).height()&&e(i).css({"overflow-y":"scroll","max-height":"100vh"})}),
t.$menu.find(".context-menu-item").on("mouseenter",function(t){t.stopImmediatePropagation();const i=e(t.target),n=i.children(".context-menu-list");if(n.length){n.css("top","");const t=n.offset().top+n.height()-e(window).scrollTop()-e(window).height();t>0&&n.offset({top:n.offset().top-t})}})}.bind(this),hide:function(e){this.active=!1}.bind(this)}})},getUserMenu:function(){return this.userMenu},setUserMenu:function(e){this.userMenu=e},getActive:function(){return this.active},build:function(t,n){const r=this.getBrowser(),o=r.getActiveLayer(),s=o?o.getViewpoint():null,a=r.viewer_.getValue(),u=r.getElement().fullScreen(),l=e(document).width()-n.pageX<370,c={className:"x_ite-private-menu x_ite-private-menu-title",items:{separator0:"--------",viewpoints:{name:i("Viewpoints"),className:"context-menu-icon x_ite-private-icon-viewpoint",items:this.getViewpoints(),callback:function(e){e&&(r.bindViewpoint(r.getActiveLayer(),e),r.getSurface().focus())}.bind(this,s)},separator1:"--------",viewer:{name:i(this.getViewerName(a)),className:"context-menu-icon x_ite-private-icon-"+a.toLowerCase()+"-viewer",callback:function(e){r.viewer_=e,r.getNotification().string_=i(this.getViewerName(e)),r.getSurface().focus()}.bind(this,a)},"available-viewers":{name:i("Available Viewers"),items:this.getAvailableViewers()},"straighten-horizon":{name:i("Straighten Horizon"),type:"checkbox",selected:r.getBrowserOption("StraightenHorizon"),events:{click:function(t){const n=e(t.target).is(":checked");if(r.setBrowserOption("StraightenHorizon",n),n){r.getNotification().string_=i("Straighten Horizon")+": "+i("on");const e=r.getActiveViewpoint();e&&e.straighten(r.getActiveLayer(),!0)}else r.getNotification().string_=i("Straighten Horizon")+": "+i("off")}.bind(this)}},separator2:"--------","primitive-quality":{name:i("Primitive Quality"),className:"context-menu-icon x_ite-private-icon-primitive-quality",items:{high:{name:i("High"),type:"radio",radio:"primitive-quality",selected:"HIGH"===r.getBrowserOption("PrimitiveQuality"),events:{click:function(){r.setBrowserOption("PrimitiveQuality","HIGH"),r.getNotification().string_=i("Primitive Quality")+": "+i("high")}.bind(this)}},medium:{name:i("Medium"),type:"radio",radio:"primitive-quality",selected:"MEDIUM"===r.getBrowserOption("PrimitiveQuality"),events:{click:function(){r.setBrowserOption("PrimitiveQuality","MEDIUM"),r.getNotification().string_=i("Primitive Quality")+": "+i("medium")}.bind(this)}},low:{name:i("Low"),type:"radio",radio:"primitive-quality",selected:"LOW"===r.getBrowserOption("PrimitiveQuality"),events:{click:function(){r.setBrowserOption("PrimitiveQuality","LOW"),r.getNotification().string_=i("Primitive Quality")+": "+i("low")}.bind(this)}}}},"texture-quality":{name:i("Texture Quality"),className:"context-menu-icon x_ite-private-icon-texture-quality",items:{high:{name:i("High"),type:"radio",radio:"texture-quality",selected:"HIGH"===r.getBrowserOption("TextureQuality"),events:{click:function(){r.setBrowserOption("TextureQuality","HIGH"),r.getNotification().string_=i("Texture Quality")+": "+i("high")}.bind(this)}},medium:{name:i("Medium"),type:"radio",radio:"texture-quality",selected:"MEDIUM"===r.getBrowserOption("TextureQuality"),events:{click:function(){r.setBrowserOption("TextureQuality","MEDIUM"),r.getNotification().string_=i("Texture Quality")+": "+i("medium")}.bind(this)}},low:{name:i("Low"),type:"radio",radio:"texture-quality",selected:"LOW"===r.getBrowserOption("TextureQuality"),events:{click:function(){r.setBrowserOption("TextureQuality","LOW"),r.getNotification().string_=i("Texture Quality")+": "+i("low")}.bind(this)}}}},"display-rubberband":{name:i("Display Rubberband"),type:"checkbox",selected:r.getBrowserOption("Rubberband"),events:{click:function(t){const n=e(t.target).is(":checked");r.setBrowserOption("Rubberband",n),r.getNotification().string_=n?i("Rubberband")+": "+i("on"):i("Rubberband")+": "+i("off")}.bind(this)}},"browser-timings":{name:i("Browser Timings"),type:"checkbox",selected:r.getBrowserOption("Timings"),events:{click:function(t){r.setBrowserOption("Timings",e(t.target).is(":checked")),r.getSurface().focus()}.bind(this)}},fullscreen:{name:i(u?"Leave Fullscreen":"Fullscreen"),className:"context-menu-icon "+(u?"x_ite-private-icon-leave-fullscreen":"x_ite-private-icon-fullscreen"),callback:function(){r.getElement().toggleFullScreen()}.bind(this)},separator3:"--------","world-info":{name:i("Show World Info"),className:"context-menu-icon x_ite-private-icon-world-info",callback:function(){define.show(),require(["https://cdn.jsdelivr.net/gh/showdownjs/showdown@1.9.1/dist/showdown.min.js"],function(t){define.hide(),r.getElement().find(".x_ite-private-world-info").remove();const i=new t.Converter,n=r.getElement().find(".x_ite-private-browser"),o=e("<div></div>").addClass("x_ite-private-world-info-overlay").appendTo(n),s=e("<div></div>").addClass("x_ite-private-world-info").appendTo(o),a=r.getExecutionContext().getWorldInfos()[0],u=a.title,l=a.info;i.setOption("omitExtraWLInCodeBlocks",!0),i.setOption("simplifiedAutoLink",!0),i.setOption("excludeTrailingPunctuationFromURLs",!0),i.setOption("literalMidWordUnderscores",!0),i.setOption("strikethrough",!0),i.setOption("openLinksInNewWindow",!1),e("<div></div>").addClass("x_ite-private-world-info-top").text("World Info").appendTo(s),u.length&&e("<div></div>").addClass("x_ite-private-world-info-title").text(u).appendTo(s);for(const t of l)e("<div></div>").addClass("x_ite-private-world-info-info").html(i.makeHtml(t)).appendTo(s);s.find("a").on("click",function(e){e.stopPropagation()}),s.find("a[href^=http]").each(function(){this.href.indexOf(location.hostname)===-1&&e(this).attr("target","_blank")}),o.on("click",function(){o.remove()})})}},about:{name:i("About X_ITE"),className:"context-menu-icon x_ite-private-icon-help-about",callback:function(){window.open(r.getProviderUrl())}}}};if(e.isFunction(this.userMenu)){const t=this.userMenu();if(e.isPlainObject(t)){Object.assign(c.items,{separator4:"--------"});for(const e in t)c.items["user-"+e]=t[e]}}l&&(c.className+=" x_ite-private-menu-submenus-left"),e.isEmptyObject(c.items.viewpoints.items)&&(delete c.items.separator0,delete c.items.viewpoints),Object.keys(c.items["available-viewers"].items).length<2&&delete c.items["available-viewers"],(!r.getCurrentViewer().match(/^(?:EXAMINE|FLY)$/)||s&&"GeoViewpoint"===s.getTypeName())&&delete c.items["straighten-horizon"];const h=r.getExecutionContext().getWorldInfos()[0];return(!h||0===h.title.length&&0===h.info.length)&&delete c.items["world-info"],c},getViewpoints:function(){const e=this.getBrowser(),t=e.getActiveLayer();if(!t)return{};const i=e.getBrowserOption("EnableInlineViewpoints"),n=e.currentScene,r=t.getViewpoints().get(),o=t.getViewpoint(),s={};for(const t of r){const r=t.description_.getValue();if(""!==r&&(i||t.getScene()===n)){const i={name:r,callback:function(t){e.bindViewpoint(e.getActiveLayer(),t),e.getSurface().focus()}.bind(this,t)};t===o&&(i.className="context-menu-selected"),s["Viewpoint"+t.getId()]=i}}return s},getAvailableViewers:function(){const e=this.getBrowser(),t=e.viewer_.getValue(),n=e.availableViewers_,r={};for(const o of n)r[o]={name:i(this.getViewerName(o)),className:"context-menu-icon x_ite-private-icon-"+o.toLowerCase()+"-viewer",callback:function(t){e.viewer_=t,e.getNotification().string_=i(this.getViewerName(t)),e.getSurface().focus()}.bind(this,o)},o===t&&(r[o].className+=" context-menu-selected");return r},getViewerName:function(e){switch(e){case"EXAMINE":return i("Examine Viewer");case"WALK":return i("Walk Viewer");case"FLY":return i("Fly Viewer");case"PLANE":return i("Plane Viewer");case"LOOKAT":return i("Look At Viewer");case"NONE":return i("None Viewer")}}}),n}),define("x_ite/Parser/HTMLSupport",[],function(){"use strict";const e=new Map,t=new Map;return{addNodeTypeName:function(t){e.set(t,t),e.set(t.toUpperCase(),t)},getNodeTypeName:function(t){return e.get(t)},addFieldName:function(e){t.set(e,e),t.set(e.toLowerCase(),e)},getFieldName:function(e){return t.get(e)}}}),define("x_ite/Configuration/SupportedNodes",["x_ite/Base/X3DConstants","x_ite/Parser/HTMLSupport"],function(e,t){"use strict";function i(){}const n=new Map,r=new Map;let o=e.X3DBaseNode;i.prototype={addType:function(i,r){e[i]=++o,n.set(i,r),t.addNodeTypeName(i);for(const i of r.prototype[Symbol.for("X3DBaseNode.fieldDefinitions")]){const n=i.name,r=i.accessType;r&e.initializeOnly&&t.addFieldName(n)}},getType:function(e){return n.get(e)},getTypes(){return Array.from(n.values())},addAbstractType:function(t,i){e[t]=++o,r.set(t,i)},getAbstractType:function(e){return r.get(e)},getAbstractTypes(){return Array.from(r.values())}};for(const e of Reflect.ownKeys(i.prototype))Object.defineProperty(i.prototype,e,{enumerable:!1});return new i}),define("x_ite/Execution/ImportedNode",["x_ite/Base/X3DBaseNode","x_ite/Base/X3DConstants","x_ite/Fields/SFNodeCache","x_ite/InputOutput/Generator"],function(e,t,i,n){"use strict";function r(t,i,n,r){e.call(this,t),this[o]=i,this[s]=n,this[a]=r,this[u]=new Set,this[o].loadState_.addInterest("set_loadState__",this)}const o=Symbol(),s=Symbol(),a=Symbol(),u=Symbol();r.prototype=Object.assign(Object.create(e.prototype),{constructor:r,getInlineNode:function(){return this[o]},getExportedName:function(){return this[s]},getExportedNode:function(){return this[o].getInternalScene().getExportedNode(this[s]).getValue()},getImportedName:function(){return this[a]},addRoute:function(e,i,n,r){const s={sourceNode:e,sourceField:i,destinationNode:n,destinationField:r};this[u].add(s),this[o].checkLoadState()===t.COMPLETE_STATE&&this.resolveRoute(s)},resolveRoute:function(e){try{const t=e.sourceField,i=e.destinationField;let n=e.sourceNode,o=e.destinationNode;e.real&&e.real.dispose(),n instanceof r&&(n=n.getExportedNode()),o instanceof r&&(o=o.getExportedNode()),e.real=this.getExecutionContext().addSimpleRoute(n,t,o,i)}catch(e){console.error(e.message)}},deleteRoute:function(e){for(const t of this[u])t.real===e&&this[u].delete(t)},deleteRoutes:function(){for(const e of this[u]){const t=e.real;t&&(delete e.real,this.getExecutionContext().deleteSimpleRoute(t))}},set_loadState__:function(){switch(this[o].checkLoadState()){case t.NOT_STARTED_STATE:case t.FAILED_STATE:this.deleteRoutes();break;case t.COMPLETE_STATE:this.deleteRoutes();for(const e of this[u])this.resolveRoute(e)}},toVRMLStream:function(e){const t=n.Get(e);if(!t.ExistsNode(this.getInlineNode()))throw new Error("ImportedNode.toXMLStream: Inline node does not exist.");e.string+=t.Indent(),e.string+="IMPORT",e.string+=" ",e.string+=t.Name(this.getInlineNode()),e.string+=".",e.string+=this.getExportedName(),this.getImportedName()!==this.getExportedName()&&(e.string+=" ",e.string+="AS",e.string+=" ",e.string+=this.getImportedName());try{t.AddRouteNode(this),t.AddImportedNode(this.getExportedNode(),this.getImportedName())}catch(i){for(const i of this[u]){const n=i.sourceNode,o=i.sourceField,s=i.destinationNode,a=i.destinationField;if(t.ExistsRouteNode(n)&&t.ExistsRouteNode(s)){const i=n instanceof r?n.getImportedName():t.Name(n),u=s instanceof r?s.getImportedName():t.Name(s);e.string+="\n",e.string+="\n",e.string+=t.Indent(),e.string+="ROUTE",e.string+=" ",e.string+=i,e.string+=".",e.string+=o,e.string+=" ",e.string+="TO",e.string+=" ",e.string+=u,e.string+=".",e.string+=a}}}},toXMLStream:function(e){const t=n.Get(e);if(!t.ExistsNode(this.getInlineNode()))throw new Error("ImportedNode.toXMLStream: Inline node does not exist.");e.string+=t.Indent(),e.string+="<IMPORT",e.string+=" ",e.string+="inlineDEF='",e.string+=t.XMLEncode(t.Name(this.getInlineNode())),e.string+="'",e.string+=" ",e.string+="importedDEF='",e.string+=t.XMLEncode(this.getExportedName()),e.string+="'",this.getImportedName()!==this.getExportedName()&&(e.string+=" ",e.string+="AS='",e.string+=t.XMLEncode(this.getImportedName()),e.string+="'"),e.string+="/>";try{t.AddRouteNode(this),t.AddImportedNode(this.getExportedNode(),this.getImportedName())}catch(i){for(const i of this[u]){const n=i.sourceNode,o=i.sourceField,s=i.destinationNode,a=i.destinationField;if(t.ExistsRouteNode(n)&&t.ExistsRouteNode(s)){const i=n instanceof r?n.getImportedName():t.Name(n),u=s instanceof r?s.getImportedName():t.Name(s);e.string+="\n",e.string+="\n",e.string+=t.Indent(),e.string+="<ROUTE",e.string+=" ",e.string+="fromNode='",e.string+=t.XMLEncode(i),e.string+="'",e.string+=" ",e.string+="fromField='",e.string+=t.XMLEncode(o),e.string+="'",e.string+=" ",e.string+="toNode='",e.string+=t.XMLEncode(u),e.string+="'",e.string+=" ",e.string+="toField='",e.string+=t.XMLEncode(a),e.string+="'",e.string+="/>"}}}},dispose:function(){this[o].loadState_.removeInterest("set_loadState__",this),this.deleteRoutes(),e.prototype.dispose.call(this)}});for(const e of Reflect.ownKeys(r.prototype))Object.defineProperty(r.prototype,e,{enumerable:!1});return Object.defineProperty(r.prototype,"inlineNode",{get:function(){return i.get(this[o])},enumerable:!0,configurable:!1}),Object.defineProperty(r.prototype,"exportedName",{get:function(){return this[s]},enumerable:!0,configurable:!1}),Object.defineProperty(r.prototype,"exportedNode",{get:function(){return this[o].getInternalScene().getExportedNode(this[s])},enumerable:!0,configurable:!1}),Object.defineProperty(r.prototype,"importedName",{get:function(){return this[a]},enumerable:!0,configurable:!1}),r}),define("x_ite/Prototype/ExternProtoDeclarationArray",["x_ite/Base/X3DInfoArray"],function(e){"use strict";function t(t){return e.call(this)}t.prototype=Object.assign(Object.create(e.prototype),{constructor:t,getTypeName:function(){return"ExternProtoDeclarationArray"}});for(const e of Reflect.ownKeys(t.prototype))Object.defineProperty(t.prototype,e,{enumerable:!1});return t}),define("x_ite/Prototype/ProtoDeclarationArray",["x_ite/Base/X3DInfoArray"],function(e){"use strict";function t(t){return e.call(this)}t.prototype=Object.assign(Object.create(e.prototype),{constructor:t,getTypeName:function(){return"ProtoDeclarationArray"}});for(const e of Reflect.ownKeys(t.prototype))Object.defineProperty(t.prototype,e,{enumerable:!1});return t}),define("x_ite/Routing/RouteArray",["x_ite/Base/X3DInfoArray"],function(e){"use strict";function t(){return e.call(this)}t.prototype=Object.assign(Object.create(e.prototype),{constructor:t,getTypeName:function(){return"RouteArray"}});for(const e of Reflect.ownKeys(t.prototype))Object.defineProperty(t.prototype,e,{enumerable:!1});return t}),define("x_ite/Routing/X3DRoute",["x_ite/Base/X3DObject","x_ite/Base/X3DConstants","x_ite/Fields/SFNodeCache","x_ite/InputOutput/Generator"],function(e,t,i,n){"use strict";function r(t,i,n,r,c){e.call(this,t),this[o]=t,this[s]=i,this[a]=n,this[u]=r,this[l]=c,n.addFieldInterest(c),n.addOutputRoute(this),c.addInputRoute(this)}const o=Symbol(),s=Symbol(),a=Symbol(),u=Symbol(),l=Symbol();r.prototype=Object.assign(Object.create(e.prototype),{getTypeName:function(){return"X3DRoute"},getExecutionContext:function(){return this[o]},getSourceNode:function(){return this[s]},getSourceField:function(){return this[a].getName()},getDestinationNode:function(){return this[u]},getDestinationField:function(){return this[l].getName()},disconnect:function(){this[a].removeFieldInterest(this[l]),this[a].removeOutputRoute(this),this[l].removeInputRoute(this)},toVRMLStream:function(e){const i=n.Get(e),r=i.LocalName(this[s]),o=i.LocalName(this[u]);e.string+=i.Indent(),e.string+="ROUTE",e.string+=" ",e.string+=r,e.string+=".",e.string+=this[a].getName(),this[a].getAccessType()===t.inputOutput&&(e.string+="_changed"),e.string+=" ",e.string+="TO",e.string+=" ",e.string+=o,e.string+=".",this[l].getAccessType()===t.inputOutput&&(e.string+="set_"),e.string+=this[l].getName()},toXMLStream:function(e){const i=n.Get(e),r=i.LocalName(this[s]),o=i.LocalName(this[u]);e.string+=i.Indent(),e.string+="<ROUTE",e.string+=" ",e.string+="fromNode='",e.string+=i.XMLEncode(r),e.string+="'",e.string+=" ",e.string+="fromField='",e.string+=i.XMLEncode(this[a].getName()),this[a].getAccessType()===t.inputOutput&&(e.string+="_changed"),e.string+="'",e.string+=" ",e.string+="toNode='",e.string+=i.XMLEncode(o),e.string+="'",e.string+=" ",e.string+="toField='",this[l].getAccessType()===t.inputOutput&&(e.string+="set_"),e.string+=i.XMLEncode(this[l].getName()),e.string+="'",e.string+="/>"},dispose:function(){this.disconnect(),this[o].deleteRoute(this),e.prototype.dispose.call(this)}});for(const e of Reflect.ownKeys(r.prototype))Object.defineProperty(r.prototype,e,{enumerable:!1});return Object.defineProperty(r.prototype,"sourceNode",{get:function(){return i.get(this[s])},enumerable:!0,configurable:!1}),Object.defineProperty(r.prototype,"sourceField",{get:function(){return this[a].getName()},enumerable:!0,configurable:!1}),Object.defineProperty(r.prototype,"destinationNode",{get:function(){return i.get(this[u])},enumerable:!0,configurable:!1}),Object.defineProperty(r.prototype,"destinationField",{get:function(){return this[l].getName()},enumerable:!0,configurable:!1}),r}),define("x_ite/Base/X3DCast",["x_ite/Fields"],function(e){"use strict";return function(t,i){try{if(i&&(i instanceof e.SFNode&&(i=i.getValue()),i&&(i=i.getInnerNode(),i.getType().indexOf(t)!==-1)))return i}catch(e){}return null}}),define("x_ite/Execution/X3DExecutionContext",["x_ite/Configuration/SupportedNodes","x_ite/Fields","x_ite/Base/X3DBaseNode","x_ite/Execution/ImportedNode","x_ite/Prototype/ExternProtoDeclarationArray","x_ite/Prototype/ProtoDeclarationArray","x_ite/Routing/RouteArray","x_ite/Routing/X3DRoute","x_ite/Base/X3DCast","x_ite/Base/X3DConstants","x_ite/InputOutput/Generator","x_ite/Fields/SFNodeCache","standard/Math/Algorithm"],function(e,t,i,n,r,o,s,a,u,l,c,h,d){"use strict";function p(e){i.call(this,e),this.addType(l.X3DExecutionContext),this.addChildObjects("rootNodes",new t.MFNode,"worldInfos",new t.MFNode),this.rootNodes_.setAccessType(l.initializeOnly),this.rootNodes_.addCloneCount(1),this[f]=new Map,this[g]=new Map,this[m]=new o,this[y]=new r,this[_]=new s}const f=Symbol(),g=Symbol(),m=Symbol(),y=Symbol(),_=Symbol(),x=Symbol();e.addAbstractType("X3DExecutionContext"),p.prototype=Object.assign(Object.create(i.prototype),{constructor:p,getTypeName:function(){return"X3DExecutionContext"},[x]:null,getNode:function(){return this[x]},setNode:function(e){this[x]=e},getSpecificationVersion:function(){return this.getExecutionContext().getSpecificationVersion()},getEncoding:function(){return this.getExecutionContext().getEncoding()},getWorldURL:function(){return this.getExecutionContext().getWorldURL()},getProfile:function(){return this.getExecutionContext().getProfile()},getComponents:function(){return this.getExecutionContext().getComponents()},fromUnit:function(e,t){return this.getExecutionContext().fromUnit(e,t)},toUnit:function(e,t){return this.getExecutionContext().toUnit(e,t)},getUnits:function(){return this.getExecutionContext().getUnits()},createNode:function(e,t=!0){if(t===!1){const t=this.getBrowser().getSupportedNode(e);return t?new t(this):null}{const t=this.getBrowser().getSupportedNode(e);if(!t)throw new Error("Unknown node type '"+e+"'.");const i=new t(this);return i.setup(),h.get(i)}},createProto:function(e,t=!0){const i=require("x_ite/Execution/X3DScene");let n=this;for(;;){const r=n.protos.get(e);if(r)return r.createInstance(this,t);const o=n.externprotos.get(e);if(o)return o.createInstance(this,t);if(n instanceof i)break;n=n.getExecutionContext()}if(t===!1)return null;throw new Error("Unknown proto or externproto type '"+e+"'.")},addNamedNode:function(e,t){if(this[f].has(e))throw new Error("Couldn't add named node: node named '"+e+"' is already in use.");this.updateNamedNode(e,t)},updateNamedNode:function(e,n){if(!(n instanceof t.SFNode||n instanceof i))throw new Error("Couldn't update named node: node must be of type SFNode.");e=String(e);const r=n instanceof t.SFNode?n.getValue():n;if(!r)throw new Error("Couldn't update named node: node IS NULL.");if(r.getExecutionContext()!==this)throw new Error("Couldn't update named node: node does not belong to this execution context.");if(0===e.length)throw new Error("Couldn't update named node: node name is empty.");this.removeNamedNode(r.getName()),this.removeNamedNode(e),r.setName(e),this[f].set(e,r)},removeNamedNode:function(e){this[f].delete(e)},getNamedNode:function(e){const t=this[f].get(e);if(t)return h.get(t);throw new Error("Named node '"+e+"' not found.")},getNamedNodes:function(){return this[f]},getUniqueName:function(){return function(e){e=e.replace(/_\d+$/,"");let t=e,i=64;for(;i&&(this[f].has(t)||0===t.length);){const n=i,r=i<<=1;t=e,t+="_",t+=Math.round(d.random(n,r))}return t}}(),addImportedNode:function(e,t,i){if(void 0===i&&(i=t),this[g].has(i))throw new Error("Couldn't add imported node: imported name '"+i+"' already in use.");this.updateImportedNode(e,t,i)},updateImportedNode:function(e,t,i){if(e=u(l.Inline,e),t=String(t),i=void 0===i?t:String(i),!e)throw new Error("Node named is not an Inline node.");if(e.getExecutionContext()!==this)throw new Error("Couldn't update imported node: Inline node does not belong to this execution context.");if(0===t.length)throw new Error("Couldn't update imported node: exported name is empty.");if(0===i.length)throw new Error("Couldn't update imported node: imported name is empty.");this.removeImportedNode(i);const r=new n(this,e,t,i);this[g].set(i,r),r.setup()},removeImportedNode:function(e){const t=this[g].get(e);t&&(t.dispose(),this[g].delete(e))},getImportedNode:function(e){const t=this[g].get(e);if(t)return h.get(t.getExportedNode());throw new Error("Imported node '"+e+"' not found.")},getImportedNodes:function(){return this[g]},getLocalNode:function(e){try{return this.getNamedNode(e)}catch(t){const i=this[g].get(e);if(i)return h.get(i);throw new Error("Unknown named or imported node '"+e+"'.")}},getLocalName:function(e){if(!(e instanceof t.SFNode))throw new Error("Couldn't get local name: node is NULL.");if(e.getValue().getExecutionContext()===this)return e.getValue().getName();for(const t of this[g].values())try{if(t.getExportedNode()===e.getValue())return t.getImportedName()}catch(e){}throw new Error("Couldn't get local name: node is shared.")},setRootNodes:function(){},getRootNodes:function(){return this.rootNodes_},getProtoDeclaration:function(e){const t=this[m].get(e);if(t)return t;throw new Error("Proto declaration '"+e+"' not found.")},addProtoDeclaration(e,t){if(!(t instanceof require("x_ite/Prototype/X3DProtoDeclaration")))throw new Error("Couldn't add proto declaration: proto must be of type X3DProtoDeclaration.");if(this[m].get(e))throw new Error("Couldn't add proto declaration: proto '"+e+"' already in use.");if(e=String(e),0===e.length)throw new Error("Couldn't add proto declaration: proto name is empty.");this[m].add(e,t),t.setName(e)},updateProtoDeclaration(e,t){if(!(t instanceof require("x_ite/Prototype/X3DProtoDeclaration")))throw new Error("Couldn't add proto declaration: proto must be of type X3DProtoDeclaration.");if(e=String(e),0===e.length)throw new Error("Couldn't add proto declaration: proto name is empty.");this[m].update(t.getName(),e,t),t.setName(e)},removeProtoDeclaration(e){this[m].remove(e)},getProtoDeclarations:function(){return this[m]},getUniqueProtoName:function(){return function(e){e=e.replace(/\d+$/,"");let t=e,i=64;for(;i&&this[m].has(t);){const n=i,r=i<<=1;t=e,t+=Math.round(d.random(n,r))}return t}}(),getExternProtoDeclaration:function(e){const t=this[y].get(e);if(t)return t;throw new Error("Extern proto declaration '"+e+"' not found.")},addExternProtoDeclaration(e,t){if(!(t instanceof require("x_ite/Prototype/X3DExternProtoDeclaration")))throw new Error("Couldn't add extern proto declaration: extern proto must be of type X3DExternProtoDeclaration.");if(this[y].get(e))throw new Error("Couldn't add extern proto declaration: extern proto '"+e+"' already in use.");if(e=String(e),0===e.length)throw new Error("Couldn't add extern proto declaration: extern proto name is empty.");this[y].add(e,t),t.setName(e)},updateExternProtoDeclaration(e,t){if(!(t instanceof require("x_ite/Prototype/X3DExternProtoDeclaration")))throw new Error("Couldn't add extern proto declaration: extern proto must be of type X3DExternProtoDeclaration.");if(e=String(e),0===e.length)throw new Error("Couldn't add extern proto declaration: extern proto name is empty.");this[y].update(t.getName(),e,t),t.setName(e)},removeExternProtoDeclaration(e){this[y].remove(e)},getExternProtoDeclarations:function(){return this[y]},getUniqueExternProtoName:function(){return function(e){e=e.replace(/\d+$/,"");let t=e,i=64;for(;i&&this[y].has(t);){const n=i,r=i<<=1;t=e,t+=Math.round(d.random(n,r))}return t}}(),addRoute:function(e,i,r,o){if(i=String(i),o=String(o),!(e instanceof t.SFNode))throw new Error("Bad ROUTE specification: source node must be of type SFNode.");if(!(r instanceof t.SFNode))throw new Error("Bad ROUTE specification: destination node must be of type SFNode.");const s=e.getValue(),a=r.getValue();if(!s)throw new Error("Bad ROUTE specification: source node is NULL.");if(!a)throw new Error("Bad ROUTE specification: destination node is NULL.");let u=s instanceof n?s:null,l=a instanceof n?a:null;try{s.getExecutionContext()!==this&&(u=this.getLocalNode(this.getLocalName(e)).getValue())}catch(e){}try{a.getExecutionContext()!==this&&(l=this.getLocalNode(this.getLocalName(r)).getValue())}catch(e){}if(u instanceof n&&l instanceof n?(u.addRoute(u,i,l,o),l.addRoute(u,i,l,o)):u instanceof n?u.addRoute(u,i,a,o):l instanceof n&&l.addRoute(s,i,l,o),u!==s&&l!==a)return this.addSimpleRoute(s,i,a,o)},addSimpleRoute:function(e,t,i,n){try{if(t=e.getField(t),n=i.getField(n),!t.isOutput())throw new Error("Field named '"+t.getName()+"' in node named '"+e.getName()+"' of type "+e.getTypeName()+" is not an output field.");if(!n.isInput())throw new Error("Field named '"+n.getName()+"' in node named '"+i.getName()+"' of type "+i.getTypeName()+" is not an input field.");if(t.getType()!==n.getType())throw new Error("ROUTE types "+t.getTypeName()+" and "+n.getTypeName()+" do not match.");const r=t.getId()+"."+n.getId();let o=this[_].get(r);return o?o:(o=new a(this,e,t,i,n),this[_].add(r,o),o)}catch(e){throw new Error("Bad ROUTE specification: "+e.message)}},deleteRoute:function(e){if(4===arguments.length&&!(e=this.getRoute.apply(this,arguments)))return!1;this.deleteSimpleRoute(e)&&this.deleteImportedRoute(e.sourceNode,e.destinationNode,e)},deleteSimpleRoute:function(e){try{const t=e.getSourceNode().getField(e.getSourceField()),i=e.getDestinationNode().getField(e.getDestinationField()),n=t.getId()+"."+i.getId();return this[_].remove(n),e.disconnect(),!0}catch(e){return console.log(e),!1}},deleteImportedRoute(e,t,i){let r=null,o=null;try{e.getValue().getExecutionContext()!==this&&(r=this.getLocalNode(this.getLocalName(e)).getValue())}catch(e){}try{t.getValue().getExecutionContext()!==this&&(o=this.getLocalNode(this.getLocalName(t)).getValue())}catch(e){}r instanceof n&&o instanceof n?(r.deleteRoute(i),o.deleteRoute(i)):r instanceof n?r.deleteRoute(i):o instanceof n&&o.deleteRoute(i)},getRoute:function(e,t,i,n){if(!e.getValue())throw new Error("Bad ROUTE specification: sourceNode is NULL.");if(!i.getValue())throw new Error("Bad ROUTE specification: destinationNode is NULL.");t=e.getValue().getField(t),n=i.getValue().getField(n);const r=t.getId()+"."+n.getId();return this[_].get(r)},getRoutes:function(){return this[_]},getWorldInfos:function(){return this.worldInfos_},addWorldInfo:function(e){this.worldInfos_.push(e)},removeWorldInfo:function(e){const t=this.worldInfos_.getValue().indexOf(e);t!==-1&&this.worldInfos_.splice(t,1)},toVRMLStream:function(e){const t=c.Get(e);t.PushExecutionContext(this),t.EnterScope(),t.ImportedNodes(this.getImportedNodes()),this.getExternProtoDeclarations().toVRMLStream(e),this.getProtoDeclarations().toVRMLStream(e);const i=this.getRootNodes();for(let n=0,r=i.length;n<r;++n){const o=i[n];e.string+=t.Indent(),o?o.toVRMLStream(e):e.string+="NULL",e.string+="\n",n!==r-1&&(e.string+="\n")}const n=this.getImportedNodes();n.size&&(e.string+="\n",n.forEach(function(t){try{t.toVRMLStream(e),e.string+="\n"}catch(e){}}));const r=this.getRoutes();r.length&&(e.string+="\n",r.toVRMLStream(e)),t.LeaveScope(),t.PopExecutionContext()},toXMLStream:function(e){const t=c.Get(e);t.PushExecutionContext(this),t.EnterScope(),t.ImportedNodes(this.getImportedNodes()),this.getExternProtoDeclarations().toXMLStream(e),this.getProtoDeclarations().toXMLStream(e);const i=this.getRootNodes();i.length&&(i.toXMLStream(e),e.string+="\n"),this.getImportedNodes().forEach(function(t){try{t.toXMLStream(e),e.string+="\n"}catch(e){}}),this.getRoutes().toXMLStream(e),t.LeaveScope(),t.PopExecutionContext()},dispose:function(){this.rootNodes_.dispose();for(const e of this[_])this.deleteRoute(e);i.prototype.dispose.call(this)}});for(const e of Reflect.ownKeys(p.prototype))Object.defineProperty(p.prototype,e,{enumerable:!1});return Object.defineProperty(p.prototype,"specificationVersion",{get:function(){return this.getSpecificationVersion()},enumerable:!0,configurable:!1}),Object.defineProperty(p.prototype,"encoding",{get:function(){return this.getEncoding()},enumerable:!0,configurable:!1}),Object.defineProperty(p.prototype,"profile",{get:function(){return this.getProfile()},enumerable:!0,configurable:!1}),Object.defineProperty(p.prototype,"components",{get:function(){return this.getComponents()},enumerable:!0,configurable:!1}),Object.defineProperty(p.prototype,"worldURL",{get:function(){return this.getWorldURL()},enumerable:!0,configurable:!1}),Object.defineProperty(p.prototype,"units",{get:function(){return this.getUnits()},enumerable:!0,configurable:!1}),Object.defineProperty(p.prototype,"rootNodes",{get:function(){return this.getRootNodes()},set:function(e){this.setRootNodes(e)},enumerable:!0,configurable:!1}),Object.defineProperty(p.prototype,"protos",{get:function(){return this.getProtoDeclarations()},enumerable:!0,configurable:!1}),Object.defineProperty(p.prototype,"externprotos",{get:function(){return this.getExternProtoDeclarations()},enumerable:!0,configurable:!1}),Object.defineProperty(p.prototype,"routes",{get:function(){return this.getRoutes()},enumerable:!0,configurable:!1}),p}),define("x_ite/Configuration/ComponentInfo",["x_ite/Base/X3DObject","x_ite/InputOutput/Generator"],function(e,t){"use strict";function i(e,t,i,n){this.name=e,this.level=t,this.title=i,this.providerUrl=n}i.prototype=Object.assign(Object.create(e.prototype),{constructor:i,getTypeName:function(){return"ComponentInfo"},toVRMLStream:function(e){e.string+="COMPONENT",e.string+=" ",e.string+=this.name,e.string+=" ",e.string+=":",e.string+=" ",e.string+=this.level},toXMLStream:function(e){const i=t.Get(e);e.string+=i.Indent(),e.string+="<component",e.string+=" ",e.string+="name='",e.string+=this.name,e.string+="'",e.string+=" ",e.string+="level='",e.string+=this.level,e.string+="'",e.string+="/>"}});for(const e of Reflect.ownKeys(i.prototype))Object.defineProperty(i.prototype,e,{enumerable:!1});return i}),define("x_ite/Configuration/ComponentInfoArray",["x_ite/Configuration/ComponentInfo","x_ite/Base/X3DInfoArray"],function(e,t){"use strict";function i(e){const i=t.call(this);for(const t of e)this.add(t.name,t);return i}i.prototype=Object.assign(Object.create(t.prototype),{constructor:i,getTypeName:function(){return"ComponentInfoArray"},addComponent:function(t){this.add(t.name,new e(t.name,t.level,t.title,t.providerUrl))}});for(const e of Reflect.ownKeys(i.prototype))Object.defineProperty(i.prototype,e,{enumerable:!1});return i}),define("x_ite/Configuration/UnitInfo",["x_ite/Base/X3DObject","x_ite/InputOutput/Generator"],function(e,t){"use strict";function i(e,t,i){Object.defineProperty(this,"category",{value:e,writable:!1}),this.name=t,this.conversionFactor=i}i.prototype=Object.assign(Object.create(e.prototype),{constructor:i,getTypeName:function(){return"UnitInfo"},toVRMLStream:function(e){e.string+="UNIT",e.string+=" ",e.string+=this.category,
e.string+=" ",e.string+=this.name,e.string+=" ",e.string+=this.conversionFactor},toXMLStream:function(e){const i=t.Get(e);e.string+=i.Indent(),e.string+="<unit",e.string+=" ",e.string+="category='",e.string+=this.category,e.string+="'",e.string+=" ",e.string+="name='",e.string+=i.XMLEncode(this.name),e.string+="'",e.string+=" ",e.string+="conversionFactor='",e.string+=this.conversionFactor,e.string+="'",e.string+="/>"}});for(const e of Reflect.ownKeys(i.prototype))Object.defineProperty(i.prototype,e,{enumerable:!1});return Object.defineProperty(i.prototype,"conversion_factor",{get:function(){return this.conversionFactor},enumerable:!1,configurable:!1}),i}),define("x_ite/Configuration/UnitInfoArray",["x_ite/Base/X3DInfoArray"],function(e){"use strict";function t(){return e.call(this)}t.prototype=Object.assign(Object.create(e.prototype),{constructor:t,getTypeName:function(){return"UnitInfoArray"}});for(const e of Reflect.ownKeys(t.prototype))Object.defineProperty(t.prototype,e,{enumerable:!1});return t}),define("x_ite/Execution/ExportedNode",["x_ite/Base/X3DObject","x_ite/Fields/SFNodeCache","x_ite/InputOutput/Generator"],function(e,t,i){"use strict";function n(t,i){e.call(this),this[r]=t,this[o]=i}const r=Symbol(),o=Symbol();n.prototype=Object.assign(Object.create(e.prototype),{constructor:n,getExportedName:function(){return this[r]},getLocalNode:function(){return this[o]},toVRMLStream:function(e){const t=i.Get(e),n=t.LocalName(this[o]);e.string+=t.Indent(),e.string+="EXPORT",e.string+=" ",e.string+=n,this[r]!==n&&(e.string+=" ",e.string+="AS",e.string+=" ",e.string+=this[r])},toXMLStream:function(e){const t=i.Get(e),n=t.LocalName(this[o]);e.string+=t.Indent(),e.string+="<EXPORT",e.string+=" ",e.string+="localDEF='",e.string+=t.XMLEncode(n),e.string+="'",this[r]!==n&&(e.string+=" ",e.string+="AS='",e.string+=t.XMLEncode(this[r]),e.string+="'"),e.string+="/>"}});for(const e of Reflect.ownKeys(n.prototype))Object.defineProperty(n.prototype,e,{enumerable:!1});return Object.defineProperty(n.prototype,"exportedName",{get:function(){return t.get(this[r])},enumerable:!0,configurable:!1}),Object.defineProperty(n.prototype,"localNode",{get:function(){return t.get(this[o])},enumerable:!0,configurable:!1}),n}),define("x_ite/Execution/X3DScene",["x_ite/Configuration/SupportedNodes","x_ite/Fields","x_ite/Execution/X3DExecutionContext","x_ite/Configuration/ComponentInfoArray","x_ite/Configuration/UnitInfo","x_ite/Configuration/UnitInfoArray","x_ite/Execution/ExportedNode","x_ite/Base/X3DConstants","x_ite/InputOutput/Generator","x_ite/Fields/SFNodeCache"],function(e,t,i,n,r,o,s,a,u,l){"use strict";function c(e){i.call(this,e),this.addType(a.X3DScene),this[h]="3.3",this[d]="SCRIPTED",this[p]=null,this[f]=new n([]),this[g]=location.toString(),this[m]=new o,this[m].add("angle",new r("angle","radian",1)),this[m].add("force",new r("force","newton",1)),this[m].add("length",new r("length","metre",1)),this[m].add("mass",new r("mass","kilogram",1)),this[y]=new Map,this[_]=new Map,this.getRootNodes().setAccessType(a.inputOutput),this.setLive(!1)}const h=Symbol(),d=Symbol(),p=Symbol(),f=Symbol(),g=Symbol(),m=Symbol(),y=Symbol(),_=Symbol();e.addAbstractType("X3DScene"),c.prototype=Object.assign(Object.create(i.prototype),{constructor:c,getTypeName:function(){return"X3DScene"},isMainScene:function(){return this===this.getExecutionContext()},setSpecificationVersion:function(e){this[h]=e},getSpecificationVersion:function(){return this[h]},setEncoding:function(e){this[d]=e},getEncoding:function(){return this[d]},setWorldURL:function(e){this[g]=e},getWorldURL:function(){return this[g]},setProfile:function(e){this[p]=e},getProfile:function(){return this[p]},addComponent:function(e){this[f].add(e.name,e)},getComponents:function(){return this[f]},updateUnit:function(e,t,i){const n=this[m].get(e);n&&(n.name=t,n.conversionFactor=i)},getUnits:function(){return this[m]},fromUnit:function(e,t){switch(e){case"angle":case"force":case"length":case"mass":return t*this.getUnits().get(e).conversionFactor;case"acceleration:":return t*this.getUnits().get("length").conversionFactor;case"angularRate":return t*this.getUnits().get("angle").conversionFactor;case"area":return t*Math.pow(this.getUnits().get("length").conversionFactor,2);case"speed":return t*this.getUnits().get("length").conversionFactor;case"volume":return t*Math.pow(this.getUnits().get("length").conversionFactor,3)}return t},toUnit:function(e,t){switch(e){case"angle":case"force":case"length":case"mass":return t/this.getUnits().get(e).conversionFactor;case"acceleration:":return t/this.getUnits().get("length").conversionFactor;case"angularRate":return t/this.getUnits().get("angle").conversionFactor;case"area":return t/Math.pow(this.getUnits().get("length").conversionFactor,2);case"speed":return t/this.getUnits().get("length").conversionFactor;case"volume":return t/Math.pow(this.getUnits().get("length").conversionFactor,3)}return t},setMetaData:function(e,t){e.length&&this[y].set(e,String(t))},removeMetaData:function(e){this[y].delete(e)},getMetaData:function(e){return this[y].get(e)},getMetaDatas:function(){return this[y]},addExportedNode:function(e,t){if(this[_].has(e))throw new Error("Couldn't add exported node: exported name '"+e+"' already in use.");this.updateExportedNode(e,t)},updateExportedNode:function(e,i){if(e=String(e),0===e.length)throw new Error("Couldn't update exported node: node exported name is empty.");if(!(i instanceof t.SFNode))throw new Error("Couldn't update exported node: node must be of type SFNode.");if(!i.getValue())throw new Error("Couldn't update exported node: node IS NULL.");const n=new s(e,i.getValue());this[_].set(e,n)},removeExportedNode:function(e){this[_].delete(e)},getExportedNode:function(e){const t=this[_].get(e);if(t)return l.get(t.getLocalNode());throw new Error("Exported node '"+e+"' not found.")},getExportedNodes:function(){return this[_]},addRootNode:function(e){if(null===e&&(e=new t.SFNode),!(e instanceof t.SFNode))throw new Error("Couldn't add root node: node must be of type SFNode.");const i=this.getRootNodes();for(const t of i)if(t.equals(e))return;i.push(e)},removeRootNode:function(e){if(null===e&&(e=new t.SFNode),!(e instanceof t.SFNode))throw new Error("Couldn't remove root node: node must be of type SFNode.");const i=this.getRootNodes(),n=i.length;i.erase(i.remove(0,n,e),n)},setRootNodes:function(e){this.getRootNodes().setValue(e)},toVRMLStream:function(e){const n=u.Get(e);let r=this.getSpecificationVersion();"2.0"===r&&(r="3.3"),e.string+="#X3D V",e.string+=r,e.string+=" ",e.string+="utf8",e.string+=" ",e.string+=this.getBrowser().name,e.string+=" ",e.string+="V",e.string+=this.getBrowser().version,e.string+="\n",e.string+="\n";const o=this.getProfile();o&&(o.toVRMLStream(e),e.string+="\n",e.string+="\n");const s=this.getComponents();s.length&&(s.toVRMLStream(e),e.string+="\n");{let t=!0;for(const i of this.getUnits())1!==i.conversionFactor&&(t=!1,i.toVRMLStream(e),e.string+="\n");t||(e.string+="\n")}const a=this.getMetaDatas();a.size&&(a.forEach(function(i,n){e.string+="META",e.string+=" ",e.string+=new t.SFString(n).toString(),e.string+=" ",e.string+=new t.SFString(i).toString(),e.string+="\n"}),e.string+="\n");const l=this.getExportedNodes();n.PushExecutionContext(this),n.EnterScope(),n.ExportedNodes(l),i.prototype.toVRMLStream.call(this,e),l.size&&(e.string+="\n",l.forEach(function(t){try{t.toVRMLStream(e),e.string+="\n"}catch(e){console.log(e)}})),n.LeaveScope(),n.PopExecutionContext()},toXMLStream:function(e){const t=u.Get(e);let n=this.getSpecificationVersion();"2.0"===n&&(n="3.3"),e.string+='<?xml version="1.0" encoding="UTF-8"?>\n',e.string+='<!DOCTYPE X3D PUBLIC "ISO//Web3D//DTD X3D ',e.string+=n,e.string+='//EN" "http://www.web3d.org/specifications/x3d-',e.string+=n,e.string+='.dtd">\n',e.string+="<X3D",e.string+=" ",e.string+="profile='",e.string+=this.getProfile()?this.getProfile().name:"Full",e.string+="'",e.string+=" ",e.string+="version='",e.string+=n,e.string+="'",e.string+=" ",e.string+="xmlns:xsd='http://www.w3.org/2001/XMLSchema-instance'",e.string+=" ",e.string+="xsd:noNamespaceSchemaLocation='http://www.web3d.org/specifications/x3d-",e.string+=n,e.string+=".xsd'>\n",t.IncIndent(),e.string+=t.Indent(),e.string+="<head>\n",t.IncIndent(),this.getComponents().toXMLStream(e);for(const t of this.getUnits())1!==t.conversionFactor&&(t.toXMLStream(e),e.string+="\n");this.getMetaDatas().forEach(function(i,n){e.string+=t.Indent(),e.string+="<meta",e.string+=" ",e.string+="name='",e.string+=t.XMLEncode(n),e.string+="'",e.string+=" ",e.string+="content='",e.string+=t.XMLEncode(i),e.string+="'",e.string+="/>\n"}),t.DecIndent(),e.string+=t.Indent(),e.string+="</head>\n",e.string+=t.Indent(),e.string+="<Scene>\n",t.IncIndent();const r=this.getExportedNodes();t.PushExecutionContext(this),t.EnterScope(),t.ExportedNodes(r),i.prototype.toXMLStream.call(this,e),r.forEach(function(t){try{t.toXMLStream(e),e.string+="\n"}catch(e){console.log(e)}}),t.LeaveScope(),t.PopExecutionContext(),t.DecIndent(),e.string+=t.Indent(),e.string+="</Scene>\n",t.DecIndent(),e.string+="</X3D>\n"}});for(const e of Reflect.ownKeys(c.prototype))Object.defineProperty(c.prototype,e,{enumerable:!1});return c}),define("x_ite/Execution/Scene",["x_ite/Fields","x_ite/Execution/X3DScene"],function(e,t){"use strict";function i(i){this[n]=i,t.call(this,this),this.addChildObjects("initLoadCount",new e.SFInt32,"loadCount",new e.SFInt32),this[r]=new Set}const n=Symbol.for("X3DEventObject.browser"),r=Symbol();i.prototype=Object.assign(Object.create(t.prototype),{constructor:i,setExecutionContext:function(e){if(!this.isMainScene()){const e=this.getScene();for(const t of this[r])e.removeLoadCount(t)}if(t.prototype.setExecutionContext.call(this,e),!this.isMainScene()){const e=this.getScene();for(const t of this[r])e.addLoadCount(t)}},addInitLoadCount:function(e){this.initLoadCount_=this.initLoadCount_.getValue()+1},removeInitLoadCount:function(e){this.initLoadCount_=this.initLoadCount_.getValue()-1},addLoadCount:function(e){if(!this[r].has(e)){this[r].add(e),this.loadCount_=this[r].size;const t=this.getBrowser(),i=this.getScene();this!==t.getExecutionContext()&&this.loader!==t.loader||t.addLoadCount(e),this.isMainScene()||i.addLoadCount(e)}},removeLoadCount:function(e){if(this[r].has(e)){this[r].delete(e),this.loadCount_=this[r].size;const t=this.getBrowser(),i=this.getScene();this!==t.getExecutionContext()&&this.loader!==t.loader||t.removeLoadCount(e),this.isMainScene()||i.removeLoadCount(e)}},getLoadingObjects:function(){return this[r]}});for(const e of Reflect.ownKeys(i.prototype))Object.defineProperty(i.prototype,e,{enumerable:!1});return i}),define("x_ite/Parser/X3DParser",[],function(){"use strict";function e(e){this.scene=e,this.executionContexts=[e],this.prototypes=[],this.units=!0}return e.prototype={constructor:e,getScene:function(){return this.scene},getBrowser:function(){return this.scene.getBrowser()},getExecutionContext:function(){return this.executionContexts.at(-1)},pushExecutionContext:function(e){return this.executionContexts.push(e)},popExecutionContext:function(){this.executionContexts.pop()},getPrototype:function(){return this.prototypes.at(-1)},pushPrototype:function(e){return this.prototypes.push(e)},popPrototype:function(){this.prototypes.pop()},isInsideProtoDefinition:function(){return Boolean(this.prototypes.length)},addRootNode:function(e){this.getExecutionContext().rootNodes.push(e)},getProviderUrls:function(){return function(){const e=this.getScene(),t=e.getProfile()?e.getProfile():e.getBrowser().getProfile("Full"),i=t.components,n=e.getComponents(),r=new Set;for(const e of i){const t=e.providerUrl;t.match(/\.js$/)&&r.add(t)}for(const e of n){const t=e.providerUrl;t.match(/\.js$/)&&r.add(t)}if("function"==typeof globalRequire&&"string"==typeof __filename)for(const e of r)globalRequire(globalRequire("url").fileURLToPath(e));return Array.from(r)}}(),setUnits:function(e){if("boolean"==typeof arguments[0])return void(this.units=arguments[0]);const t=e.match(/Titania\s+V(\d+).*/);if(t){const e=parseInt(t[1]);if(e<4)return void(this.units=!1)}this.units=!0},getUnits:function(){return this.units},fromUnit:function(e,t){return this.units?this.getExecutionContext().fromUnit(e,t):t}},e}),define("x_ite/Components/Networking/X3DUrlObject",["x_ite/Fields","x_ite/Base/X3DConstants"],function(e,t){"use strict";function i(i){this.addType(t.X3DUrlObject),this.addChildObjects("loadState",new e.SFInt32(t.NOT_STARTED_STATE),"urlBuffer",new e.MFString),this[n]=!0,this[r]=performance.now()}const n=Symbol(),r=Symbol(),o=Symbol(),s=Symbol();return i.prototype={constructor:i,initialize:function(){this.isLive().addInterest("set_live__",this),this.load_.addInterest("set_load__",this),this.url_.addInterest("set_url__",this),this.urlBuffer_.addInterest("loadNow",this),this.autoRefresh_.addInterest("set_autoRefresh__",this),this.autoRefreshTimeLimit_.addInterest("set_autoRefresh__",this)},setLoadState:function(e,i=!0){if(this.loadState_=e,e===t.COMPLETE_STATE&&(this[o]=performance.now(),this.setAutoRefreshTimer(this.autoRefresh_.getValue())),i)switch(e){case t.NOT_STARTED_STATE:break;case t.IN_PROGRESS_STATE:this.getScene().addLoadCount(this);break;case t.COMPLETE_STATE:case t.FAILED_STATE:this.getScene().removeLoadCount(this)}},checkLoadState:function(){return this.loadState_.getValue()},getLoadState:function(){return this.loadState_},setCache:function(e){this[n]=e},getCache:function(){return this[n]},requestImmediateLoad:function(e=!0){this.checkLoadState()!==t.COMPLETE_STATE&&this.checkLoadState()!==t.IN_PROGRESS_STATE&&this.load_.getValue()&&0!==this.url_.length&&(this.setCache(e),this.setLoadState(t.IN_PROGRESS_STATE),this.urlBuffer_=this.url_)},loadNow:function(){},requestUnload:function(){this.checkLoadState()!==t.NOT_STARTED_STATE&&this.checkLoadState()!==t.FAILED_STATE&&(this.setLoadState(t.NOT_STARTED_STATE),this.unloadNow())},unloadNow:function(){},setAutoRefreshTimer:function(e){if(clearTimeout(this[s]),!(this.autoRefresh_.getValue()<=0)){const t=this.autoRefreshTimeLimit_.getValue();0!==t&&(performance.now()-this[r])/1e3>t-e||(this[s]=setTimeout(this.performAutoRefresh.bind(this),1e3*e))}},performAutoRefresh:function(){this.setLoadState(t.NOT_STARTED_STATE),this.requestImmediateLoad(!1)},set_live__:function(){this.isLive().getValue()?this.set_autoRefresh__():clearTimeout(this[s])},set_load__:function(){this.load_.getValue()?(this.setLoadState(t.NOT_STARTED_STATE),this.requestImmediateLoad()):this.requestUnload()},set_url__:function(){this.load_.getValue()&&(this.setLoadState(t.NOT_STARTED_STATE),this.requestImmediateLoad())},set_autoRefresh__:function(){if(this.checkLoadState()===t.COMPLETE_STATE){const e=(performance.now()-this[o])/1e3,t=this.autoRefresh_.getValue();let i=t-e;i<0&&(i=Math.ceil(e/t)*t-e),this.setAutoRefreshTimer(i)}}},i}),define("x_ite/Components/Core/X3DNode",["x_ite/Fields","x_ite/Base/X3DBaseNode","x_ite/Base/X3DConstants","x_ite/InputOutput/Generator"],function(e,t,i,n){"use strict";function r(e){t.call(this,e),this.addType(i.X3DNode)}return r.prototype=Object.assign(Object.create(t.prototype),{constructor:r,copy:function(e){const t=e.getBody(),n=this.getName();if(n.length){const e=t.getNamedNodes().get(n);if(e)return e}const r=this.create(t);n.length&&t.updateNamedNode(n,r);for(const t of this.getPredefinedFields())try{const n=r.getField(t.getName());if(t.hasReferences())for(const i of t.getReferences())try{n.addReference(e.getField(i.getName()))}catch(e){console.error(e.message)}else if(t.getAccessType()&i.initializeOnly)switch(t.getType()){case i.SFNode:case i.MFNode:n.set(t.copy(e).getValue());break;default:n.set(t.getValue(),t.length)}}catch(e){console.log(e.message)}for(const t of this.getUserDefinedFields()){const i=t.copy(e);if(r.addUserDefinedField(t.getAccessType(),t.getName(),i),t.hasReferences())for(const n of t.getReferences())try{i.addReference(e.getField(n.getName()))}catch(t){console.error("No reference '"+n.getName()+"' inside execution context "+e.getTypeName()+" '"+e.getName()+"'.")}}return r.setup(),r},getDisplayName:function(){return function(){return this.getName().replace(/_\d+$/,"")}}(),getFieldsAreEnumerable:function(){return!0},traverse:function(){},toStream:function(e){e.string+=this.getTypeName()+" { }"},toVRMLStream:function(e){const t=n.Get(e);t.EnterScope();const i=t.Name(this);if(i.length&&t.ExistsNode(this))return e.string+="USE",e.string+=" ",e.string+=i,void t.LeaveScope();i.length&&(t.AddNode(this),e.string+="DEF",e.string+=" ",e.string+=i,e.string+=" "),e.string+=this.getTypeName(),e.string+=" ",e.string+="{";const r=this.getChangedFields(),o=this.getUserDefinedFields();let s=0,a=0;if(this.canUserDefinedFields()){for(const e of o)s=Math.max(s,e.getTypeName().length),a=Math.max(a,t.AccessType(e.getAccessType()).length);if(o.length){e.string+="\n",t.IncIndent();for(const t of o)this.toVRMLStreamUserDefinedField(e,t,s,a),e.string+="\n";t.DecIndent(),0!==r.length&&(e.string+="\n")}}0===r.length?o.length?e.string+=t.Indent():e.string+=" ":(0===o.length&&(e.string+="\n"),t.IncIndent(),r.forEach(function(t){this.toVRMLStreamField(e,t,s,a),e.string+="\n"},this),t.DecIndent(),e.string+=t.Indent()),e.string+="}",t.LeaveScope()},toVRMLStreamField:function(e,t,r,o){const s=n.Get(e),a=s.IsSharedNode(this);if(0===t.getReferences().size||!s.ExecutionContext()||a)t.isInitializable()&&(e.string+=s.Indent(),e.string+=t.getName(),e.string+=" ",t.toVRMLStream(e));else{let n=0,r=!1;t.getReferences().forEach(function(i){r=r||i.isInitializable(),e.string+=s.Indent(),e.string+=t.getName(),e.string+=" ",e.string+="IS",e.string+=" ",e.string+=i.getName(),++n!==t.getReferences().size&&(e.string+="\n")}),t.getAccessType()!==i.inputOutput||r||this.isDefaultValue(t)||(e.string+="\n",e.string+=s.Indent(),e.string+=t.getName(),e.string+=" ",t.toVRMLStream(e))}},toVRMLStreamUserDefinedField:function(e,t,r,o){const s=n.Get(e),a=s.IsSharedNode(this);if(0===t.getReferences().size||!s.ExecutionContext()||a)e.string+=s.Indent(),e.string+=s.PadRight(s.AccessType(t.getAccessType()),o),e.string+=" ",e.string+=s.PadRight(t.getTypeName(),r),e.string+=" ",e.string+=t.getName(),t.isInitializable()&&(e.string+=" ",t.toVRMLStream(e));else{let n=0,a=!1;t.getReferences().forEach(function(i){a=a||i.isInitializable(),e.string+=s.Indent(),e.string+=s.PadRight(s.AccessType(t.getAccessType()),o),e.string+=" ",e.string+=s.PadRight(t.getTypeName(),r),e.string+=" ",e.string+=t.getName(),e.string+=" ",e.string+="IS",e.string+=" ",e.string+=i.getName(),++n!==t.getReferences().size&&(e.string+="\n")}),t.getAccessType()!==i.inputOutput||a||t.isDefaultValue()||(e.string+="\n",e.string+=s.Indent(),e.string+=s.PadRight(s.AccessType(t.getAccessType()),o),e.string+=" ",e.string+=s.PadRight(t.getTypeName(),r),e.string+=" ",e.string+=t.getName(),t.isInitializable()&&(e.string+=" ",t.toVRMLStream(e)))}},toXMLStream:function(e){const t=n.Get(e),r=t.IsSharedNode(this);t.EnterScope();const o=t.Name(this);if(o.length&&t.ExistsNode(this)){e.string+=t.Indent(),e.string+="<",e.string+=this.getTypeName(),e.string+=" ",e.string+="USE='",e.string+=t.XMLEncode(o),e.string+="'";const i=t.ContainerField();return i&&i.getName()!==this.getContainerField()&&(e.string+=" ",e.string+="containerField='",e.string+=t.XMLEncode(i.getName()),e.string+="'"),e.string+="/>",void t.LeaveScope()}e.string+=t.Indent(),e.string+="<",e.string+=this.getTypeName(),o.length&&(t.AddNode(this),e.string+=" ",e.string+="DEF='",e.string+=t.XMLEncode(o),e.string+="'");const s=t.ContainerField();s&&s.getName()!==this.getContainerField()&&(e.string+=" ",e.string+="containerField='",e.string+=t.XMLEncode(s.getName()),e.string+="'");const a=this.getChangedFields(),u=this.getUserDefinedFields(),l=[],c=[];let h=this.getSourceText();h&&0===h.length&&(h=null),t.IncIndent(),t.IncIndent();for(const n of a){let o=!1;if(t.ExecutionContext()&&n.getAccessType()===i.inputOutput&&0!==n.getReferences().size){let e=!1;n.getReferences().forEach(function(t){e=e||t.isInitializable()}),e||(o=!this.isDefaultValue(n))}if(0===n.getReferences().size||!t.ExecutionContext()||r||o){if(o&&l.push(n),n.isInitializable())switch(n.getType()){case i.SFNode:case i.MFNode:c.push(n);break;default:if(n===h)break;e.string+="\n",e.string+=t.Indent(),e.string+=n.getName(),e.string+="='",n.toXMLStream(e),e.string+="'"}}else l.push(n)}if(t.DecIndent(),t.DecIndent(),this.canUserDefinedFields()&&u.length||l.length&&!r||c.length||h){if(e.string+=">\n",t.IncIndent(),this.canUserDefinedFields())for(const n of u){e.string+=t.Indent(),e.string+="<field",e.string+=" ",e.string+="accessType='",e.string+=t.AccessType(n.getAccessType()),e.string+="'",e.string+=" ",e.string+="type='",e.string+=n.getTypeName(),e.string+="'",e.string+=" ",e.string+="name='",e.string+=t.XMLEncode(n.getName()),e.string+="'";let o=!1;if(n.getAccessType()===i.inputOutput&&0!==n.getReferences().size){let e=!1;n.getReferences().forEach(function(t){e=e||t.isInitializable()}),e||(o=!0)}if(0===n.getReferences().size||!t.ExecutionContext()||r||o)if(o&&t.ExecutionContext()&&l.push(n),!n.isInitializable()||n.isDefaultValue())e.string+="/>\n";else switch(n.getType()){case i.SFNode:case i.MFNode:t.PushContainerField(n),e.string+=">\n",t.IncIndent(),n.toXMLStream(e),e.string+="\n",t.DecIndent(),e.string+=t.Indent(),e.string+="</field>\n",t.PopContainerField();break;default:e.string+=" ",e.string+="value='",n.toXMLStream(e),e.string+="'",e.string+="/>\n"}else t.ExecutionContext()&&l.push(n),e.string+="/>\n"}if(l.length&&!r){e.string+=t.Indent(),e.string+="<IS>",e.string+="\n",t.IncIndent();for(const i of l){const n=i.getReferences();n.forEach(function(n){e.string+=t.Indent(),e.string+="<connect",e.string+=" ",e.string+="nodeField='",e.string+=t.XMLEncode(i.getName()),e.string+="'",e.string+=" ",e.string+="protoField='",e.string+=t.XMLEncode(n.getName()),e.string+="'",e.string+="/>\n"})}t.DecIndent(),e.string+=t.Indent(),e.string+="</IS>\n"}for(const i of c)t.PushContainerField(i),i.toXMLStream(e),e.string+="\n",t.PopContainerField();if(h)for(const i of h)e.string+="<![CDATA[",e.string+=t.escapeCDATA(i),e.string+="]]>\n";t.DecIndent(),e.string+=t.Indent(),e.string+="</",e.string+=this.getTypeName(),e.string+=">"}else e.string+="/>";t.LeaveScope()},dispose:function(){const n=this.getExecutionContext();if(this.getName()&&n.removeNamedNode(this.getName()),!n.isMainScene()){const e=n.getExecutionContext();for(const[t,i]of new Map(e.getImportedNodes()))try{i.getExportedNode()===this&&e.removeImportedNode(t)}catch(e){}}if(n.getType().includes(i.X3DScene))for(const[e,t]of new Map(n.getExportedNodes()))t.getLocalNode()===this&&n.removeExportedNode(e);for(const e of this.getFields())e.dispose();for(const t of new Set(this.getParents()))if(t instanceof e.SFNode){for(const i of new Set(t.getParents()))if(i instanceof e.MFNode){const e=i.length;i.erase(i.remove(0,e,t),e)}t.setValue(null)}t.prototype.dispose.call(this)}}),r}),define("x_ite/Components/Core/X3DPrototypeInstance",["x_ite/Base/X3DChildObject","x_ite/Components/Core/X3DNode","x_ite/Execution/X3DExecutionContext","x_ite/Base/X3DConstants","x_ite/InputOutput/Generator"],function(e,t,i,n,r){"use strict";function o(e,i){this[s]=i,this[a]=i.getFieldDefinitions(),t.call(this,e),this.addType(n.X3DPrototypeInstance);const r=require("x_ite/Prototype/X3DProtoDeclaration");e.getNode()instanceof r||i.isExternProto&&(i.updateInstances_.addInterest("construct",this),i.requestImmediateLoad())}const s=Symbol(),a=Symbol.for("X3DBaseNode.fieldDefinitions");return o.prototype=Object.assign(Object.create(t.prototype),{constructor:o,create:function(e){return new o(e,this[s])},getTypeName:function(){return this[s].getName()},getComponentName:function(){return"Core"},getContainerField:function(){return"children"},initialize:function(){try{t.prototype.initialize.call(this),this[s].isExternProto||this.construct()}catch(e){console.log(e),console.error(e.message)}},construct:function(){this.body&&this.body.dispose();const t=this[s].getProtoDeclaration();if(!t)return this.body=new i(this.getExecutionContext()),this.body.setNode(this),this.body.setup(),void(this.isInitialized()&&e.prototype.addEvent.call(this));if(this[s].isExternProto)for(const e of t.getFieldDefinitions())try{const i=this.getField(e.name),r=t.getField(e.name);if(i.getAccessType()!==r.getAccessType())continue;if(i.getType()!==r.getType())continue;if(!(i.getAccessType()&n.initializeOnly))continue;if(i.getModificationTime())continue;if(i.hasReferences())continue;if(i.equals(r))continue;i.setValue(r)}catch(t){this.addField(e)}this.body=new i(t.getExecutionContext()),this.body.setNode(this),this.importExternProtos(t.getBody().externprotos),this.importProtos(t.getBody().protos),this.copyRootNodes(t.getBody().rootNodes),this.copyImportedNodes(t.getBody(),t.getBody().getImportedNodes()),this.copyRoutes(t.getBody(),t.getBody().routes),this.body.setup(),this.isInitialized()&&e.prototype.addEvent.call(this),this[s].updateInstances_.removeInterest("construct",this),this[s].updateInstances_.addInterest("update",this)},update:function(){const e=Array.from(this.getFields());for(const t of e)this.removeField(t.getName());for(const e of this.getFieldDefinitions())this.addField(e);for(const t of e){const e=this.getFields().get(t.getName());e&&e.getType()===t.getType()&&e.isInitializable()&&e.assign(t)}for(const e of this.getFields())e.setTainted(!1);this.construct()},getExtendedEventHandling:function(){return!1},getProtoNode:function(){return this[s]},getBody:function(){return this.body},getInnerNode:function(){const e=this.body.getRootNodes().getValue();if(e.length){const t=e[0];if(t)return t.getValue().getInnerNode()}throw new Error("Root node not available.")},importExternProtos:function(e){const t=this.body.externprotos;for(const i of e)t.add(i.getName(),i)},importProtos:function(e){const t=this.body.protos;for(const i of e)t.add(i.getName(),i)},copyRootNodes:function(e){const t=this.body.getRootNodes();for(const i of e)t.push(i.copy(this))},copyImportedNodes:function(e,t){t.forEach(function(e,t){try{const i=this.body.getNamedNode(e.getInlineNode().getName()),n=e.getExportedName();this.body.addImportedNode(i,n,t)}catch(e){console.error("Bad IMPORT specification in copy: ",e)}},this)},copyRoutes:function(e,t){for(const i of t)try{const t=this.body.getLocalNode(e.getLocalName(i.sourceNode)),n=this.body.getLocalNode(e.getLocalName(i.destinationNode));this.body.addRoute(t,i.sourceField,n,i.destinationField)}catch(e){console.log(e)}},toXMLStream:function(e){const t=r.Get(e),i=t.IsSharedNode(this);t.EnterScope();const o=t.Name(this);if(o.length&&t.ExistsNode(this)){e.string+=t.Indent(),e.string+="<ProtoInstance",e.string+=" ",e.string+="name='",e.string+=t.XMLEncode(this.getTypeName()),e.string+="'",e.string+=" ",e.string+="USE='",e.string+=t.XMLEncode(o),e.string+="'";const i=t.ContainerField();return i&&i.getName()!==this.getContainerField()&&(e.string+=" ",e.string+="containerField='",e.string+=t.XMLEncode(i.getName()),e.string+="'"),e.string+="/>",void t.LeaveScope()}e.string+=t.Indent(),e.string+="<ProtoInstance",e.string+=" ",e.string+="name='",e.string+=t.XMLEncode(this.getTypeName()),e.string+="'",o.length&&(t.AddNode(this),e.string+=" ",e.string+="DEF='",e.string+=t.XMLEncode(o),e.string+="'");const s=t.ContainerField();s&&s.getName()!==this.getContainerField()&&(e.string+=" ",e.string+="containerField='",e.string+=t.XMLEncode(s.getName()),e.string+="'");const a=this.getChangedFields();if(0===a.length)e.string+="/>";else{e.string+=">\n",t.IncIndent();const r=[];for(const o of a){let s=!1;if(t.ExecutionContext()&&o.getAccessType()===n.inputOutput&&0!==o.getReferences().size){let e=!1;o.getReferences().forEach(function(t){e=e||t.isInitializable()}),e||(s=!this.isDefaultValue(o))}if(0===o.getReferences().size||!t.ExecutionContext()||i||s)switch(s&&r.push(o),o.getType()){case n.MFNode:e.string+=t.Indent(),e.string+="<fieldValue",e.string+=" ",e.string+="name='",e.string+=t.XMLEncode(o.getName()),e.string+="'",0===o.length?e.string+="/>\n":(t.PushContainerField(o),e.string+=">\n",t.IncIndent(),o.toXMLStream(e),e.string+="\n",t.DecIndent(),e.string+=t.Indent(),e.string+="</fieldValue>\n",t.PopContainerField());break;case n.SFNode:if(null!==o.getValue()){t.PushContainerField(o),e.string+=t.Indent(),e.string+="<fieldValue",e.string+=" ",e.string+="name='",e.string+=t.XMLEncode(o.getName()),e.string+="'",e.string+=">\n",t.IncIndent(),o.toXMLStream(e),e.string+="\n",t.DecIndent(),e.string+=t.Indent(),e.string+="</fieldValue>\n",t.PopContainerField();break}default:e.string+=t.Indent(),e.string+="<fieldValue",e.string+=" ",e.string+="name='",e.string+=t.XMLEncode(o.getName()),e.string+="'",e.string+=" ",e.string+="value='",o.toXMLStream(e),e.string+="'",e.string+="/>\n"}else r.push(o)}if(r.length&&!i){e.string+=t.Indent(),e.string+="<IS>",e.string+="\n",t.IncIndent();for(const i of r){const n=i.getReferences();n.forEach(function(n){e.string+=t.Indent(),e.string+="<connect",e.string+=" ",e.string+="nodeField='",e.string+=t.XMLEncode(i.getName()),e.string+="'",e.string+=" ",e.string+="protoField='",e.string+=t.XMLEncode(n.getName()),e.string+="'",e.string+="/>\n"})}t.DecIndent(),e.string+=t.Indent(),e.string+="</IS>\n"}t.DecIndent(),e.string+=t.Indent(),e.string+="</ProtoInstance>"}t.LeaveScope()},dispose:function(){this[s].updateInstances_.removeInterest("construct",this),this[s].updateInstances_.removeInterest("update",this),this.body&&this.body.dispose(),t.prototype.dispose.call(this)}}),o}),define("x_ite/Prototype/X3DProtoDeclarationNode",["x_ite/Configuration/SupportedNodes","x_ite/Fields","x_ite/Base/X3DBaseNode","x_ite/Components/Core/X3DPrototypeInstance","x_ite/Fields/SFNodeCache","x_ite/Base/X3DConstants"],function(e,t,i,n,r,o){"use strict";function s(e){i.call(this,e),this.addType(o.X3DProtoDeclarationNode),this.addChildObjects("updateInstances",new t.SFTime)}e.addAbstractType("X3DProtoDeclarationNode"),s.prototype=Object.assign(Object.create(i.prototype),{constructor:s,canUserDefinedFields:function(){return!0},createInstance:function(e,t=!0){if(t===!1)return new n(e,this);{const t=new n(e,this);return t.setup(),r.get(t)}},newInstance:function(){return this.createInstance(this.getExecutionContext())},requestUpdateInstances:function(){this.updateInstances_=this.getBrowser().getCurrentTime()}});for(const e of Reflect.ownKeys(s.prototype))Object.defineProperty(s.prototype,e,{enumerable:!1});return s}),define("x_ite/Prototype/X3DExternProtoDeclaration",["jquery","x_ite/Configuration/SupportedNodes","x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Networking/X3DUrlObject","x_ite/Prototype/X3DProtoDeclarationNode","x_ite/Base/X3DConstants","x_ite/InputOutput/Generator"],function(e,t,i,n,r,o,s,a,u){"use strict";function l(e,t){s.call(this,e),o.call(this,e),this.addType(a.X3DExternProtoDeclaration),this.addChildObjects("load",new i.SFBool(!0),"url",t.copy(),"autoRefresh",new i.SFTime,"autoRefreshTimeLimit",new i.SFTime(3600))}t.addAbstractType("X3DExternProtoDeclaration");const c=Symbol(),h=Symbol();l.prototype=Object.assign(Object.create(s.prototype),o.prototype,{constructor:l,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new r([new n(a.inputOutput,"metadata",new i.SFNode)]),getTypeName:function(){return"X3DExternProtoDeclaration"},initialize:function(){s.prototype.initialize.call(this),o.prototype.initialize.call(this)},set_live__:function(){o.prototype.set_live__.call(this),this.checkLoadState()===a.COMPLETE_STATE&&this[h].setLive(this.isLive().getValue())},canUserDefinedFields:function(){return!0},setProtoDeclaration:function(e){if(this[c]=e,e){const t=this.getFieldDefinitions();for(const e of Array.from(t))t.remove(e.name);for(const i of e.getFieldDefinitions())t.add(i.name,i)}this.requestUpdateInstances()},getProtoDeclaration:function(){return this[c]},loadNow:function(){this.getScene().addInitLoadCount(this),
new(require("x_ite/InputOutput/FileLoader"))(this).createX3DFromURL(this.urlBuffer_,null,this.setInternalSceneAsync.bind(this))},setInternalSceneAsync:function(e){e?this.setInternalScene(e):this.setError(new Error("File could not be loaded.")),this.getScene().removeInitLoadCount(this)},setInternalScene:function(e){this[h]=e;const t=new URL(this[h].getWorldURL()).hash.substr(1),i=t?this[h].protos.get(t):this[h].protos[0];if(!i)throw new Error("PROTO not found");this[h].setLive(this.isLive().getValue()),this[h].setPrivate(this.getScene().getPrivate()),this[h].setExecutionContext(this.getExecutionContext()),this.setLoadState(a.COMPLETE_STATE),this.setProtoDeclaration(i)},getInternalScene:function(){return this[h]},setError:function(e){console.error("Error loading extern prototype:",e),this[h]=this.getBrowser().getPrivateScene(),this.setLoadState(a.FAILED_STATE),this.setProtoDeclaration(null)},toVRMLStream:function(e){const t=u.Get(e);e.string+=t.Indent(),e.string+="EXTERNPROTO",e.string+=" ",e.string+=this.getName(),e.string+=" ",e.string+="[";const i=this.getUserDefinedFields();let n=0,r=0;if(0===i.length)e.string+=" ";else{for(const e of i)n=Math.max(n,e.getTypeName().length),r=Math.max(r,t.AccessType(e.getAccessType()).length);e.string+="\n",t.IncIndent();for(const t of i)this.toVRMLStreamUserDefinedField(e,t,n,r),e.string+="\n";t.DecIndent(),e.string+=t.Indent()}e.string+="]",e.string+="\n",e.string+=t.Indent(),this.url_.toVRMLStream(e)},toVRMLStreamUserDefinedField:function(e,t,i,n){const r=u.Get(e);e.string+=r.Indent(),e.string+=r.PadRight(r.AccessType(t.getAccessType()),n),e.string+=" ",e.string+=r.PadRight(t.getTypeName(),i),e.string+=" ",e.string+=t.getName()},toXMLStream:function(e){const t=u.Get(e);e.string+=t.Indent(),e.string+="<ExternProtoDeclare",e.string+=" ",e.string+="name='",e.string+=t.XMLEncode(this.getName()),e.string+="'",e.string+=" ",e.string+="url='",this.url_.toXMLStream(e),e.string+="'",e.string+=">\n",t.IncIndent();const i=this.getUserDefinedFields();for(const n of i)e.string+=t.Indent(),e.string+="<field",e.string+=" ",e.string+="accessType='",e.string+=t.AccessType(n.getAccessType()),e.string+="'",e.string+=" ",e.string+="type='",e.string+=n.getTypeName(),e.string+="'",e.string+=" ",e.string+="name='",e.string+=t.XMLEncode(n.getName()),e.string+="'",e.string+="/>\n";t.DecIndent(),e.string+=t.Indent(),e.string+="</ExternProtoDeclare>"}});for(const e of Reflect.ownKeys(l.prototype))Object.defineProperty(l.prototype,e,{enumerable:!1});return Object.defineProperty(l.prototype,"name",{get:function(){return this.getName()},enumerable:!0,configurable:!1}),Object.defineProperty(l.prototype,"fields",{get:function(){return this.getFieldDefinitions()},enumerable:!0,configurable:!1}),Object.defineProperty(l.prototype,"isExternProto",{get:function(){return!0},enumerable:!0,configurable:!1}),Object.defineProperty(l.prototype,"urls",{get:function(){return this.url_},enumerable:!0,configurable:!1}),Object.defineProperty(l.prototype,"loadState",{get:function(){return this.checkLoadState()},enumerable:!0,configurable:!1}),l}),define("x_ite/Prototype/X3DProtoDeclaration",["x_ite/Configuration/SupportedNodes","x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Execution/X3DExecutionContext","x_ite/Prototype/X3DProtoDeclarationNode","x_ite/Base/X3DConstants","x_ite/InputOutput/Generator"],function(e,t,i,n,r,o,s,a){"use strict";function u(e){o.call(this,e),this.addType(s.X3DProtoDeclaration),this.addChildObjects("loadState",new t.SFInt32(s.NOT_STARTED_STATE)),this[l]=new r(e),this[l].setNode(this),this[l].setLive(!1),this.setLive(!1)}e.addAbstractType("X3DProtoDeclaration");const l=Symbol();u.prototype=Object.assign(Object.create(o.prototype),{constructor:u,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new n([new i(s.inputOutput,"metadata",new t.SFNode)]),getTypeName:function(){return"X3DProtoDeclaration"},initialize:function(){o.prototype.initialize.call(this),this[l].setup(),this.loadState_=s.COMPLETE_STATE},getProtoDeclaration:function(){return this},getBody:function(){return this[l]},checkLoadState:function(){return this.loadState_.getValue()},canUserDefinedFields:function(){return!0},toVRMLStream:function(e){const t=a.Get(e);e.string+=t.Indent(),e.string+="PROTO",e.string+=" ",e.string+=this.getName(),e.string+=" ",e.string+="[",t.EnterScope();const i=this.getUserDefinedFields();let n=0,r=0;if(0===i.length)e.string+=" ";else{for(const e of i)n=Math.max(n,e.getTypeName().length),r=Math.max(r,t.AccessType(e.getAccessType()).length);e.string+="\n",t.IncIndent();for(const t of i)this.toVRMLStreamUserDefinedField(e,t,n,r),e.string+="\n";t.DecIndent(),e.string+=t.Indent()}t.LeaveScope(),e.string+="]",e.string+="\n",e.string+=t.Indent(),e.string+="{",e.string+="\n",t.IncIndent(),this[l].toVRMLStream(e),t.DecIndent(),e.string+=t.Indent(),e.string+="}"},toVRMLStreamUserDefinedField:function(e,t,i,n){const r=a.Get(e);e.string+=r.Indent(),e.string+=r.PadRight(r.AccessType(t.getAccessType()),n),e.string+=" ",e.string+=r.PadRight(t.getTypeName(),i),e.string+=" ",e.string+=t.getName(),t.isInitializable()&&(e.string+=" ",t.toVRMLStream(e))},toXMLStream:function(e){const t=a.Get(e);e.string+=t.Indent(),e.string+="<ProtoDeclare",e.string+=" ",e.string+="name='",e.string+=t.XMLEncode(this.getName()),e.string+="'",e.string+=">",e.string+="\n",t.EnterScope();const i=this.getUserDefinedFields();if(0!==i.length){t.IncIndent(),e.string+=t.Indent(),e.string+="<ProtoInterface>\n",t.IncIndent();for(const n of i)if(e.string+=t.Indent(),e.string+="<field",e.string+=" ",e.string+="accessType='",e.string+=t.AccessType(n.getAccessType()),e.string+="'",e.string+=" ",e.string+="type='",e.string+=n.getTypeName(),e.string+="'",e.string+=" ",e.string+="name='",e.string+=t.XMLEncode(n.getName()),e.string+="'",n.isDefaultValue())e.string+="/>\n";else switch(n.getType()){case s.SFNode:case s.MFNode:t.PushContainerField(n),e.string+=">\n",t.IncIndent(),n.toXMLStream(e),e.string+="\n",t.DecIndent(),e.string+=t.Indent(),e.string+="</field>\n",t.PopContainerField();break;default:e.string+=" ",e.string+="value='",n.toXMLStream(e),e.string+="'",e.string+="/>\n"}t.DecIndent(),e.string+=t.Indent(),e.string+="</ProtoInterface>\n",t.DecIndent()}t.LeaveScope(),t.IncIndent(),e.string+=t.Indent(),e.string+="<ProtoBody>\n",t.IncIndent(),this[l].toXMLStream(e),t.DecIndent(),e.string+=t.Indent(),e.string+="</ProtoBody>\n",t.DecIndent(),e.string+=t.Indent(),e.string+="</ProtoDeclare>"}});for(const e of Reflect.ownKeys(u.prototype))Object.defineProperty(u.prototype,e,{enumerable:!1});return Object.defineProperty(u.prototype,"name",{get:function(){return this.getName()},enumerable:!0,configurable:!1}),Object.defineProperty(u.prototype,"fields",{get:function(){return this.getFieldDefinitions()},enumerable:!0,configurable:!1}),Object.defineProperty(u.prototype,"isExternProto",{get:function(){return!1},enumerable:!0,configurable:!1}),u}),define("x_ite/Parser/Parser",["x_ite/Fields","x_ite/Parser/X3DParser","x_ite/Prototype/X3DExternProtoDeclaration","x_ite/Prototype/X3DProtoDeclaration","x_ite/Base/X3DConstants"],function(e,t,i,n,r){"use strict";function o(e){switch(e){case r.inializeOnly:return"initializeOnly";case r.inputOnly:return"inputOnly";case r.outputOnly:return"outputOnly";case r.inputOutput:return"inputOutput"}}function s(e){return this.lastIndex=e.lastIndex,e.result=this.exec(e.input),!!e.result&&(e.lastIndex=this.lastIndex,!0)}function a(e){t.call(this,e)}var u={Whitespaces:new RegExp("([\\x20\\n,\\t\\r]+)","gy"),Comment:new RegExp("#(.*?)(?=[\\n\\r])","gy"),Header:new RegExp("^#(VRML|X3D) V(.*?) (utf8)(?:[ \\t]+(.*?))?[ \\t]*[\\n\\r]","gy"),AS:new RegExp("AS","gy"),COMPONENT:new RegExp("COMPONENT","gy"),DEF:new RegExp("DEF","gy"),EXPORT:new RegExp("EXPORT","gy"),EXTERNPROTO:new RegExp("EXTERNPROTO","gy"),FALSE:new RegExp("FALSE|false","gy"),IMPORT:new RegExp("IMPORT","gy"),IS:new RegExp("IS","gy"),META:new RegExp("META","gy"),NULL:new RegExp("NULL","gy"),TRUE:new RegExp("TRUE|true","gy"),PROFILE:new RegExp("PROFILE","gy"),PROTO:new RegExp("PROTO","gy"),ROUTE:new RegExp("ROUTE","gy"),TO:new RegExp("TO","gy"),UNIT:new RegExp("UNIT","gy"),USE:new RegExp("USE","gy"),OpenBrace:new RegExp("\\{","gy"),CloseBrace:new RegExp("\\}","gy"),OpenBracket:new RegExp("\\[","gy"),CloseBracket:new RegExp("\\]","gy"),Period:new RegExp("\\.","gy"),Colon:new RegExp("\\:","gy"),Id:new RegExp("([^\\x30-\\x39\\x00-\\x20\\x22\\x23\\x27\\x2b\\x2c\\x2d\\x2e\\x5b\\x5c\\x5d\\x7b\\x7d\\x7f]{1}[^\\x00-\\x20\\x22\\x23\\x27\\x2c\\x2e\\x5b\\x5c\\x5d\\x7b\\x7d\\x7f]*)","gy"),ComponentNameId:new RegExp("([^\\x30-\\x39\\x00-\\x20\\x22\\x23\\x27\\x2b\\x2c\\x2d\\x2e\\x5b\\x5c\\x5d\\x7b\\x7d\\x7f\\x3a]{1}[^\\x00-\\x20\\x22\\x23\\x27\\x2c\\x2e\\x5b\\x5c\\x5d\\x7b\\x7d\\x7f\\x3a]*)","gy"),initializeOnly:new RegExp("initializeOnly","gy"),inputOnly:new RegExp("inputOnly","gy"),outputOnly:new RegExp("outputOnly","gy"),inputOutput:new RegExp("inputOutput","gy"),field:new RegExp("field","gy"),eventIn:new RegExp("eventIn","gy"),eventOut:new RegExp("eventOut","gy"),exposedField:new RegExp("exposedField","gy"),FieldType:new RegExp("(MFBool|MFColorRGBA|MFColor|MFDouble|MFFloat|MFImage|MFInt32|MFMatrix3d|MFMatrix3f|MFMatrix4d|MFMatrix4f|MFNode|MFRotation|MFString|MFTime|MFVec2d|MFVec2f|MFVec3d|MFVec3f|MFVec4d|MFVec4f|SFBool|SFColorRGBA|SFColor|SFDouble|SFFloat|SFImage|SFInt32|SFMatrix3d|SFMatrix3f|SFMatrix4d|SFMatrix4f|SFNode|SFRotation|SFString|SFTime|SFVec2d|SFVec2f|SFVec3d|SFVec3f|SFVec4d|SFVec4f)","gy"),int32:new RegExp("((?:0[xX][\\da-fA-F]+)|(?:[+-]?\\d+))","gy"),double:new RegExp("([+-]?(?:(?:(?:\\d*\\.\\d+)|(?:\\d+(?:\\.)?))(?:[eE][+-]?\\d+)?))","gy"),string:new RegExp('"((?:[^\\\\"]|\\\\\\\\|\\\\\\")*)"',"gy"),Inf:new RegExp("[+]?(?:inf|Infinity)","gy"),NegativeInf:new RegExp("-(?:inf|Infinity)","gy"),NaN:new RegExp("[+-]?(nan|NaN)","gy"),Break:new RegExp("\\r?\\n","g")};for(var l in u)u[l].parse=s;return a.prototype=Object.assign(Object.create(t.prototype),{accessTypes:{field:r.initializeOnly,eventIn:r.inputOnly,eventOut:r.outputOnly,exposedField:r.inputOutput,initializeOnly:r.initializeOnly,inputOnly:r.inputOnly,outputOnly:r.outputOnly,inputOutput:r.inputOutput},SFBool:new e.SFBool,SFColor:new e.SFColor,SFColorRGBA:new e.SFColorRGBA,SFDouble:new e.SFDouble,SFFloat:new e.SFFloat,SFImage:new e.SFImage,SFInt32:new e.SFInt32,SFMatrix3f:new e.SFMatrix3f,SFMatrix3d:new e.SFMatrix3d,SFMatrix4f:new e.SFMatrix4f,SFMatrix4d:new e.SFMatrix4d,SFNode:new e.SFNode,SFRotation:new e.SFRotation,SFString:new e.SFString,SFTime:new e.SFTime,SFVec2d:new e.SFVec2d,SFVec2f:new e.SFVec2f,SFVec3d:new e.SFVec3d,SFVec3f:new e.SFVec3f,SFVec4d:new e.SFVec4d,SFVec4f:new e.SFVec4f,MFBool:new e.MFBool,MFColor:new e.MFColor,MFColorRGBA:new e.MFColorRGBA,MFDouble:new e.MFDouble,MFFloat:new e.MFFloat,MFImage:new e.MFImage,MFInt32:new e.MFInt32,MFMatrix3d:new e.MFMatrix3d,MFMatrix3f:new e.MFMatrix3f,MFMatrix4d:new e.MFMatrix4d,MFMatrix4f:new e.MFMatrix4f,MFNode:new e.MFNode,MFRotation:new e.MFRotation,MFString:new e.MFString,MFTime:new e.MFTime,MFVec2d:new e.MFVec2d,MFVec2f:new e.MFVec2f,MFVec3d:new e.MFVec3d,MFVec3f:new e.MFVec3f,MFVec4d:new e.MFVec4d,MFVec4f:new e.MFVec4f,setInput:function(e){this.input=e,this.lineNumber=1,this.lastIndex=0},getInput:function(){return this.input},exception:function(e){if(this.getBrowser().isStrict())throw new Error(e);console.warn(e)},parseIntoScene:function(e,t,i){try{return this.success=t,this.error=i,this.getScene().setEncoding("VRML"),this.getScene().setProfile(this.getBrowser().getProfile("Full")),this.setInput(e),void this.x3dScene()}catch(e){throw new Error(this.getError(e))}},getError:function(e){var t=e.message,i=this.getLine(),n=this.getLastLine(),r=this.getLastLine(),o=n.length-i.length+1;return n.length>80&&(n=n.substr(o-40,80),r="",o=40),"\n********************************************************************************\nParser error at line "+this.lineNumber+":"+o+"\nin '"+this.getScene().getWorldURL()+"'\n\n"+r+"\n"+n+"\n"+Array(o).join(" ")+"^\n"+t+"\n********************************************************************************\n"},getLine:function(){for(var e=this.input,t=this.lastIndex,i="";t<e.length&&"\n"!==e[t]&&"\r"!==e[t];)i+=e[t++];return this.lastIndex=t,i},getLastLine:function(){var e=this.input,t=this.lastIndex,i="";for(t<e.length&&("\n"!==e[t]||"\r"!==e[t])&&--t;t>=0&&"\n"!==e[t]&&"\r"!==e[t];)i=e[t--]+i;return this.lastIndex=t,i},comments:function(){for(;this.comment(););},comment:function(){return!!this.whitespaces()||u.Comment.parse(this)},whitespaces:function(){return!!u.Whitespaces.parse(this)&&(this.xml||this.lines(this.result[1]),!0)},lines:function(e){var t=e.match(u.Break);t&&(this.lineNumber+=t.length)},x3dScene:function(){this.pushExecutionContext(this.getScene()),this.headerStatement(),this.profileStatement(),this.componentStatements(),this.unitStatements(),this.metaStatements();try{this.setUnits(this.getScene().getMetaData("generator"))}catch(e){}if(this.success)require(this.getProviderUrls(),function(){try{if(this.statements(),this.popExecutionContext(),this.lastIndex<this.input.length)throw new Error("Unknown statement.");this.success(this.getScene())}catch(e){this.error(new Error(this.getError(e)))}}.bind(this),function(e){this.error(e)}.bind(this));else if(this.statements(),this.popExecutionContext(),this.lastIndex<this.input.length)throw new Error("Unknown statement.")},headerStatement:function(){u.Header.lastIndex=0;var e=u.Header.exec(this.input);return!!e&&(this.getScene().setSpecificationVersion(e[2]),this.getScene().setEncoding("VRML"),!0)},profileStatement:function(){if(this.comments(),u.PROFILE.parse(this)){if(this.profileNameId()){var e=this.getBrowser().getProfile(this.result[1]);return void this.getScene().setProfile(e)}throw new Error("Expected a profile name.")}},componentStatements:function(){for(var e=this.componentStatement();e;)this.getScene().addComponent(e),e=this.componentStatement()},componentStatement:function(){if(this.comments(),u.COMPONENT.parse(this)){if(this.componentNameId()){var e=this.result[1];if(this.comments(),u.Colon.parse(this)){if(this.componentSupportLevel()){var t=this.value;return this.getBrowser().getComponent(e,t)}throw new Error("Expected a component support level.")}throw new Error("Expected a ':' after component name.")}throw new Error("Expected a component name.")}return null},componentSupportLevel:function(){return this.int32()},unitStatements:function(){for(;this.unitStatement(););},unitStatement:function(){if(this.comments(),u.UNIT.parse(this)){if(this.categoryNameId()){var e=this.result[1];if(this.unitNameId()){var t=this.result[1];if(this.unitConversionFactor()){var i=this.value;try{return this.getScene().updateUnit(e,t,i),!0}catch(e){return console.log(e.message),!0}}throw new Error("Expected unit conversion factor.")}throw new Error("Expected unit name identifier.")}throw new Error("Expected category name identifier after UNIT statement.")}return!1},unitConversionFactor:function(){return this.double()},metaStatements:function(){for(;this.metaStatement(););},metaStatement:function(){if(this.comments(),u.META.parse(this)){if(this.metakey()){var e=this.value;if(this.metavalue()){var t=this.value;return this.getScene().setMetaData(e,t),!0}throw new Error("Expected metadata value.")}throw new Error("Expected metadata key.")}return!1},metakey:function(){return this.string()},metavalue:function(){return this.string()},exportStatement:function(){if(this.comments(),u.EXPORT.parse(this)){if(this.nodeNameId()){var e=this.result[1],t="";this.comments();var i=this.getScene().getLocalNode(e);if(u.AS.parse(this)){if(!this.exportedNodeNameId())throw new Error("No name given after AS.");t=this.result[1]}else t=e;return this.getScene().updateExportedNode(t,i),!0}throw new Error("No name given after EXPORT.")}return!1},importStatement:function(){if(this.comments(),u.IMPORT.parse(this)){if(this.nodeNameId()){var e=this.result[1],t=this.getExecutionContext().getNamedNode(e);if(this.comments(),u.Period.parse(this)){if(this.exportedNodeNameId()){var i=this.result[1],n=i;if(this.comments(),u.AS.parse(this)){if(!this.nodeNameId())throw new Error("No name given after AS.");n=this.result[1]}return this.getExecutionContext().updateImportedNode(t,i,n),!0}throw new Error("Expected exported node name.")}throw new Error("Expected a '.' after exported node name.")}throw new Error("No name given after IMPORT statement.")}return!1},statements:function(){for(;this.statement(););},statement:function(){if(this.protoStatement())return!0;if(this.routeStatement())return!0;if(this.importStatement())return!0;if(this.exportStatement())return!0;var e=this.nodeStatement();return e!==!1&&(this.addRootNode(e),!0)},nodeStatement:function(){if(this.comments(),u.DEF.parse(this)){if(this.nodeNameId())return this.node(this.result[1]);throw new Error("No name given after DEF.")}if(u.USE.parse(this)){if(this.nodeNameId())return this.getExecutionContext().getNamedNode(this.result[1]).getValue();throw new Error("No name given after USE.")}return u.NULL.parse(this)?null:this.node("")},protoStatement:function(){return!!this.proto()||!!this.externproto()},protoStatements:function(){for(;this.protoStatement(););},proto:function(){if(this.comments(),u.PROTO.parse(this)){if(this.nodeTypeId()){var e=this.result[1];if(this.comments(),u.OpenBracket.parse(this)){var t=this.interfaceDeclarations();if(this.comments(),u.CloseBracket.parse(this)){if(this.comments(),u.OpenBrace.parse(this)){for(var i=new n(this.getExecutionContext()),r=0,o=t.length;r<o;++r){var s=t[r];i.addUserDefinedField(s.getAccessType(),s.getName(),s)}if(this.pushPrototype(i),this.pushExecutionContext(i.getBody()),this.protoBody(),this.popExecutionContext(),this.popPrototype(),this.comments(),u.CloseBrace.parse(this)){i.setup();try{const t=this.getExecutionContext().getProtoDeclaration(e);this.getExecutionContext().updateProtoDeclaration(this.getExecutionContext().getUniqueProtoName(e),t)}catch(e){}return this.getExecutionContext().updateProtoDeclaration(e,i),!0}throw new Error("Expected a '}' at the end of PROTO body.")}throw new Error("Expected a '{' at the beginning of PROTO body.")}throw new Error("Expected a ']' at the end of PROTO interface declaration.")}throw new Error("Expected a '[' at the beginning of PROTO interface declaration.")}throw new Error("Invalid PROTO definition name.")}return!1},protoBody:function(){this.protoStatements();var e=this.rootNodeStatement();e!==!1&&this.addRootNode(e),this.statements()},rootNodeStatement:function(){if(this.comments(),u.DEF.parse(this)){if(this.nodeNameId()){var e=this.result[0],t=this.node(e);if(t!==!1)return t;throw new Error("Expected node type name after DEF.")}throw new Error("No name given after DEF.")}var t=this.node("");return t!==!1&&t},interfaceDeclarations:function(){for(var e=[],t=this.interfaceDeclaration();t;)e.push(t),t=this.interfaceDeclaration();return e},restrictedInterfaceDeclaration:function(){if(this.comments(),u.inputOnly.parse(this)||u.eventIn.parse(this)){if(this.fieldType()){var e=this.result[1];if(this.inputOnlyId()){var t=this.result[1],i=new this[e].constructor;return i.setAccessType(r.inputOnly),i.setName(t),i}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}if(u.outputOnly.parse(this)||u.eventOut.parse(this)){if(this.fieldType()){var e=this.result[1];if(this.outputOnlyId()){var t=this.result[1],i=new this[e].constructor;return i.setAccessType(r.outputOnly),i.setName(t),i}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}if(u.initializeOnly.parse(this)||u.field.parse(this)){if(this.fieldType()){var e=this.result[1];if(this.initializeOnlyId()){var t=this.result[1],i=new this[e].constructor;if(this.fieldValue(i))return i.setAccessType(r.initializeOnly),i.setName(t),i;throw new Error("Couldn't read value for field '"+t+"'.")}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}return null},interfaceDeclaration:function(){var e=this.restrictedInterfaceDeclaration();if(e)return e;if(this.comments(),u.inputOutput.parse(this)||u.exposedField.parse(this)){if(this.fieldType()){var t=this.result[1];if(this.inputOutputId()){var i=this.result[1],e=new this[t].constructor;if(this.fieldValue(e))return e.setAccessType(r.inputOutput),e.setName(i),e;throw new Error("Couldn't read value for field '"+i+"'.")}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}return null},externproto:function(){if(this.comments(),u.EXTERNPROTO.parse(this)){if(this.nodeTypeId()){var e=this.result[1];if(this.comments(),u.OpenBracket.parse(this)){var t=this.externInterfaceDeclarations();if(this.comments(),u.CloseBracket.parse(this)){if(this.URLList(this.MFString)){for(var n=new i(this.getExecutionContext(),this.MFString),r=0,o=t.length;r<o;++r){var s=t[r];n.addUserDefinedField(s.getAccessType(),s.getName(),s)}n.setup();try{const t=this.getExecutionContext().getExternProtoDeclaration(e);this.getExecutionContext().updateExternProtoDeclaration(this.getExecutionContext().getUniqueExternProtoName(e),t)}catch(e){}return this.getExecutionContext().updateExternProtoDeclaration(e,n),!0}throw new Error("Expected a URL list after EXTERNPROTO interface declaration '"+e+"'.")}throw new Error("Expected a ']' at the end of EXTERNPROTO interface declaration.")}throw new Error("Expected a '[' at the beginning of EXTERNPROTO interface declaration.")}throw new Error("Invalid EXTERNPROTO definition name.")}return!1},externInterfaceDeclarations:function(){for(var e=[],t=this.externInterfaceDeclaration();t;)e.push(t),t=this.externInterfaceDeclaration();return e},externInterfaceDeclaration:function(){if(this.comments(),u.inputOnly.parse(this)||u.eventIn.parse(this)){if(this.fieldType()){var e=this.result[1];if(this.inputOnlyId()){var t=this.result[1],i=new this[e].constructor;return i.setAccessType(r.inputOnly),i.setName(t),i}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}if(u.outputOnly.parse(this)||u.eventOut.parse(this)){if(this.fieldType()){var e=this.result[1];if(this.outputOnlyId()){var t=this.result[1],i=new this[e].constructor;return i.setAccessType(r.outputOnly),i.setName(t),i}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}if(u.initializeOnly.parse(this)||u.field.parse(this)){if(this.fieldType()){var e=this.result[1];if(this.initializeOnlyId()){var t=this.result[1],i=new this[e].constructor;return i.setAccessType(r.initializeOnly),i.setName(t),i}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}if(u.inputOutput.parse(this)||u.exposedField.parse(this)){if(this.fieldType()){var e=this.result[1];if(this.inputOutputId()){var t=this.result[1],i=new this[e].constructor;return i.setAccessType(r.inputOutput),i.setName(t),i}throw new Error("Expected a name for field.")}throw this.Id(),new Error("Unknown event or field type: '"+this.result[1]+"'.")}return null},URLList:function(e){return this.mfstringValue(e)},routeStatement:function(){if(this.comments(),u.ROUTE.parse(this)){if(this.nodeNameId()){var e=this.result[1],t=this.getExecutionContext().getLocalNode(e);if(this.comments(),u.Period.parse(this)){if(this.outputOnlyId()){var i=this.result[1];if(this.comments(),u.TO.parse(this)){if(this.nodeNameId()){var n=this.result[1],r=this.getExecutionContext().getLocalNode(n);if(this.comments(),u.Period.parse(this)){if(this.inputOnlyId())try{var o=this.result[1];return this.getExecutionContext().addRoute(t,i,r,o),!0}catch(e){return this.exception(e.message),!0}throw new Error("Bad ROUTE specification: Expected a field name.")}throw new Error("Bad ROUTE specification: Expected a '.' after node name.")}throw new Error("Bad ROUTE specification: Expected a node name.")}throw new Error("Bad ROUTE specification: Expected a 'TO'.")}throw new Error("Bad ROUTE specification: Expected a field name.")}throw new Error("Bad ROUTE specification: Expected a '.' after node name.")}throw new Error("Bad ROUTE specification: Expected a node name.")}return!1},node:function(e){if(this.nodeTypeId()){var t=this.result[1],i=this.getExecutionContext().createNode(t,!1);if(!i&&!(i=this.getExecutionContext().createProto(t,!1)))throw new Error("Unknown node type or proto '"+t+"', you probably have insufficient component/profile statements.");if(e.length){try{var n=this.getExecutionContext().getNamedNode(e);this.getExecutionContext().updateNamedNode(this.getExecutionContext().getUniqueName(e),n)}catch(e){}this.getExecutionContext().updateNamedNode(e,i)}if(this.comments(),u.OpenBrace.parse(this)){if(i.canUserDefinedFields()?this.scriptBody(i):this.nodeBody(i),this.comments(),u.CloseBrace.parse(this))return this.isInsideProtoDefinition()||i.setup(),i;throw new Error("Expected '}' at the end of node body.")}throw new Error("Expected '{' at the beginning of node body.")}return!1},scriptBody:function(e){for(;this.scriptBodyElement(e););},scriptBodyElement:function(e){var t=this.lastIndex,i=this.lineNumber;if(this.Id()){var n=this.accessTypes[this.result[1]];if(n&&this.fieldType()){var o=this.result[1];if(this.Id()){var s=this.result[1];if(this.comments(),u.IS.parse(this)){if(this.isInsideProtoDefinition()){if(this.Id()){var a=this.result[1];try{var l=this.getPrototype().getField(a)}catch(e){return this.exception("No such event or field '"+a+"' inside PROTO "+this.getPrototype().getName()+" interface declaration."),!0}var c=this[o];if(c.getType()===l.getType()){if(l.isReference(n)){try{var h=e.getField(s);n===h.getAccessType()&&l.getType()===h.getType()||(h=this.createUserDefinedField(e,n,s,c))}catch(t){var h=this.createUserDefinedField(e,n,s,c)}return h.addReference(l),!0}throw new Error("Field '"+s+"' and '"+l.getName()+"' in PROTO '"+this.getPrototype().getName()+"' are incompatible as an IS mapping.")}throw new Error("Field '"+s+"' and '"+l.getName()+"' in PROTO '"+this.getPrototype().getName()+"' have different types.")}throw new Error("No name give after IS statement.")}throw new Error("IS statement outside PROTO definition.")}}}}this.lastIndex=t,this.lineNumber=i;var h=this.interfaceDeclaration();if(h){try{if(h.getAccessType()===r.inputOutput){var d=e.getField(h.getName());if(d.getAccessType()===r.inputOutput&&h.getType()===d.getType())return d.setValue(h),!0}}catch(e){}return e.addUserDefinedField(h.getAccessType(),h.getName(),h),!0}return this.nodeBodyElement(e)},createUserDefinedField:function(e,t,i,n){var r=new n.constructor;return e.addUserDefinedField(t,i,r),r},nodeBody:function(e){for(;this.nodeBodyElement(e););},nodeBodyElement:function(e){if(this.protoStatement())return!0;if(this.routeStatement())return!0;if(this.Id()){var t=this.result[1];try{var i=e.getField(t)}catch(i){throw new Error("Unknown field '"+t+"' in class '"+e.getTypeName()+"'.")}if(this.comments(),u.IS.parse(this)){if(this.isInsideProtoDefinition()){if(this.Id()){var n=this.result[1];try{var r=this.getPrototype().getField(n)}catch(e){return this.exception("No such event or field '"+n+"' inside PROTO "+this.getPrototype().getName()),!0}if(i.getType()===r.getType()){if(r.isReference(i.getAccessType()))return i.addReference(r),!0;throw new Error("Field '"+i.getName()+"' and '"+r.getName()+"' in PROTO "+this.getPrototype().getName()+" are incompatible as an IS mapping.")}throw new Error("Field '"+i.getName()+"' and '"+r.getName()+"' in PROTO "+this.getPrototype().getName()+" have different types.")}throw new Error("No name give after IS statement.")}throw new Error("IS statement outside PROTO definition.")}if(i.isInitializable()){if(this.fieldValue(i))return!0;throw new Error("Couldn't read value for field '"+t+"'.")}throw new Error("Couldn't assign value to "+o(i.getAccessType())+" field '"+t+"'.")}return!1},profileNameId:function(){return this.Id()},componentNameId:function(){return this.comments(),u.ComponentNameId.parse(this)},categoryNameId:function(){return this.Id()},unitNameId:function(){return this.Id()},exportedNodeNameId:function(){return this.Id()},nodeNameId:function(){return this.Id()},nodeTypeId:function(){return this.Id()},initializeOnlyId:function(){return this.Id()},inputOnlyId:function(){return this.Id()},outputOnlyId:function(){return this.Id()},inputOutputId:function(){return this.Id()},Id:function(){return this.comments(),u.Id.parse(this)},fieldType:function(){return this.comments(),u.FieldType.parse(this)},fieldValue:function(e){return this.fieldTypes[e.getType()].call(this,e)},double:function(){return this.comments(),u.double.parse(this)?(this.value=parseFloat(this.result[1]),!0):u.Inf.parse(this)?(this.value=Number.POSITIVE_INFINITY,!0):u.NegativeInf.parse(this)?(this.value=Number.NEGATIVE_INFINITY,!0):!!u.NaN.parse(this)&&(this.value=Number.NaN,!0)},int32:function(){return this.comments(),!!u.int32.parse(this)&&(this.value=parseInt(this.result[1]),!0)},string:function(){return this.comments(),!!u.string.parse(this)&&(this.value=e.SFString.unescape(this.result[1]),this.lines(this.value),!0)},sfboolValue:function(e){return this.comments(),u.TRUE.parse(this)?(e.setValue(!0),!0):!!u.FALSE.parse(this)&&(e.setValue(!1),!0)},mfboolValue:function(e){if(e.length=0,this.sfboolValue(this.SFBool))return e.push(this.SFBool),!0;if(u.OpenBracket.parse(this)){if(this.sfboolValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfboolValues:function(e){for(e.length=0,e=e.getTarget();this.sfboolValue(this.SFBool);)e.push(this.SFBool)},sfcolorValue:function(e){if(this.double()){var t=this.value;if(this.double()){var i=this.value;if(this.double()){var n=this.value;return e.r=t,e.g=i,e.b=n,!0}}}return!1},mfcolorValue:function(e){if(e.length=0,this.sfcolorValue(this.SFColor))return e.push(this.SFColor),!0;if(u.OpenBracket.parse(this)){if(this.sfcolorValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfcolorValues:function(e){for(e.length=0,e=e.getTarget();this.sfcolorValue(this.SFColor);)e.push(this.SFColor)},sfcolorrgbaValue:function(e){if(this.double()){var t=this.value;if(this.double()){var i=this.value;if(this.double()){var n=this.value;if(this.double()){var r=this.value;return e.r=t,e.g=i,e.b=n,e.a=r,!0}}}}return!1},mfcolorrgbaValue:function(e){if(e.length=0,this.sfcolorrgbaValue(this.SFColorRGBA))return e.push(this.SFColorRGBA),!0;if(u.OpenBracket.parse(this)){if(this.sfcolorrgbaValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfcolorrgbaValues:function(e){for(e.length=0,e=e.getTarget();this.sfcolorrgbaValue(this.SFColorRGBA);)e.push(this.SFColorRGBA)},sfdoubleValue:function(e){return!!this.double()&&(e.setValue(this.fromUnit(e.getUnit(),this.value)),!0)},mfdoubleValue:function(e){if(e.length=0,this.SFDouble.setUnit(e.getUnit()),this.sfdoubleValue(this.SFDouble))return e.push(this.SFDouble),!0;if(u.OpenBracket.parse(this)){if(this.sfdoubleValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfdoubleValues:function(e){for(e.length=0,e=e.getTarget(),this.SFDouble.setUnit(e.getUnit());this.sfdoubleValue(this.SFDouble);)e.push(this.SFDouble)},sffloatValue:function(e){return this.sfdoubleValue(e)},mffloatValue:function(e){if(e.length=0,this.SFFloat.setUnit(e.getUnit()),this.sffloatValue(this.SFFloat))return e.push(this.SFFloat),!0;if(u.OpenBracket.parse(this)){if(this.sffloatValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sffloatValues:function(e){for(e.length=0,e=e.getTarget(),this.SFFloat.setUnit(e.getUnit());this.sffloatValue(this.SFFloat);)e.push(this.SFFloat)},
sfimageValue:function(e){if(this.int32()){var t=this.value;if(this.int32()){var i=this.value;if(this.int32()){var n=this.value,r=t*i;e.width=t,e.height=i,e.comp=n;for(var o=e.array,s=0;s<r;++s){if(!this.int32())return!1;o[s]=this.value}return!0}}}return!1},mfimageValue:function(e){if(e.length=0,this.sfimageValue(this.SFImage))return e.push(this.SFImage),!0;if(u.OpenBracket.parse(this)){if(this.sfimageValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfimageValues:function(e){for(e.length=0,e=e.getTarget();this.sfimageValue(this.SFImage);)e.push(this.SFImage)},sfint32Value:function(e){return!!this.int32()&&(e.setValue(this.value),!0)},mfint32Value:function(e){if(e.length=0,this.sfint32Value(this.SFInt32))return e.push(this.SFInt32),!0;if(u.OpenBracket.parse(this)){if(this.sfint32Values(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfint32Values:function(e){for(e.length=0,e=e.getTarget();this.sfint32Value(this.SFInt32);)e.push(this.SFInt32)},sfmatrix3dValue:function(e){if(this.double()){var t=this.value;if(this.double()){var i=this.value;if(this.double()){var n=this.value;if(this.double()){var r=this.value;if(this.double()){var o=this.value;if(this.double()){var s=this.value;if(this.double()){var a=this.value;if(this.double()){var u=this.value;if(this.double()){var l=this.value;return e[0]=t,e[1]=i,e[2]=n,e[3]=r,e[4]=o,e[5]=s,e[6]=a,e[7]=u,e[8]=l,!0}}}}}}}}}return!1},mfmatrix3dValue:function(e){if(e.length=0,this.sfmatrix3dValue(this.SFMatrix3d))return e.push(this.SFMatrix3d),!0;if(u.OpenBracket.parse(this)){if(this.sfmatrix3dValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfmatrix3dValues:function(e){for(e.length=0,e=e.getTarget();this.sfmatrix3dValue(this.SFMatrix3d);)e.push(this.SFMatrix3d)},sfmatrix3fValue:function(e){return this.sfmatrix3dValue(e)},mfmatrix3fValue:function(e){if(e.length=0,this.sfmatrix3fValue(this.SFMatrix3f))return e.push(this.SFMatrix3f),!0;if(u.OpenBracket.parse(this)){if(this.sfmatrix3fValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfmatrix3fValues:function(e){for(e.length=0,e=e.getTarget();this.sfmatrix3fValue(this.SFMatrix3f);)e.push(this.SFMatrix3f)},sfmatrix4dValue:function(e){if(this.double()){var t=this.value;if(this.double()){var i=this.value;if(this.double()){var n=this.value;if(this.double()){var r=this.value;if(this.double()){var o=this.value;if(this.double()){var s=this.value;if(this.double()){var a=this.value;if(this.double()){var u=this.value;if(this.double()){var l=this.value;if(this.double()){var c=this.value;if(this.double()){var h=this.value;if(this.double()){var d=this.value;if(this.double()){var p=this.value;if(this.double()){var f=this.value;if(this.double()){var g=this.value;if(this.double()){var m=this.value;return e[0]=t,e[1]=i,e[2]=n,e[3]=r,e[4]=o,e[5]=s,e[6]=a,e[7]=u,e[8]=l,e[9]=c,e[10]=h,e[11]=d,e[12]=p,e[13]=f,e[14]=g,e[15]=m,!0}}}}}}}}}}}}}}}}return!1},mfmatrix4dValue:function(e){if(e.length=0,this.sfmatrix4dValue(this.SFMatrix4d))return e.push(this.SFMatrix4d),!0;if(u.OpenBracket.parse(this)){if(this.sfmatrix4dValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfmatrix4dValues:function(e){for(e.length=0,e=e.getTarget();this.sfmatrix4dValue(this.SFMatrix4d);)e.push(this.SFMatrix4d)},sfmatrix4fValue:function(e){return this.sfmatrix4dValue(e)},mfmatrix4fValue:function(e){if(e.length=0,this.sfmatrix4fValue(this.SFMatrix4f))return e.push(this.SFMatrix4f),!0;if(u.OpenBracket.parse(this)){if(this.sfmatrix4fValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfmatrix4fValues:function(e){for(e.length=0,e=e.getTarget();this.sfmatrix4fValue(this.SFMatrix4f);)e.push(this.SFMatrix4f)},sfnodeValue:function(e){var t=this.nodeStatement();return t!==!1&&(e.setValue(t),!0)},mfnodeValue:function(e){e.length=0;var t=this.nodeStatement();if(t!==!1)return e.push(t),!0;if(u.OpenBracket.parse(this)){if(this.nodeStatements(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},nodeStatements:function(e){for(var t=this.nodeStatement();t!==!1;)e.push(t),t=this.nodeStatement()},sfrotationValue:function(e){if(this.double()){var t=this.value;if(this.double()){var i=this.value;if(this.double()){var n=this.value;if(this.double()){var r=this.value;return e.x=t,e.y=i,e.z=n,e.angle=this.fromUnit("angle",r),!0}}}}return!1},mfrotationValue:function(e){if(e.length=0,this.sfrotationValue(this.SFRotation))return e.push(this.SFRotation),!0;if(u.OpenBracket.parse(this)){if(this.sfrotationValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfrotationValues:function(e){for(e.length=0,e=e.getTarget();this.sfrotationValue(this.SFRotation);)e.push(this.SFRotation)},sfstringValue:function(e){return!!this.string()&&(e.setValue(this.value),!0)},mfstringValue:function(e){if(e.length=0,this.sfstringValue(this.SFString))return e.push(this.SFString),!0;if(u.OpenBracket.parse(this)){if(this.sfstringValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfstringValues:function(e){for(e.length=0,e=e.getTarget();this.sfstringValue(this.SFString);)e.push(this.SFString)},sftimeValue:function(e){return this.sfdoubleValue(e)},mftimeValue:function(e){if(e.length=0,this.sftimeValue(this.SFTime))return e.push(this.SFTime),!0;if(u.OpenBracket.parse(this)){if(this.sftimeValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sftimeValues:function(e){for(e.length=0,e=e.getTarget();this.sftimeValue(this.SFTime);)e.push(this.SFTime)},sfvec2dValue:function(e){if(this.double()){var t=this.value;if(this.double()){var i=this.value,n=e.getUnit();return e.x=this.fromUnit(n,t),e.y=this.fromUnit(n,i),!0}}return!1},mfvec2dValue:function(e){if(e.length=0,this.SFVec2d.setUnit(e.getUnit()),this.sfvec2dValue(this.SFVec2d))return e.push(this.SFVec2d),!0;if(u.OpenBracket.parse(this)){if(this.sfvec2dValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfvec2dValues:function(e){for(e.length=0,e=e.getTarget(),this.SFVec2d.setUnit(e.getUnit());this.sfvec2dValue(this.SFVec2d);)e.push(this.SFVec2d)},sfvec2fValue:function(e){return this.sfvec2dValue(e)},mfvec2fValue:function(e){if(e.length=0,this.SFVec2f.setUnit(e.getUnit()),this.sfvec2fValue(this.SFVec2f))return e.push(this.SFVec2f),!0;if(u.OpenBracket.parse(this)){if(this.sfvec2fValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfvec2fValues:function(e){for(e.length=0,e=e.getTarget(),this.SFVec2f.setUnit(e.getUnit());this.sfvec2fValue(this.SFVec2f);)e.push(this.SFVec2f)},sfvec3dValue:function(e){if(this.double()){var t=this.value;if(this.double()){var i=this.value;if(this.double()){var n=this.value,r=e.getUnit();return e.x=this.fromUnit(r,t),e.y=this.fromUnit(r,i),e.z=this.fromUnit(r,n),!0}}}return!1},mfvec3dValue:function(e){if(e.length=0,this.SFVec3d.setUnit(e.getUnit()),this.sfvec3dValue(this.SFVec3d))return e.push(this.SFVec3d),!0;if(u.OpenBracket.parse(this)){if(this.sfvec3dValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfvec3dValues:function(e){for(e.length=0,e=e.getTarget(),this.SFVec3d.setUnit(e.getUnit());this.sfvec3dValue(this.SFVec3d);)e.push(this.SFVec3d)},sfvec3fValue:function(e){return this.sfvec3dValue(e)},mfvec3fValue:function(e){if(e.length=0,this.SFVec3f.setUnit(e.getUnit()),this.sfvec3fValue(this.SFVec3f))return e.push(this.SFVec3f),!0;if(u.OpenBracket.parse(this)){if(this.sfvec3fValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfvec3fValues:function(e){for(e.length=0,e=e.getTarget(),this.SFVec3f.setUnit(e.getUnit());this.sfvec3fValue(this.SFVec3f);)e.push(this.SFVec3f)},sfvec4dValue:function(e){if(this.double()){var t=this.value;if(this.double()){var i=this.value;if(this.double()){var n=this.value;if(this.double()){var r=this.value,o=e.getUnit();return e.x=this.fromUnit(o,t),e.y=this.fromUnit(o,i),e.z=this.fromUnit(o,n),e.w=this.fromUnit(o,r),!0}}}}return!1},mfvec4dValue:function(e){if(e.length=0,this.SFVec4d.setUnit(e.getUnit()),this.sfvec4dValue(this.SFVec4d))return e.push(this.SFVec4d),!0;if(u.OpenBracket.parse(this)){if(this.sfvec4dValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfvec4dValues:function(e){for(e.length=0,e=e.getTarget(),this.SFVec4d.setUnit(e.getUnit());this.sfvec4dValue(this.SFVec4d);)e.push(this.SFVec4d)},sfvec4fValue:function(e){return this.sfvec4dValue(e)},mfvec4fValue:function(e){if(e.length=0,this.SFVec4f.setUnit(e.getUnit()),this.sfvec4fValue(this.SFVec4f))return e.push(this.SFVec4f),!0;if(u.OpenBracket.parse(this)){if(this.sfvec4fValues(e),this.comments(),u.CloseBracket.parse(this))return!0;throw new Error("Expected ']'.")}return!1},sfvec4fValues:function(e){for(e.length=0,e=e.getTarget(),this.SFVec4f.setUnit(e.getUnit());this.sfvec4fValue(this.SFVec4f);)e.push(this.SFVec4f)}}),a.prototype.fieldTypes=[],a.prototype.fieldTypes[r.SFBool]=a.prototype.sfboolValue,a.prototype.fieldTypes[r.SFColor]=a.prototype.sfcolorValue,a.prototype.fieldTypes[r.SFColorRGBA]=a.prototype.sfcolorrgbaValue,a.prototype.fieldTypes[r.SFDouble]=a.prototype.sfdoubleValue,a.prototype.fieldTypes[r.SFFloat]=a.prototype.sffloatValue,a.prototype.fieldTypes[r.SFImage]=a.prototype.sfimageValue,a.prototype.fieldTypes[r.SFInt32]=a.prototype.sfint32Value,a.prototype.fieldTypes[r.SFMatrix3f]=a.prototype.sfmatrix3dValue,a.prototype.fieldTypes[r.SFMatrix3d]=a.prototype.sfmatrix3fValue,a.prototype.fieldTypes[r.SFMatrix4f]=a.prototype.sfmatrix4dValue,a.prototype.fieldTypes[r.SFMatrix4d]=a.prototype.sfmatrix4fValue,a.prototype.fieldTypes[r.SFNode]=a.prototype.sfnodeValue,a.prototype.fieldTypes[r.SFRotation]=a.prototype.sfrotationValue,a.prototype.fieldTypes[r.SFString]=a.prototype.sfstringValue,a.prototype.fieldTypes[r.SFTime]=a.prototype.sftimeValue,a.prototype.fieldTypes[r.SFVec2d]=a.prototype.sfvec2dValue,a.prototype.fieldTypes[r.SFVec2f]=a.prototype.sfvec2fValue,a.prototype.fieldTypes[r.SFVec3d]=a.prototype.sfvec3dValue,a.prototype.fieldTypes[r.SFVec3f]=a.prototype.sfvec3fValue,a.prototype.fieldTypes[r.SFVec4d]=a.prototype.sfvec4dValue,a.prototype.fieldTypes[r.SFVec4f]=a.prototype.sfvec4fValue,a.prototype.fieldTypes[r.MFBool]=a.prototype.mfboolValue,a.prototype.fieldTypes[r.MFColor]=a.prototype.mfcolorValue,a.prototype.fieldTypes[r.MFColorRGBA]=a.prototype.mfcolorrgbaValue,a.prototype.fieldTypes[r.MFDouble]=a.prototype.mfdoubleValue,a.prototype.fieldTypes[r.MFFloat]=a.prototype.mffloatValue,a.prototype.fieldTypes[r.MFImage]=a.prototype.mfimageValue,a.prototype.fieldTypes[r.MFInt32]=a.prototype.mfint32Value,a.prototype.fieldTypes[r.MFMatrix3d]=a.prototype.mfmatrix3dValue,a.prototype.fieldTypes[r.MFMatrix3f]=a.prototype.mfmatrix3fValue,a.prototype.fieldTypes[r.MFMatrix4d]=a.prototype.mfmatrix4dValue,a.prototype.fieldTypes[r.MFMatrix4f]=a.prototype.mfmatrix4fValue,a.prototype.fieldTypes[r.MFNode]=a.prototype.mfnodeValue,a.prototype.fieldTypes[r.MFRotation]=a.prototype.mfrotationValue,a.prototype.fieldTypes[r.MFString]=a.prototype.mfstringValue,a.prototype.fieldTypes[r.MFTime]=a.prototype.mftimeValue,a.prototype.fieldTypes[r.MFVec2d]=a.prototype.mfvec2dValue,a.prototype.fieldTypes[r.MFVec2f]=a.prototype.mfvec2fValue,a.prototype.fieldTypes[r.MFVec3d]=a.prototype.mfvec3dValue,a.prototype.fieldTypes[r.MFVec3f]=a.prototype.mfvec3fValue,a.prototype.fieldTypes[r.MFVec4d]=a.prototype.mfvec4dValue,a.prototype.fieldTypes[r.MFVec4f]=a.prototype.mfvec4fValue,a}),define("standard/Utility/DataStorage",[],function(){"use strict";function e(e,o){return this.target=this,t.set(this,e),i.set(this,o),n.set(this,{}),new Proxy(this,r)}const t=new WeakMap,i=new WeakMap,n=new WeakMap,r={get:function(e,t){var i=e[t];if(void 0!==i)return i;var i=e.getStorage()[e.getNameSpace()+t];return void 0===i||"undefined"===i||null===i?e.getDefaultValue(t):JSON.parse(i)},set:function(e,t,i){return void 0===i?e.getStorage().removeItem(e.getNameSpace()+t):e.getStorage()[e.getNameSpace()+t]=JSON.stringify(i),!0}};return e.prototype={constructor:e,getStorage:function(){return t.get(this.target)},getNameSpace:function(){return i.get(this.target)},addNameSpace:function(t){return new e(this.getStorage(),this.getNameSpace()+t)},addDefaultValues:function(e){Object.assign(n.get(this.target),e)},getDefaultValue(e){const t=n.get(this.target)[e];return void 0===t?void 0:JSON.parse(JSON.stringify(t))},clear:function(){const e=this.getStorage(),t=this.getNameSpace();for(const i of Object.keys(e))i.startsWith(t)&&e.removeItem(i)}},e}),define("x_ite/Browser/Core/X3DCoreContext",["jquery","x_ite/Fields","x_ite/Browser/Core/BrowserTimings","x_ite/Browser/Core/BrowserOptions","x_ite/Browser/Core/BrowserProperties","x_ite/Browser/Core/RenderingProperties","x_ite/Browser/Core/Notification","x_ite/Browser/Core/ContextMenu","x_ite/Execution/Scene","x_ite/Parser/Parser","standard/Utility/DataStorage","standard/Math/Numbers/Vector3","locale/gettext"],function(e,t,i,n,r,o,s,a,u,l,c,h,d){"use strict";function p(e,t,i){const n={preserveDrawingBuffer:i};let r=null;if(t>=2&&!r&&(r=e.getContext("webgl2",n))&&(r.getVersion=function(){return 2}),t>=1&&!r&&(r=e.getContext("webgl",n)||e.getContext("experimental-webgl",n))&&(r.getVersion=function(){return 1}),!r)throw new Error("Couldn't create WebGL context.");const o=r.getParameter(r.ALIASED_LINE_WIDTH_RANGE);return 1===o[0]&&1===o[1]&&(r.lineWidth=Function.prototype),r}function f(u){this[y]=++P,this[_]=u;const l=e("<div></div>").addClass("x_ite-private-browser x_ite-private-browser-"+this.getNumber()).prependTo(this[_]),h=e("<div></div>").addClass("x_ite-private-splash-screen").appendTo(l),d=(e("<div></div>").addClass("x_ite-private-spinner").appendTo(h),e("<div></div>").addClass("x_ite-private-progress").appendTo(h)),f=e("<div></div>").addClass("x_ite-private-surface").appendTo(l);e("<div></div>").addClass("x_ite-private-x_ite").html("X_ITE<span class='x_ite-private-x3d'>X3D</span>").appendTo(d),e("<div></div>").addClass("x_ite-private-progressbar").appendTo(d).append(e("<div></div>")),e("<div></div>").addClass("x_ite-private-spinner-text").appendTo(d),this[x]=h,this[w]=f,this[b]=e("<canvas></canvas>").addClass("x_ite-private-canvas").prependTo(f),this[v]=p(this[b][0],g,"true"===u.attr("preserveDrawingBuffer")),this[S]=new Map;const V=this.getContext();for(const e of m)this[S].set(e,V.getExtension(e));this[T]=new c(localStorage,"X_ITE.X3DBrowser("+this[y]+")."),this[C]=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),this[F]=new i(this.getPrivateScene()),this[O]=new n(this.getPrivateScene()),this[N]=new r(this.getPrivateScene()),this[E]=new o(this.getPrivateScene()),this[D]=new s(this.getPrivateScene()),this[M]=new a(this.getPrivateScene()),e(".x_ite-console").empty(),this.addChildObjects("controlKey",new t.SFBool,"shiftKey",new t.SFBool,"altKey",new t.SFBool,"altGrKey",new t.SFBool)}const g=2,m=["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_frag_depth","EXT_shader_texture_lod","EXT_texture_filter_anisotropic","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_compressed_texture_s3tc","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_depth_texture","WEBGL_draw_buffers","WEBGL_lose_context","EXT_color_buffer_float","EXT_color_buffer_half_float","EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2","EXT_sRGB","WEBGL_color_buffer_float","WEBGL_compressed_texture_astc","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","EXT_float_blend","OES_fbo_render_mipmap","WEBGL_get_buffer_sub_data_async","WEBGL_multiview","WEBGL_security_sensitive_resources","WEBGL_shared_resources","EXT_clip_cull_distance","WEBGL_debug","WEBGL_dynamic_texture","WEBGL_subarray_uploads","WEBGL_texture_multisample","WEBGL_texture_source_iframe","WEBGL_video_texture","EXT_texture_storage","OES_depth24","WEBGL_debug_shader_precision","WEBGL_draw_elements_no_range_check","WEBGL_subscribe_uniform","WEBGL_texture_from_depth_video"],y=Symbol(),_=Symbol(),x=Symbol(),w=Symbol(),b=Symbol(),v=Symbol(),S=Symbol(),T=Symbol(),C=Symbol(),F=Symbol(),O=Symbol(),N=Symbol(),E=Symbol(),D=Symbol(),M=Symbol(),V=Symbol(),I=Symbol(),B=Symbol(),A=Symbol();let P=0;return f.prototype={initialize:function(){this[F].setup(),this[O].setup(),this[N].setup(),this[E].setup(),this[D].setup(),this[M].setup(),this[V]=new MutationObserver(this.processMutations.bind(this)),this[V].observe(this[_][0],{attributes:!0,childList:!1,characterData:!1,subtree:!1}),Object.defineProperty(this.getElement().get(0),"src",{get:function(){return this.getExecutionContext().getWorldURL()}.bind(this),set:function(e){this.loadURL(new t.MFString(e),new t.MFString)}.bind(this),enumerable:!0,configurable:!1}),Object.defineProperty(this.getElement().get(0),"url",{get:function(){const e=this.getExecutionContext().getWorldURL();return e?new t.MFString(e):new t.MFString}.bind(this),set:function(e){this.loadURL(e,new t.MFString)}.bind(this),enumerable:!0,configurable:!1}),this.setBrowserEventHandler("onload"),this.setBrowserEventHandler("onshutdown"),this.setBrowserEventHandler("onerror"),this.getElement().bind("keydown.X3DCoreContext",this[B].bind(this)),this.getElement().bind("keyup.X3DCoreContext",this[A].bind(this))},getDebug:function(){return this.getBrowserOptions().getDebug()},getNumber:function(){return this[y]},isStrict:function(){return!1},getElement:function(){return this[_]},getSurface:function(){return this[w]},getSplashScreen:function(){return this[x]},getCanvas:function(){return this[b]},getContext:function(){return this[v]},getExtension:function(e){return this[S].get(e)},getMobile:function(){return this[C]},getLocalStorage:function(){return this[T]},getBrowserTimings:function(){return this[F]},getBrowserOptions:function(){return this[O]},getBrowserProperties:function(){return this[N]},getRenderingProperties:function(){return this[E]},getNotification:function(){return this[D]},getContextMenu:function(){return this[M]},getPrivateScene:function(){return this[I]?this[I]:(this[I]=new u(this),this[I].setPrivate(!0),this[I].setLive(!0),this[I].setup(),this[I])},processMutations:function(e){e.forEach(function(e){this.processMutation(e)},this)},processMutation:function(e){const t=e.target;switch(e.type){case"attributes":this.processAttribute(e,t)}},processAttribute:function(e,t){switch(e.attributeName.toLowerCase()){case"onerror":this.setBrowserEventHandler("onerror");break;case"onload":this.setBrowserEventHandler("onload");break;case"onshutdown":this.setBrowserEventHandler("onshutdown");break;case"splashscreen":this.getBrowserOptions().setAttributeSplashScreen();break;case"src":{const e=this.getElement().attr("src");this.load('"'+e+'"');break}case"url":this.load(this.getElement().attr("url"))}},load:function(e){if(e){const i=new l(this.getExecutionContext()),n=new t.MFString,r=new t.MFString;i.setInput(e),i.sfstringValues(n),n.length&&this.loadURL(n,r)}else this.getLoading()||this.getCanvas().fadeIn(0)},setBrowserEventHandler:function(e){const t=this.getElement().get(0),i=this.getElement().attr(e);t[e]=i?new Function(i):Function.prototype},callBrowserEventHandler:function(e){const t=this.getElement().get(0),i=t[e];window.jQuery?window.jQuery(t).trigger(e.substr(2)):i&&i.call(t)},getShiftKey:function(){return this.shiftKey_.getValue()},getControlKey:function(){return this.controlKey_.getValue()},getAltKey:function(){return this.altKey_.getValue()},getAltGrKey:function(){return this.altGrKey_.getValue()},[B]:function(e){switch(e.keyCode){case 16:this.shiftKey_=!0;break;case 17:this.controlKey_=!0;break;case 18:this.altKey_=!0;break;case 37:case 38:case 39:case 40:this.requestAnimationFrame();break;case 49:this.getDebug()&&this.getControlKey()&&(e.preventDefault(),this.setBrowserOption("Shading","POINT"),this.getNotification().string_="Shading: Pointset");break;case 50:this.getDebug()&&this.getControlKey()&&(e.preventDefault(),this.setBrowserOption("Shading","WIREFRAME"),this.getNotification().string_="Shading: Wireframe");break;case 51:this.getDebug()&&this.getControlKey()&&(e.preventDefault(),this.setBrowserOption("Shading","FLAT"),this.getNotification().string_="Shading: Flat");break;case 52:this.getDebug()&&this.getControlKey()&&(e.preventDefault(),this.setBrowserOption("Shading","GOURAUD"),this.getNotification().string_="Shading: Gouraud");break;case 53:this.getDebug()&&this.getControlKey()&&(e.preventDefault(),this.setBrowserOption("Shading","PHONG"),this.getNotification().string_="Shading: Phong");break;case 83:this.getDebug()&&this.getControlKey()&&(e.preventDefault(),this.isLive().getValue()?this.endUpdate():this.beginUpdate(),this.getNotification().string_=this.isLive().getValue()?"Begin Update":"End Update");break;case 225:this.altGrKey_=!0;break;case 171:case 187:this.getControlKey()&&(e.preventDefault(),this.setBrowserOption("Timings",!this.getBrowserOption("Timings")));break;case 36:e.preventDefault(),this.firstViewpoint();break;case 35:e.preventDefault(),this.lastViewpoint();break;case 33:e.preventDefault(),this.previousViewpoint();break;case 34:e.preventDefault(),this.nextViewpoint();break;case 119:if(this.getShiftKey()){e.preventDefault();const i=this.getActiveViewpoint();if(!i)break;const n=this.getPrivateScene().createNode(i.getTypeName());switch(i.getTypeName()){case"Viewpoint":n.position=i.getUserPosition(),n.orientation=i.getUserOrientation(),n.centerOfRotation=i.getUserCenterOfRotation(),n.fieldOfView=i.getFieldOfView();break;case"OrthoViewpoint":n.position=i.getUserPosition(),n.orientation=i.getUserOrientation(),n.centerOfRotation=i.getUserCenterOfRotation(),n.fieldOfView=new t.MFFloat(i.getMinimumX(),i.getMinimumY(),i.getMaximumX(),i.getMaximumY());break;case"GeoViewpoint":{const e=i.geoOrigin_,t=new h(0,0,0);if(e.getValue()&&"GeoOrigin"===e.getNodeTypeName()){const t=this.getPrivateScene().createNode("GeoOrigin");n.geoOrigin=t,t.geoSystem=e.geoSystem,t.geoCoords=e.geoCoords,t.rotateYUp=e.rotateYUp}n.geoSystem=i.geoSystem_,n.position=i.getGeoCoord(i.getUserPosition(),t),n.orientation=i.getUserOrientation(),n.centerOfRotation=i.getGeoCoord(i.getUserCenterOfRotation(),t),n.fieldOfView=i.getFieldOfView();break}}let r;switch(this.getExecutionContext().getEncoding()){case"ASCII":case"VRML":r=n.toVRMLString();break;case"JSON":r=n.toVRMLString();break;default:r=n.toXMLString()}r+="\n",console.log(r),this.copyToClipboard(r),this.getNotification().string_=d("Viewpoint is copied to clipboard.")}}},[A]:function(e){switch(e.which){case 16:this.shiftKey_=!1;break;case 17:this.controlKey_=!1;break;case 18:this.altKey_=!1;break;case 37:case 38:case 39:case 40:this.requestAnimationFrame();break;case 225:this.altGrKey_=!1}},copyToClipboard:function(t){const i=e("<textarea></textarea>");this.getElement().find(".x_ite-private-browser").prepend(i),i.text(t).select(),document.execCommand("copy"),i.remove()}},f}),define("x_ite/Routing/X3DRoutingContext",[],function(){"use strict";function e(){this[t]=[],this[i]=[],this[n]=[],this[r]=[]}const t=Symbol(),i=Symbol(),n=Symbol(),r=Symbol();return e.prototype={constructor:e,initialize:function(){},addTaintedField:function(e,i){this[t].push(e,i)},addTaintedNode:function(e){this[n].push(e)},processEvents:function(){do{do{const e=this[t];this[t]=this[i],this[t].length=0;for(let t=0,i=e.length;t<i;t+=2)e[t].processEvent(e[t+1]);this[i]=e}while(this[t].length)do{const e=this[n];this[n]=this[r],this[n].length=0;for(const t of e)t.processEvents();this[r]=e}while(!this[t].length&&this[n].length)}while(this[t].length)}},e}),define("x_ite/Browser/Scripting/X3DScriptingContext",[],function(){"use strict";function e(){this[t]=[this]}const t=Symbol();return e.prototype={initialize:function(){},isExternal:function(){return 1===this[t].length},getScriptStack:function(){return this[t]}},e}),define("x_ite/Browser/Networking/urls",[],function(){"use strict";function e(){}return e.prototype={getProviderUrl:function(e){return e?(getScriptURL().match(/\.min\.js$/)&&(e+=".min"),new URL("assets/components/"+e+".js",getScriptURL()).href):"https://create3000.github.io/x_ite/"},getShaderUrl:function(e){return new URL("assets/shaders/"+e,getScriptURL()).href},getFontsUrl:function(e){return new URL("assets/fonts/"+e,getScriptURL()).href},getLinetypeUrl:function(e){return new URL("assets/linetype/"+e+".png",getScriptURL()).href},getHatchingUrl:function(e){return new URL("assets/hatching/"+e+".png",getScriptURL()).href}},new e}),define("x_ite/Browser/Networking/X3DNetworkingContext",["x_ite/Fields","x_ite/Browser/Networking/urls","locale/gettext"],function(e,t,i){"use strict";function n(e){let t=e.baseURI;return t.startsWith("about:")&&(t=document.baseURI),t}function r(){this.addChildObjects("loadCount",new e.SFInt32),this[o]=0,this[s]=new Set,this[a]=!1,this[u]=n(this.getElement()[0]),this.getCanvas().fadeOut(0),this.getBrowserOptions().getSplashScreen()&&this.getSplashScreen().fadeIn(0)}const o=Symbol(),s=Symbol(),a=Symbol(),u=Symbol(),l=Symbol();return r.prototype={initialize:function(){},getProviderUrl:function(){return t.getProviderUrl()},getLocation:function(){return this[u]},getDefaultScene:function(){return this[l]=this.createScene(),this[l].setPrivate(!0),this[l].setLive(!0),this[l].setup(),this.getDefaultScene=function(){return this[l]},Object.defineProperty(this,"getDefaultScene",{enumerable:!1}),this[l]},setBrowserLoading:function(e){this[a]=e,e?(this.resetLoadCount(),this.getElement().find(".x_ite-private-world-info").remove(),this.getBrowserOptions().getSplashScreen()?(this.getCanvas().stop(!0,!0).animate({delay:1},1).fadeOut(0),this.getSplashScreen().stop(!0,!0).animate({delay:1},1).fadeIn(0)):this.getCanvas().fadeOut(0)):this.getBrowserOptions().getSplashScreen()?(this.getSplashScreen().stop(!0,!0).fadeIn(0).fadeOut(2e3),this.getCanvas().stop(!0,!0).fadeOut(0).fadeIn(2e3)):this.getCanvas().fadeIn(0)},getLoading:function(){return this[a]},addLoadCount:function(e){this[s].has(e)||(++this[o],this[s].add(e),this.setLoadCount(this[s].size),this.setCursor("DEFAULT"))},removeLoadCount:function(e){this[s].has(e)&&(this[s].delete(e),this.setLoadCount(this[s].size))},setLoadCount:function(e){if(this.loadCount_=e,e)var t=i(1==e?"Loading %1 file":"Loading %1 files").replace("%1",e);else{var t=i("Loading done");this.setCursor("DEFAULT")}this[a]||(this.getNotification().string_=t),this.getSplashScreen().find(".x_ite-private-spinner-text").text(t),this.getSplashScreen().find(".x_ite-private-progressbar div").css("width",100*(this[o]-e)/this[o]+"%")},resetLoadCount:function(){this.loadCount_=0,this[o]=0,this[s].clear()}},r}),define("x_ite/Components/Shape/X3DAppearanceChildNode",["x_ite/Components/Core/X3DNode","x_ite/Base/X3DConstants"],function(e,t){"use strict";function i(i){e.call(this,i),this.addType(t.X3DAppearanceChildNode)}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i}),i}),define("x_ite/Rendering/TraverseType",[],function(){"use strict";let e=0;return{POINTER:e++,CAMERA:e++,PICKING:e++,COLLISION:e++,SHADOW:e++,DISPLAY:e++}}),define("x_ite/Components/Shaders/X3DShaderNode",["x_ite/Fields","x_ite/Browser/Core/Shading","x_ite/Components/Shape/X3DAppearanceChildNode","x_ite/Base/X3DConstants","x_ite/Rendering/TraverseType"],function(e,t,i,n,r){"use strict";function o(t){i.call(this,t),this.addType(n.X3DShaderNode),this.addChildObjects("activationTime",new e.SFTime),this.valid=!1,this.selected=0}return o.prototype=Object.assign(Object.create(i.prototype),{constructor:o,initialize:function(){i.prototype.initialize.call(this),this.activate_.addInterest("set_activate__",this)},set_activate__:function(){this.activationTime_=this.getBrowser().getCurrentTime()},custom:!0,setCustom:function(e){this.custom=e},getCustom:function(){return this.custom},setValid:function(e){this.isValid_=this.valid=e},getValid:function(){return this.valid},setShading:function(e){var i=this.getBrowser().getContext();switch(e){case t.POINT:this.primitiveMode=i.POINTS,this.wireframe=!0;break;case t.WIREFRAME:this.primitiveMode=i.LINE_LOOP,this.wireframe=!0;break;default:this.primitiveMode=i.TRIANGLES,this.wireframe=!1}},select:function(){++this.selected,this.isSelected_.getValue()||(this.isSelected_=!0)},deselect:function(){0===--this.selected&&this.isSelected_.getValue()&&(this.isSelected_=!1)},traverse:function(e,t){e===r.DISPLAY&&t.getShaders().add(this)}}),o}),define("x_ite/Components/Core/X3DChildNode",["x_ite/Fields","x_ite/Components/Core/X3DNode","x_ite/Base/X3DConstants"],function(e,t,i){"use strict";function n(n){this.getExecutionContext()||(t.call(this,n),this.addType(i.X3DChildNode),this.addChildObjects("isCameraObject",new e.SFBool),this.addChildObjects("isPickableObject",new e.SFBool),this.isCameraObject_.setAccessType(i.outputOnly),this.isPickableObject_.setAccessType(i.outputOnly))}return n.prototype=Object.assign(Object.create(t.prototype),{constructor:n,setCameraObject:function(e){e!==this.isCameraObject_.getValue()&&(this.isCameraObject_=e)},getCameraObject:function(){return this.isCameraObject_.getValue()},setPickableObject:function(e){e!==this.isPickableObject_.getValue()&&(this.isPickableObject_=e)},getPickableObject:function(){return this.isPickableObject_.getValue()}}),n}),define("x_ite/Components/Core/X3DBindableNode",["x_ite/Fields","x_ite/Components/Core/X3DChildNode","x_ite/Base/X3DConstants"],function(e,t,i){"use strict";function n(n){t.call(this,n),this.addType(i.X3DBindableNode),this.addChildObjects("transitionActive",new e.SFBool)}return n.prototype=Object.assign(Object.create(t.prototype),{constructor:n,getCameraObject:function(){return!0},transitionStart:function(){}}),n}),define("x_ite/Components/Core/X3DSensorNode",["x_ite/Components/Core/X3DChildNode","x_ite/Base/X3DConstants"],function(e,t){"use strict";function i(i){e.call(this,i),this.addType(t.X3DSensorNode)}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i}),i}),define("x_ite/Components/Time/X3DTimeDependentNode",["x_ite/Fields","x_ite/Components/Core/X3DChildNode","x_ite/Base/X3DConstants"],function(e,t,i){"use strict";function n(t){this.addType(i.X3DTimeDependentNode),this.addChildObjects("initialized",new e.SFTime,"isEvenLive",new e.SFBool),this.startTimeValue=0,this.pauseTimeValue=0,this.resumeTimeValue=0,this.stopTimeValue=0,this.start=0,this.pause=0,this.pauseInterval=0,this.startTimeout=null,this.pauseTimeout=null,this.resumeTimeout=null,this.stopTimeout=null,this.disabled=!1}return n.prototype=Object.assign(Object.create(t.prototype),{constructor:n,initialize:function(){this.isLive().addInterest("set_live__",this),this.isEvenLive_.addInterest("set_live__",this),this.initialized_.addInterest("set_loop__",this),this.enabled_.addInterest("set_enabled__",this),this.loop_.addInterest("set_loop__",this),this.startTime_.addInterest("set_startTime__",this),this.pauseTime_.addInterest("set_pauseTime__",this),this.resumeTime_.addInterest("set_resumeTime__",this),this.stopTime_.addInterest("set_stopTime__",this),this.startTimeValue=this.startTime_.getValue(),this.pauseTimeValue=this.pauseTime_.getValue(),this.resumeTimeValue=this.resumeTime_.getValue(),this.stopTimeValue=this.stopTime_.getValue(),this.initialized_=this.getBrowser().getCurrentTime()},getDisabled:function(){return this.disabled},getLiveState:function(){return this.getLive()&&(this.getExecutionContext().isLive().getValue()||this.isEvenLive_.getValue())},
getElapsedTime:function(){return this.getBrowser().getCurrentTime()-this.start-this.pauseInterval},resetElapsedTime:function(){this.start=this.getBrowser().getCurrentTime(),this.pause=this.getBrowser().getCurrentTime(),this.pauseInterval=0},set_live__:function(){this.isLive().getValue()||this.isEvenLive_.getValue()?this.disabled&&(this.disabled=!1,this.isActive_.getValue()&&!this.isPaused_.getValue()&&this.real_resume()):this.disabled||!this.isActive_.getValue()||this.isPaused_.getValue()||(this.disabled=!0,this.real_pause())},set_enabled__:function(){this.enabled_.getValue()?this.set_loop__():this.stop()},set_loop__:function(){this.enabled_.getValue()&&this.loop_.getValue()&&this.stopTimeValue<=this.startTimeValue&&this.startTimeValue<=this.getBrowser().getCurrentTime()&&this.do_start()},set_startTime__:function(){this.startTimeValue=this.startTime_.getValue(),this.enabled_.getValue()&&(this.removeTimeout("startTimeout"),this.startTimeValue<=this.getBrowser().getCurrentTime()?this.do_start():this.addTimeout("startTimeout","do_start",this.startTimeValue))},set_pauseTime__:function(){if(this.pauseTimeValue=this.pauseTime_.getValue(),this.enabled_.getValue()){if(this.removeTimeout("pauseTimeout"),this.pauseTimeValue<=this.resumeTimeValue)return;this.pauseTimeValue<=this.getBrowser().getCurrentTime()?this.do_pause():this.addTimeout("pauseTimeout","do_pause",this.pauseTimeValue)}},set_resumeTime__:function(){if(this.resumeTimeValue=this.resumeTime_.getValue(),this.enabled_.getValue()){if(this.removeTimeout("resumeTimeout"),this.resumeTimeValue<=this.pauseTimeValue)return;this.resumeTimeValue<=this.getBrowser().getCurrentTime()?this.do_resume():this.addTimeout("resumeTimeout","do_resume",this.resumeTimeValue)}},set_stopTime__:function(){if(this.stopTimeValue=this.stopTime_.getValue(),this.enabled_.getValue()){if(this.removeTimeout("stopTimeout"),this.stopTimeValue<=this.startTimeValue)return;this.stopTimeValue<=this.getBrowser().getCurrentTime()?this.do_stop():this.addTimeout("stopTimeout","do_stop",this.stopTimeValue)}},do_start:function(){this.isActive_.getValue()||(this.resetElapsedTime(),this.isActive_=!0,this.set_start(),this.isLive().getValue()?this.getBrowser().timeEvents().addInterest("set_time",this):(this.disabled=!0,this.real_pause()),this.elapsedTime_=0)},do_pause:function(){this.isActive_.getValue()&&!this.isPaused_.getValue()&&(this.isPaused_=!0,this.pauseTimeValue!==this.getBrowser().getCurrentTime()&&(this.pauseTimeValue=this.getBrowser().getCurrentTime()),this.isLive().getValue()&&this.real_pause())},real_pause:function(){this.pause=performance.now(),this.set_pause(),this.getBrowser().timeEvents().removeInterest("set_time",this)},do_resume:function(){this.isActive_.getValue()&&this.isPaused_.getValue()&&(this.isPaused_=!1,this.resumeTimeValue!==this.getBrowser().getCurrentTime()&&(this.resumeTimeValue=this.getBrowser().getCurrentTime()),this.isLive().getValue()&&this.real_resume())},real_resume:function(){const e=(performance.now()-this.pause)/1e3;this.pauseInterval+=e,this.set_resume(e),this.getBrowser().timeEvents().addInterest("set_time",this),this.getBrowser().addBrowserEvent()},do_stop:function(){this.stop()},stop:function(){this.isActive_.getValue()&&(this.set_stop(),this.elapsedTime_=this.getElapsedTime(),this.isPaused_.getValue()&&(this.isPaused_=!1),this.isActive_=!1,this.getBrowser().timeEvents().removeInterest("set_time",this))},timeout:function(e){this.enabled_.getValue()&&(this.getBrowser().advanceTime(performance.now()),this[e]())},addTimeout:function(e,t,i){this.removeTimeout(e),this[e]=setTimeout(this.timeout.bind(this,t),1e3*(i-this.getBrowser().getCurrentTime()))},removeTimeout:function(e){clearTimeout(this[e]),this[e]=null},set_start:function(){},set_pause:function(){},set_resume:function(){},set_stop:function(){},set_time:function(){}}),n}),define("x_ite/Components/Time/TimeSensor",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Core/X3DSensorNode","x_ite/Components/Time/X3DTimeDependentNode","x_ite/Base/X3DConstants","standard/Math/Algorithm"],function(e,t,i,n,r,o,s){"use strict";function a(t){n.call(this,t),r.call(this,t),this.addType(o.TimeSensor),this.addChildObjects("range",new e.MFFloat(0,0,1)),this.cycle=0,this.interval=0,this.fraction=0,this.first=0,this.last=1,this.scale=1}return a.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:a,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOutput,"enabled",new e.SFBool(!0)),new t(o.inputOutput,"cycleInterval",new e.SFTime(1)),new t(o.inputOutput,"loop",new e.SFBool),new t(o.inputOutput,"startTime",new e.SFTime),new t(o.inputOutput,"resumeTime",new e.SFTime),new t(o.inputOutput,"pauseTime",new e.SFTime),new t(o.inputOutput,"stopTime",new e.SFTime),new t(o.outputOnly,"isPaused",new e.SFBool),new t(o.outputOnly,"isActive",new e.SFBool),new t(o.outputOnly,"cycleTime",new e.SFTime),new t(o.outputOnly,"elapsedTime",new e.SFTime),new t(o.outputOnly,"fraction_changed",new e.SFFloat),new t(o.outputOnly,"time",new e.SFTime)]),getTypeName:function(){return"TimeSensor"},getComponentName:function(){return"Time"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),r.prototype.initialize.call(this),this.cycleInterval_.addInterest("set_cycleInterval__",this),this.range_.addInterest("set_range__",this)},setRange:function(e,t,i){const n=this.getBrowser().getCurrentTime(),r=this.startTime_.getValue(),o=this.cycleInterval_.getValue();this.first=t,this.last=i,this.scale=this.last-this.first,this.interval=o*this.scale,this.fraction=s.fract((e>=1?0:e)+(this.interval?(n-r)/this.interval:0)),this.cycle=n-(this.fraction-this.first)*o},set_cycleInterval__:function(){this.isActive_.getValue()&&this.setRange(this.fraction,this.range_[1],this.range_[2])},set_range__:function(){this.isActive_.getValue()&&(this.setRange(this.range_[0],this.range_[1],this.range_[2]),this.isPaused_.getValue()||this.set_fraction(this.getBrowser().getCurrentTime()))},set_start:function(){this.setRange(this.range_[0],this.range_[1],this.range_[2]),this.isLive().getValue()&&(this.fraction_changed_=this.fraction,this.time_=this.getBrowser().getCurrentTime())},set_resume:function(e){const t=this.getBrowser().getCurrentTime(),i=this.startTime_.getValue();this.setRange(this.interval?s.fract(this.fraction-(t-i)/this.interval):0,this.range_[1],this.range_[2])},set_fraction:function(e){this.fraction_changed_=this.fraction=this.first+(this.interval?s.fract((e-this.cycle)/this.interval):0)*this.scale},set_time:function(){const e=this.getBrowser().getCurrentTime();e-this.cycle>=this.interval?this.loop_.getValue()?this.interval&&(this.cycle+=this.interval*Math.floor((e-this.cycle)/this.interval),this.elapsedTime_=this.getElapsedTime(),this.cycleTime_=e,this.set_fraction(e)):(this.fraction_changed_=this.fraction=this.last,this.stop()):(this.elapsedTime_=this.getElapsedTime(),this.set_fraction(e)),this.time_=e}}),a}),define("x_ite/Components/Interpolation/X3DInterpolatorNode",["x_ite/Components/Core/X3DChildNode","x_ite/Base/X3DConstants","standard/Math/Algorithm"],function(e,t,i){"use strict";function n(i){e.call(this,i),this.addType(t.X3DInterpolatorNode)}return n.prototype=Object.assign(Object.create(e.prototype),{constructor:n,setup:function(){this.set_key__(),this.key_.length&&this.interpolate(0,0,0),e.prototype.setup.call(this)},initialize:function(){e.prototype.initialize.call(this),this.set_fraction_.addInterest("set_fraction__",this),this.key_.addInterest("set_key__",this)},set_fraction__:function(){var e=this.key_,t=e.length,n=this.set_fraction_.getValue();switch(t){case 0:return;case 1:return this.interpolate(0,0,0);default:if(n<=e[0])return this.interpolate(0,1,0);var r=i.upperBound(e,0,t,n,i.less);if(r!==t){var o=r-1,s=(n-e[o])/(e[r]-e[o]);this.interpolate(o,r,i.clamp(s,0,1))}else this.interpolate(t-2,t-1,1)}},set_key__:function(){this.set_keyValue__()},set_keyValue__:function(){},interpolate:function(){}}),n}),define("x_ite/Components/Interpolation/EaseInEaseOut",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Base/X3DConstants"],function(e,t,i,n,r){"use strict";function o(e){n.call(this,e),this.addType(r.EaseInEaseOut)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_fraction",new e.SFFloat),new t(r.inputOutput,"key",new e.MFFloat),new t(r.inputOutput,"easeInEaseOut",new e.MFVec2f),new t(r.outputOnly,"modifiedFraction_changed",new e.SFFloat)]),getTypeName:function(){return"EaseInEaseOut"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.easeInEaseOut_.addInterest("set_keyValue__",this)},set_keyValue__:function(){this.easeInEaseOut_.length<this.key_.length&&this.easeInEaseOut_.resize(this.key_.length,this.easeInEaseOut_.length?this.easeInEaseOut_[this.easeInEaseOut_.length-1]:new e.SFVec2f)},interpolate:function(e,t,i){var n=this.easeInEaseOut_[e].y,r=this.easeInEaseOut_[t].x,o=n+r;if(o<0)this.modifiedFraction_changed_=i;else{o>1&&(r/=o,n/=o);var s=1/(2-n-r);if(i<n)this.modifiedFraction_changed_=s/n*i*i;else if(i<=1-r)this.modifiedFraction_changed_=s*(2*i-n);else{var a=1-i;this.modifiedFraction_changed_=1-s*a*a/r}}}}),o}),define("x_ite/Components/Interpolation/PositionInterpolator",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),this.addType(r.PositionInterpolator)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_fraction",new e.SFFloat),new t(r.inputOutput,"key",new e.MFFloat),new t(r.inputOutput,"keyValue",new e.MFVec3f),new t(r.outputOnly,"value_changed",new e.SFVec3f)]),getTypeName:function(){return"PositionInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.keyValue_.addInterest("set_keyValue__",this)},set_keyValue__:function(){var t=this.key_,i=this.keyValue_;i.length<t.length&&i.resize(t.length,i.length?i[i.length-1]:new e.SFVec3f)},interpolate:function(){var e=new o(0,0,0);return function(t,i,n){this.value_changed_=e.assign(this.keyValue_[t].getValue()).lerp(this.keyValue_[i].getValue(),n)}}()}),s}),define("x_ite/Components/Interpolation/OrientationInterpolator",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Rotation4"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),this.addType(r.OrientationInterpolator),this.keyValue_.setUnit("angle"),this.value_changed_.setUnit("angle")}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_fraction",new e.SFFloat),new t(r.inputOutput,"key",new e.MFFloat),new t(r.inputOutput,"keyValue",new e.MFRotation),new t(r.outputOnly,"value_changed",new e.SFRotation)]),getTypeName:function(){return"OrientationInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.keyValue_.addInterest("set_keyValue__",this)},set_keyValue__:function(){const t=this.key_,i=this.keyValue_;i.length<t.length&&i.resize(t.length,i.length?i[i.length-1]:new e.SFRotation)},interpolate:function(){const e=new o(0,0,1,0),t=new o(0,0,1,0);return function(i,n,r){try{e.assign(this.keyValue_[i].getValue()),t.assign(this.keyValue_[n].getValue()),this.value_changed_=e.slerp(t,r)}catch(e){}}}()}),s}),define("x_ite/Components/Navigation/X3DViewpointNode",["x_ite/Fields","x_ite/Components/Core/X3DBindableNode","x_ite/Components/Time/TimeSensor","x_ite/Components/Interpolation/EaseInEaseOut","x_ite/Components/Interpolation/PositionInterpolator","x_ite/Components/Interpolation/OrientationInterpolator","x_ite/Rendering/TraverseType","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4"],function(e,t,i,n,r,o,s,a,u,l,c){"use strict";function h(s){t.call(this,s),this.addType(a.X3DViewpointNode),this.addChildObjects("positionOffset",new e.SFVec3f,"orientationOffset",new e.SFRotation,"scaleOffset",new e.SFVec3f(1,1,1),"scaleOrientationOffset",new e.SFRotation,"centerOfRotationOffset",new e.SFVec3f,"fieldOfViewScale",new e.SFFloat(1)),this.userPosition=new u(0,1,0),this.userOrientation=new l(0,0,1,0),this.userCenterOfRotation=new u(0,0,0),this.modelMatrix=new c,this.cameraSpaceMatrix=new c(1,0,0,0,0,1,0,0,0,0,1,0,0,0,10,1),this.viewMatrix=new c(1,0,0,0,0,1,0,0,0,0,1,0,0,0,-10,1);const h=this.getBrowser();this.timeSensor=new i(h.getPrivateScene()),this.easeInEaseOut=new n(h.getPrivateScene()),this.positionInterpolator=new r(h.getPrivateScene()),this.orientationInterpolator=new o(h.getPrivateScene()),this.scaleInterpolator=new r(h.getPrivateScene()),this.scaleOrientationInterpolator=new o(h.getPrivateScene())}return h.prototype=Object.assign(Object.create(t.prototype),{constructor:h,initialize:function(){t.prototype.initialize.call(this),this.timeSensor.stopTime_=1,this.timeSensor.setup(),this.easeInEaseOut.key_=new e.MFFloat(0,1),this.easeInEaseOut.easeInEaseOut_=new e.MFVec2f(new e.SFVec2f(0,0),new e.SFVec2f(0,0)),this.easeInEaseOut.setup(),this.positionInterpolator.key_=new e.MFFloat(0,1),this.orientationInterpolator.key_=new e.MFFloat(0,1),this.scaleInterpolator.key_=new e.MFFloat(0,1),this.scaleOrientationInterpolator.key_=new e.MFFloat(0,1),this.positionInterpolator.setup(),this.orientationInterpolator.setup(),this.scaleInterpolator.setup(),this.scaleOrientationInterpolator.setup(),this.timeSensor.isActive_.addFieldInterest(this.transitionActive_),this.timeSensor.fraction_changed_.addFieldInterest(this.easeInEaseOut.set_fraction_),this.easeInEaseOut.modifiedFraction_changed_.addFieldInterest(this.positionInterpolator.set_fraction_),this.easeInEaseOut.modifiedFraction_changed_.addFieldInterest(this.orientationInterpolator.set_fraction_),this.easeInEaseOut.modifiedFraction_changed_.addFieldInterest(this.scaleInterpolator.set_fraction_),this.easeInEaseOut.modifiedFraction_changed_.addFieldInterest(this.scaleOrientationInterpolator.set_fraction_),this.positionInterpolator.value_changed_.addFieldInterest(this.positionOffset_),this.orientationInterpolator.value_changed_.addFieldInterest(this.orientationOffset_),this.scaleInterpolator.value_changed_.addFieldInterest(this.scaleOffset_),this.scaleOrientationInterpolator.value_changed_.addFieldInterest(this.scaleOrientationOffset_),this.isBound_.addInterest("set_bound__",this)},getEaseInEaseOut:function(){return this.easeInEaseOut},setInterpolators:function(){},getPosition:function(){return this.position_.getValue()},getUserPosition:function(){return this.userPosition.assign(this.getPosition()).add(this.positionOffset_.getValue())},getOrientation:function(){return this.orientation_.getValue()},getUserOrientation:function(){return this.userOrientation.assign(this.getOrientation()).multRight(this.orientationOffset_.getValue())},getCenterOfRotation:function(){return this.centerOfRotation_.getValue()},getUserCenterOfRotation:function(){return this.userCenterOfRotation.assign(this.getCenterOfRotation()).add(this.centerOfRotationOffset_.getValue())},getProjectionMatrix:function(e){const t=e.getNavigationInfo();return this.getProjectionMatrixWithLimits(t.getNearValue(),t.getFarValue(this),e.getLayer().getViewport().getRectangle(e.getBrowser()))},getCameraSpaceMatrix:function(){return this.cameraSpaceMatrix},getViewMatrix:function(){return this.viewMatrix},getModelMatrix:function(){return this.modelMatrix},getMaxFarValue:function(){return this.getBrowser().getRenderingProperty("LogarithmicDepthBuffer")?1e10:1e5},getUpVector:function(){return u.yAxis},getSpeedFactor:function(){return 1},setVRMLTransition:function(e){this.VRMLTransition=e},getVRMLTransition:function(){return this.VRMLTransition},transitionStart:function(){const t=new u(0,0,0),i=new l(0,0,1,0),n=new u(0,0,0),r=new l(0,0,1,0);return function(o,s,a){try{if(this.to=a,a.jump_.getValue()){if(a.retainUserOffsets_.getValue()||a.resetUserOffsets(),this!==a)for(const e of a.getFields())this.getField(e.getName()).assign(e);const u=o.getNavigationInfo(),l=u.transitionTime_.getValue();let c=u.getTransitionType();switch("2.0"==this.getExecutionContext().getSpecificationVersion()&&(c=a.getVRMLTransition()?"LINEAR":"TELEPORT"),a.setVRMLTransition(!1),l<=0&&(c="TELEPORT"),c){case"TELEPORT":return void(u.transitionComplete_=!0);case"ANIMATE":this.easeInEaseOut.easeInEaseOut_=new e.MFVec2f(new e.SFVec2f(0,1),new e.SFVec2f(1,0));break;default:this.easeInEaseOut.easeInEaseOut_=new e.MFVec2f(new e.SFVec2f(0,0),new e.SFVec2f(0,0))}this.timeSensor.cycleInterval_=l,this.timeSensor.stopTime_=this.getBrowser().getCurrentTime(),this.timeSensor.startTime_=this.getBrowser().getCurrentTime(),this.timeSensor.isActive_.addInterest("set_active__",this,u),a.getRelativeTransformation(s,t,i,n,r),this.positionInterpolator.keyValue_=new e.MFVec3f(t,a.positionOffset_),this.orientationInterpolator.keyValue_=new e.MFRotation(i,a.orientationOffset_),this.scaleInterpolator.keyValue_=new e.MFVec3f(n,a.scaleOffset_),this.scaleOrientationInterpolator.keyValue_=new e.MFRotation(r,a.scaleOrientationOffset_),this.positionOffset_=t,this.orientationOffset_=i,this.scaleOffset_=n,this.scaleOrientationOffset_=r,this.setInterpolators(s,a),this.transitionActive_=!0}else a.getRelativeTransformation(s,t,i,n,r),a.positionOffset_=t,a.orientationOffset_=i,a.scaleOffset_=n,a.scaleOrientationOffset_=r,a.setInterpolators(s,a)}catch(e){console.log(e)}}}(),transitionStop:function(){this.timeSensor.stopTime_=this.getBrowser().getCurrentTime(),this.timeSensor.isActive_.removeInterest("set_active__",this)},resetUserOffsets:function(){this.positionOffset_=u.Zero,this.orientationOffset_=l.Identity,this.scaleOffset_=u.One,this.scaleOrientationOffset_=l.Identity,this.centerOfRotationOffset_=u.Zero,this.fieldOfViewScale_=1},getRelativeTransformation:function(e,t,i,n,r){this.modelMatrix.copy().multRight(e.getViewMatrix()).inverse().get(t,i,n,r),t.subtract(this.getPosition()),i.assign(this.getOrientation().copy().inverse().multRight(i))},lookAtPoint:function(e,t,i,n){try{this.getCameraSpaceMatrix().multVecMatrix(t),c.inverse(this.getModelMatrix()).multVecMatrix(t);const r=2*e.getNavigationInfo().getNearValue();this.lookAt(e,t,r,i,n)}catch(e){console.error(e)}},lookAtBBox:function(e,t,i,n){try{t=t.copy().multRight(c.inverse(this.getModelMatrix()));const r=2*e.getNavigationInfo().getNearValue();this.lookAt(e,t.center,r,i,n)}catch(e){console.log(e)}},lookAt:function(t,i,n,r,o){const s=i.copy().add(this.getUserOrientation().multVecRot(new u(0,0,n))).subtract(this.getPosition());t.getNavigationInfo().transitionStart_=!0,this.timeSensor.cycleInterval_=.2,this.timeSensor.stopTime_=this.getBrowser().getCurrentTime(),this.timeSensor.startTime_=this.getBrowser().getCurrentTime(),this.timeSensor.isActive_.addInterest("set_active__",this,t.getNavigationInfo()),this.easeInEaseOut.easeInEaseOut_=new e.MFVec2f(new e.SFVec2f(0,1),new e.SFVec2f(1,0));const a=u.lerp(this.positionOffset_.getValue(),s,r),c=u.add(this.getPosition(),a).subtract(i);let h=l.multRight(this.orientationOffset_.getValue(),new l(this.getUserOrientation().multVecRot(new u(0,0,1)),c));o&&(h=l.inverse(this.getOrientation()).multRight(this.straightenHorizon(l.multRight(this.getOrientation(),h)))),this.positionInterpolator.keyValue_=new e.MFVec3f(this.positionOffset_,a),this.orientationInterpolator.keyValue_=new e.MFRotation(this.orientationOffset_,h),this.scaleInterpolator.keyValue_=new e.MFVec3f(this.scaleOffset_,this.scaleOffset_),this.scaleOrientationInterpolator.keyValue_=new e.MFRotation(this.scaleOrientationOffset_,this.scaleOrientationOffset_),this.setInterpolators(this,this),this.centerOfRotationOffset_=u.subtract(i,this.getCenterOfRotation()),this.set_bind_=!0},straighten:function(t,i){t.getNavigationInfo().transitionStart_=!0,this.timeSensor.cycleInterval_=.4,this.timeSensor.stopTime_=this.getBrowser().getCurrentTime(),this.timeSensor.startTime_=this.getBrowser().getCurrentTime(),this.timeSensor.isActive_.addInterest("set_active__",this,t.getNavigationInfo()),this.easeInEaseOut.easeInEaseOut_=new e.MFVec2f(new e.SFVec2f(0,1),new e.SFVec2f(1,0));const n=l.multRight(l.inverse(this.getOrientation()),this.straightenHorizon(this.getUserOrientation()));this.positionInterpolator.keyValue_=new e.MFVec3f(this.positionOffset_,this.positionOffset_),this.orientationInterpolator.keyValue_=new e.MFRotation(this.orientationOffset_,n),this.scaleInterpolator.keyValue_=new e.MFVec3f(this.scaleOffset_,this.scaleOffset_),this.scaleOrientationInterpolator.keyValue_=new e.MFRotation(this.scaleOrientationOffset_,this.scaleOrientationOffset_),this.setInterpolators(this,this),this.set_bind_=!0},straightenHorizon:function(){const e=new u(0,0,0),t=new u(0,0,0),i=new l(0,0,1,0);return function(n){n.multVecRot(e.assign(u.xAxis).negate()),n.multVecRot(t.assign(u.zAxis));const r=this.getUpVector(),o=t.cross(r);return Math.abs(t.dot(r))>=1?n:Math.abs(o.dot(e))>=1?n:(i.setFromToVec(e,o),n.multRight(i))}}(),set_active__:function(e,t){this.isBound_.getValue()&&!e.getValue()&&1===this.timeSensor.fraction_changed_.getValue()&&(t.transitionComplete_=!0)},set_bound__:function(){this.isBound_.getValue()?this.getBrowser().getNotification().string_=this.description_:this.timeSensor.stopTime_=this.getBrowser().getCurrentTime()},traverse:function(e,t){e===s.CAMERA&&(t.getLayer().getViewpoints().push(this),this.modelMatrix.assign(t.getModelViewMatrix().get()))},update:function(){try{this.cameraSpaceMatrix.set(this.getUserPosition(),this.getUserOrientation(),this.scaleOffset_.getValue(),this.scaleOrientationOffset_.getValue()),this.cameraSpaceMatrix.multRight((this.to||this).modelMatrix),this.viewMatrix.assign(this.cameraSpaceMatrix).inverse()}catch(e){console.log(e)}}}),h}),define("x_ite/Components/Interpolation/ScalarInterpolator",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Base/X3DConstants","standard/Math/Algorithm"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),this.addType(r.ScalarInterpolator)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_fraction",new e.SFFloat),new t(r.inputOutput,"key",new e.MFFloat),new t(r.inputOutput,"keyValue",new e.MFFloat),new t(r.outputOnly,"value_changed",new e.SFFloat)]),getTypeName:function(){return"ScalarInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.keyValue_.addInterest("set_keyValue__",this)},set_keyValue__:function(){var e=this.key_,t=this.keyValue_;t.length<e.length&&t.resize(e.length,t.length?t[t.length-1]:0)},interpolate:function(e,t,i){this.value_changed_=o.lerp(this.keyValue_[e],this.keyValue_[t],i)}}),s}),define("standard/Math/Geometry/Camera",["standard/Math/Numbers/Vector3"],function(e){"use strict";return{frustum:function(e,t,i,n,r,o,s){const a=t-e,u=n-i,l=o-r,c=2*r,h=(t+e)/a,d=(n+i)/u,p=-(o+r)/l,f=-(c*o)/l,g=c/a,m=c/u;return s.set(g,0,0,0,0,m,0,0,h,d,p,-1,0,0,f,0)},perspective:function(e,t,i,n,r,o){const s=Math.tan(e/2)*t;if(n>r){const e=n*s/r;return this.frustum(-e,e,-s,s,t,i,o)}{const e=r*s/n;return this.frustum(-s,s,-e,e,t,i,o)}},perspective2:function(e,t,i,n,r,o){const s=Math.tan(e/2)*t;return this.frustum(-s,s,-s,s,t,i,o)},ortho:function(e,t,i,n,r,o,s){const a=t-e,u=n-i,l=o-r,c=2/a,h=2/u,d=-2/l,p=-(t+e)/a,f=-(n+i)/u,g=-(o+r)/l;return s.set(c,0,0,0,0,h,0,0,0,0,d,0,p,f,g,1)},orthoBox:function(){const t=new e(0,0,0),i=new e(0,0,0);return function(e,n){return e.getExtents(t,i),this.ortho(t.x,i.x,t.y,i.y,-i.z,-t.z,n)}}()}}),define("x_ite/Components/Navigation/OrthoViewpoint",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Navigation/X3DViewpointNode","x_ite/Components/Interpolation/ScalarInterpolator","x_ite/Base/X3DConstants","standard/Math/Geometry/Camera","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4"],function(e,t,i,n,r,o,s,a,u,l){"use strict";function c(t){n.call(this,t),this.addType(o.OrthoViewpoint),this.addChildObjects("fieldOfViewOffset",new e.MFFloat(0,0,0,0)),this.position_.setUnit("length"),this.centerOfRotation_.setUnit("length"),this.fieldOfView_.setUnit("length"),this.projectionMatrix=new l,this.fieldOfViewOffsetInterpolator0=new r(this.getBrowser().getPrivateScene()),this.fieldOfViewOffsetInterpolator1=new r(this.getBrowser().getPrivateScene()),this.fieldOfViewOffsetInterpolator2=new r(this.getBrowser().getPrivateScene()),this.fieldOfViewOffsetInterpolator3=new r(this.getBrowser().getPrivateScene()),this.fieldOfViewScaleInterpolator=new r(this.getBrowser().getPrivateScene())}return c.prototype=Object.assign(Object.create(n.prototype),{constructor:c,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOnly,"set_bind",new e.SFBool),new t(o.inputOutput,"description",new e.SFString),new t(o.inputOutput,"position",new e.SFVec3f(0,0,10)),new t(o.inputOutput,"orientation",new e.SFRotation),new t(o.inputOutput,"centerOfRotation",new e.SFVec3f),new t(o.inputOutput,"fieldOfView",new e.MFFloat(-1,-1,1,1)),new t(o.inputOutput,"jump",new e.SFBool(!0)),new t(o.inputOutput,"retainUserOffsets",new e.SFBool),new t(o.outputOnly,"isBound",new e.SFBool),new t(o.outputOnly,"bindTime",new e.SFTime)]),getTypeName:function(){return"OrthoViewpoint"},getComponentName:function(){return"Navigation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.fieldOfView_.addInterest("set_fieldOfView__",this),this.fieldOfViewOffset_.addInterest("set_fieldOfView__",this),this.fieldOfViewScale_.addInterest("set_fieldOfView__",this),this.fieldOfViewOffsetInterpolator0.key_=new e.MFFloat(0,1),this.fieldOfViewOffsetInterpolator1.key_=new e.MFFloat(0,1),this.fieldOfViewOffsetInterpolator2.key_=new e.MFFloat(0,1),this.fieldOfViewOffsetInterpolator3.key_=new e.MFFloat(0,1),this.fieldOfViewScaleInterpolator.key_=new e.MFFloat(0,1),this.fieldOfViewOffsetInterpolator0.setup(),this.fieldOfViewOffsetInterpolator1.setup(),this.fieldOfViewOffsetInterpolator2.setup(),this.fieldOfViewOffsetInterpolator3.setup(),this.fieldOfViewScaleInterpolator.setup(),this.getEaseInEaseOut().modifiedFraction_changed_.addFieldInterest(this.fieldOfViewOffsetInterpolator0.set_fraction_),this.getEaseInEaseOut().modifiedFraction_changed_.addFieldInterest(this.fieldOfViewOffsetInterpolator1.set_fraction_),this.getEaseInEaseOut().modifiedFraction_changed_.addFieldInterest(this.fieldOfViewOffsetInterpolator2.set_fraction_),this.getEaseInEaseOut().modifiedFraction_changed_.addFieldInterest(this.fieldOfViewOffsetInterpolator3.set_fraction_),this.getEaseInEaseOut().modifiedFraction_changed_.addFieldInterest(this.fieldOfViewScaleInterpolator.set_fraction_),this.fieldOfViewOffsetInterpolator0.value_changed_.addInterest("set_fieldOfViewOffset__",this),this.fieldOfViewOffsetInterpolator1.value_changed_.addInterest("set_fieldOfViewOffset__",this),this.fieldOfViewOffsetInterpolator2.value_changed_.addInterest("set_fieldOfViewOffset__",this),this.fieldOfViewOffsetInterpolator3.value_changed_.addInterest("set_fieldOfViewOffset__",this),this.fieldOfViewScaleInterpolator.value_changed_.addFieldInterest(this.fieldOfViewScale_),this.set_fieldOfView__()},set_fieldOfView__:function(){var e=this.fieldOfView_.length,t=this.fieldOfViewScale_.getValue();this.minimumX=((e>0?this.fieldOfView_[0]:-1)+this.fieldOfViewOffset_[0])*t,this.minimumY=((e>1?this.fieldOfView_[1]:-1)+this.fieldOfViewOffset_[1])*t,this.maximumX=((e>2?this.fieldOfView_[2]:1)+this.fieldOfViewOffset_[2])*t,this.maximumY=((e>3?this.fieldOfView_[3]:1)+this.fieldOfViewOffset_[3])*t,this.sizeX=this.maximumX-this.minimumX,this.sizeY=this.maximumY-this.minimumY},set_fieldOfViewOffset__:function(){this.fieldOfViewOffset_[0]=this.fieldOfViewOffsetInterpolator0.value_changed_.getValue(),this.fieldOfViewOffset_[1]=this.fieldOfViewOffsetInterpolator1.value_changed_.getValue(),this.fieldOfViewOffset_[2]=this.fieldOfViewOffsetInterpolator2.value_changed_.getValue(),this.fieldOfViewOffset_[3]=this.fieldOfViewOffsetInterpolator3.value_changed_.getValue()},setInterpolators:function(t,i){if(t.getType().indexOf(o.OrthoViewpoint)>=0){const n=i.fieldOfView_.length,r=t.fieldOfView_.length,o=(r>0?t.fieldOfView_[0]:-1)-(n>0?i.fieldOfView_[0]:-1),s=(r>1?t.fieldOfView_[1]:-1)-(n>1?i.fieldOfView_[1]:-1),a=(r>2?t.fieldOfView_[2]:1)-(n>2?i.fieldOfView_[2]:1),u=(r>3?t.fieldOfView_[3]:1)-(n>3?i.fieldOfView_[3]:1);this.fieldOfViewOffsetInterpolator0.keyValue_=new e.MFFloat(o,i.fieldOfViewOffset_[0]),this.fieldOfViewOffsetInterpolator1.keyValue_=new e.MFFloat(s,i.fieldOfViewOffset_[1]),this.fieldOfViewOffsetInterpolator2.keyValue_=new e.MFFloat(a,i.fieldOfViewOffset_[2]),this.fieldOfViewOffsetInterpolator3.keyValue_=new e.MFFloat(u,i.fieldOfViewOffset_[3]),this.fieldOfViewScaleInterpolator.keyValue_=new e.MFFloat(t.fieldOfViewScale_.getValue(),i.fieldOfViewScale_.getValue()),this.fieldOfViewOffset_[0]=o,this.fieldOfViewOffset_[1]=s,this.fieldOfViewOffset_[2]=a,this.fieldOfViewOffset_[3]=u,this.fieldOfViewScale_=t.fieldOfViewScale_.getValue()}else this.fieldOfViewOffsetInterpolator0.keyValue_=new e.MFFloat(i.fieldOfViewOffset_[0],i.fieldOfViewOffset_[0]),this.fieldOfViewOffsetInterpolator1.keyValue_=new e.MFFloat(i.fieldOfViewOffset_[1],i.fieldOfViewOffset_[1]),this.fieldOfViewOffsetInterpolator2.keyValue_=new e.MFFloat(i.fieldOfViewOffset_[2],i.fieldOfViewOffset_[2]),this.fieldOfViewOffsetInterpolator3.keyValue_=new e.MFFloat(i.fieldOfViewOffset_[3],i.fieldOfViewOffset_[3]),this.fieldOfViewScaleInterpolator.keyValue_=new e.MFFloat(i.fieldOfViewScale_.getValue(),i.fieldOfViewScale_.getValue()),this.fieldOfViewOffset_=i.fieldOfViewOffset_.getValue(),this.fieldOfViewScale_=i.fieldOfViewScale_.getValue()},getMinimumX:function(){return this.minimumX},getMinimumY:function(){return this.minimumY},getMaximumX:function(){return this.maximumX},getMaximumY:function(){return this.maximumY},getSizeX:function(){return this.sizeX},getSizeY:function(){return this.sizeY},getMaxFarValue:function(){return 1e5},getScreenScale:function(){var e=new u(0,0,0);return function(t,i){var n=i[2],r=i[3],o=this.sizeX,s=this.sizeY;if(n/r>o/s){var a=s/r;return e.set(a,a,a)}var a=o/n;return e.set(a,a,a)}}(),getViewportSize:function(){var e=new a(0,0);return function(t,i){var n=t[2],r=t[3],o=this.sizeX,s=this.sizeY,a=n/r;return a>o/s?e.set(s*a,s):e.set(o,o/a)}}(),getLookAtDistance:function(e){return e.size.abs()/2+10},getProjectionMatrixWithLimits:function(e,t,i){var n=i[2],r=i[3],o=n/r,a=this.sizeX,u=this.sizeY;if(o>a/u){var l=(this.minimumX+this.maximumX)/2,c=u*o/2;return s.ortho(l-c,l+c,this.minimumY,this.maximumY,e,t,this.projectionMatrix)}var l=(this.minimumY+this.maximumY)/2,c=a/o/2;return s.ortho(this.minimumX,this.maximumX,l-c,l+c,e,t,this.projectionMatrix)}}),c}),
define("x_ite/Components/Shaders/X3DProgrammableShaderObject",["x_ite/Base/X3DCast","x_ite/Base/X3DConstants","x_ite/Components/Navigation/OrthoViewpoint","standard/Math/Numbers/Matrix3"],function(e,t,i,n){"use strict";function r(e){this.addType(t.X3DProgrammableShaderObject),this.x3d_ClipPlane=[],this.x3d_LightType=[],this.x3d_LightOn=[],this.x3d_LightColor=[],this.x3d_LightIntensity=[],this.x3d_LightAmbientIntensity=[],this.x3d_LightAttenuation=[],this.x3d_LightLocation=[],this.x3d_LightDirection=[],this.x3d_LightBeamWidth=[],this.x3d_LightCutOffAngle=[],this.x3d_LightRadius=[],this.x3d_LightMatrix=[],this.x3d_ShadowIntensity=[],this.x3d_ShadowColor=[],this.x3d_ShadowBias=[],this.x3d_ShadowMatrix=[],this.x3d_ShadowMapSize=[],this.x3d_ShadowMap=[],this.x3d_TextureType=[],this.x3d_Texture2D=[],this.x3d_Texture3D=[],this.x3d_CubeMapTexture=[],this.x3d_MultiTextureMode=[],this.x3d_MultiTextureAlphaMode=[],this.x3d_MultiTextureSource=[],this.x3d_MultiTextureFunction=[],this.x3d_TextureCoordinateGeneratorMode=[],this.x3d_TextureCoordinateGeneratorParameter=[],this.x3d_ProjectiveTexture=[],this.x3d_ProjectiveTextureMatrix=[],this.x3d_ProjectiveTextureLocation=[],this.x3d_TexCoord=[],this.x3d_TextureMatrix=[],this.numClipPlanes=0,this.fogNode=null,this.numLights=0,this.numGlobalLights=0,this.lightNodes=[],this.numProjectiveTextures=0,this.numGlobalProjectiveTextures=0,this.projectiveTextureNodes=[],this.textures=new Map}const o=Symbol.for("X3DField.uniformLocation");return r.prototype={constructor:r,initialize:function(){const e=this.getBrowser();this.x3d_MaxClipPlanes=e.getMaxClipPlanes(),this.x3d_MaxLights=e.getMaxLights(),this.x3d_MaxTextures=e.getMaxTextures()},canUserDefinedFields:function(){return!0},bindAttributeLocations:function(e,t){e.bindAttribLocation(t,0,"x3d_Vertex")},getDefaultUniforms:function(){const e=this.getBrowser(),t=e.getContext(),i=this.getProgram();this.x3d_LogarithmicFarFactor1_2=t.getUniformLocation(i,"x3d_LogarithmicFarFactor1_2"),this.x3d_GeometryType=t.getUniformLocation(i,"x3d_GeometryType"),this.x3d_NumClipPlanes=t.getUniformLocation(i,"x3d_NumClipPlanes"),this.x3d_ClipPlanes=t.getUniformLocation(i,"x3d_ClipPlane");for(let e=0;e<this.x3d_MaxClipPlanes;++e)this.x3d_ClipPlane[e]=t.getUniformLocation(i,"x3d_ClipPlane["+e+"]");this.x3d_FogType=this.getUniformLocation(t,i,"x3d_Fog.type","x3d_FogType"),this.x3d_FogColor=this.getUniformLocation(t,i,"x3d_Fog.color","x3d_FogColor"),this.x3d_FogVisibilityRange=this.getUniformLocation(t,i,"x3d_Fog.visibilityRange","x3d_FogVisibilityRange"),this.x3d_FogMatrix=this.getUniformLocation(t,i,"x3d_Fog.matrix","x3d_FogMatrix"),this.x3d_FogCoord=this.getUniformLocation(t,i,"x3d_Fog.fogCoord","x3d_FogCoord"),this.x3d_AlphaCutoff=t.getUniformLocation(i,"x3d_AlphaCutoff"),this.x3d_PointPropertiesPointSizeScaleFactor=t.getUniformLocation(i,"x3d_PointProperties.pointSizeScaleFactor"),this.x3d_PointPropertiesPointSizeMinValue=t.getUniformLocation(i,"x3d_PointProperties.pointSizeMinValue"),this.x3d_PointPropertiesPointSizeMaxValue=t.getUniformLocation(i,"x3d_PointProperties.pointSizeMaxValue"),this.x3d_PointPropertiesPointSizeAttenuation=t.getUniformLocation(i,"x3d_PointProperties.pointSizeAttenuation"),this.x3d_PointPropertiesColorMode=t.getUniformLocation(i,"x3d_PointProperties.colorMode"),this.x3d_LinePropertiesApplied=t.getUniformLocation(i,"x3d_LineProperties.applied"),this.x3d_LinePropertiesLinewidthScaleFactor=this.getUniformLocation(t,i,"x3d_LineProperties.linewidthScaleFactor","x3d_LinewidthScaleFactor"),this.x3d_LinePropertiesLinetype=t.getUniformLocation(i,"x3d_LineProperties.linetype"),this.x3d_FillPropertiesFilled=t.getUniformLocation(i,"x3d_FillProperties.filled"),this.x3d_FillPropertiesHatched=t.getUniformLocation(i,"x3d_FillProperties.hatched"),this.x3d_FillPropertiesHatchColor=t.getUniformLocation(i,"x3d_FillProperties.hatchColor"),this.x3d_FillPropertiesHatchStyle=t.getUniformLocation(i,"x3d_FillProperties.hatchStyle"),this.x3d_ColorMaterial=t.getUniformLocation(i,"x3d_ColorMaterial"),this.x3d_NumLights=t.getUniformLocation(i,"x3d_NumLights");for(let e=0;e<this.x3d_MaxLights;++e)this.x3d_LightType[e]=this.getUniformLocation(t,i,"x3d_LightSource["+e+"].type","x3d_LightType["+e+"]"),this.x3d_LightColor[e]=this.getUniformLocation(t,i,"x3d_LightSource["+e+"].color","x3d_LightColor["+e+"]"),this.x3d_LightAmbientIntensity[e]=this.getUniformLocation(t,i,"x3d_LightSource["+e+"].ambientIntensity","x3d_LightAmbientIntensity["+e+"]"),this.x3d_LightIntensity[e]=this.getUniformLocation(t,i,"x3d_LightSource["+e+"].intensity","x3d_LightIntensity["+e+"]"),this.x3d_LightAttenuation[e]=this.getUniformLocation(t,i,"x3d_LightSource["+e+"].attenuation","x3d_LightAttenuation["+e+"]"),this.x3d_LightLocation[e]=this.getUniformLocation(t,i,"x3d_LightSource["+e+"].location","x3d_LightLocation["+e+"]"),this.x3d_LightDirection[e]=this.getUniformLocation(t,i,"x3d_LightSource["+e+"].direction","x3d_LightDirection["+e+"]"),this.x3d_LightBeamWidth[e]=this.getUniformLocation(t,i,"x3d_LightSource["+e+"].beamWidth","x3d_LightBeamWidth["+e+"]"),this.x3d_LightCutOffAngle[e]=this.getUniformLocation(t,i,"x3d_LightSource["+e+"].cutOffAngle","x3d_LightCutOffAngle["+e+"]"),this.x3d_LightRadius[e]=this.getUniformLocation(t,i,"x3d_LightSource["+e+"].radius","x3d_LightRadius["+e+"]"),this.x3d_LightMatrix[e]=this.getUniformLocation(t,i,"x3d_LightSource["+e+"].matrix","x3d_LightMatrix["+e+"]"),this.x3d_ShadowIntensity[e]=t.getUniformLocation(i,"x3d_LightSource["+e+"].shadowIntensity"),this.x3d_ShadowColor[e]=t.getUniformLocation(i,"x3d_LightSource["+e+"].shadowColor"),this.x3d_ShadowBias[e]=t.getUniformLocation(i,"x3d_LightSource["+e+"].shadowBias"),this.x3d_ShadowMatrix[e]=t.getUniformLocation(i,"x3d_LightSource["+e+"].shadowMatrix"),this.x3d_ShadowMapSize[e]=t.getUniformLocation(i,"x3d_LightSource["+e+"].shadowMapSize"),this.x3d_ShadowMap[e]=t.getUniformLocation(i,"x3d_ShadowMap["+e+"]");this.x3d_AmbientIntensity=this.getUniformLocation(t,i,"x3d_Material.ambientIntensity","x3d_FrontMaterial.ambientIntensity"),this.x3d_DiffuseColor=this.getUniformLocation(t,i,"x3d_Material.diffuseColor","x3d_FrontMaterial.diffuseColor"),this.x3d_SpecularColor=this.getUniformLocation(t,i,"x3d_Material.specularColor","x3d_FrontMaterial.specularColor"),this.x3d_EmissiveColor=this.getUniformLocation(t,i,"x3d_Material.emissiveColor","x3d_FrontMaterial.emissiveColor"),this.x3d_Shininess=this.getUniformLocation(t,i,"x3d_Material.shininess","x3d_FrontMaterial.shininess"),this.x3d_Transparency=this.getUniformLocation(t,i,"x3d_Material.transparency","x3d_FrontMaterial.transparency"),this.x3d_NumTextures=t.getUniformLocation(i,"x3d_NumTextures"),this.x3d_NumProjectiveTextures=t.getUniformLocation(i,"x3d_NumProjectiveTextures"),this.x3d_MultiTextureColor=t.getUniformLocation(i,"x3d_MultiTextureColor");for(let e=0;e<this.x3d_MaxTextures;++e)this.x3d_TextureType[e]=t.getUniformLocation(i,"x3d_TextureType["+e+"]"),this.x3d_Texture2D[e]=t.getUniformLocation(i,"x3d_Texture2D["+e+"]"),this.x3d_Texture3D[e]=t.getUniformLocation(i,"x3d_Texture3D["+e+"]"),this.x3d_CubeMapTexture[e]=t.getUniformLocation(i,"x3d_CubeMapTexture["+e+"]"),this.x3d_MultiTextureMode[e]=t.getUniformLocation(i,"x3d_MultiTexture["+e+"].mode"),this.x3d_MultiTextureAlphaMode[e]=t.getUniformLocation(i,"x3d_MultiTexture["+e+"].alphaMode"),this.x3d_MultiTextureSource[e]=t.getUniformLocation(i,"x3d_MultiTexture["+e+"].source"),this.x3d_MultiTextureFunction[e]=t.getUniformLocation(i,"x3d_MultiTexture["+e+"].function"),this.x3d_TextureCoordinateGeneratorMode[e]=t.getUniformLocation(i,"x3d_TextureCoordinateGenerator["+e+"].mode"),this.x3d_TextureCoordinateGeneratorParameter[e]=t.getUniformLocation(i,"x3d_TextureCoordinateGenerator["+e+"].parameter"),this.x3d_ProjectiveTexture[e]=t.getUniformLocation(i,"x3d_ProjectiveTexture["+e+"]"),this.x3d_ProjectiveTextureMatrix[e]=t.getUniformLocation(i,"x3d_ProjectiveTextureMatrix["+e+"]"),this.x3d_ProjectiveTextureLocation[e]=t.getUniformLocation(i,"x3d_ProjectiveTextureLocation["+e+"]"),this.x3d_TextureMatrix[e]=t.getUniformLocation(i,"x3d_TextureMatrix["+e+"]"),this.x3d_TexCoord[e]=this.getAttribLocation(t,i,"x3d_TexCoord"+e,e?"":"x3d_TexCoord");return this.x3d_Viewport=t.getUniformLocation(i,"x3d_Viewport"),this.x3d_ProjectionMatrix=t.getUniformLocation(i,"x3d_ProjectionMatrix"),this.x3d_ModelViewMatrix=t.getUniformLocation(i,"x3d_ModelViewMatrix"),this.x3d_NormalMatrix=t.getUniformLocation(i,"x3d_NormalMatrix"),this.x3d_CameraSpaceMatrix=t.getUniformLocation(i,"x3d_CameraSpaceMatrix"),this.x3d_FogDepth=t.getAttribLocation(i,"x3d_FogDepth"),this.x3d_Color=t.getAttribLocation(i,"x3d_Color"),this.x3d_Normal=t.getAttribLocation(i,"x3d_Normal"),this.x3d_Vertex=t.getAttribLocation(i,"x3d_Vertex"),this.x3d_ParticleId=t.getUniformLocation(i,"x3d_Particle.id"),this.x3d_ParticleLife=t.getUniformLocation(i,"x3d_Particle.life"),this.x3d_ParticleElapsedTime=t.getUniformLocation(i,"x3d_Particle.elapsedTime"),t.uniform1i(this.x3d_LinePropertiesLinetype,e.getLinetypeUnit()),t.uniform1i(this.x3d_FillPropertiesHatchStyle,e.getHatchStyleUnit()),t.uniform1i(this.x3d_NumTextures,0),t.uniform1iv(this.x3d_Texture2D[0],e.getTexture2DUnits()),t.uniform1iv(this.x3d_CubeMapTexture[0],e.getCubeMapTextureUnits()),t.uniform1iv(this.x3d_ShadowMap[0],new Int32Array(this.x3d_MaxLights).fill(e.getShadowTextureUnit())),e.getProjectiveTextureMapping()&&t.uniform1iv(this.x3d_ProjectiveTexture[0],e.getProjectiveTextureUnits()),t.getVersion()>=2&&t.uniform1iv(this.x3d_Texture3D[0],e.getTexture3DUnits()),this.x3d_FogDepth<0?(this.enableFogDepthAttribute=Function.prototype,this.disableFogDepthAttribute=Function.prototype):(delete this.enableFogDepthAttribute,delete this.disableFogDepthAttribute),this.x3d_Color<0?(this.enableColorAttribute=Function.prototype,this.disableColorAttribute=Function.prototype):(delete this.enableColorAttribute,delete this.disableColorAttribute),this.x3d_TexCoord.some(function(e){return e>=0})?(delete this.enableTexCoordAttribute,delete this.disableTexCoordAttribute):(this.enableTexCoordAttribute=Function.prototype,this.disableTexCoordAttribute=Function.prototype),this.x3d_Normal<0?(this.enableNormalAttribute=Function.prototype,this.disableNormalAttribute=Function.prototype):(delete this.enableNormalAttribute,delete this.disableNormalAttribute),!(this.x3d_Vertex<0)||(t.getVersion()>=2?console.warn("Missing »in vec4 x3d_Vertex;«."):console.warn("Missing »attribute vec4 x3d_Vertex;«."),!1)},getUniformLocation:function(e,t,i,n){let r=e.getUniformLocation(t,i);return r?r:n?(r=e.getUniformLocation(t,n),r&&console.warn(this.getTypeName(),this.getName(),"Using uniform location name »"+n+"« is depreciated, use »"+i+"«. See https://create3000.github.io/x_ite/Custom-Shaders.html."),r):0},getAttribLocation:function(e,t,i,n){let r=e.getAttribLocation(t,i);return r>=0?r:n?(r=e.getAttribLocation(t,n),r>=0&&console.warn(this.getTypeName(),this.getName(),"Using attribute location name »"+n+"« is depreciated, use »"+i+"«. See https://create3000.github.io/x_ite/Custom-Shaders.html."),r):-1},addShaderFields:function(){const e=this.getBrowser().getContext(),i=this.getProgram();this.textures.clear();for(const n of this.getUserDefinedFields()){const r=e.getUniformLocation(i,n.getName());if(r){switch(n.getType()){case t.SFImage:r.array=new Int32Array(3+n.array.length);break;case t.SFMatrix3d:case t.SFMatrix3f:case t.SFRotation:r.array=new Float32Array(9);break;case t.SFMatrix4d:case t.SFMatrix4f:r.array=new Float32Array(16);break;case t.SFNode:break;case t.MFBool:case t.MFInt32:r.array=new Int32Array(this.getLocationLength(e,i,n));break;case t.MFFloat:case t.MFDouble:case t.MFTime:r.array=new Float32Array(this.getLocationLength(e,i,n));break;case t.MFImage:r.array=new Int32Array(this.getImagesLength(n));break;case t.MFMatrix3d:case t.MFMatrix3f:case t.MFRotation:r.array=new Float32Array(9*this.getLocationLength(e,i,n));break;case t.MFMatrix4d:case t.MFMatrix4f:r.array=new Float32Array(16*this.getLocationLength(e,i,n));break;case t.MFNode:{const t=r.locations=[];for(let r=0;;++r){const o=e.getUniformLocation(i,n.getName()+"["+r+"]");if(!o)break;t.push(o)}break}case t.MFVec2d:case t.MFVec2f:r.array=new Float32Array(2*this.getLocationLength(e,i,n));break;case t.MFVec3d:case t.MFVec3f:case t.MFColor:r.array=new Float32Array(3*this.getLocationLength(e,i,n));break;case t.MFVec4d:case t.MFVec4f:case t.MFColorRGBA:r.array=new Float32Array(4*this.getLocationLength(e,i,n))}r.array?n[o]=r.array.length?r:null:n[o]=r,n.addInterest("set_field__",this),this.set_field__(n)}}},removeShaderFields:function(){for(const e of this.getUserDefinedFields())e.removeInterest("set_field__",this)},set_field__:function(){const i=new n;return function(n){const r=this.getBrowser().getContext(),s=n[o];if(s)switch(n.getType()){case t.SFBool:case t.SFInt32:return void r.uniform1i(s,n.getValue());case t.SFColor:{const e=n.getValue();return void r.uniform3f(s,e.r,e.g,e.b)}case t.SFColorRGBA:{const e=n.getValue();return void r.uniform4f(s,e.r,e.g,e.b,e.a)}case t.SFDouble:case t.SFFloat:case t.SFTime:return void r.uniform1f(s,n.getValue());case t.SFImage:{let e=s.array;const t=n.array,i=3+t.length;i!==e.length&&(e=s.array=new Int32Array(i)),e[0]=n.width,e[1]=n.height,e[2]=n.comp;for(let i=3,n=0,r=t.length;n<r;++n,++i)e[i]=t[n];return void r.uniform1iv(s,e)}case t.SFMatrix3d:case t.SFMatrix3f:return s.array.set(n.getValue()),void r.uniformMatrix3fv(s,!1,s.array);case t.SFMatrix4d:case t.SFMatrix4f:return s.array.set(n.getValue()),void r.uniformMatrix4fv(s,!1,s.array);case t.SFNode:{const i=e(t.X3DTextureNode,n);return i?void this.textures.set(s,{name:n.getName(),texture:i,textureUnit:void 0}):void this.textures.delete(s)}case t.SFRotation:return n.getValue().getMatrix(s.array),void r.uniformMatrix3fv(s,!1,s.array);case t.SFString:return;case t.SFVec2d:case t.SFVec2f:{const e=n.getValue();return void r.uniform2f(s,e.x,e.y)}case t.SFVec3d:case t.SFVec3f:{const e=n.getValue();return void r.uniform3f(s,e.x,e.y,e.z)}case t.SFVec4d:case t.SFVec4f:{const e=n.getValue();return void r.uniform4f(s,e.x,e.y,e.z,e.w)}case t.MFBool:case t.MFInt32:{const e=s.array;for(var a=0,u=n.length;a<u;++a)e[a]=n[a];for(let t=e.length;a<t;++a)e[a]=0;return void r.uniform1iv(s,e)}case t.MFColor:{const e=s.array;for(var a=0,l=0,u=n.length;a<u;++a){const t=n[a];e[l++]=t.r,e[l++]=t.g,e[l++]=t.b}for(let t=e.length;l<t;++l)e[l]=0;return void r.uniform3fv(s,e)}case t.MFColorRGBA:{const e=s.array;for(var a=0,l=0,u=n.length;a<u;++a){const t=n[a];e[l++]=t.r,e[l++]=t.g,e[l++]=t.b,e[l++]=t.a}for(let t=e.length;l<t;++l)e[l]=0;return void r.uniform4fv(s,e)}case t.MFDouble:case t.MFFloat:case t.MFTime:{const e=s.array;for(var a=0,u=n.length;a<u;++a)e[a]=n[a];for(let t=e.length;a<t;++a)e[a]=0;return void r.uniform1fv(s,e)}case t.MFImage:{const e=s.array;for(let t=0,i=0,r=n.length;t<r;++t){const r=n[t],o=r.array;e[i++]=r.width,e[i++]=r.height,e[i++]=r.comp;for(let t=0,n=o.length;t<n;++t)e[i++]=o[t]}return void r.uniform1iv(s,e)}case t.MFMatrix3d:case t.MFMatrix3f:{const e=s.array;for(var a=0,l=0,u=n.length;a<u;++a){const t=n[a];for(let i=0;i<9;++i)e[l++]=t[i]}for(let t=e.length;l<t;++l)e[l]=0;return void r.uniformMatrix3fv(s,!1,e)}case t.MFMatrix4d:case t.MFMatrix4f:{const e=s.array;for(var a=0,l=0,u=n.length;a<u;++a){const t=n[a];for(let i=0;i<16;++i)e[l++]=t[i]}for(let t=e.length;l<t;++l)e[l]=0;return void r.uniformMatrix4fv(s,!1,e)}case t.MFNode:{const i=s.locations;for(let r=0,o=n.length;r<o;++r){const o=e(t.X3DTextureNode,n[r]);o&&this.textures.set(i[r],{name:n[r].getName(),texture:o,textureUnit:void 0})}return}case t.MFRotation:{const e=s.array;for(var a=0,l=0,u=n.length;a<u;++a){const t=n[a].getValue().getMatrix(i);e[l++]=t[0],e[l++]=t[1],e[l++]=t[2],e[l++]=t[3],e[l++]=t[4],e[l++]=t[5],e[l++]=t[6],e[l++]=t[7],e[l++]=t[8]}for(let t=e.length;l<t;++l)e[l]=0;return void r.uniformMatrix3fv(s,!1,e)}case t.MFString:return;case t.MFVec2d:case t.MFVec2f:{const e=s.array;for(var a=0,l=0,u=n.length;a<u;++a){const t=n[a];e[l++]=t.x,e[l++]=t.y}for(let t=e.length;l<t;++l)e[l]=0;return void r.uniform2fv(s,e)}case t.MFVec3d:case t.MFVec3f:{const e=s.array;for(var a=0,l=0,u=n.length;a<u;++a){const t=n[a];e[l++]=t.x,e[l++]=t.y,e[l++]=t.z}for(let t=e.length;l<t;++l)e[l]=0;return void r.uniform3fv(s,e)}case t.MFVec4d:case t.MFVec4f:{const e=s.array;for(var a=0,l=0,u=n.length;a<u;++a){const t=n[a];e[l++]=t.x,e[l++]=t.y,e[l++]=t.z,e[l++]=t.w}for(let t=e.length;l<t;++l)e[l]=0;return void r.uniform4fv(s,e)}}}}(),getImagesLength:function(e){const t=e.getValue();let i=3*t.length;for(const e of t)i+=e.array.length;return i},getLocationLength:function(e,t,i){const n=i.getName();for(let i=0;;++i){const r=e.getUniformLocation(t,n+"["+i+"]");if(!r)return i}},hasFog:function(e){return this.fogNode===e||(this.fogNode=e,!1)},hasLight:function(e,t){return this.lightNodes[e]===t||(this.lightNodes[e]=t,!1)},hasTextureProjector:function(e,t){return this.projectiveTextureNodes[e]===t||(this.projectiveTextureNodes[e]=t,!1)},setLocalObjects:function(e,t){this.numClipPlanes=0,this.numLights=0,this.numProjectiveTextures=0,this.lightNodes.length=0,this.projectiveTextureNodes.length=0;for(const i of t)i.setShaderUniforms(e,this);e.uniform1i(this.x3d_NumClipPlanes,Math.min(this.numClipPlanes,this.x3d_MaxClipPlanes)),e.uniform1i(this.x3d_NumLights,Math.min(this.numLights,this.x3d_MaxLights)),e.uniform1i(this.x3d_NumProjectiveTextures,Math.min(this.numProjectiveTextures,this.x3d_MaxTextures))},setGlobalUniforms:function(e,t,n,r,o){const s=t.getGlobalObjects();e.uniform4iv(this.x3d_Viewport,o),e.uniformMatrix4fv(this.x3d_ProjectionMatrix,!1,r),e.uniformMatrix4fv(this.x3d_CameraSpaceMatrix,!1,n),this.fogNode=null,this.numLights=0,this.numProjectiveTextures=0,this.lightNodes.length=0,this.projectiveTextureNodes.length=0;for(const t of s)t.setShaderUniforms(e,this);this.numGlobalLights=this.numLights,this.numGlobalProjectiveTextures=this.numProjectiveTextures;const a=t.getViewpoint(),u=t.getNavigationInfo();a instanceof i?e.uniform1f(this.x3d_LogarithmicFarFactor1_2,-1):e.uniform1f(this.x3d_LogarithmicFarFactor1_2,1/Math.log2(u.getFarValue(a)+1))},setLocalUniforms:function(e,t,i=!0){const n=t.shapeNode,r=t.geometryContext||n.getGeometry(),o=r.geometryType,s=r.textureCoordinateNode,a=n.getAppearance(),u=a.stylePropertiesNode[o],l=i?a.materialNode:a.backMaterialNode,c=t.textureNode||a.textureNode,h=a.textureTransformNode,d=t.modelViewMatrix,p=t.localObjects;e.uniformMatrix4fv(this.x3d_ModelViewMatrix,!1,d),e.uniform1i(this.x3d_GeometryType,o),this.numClipPlanes=0,this.numLights=this.numGlobalLights,this.numProjectiveTextures=this.numGlobalProjectiveTextures;for(const t of p)t.setShaderUniforms(e,this);e.uniform1i(this.x3d_NumClipPlanes,Math.min(this.numClipPlanes,this.x3d_MaxClipPlanes)),e.uniform1i(this.x3d_NumLights,Math.min(this.numLights,this.x3d_MaxLights)),e.uniform1i(this.x3d_NumProjectiveTextures,Math.min(this.numProjectiveTextures,this.x3d_MaxTextures)),t.fogNode.setShaderUniforms(e,this),e.uniform1i(this.x3d_FogCoord,r.fogCoords),e.uniform1f(this.x3d_AlphaCutoff,a.alphaCutoff),u.setShaderUniforms(e,this),e.uniform1i(this.x3d_ColorMaterial,r.colorMaterial),l.setShaderUniforms(e,this,i),e.uniformMatrix3fv(this.x3d_NormalMatrix,!1,this.getNormalMatrix(d)),c?(c.setShaderUniforms(e,this,t.renderer),h.setShaderUniforms(e,this),s.setShaderUniforms(e,this)):(e.uniform1i(this.x3d_NumTextures,0),this.getCustom()&&(h.setShaderUniforms(e,this),s.setShaderUniforms(e,this)))},getNormalMatrix:function(){const e=new Float32Array(9);return function(t){try{return e[0]=t[0],e[3]=t[1],e[6]=t[2],e[1]=t[4],e[4]=t[5],e[7]=t[6],e[2]=t[8],e[5]=t[9],e[8]=t[10],n.prototype.inverse.call(e),e}catch(t){return e.set(n.Identity),e}}}(),enable:function(e){const t=this.getBrowser();this.textures.forEach(function(i,n){const r=i.name,o=i.texture;if(!t.getCombinedTextureUnits().length)return void console.warn("Not enough combined texture units for uniform variable '"+r+"' available.");const s=i.textureUnit=t.getCombinedTextureUnits().pop();e.uniform1i(n,s),e.activeTexture(e.TEXTURE0+s),e.bindTexture(o.getTarget(),o.getTexture())}),e.activeTexture(e.TEXTURE0)},disable:function(e){const t=this.getBrowser();this.textures.forEach(function(e){const i=e.textureUnit;void 0!==i&&t.getCombinedTextureUnits().push(i),e.textureUnit=void 0})},enableFloatAttrib:function(e,t,i,n){const r=e.getAttribLocation(this.getProgram(),t);r!==-1&&(e.enableVertexAttribArray(r),e.bindBuffer(e.ARRAY_BUFFER,i),e.vertexAttribPointer(r,n,e.FLOAT,!1,0,0))},disableFloatAttrib:function(e,t){const i=e.getAttribLocation(this.getProgram(),t);i!==-1&&e.disableVertexAttribArray(i)},enableMatrix3Attrib:function(e,t,i){const n=e.getAttribLocation(this.getProgram(),t);n!==-1&&(e.enableVertexAttribArray(n),e.enableVertexAttribArray(n+1),e.enableVertexAttribArray(n+2),e.bindBuffer(e.ARRAY_BUFFER,i),e.vertexAttribPointer(n,3,e.FLOAT,!1,36,0),e.vertexAttribPointer(n+1,3,e.FLOAT,!1,36,12),e.vertexAttribPointer(n+2,3,e.FLOAT,!1,36,24))},disableMatrix3Attrib:function(e,t){const i=e.getAttribLocation(this.getProgram(),t);i!==-1&&(e.disableVertexAttribArray(i),e.disableVertexAttribArray(i+1),e.disableVertexAttribArray(i+2))},enableMatrix4Attrib:function(e,t,i){const n=e.getAttribLocation(this.getProgram(),t);n!==-1&&(e.enableVertexAttribArray(n),e.enableVertexAttribArray(n+1),e.enableVertexAttribArray(n+2),e.enableVertexAttribArray(n+3),e.bindBuffer(e.ARRAY_BUFFER,i),e.vertexAttribPointer(n,4,e.FLOAT,!1,64,0),e.vertexAttribPointer(n+1,4,e.FLOAT,!1,64,16),e.vertexAttribPointer(n+2,4,e.FLOAT,!1,64,32),e.vertexAttribPointer(n+3,4,e.FLOAT,!1,64,48))},disableMatrix4Attrib:function(e,t){const i=e.getAttribLocation(this.getProgram(),t);i!==-1&&(e.disableVertexAttribArray(i),e.disableVertexAttribArray(i+1),e.disableVertexAttribArray(i+2),e.disableVertexAttribArray(i+3))},enableFogDepthAttribute:function(e,t){e.enableVertexAttribArray(this.x3d_FogDepth),e.bindBuffer(e.ARRAY_BUFFER,t),e.vertexAttribPointer(this.x3d_FogDepth,1,e.FLOAT,!1,0,0)},disableFogDepthAttribute:function(e){e.disableVertexAttribArray(this.x3d_FogDepth)},enableColorAttribute:function(e,t){e.enableVertexAttribArray(this.x3d_Color),e.bindBuffer(e.ARRAY_BUFFER,t),e.vertexAttribPointer(this.x3d_Color,4,e.FLOAT,!1,0,0)},disableColorAttribute:function(e){e.disableVertexAttribArray(this.x3d_Color)},enableTexCoordAttribute:function(e,t,i){const n=Math.min(this.x3d_MaxTextures,t.length);for(let i=0;i<n;++i){const n=this.x3d_TexCoord[i];n!==-1&&(e.enableVertexAttribArray(n),e.bindBuffer(e.ARRAY_BUFFER,t[i]),e.vertexAttribPointer(n,4,e.FLOAT,!1,0,0))}},disableTexCoordAttribute:function(e){for(let t=0,i=this.x3d_MaxTextures;t<i;++t){const i=this.x3d_TexCoord[t];i!==-1&&e.disableVertexAttribArray(i)}},enableNormalAttribute:function(e,t){e.enableVertexAttribArray(this.x3d_Normal),e.bindBuffer(e.ARRAY_BUFFER,t),e.vertexAttribPointer(this.x3d_Normal,3,e.FLOAT,!1,0,0)},disableNormalAttribute:function(e){e.disableVertexAttribArray(this.x3d_Normal)},enableVertexAttribute:function(e,t){e.enableVertexAttribArray(this.x3d_Vertex),e.bindBuffer(e.ARRAY_BUFFER,t),e.vertexAttribPointer(this.x3d_Vertex,4,e.FLOAT,!1,0,0)},disableVertexAttribute:function(e){e.disableVertexAttribArray(this.x3d_Vertex)},setParticle:function(e,t,i){e.uniformMatrix4fv(this.x3d_ModelViewMatrix,!1,i),e.uniform1i(this.x3d_ParticleId,t.id),e.uniform1i(this.x3d_ParticleLife,t.life),e.uniform1f(this.x3d_ParticleElapsedTime,t.elapsedTime/t.lifetime)},getProgramInfo:function(){function e(e,t){return e<t?-1:e>t?1:0}const t=this.getBrowser().getContext(),i=this.getProgram(),n={attributes:[],uniforms:[],attributeCount:0,uniformCount:0},r=t.getProgramParameter(i,t.ACTIVE_UNIFORMS),o=t.getProgramParameter(i,t.ACTIVE_ATTRIBUTES),s={35664:"vec2",35665:"vec3",35666:"vec4",35667:"ivec2",35668:"ivec3",35669:"ivec4",35670:"bool",35671:"bvec2",35672:"bvec3",35673:"bvec4",35674:"mat2",35675:"mat3",35676:"mat4",35678:"sampler2D",35680:"samplerCube",5120:"byte",5121:"ubyte",5122:"short",5123:"ushort",5124:"int",5125:"uint",5126:"float"};for(let e=0;e<r;++e){const r=t.getActiveUniform(i,e);r.typeName=s[r.type],n.uniforms.push(Object.assign({},r)),n.uniformCount+=r.size}for(let e=0;e<o;++e){const r=t.getActiveAttrib(i,e);r.typeName=s[r.type],n.attributes.push(Object.assign({},r)),n.attributeCount+=r.size}return n.uniforms.sort(function(t,i){return e(t.name,i.name)}),n.attributes.sort(function(t,i){return e(t.name,i.name)}),n},printProgramInfo:function(){const e=this.getProgramInfo();console.log(this.getName()),console.table(e.attributes),console.log(this.getName(),"attributeCount",e.attributeCount),console.log(this.getName()),console.table(e.uniforms),console.log(this.getName(),"uniformCount",e.uniformCount)}},r}),define("x_ite/Components/Networking/X3DNetworkSensorNode",["x_ite/Components/Core/X3DSensorNode","x_ite/Base/X3DConstants"],function(e,t){"use strict";function i(i){e.call(this,i),this.addType(t.X3DNetworkSensorNode)}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i}),i}),define("x_ite/Components/Networking/LoadSensor",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Networking/X3DNetworkSensorNode","x_ite/Base/X3DCast","x_ite/Base/X3DConstants"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),this.addType(o.LoadSensor),this.urlObjects=[],this.aborted=!1,this.timeOutId=void 0}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOutput,"enabled",new e.SFBool(!0)),new t(o.inputOutput,"timeOut",new e.SFTime),new t(o.outputOnly,"isActive",new e.SFBool),new t(o.outputOnly,"isLoaded",new e.SFBool),new t(o.outputOnly,"progress",new e.SFFloat),new t(o.outputOnly,"loadTime",new e.SFTime),new t(o.inputOutput,"watchList",new e.MFNode)]),getTypeName:function(){return"LoadSensor"},getComponentName:function(){return"Networking"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.enabled_.addInterest("set_enabled__",this),this.timeOut_.addInterest("set_timeOut__",this),this.watchList_.addInterest("set_watchList__",this),this.watchList_.addEvent()},set_enabled__:function(){this.enabled_.getValue()?this.reset():(this.abort(),this.remove())},set_timeOut__:function(){this.isActive_.getValue()&&(this.clearTimeout(),this.aborted=!1,this.timeOut_.getValue()>0&&(this.timeOutId=setTimeout(this.abort.bind(this),1e3*this.timeOut_.getValue())))},set_watchList__:function(){this.reset()},set_loadState__:function(e,t){switch(t.checkLoadState()){case o.NOT_STARTED_STATE:break;case o.IN_PROGRESS_STATE:case o.COMPLETE_STATE:case o.FAILED_STATE:this.count()}},count:function(){for(var e=0,t=0,i=this.urlObjects,n=0,r=i.length;n<r;++n){var s=i[n];e+=s.checkLoadState()==o.COMPLETE_STATE,t+=s.checkLoadState()==o.FAILED_STATE}var a=e==i.length,u=e/i.length;this.aborted||t||a?(this.clearTimeout(),this.isActive_=!1,this.isLoaded_=a,this.progress_=u,a&&(this.loadTime_=this.getBrowser().getCurrentTime())):this.isActive_.getValue()?this.progress_=u:(this.isActive_=!0,this.progress_=u,this.set_timeOut__())},abort:function(){this.clearTimeout(),this.aborted=!0,this.enabled_.getValue()&&this.count()},reset:function(){if(this.remove(),this.enabled_.getValue()){for(var e=this.watchList_.getValue(),t=this.urlObjects,i=0,n=e.length;i<n;++i){var s=r(o.X3DUrlObject,e[i]);s&&(t.push(s),s.loadState_.addInterest("set_loadState__",this,s))}this.count()}},remove:function(){this.clearTimeout();for(var e=this.urlObjects,t=0,i=e.length;t<i;++t)e[t].loadState_.removeInterest("set_loadState__",this);e.length=0},clearTimeout:function(){clearTimeout(this.timeOutId),this.timeOutId=void 0}}),s}),define("x_ite/Components/Shaders/ComposedShader",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Shaders/X3DShaderNode","x_ite/Components/Shaders/X3DProgrammableShaderObject","x_ite/Components/Networking/LoadSensor","x_ite/Base/X3DCast","x_ite/Base/X3DConstants"],function(e,t,i,n,r,o,s,a){"use strict";function u(e){n.call(this,e),r.call(this,e),this.addType(a.ComposedShader),this.loadSensor=new o(e)}return u.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:u,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(a.inputOutput,"metadata",new e.SFNode),new t(a.inputOnly,"activate",new e.SFBool),new t(a.outputOnly,"isSelected",new e.SFBool),new t(a.outputOnly,"isValid",new e.SFBool),new t(a.initializeOnly,"language",new e.SFString),new t(a.inputOutput,"parts",new e.MFNode)]),wireframe:!1,getTypeName:function(){return"ComposedShader"},getComponentName:function(){return"Shaders"},getContainerField:function(){return"shaders"},initialize:function(){n.prototype.initialize.call(this),r.prototype.initialize.call(this);var e=this.getBrowser().getContext();this.primitiveMode=e.TRIANGLES,this.isLive().addInterest("set_live__",this),this.parts_.addFieldInterest(this.loadSensor.watchList_),this.loadSensor.isLoaded_.addInterest("set_loaded__",this),this.loadSensor.watchList_=this.parts_,this.loadSensor.setPrivate(!0),this.loadSensor.setup()},getProgram:function(){return this.program},set_live__:function(){var e=this.getBrowser().getContext();this.isLive().getValue()?this.getValid()&&(this.enable(e),this.addShaderFields(),this.disable(e)):this.getValid()&&(this.enable(e),this.removeShaderFields(),this.disable(e))},set_loaded__:function(){if(this.loadSensor.isLoaded_.getValue()){var e=this.getBrowser().getContext(),t=e.createProgram(),i=this.parts_.getValue(),n=0;this.getValid()&&this.removeShaderFields(),this.program=t;for(var r=0,o=i.length;r<o;++r){var u=s(a.ShaderPart,i[r]);u&&(n+=u.isValid(),e.attachShader(t,u.getShader()))}n&&(this.bindAttributeLocations(e,t),e.linkProgram(t),n=e.getProgramParameter(t,e.LINK_STATUS)),n?(e.useProgram(this.program),this.getDefaultUniforms()?this.addShaderFields():n=!1):console.warn("Couldn't initialize "+this.getTypeName()+" '"+this.getName()+"': "+e.getProgramInfoLog(t)),this.setValid(Boolean(n))}else this.setValid(!1)},set_field__:function(e){this.getBrowser().getContext().useProgram(this.program),r.prototype.set_field__.call(this,e)},setGlobalUniforms:function(e,t,i,n,o){e.useProgram(this.program),r.prototype.setGlobalUniforms.call(this,e,t,i,n,o)},enable:function(e){e.useProgram(this.program),r.prototype.enable.call(this,e)}}),u}),define("text!assets/shaders/Types.glsl",[],function(){
return"\nstruct x3d_FogParameters {\n   mediump int   type;\n   mediump vec3  color;\n   mediump float visibilityRange;\n   mediump mat3  matrix;\n   bool          fogCoord;\n};\n\n//uniform x3d_FogParameters x3d_Fog;\n\nstruct x3d_LightSourceParameters {\n   mediump int   type;\n   mediump vec3  color;\n   mediump float intensity;\n   mediump float ambientIntensity;\n   mediump vec3  attenuation;\n   mediump vec3  location;\n   mediump vec3  direction;\n   mediump float radius;\n   mediump float beamWidth;\n   mediump float cutOffAngle;\n   mediump mat3  matrix;\n   #ifdef X3D_SHADOWS\n   mediump vec3  shadowColor;\n   mediump float shadowIntensity;\n   mediump float shadowBias;\n   mediump mat4  shadowMatrix;\n   mediump int   shadowMapSize;\n   #endif\n};\n\n//uniform x3d_LightSourceParameters x3d_LightSource [x3d_MaxLights];\n\nstruct x3d_PointPropertiesParameters\n{\n   mediump float pointSizeScaleFactor;\n   mediump float pointSizeMinValue;\n   mediump float pointSizeMaxValue;\n   mediump vec3  pointSizeAttenuation;\n   mediump int   colorMode;\n};\n\n//uniform x3d_PointPropertiesParameters x3d_PointProperties;\n\nstruct x3d_LinePropertiesParameters\n{\n   bool          applied;\n   mediump float linewidthScaleFactor;\n   sampler2D     linetype;\n};\n\n//uniform x3d_LinePropertiesParameters x3d_LineProperties;\n\nstruct x3d_FillPropertiesParameters\n{\n   bool         filled;\n   bool         hatched;\n   mediump vec3 hatchColor;\n   sampler2D    hatchStyle;\n};\n\n//uniform x3d_FillPropertiesParameters x3d_FillProperties;\n\nstruct x3d_MaterialParameters\n{\n   mediump float ambientIntensity;\n   mediump vec3  diffuseColor;\n   mediump vec3  specularColor;\n   mediump vec3  emissiveColor;\n   mediump float shininess;\n   mediump float transparency;\n};\n\n//uniform x3d_MaterialParameters x3d_Material;\n\nstruct x3d_MultiTextureParameters\n{\n   mediump int mode;\n   mediump int alphaMode;\n   mediump int source;\n   mediump int function;\n};\n\n//uniform x3d_MultiTextureParameters x3d_MultiTexture [x3d_MaxTextures];\n\nstruct x3d_TextureCoordinateGeneratorParameters\n{\n   mediump int   mode;\n   mediump float parameter [6];\n};\n\n//uniform x3d_TextureCoordinateGeneratorParameters x3d_TextureCoordinateGenerator [x3d_MaxTextures];\n\nstruct x3d_ParticleParameters\n{\n   mediump int   id;\n   mediump int   life;\n   mediump float elapsedTime;\n};\n\n//uniform x3d_ParticleParameters x3d_Particle;\n"}),define("x_ite/Browser/Texturing/MultiTextureModeType",[],function(){"use strict";let e=0;return{REPLACE:e++,MODULATE:e++,MODULATE2X:e++,MODULATE4X:e++,ADD:e++,ADDSIGNED:e++,ADDSIGNED2X:e++,ADDSMOOTH:e++,SUBTRACT:e++,BLENDDIFFUSEALPHA:e++,BLENDTEXTUREALPHA:e++,BLENDFACTORALPHA:e++,BLENDCURRENTALPHA:e++,MODULATEALPHA_ADDCOLOR:e++,MODULATEINVALPHA_ADDCOLOR:e++,MODULATEINVCOLOR_ADDALPHA:e++,DOTPRODUCT3:e++,SELECTARG1:e++,SELECTARG2:e++,OFF:e++}}),define("x_ite/Browser/Texturing/MultiTextureSourceType",[],function(){"use strict";let e=0;return{DEFAULT:e++,DIFFUSE:e++,SPECULAR:e++,FACTOR:e++}}),define("x_ite/Browser/Texturing/MultiTextureFunctionType",[],function(){"use strict";let e=0;return{DEFAULT:e++,COMPLEMENT:e++,ALPHAREPLICATE:e++}}),define("x_ite/Browser/Texturing/TextureCoordinateGeneratorModeType",[],function(){"use strict";let e=0;return{NONE:e++,SPHERE:e++,CAMERASPACENORMAL:e++,CAMERASPACEPOSITION:e++,CAMERASPACEREFLECTIONVECTOR:e++,SPHERE_LOCAL:e++,COORD:e++,COORD_EYE:e++,NOISE:e++,NOISE_EYE:e++,SPHERE_REFLECT:e++,SPHERE_REFLECT_LOCAL:e++}}),define("x_ite/Browser/Shaders/Shader",["x_ite/Browser/Shaders/ShaderSource","text!assets/shaders/Types.glsl","x_ite/Browser/Texturing/MultiTextureModeType","x_ite/Browser/Texturing/MultiTextureSourceType","x_ite/Browser/Texturing/MultiTextureFunctionType","x_ite/Browser/Texturing/TextureCoordinateGeneratorModeType"],function(e,t,i,n,r,o){"use strict";function s(e,t,i){e.indexOf(t)!==-1&&console.warn("Use of '"+t+"' is depreciated, use '"+i+"' instead. See https://create3000.github.io/x_ite/Custom-Shaders.html.")}return{getShaderSource:function(a,u,l,c){const h=a.getContext();l=e.get(h,l);const d=new RegExp("^((?:\\s+|/\\*[^]*?\\*/|//.*?\\n)?(?:#version\\s+.*?\\n)?)([^]*)$"),p=l.match(d);if(!p)return l;let f="";f+="#define X_ITE\n",a.getRenderingProperty("LogarithmicDepthBuffer")&&(f+="#define X3D_LOGARITHMIC_DEPTH_BUFFER\n"),(h.getVersion()>=2||a.getExtension("WEBGL_depth_texture"))&&(f+="#define X3D_DEPTH_TEXTURE\n"),a.getMultiTexturing()&&(f+="#define X3D_MULTI_TEXTURING\n"),a.getProjectiveTextureMapping()&&(f+="#define X3D_PROJECTIVE_TEXTURE_MAPPING\n"),c&&(f+="#define X3D_SHADOWS\n",f+="#define X3D_PCF_FILTERING\n");let g="";g+="#define x3d_None 0\n",g+="#define x3d_Points      0\n",g+="#define x3d_Lines       1\n",g+="#define x3d_Geometry2D  2\n",g+="#define x3d_Geometry3D  3\n",g+="#define x3d_MaxClipPlanes  "+a.getMaxClipPlanes()+"\n",g+="#define x3d_LinearFog        1\n",g+="#define x3d_ExponentialFog   2\n",g+="#define x3d_Exponential2Fog  3\n",g+="#define x3d_MaxLights         "+a.getMaxLights()+"\n",g+="#define x3d_DirectionalLight  1\n",g+="#define x3d_PointLight        2\n",g+="#define x3d_SpotLight         3\n",g+="#define x3d_MaxTextures                "+a.getMaxTextures()+"\n",g+="#define x3d_TextureType2D              2\n",g+="#define x3d_TextureType3D              3\n",g+="#define x3d_TextureTypeCubeMapTexture  4\n",g+="#define x3d_PointColor           0\n",g+="#define x3d_TextureColor         1\n",g+="#define x3d_TextureAndPointColor 2\n",g+="#define x3d_Replace                   "+i.REPLACE+"\n",g+="#define x3d_Modulate                  "+i.MODULATE+"\n",g+="#define x3d_Modulate2X                "+i.MODULATE2X+"\n",g+="#define x3d_Modulate4X                "+i.MODULATE4X+"\n",g+="#define x3d_Add                       "+i.ADD+"\n",g+="#define x3d_AddSigned                 "+i.ADDSIGNED+"\n",g+="#define x3d_AddSigned2X               "+i.ADDSIGNED2X+"\n",g+="#define x3d_AddSmooth                 "+i.ADDSMOOTH+"\n",g+="#define x3d_Subtract                  "+i.SUBTRACT+"\n",g+="#define x3d_BlendDiffuseAlpha         "+i.BLENDDIFFUSEALPHA+"\n",g+="#define x3d_BlendTextureAlpha         "+i.BLENDTEXTUREALPHA+"\n",g+="#define x3d_BlendFactorAlpha          "+i.BLENDFACTORALPHA+"\n",g+="#define x3d_BlendCurrentAlpha         "+i.BLENDCURRENTALPHA+"\n",g+="#define x3d_ModulateAlphaAddColor     "+i.MODULATEALPHA_ADDCOLOR+"\n",g+="#define x3d_ModulateInvAlphaAddColor  "+i.MODULATEINVALPHA_ADDCOLOR+"\n",g+="#define x3d_ModulateInvColorAddAlpha  "+i.MODULATEINVCOLOR_ADDALPHA+"\n",g+="#define x3d_DotProduct3               "+i.DOTPRODUCT3+"\n",g+="#define x3d_SelectArg1                "+i.SELECTARG1+"\n",g+="#define x3d_SelectArg2                "+i.SELECTARG2+"\n",g+="#define x3d_Off                       "+i.OFF+"\n",g+="#define x3d_Diffuse  "+n.DIFFUSE+"\n",g+="#define x3d_Specular "+n.SPECULAR+"\n",g+="#define x3d_Factor   "+n.FACTOR+"\n",g+="#define x3d_Complement     "+r.COMPLEMENT+"\n",g+="#define x3d_AlphaReplicate "+r.ALPHAREPLICATE+"\n",g+="#define x3d_Sphere                      "+o.SPHERE+"\n",g+="#define x3d_CameraSpaceNormal           "+o.CAMERASPACENORMAL+"\n",g+="#define x3d_CameraSpacePosition         "+o.CAMERASPACEPOSITION+"\n",g+="#define x3d_CameraSpaceReflectionVector "+o.CAMERASPACEREFLECTIONVECTOR+"\n",g+="#define x3d_SphereLocal                 "+o.SPHERE_LOCAL+"\n",g+="#define x3d_Coord                       "+o.COORD+"\n",g+="#define x3d_CoordEye                    "+o.COORD_EYE+"\n",g+="#define x3d_Noise                       "+o.NOISE+"\n",g+="#define x3d_NoiseEye                    "+o.NOISE_EYE+"\n",g+="#define x3d_SphereReflect               "+o.SPHERE_REFLECT+"\n",g+="#define x3d_SphereReflectLocal          "+o.SPHERE_REFLECT_LOCAL+"\n",g+="#define x3d_GeometryPoints  0\n",g+="#define x3d_GeometryLines   1\n",g+="#define x3d_NoneClipPlane   vec4 (88.0, 51.0, 68.0, 33.0)\n",g+="#define x3d_NoneFog         0\n",g+="#define x3d_NoneLight       0\n",g+="#define x3d_NoneTexture     0\n",s(l,"x3d_GeometryPoints","x3d_Points"),s(l,"x3d_GeometryLines","x3d_Lines"),s(l,"x3d_NoneClipPlane","x3d_NumClipPlanes"),s(l,"x3d_NoneFog","x3d_None"),s(l,"x3d_NoneLight","x3d_NumLights"),s(l,"x3d_NoneTexture","x3d_NumTextures");const m=l.match(/\s*precision\s+(lowp|mediump|highp)\s+float\s*;/),y=l.match(/\s*precision\s+(lowp|mediump|highp)\s+int\s*;/),_=m?m[1]:"mediump",x=y?y[1]:"mediump",w=t.replace(/mediump\s+(float|vec2|vec3|mat3|mat4)/g,_+" $1").replace(/mediump\s+(int)/g,x+" $1"),b=(p[1].match(/\n/g)||[]).length+1;return p[1]+f+g+w+"#line "+b+"\n"+p[2]}}}),define("x_ite/Parser/XMLParser",["jquery","x_ite/Base/X3DField","x_ite/Base/X3DBaseNode","x_ite/Components/Core/X3DPrototypeInstance","x_ite/Fields","x_ite/Parser/Parser","x_ite/Parser/X3DParser","x_ite/Parser/HTMLSupport","x_ite/Prototype/X3DExternProtoDeclaration","x_ite/Prototype/X3DProtoDeclaration","x_ite/Base/X3DConstants"],function(e,t,i,n,r,o,s,a,u,l,c){"use strict";function h(e){s.call(this,e),this.protoDeclarations=[],this.parents=[],this.parser=new o(e),this.url=new r.MFString;try{this.setUnits(this.getScene().getMetaData("generator")),this.parser.setUnits(this.getUnits())}catch(e){}}function d(e){return e.replace(w,"").split(b)}function p(e){return e.replace(_,"Infinity").replace(x,"NaN").replace(w,"").split(b)}function f(e){return e.replace(w,"").split(b)}function g(e){for(var t=null,i=[];t=v.exec(e);)i.push(t[1]);return i.map(r.SFString.unescape)}const m=Symbol.for("X_ITE.dom"),y={initializeOnly:c.initializeOnly,inputOnly:c.inputOnly,outputOnly:c.outputOnly,inputOutput:c.inputOutput};h.prototype=Object.assign(Object.create(s.prototype),{constructor:h,parseIntoScene:function(e,t,i){this.scene[m]=e,this.success=t,this.error=i,this.getScene().setEncoding("XML"),this.getScene().setProfile(this.getBrowser().getProfile("Full")),this.xmlElement(e)},parseIntoNode:function(e,t){this.pushExecutionContext(e.getExecutionContext()),this.pushParent(e),this.childElement(t),this.popParent(),this.popExecutionContext()},xmlElement:function(t){if(null===t&&this.success)return this.success(this.getScene());switch(t.nodeName){case"#document":var i=e(t).children("X3D");if(i.length)for(var n=0;n<i.length;++n)this.x3dElement(i[n]);else this.success?require(this.getProviderUrls(),function(){try{this.childrenElements(t),this.success(this.getScene())}catch(e){this.error&&this.error(e)}}.bind(this),function(e){this.error&&this.error(e)}.bind(this)):this.childrenElements(t);break;case"X3D":this.x3dElement(t);break;case"Scene":case"SCENE":this.success?require(this.getProviderUrls(),function(){try{this.sceneElement(t),this.success(this.getScene())}catch(e){this.error&&this.error(e)}}.bind(this),function(e){this.error&&this.error(e)}.bind(this)):this.sceneElement(t);break;default:this.success?require(this.getProviderUrls(),function(){try{this.childrenElements(t),this.success(this.getScene())}catch(e){this.error&&this.error(e)}}.bind(this),function(e){this.error&&this.error(e)}.bind(this)):this.childrenElements(t)}},x3dElement:function(e){try{var t=e.getAttribute("profile"),i=this.getBrowser().getProfile(t||"Full");this.getScene().setProfile(i)}catch(e){console.log(e)}var n=e.getAttribute("version");n&&this.getScene().setSpecificationVersion(n);for(var r=e.childNodes,o=0;o<r.length;++o)this.x3dElementChildHead(r[o]);if(this.success)require(this.getProviderUrls(),function(){try{for(var e=0;e<r.length;++e)this.x3dElementChildScene(r[e]);this.success(this.getScene())}catch(e){this.error&&this.error(e)}}.bind(this),function(e){this.error&&this.error(e)}.bind(this));else for(var o=0;o<r.length;++o)this.x3dElementChildScene(r[o])},x3dElementChildHead:function(e){switch(e.nodeName){case"head":case"HEAD":return void this.headElement(e)}},x3dElementChildScene:function(e){switch(e.nodeName){case"Scene":case"SCENE":return void this.sceneElement(e)}},headElement:function(e){for(var t=e.childNodes,i=0;i<t.length;++i)this.headElementChild(t[i]);try{this.setUnits(this.getScene().getMetaData("generator")),this.parser.setUnits(this.getUnits())}catch(e){}},headElementChild:function(e){switch(e.nodeName){case"component":case"COMPONENT":return void this.componentElement(e);case"unit":case"UNIT":return void this.unitElement(e);case"meta":case"META":return void this.metaElement(e)}},componentElement:function(e){try{var t=e.getAttribute("name"),i=parseInt(e.getAttribute("level"));if(null===t)return console.warn("XML Parser Error: Bad component statement: Expected name attribute.");if(null===i)return console.warn("XML Parser Error: Bad component statement: Expected level attribute.");var n=this.getBrowser().getComponent(t,i);this.getScene().addComponent(n)}catch(e){console.log(e.message)}},unitElement:function(e){var t=e.getAttribute("category"),i=e.getAttribute("name"),n=e.getAttribute("conversionFactor");return null===t?console.warn("XML Parser Error: Bad unit statement: Expected category attribute."):null===i?console.warn("XML Parser Error: Bad unit statement: Expected name attribute."):null===n?console.warn("XML Parser Error: Bad unit statement: Expected conversionFactor attribute."):void this.getScene().updateUnit(t,i,parseFloat(n))},metaElement:function(e){var t=e.getAttribute("name"),i=e.getAttribute("content");return null===t?console.warn("XML Parser Error: Bad meta statement: Expected name attribute."):null===i?console.warn("XML Parser Error: Bad meta statement: Expected content attribute."):void this.getScene().setMetaData(t,i)},sceneElement:function(e){this.childrenElements(e)},childrenElements:function(e){for(var t=e.childNodes,i=0;i<t.length;++i)this.childElement(t[i])},childElement:function(e){switch(e.nodeName){case"#comment":case"#text":return;case"#cdata-section":return void this.cdataNode(e);case"ExternProtoDeclare":case"EXTERNPROTODECLARE":return void this.externProtoDeclareElement(e);case"ProtoDeclare":case"PROTODECLARE":return void this.protoDeclareElement(e);case"IS":return void this.isElement(e);case"ProtoInstance":case"PROTOINSTANCE":return void this.protoInstanceElement(e);case"fieldValue":case"FIELDVALUE":return void this.fieldValueElement(e);case"field":case"FIELD":return void this.fieldElement(e);case"ROUTE":return void this.routeElement(e);case"IMPORT":return void this.importElement(e);case"EXPORT":return void this.exportElement(e);default:return void this.nodeElement(e)}},externProtoDeclareElement:function(e){var t=e.getAttribute("name");if(this.id(t)){var i=e.getAttribute("url");if(null===i)return console.warn("XML Parser Error: Bad ExternProtoDeclare statement: Expected url attribute.");this.parser.setInput(i),o.prototype.sfstringValues.call(this.parser,this.url);var n=new u(this.getExecutionContext(),this.url);this.pushParent(n),this.protoInterfaceElement(e),this.popParent(),n.setup();try{const e=this.getExecutionContext().getExternProtoDeclaration(t);this.getExecutionContext().updateExternProtoDeclaration(this.getExecutionContext().getUniqueExternProtoName(t),e)}catch(e){}this.getExecutionContext().updateExternProtoDeclaration(t,n)}},protoDeclareElement:function(e){var t=e.getAttribute("name");if(this.id(t)){for(var i=new l(this.getExecutionContext()),n=e.childNodes,r=0;r<n.length;++r){var o=n[r];switch(o.nodeName){case"ProtoInterface":case"PROTOINTERFACE":this.pushParent(i),this.protoInterfaceElement(o),this.popParent();break;default:continue}break}for(var r=0;r<n.length;++r){var o=n[r];switch(o.nodeName){case"ProtoBody":case"PROTOBODY":this.pushPrototype(i),this.pushExecutionContext(i.getBody()),this.pushParent(i),this.protoBodyElement(o),this.popParent(),this.popExecutionContext(),this.popPrototype();break;default:continue}break}i.setup();try{const e=this.getExecutionContext().getProtoDeclaration(t);this.getExecutionContext().updateProtoDeclaration(this.getExecutionContext().getUniqueProtoName(t),e)}catch(e){}this.getExecutionContext().updateProtoDeclaration(t,i)}},protoInterfaceElement:function(e){for(var t=e.childNodes,i=0;i<t.length;++i)this.protoInterfaceElementChild(t[i])},protoInterfaceElementChild:function(e){switch(e.nodeName){case"field":case"FIELD":return void this.fieldElement(e)}},fieldElement:function(e){try{if(0===this.getParents().length)return;var t=this.getParent();if(!(t instanceof i))return;if(!t.canUserDefinedFields())return;var n=y[e.getAttribute("accessType")];void 0===n&&(n=c.initializeOnly);var o=r[e.getAttribute("type")];if(void 0===o)return;var s=e.getAttribute("name");if(!this.id(s))return;var a=new o;n&c.initializeOnly&&(this.fieldValue(a,e.getAttribute("value")),this.pushParent(a),this.childrenElements(e),this.popParent()),t.addUserDefinedField(n,s,a)}catch(e){}},protoBodyElement:function(e){this.childrenElements(e)},isElement:function(e){if(this.isInsideProtoDefinition())for(var t=e.childNodes,i=0;i<t.length;++i)this.isElementChild(t[i])},isElementChild:function(e){switch(e.nodeName){case"connect":case"CONNECT":return void this.connectElement(e)}},connectElement:function(e){var t=e.getAttribute("nodeField"),n=e.getAttribute("protoField");if(null===t)return console.warn("XML Parser Error: Bad connect statement: Expected nodeField attribute.");if(null===n)return console.warn("XML Parser Error: Bad connect statement: Expected protoField attribute.");try{if(0===this.getParents().length)return;var r=this.getParent(),o=this.getPrototype();if(!(r instanceof i))return;var s=r.getField(t),a=o.getField(n);if(s.getType()!==a.getType())throw new Error("Field '"+s.getName()+"' and '"+a.getName()+"' in PROTO "+this.proto.getName()+" have different types.");if(!a.isReference(s.getAccessType()))throw new Error("Field '"+s.getName()+"' and '"+a.getName()+"' in PROTO "+o.getName()+" are incompatible as an IS mapping.");s.addReference(a)}catch(e){console.warn("XML Parser Error: Couldn't create IS reference: "+e.message)}},protoInstanceElement:function(e){try{if(this.useAttribute(e))return;var t=e.getAttribute("name");if(this.id(t)){var i=this.getExecutionContext().createProto(t,!1);if(!i)throw new Error("Unknown proto or externproto type '"+t+"'.");e.x3d=i,this.defAttribute(e,i),this.addNode(e,i),this.pushParent(i),this.childrenElements(e),this.isInsideProtoDefinition()||i.setup(),this.popParent()}}catch(e){console.warn("XML Parser Error: ",e.message)}},fieldValueElement:function(e){try{if(0===this.getParents().length)return;var t=this.getParent(),i=e.getAttribute("name");if(!(t instanceof n))return;if(!this.id(i))return;var r=t.getField(i);r.getAccessType()&c.initializeOnly&&(r.getType()===c.MFNode&&(r.length=0),this.fieldValue(r,e.getAttribute("value")),this.pushParent(r),this.childrenElements(e),this.popParent())}catch(e){console.warn("XML Parser Error: Couldn't assign field value: "+e.message)}},nodeElement:function(e){try{if(this.useAttribute(e))return;var t=this.getExecutionContext().createNode(this.nodeNameToCamelCase(e.nodeName),!1);if(!t)throw new Error("Unknown node type '"+e.nodeName+"', you probably have insufficient component/profile statements.");e.x3d=t,this.defAttribute(e,t),this.addNode(e,t),this.pushParent(t),this.nodeAttributes(e,t),this.childrenElements(e),this.isInsideProtoDefinition()||t.setup(),this.popParent()}catch(t){if("NULL"==e.nodeName)return void this.addNode(e,null);console.error("XML Parser Error: "+t.message)}},routeElement:function(e){try{var t=e.getAttribute("fromNode"),i=e.getAttribute("fromField"),n=e.getAttribute("toNode"),r=e.getAttribute("toField");if(null===t)throw new Error("Bad ROUTE statement: Expected fromNode attribute.");if(null===i)throw new Error("Bad ROUTE statement: Expected fromField attribute.");if(null===n)throw new Error("Bad ROUTE statement: Expected toNode attribute.");if(null===r)throw new Error("Bad ROUTE statement: Expected toField attribute.");var o=this.getExecutionContext(),s=o.getLocalNode(t),a=o.getLocalNode(n),u=o.addRoute(s,i,a,r);e.x3d=u}catch(e){console.log(e),console.warn("XML Parser Error: "+e.message)}},importElement:function(e){try{var t=e.getAttribute("inlineDEF"),i=e.getAttribute("importedDEF")||e.getAttribute("exportedDEF"),n=e.getAttribute("AS");if(null===t)throw new Error("Bad IMPORT statement: Expected inlineDEF attribute.");if(null===i)throw new Error("Bad IMPORT statement: Expected importedDEF attribute.");n||(n=i);var r=this.getExecutionContext().getNamedNode(t);this.getExecutionContext().updateImportedNode(r,i,n)}catch(e){console.warn("XML Parser Error: "+e.message)}},exportElement:function(e){try{if(this.getScene()!==this.getExecutionContext())return;var t=e.getAttribute("localDEF"),i=e.getAttribute("AS");if(null===t)throw new Error("Bad EXPORT statement: Expected localDEF attribute.");i||(i=t);var n=this.getExecutionContext().getLocalNode(t);this.getScene().updateExportedNode(i,n)}catch(e){console.warn("XML Parser Error: "+e.message)}},cdataNode:function(e){if(0!==this.getParents().length){var t=this.getParent();if(t instanceof i){var n=t.getSourceText();n&&n.push(e.data)}}},useAttribute:function(e){try{var t=e.getAttribute("USE");if(this.id(t)){var i=this.getExecutionContext().getNamedNode(t);return this.addNode(e,i.getValue()),!0}}catch(e){console.warn("Invalid USE name: "+e.message)}return!1},defAttribute:function(e,t){try{var i=e.getAttribute("DEF");if(i){try{var n=this.getExecutionContext().getNamedNode(i);this.getExecutionContext().updateNamedNode(this.getExecutionContext().getUniqueName(i),n)}catch(e){}this.getExecutionContext().updateNamedNode(i,t)}}catch(e){console.warn("Invalid DEF name: "+e.message)}},nodeAttributes:function(e,t){for(var i=e.attributes,n=0;n<i.length;++n)this.nodeAttribute(i[n],t)},nodeAttribute:function(e,t){try{var i=t.getField(this.attributeToCamelCase(e.name));i.getAccessType()&c.initializeOnly&&this.fieldValue(i,e.value)}catch(e){}},fieldValue:function(e,t){null!==t&&(this.parser.pushExecutionContext(this.getExecutionContext()),this.parser.setInput(t),this.fieldTypes[e.getType()].call(this.parser,e),this.parser.popExecutionContext())},addNode:function(e,i){if(0===this.parents.length||this.getParent()instanceof l)return void this.getExecutionContext().rootNodes.push(i);var n=this.getParent();if(n instanceof t)switch(n.getType()){case c.SFNode:return void n.setValue(i);case c.MFNode:return void n.push(i)}else try{var r=e.getAttribute("containerField");if(!r){if(!i)throw new Error("NULL node must have a container field attribute.");r=i.getContainerField()}var o=n.getField(r);switch(o.getType()){case c.SFNode:return void o.setValue(i);case c.MFNode:return void o.push(i)}}catch(e){}},getParents:function(){return this.parents},getParent:function(){return this.parents.at(-1)},pushParent:function(e){return this.parents.push(e)},popParent:function(){this.parents.pop()},id:function(e){return null!==e&&0!==e.length},nodeNameToCamelCase:function(e){return a.getNodeTypeName(e)},attributeToCamelCase:function(e){return a.getFieldName(e)}}),h.prototype.fieldTypes=[],h.prototype.fieldTypes[c.SFBool]=o.prototype.sfboolValue,h.prototype.fieldTypes[c.SFColor]=o.prototype.sfcolorValue,h.prototype.fieldTypes[c.SFColorRGBA]=o.prototype.sfcolorrgbaValue,h.prototype.fieldTypes[c.SFDouble]=o.prototype.sfdoubleValue,h.prototype.fieldTypes[c.SFFloat]=o.prototype.sffloatValue,h.prototype.fieldTypes[c.SFImage]=o.prototype.sfimageValue,h.prototype.fieldTypes[c.SFInt32]=o.prototype.sfint32Value,h.prototype.fieldTypes[c.SFMatrix3f]=o.prototype.sfmatrix3dValue,h.prototype.fieldTypes[c.SFMatrix3d]=o.prototype.sfmatrix3fValue,h.prototype.fieldTypes[c.SFMatrix4f]=o.prototype.sfmatrix4dValue,h.prototype.fieldTypes[c.SFMatrix4d]=o.prototype.sfmatrix4fValue,h.prototype.fieldTypes[c.SFNode]=function(e){e.setValue(null)},h.prototype.fieldTypes[c.SFRotation]=o.prototype.sfrotationValue,h.prototype.fieldTypes[c.SFString]=function(e){e.setValue(r.SFString.unescape(this.input))},h.prototype.fieldTypes[c.SFTime]=o.prototype.sftimeValue,h.prototype.fieldTypes[c.SFVec2d]=o.prototype.sfvec2dValue,h.prototype.fieldTypes[c.SFVec2f]=o.prototype.sfvec2fValue,h.prototype.fieldTypes[c.SFVec3d]=o.prototype.sfvec3dValue,h.prototype.fieldTypes[c.SFVec3f]=o.prototype.sfvec3fValue,h.prototype.fieldTypes[c.SFVec4d]=o.prototype.sfvec4dValue,h.prototype.fieldTypes[c.SFVec4f]=o.prototype.sfvec4fValue,h.prototype.fieldTypes[c.MFBool]=o.prototype.sfboolValues,h.prototype.fieldTypes[c.MFColor]=o.prototype.sfcolorValues,h.prototype.fieldTypes[c.MFColorRGBA]=o.prototype.sfcolorrgbaValues,h.prototype.fieldTypes[c.MFDouble]=o.prototype.sfdoubleValues,h.prototype.fieldTypes[c.MFFloat]=o.prototype.sffloatValues,h.prototype.fieldTypes[c.MFImage]=o.prototype.sfimageValues,h.prototype.fieldTypes[c.MFInt32]=o.prototype.sfint32Values,h.prototype.fieldTypes[c.MFMatrix3d]=o.prototype.sfmatrix3dValues,h.prototype.fieldTypes[c.MFMatrix3f]=o.prototype.sfmatrix3fValues,h.prototype.fieldTypes[c.MFMatrix4d]=o.prototype.sfmatrix4dValues,h.prototype.fieldTypes[c.MFMatrix4f]=o.prototype.sfmatrix4fValues,h.prototype.fieldTypes[c.MFNode]=function(e){e.length=0},h.prototype.fieldTypes[c.MFRotation]=o.prototype.sfrotationValues,h.prototype.fieldTypes[c.MFString]=o.prototype.sfstringValues,h.prototype.fieldTypes[c.MFTime]=o.prototype.sftimeValues,h.prototype.fieldTypes[c.MFVec2d]=o.prototype.sfvec2dValues,h.prototype.fieldTypes[c.MFVec2f]=o.prototype.sfvec2fValues,h.prototype.fieldTypes[c.MFVec3d]=o.prototype.sfvec3dValues,h.prototype.fieldTypes[c.MFVec3f]=o.prototype.sfvec3fValues,h.prototype.fieldTypes[c.MFVec4d]=o.prototype.sfvec4dValues,h.prototype.fieldTypes[c.MFVec4f]=o.prototype.sfvec4fValues;var _=/\binf\b/g,x=/\bnan\b/g,w=/^[\x20\n,\t\r"]+|[\x20\n,\t\r"]+$/g,b=/[\x20\n,\t\r"]+/,v=new RegExp('"((?:[^\\\\"]|\\\\\\\\|\\\\\\")*)"',"g");return h.prototype.fieldTypes[c.MFColor]=h.prototype.fieldTypes[c.MFColorRGBA]=h.prototype.fieldTypes[c.MFMatrix3d]=h.prototype.fieldTypes[c.MFMatrix3f]=h.prototype.fieldTypes[c.MFMatrix4d]=h.prototype.fieldTypes[c.MFMatrix4f]=h.prototype.fieldTypes[c.MFVec4d]=h.prototype.fieldTypes[c.MFVec4f]=function(e){e.setValue(p(this.getInput()).map(function(e){return parseFloat(e)}))},h.prototype.fieldTypes[c.MFBool]=function(e){e.setValue(d(this.getInput()).map(function(e){return"true"===e||"TRUE"===e}))},h.prototype.fieldTypes[c.MFInt32]=function(e){e.setValue(f(this.getInput()).map(function(e){return parseInt(e)}))},h.prototype.fieldTypes[c.MFDouble]=h.prototype.fieldTypes[c.MFFloat]=h.prototype.fieldTypes[c.MFVec2d]=h.prototype.fieldTypes[c.MFVec2f]=h.prototype.fieldTypes[c.MFVec3d]=h.prototype.fieldTypes[c.MFVec3f]=function(e){var t=e.getUnit();e.setValue(p(this.getInput()).map(function(e){return this.fromUnit(t,parseFloat(e))},this))},h.prototype.fieldTypes[c.MFString]=function(e){e.setValue(g(this.getInput()))},h}),define("x_ite/Parser/JSONParser",["x_ite/Parser/XMLParser","x_ite/Parser/X3DParser"],function(e,t){"use strict";function i(e){t.call(this,e),this.x3djsonNS="http://www.web3d.org/specifications/x3d-namespace"}return i.prototype=Object.assign(Object.create(t.prototype),{constructor:i,parseIntoScene:function(t,i,n){const r=this.createElement("X3D");return this.convertToDOM(t,"",r),new e(this.scene).parseIntoScene(r,i,n),r},elementSetAttribute:function(e,t,i){switch(t){case"SON schema":break;case"ncoding":break;default:"function"==typeof e.setAttribute&&e.setAttribute(t,i)}},convertChildren:function(e,t,i){for(const n in t)"object"==typeof t[n]&&(isNaN(parseInt(n))?this.convertObject(n,t,i,e.substr(1)):this.convertToDOM(t[n],n,i,e.substr(1)))},createElement:function(e,t){if(void 0===this.x3djsonNS)var i=document.createElement(e);else{var i=document.createElementNS(this.x3djsonNS,e);null!==i&&void 0!==i||(console.error("Trouble creating element for",e),i=document.createElement(e))}return void 0!==t&&this.elementSetAttribute(i,"containerField",t),i},createCDATA:function(e,t,i){let n=i.trim().replace(/\\"/g,'\\"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&");do i=n,n=i.replace(/'([^'\r\n]*)\n([^']*)'/g,"'$1\\n$2'"),i!==n&&console.log("CDATA Replacing",i,"with",n);while(n!==i)const r=new DOMParser,o="<script> <![CDATA[ "+n+" ]]> </script>",s=r.parseFromString(o,"application/xml"),a=s.children[0].childNodes[1];t.appendChild(a)},convertObject:function(e,t,i,n){if(null!==t&&"object"==typeof t[e])if("@"===e.substr(0,1))this.convertToDOM(t[e],e,i);else if("-"===e.substr(0,1))this.convertChildren(e,t[e],i);else if("#comment"===e)for(const n in t[e]){const r=document.createComment(this.commentStringToXML(t[e][n]));i.appendChild(r)}else if("#sourceCode"===e||"@sourceCode"===e||"#sourceText"===e)this.createCDATA(document,i,t[e].join("\r\n")+"\r\n");else if("connect"===e||"fieldValue"===e||"field"===e||"meta"===e||"component"===e){for(const r in t[e])if("object"==typeof t[e][r]){const o=this.createElement(e,n);this.convertToDOM(t[e][r],r,o),i.appendChild(o),i.appendChild(document.createTextNode("\n"))}}else{const r=this.createElement(e,n);this.convertToDOM(t[e],e,r),i.appendChild(r),i.appendChild(document.createTextNode("\n"))}},commentStringToXML:function(e){let t=e;return e=e.replace(/\\\\/g,"\\"),t!==e&&console.log("X3DJSONLD <!-> replacing",t,"with",e),e},SFStringToXML:function(e){const t=e;return e=e.replace(/\\/g,"\\\\"),e=e.replace(/"/g,'\\"'),t!==e&&console.log("X3DJSONLD [] replacing",t,"with",e),e},JSONStringToXML:function(e){const t=e;return e=e.replace(/\\/g,"\\\\"),e=e.replace(/\n/g,"\\n"),t!==e&&console.log("X3DJSONLD replacing",t,"with",e),e},convertToDOM:function(e,t,i,n){let r=!1,o=[],s=!1;for(const t in e)if(r=!isNaN(parseInt(t)))switch(typeof e[t]){case"number":o.push(e[t]);break;case"string":o.push(e[t]),s=!0;break;case"boolean":o.push(e[t]);break;case"object":this.convertToDOM(e[t],t,i);break;case"undefined":break;default:console.error("Unknown type found in array "+typeof e[t])}else switch(typeof e[t]){case"object":"X3D"===t?this.convertToDOM(e[t],t,i):this.convertObject(t,e,i,n);break;case"number":this.elementSetAttribute(i,t.substr(1),e[t]);break;case"string":if("#comment"!==t)this.elementSetAttribute(i,t.substr(1),this.JSONStringToXML(e[t]));else{const n=document.createComment(this.commentStringToXML(e[t]));i.appendChild(n)}break;case"boolean":this.elementSetAttribute(i,t.substr(1),e[t]);break;case"undefined":break;default:console.error("Unknown type found in object "+typeof e[t]),console.error(e)}if(r){if("@"===t.substr(0,1))if(s){s=!1;for(const e in o)o[e]=this.SFStringToXML(o[e]);this.elementSetAttribute(i,t.substr(1),'"'+o.join('" "')+'"')}else this.elementSetAttribute(i,t.substr(1),o.join(" "));r=!1}return i}}),i}),define("standard/Math/Geometry/Plane3",["standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4"],function(e,t){"use strict";function i(e,t){this.normal=t.copy(),this.distanceFromOrigin=t.dot(e)}const n=new e(0,0,0),r=new e(0,0,0),o=new t;return i.prototype={constructor:i,copy:function(){const e=Object.create(i.prototype);return e.normal=this.normal.copy(),e.distanceFromOrigin=this.distanceFromOrigin,e},assign:function(e){return this.normal.assign(e.normal),this.distanceFromOrigin=e.distanceFromOrigin,this},set:function(e,t){return this.normal.assign(t),this.distanceFromOrigin=t.dot(e),this},multRight:function(e){return r.assign(this.normal).multiply(this.distanceFromOrigin),o.assign(e).inverse(),o.multMatrixDir(n.assign(this.normal)).normalize(),e.multVecMatrix(r),this.normal.assign(n),this.distanceFromOrigin=n.dot(r),this},multLeft:function(e){return r.assign(this.normal).multiply(this.distanceFromOrigin),o.assign(e).inverse(),o.multDirMatrix(n.assign(this.normal)).normalize(),e.multMatrixVec(r),this.normal.assign(n),this.distanceFromOrigin=n.dot(r),this},getDistanceToPoint:function(t){return e.dot(t,this.normal)-this.distanceFromOrigin},intersectsLine:function(e,t){const i=e.point,n=e.direction,r=n.dot(this.normal);if(0===r)return!1;const o=(this.distanceFromOrigin-this.normal.dot(i))/r;return t.x=i.x+n.x*o,t.y=i.y+n.y*o,t.z=i.z+n.z*o,!0},toString:function(){return this.normal.toString()+" "+this.distanceFromOrigin}},i});var libtess={};libtess.DEBUG=!1,libtess.assert=function(e,t){
if(libtess.DEBUG&&!e)throw new Error("Assertion failed"+(t?": "+t:""))},libtess.GLU_TESS_MAX_COORD=1e150,libtess.TRUE_PROJECT=!1,libtess.GLU_TESS_DEFAULT_TOLERANCE=0,libtess.windingRule={GLU_TESS_WINDING_ODD:100130,GLU_TESS_WINDING_NONZERO:100131,GLU_TESS_WINDING_POSITIVE:100132,GLU_TESS_WINDING_NEGATIVE:100133,GLU_TESS_WINDING_ABS_GEQ_TWO:100134},libtess.primitiveType={GL_LINE_LOOP:2,GL_TRIANGLES:4,GL_TRIANGLE_STRIP:5,GL_TRIANGLE_FAN:6},libtess.errorType={GLU_TESS_MISSING_BEGIN_POLYGON:100151,GLU_TESS_MISSING_END_POLYGON:100153,GLU_TESS_MISSING_BEGIN_CONTOUR:100152,GLU_TESS_MISSING_END_CONTOUR:100154,GLU_TESS_COORD_TOO_LARGE:100155,GLU_TESS_NEED_COMBINE_CALLBACK:100156},libtess.gluEnum={GLU_TESS_BEGIN:100100,GLU_TESS_VERTEX:100101,GLU_TESS_END:100102,GLU_TESS_ERROR:100103,GLU_TESS_EDGE_FLAG:100104,GLU_TESS_COMBINE:100105,GLU_TESS_BEGIN_DATA:100106,GLU_TESS_VERTEX_DATA:100107,GLU_TESS_END_DATA:100108,GLU_TESS_ERROR_DATA:100109,GLU_TESS_EDGE_FLAG_DATA:100110,GLU_TESS_COMBINE_DATA:100111,GLU_TESS_MESH:100112,GLU_TESS_TOLERANCE:100142,GLU_TESS_WINDING_RULE:100140,GLU_TESS_BOUNDARY_ONLY:100141,GLU_INVALID_ENUM:100900,GLU_INVALID_VALUE:100901},libtess.PQHandle,libtess.geom={},libtess.geom.vertEq=function(e,t){return e.s===t.s&&e.t===t.t},libtess.geom.vertLeq=function(e,t){return e.s<t.s||e.s===t.s&&e.t<=t.t},libtess.geom.edgeEval=function(e,t,i){var n=t.s-e.s,r=i.s-t.s;return n+r>0?n<r?t.t-e.t+(e.t-i.t)*(n/(n+r)):t.t-i.t+(i.t-e.t)*(r/(n+r)):0},libtess.geom.edgeSign=function(e,t,i){var n=t.s-e.s,r=i.s-t.s;return n+r>0?(t.t-i.t)*n+(t.t-e.t)*r:0},libtess.geom.transLeq=function(e,t){return e.t<t.t||e.t===t.t&&e.s<=t.s},libtess.geom.transEval=function(e,t,i){var n=t.t-e.t,r=i.t-t.t;return n+r>0?n<r?t.s-e.s+(e.s-i.s)*(n/(n+r)):t.s-i.s+(i.s-e.s)*(r/(n+r)):0},libtess.geom.transSign=function(e,t,i){var n=t.t-e.t,r=i.t-t.t;return n+r>0?(t.s-i.s)*n+(t.s-e.s)*r:0},libtess.geom.edgeGoesLeft=function(e){return libtess.geom.vertLeq(e.dst(),e.org)},libtess.geom.edgeGoesRight=function(e){return libtess.geom.vertLeq(e.org,e.dst())},libtess.geom.vertL1dist=function(e,t){return Math.abs(e.s-t.s)+Math.abs(e.t-t.t)},libtess.geom.vertCCW=function(e,t,i){return e.s*(t.t-i.t)+t.s*(i.t-e.t)+i.s*(e.t-t.t)>=0},libtess.geom.interpolate_=function(e,t,i,n){return e=e<0?0:e,i=i<0?0:i,e<=i?0===i?(t+n)/2:t+e/(e+i)*(n-t):n+i/(e+i)*(t-n)},libtess.geom.edgeIntersect=function(e,t,i,n,r){var o,s,a;libtess.geom.vertLeq(e,t)||(a=e,e=t,t=a),libtess.geom.vertLeq(i,n)||(a=i,i=n,n=a),libtess.geom.vertLeq(e,i)||(a=e,e=i,i=a,a=t,t=n,n=a),libtess.geom.vertLeq(i,t)?libtess.geom.vertLeq(t,n)?(o=libtess.geom.edgeEval(e,i,t),s=libtess.geom.edgeEval(i,t,n),o+s<0&&(o=-o,s=-s),r.s=libtess.geom.interpolate_(o,i.s,s,t.s)):(o=libtess.geom.edgeSign(e,i,t),s=-libtess.geom.edgeSign(e,n,t),o+s<0&&(o=-o,s=-s),r.s=libtess.geom.interpolate_(o,i.s,s,n.s)):r.s=(i.s+t.s)/2,libtess.geom.transLeq(e,t)||(a=e,e=t,t=a),libtess.geom.transLeq(i,n)||(a=i,i=n,n=a),libtess.geom.transLeq(e,i)||(a=e,e=i,i=a,a=t,t=n,n=a),libtess.geom.transLeq(i,t)?libtess.geom.transLeq(t,n)?(o=libtess.geom.transEval(e,i,t),s=libtess.geom.transEval(i,t,n),o+s<0&&(o=-o,s=-s),r.t=libtess.geom.interpolate_(o,i.t,s,t.t)):(o=libtess.geom.transSign(e,i,t),s=-libtess.geom.transSign(e,n,t),o+s<0&&(o=-o,s=-s),r.t=libtess.geom.interpolate_(o,i.t,s,n.t)):r.t=(i.t+t.t)/2},libtess.mesh={},libtess.mesh.makeEdge=function(e){var t=libtess.mesh.makeEdgePair_(e.eHead);return libtess.mesh.makeVertex_(t,e.vHead),libtess.mesh.makeVertex_(t.sym,e.vHead),libtess.mesh.makeFace_(t,e.fHead),t},libtess.mesh.meshSplice=function(e,t){var i=!1,n=!1;e!==t&&(t.org!==e.org&&(n=!0,libtess.mesh.killVertex_(t.org,e.org)),t.lFace!==e.lFace&&(i=!0,libtess.mesh.killFace_(t.lFace,e.lFace)),libtess.mesh.splice_(t,e),n||(libtess.mesh.makeVertex_(t,e.org),e.org.anEdge=e),i||(libtess.mesh.makeFace_(t,e.lFace),e.lFace.anEdge=e))},libtess.mesh.deleteEdge=function(e){var t=e.sym,i=!1;e.lFace!==e.rFace()&&(i=!0,libtess.mesh.killFace_(e.lFace,e.rFace())),e.oNext===e?libtess.mesh.killVertex_(e.org,null):(e.rFace().anEdge=e.oPrev(),e.org.anEdge=e.oNext,libtess.mesh.splice_(e,e.oPrev()),i||libtess.mesh.makeFace_(e,e.lFace)),t.oNext===t?(libtess.mesh.killVertex_(t.org,null),libtess.mesh.killFace_(t.lFace,null)):(e.lFace.anEdge=t.oPrev(),t.org.anEdge=t.oNext,libtess.mesh.splice_(t,t.oPrev())),libtess.mesh.killEdge_(e)},libtess.mesh.addEdgeVertex=function(e){var t=libtess.mesh.makeEdgePair_(e),i=t.sym;return libtess.mesh.splice_(t,e.lNext),t.org=e.dst(),libtess.mesh.makeVertex_(i,t.org),t.lFace=i.lFace=e.lFace,t},libtess.mesh.splitEdge=function(e){var t=libtess.mesh.addEdgeVertex(e),i=t.sym;return libtess.mesh.splice_(e.sym,e.sym.oPrev()),libtess.mesh.splice_(e.sym,i),e.sym.org=i.org,i.dst().anEdge=i.sym,i.sym.lFace=e.rFace(),i.winding=e.winding,i.sym.winding=e.sym.winding,i},libtess.mesh.connect=function(e,t){var i=!1,n=libtess.mesh.makeEdgePair_(e),r=n.sym;return t.lFace!==e.lFace&&(i=!0,libtess.mesh.killFace_(t.lFace,e.lFace)),libtess.mesh.splice_(n,e.lNext),libtess.mesh.splice_(r,t),n.org=e.dst(),r.org=t.org,n.lFace=r.lFace=e.lFace,e.lFace.anEdge=r,i||libtess.mesh.makeFace_(n,e.lFace),n},libtess.mesh.zapFace=function(e){var t,i=e.anEdge,n=i.lNext;do if(t=n,n=t.lNext,t.lFace=null,null===t.rFace()){t.oNext===t?libtess.mesh.killVertex_(t.org,null):(t.org.anEdge=t.oNext,libtess.mesh.splice_(t,t.oPrev()));var r=t.sym;r.oNext===r?libtess.mesh.killVertex_(r.org,null):(r.org.anEdge=r.oNext,libtess.mesh.splice_(r,r.oPrev())),libtess.mesh.killEdge_(t)}while(t!==i)var o=e.prev,s=e.next;s.prev=o,o.next=s},libtess.mesh.meshUnion=function(e,t){var i=e.fHead,n=e.vHead,r=e.eHead,o=t.fHead,s=t.vHead,a=t.eHead;return o.next!==o&&(i.prev.next=o.next,o.next.prev=i.prev,o.prev.next=i,i.prev=o.prev),s.next!==s&&(n.prev.next=s.next,s.next.prev=n.prev,s.prev.next=n,n.prev=s.prev),a.next!==a&&(r.sym.next.sym.next=a.next,a.next.sym.next=r.sym.next,a.sym.next.sym.next=r,r.sym.next=a.sym.next),e},libtess.mesh.deleteMesh=function(e){},libtess.mesh.makeEdgePair_=function(e){var t=new libtess.GluHalfEdge,i=new libtess.GluHalfEdge,n=e.sym.next;return i.next=n,n.sym.next=t,t.next=e,e.sym.next=i,t.sym=i,t.oNext=t,t.lNext=i,i.sym=t,i.oNext=i,i.lNext=t,t},libtess.mesh.splice_=function(e,t){var i=e.oNext,n=t.oNext;i.sym.lNext=t,n.sym.lNext=e,e.oNext=n,t.oNext=i},libtess.mesh.makeVertex_=function(e,t){var i=t.prev,n=new libtess.GluVertex(t,i);i.next=n,t.prev=n,n.anEdge=e;var r=e;do r.org=n,r=r.oNext;while(r!==e)},libtess.mesh.makeFace_=function(e,t){var i=t.prev,n=new libtess.GluFace(t,i);i.next=n,t.prev=n,n.anEdge=e,n.inside=t.inside;var r=e;do r.lFace=n,r=r.lNext;while(r!==e)},libtess.mesh.killEdge_=function(e){var t=e.next,i=e.sym.next;t.sym.next=i,i.sym.next=t},libtess.mesh.killVertex_=function(e,t){var i=e.anEdge,n=i;do n.org=t,n=n.oNext;while(n!==i)var r=e.prev,o=e.next;o.prev=r,r.next=o},libtess.mesh.killFace_=function(e,t){var i=e.anEdge,n=i;do n.lFace=t,n=n.lNext;while(n!==i)var r=e.prev,o=e.next;o.prev=r,r.next=o},libtess.normal={},libtess.normal.S_UNIT_X_=1,libtess.normal.S_UNIT_Y_=0,libtess.normal.projectPolygon=function(e,t,i,n){var r=!1,o=[t,i,n];0===t&&0===i&&0===n&&(libtess.normal.computeNormal_(e,o),r=!0);var s,a=libtess.normal.longAxis_(o),u=e.mesh.vHead;if(libtess.TRUE_PROJECT){libtess.normal.normalize_(o);var l=[0,0,0],c=[0,0,0];l[a]=0,l[(a+1)%3]=libtess.normal.S_UNIT_X_,l[(a+2)%3]=libtess.normal.S_UNIT_Y_;var h=libtess.normal.dot_(l,o);for(l[0]-=h*o[0],l[1]-=h*o[1],l[2]-=h*o[2],libtess.normal.normalize_(l),c[0]=o[1]*l[2]-o[2]*l[1],c[1]=o[2]*l[0]-o[0]*l[2],c[2]=o[0]*l[1]-o[1]*l[0],libtess.normal.normalize_(c),s=u.next;s!==u;s=s.next)s.s=libtess.normal.dot_(s.coords,l),s.t=libtess.normal.dot_(s.coords,c)}else{var d=(a+1)%3,p=(a+2)%3,f=o[a]>0?1:-1;for(s=u.next;s!==u;s=s.next)s.s=s.coords[d],s.t=f*s.coords[p]}r&&libtess.normal.checkOrientation_(e)},libtess.normal.dot_=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},libtess.normal.normalize_=function(e){var t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2];t=Math.sqrt(t),e[0]/=t,e[1]/=t,e[2]/=t},libtess.normal.longAxis_=function(e){var t=0;return Math.abs(e[1])>Math.abs(e[0])&&(t=1),Math.abs(e[2])>Math.abs(e[t])&&(t=2),t},libtess.normal.computeNormal_=function(e,t){var i,n=[-2*libtess.GLU_TESS_MAX_COORD,-2*libtess.GLU_TESS_MAX_COORD,-2*libtess.GLU_TESS_MAX_COORD],r=[2*libtess.GLU_TESS_MAX_COORD,2*libtess.GLU_TESS_MAX_COORD,2*libtess.GLU_TESS_MAX_COORD],o=[],s=[],a=e.mesh.vHead;for(i=a.next;i!==a;i=i.next)for(var u=0;u<3;++u){var l=i.coords[u];l<r[u]&&(r[u]=l,s[u]=i),l>n[u]&&(n[u]=l,o[u]=i)}var c=0;if(n[1]-r[1]>n[0]-r[0]&&(c=1),n[2]-r[2]>n[c]-r[c]&&(c=2),r[c]>=n[c])return t[0]=0,t[1]=0,void(t[2]=1);var h=0,d=s[c],p=o[c],f=[0,0,0],g=[d.coords[0]-p.coords[0],d.coords[1]-p.coords[1],d.coords[2]-p.coords[2]],m=[0,0,0];for(i=a.next;i!==a;i=i.next){m[0]=i.coords[0]-p.coords[0],m[1]=i.coords[1]-p.coords[1],m[2]=i.coords[2]-p.coords[2],f[0]=g[1]*m[2]-g[2]*m[1],f[1]=g[2]*m[0]-g[0]*m[2],f[2]=g[0]*m[1]-g[1]*m[0];var y=f[0]*f[0]+f[1]*f[1]+f[2]*f[2];y>h&&(h=y,t[0]=f[0],t[1]=f[1],t[2]=f[2])}h<=0&&(t[0]=t[1]=t[2]=0,t[libtess.normal.longAxis_(g)]=1)},libtess.normal.checkOrientation_=function(e){for(var t=0,i=e.mesh.fHead,n=i.next;n!==i;n=n.next){var r=n.anEdge;if(!(r.winding<=0))do t+=(r.org.s-r.dst().s)*(r.org.t+r.dst().t),r=r.lNext;while(r!==n.anEdge)}if(t<0)for(var o=e.mesh.vHead,s=o.next;s!==o;s=s.next)s.t=-s.t},libtess.render={},libtess.render.renderMesh=function(e,t,i){for(var n=!1,r=-1,o=t.fHead.prev;o!==t.fHead;o=o.prev)if(o.inside){n||(e.callBeginCallback(libtess.primitiveType.GL_TRIANGLES),n=!0);var s=o.anEdge;do{if(i){var a=s.rFace().inside?0:1;r!==a&&(r=a,e.callEdgeFlagCallback(!!r))}e.callVertexCallback(s.org.data),s=s.lNext}while(s!==o.anEdge)}n&&e.callEndCallback()},libtess.render.renderBoundary=function(e,t){for(var i=t.fHead.next;i!==t.fHead;i=i.next)if(i.inside){e.callBeginCallback(libtess.primitiveType.GL_LINE_LOOP);var n=i.anEdge;do e.callVertexCallback(n.org.data),n=n.lNext;while(n!==i.anEdge)e.callEndCallback()}},libtess.sweep={},libtess.sweep.SENTINEL_COORD_=4*libtess.GLU_TESS_MAX_COORD,libtess.sweep.TOLERANCE_NONZERO_=!1,libtess.sweep.computeInterior=function(e){e.fatalError=!1,libtess.sweep.removeDegenerateEdges_(e),libtess.sweep.initPriorityQ_(e),libtess.sweep.initEdgeDict_(e);for(var t;null!==(t=e.pq.extractMin());){for(;;){var i=e.pq.minimum();if(null===i||!libtess.geom.vertEq(i,t))break;i=e.pq.extractMin(),libtess.sweep.spliceMergeVertices_(e,t.anEdge,i.anEdge)}libtess.sweep.sweepEvent_(e,t)}var n=e.dict.getMin().getKey();e.event=n.eUp.org,libtess.sweep.doneEdgeDict_(e),libtess.sweep.donePriorityQ_(e),libtess.sweep.removeDegenerateFaces_(e.mesh),e.mesh.checkMesh()},libtess.sweep.addWinding_=function(e,t){e.winding+=t.winding,e.sym.winding+=t.sym.winding},libtess.sweep.edgeLeq_=function(e,t,i){var n=e.event,r=t.eUp,o=i.eUp;return r.dst()===n?o.dst()===n?libtess.geom.vertLeq(r.org,o.org)?libtess.geom.edgeSign(o.dst(),r.org,o.org)<=0:libtess.geom.edgeSign(r.dst(),o.org,r.org)>=0:libtess.geom.edgeSign(o.dst(),n,o.org)<=0:o.dst()===n?libtess.geom.edgeSign(r.dst(),n,r.org)>=0:libtess.geom.edgeEval(r.dst(),n,r.org)>=libtess.geom.edgeEval(o.dst(),n,o.org)},libtess.sweep.deleteRegion_=function(e,t){t.fixUpperEdge,t.eUp.activeRegion=null,e.dict.deleteNode(t.nodeUp),t.nodeUp=null},libtess.sweep.fixUpperEdge_=function(e,t){libtess.mesh.deleteEdge(e.eUp),e.fixUpperEdge=!1,e.eUp=t,t.activeRegion=e},libtess.sweep.topLeftRegion_=function(e){var t=e.eUp.org;do e=e.regionAbove();while(e.eUp.org===t)if(e.fixUpperEdge){var i=libtess.mesh.connect(e.regionBelow().eUp.sym,e.eUp.lNext);libtess.sweep.fixUpperEdge_(e,i),e=e.regionAbove()}return e},libtess.sweep.topRightRegion_=function(e){var t=e.eUp.dst();do e=e.regionAbove();while(e.eUp.dst()===t)return e},libtess.sweep.addRegionBelow_=function(e,t,i){var n=new libtess.ActiveRegion;return n.eUp=i,n.nodeUp=e.dict.insertBefore(t.nodeUp,n),i.activeRegion=n,n},libtess.sweep.isWindingInside_=function(e,t){switch(e.windingRule){case libtess.windingRule.GLU_TESS_WINDING_ODD:return 0!=(1&t);case libtess.windingRule.GLU_TESS_WINDING_NONZERO:return 0!==t;case libtess.windingRule.GLU_TESS_WINDING_POSITIVE:return t>0;case libtess.windingRule.GLU_TESS_WINDING_NEGATIVE:return t<0;case libtess.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:return t>=2||t<=-2}return!1},libtess.sweep.computeWinding_=function(e,t){t.windingNumber=t.regionAbove().windingNumber+t.eUp.winding,t.inside=libtess.sweep.isWindingInside_(e,t.windingNumber)},libtess.sweep.finishRegion_=function(e,t){var i=t.eUp,n=i.lFace;n.inside=t.inside,n.anEdge=i,libtess.sweep.deleteRegion_(e,t)},libtess.sweep.finishLeftRegions_=function(e,t,i){for(var n=t,r=t.eUp;n!==i;){n.fixUpperEdge=!1;var o=n.regionBelow(),s=o.eUp;if(s.org!==r.org){if(!o.fixUpperEdge){libtess.sweep.finishRegion_(e,n);break}s=libtess.mesh.connect(r.lPrev(),s.sym),libtess.sweep.fixUpperEdge_(o,s)}r.oNext!==s&&(libtess.mesh.meshSplice(s.oPrev(),s),libtess.mesh.meshSplice(r,s)),libtess.sweep.finishRegion_(e,n),r=o.eUp,n=o}return r},libtess.sweep.addRightEdges_=function(e,t,i,n,r,o){var s=!0,a=i;do libtess.sweep.addRegionBelow_(e,t,a.sym),a=a.oNext;while(a!==n)null===r&&(r=t.regionBelow().eUp.rPrev());for(var u,l=t,c=r;u=l.regionBelow(),a=u.eUp.sym,a.org===c.org;)a.oNext!==c&&(libtess.mesh.meshSplice(a.oPrev(),a),libtess.mesh.meshSplice(c.oPrev(),a)),u.windingNumber=l.windingNumber-a.winding,u.inside=libtess.sweep.isWindingInside_(e,u.windingNumber),l.dirty=!0,!s&&libtess.sweep.checkForRightSplice_(e,l)&&(libtess.sweep.addWinding_(a,c),libtess.sweep.deleteRegion_(e,l),libtess.mesh.deleteEdge(c)),s=!1,l=u,c=a;l.dirty=!0,o&&libtess.sweep.walkDirtyRegions_(e,l)},libtess.sweep.callCombine_=function(e,t,i,n,r){var o=[t.coords[0],t.coords[1],t.coords[2]];t.data=null,t.data=e.callCombineCallback(o,i,n),null===t.data&&(r?e.fatalError||(e.callErrorCallback(libtess.errorType.GLU_TESS_NEED_COMBINE_CALLBACK),e.fatalError=!0):t.data=i[0])},libtess.sweep.spliceMergeVertices_=function(e,t,i){var n=[null,null,null,null],r=[.5,.5,0,0];n[0]=t.org.data,n[1]=i.org.data,libtess.sweep.callCombine_(e,t.org,n,r,!1),libtess.mesh.meshSplice(t,i)},libtess.sweep.vertexWeights_=function(e,t,i,n,r){var o=libtess.geom.vertL1dist(t,e),s=libtess.geom.vertL1dist(i,e),a=r,u=r+1;n[a]=.5*s/(o+s),n[u]=.5*o/(o+s),e.coords[0]+=n[a]*t.coords[0]+n[u]*i.coords[0],e.coords[1]+=n[a]*t.coords[1]+n[u]*i.coords[1],e.coords[2]+=n[a]*t.coords[2]+n[u]*i.coords[2]},libtess.sweep.getIntersectData_=function(e,t,i,n,r,o){var s=[0,0,0,0],a=[i.data,n.data,r.data,o.data];t.coords[0]=t.coords[1]=t.coords[2]=0,libtess.sweep.vertexWeights_(t,i,n,s,0),libtess.sweep.vertexWeights_(t,r,o,s,2),libtess.sweep.callCombine_(e,t,a,s,!0)},libtess.sweep.checkForRightSplice_=function(e,t){var i=t.regionBelow(),n=t.eUp,r=i.eUp;if(libtess.geom.vertLeq(n.org,r.org)){if(libtess.geom.edgeSign(r.dst(),n.org,r.org)>0)return!1;libtess.geom.vertEq(n.org,r.org)?n.org!==r.org&&(e.pq.remove(n.org.pqHandle),libtess.sweep.spliceMergeVertices_(e,r.oPrev(),n)):(libtess.mesh.splitEdge(r.sym),libtess.mesh.meshSplice(n,r.oPrev()),t.dirty=i.dirty=!0)}else{if(libtess.geom.edgeSign(n.dst(),r.org,n.org)<0)return!1;t.regionAbove().dirty=t.dirty=!0,libtess.mesh.splitEdge(n.sym),libtess.mesh.meshSplice(r.oPrev(),n)}return!0},libtess.sweep.checkForLeftSplice_=function(e,t){var i,n=t.regionBelow(),r=t.eUp,o=n.eUp;if(libtess.geom.vertLeq(r.dst(),o.dst())){if(libtess.geom.edgeSign(r.dst(),o.dst(),r.org)<0)return!1;t.regionAbove().dirty=t.dirty=!0,i=libtess.mesh.splitEdge(r),libtess.mesh.meshSplice(o.sym,i),i.lFace.inside=t.inside}else{if(libtess.geom.edgeSign(o.dst(),r.dst(),o.org)>0)return!1;t.dirty=n.dirty=!0,i=libtess.mesh.splitEdge(o),libtess.mesh.meshSplice(r.lNext,o.sym),i.rFace().inside=t.inside}return!0},libtess.sweep.checkForIntersect_=function(e,t){var i=t.regionBelow(),n=t.eUp,r=i.eUp,o=n.org,s=r.org,a=n.dst(),u=r.dst(),l=new libtess.GluVertex;if(o===s)return!1;if(Math.min(o.t,a.t)>Math.max(s.t,u.t))return!1;if(libtess.geom.vertLeq(o,s)){if(libtess.geom.edgeSign(u,o,s)>0)return!1}else if(libtess.geom.edgeSign(a,s,o)<0)return!1;libtess.geom.edgeIntersect(a,o,u,s,l),libtess.geom.vertLeq(l,e.event)&&(l.s=e.event.s,l.t=e.event.t);var c=libtess.geom.vertLeq(o,s)?o:s;if(libtess.geom.vertLeq(c,l)&&(l.s=c.s,l.t=c.t),libtess.geom.vertEq(l,o)||libtess.geom.vertEq(l,s))return libtess.sweep.checkForRightSplice_(e,t),!1;if(!libtess.geom.vertEq(a,e.event)&&libtess.geom.edgeSign(a,e.event,l)>=0||!libtess.geom.vertEq(u,e.event)&&libtess.geom.edgeSign(u,e.event,l)<=0){if(u===e.event)return libtess.mesh.splitEdge(n.sym),libtess.mesh.meshSplice(r.sym,n),t=libtess.sweep.topLeftRegion_(t),n=t.regionBelow().eUp,libtess.sweep.finishLeftRegions_(e,t.regionBelow(),i),libtess.sweep.addRightEdges_(e,t,n.oPrev(),n,n,!0),!0;if(a===e.event){libtess.mesh.splitEdge(r.sym),libtess.mesh.meshSplice(n.lNext,r.oPrev()),i=t,t=libtess.sweep.topRightRegion_(t);var h=t.regionBelow().eUp.rPrev();return i.eUp=r.oPrev(),r=libtess.sweep.finishLeftRegions_(e,i,null),libtess.sweep.addRightEdges_(e,t,r.oNext,n.rPrev(),h,!0),!0}return libtess.geom.edgeSign(a,e.event,l)>=0&&(t.regionAbove().dirty=t.dirty=!0,libtess.mesh.splitEdge(n.sym),n.org.s=e.event.s,n.org.t=e.event.t),libtess.geom.edgeSign(u,e.event,l)<=0&&(t.dirty=i.dirty=!0,libtess.mesh.splitEdge(r.sym),r.org.s=e.event.s,r.org.t=e.event.t),!1}return libtess.mesh.splitEdge(n.sym),libtess.mesh.splitEdge(r.sym),libtess.mesh.meshSplice(r.oPrev(),n),n.org.s=l.s,n.org.t=l.t,n.org.pqHandle=e.pq.insert(n.org),libtess.sweep.getIntersectData_(e,n.org,o,a,s,u),t.regionAbove().dirty=t.dirty=i.dirty=!0,!1},libtess.sweep.walkDirtyRegions_=function(e,t){for(var i=t.regionBelow();;){for(;i.dirty;)t=i,i=i.regionBelow();if(!t.dirty&&(i=t,null===(t=t.regionAbove())||!t.dirty))return;t.dirty=!1;var n=t.eUp,r=i.eUp;if(n.dst()!==r.dst()&&libtess.sweep.checkForLeftSplice_(e,t)&&(i.fixUpperEdge?(libtess.sweep.deleteRegion_(e,i),libtess.mesh.deleteEdge(r),i=t.regionBelow(),r=i.eUp):t.fixUpperEdge&&(libtess.sweep.deleteRegion_(e,t),libtess.mesh.deleteEdge(n),t=i.regionAbove(),n=t.eUp)),n.org!==r.org)if(n.dst()===r.dst()||t.fixUpperEdge||i.fixUpperEdge||n.dst()!==e.event&&r.dst()!==e.event)libtess.sweep.checkForRightSplice_(e,t);else if(libtess.sweep.checkForIntersect_(e,t))return;n.org===r.org&&n.dst()===r.dst()&&(libtess.sweep.addWinding_(r,n),libtess.sweep.deleteRegion_(e,t),libtess.mesh.deleteEdge(n),t=i.regionAbove())}},libtess.sweep.connectRightVertex_=function(e,t,i){var n=i.oNext,r=t.regionBelow(),o=t.eUp,s=r.eUp,a=!1;if(o.dst()!==s.dst()&&libtess.sweep.checkForIntersect_(e,t),libtess.geom.vertEq(o.org,e.event)&&(libtess.mesh.meshSplice(n.oPrev(),o),t=libtess.sweep.topLeftRegion_(t),n=t.regionBelow().eUp,libtess.sweep.finishLeftRegions_(e,t.regionBelow(),r),a=!0),libtess.geom.vertEq(s.org,e.event)&&(libtess.mesh.meshSplice(i,s.oPrev()),i=libtess.sweep.finishLeftRegions_(e,r,null),a=!0),a)return void libtess.sweep.addRightEdges_(e,t,i.oNext,n,n,!0);var u;u=libtess.geom.vertLeq(s.org,o.org)?s.oPrev():o,u=libtess.mesh.connect(i.lPrev(),u),libtess.sweep.addRightEdges_(e,t,u,u.oNext,u.oNext,!1),u.sym.activeRegion.fixUpperEdge=!0,libtess.sweep.walkDirtyRegions_(e,t)},libtess.sweep.connectLeftDegenerate_=function(e,t,i){var n=t.eUp;if(libtess.geom.vertEq(n.org,i))return void(libtess.sweep.TOLERANCE_NONZERO_&&libtess.sweep.spliceMergeVertices_(e,n,i.anEdge));if(!libtess.geom.vertEq(n.dst(),i))return libtess.mesh.splitEdge(n.sym),t.fixUpperEdge&&(libtess.mesh.deleteEdge(n.oNext),t.fixUpperEdge=!1),libtess.mesh.meshSplice(i.anEdge,n),void libtess.sweep.sweepEvent_(e,i);if(libtess.sweep.TOLERANCE_NONZERO_){t=libtess.sweep.topRightRegion_(t);var r=t.regionBelow(),o=r.eUp.sym,s=o.oNext,a=s;r.fixUpperEdge&&(libtess.sweep.deleteRegion_(e,r),libtess.mesh.deleteEdge(o),o=s.oPrev()),libtess.mesh.meshSplice(i.anEdge,o),libtess.geom.edgeGoesLeft(s)||(s=null),libtess.sweep.addRightEdges_(e,t,o.oNext,a,s,!0)}},libtess.sweep.connectLeftVertex_=function(e,t){var i=new libtess.ActiveRegion;i.eUp=t.anEdge.sym;var n=e.dict.search(i).getKey(),r=n.regionBelow(),o=n.eUp,s=r.eUp;if(0===libtess.geom.edgeSign(o.dst(),t,o.org))return void libtess.sweep.connectLeftDegenerate_(e,n,t);var a,u=libtess.geom.vertLeq(s.dst(),o.dst())?n:r;if(n.inside||u.fixUpperEdge){if(u===n)a=libtess.mesh.connect(t.anEdge.sym,o.lNext);else{a=libtess.mesh.connect(s.dNext(),t.anEdge).sym}u.fixUpperEdge?libtess.sweep.fixUpperEdge_(u,a):libtess.sweep.computeWinding_(e,libtess.sweep.addRegionBelow_(e,n,a)),libtess.sweep.sweepEvent_(e,t)}else libtess.sweep.addRightEdges_(e,n,t.anEdge,t.anEdge,null,!0)},libtess.sweep.sweepEvent_=function(e,t){e.event=t;for(var i=t.anEdge;null===i.activeRegion;)if((i=i.oNext)===t.anEdge)return void libtess.sweep.connectLeftVertex_(e,t);var n=libtess.sweep.topLeftRegion_(i.activeRegion),r=n.regionBelow(),o=r.eUp,s=libtess.sweep.finishLeftRegions_(e,r,null);s.oNext===o?libtess.sweep.connectRightVertex_(e,n,s):libtess.sweep.addRightEdges_(e,n,s.oNext,o,o,!0)},libtess.sweep.addSentinel_=function(e,t){var i=new libtess.ActiveRegion,n=libtess.mesh.makeEdge(e.mesh);n.org.s=libtess.sweep.SENTINEL_COORD_,n.org.t=t,n.dst().s=-libtess.sweep.SENTINEL_COORD_,n.dst().t=t,e.event=n.dst(),i.eUp=n,i.windingNumber=0,i.inside=!1,i.fixUpperEdge=!1,i.sentinel=!0,i.dirty=!1,i.nodeUp=e.dict.insert(i)},libtess.sweep.initEdgeDict_=function(e){e.dict=new libtess.Dict(e,libtess.sweep.edgeLeq_),libtess.sweep.addSentinel_(e,-libtess.sweep.SENTINEL_COORD_),libtess.sweep.addSentinel_(e,libtess.sweep.SENTINEL_COORD_)},libtess.sweep.doneEdgeDict_=function(e){for(var t;null!==(t=e.dict.getMin().getKey());)t.sentinel,libtess.sweep.deleteRegion_(e,t);e.dict=null},libtess.sweep.removeDegenerateEdges_=function(e){for(var t,i=e.mesh.eHead,n=i.next;n!==i;n=t){t=n.next;var r=n.lNext;libtess.geom.vertEq(n.org,n.dst())&&n.lNext.lNext!==n&&(libtess.sweep.spliceMergeVertices_(e,r,n),libtess.mesh.deleteEdge(n),n=r,r=n.lNext),r.lNext===n&&(r!==n&&(r!==t&&r!==t.sym||(t=t.next),libtess.mesh.deleteEdge(r)),n!==t&&n!==t.sym||(t=t.next),libtess.mesh.deleteEdge(n))}},libtess.sweep.initPriorityQ_=function(e){var t=new libtess.PriorityQ;e.pq=t;var i,n=e.mesh.vHead;for(i=n.next;i!==n;i=i.next)i.pqHandle=t.insert(i);t.init()},libtess.sweep.donePriorityQ_=function(e){e.pq.deleteQ(),e.pq=null},libtess.sweep.removeDegenerateFaces_=function(e){for(var t,i=e.fHead.next;i!==e.fHead;i=t){t=i.next;var n=i.anEdge;n.lNext.lNext===n&&(libtess.sweep.addWinding_(n.oNext,n),libtess.mesh.deleteEdge(n))}},libtess.tessmono={},libtess.tessmono.tessellateMonoRegion_=function(e){for(var t=e.anEdge;libtess.geom.vertLeq(t.dst(),t.org);t=t.lPrev());for(;libtess.geom.vertLeq(t.org,t.dst());t=t.lNext);for(var i,n=t.lPrev();t.lNext!==n;)if(libtess.geom.vertLeq(t.dst(),n.org)){for(;n.lNext!==t&&(libtess.geom.edgeGoesLeft(n.lNext)||libtess.geom.edgeSign(n.org,n.dst(),n.lNext.dst())<=0);)i=libtess.mesh.connect(n.lNext,n),n=i.sym;n=n.lPrev()}else{for(;n.lNext!==t&&(libtess.geom.edgeGoesRight(t.lPrev())||libtess.geom.edgeSign(t.dst(),t.org,t.lPrev().org)>=0);)i=libtess.mesh.connect(t,t.lPrev()),t=i.sym;t=t.lNext}for(;n.lNext.lNext!==t;)i=libtess.mesh.connect(n.lNext,n),n=i.sym},libtess.tessmono.tessellateInterior=function(e){for(var t,i=e.fHead.next;i!==e.fHead;i=t)t=i.next,i.inside&&libtess.tessmono.tessellateMonoRegion_(i)},libtess.tessmono.discardExterior=function(e){for(var t,i=e.fHead.next;i!==e.fHead;i=t)t=i.next,i.inside||libtess.mesh.zapFace(i)},libtess.tessmono.setWindingNumber=function(e,t,i){for(var n,r=e.eHead.next;r!==e.eHead;r=n)n=r.next,r.rFace().inside!==r.lFace.inside?r.winding=r.lFace.inside?t:-t:i?libtess.mesh.deleteEdge(r):r.winding=0},libtess.Dict=function(e,t){this.head_=new libtess.DictNode,this.frame_=e,this.leq_=t},libtess.Dict.prototype.deleteDict_=function(){},libtess.Dict.prototype.insertBefore=function(e,t){do e=e.prev;while(null!==e.key&&!this.leq_(this.frame_,e.key,t))var i=new libtess.DictNode(t,e.next,e);return e.next.prev=i,e.next=i,i},libtess.Dict.prototype.insert=function(e){return this.insertBefore(this.head_,e)},libtess.Dict.prototype.deleteNode=function(e){e.next.prev=e.prev,e.prev.next=e.next},libtess.Dict.prototype.search=function(e){var t=this.head_;do t=t.next;while(null!==t.key&&!this.leq_(this.frame_,e,t.key))return t},libtess.Dict.prototype.getMin=function(){return this.head_.next},libtess.Dict.prototype.getMax=function(){return this.head_.prev},libtess.DictNode=function(e,t,i){this.key=e||null,this.next=t||this,this.prev=i||this},libtess.DictNode.prototype.getKey=function(){return this.key},libtess.DictNode.prototype.getSuccessor=function(){return this.next},libtess.DictNode.prototype.getPredecessor=function(){return this.prev},libtess.GluTesselator=function(){this.state_=libtess.GluTesselator.tessState_.T_DORMANT,this.lastEdge_=null,this.mesh=null,this.errorCallback_=null,this.normal_=[0,0,0],this.windingRule=libtess.windingRule.GLU_TESS_WINDING_ODD,this.fatalError=!1,this.dict=null,this.pq=null,this.event=null,this.combineCallback_=null,this.boundaryOnly_=!1,this.beginCallback_=null,this.edgeFlagCallback_=null,this.vertexCallback_=null,this.endCallback_=null,this.meshCallback_=null,this.polygonData_=null},libtess.GluTesselator.tessState_={T_DORMANT:0,T_IN_POLYGON:1,T_IN_CONTOUR:2},libtess.GluTesselator.prototype.gluDeleteTess=function(){this.requireState_(libtess.GluTesselator.tessState_.T_DORMANT)},libtess.GluTesselator.prototype.gluTessProperty=function(e,t){switch(e){case libtess.gluEnum.GLU_TESS_TOLERANCE:return;case libtess.gluEnum.GLU_TESS_WINDING_RULE:var i=t;switch(i){case libtess.windingRule.GLU_TESS_WINDING_ODD:case libtess.windingRule.GLU_TESS_WINDING_NONZERO:case libtess.windingRule.GLU_TESS_WINDING_POSITIVE:case libtess.windingRule.GLU_TESS_WINDING_NEGATIVE:case libtess.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:return void(this.windingRule=i)}break;case libtess.gluEnum.GLU_TESS_BOUNDARY_ONLY:return void(this.boundaryOnly_=!!t);default:return void this.callErrorCallback(libtess.gluEnum.GLU_INVALID_ENUM)}this.callErrorCallback(libtess.gluEnum.GLU_INVALID_VALUE)},libtess.GluTesselator.prototype.gluGetTessProperty=function(e){switch(e){case libtess.gluEnum.GLU_TESS_TOLERANCE:return 0;case libtess.gluEnum.GLU_TESS_WINDING_RULE:return this.windingRule;case libtess.gluEnum.GLU_TESS_BOUNDARY_ONLY:return this.boundaryOnly_;default:this.callErrorCallback(libtess.gluEnum.GLU_INVALID_ENUM)}return!1},libtess.GluTesselator.prototype.gluTessNormal=function(e,t,i){this.normal_[0]=e,this.normal_[1]=t,this.normal_[2]=i},libtess.GluTesselator.prototype.gluTessCallback=function(e,t){var i=t?t:null;switch(e){case libtess.gluEnum.GLU_TESS_BEGIN:case libtess.gluEnum.GLU_TESS_BEGIN_DATA:return void(this.beginCallback_=i);case libtess.gluEnum.GLU_TESS_EDGE_FLAG:case libtess.gluEnum.GLU_TESS_EDGE_FLAG_DATA:return void(this.edgeFlagCallback_=i);case libtess.gluEnum.GLU_TESS_VERTEX:case libtess.gluEnum.GLU_TESS_VERTEX_DATA:return void(this.vertexCallback_=i);case libtess.gluEnum.GLU_TESS_END:case libtess.gluEnum.GLU_TESS_END_DATA:return void(this.endCallback_=i);case libtess.gluEnum.GLU_TESS_ERROR:case libtess.gluEnum.GLU_TESS_ERROR_DATA:return void(this.errorCallback_=i);case libtess.gluEnum.GLU_TESS_COMBINE:case libtess.gluEnum.GLU_TESS_COMBINE_DATA:return void(this.combineCallback_=i);case libtess.gluEnum.GLU_TESS_MESH:return void(this.meshCallback_=i);default:return void this.callErrorCallback(libtess.gluEnum.GLU_INVALID_ENUM)}},libtess.GluTesselator.prototype.gluTessVertex=function(e,t){var i=!1,n=[0,0,0];this.requireState_(libtess.GluTesselator.tessState_.T_IN_CONTOUR);for(var r=0;r<3;++r){var o=e[r];o<-libtess.GLU_TESS_MAX_COORD&&(o=-libtess.GLU_TESS_MAX_COORD,i=!0),o>libtess.GLU_TESS_MAX_COORD&&(o=libtess.GLU_TESS_MAX_COORD,i=!0),n[r]=o}i&&this.callErrorCallback(libtess.errorType.GLU_TESS_COORD_TOO_LARGE),this.addVertex_(n,t)},libtess.GluTesselator.prototype.gluTessBeginPolygon=function(e){this.requireState_(libtess.GluTesselator.tessState_.T_DORMANT),this.state_=libtess.GluTesselator.tessState_.T_IN_POLYGON,this.mesh=new libtess.GluMesh,this.polygonData_=e},libtess.GluTesselator.prototype.gluTessBeginContour=function(){this.requireState_(libtess.GluTesselator.tessState_.T_IN_POLYGON),this.state_=libtess.GluTesselator.tessState_.T_IN_CONTOUR,this.lastEdge_=null},libtess.GluTesselator.prototype.gluTessEndContour=function(){this.requireState_(libtess.GluTesselator.tessState_.T_IN_CONTOUR),this.state_=libtess.GluTesselator.tessState_.T_IN_POLYGON},libtess.GluTesselator.prototype.gluTessEndPolygon=function(){if(this.requireState_(libtess.GluTesselator.tessState_.T_IN_POLYGON),this.state_=libtess.GluTesselator.tessState_.T_DORMANT,libtess.normal.projectPolygon(this,this.normal_[0],this.normal_[1],this.normal_[2]),libtess.sweep.computeInterior(this),!this.fatalError){var e=this.mesh;if(this.boundaryOnly_?libtess.tessmono.setWindingNumber(e,1,!0):libtess.tessmono.tessellateInterior(e),this.mesh.checkMesh(),this.beginCallback_||this.endCallback_||this.vertexCallback_||this.edgeFlagCallback_)if(this.boundaryOnly_)libtess.render.renderBoundary(this,this.mesh);else{var t=!!this.edgeFlagCallback_;libtess.render.renderMesh(this,this.mesh,t)}if(this.meshCallback_)return libtess.tessmono.discardExterior(this.mesh),this.meshCallback_(this.mesh),this.mesh=null,void(this.polygonData_=null)}libtess.mesh.deleteMesh(this.mesh),this.polygonData_=null,this.mesh=null},libtess.GluTesselator.prototype.requireState_=function(e){this.state_!==e&&this.gotoState_(e)},libtess.GluTesselator.prototype.gotoState_=function(e){for(;this.state_!==e;)if(this.state_<e)switch(this.state_){case libtess.GluTesselator.tessState_.T_DORMANT:this.callErrorCallback(libtess.errorType.GLU_TESS_MISSING_BEGIN_POLYGON),this.gluTessBeginPolygon(null);break;case libtess.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorCallback(libtess.errorType.GLU_TESS_MISSING_BEGIN_CONTOUR),this.gluTessBeginContour()}else switch(this.state_){case libtess.GluTesselator.tessState_.T_IN_CONTOUR:this.callErrorCallback(libtess.errorType.GLU_TESS_MISSING_END_CONTOUR),this.gluTessEndContour();break;case libtess.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorCallback(libtess.errorType.GLU_TESS_MISSING_END_POLYGON),this.gluTessEndPolygon()}},libtess.GluTesselator.prototype.addVertex_=function(e,t){var i=this.lastEdge_;null===i?(i=libtess.mesh.makeEdge(this.mesh),libtess.mesh.meshSplice(i,i.sym)):(libtess.mesh.splitEdge(i),i=i.lNext),i.org.data=t,i.org.coords[0]=e[0],i.org.coords[1]=e[1],i.org.coords[2]=e[2],i.winding=1,i.sym.winding=-1,this.lastEdge_=i},libtess.GluTesselator.prototype.callBeginCallback=function(e){this.beginCallback_&&this.beginCallback_(e,this.polygonData_)},libtess.GluTesselator.prototype.callVertexCallback=function(e){this.vertexCallback_&&this.vertexCallback_(e,this.polygonData_)},libtess.GluTesselator.prototype.callEdgeFlagCallback=function(e){this.edgeFlagCallback_&&this.edgeFlagCallback_(e,this.polygonData_)},libtess.GluTesselator.prototype.callEndCallback=function(){this.endCallback_&&this.endCallback_(this.polygonData_)},libtess.GluTesselator.prototype.callCombineCallback=function(e,t,i){return this.combineCallback_?this.combineCallback_(e,t,i,this.polygonData_)||null:null},libtess.GluTesselator.prototype.callErrorCallback=function(e){this.errorCallback_&&this.errorCallback_(e,this.polygonData_)},libtess.GluFace=function(e,t){this.next=e||this,this.prev=t||this,this.anEdge=null,this.data=null,this.inside=!1},libtess.GluHalfEdge=function(e){this.next=e||this,this.sym=null,this.oNext=null,this.lNext=null,this.org=null,this.lFace=null,this.activeRegion=null,this.winding=0},libtess.GluHalfEdge.prototype.rFace=function(){return this.sym.lFace},libtess.GluHalfEdge.prototype.dst=function(){return this.sym.org},libtess.GluHalfEdge.prototype.oPrev=function(){return this.sym.lNext},libtess.GluHalfEdge.prototype.lPrev=function(){return this.oNext.sym},libtess.GluHalfEdge.prototype.dPrev=function(){return this.lNext.sym},libtess.GluHalfEdge.prototype.rPrev=function(){return this.sym.oNext},
libtess.GluHalfEdge.prototype.dNext=function(){return this.rPrev().sym},libtess.GluHalfEdge.prototype.rNext=function(){return this.oPrev().sym},libtess.GluMesh=function(){this.vHead=new libtess.GluVertex,this.fHead=new libtess.GluFace,this.eHead=new libtess.GluHalfEdge,this.eHeadSym=new libtess.GluHalfEdge,this.eHead.sym=this.eHeadSym,this.eHeadSym.sym=this.eHead},libtess.GluMesh.prototype.checkMesh=function(){if(libtess.DEBUG){var e,t,i=this.fHead,n=this.vHead,r=this.eHead,o=i;for(o=i;(t=o.next)!==i;o=t){e=t.anEdge;do e=e.lNext;while(e!==t.anEdge)}var s,a=n;for(a=n;(s=a.next)!==n;a=s){e=s.anEdge;do e=e.oNext;while(e!==s.anEdge)}var u=r;for(u=r;(e=u.next)!==r;u=e);}},libtess.GluVertex=function(e,t){this.next=e||this,this.prev=t||this,this.anEdge=null,this.data=null,this.coords=[0,0,0],this.s=0,this.t=0,this.pqHandle=0},libtess.PriorityQ=function(){this.verts_=[],this.order_=null,this.size_=0,this.initialized_=!1,this.heap_=new libtess.PriorityQHeap},libtess.PriorityQ.prototype.deleteQ=function(){this.heap_=null,this.order_=null,this.verts_=null},libtess.PriorityQ.prototype.init=function(){this.order_=[];for(var e=0;e<this.size_;e++)this.order_[e]=e;var t=function(e){return function(t,i){return libtess.geom.vertLeq(e[t],e[i])?1:-1}}(this.verts_);if(this.order_.sort(t),this.initialized_=!0,this.heap_.init(),libtess.DEBUG){var i=0+this.size_-1;for(e=0;e<i;++e);}},libtess.PriorityQ.prototype.insert=function(e){if(this.initialized_)return this.heap_.insert(e);var t=this.size_++;return this.verts_[t]=e,-(t+1)},libtess.PriorityQ.prototype.extractMin=function(){if(0===this.size_)return this.heap_.extractMin();var e=this.verts_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var t=this.heap_.minimum();if(libtess.geom.vertLeq(t,e))return this.heap_.extractMin()}do--this.size_;while(this.size_>0&&null===this.verts_[this.order_[this.size_-1]])return e},libtess.PriorityQ.prototype.minimum=function(){if(0===this.size_)return this.heap_.minimum();var e=this.verts_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var t=this.heap_.minimum();if(libtess.geom.vertLeq(t,e))return t}return e},libtess.PriorityQ.prototype.remove=function(e){if(e>=0)return void this.heap_.remove(e);for(e=-(e+1),this.verts_[e]=null;this.size_>0&&null===this.verts_[this.order_[this.size_-1]];)--this.size_},libtess.PriorityQHeap=function(){this.heap_=libtess.PriorityQHeap.reallocNumeric_([0],libtess.PriorityQHeap.INIT_SIZE_+1),this.verts_=[null,null],this.handles_=[0,0],this.size_=0,this.max_=libtess.PriorityQHeap.INIT_SIZE_,this.freeList_=0,this.initialized_=!1,this.heap_[1]=1},libtess.PriorityQHeap.INIT_SIZE_=32,libtess.PriorityQHeap.reallocNumeric_=function(e,t){for(var i=new Array(t),n=0;n<e.length;n++)i[n]=e[n];for(;n<t;n++)i[n]=0;return i},libtess.PriorityQHeap.prototype.init=function(){for(var e=this.size_;e>=1;--e)this.floatDown_(e);this.initialized_=!0},libtess.PriorityQHeap.prototype.insert=function(e){var t=++this.size_;2*t>this.max_&&(this.max_*=2,this.handles_=libtess.PriorityQHeap.reallocNumeric_(this.handles_,this.max_+1));var i;return 0===this.freeList_?i=t:(i=this.freeList_,this.freeList_=this.handles_[this.freeList_]),this.verts_[i]=e,this.handles_[i]=t,this.heap_[t]=i,this.initialized_&&this.floatUp_(t),i},libtess.PriorityQHeap.prototype.isEmpty=function(){return 0===this.size_},libtess.PriorityQHeap.prototype.minimum=function(){return this.verts_[this.heap_[1]]},libtess.PriorityQHeap.prototype.extractMin=function(){var e=this.heap_,t=this.verts_,i=this.handles_,n=e[1],r=t[n];return this.size_>0&&(e[1]=e[this.size_],i[e[1]]=1,t[n]=null,i[n]=this.freeList_,this.freeList_=n,--this.size_>0&&this.floatDown_(1)),r},libtess.PriorityQHeap.prototype.remove=function(e){var t=this.heap_,i=this.verts_,n=this.handles_,r=n[e];if(t[r]=t[this.size_],n[t[r]]=r,r<=--this.size_)if(r<=1)this.floatDown_(r);else{var o=i[t[r]],s=i[t[r>>1]];libtess.geom.vertLeq(s,o)?this.floatDown_(r):this.floatUp_(r)}i[e]=null,n[e]=this.freeList_,this.freeList_=e},libtess.PriorityQHeap.prototype.floatDown_=function(e){for(var t=this.heap_,i=this.verts_,n=this.handles_,r=e,o=t[r];;){var s=r<<1;s<this.size_&&libtess.geom.vertLeq(i[t[s+1]],i[t[s]])&&(s+=1);var a=t[s];if(s>this.size_||libtess.geom.vertLeq(i[o],i[a]))return t[r]=o,void(n[o]=r);t[r]=a,n[a]=r,r=s}},libtess.PriorityQHeap.prototype.floatUp_=function(e){for(var t=this.heap_,i=this.verts_,n=this.handles_,r=e,o=t[r];;){var s=r>>1,a=t[s];if(0===s||libtess.geom.vertLeq(i[a],i[o]))return t[r]=o,void(n[o]=r);t[r]=a,n[a]=r,r=s}},libtess.ActiveRegion=function(){this.eUp=null,this.nodeUp=null,this.windingNumber=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperEdge=!1},libtess.ActiveRegion.prototype.regionBelow=function(){return this.nodeUp.getPredecessor().getKey()},libtess.ActiveRegion.prototype.regionAbove=function(){return this.nodeUp.getSuccessor().getKey()},void 0!==module&&(module.exports=libtess),define("libtess",["libtess/libtess.cat"],function(e){return e}),define("libtess/libtess.cat",function(){}),define("standard/Math/Geometry/Triangle3",["standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4","libtess"],function(e,t){"use strict";return{area:function(){const t=new e(0,0,0),i=new e(0,0,0);return function(e,n,r){return t.assign(n).subtract(e).cross(i.assign(r).subtract(e)).abs()/2}}(),normal:function(e,t,i,n){const r=i.x-t.x,o=i.y-t.y,s=i.z-t.z,a=e.x-t.x,u=e.y-t.y,l=e.z-t.z;return n.set(o*l-s*u,s*a-r*l,r*u-o*a),n.normalize()},quadNormal:function(e,t,i,n,r){const o=i.x-e.x,s=i.y-e.y,a=i.z-e.z,u=n.x-t.x,l=n.y-t.y,c=n.z-t.z;return r.set(s*c-a*l,a*u-o*c,o*l-s*u),r.normalize()},triangulatePolygon:function(){const e=function(){function e(e,t){t[t.length]=e}function t(e){e!==libtess.primitiveType.GL_TRIANGLES&&console.log("expected TRIANGLES but got type: "+e)}function i(e){console.log("error callback"),console.log("error number: "+e)}function n(e,t,i){return t[0]}function r(e){}const o=new libtess.GluTesselator;return o.gluTessCallback(libtess.gluEnum.GLU_TESS_VERTEX_DATA,e),o.gluTessCallback(libtess.gluEnum.GLU_TESS_BEGIN,t),o.gluTessCallback(libtess.gluEnum.GLU_TESS_ERROR,i),o.gluTessCallback(libtess.gluEnum.GLU_TESS_COMBINE,n),o.gluTessCallback(libtess.gluEnum.GLU_TESS_EDGE_FLAG,r),o.gluTessProperty(libtess.gluEnum.GLU_TESS_TOLERANCE,0),o.gluTessProperty(libtess.gluEnum.GLU_TESS_WINDING_RULE,libtess.windingRule.GLU_TESS_WINDING_ODD),o}();return function(){const t=arguments[arguments.length-1];e.gluTessBeginPolygon(t);for(let t=0,i=arguments.length-1;t<i;++t){e.gluTessBeginContour();for(const i of arguments[t])e.gluTessVertex(i,i);e.gluTessEndContour()}return e.gluTessEndPolygon(),t}}(),triangulateConvexPolygon:function(e,t){for(let i=1,n=e.length-1;i<n;++i)t.push(e[0],e[i],e[i+1])},getPolygonNormal:function(e,t){t.set(0,0,0);var i=e[0];for(let r=0,o=e.length;r<o;++r){var n=i,i=e[(r+1)%o];t.x+=(n.y-i.y)*(n.z+i.z),t.y+=(n.z-i.z)*(n.x+i.x),t.z+=(n.x-i.x)*(n.y+i.y)}return t.normalize()}}}),define("standard/Math/Algorithms/SAT",[],function(){"use strict";function e(){}function t(e,t,i){i.min=Number.POSITIVE_INFINITY,i.max=Number.NEGATIVE_INFINITY;for(const n of e){const e=n.dot(t);e<i.min&&(i.min=e),e>i.max&&(i.max=e)}}function i(e,t,i,r){return n(i,e,t)||n(e,i,r)}function n(e,t,i){return t<=e&&e<=i}const r={min:0,max:0},o={min:0,max:0};return e.isSeparated=function(e,n,s){for(const a of e)if(t(n,a,r),t(s,a,o),!i(r.min,r.max,o.min,o.max))return!0;return!1},e}),define("standard/Math/Geometry/ViewVolume",["standard/Math/Geometry/Plane3","standard/Math/Geometry/Triangle3","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Numbers/Matrix4","standard/Math/Algorithms/SAT"],function(e,t,i,n,r,o){"use strict";function s(t,r,o){this.viewport=new n(0,0,0,0),this.scissor=new n(0,0,0,0),this.points=[new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0)],this.normals=[new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0)],this.edges=[new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0)],this.planes=[new e(i.Zero,i.Zero),new e(i.Zero,i.Zero),new e(i.Zero,i.Zero),new e(i.Zero,i.Zero),new e(i.Zero,i.Zero),new e(i.Zero,i.Zero)],arguments.length&&this.set(t,r,o)}return s.prototype={constructor:s,set:function(){const e=new r;return function(i,n,r){try{this.viewport.assign(n),this.scissor.assign(r);const o=this.points,a=o[0],u=o[1],l=o[2],c=o[3],h=o[4],d=o[5],p=o[6],f=o[7],g=r[0],m=g+r[2],y=r[1],_=y+r[3];e.assign(i).inverse(),s.unProjectPointMatrix(g,y,0,e,n,a),s.unProjectPointMatrix(m,y,0,e,n,u),s.unProjectPointMatrix(m,_,0,e,n,l),s.unProjectPointMatrix(g,_,0,e,n,c),s.unProjectPointMatrix(g,y,1,e,n,h),s.unProjectPointMatrix(m,y,1,e,n,d),s.unProjectPointMatrix(m,_,1,e,n,p),s.unProjectPointMatrix(g,_,1,e,n,f);const x=this.normals;t.normal(a,u,l,x[0]),t.normal(f,h,a,x[1]),t.normal(p,l,u,x[2]),t.normal(l,p,f,x[3]),t.normal(u,a,h,x[4]),t.normal(h,f,p,x[5]);const w=this.planes;w[0].set(u,x[0]),w[1].set(h,x[1]),w[2].set(l,x[2]),w[3].set(p,x[3]),w[4].set(a,x[4]),w[5].set(f,x[5]),this.edges.tainted=!0,this.valid=!0}catch(e){this.valid=!1}return this}}(),getViewport:function(){return this.viewport},getScissor:function(){return this.scissor},getEdges:function(){const e=this.edges;if(e.tainted){const t=this.points;e[0].assign(t[0]).subtract(t[1]),e[1].assign(t[1]).subtract(t[2]),e[2].assign(t[2]).subtract(t[3]),e[3].assign(t[3]).subtract(t[0]),e[4].assign(t[0]).subtract(t[4]),e[5].assign(t[1]).subtract(t[5]),e[6].assign(t[2]).subtract(t[6]),e[7].assign(t[3]).subtract(t[7]),e.tainted=!1}return e},intersectsSphere:function(e,t){if(this.valid){const i=this.planes;if(i[0].getDistanceToPoint(t)>e)return!1;if(i[1].getDistanceToPoint(t)>e)return!1;if(i[2].getDistanceToPoint(t)>e)return!1;if(i[3].getDistanceToPoint(t)>e)return!1;if(i[4].getDistanceToPoint(t)>e)return!1;if(i[5].getDistanceToPoint(t)>e)return!1}return!0},intersectsBox:function(){const e=[new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0)],t=[new i(0,0,0),new i(0,0,0),new i(0,0,0)],n=[new i(0,0,0),new i(0,0,0),new i(0,0,0)],r=[];for(let e=0;e<24;++e)r.push(new i(0,0,0));return function(i){i.getPoints(e);const s=this.points;if(o.isSeparated(i.getNormals(t),e,s))return!1;if(o.isSeparated(this.normals,e,s))return!1;i.getAxes(n);const a=this.getEdges();for(let e=0;e<3;++e)for(let t=0;t<8;++t)r[3*e+t].assign(n[e]).cross(a[t]);return!o.isSeparated(r,e,s)}}()},Object.assign(s,{unProjectPoint:function(){const e=new r;return function(t,i,n,r,o,s,a){return e.assign(r).multRight(o).inverse(),this.unProjectPointMatrix(t,i,n,e,s,a)}}(),unProjectPointMatrix:function(){const e=new n(0,0,0,0);return function(t,i,n,r,o,s){if(e.set((t-o[0])/o[2]*2-1,(i-o[1])/o[3]*2-1,2*n-1,1),r.multVecMatrix(e),0===e.w)throw new Error("Couldn't unproject point: divisor is 0.");const a=1/e.w;return s.set(e.x*a,e.y*a,e.z*a)}}(),unProjectRay:function(){const e=new i(0,0,0),t=new i(0,0,0),n=new r;return function(i,r,o,a,u,l){return n.assign(o).multRight(a).inverse(),s.unProjectPointMatrix(i,r,0,n,u,e),s.unProjectPointMatrix(i,r,.9,n,u,t),l.setPoints(e,t)}}(),projectPoint:function(){const e=new n(0,0,0,0);return function(t,i,n,r,o){if(e.set(t.x,t.y,t.z,1),n.multVecMatrix(i.multVecMatrix(e)),0===e.w)throw new Error("Couldn't project point: divisor is 0.");const s=1/(2*e.w);return o.set((e.x*s+.5)*r[2]+r[0],(e.y*s+.5)*r[3]+r[1],e.z*s+.5)}}(),projectLine:function(){const e=new i(0,0,0),t=new i(0,0,0);return function(n,r,o,a,u){return s.projectPoint(n.point,r,o,a,e),s.projectPoint(i.multiply(n.direction,1e9).add(n.point),r,o,a,t),e.z=0,t.z=0,u.setPoints(e,t)}}()}),s}),define("x_ite/Rendering/TextureBuffer",["standard/Math/Geometry/ViewVolume","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4"],function(e,t,i){"use strict";function n(e,t,i){const n=e.getContext();if(this.browser=e,this.width=t,this.height=i,this.array=new Uint8Array(t*i*4),this.lastBuffer=n.getParameter(n.FRAMEBUFFER_BINDING),this.buffer=n.createFramebuffer(),n.bindFramebuffer(n.FRAMEBUFFER,this.buffer),this.colorTexture=n.createTexture(),n.bindTexture(n.TEXTURE_2D,this.colorTexture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,t,i,0,n.RGBA,n.UNSIGNED_BYTE,null),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,this.colorTexture,0),n.getVersion()>=2||e.getExtension("WEBGL_depth_texture")){this.depthTexture=n.createTexture(),n.bindTexture(n.TEXTURE_2D,this.depthTexture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST);const e=n.getVersion()>=2?n.DEPTH_COMPONENT24:n.DEPTH_COMPONENT;n.texImage2D(n.TEXTURE_2D,0,e,t,i,0,n.DEPTH_COMPONENT,n.UNSIGNED_INT,null),n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,this.depthTexture,0)}else this.depthBuffer=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,this.depthBuffer),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_COMPONENT16,t,i),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,this.depthBuffer);const r=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;if(n.bindFramebuffer(n.FRAMEBUFFER,this.lastBuffer),!r)throw new Error("Couldn't create frame buffer.")}n.prototype={constructor:n,getWidth:function(){return this.width},getHeight:function(){return this.height},getColorTexture:function(){return this.colorTexture},getDepthTexture:function(){return this.depthTexture},readPixels:function(){const e=this.browser.getContext(),t=this.array,i=this.width,n=this.height;return e.readPixels(0,0,i,n,e.RGBA,e.UNSIGNED_BYTE,t),t},getDepth:function(){const n=new i,r=new t(0,0,0);return function(t,i){try{const o=this.browser.getContext(),s=this.array,a=this.width,u=this.height;let l=0,c=0,h=Number.POSITIVE_INFINITY;n.assign(t).inverse(),o.readPixels(0,0,a,u,o.RGBA,o.UNSIGNED_BYTE,s);for(let e=0,t=0;e<u;++e)for(let i=0;i<a;++i,t+=4){const n=s[t]/255+s[t+1]/65025+s[t+2]/16581375+s[t+3]/4228250625;n<h&&(l=i,c=e,h=n)}return e.unProjectPointMatrix(l,c,h,n,i,r),r.z}catch(e){return 0}}}(),bind:function(){const e=this.browser.getContext();this.lastBuffer=e.getParameter(e.FRAMEBUFFER_BINDING),e.bindFramebuffer(e.FRAMEBUFFER,this.buffer)},unbind:function(){const e=this.browser.getContext();e.bindFramebuffer(e.FRAMEBUFFER,this.lastBuffer)}};for(const e of Reflect.ownKeys(n.prototype))Object.defineProperty(n.prototype,e,{enumerable:!1});return n}),define("standard/Math/Algorithms/MergeSort",[],function(){"use strict";function e(e,t){this.array=e,this.auxiliary=[],t&&(this.compare=t)}return e.prototype={compare:function(e,t){return e<t},sort:function(e,t){this.mergeSort(e,t-1)},mergeSort:function(e,t){if(e<t){const i=e+t>>>1;this.mergeSort(e,i),this.mergeSort(i+1,t),this.merge(e,i,t)}},merge:function(e,t,i){let n,r,o;for(n=0,r=e;r<=t;)this.auxiliary[n++]=this.array[r++];for(n=0,o=e;o<r&&r<=i;)this.compare(this.array[r],this.auxiliary[n])?this.array[o++]=this.array[r++]:this.array[o++]=this.auxiliary[n++];for(;o<r;)this.array[o++]=this.auxiliary[n++]}},e}),define("standard/Math/Geometry/Box3",["standard/Math/Geometry/Triangle3","standard/Math/Numbers/Matrix4","standard/Math/Numbers/Vector3","standard/Math/Algorithms/SAT"],function(e,t,i,n){"use strict";function r(e,i){switch(arguments.length){case 0:return void(this.matrix=new t(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0));case 2:return void(this.matrix=new t(e.x/2,0,0,0,0,e.y/2,0,0,0,0,e.z/2,0,i.x,i.y,i.z,1));case 3:{const e=arguments[0],i=arguments[1],n=(i.x-e.x)/2,r=(i.y-e.y)/2,o=(i.z-e.z)/2,s=(i.x+e.x)/2,a=(i.y+e.y)/2,u=(i.z+e.z)/2;return void(this.matrix=new t(n,0,0,0,0,r,0,0,0,0,o,0,s,a,u,1))}}}return r.prototype={constructor:r,copy:function(){const e=Object.create(r.prototype);return e.matrix=this.matrix.copy(),e},assign:function(e){return this.matrix.assign(e.matrix),this},equals:function(e){return this.matrix.equals(e.matrix)},getMatrix:function(){return this.matrix},set:function(e,t){const i=this.matrix;switch(arguments.length){case 0:return i[0]=.5,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=.5,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=.5,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=0,this;case 2:return i[0]=e.x/2,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=e.y/2,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=e.z/2,i[11]=0,i[12]=t.x,i[13]=t.y,i[14]=t.z,i[15]=1,this;case 3:{const e=arguments[0],t=arguments[1],i=(t.x-e.x)/2,n=(t.y-e.y)/2,r=(t.z-e.z)/2,o=(t.x+e.x)/2,s=(t.y+e.y)/2,a=(t.z+e.z)/2;return this.matrix.set(i,0,0,0,0,n,0,0,0,0,r,0,o,s,a,1),this}}},setExtents:function(e,t){const i=this.matrix,n=(t.x-e.x)/2,r=(t.y-e.y)/2,o=(t.z-e.z)/2,s=(t.x+e.x)/2,a=(t.y+e.y)/2,u=(t.z+e.z)/2;return i[0]=n,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=r,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=o,i[11]=0,i[12]=s,i[13]=a,i[14]=u,i[15]=1,this},getExtents:function(e,t){this.getAbsoluteExtents(e,t),e.add(this.center),t.add(this.center)},getAbsoluteExtents:function(){const e=new i(0,0,0),t=new i(0,0,0),n=new i(0,0,0);return function(i,r){const o=this.matrix,s=o.xAxis,a=o.yAxis,u=o.zAxis;e.assign(a).add(u);const l=u.subtract(a);t.assign(s).add(e),n.assign(s).add(l);const c=e.subtract(s),h=l.subtract(s);i.assign(t),r.assign(t),i.min(c,h,n),r.max(c,h,n),t.negate(),c.negate(),h.negate(),n.negate(),i.min(t,c,h,n),r.max(t,c,h,n)}}(),getPoints:function(){const e=new i(0,0,0),t=new i(0,0,0),n=new i(0,0,0),r=new i(0,0,0);return function(i){const o=this.matrix;e.assign(o.xAxis),t.assign(o.yAxis),n.assign(o.zAxis),r.assign(t).add(n);const s=n.subtract(t);i[0].assign(e).add(r),i[1].assign(r).subtract(e),i[2].assign(s).subtract(e),i[3].assign(e).add(s),i[4].assign(i[2]).negate(),i[5].assign(i[3]).negate(),i[6].assign(i[0]).negate(),i[7].assign(i[1]).negate();const a=this.center;return i[0].add(a),i[1].add(a),i[2].add(a),i[3].add(a),i[4].add(a),i[5].add(a),i[6].add(a),i[7].add(a),i}}(),getAxes:function(e){const t=this.matrix;return e[0].assign(t.xAxis),e[1].assign(t.yAxis),e[2].assign(t.zAxis),e},getNormals:function(){const e=new i(0,0,0),t=new i(0,0,0),n=new i(0,0,0),r=[i.xAxis,i.yAxis,i.zAxis];return function(o){const s=this.matrix;if(e.assign(s.xAxis),t.assign(s.yAxis),n.assign(s.zAxis),0===e.norm()&&(e.assign(t).cross(n),0===e.norm())){for(const i of r)if(e.assign(i).cross(t),0!==e.norm())break;if(0===e.norm()){for(const t of r)if(e.assign(t).cross(n),0!==e.norm())break;0===e.norm()&&e.assign(i.xAxis)}}if(0===t.norm()&&(t.assign(n).cross(e),0===t.norm())){for(const e of r)if(t.assign(e).cross(n),0!==t.norm())break;if(0===t.norm()){for(const i of r)if(t.assign(i).cross(e),0!==t.norm())break;0===t.norm()&&t.assign(i.yAxis)}}if(0===n.norm()&&(n.assign(e).cross(t),0===n.norm())){for(const t of r)if(n.assign(t).cross(e),0!==n.norm())break;if(0===n.norm()){for(const e of r)if(n.assign(e).cross(t),0!==n.norm())break;0===n.norm()&&n.assign(i.zAxis)}}return o[0].assign(t).cross(n).normalize(),o[1].assign(n).cross(e).normalize(),o[2].assign(e).cross(t).normalize(),o}}(),isEmpty:function(){return 0===this.matrix[15]},add:function(){const e=new i(0,0,0),t=new i(0,0,0),n=new i(0,0,0),r=new i(0,0,0);return function(i){return this.isEmpty()?this.assign(i):i.isEmpty()?this:(this.getExtents(e,t),i.getExtents(n,r),this.set(e.min(n),t.max(r),!0))}}(),multLeft:function(e){return this.matrix.multLeft(e),this},multRight:function(e){return this.matrix.multRight(e),this},containsPoint:function(){const e=new i(0,0,0),t=new i(0,0,0);return function(i){return this.getExtents(e,t),e.x<=i.x&&t.x>=i.x&&e.y<=i.y&&t.y>=i.y&&e.z<=i.z&&t.z>=i.z}}(),intersectsBox:function(){const e=[new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0)],t=[new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0)],r=[new i(0,0,0),new i(0,0,0),new i(0,0,0)],o=[new i(0,0,0),new i(0,0,0),new i(0,0,0)],s=[new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0)],a=[new i(0,0,0),new i(0,0,0),new i(0,0,0)];return function(i){if(this.isEmpty())return!1;if(i.isEmpty())return!1;if(this.getPoints(e),i.getPoints(t),n.isSeparated(this.getNormals(a),e,t))return!1;if(n.isSeparated(i.getNormals(a),e,t))return!1;this.getAxes(r),i.getAxes(o);for(let e=0;e<3;++e)for(let t=0;t<3;++t)s[3*e+t].assign(r[e]).cross(o[t]);return!n.isSeparated(s,e,t)}}(),intersectsTriangle:function(){const t=[new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0)],r=[new i(0,0,0),new i(0,0,0),new i(0,0,0)],o=[new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0),new i(0,0,0)],s=[new i(0,0,0),new i(0,0,0),new i(0,0,0)],a=[],u=[new i(0,0,0)],l=[new i(0,0,0),new i(0,0,0),new i(0,0,0)];return function(i,c,h){if(this.isEmpty())return!1;if(this.getPoints(t),a[0]=i,a[1]=c,a[2]=h,n.isSeparated(this.getNormals(s),t,a))return!1;if(e.normal(i,c,h,u[0]),n.isSeparated(u,t,a))return!1;this.getAxes(r),l[0].assign(i).subtract(c),l[1].assign(c).subtract(h),l[2].assign(h).subtract(i);for(let e=0;e<3;++e)for(let t=0;t<3;++t)o[3*e+t].assign(r[e]).cross(l[t]);return!n.isSeparated(o,t,a)}}(),toString:function(){return this.size+", "+this.center}},Object.defineProperty(r.prototype,"size",{get:function(){const e=new i(0,0,0),t=new i(0,0,0);return function(){return this.getAbsoluteExtents(e,t),t.subtract(e)}}(),enumerable:!0,configurable:!1}),Object.defineProperty(r.prototype,"center",{get:function(){return this.matrix.origin},enumerable:!0,configurable:!1}),r}),define("standard/Math/Utility/MatrixStack",[],function(){"use strict";function e(e){return Object.assign([new e],{top:0,set:function(e){this[this.top].assign(e)},get:function(){return this[this.top]},push:function(){const e=++this.top;e<this.length?this[e].assign(this[e-1]):this[e]=this[e-1].copy()},pushMatrix:function(e){const t=++this.top;t<this.length?this[t].assign(e):this[t]=e.copy()},pop:function(){--this.top},clear:function(){this.top=0},size:function(){return this.top+1},identity:function(){this[this.top].identity()},multLeft:function(e){this[this.top].multLeft(e)},translate:function(e){this[this.top].translate(e)},rotate:function(e){this[this.top].rotate(e)},scale:function(e){this[this.top].scale(e)}})}return e}),define("x_ite/Rendering/X3DRenderObject",["x_ite/Rendering/TextureBuffer","x_ite/Rendering/TraverseType","standard/Math/Algorithm","standard/Math/Algorithms/MergeSort","standard/Math/Geometry/Camera","standard/Math/Geometry/Box3","standard/Math/Geometry/ViewVolume","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Utility/MatrixStack"],function(e,t,i,n,r,o,s,a,u,l,c,h){"use strict";function d(e,t){return e.distance<t.distance}function p(t){this.cameraSpaceMatrix=new h(c),this.viewMatrix=new h(c),this.projectionMatrix=new h(c),this.modelViewMatrix=new h(c),this.viewVolumes=[],this.globalObjects=[],this.localObjects=[],this.lights=[],this.shadow=[!1],this.localFogs=[],this.layouts=[],this.textureProjectors=[],this.generatedCubeMapTextures=[],this.shaders=new Set,this.collisions=[],this.numOpaqueShapes=0,this.numTransparentShapes=0,this.numCollisionShapes=0,this.numDepthShapes=0,this.opaqueShapes=[],this.transparentShapes=[],this.transparencySorter=new n(this.transparentShapes,d),this.collisionShapes=[],this.activeCollisions=new Set,this.depthShapes=[],this.speed=0;try{this.depthBuffer=new e(t.getBrowser(),g,m)}catch(e){console.error(e),this.getDepth=function(){return 0}}}function f(e,t){for(var i=0,n=t.length;i<n;++i)e[i]=t[i];e.length=n}const g=16,m=g;return p.prototype={constructor:p,initialize:function(){},isIndependent:function(){return!0},getCameraSpaceMatrix:function(){return this.cameraSpaceMatrix},getViewMatrix:function(){return this.viewMatrix},getProjectionMatrix:function(){return this.projectionMatrix},getModelViewMatrix:function(){return this.modelViewMatrix},getViewVolumes:function(){return this.viewVolumes},getViewVolume:function(){return this.viewVolumes.at(-1)},getGlobalObjects:function(){return this.globalObjects},getLocalObjects:function(){return this.localObjects},getLights:function(){return this.lights},pushShadow:function(e){this.shadow.push(e||this.shadow.at(-1))},popShadow:function(){this.shadow.pop()},setGlobalFog:function(){const e=new c;return function(t){const i=this.localFogs[0]||t.getFogs().pop();e.assign(t.getModelMatrix()).multRight(this.getViewMatrix().get()),i.set(t,e),this.localFog=this.localFogs[0]=i}}(),pushLocalFog:function(e){this.localFogs.push(e),this.localFog=e},popLocalFog:function(){const e=this.localFogs.pop();return this.localFog=this.localFogs.at(-1),e},getLayouts:function(){return this.layouts},getParentLayout:function(){return this.layouts.at(-1)},getTextureProjectors:function(){return this.textureProjectors},getGeneratedCubeMapTextures:function(){return this.generatedCubeMapTextures},getShaders:function(){return this.shaders},getCollisions:function(){return this.collisions},setNumCollisionShapes:function(e){this.numCollisionShapes=e},getNumCollisionShapes:function(){return this.numCollisionShapes},getCollisionShapes:function(){return this.collisionShapes},setNumDepthShapes:function(e){this.numDepthShapes=e},getNumDepthShapes:function(){return this.numDepthShapes},getDepthShapes:function(){return this.depthShapes},setNumOpaqueShapes:function(e){this.numOpaqueShapes=e},getNumOpaqueShapes:function(){return this.numOpaqueShapes},getOpaqueShapes:function(){return this.opaqueShapes},setNumTransparentShapes:function(e){this.numTransparentShapes=e},getNumTransparentShapes:function(){return this.numTransparentShapes},getTransparentShapes:function(){return this.transparentShapes},constrainTranslation:function(e,t){const i=this.getDistance(e)-this.getNavigationInfo().getCollisionRadius();if(i>0){const t=e.abs();return t>i?e.normalize().multiply(i):e}return t?this.constrainTranslation(e.normalize().multiply(i),!1):e.assign(a.Zero)},getDistance:function(){const e=new c,t=new c,i=new l(0,0,1,0),n=new a(0,0,0),o=new l(0,0,1,0);return function(s){try{const u=performance.now(),l=this.getViewpoint(),c=this.getNavigationInfo(),h=c.getCollisionRadius(),d=c.getStepHeight()-c.getAvatarHeight(),p=c.getNearValue(),f=c.getAvatarHeight();r.ortho(-h,h,Math.min(d,-h),h,p,Math.max(2*h,2*f),e),i.assign(l.orientation_.getValue()).inverse().multRight(l.getOrientation()),o.setFromToVec(a.zAxis,n.assign(s).negate()).multRight(i),l.straightenHorizon(o),t.assign(l.getModelMatrix()),t.translate(l.getUserPosition()),t.rotate(o),t.inverse(),t.multRight(e),t.multLeft(l.getCameraSpaceMatrix()),this.getProjectionMatrix().pushMatrix(t);const g=this.getDepth(e);return this.getProjectionMatrix().pop(),this.collisionTime+=performance.now()-u,-g}catch(e){console.log(e)}}}(),getDepth:function(){const e=new u(0,0,g,m),t=new s;return t.set(c.Identity,e,e),function(i){this.depthBuffer.bind(),this.viewVolumes.push(t),this.depth(this.collisionShapes,this.numCollisionShapes),this.viewVolumes.pop();const n=this.depthBuffer.getDepth(i,e);return this.depthBuffer.unbind(),n}}(),render:function(e,i,n){switch(e){case t.COLLISION:this.numCollisionShapes=0,i.call(n,e,this),this.collide(),this.gravite();break;case t.SHADOW:this.numDepthShapes=0,i.call(n,e,this),this.depth(this.depthShapes,this.numDepthShapes);break;case t.DISPLAY:this.lightIndex=0,this.numOpaqueShapes=0,this.numTransparentShapes=0,this.setGlobalFog(this.getFog()),i.call(n,e,this),this.draw()}},addCollisionShape:function(){const e=new a(0,0,0),t=new a(0,0,0);return function(i){const n=this.getModelViewMatrix().get();n.multDirMatrix(e.assign(i.getBBoxSize())),n.multVecMatrix(t.assign(i.getBBoxCenter()));const r=e.abs()/2,o=this.viewVolumes.at(-1);if(o.intersectsSphere(r,t)){const e=this.numCollisionShapes++;e===this.collisionShapes.length&&this.collisionShapes.push({renderer:this,browser:this.getBrowser(),modelViewMatrix:new Float32Array(16),collisions:[],clipPlanes:[]});const t=this.collisionShapes[e];return t.modelViewMatrix.set(n),t.shapeNode=i,t.scissor=o.getScissor(),f(t.collisions,this.collisions),f(t.clipPlanes,this.localObjects),!0}return!1}}(),addDepthShape:function(){const e=new a(0,0,0),t=new a(0,0,0);return function(i){const n=this.getModelViewMatrix().get();n.multDirMatrix(e.assign(i.getBBoxSize())),n.multVecMatrix(t.assign(i.getBBoxCenter()));const r=e.abs()/2,o=this.viewVolumes.at(-1);if(o.intersectsSphere(r,t)){const e=this.numDepthShapes++;e===this.depthShapes.length&&this.depthShapes.push({renderer:this,browser:this.getBrowser(),modelViewMatrix:new Float32Array(16),clipPlanes:[]});const t=this.depthShapes[e];return t.modelViewMatrix.set(n),t.shapeNode=i,t.scissor=o.getScissor(),f(t.clipPlanes,this.localObjects),!0}return!1}}(),addDisplayShape:function(){const e=new a(0,0,0),t=new a(0,0,0);return function(i){const n=this.getModelViewMatrix().get();n.multDirMatrix(e.assign(i.getBBoxSize())),n.multVecMatrix(t.assign(i.getBBoxCenter()));const r=e.abs()/2,o=this.viewVolumes.at(-1);if(o.intersectsSphere(r,t)){if(i.getTransparent()){const e=this.numTransparentShapes++;e===this.transparentShapes.length&&this.transparentShapes.push(this.createShapeContext(!0));var s=this.transparentShapes[e]}else{const e=this.numOpaqueShapes++;e===this.opaqueShapes.length&&this.opaqueShapes.push(this.createShapeContext(!1));var s=this.opaqueShapes[e]}return s.modelViewMatrix.set(n),s.scissor.assign(o.getScissor()),s.shapeNode=i,s.textureNode=null,s.distance=t.z,s.fogNode=this.localFog,s.shadow=this.shadow.at(-1),f(s.localObjects,this.localObjects),!0}return!1}}(),createShapeContext:function(e){return{renderer:this,browser:this.getBrowser(),transparent:e,modelViewMatrix:new Float32Array(16),scissor:new u(0,0,0,0),localObjects:[]}},collide:function(){const e=new c,t=new c,n=new o(a.Zero,a.Zero),r=new a(0,0,0);return function(){const o=new Set,s=2.2*this.getNavigationInfo().getCollisionRadius();r.set(s,s,s);for(let i=0,s=this.numCollisionShapes;i<s;++i)try{const s=this.collisionShapes[i],u=s.collisions;if(u.length&&(n.set(r,a.Zero),n.multRight(e.assign(s.modelViewMatrix).inverse()),s.shapeNode.intersectsBox(n,s.clipPlanes,t.assign(s.modelViewMatrix))))for(const e of u)o.add(e)}catch(e){console.log(e)}if(this.activeCollisions.size){const e=o.size?i.set_difference(this.activeCollisions,o,new Set):this.activeCollisions;for(const t of e)t.set_active(!1)}this.activeCollisions=o;for(const e of o)e.set_active(!0)}}(),gravite:function(){const e=new c,t=new c,i=new a(0,0,0),n=new l(0,0,1,0);return function(){try{const o=this.getBrowser(),s=o.getDepthShader();if(s.getValid()){if(o.getActiveLayer()===this){if("WALK"!==o.getCurrentViewer())return}else if("WALK"!==this.getNavigationInfo().getViewer())return;const s=this.getNavigationInfo(),u=this.getViewpoint(),l=s.getCollisionRadius(),c=s.getNearValue(),h=s.getAvatarHeight(),d=s.getStepHeight();r.ortho(-l,l,-l,l,c,Math.max(2*l,2*h),e);const p=u.getUpVector(),f=n.setFromToVec(a.zAxis,p);t.assign(u.getModelMatrix()),t.translate(u.getUserPosition()),t.rotate(f),t.inverse(),t.multRight(e),t.multLeft(u.getCameraSpaceMatrix()),this.getProjectionMatrix().pushMatrix(t);let g=-this.getDepth(e);this.getProjectionMatrix().pop(),g-=h;const m=n.setFromToVec(a.yAxis,p);if(g>0){const e=this.speed?o.getCurrentFrameRate():1e6;this.speed-=o.getBrowserOptions().Gravity_.getValue()/e;let t=this.speed/e;t<-g&&(t=-g,this.speed=0),u.positionOffset_=u.positionOffset_.getValue().add(m.multVecRot(i.set(0,t,0)))}else this.speed=0,(g=-g)>.01&&g<d&&(this.constrainTranslation(m.multVecRot(i.set(0,g,0)),!1),u.positionOffset_=i.add(u.positionOffset_.getValue()))}}catch(e){
console.log(e)}}}(),depth:function(){const e=new Float32Array(16);return function(t,i){const n=this.getBrowser(),r=n.getContext(),o=this.getViewVolume().getViewport(),s=n.getDepthShader();if(s.getValid()){s.enable(r),e.set(this.getProjectionMatrix().get()),r.uniformMatrix4fv(s.x3d_ProjectionMatrix,!1,e),r.viewport(o[0],o[1],o[2],o[3]),r.scissor(o[0],o[1],o[2],o[3]),r.clearColor(1,0,0,0),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT),r.enable(r.DEPTH_TEST),r.depthMask(!0),r.disable(r.BLEND),r.disable(r.CULL_FACE);for(let e=0;e<i;++e){const i=t[e],n=i.scissor;r.scissor(n.x,n.y,n.z,n.w),s.setLocalObjects(r,i.clipPlanes),r.uniformMatrix4fv(s.x3d_ModelViewMatrix,!1,i.modelViewMatrix),i.shapeNode.depth(r,i,s)}s.disable(r)}}}(),draw:function(){const e=new Int32Array(4),t=new Float32Array(16),i=new Float32Array(16);return function(){const n=this.getBrowser(),r=n.getContext(),o=this.getViewVolume().getViewport(),s=this.shaders,a=this.lights,u=this.textureProjectors,l=this.generatedCubeMapTextures;if(this.isIndependent()){for(const e of a)e.renderShadowMap(this);for(const e of l)e.renderTexture(this)}n.getHeadlight().setGlobalVariables(this);for(const e of a)e.setGlobalVariables(this);for(const e of u)e.setGlobalVariables(this);r.viewport(o[0],o[1],o[2],o[3]),r.scissor(o[0],o[1],o[2],o[3]),r.clear(r.DEPTH_BUFFER_BIT),this.getBackground().display(r,this,o),e.set(o),i.set(this.getCameraSpaceMatrix().get()),t.set(this.getProjectionMatrix().get()),n.hasPointShader()&&s.add(n.getPointShader()),n.hasLineShader()&&s.add(n.getLineShader()),n.hasUnlitShader()&&s.add(n.getUnlitShader()),n.hasShadowShader()&&s.add(n.getShadowShader()),s.add(n.getDefaultShader()),s.forEach(function(n){n.setGlobalUniforms(r,this,i,t,e)},this),r.enable(r.DEPTH_TEST),r.depthMask(!0),r.disable(r.BLEND);const c=this.opaqueShapes;for(let e=0,t=this.numOpaqueShapes;e<t;++e){const t=c[e],i=t.scissor;r.scissor(i.x,i.y,i.z,i.w),t.shapeNode.display(r,t)}r.depthMask(!1),r.enable(r.BLEND);const h=this.transparentShapes;this.transparencySorter.sort(0,this.numTransparentShapes);for(let e=0,t=this.numTransparentShapes;e<t;++e){const t=h[e],i=t.scissor;r.scissor(i.x,i.y,i.z,i.w),t.shapeNode.display(r,t)}r.depthMask(!0),r.disable(r.BLEND),r.activeTexture(r.TEXTURE0);const d=this.globalObjects;if(this.isIndependent()){const e=n.getLocalObjects();for(const t of e)t.dispose();e.length=0;for(const e of d)e.dispose()}s.clear(),d.length=0,a.length=0,u.length=0,l.length=0}}()},p}),define("x_ite/Components/Grouping/X3DBoundedObject",["x_ite/Fields","x_ite/Base/X3DCast","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Box3"],function(e,t,i,n,r,o){"use strict";function s(t){this.addType(i.X3DBoundedObject),this.addChildObjects("transformSensors_changed",new e.SFTime),this.bboxSize_.setUnit("length"),this.bboxCenter_.setUnit("length"),this.childBBox=new o,this.transformSensorNodes=new Set}return s.prototype={constructor:s,initialize:function(){},getDefaultBBoxSize:function(){const e=new n(-1,-1,-1);return function(){return e}}(),getBBox:function(e,t,i){const n=this.childBBox;t.set();for(var r=0,o=e.length;r<o;++r){const o=e[r];o.getBBox&&t.add(o.getBBox(n,i))}return t},displayBBox:function(){const e=new o,t=new r;return function(i,n){const r=n.getModelViewMatrix();this.getBBox(e),t.set(e.center,null,e.size),r.push(),r.multLeft(t),this.getBrowser().getBBoxNode().traverse(i,n),r.pop()}}(),addTransformSensor:function(e){this.transformSensorNodes.add(e),this.transformSensors_changed_=this.getBrowser().getCurrentTime()},removeTransformSensor:function(e){this.transformSensorNodes.delete(e),this.transformSensors_changed_=this.getBrowser().getCurrentTime()},getTransformSensors:function(){return this.transformSensorNodes}},s}),define("x_ite/Components/Grouping/X3DGroupingNode",["x_ite/Components/Core/X3DChildNode","x_ite/Components/Grouping/X3DBoundedObject","x_ite/Rendering/TraverseType","x_ite/Base/X3DConstants","x_ite/Base/X3DCast"],function(e,t,i,n,r){"use strict";function o(e){return e?e.getValue().getId():-1}function s(e,t,i,n,r,s){function a(e){return u[o(e)]}const u={};for(let e=r;e<s;++e)u[o(n[e])]=!0;return e.remove(t,i,a)}function a(i){e.call(this,i),t.call(this,i),this.addType(n.X3DGroupingNode),this.hidden=!1,this.allowedTypes=new Set,this.clipPlaneNodes=[],this.localFogNodes=[],this.lightNodes=[],this.textureProjectorNodes=[],this.pointingDeviceSensorNodes=[],this.maybeCameraObjects=[],this.cameraObjects=[],this.maybePickableSensorNodes=[],this.pickableSensorNodes=[],this.pickableObjects=[],this.childNodes=[],this.displayNodes=[],this.visibleNodes=[],this.boundedObjects=[]}return a.prototype=Object.assign(Object.create(e.prototype),t.prototype,{constructor:a,initialize:function(){e.prototype.initialize.call(this),t.prototype.initialize.call(this),this.transformSensors_changed_.addInterest("set_transformSensors__",this),this.addChildren_.addInterest("set_addChildren__",this),this.removeChildren_.addInterest("set_removeChildren__",this),this.children_.addInterest("set_children__",this),this.set_children__()},getBBox:function(e,t){return this.getSubBBox(e,t)},getSubBBox:function(e,i){return this.bboxSize_.getValue().equals(this.getDefaultBBoxSize())?t.prototype.getBBox.call(this,this.visibleNodes,e,i):e.set(this.bboxSize_.getValue(),this.bboxCenter_.getValue())},setHidden:function(e){e!==this.hidden&&(this.hidden=e,this.set_children__())},setAllowedTypes:function(){const e=this.allowedTypes;e.clear();for(const t of arguments)e.add(t)},set_addChildren__:function(){0!==this.addChildren_.length&&(this.addChildren_.setTainted(!0),this.addChildren_.erase(s(this.addChildren_,0,this.addChildren_.length,this.children_,0,this.children_.length),this.addChildren_.length),this.children_.isTainted()||(this.children_.removeInterest("set_children__",this),this.children_.addInterest("connectChildren",this)),this.children_.insert(this.children_.length,this.addChildren_,0,this.addChildren_.length),this.add(this.addChildren_),this.addChildren_.set([]),this.addChildren_.setTainted(!1))},set_removeChildren__:function(){0!==this.removeChildren_.length&&(this.children_.length>0&&(this.children_.isTainted()||(this.children_.removeInterest("set_children__",this),this.children_.addInterest("connectChildren",this)),this.children_.erase(s(this.children_,0,this.children_.length,this.removeChildren_,0,this.removeChildren_.length),this.children_.length),this.remove(this.removeChildren_)),this.removeChildren_.set([]))},set_children__:function(){this.clear(),this.add(this.children_)},connectChildren:function(){this.children_.removeInterest("connectChildren",this),this.children_.addInterest("set_children__",this)},clear:function(){for(const e of this.maybePickableSensorNodes)e.isPickableObject_.removeInterest("set_pickableObjects__",this);for(const e of this.childNodes)e.isCameraObject_.removeInterest("set_cameraObjects__",this),e.isPickableObject_.removeInterest("set_pickableObjects__",this),r(n.X3DBoundedObject,e)&&(e.visible_.removeInterest("set_visibles__",this),e.bboxDisplay_.removeInterest("set_bboxDisplays__",this));this.clipPlaneNodes.length=0,this.localFogNodes.length=0,this.lightNodes.length=0,this.textureProjectorNodes.length=0,this.pointingDeviceSensorNodes.length=0,this.maybeCameraObjects.length=0,this.maybePickableSensorNodes.length=0,this.childNodes.length=0},add:function(e){if(!this.hidden){for(const t of e)if(t)try{const e=t.getValue().getInnerNode(),i=e.getType();for(let t=i.length-1;t>=0;--t){switch(i[t]){case n.X3DPointingDeviceSensorNode:this.pointingDeviceSensorNodes.push(e);break;case n.ClipPlane:this.clipPlaneNodes.push(e);break;case n.LocalFog:this.localFogNodes.push(e);break;case n.X3DTextureProjectorNode:this.textureProjectorNodes.push(e);break;case n.X3DLightNode:this.lightNodes.push(e);break;case n.X3DBindableNode:this.maybeCameraObjects.push(e);break;case n.TransformSensor:case n.X3DPickSensorNode:e.isPickableObject_.addInterest("set_pickableObjects__",this),this.maybePickableSensorNodes.push(e);break;case n.X3DBackgroundNode:case n.X3DChildNode:e.isCameraObject_.addInterest("set_cameraObjects__",this),e.isPickableObject_.addInterest("set_pickableObjects__",this),r(n.X3DBoundedObject,e)&&(e.visible_.addInterest("set_visibles__",this),e.bboxDisplay_.addInterest("set_bboxDisplays__",this)),this.maybeCameraObjects.push(e),this.childNodes.push(e);break;case n.BooleanFilter:case n.BooleanToggle:case n.NurbsOrientationInterpolator:case n.NurbsPositionInterpolator:case n.NurbsSurfaceInterpolator:case n.TimeSensor:case n.X3DFollowerNode:case n.X3DInfoNode:case n.X3DInterpolatorNode:case n.X3DKeyDeviceSensorNode:case n.X3DLayoutNode:case n.X3DScriptNode:case n.X3DSequencerNode:case n.X3DTriggerNode:break;default:continue}break}}catch(e){}this.set_pickableObjects__(),this.set_displayNodes__(),this.set_visibles__(),this.set_bboxDisplays__()}},remove:function(e){for(const i of e)if(i)try{const e=i.getValue().getInnerNode(),o=e.getType();for(let i=o.length-1;i>=0;--i){switch(o[i]){case n.X3DPointingDeviceSensorNode:{const t=this.pointingDeviceSensorNodes.indexOf(e);t>=0&&this.pointingDeviceSensorNodes.splice(t,1);break}case n.ClipPlane:{const t=this.clipPlaneNodes.indexOf(e);t>=0&&this.clipPlaneNodes.splice(t,1);break}case n.LocalFog:{const t=this.localFogNodes.indexOf(e);t>=0&&this.localFogNodes.splice(t,1);break}case n.X3DTextureProjectorNode:{const t=this.textureProjectorNodes.indexOf(e);t>=0&&this.textureProjectorNodes.splice(t,1);break}case n.X3DLightNode:{const t=this.lightNodes.indexOf(e);t>=0&&this.lightNodes.splice(t,1);break}case n.X3DBindableNode:{const t=this.maybeCameraObjects.indexOf(e);t>=0&&this.maybeCameraObjects.splice(t,1);break}case n.TransformSensor:case n.X3DPickSensorNode:{e.isPickableObject_.removeInterest("set_pickableObjects__",this);const t=this.maybePickableSensorNodes.indexOf(e);t>=0&&this.maybePickableSensorNodes.splice(t,1);break}case n.X3DBackgroundNode:case n.X3DChildNode:e.isCameraObject_.removeInterest("set_cameraObjects__",this),e.isPickableObject_.removeInterest("set_pickableObjects__",this),r(n.X3DBoundedObject,e)&&(e.visible_.removeInterest("set_visibles__",this),e.bboxDisplay_.removeInterest("set_bboxDisplays__",this));var t=this.maybeCameraObjects.indexOf(e);t>=0&&this.maybeCameraObjects.splice(t,1);var t=this.childNodes.indexOf(e);t>=0&&this.childNodes.splice(t,1);break;case n.BooleanFilter:case n.BooleanToggle:case n.NurbsOrientationInterpolator:case n.NurbsPositionInterpolator:case n.NurbsSurfaceInterpolator:case n.TimeSensor:case n.X3DFollowerNode:case n.X3DInfoNode:case n.X3DInterpolatorNode:case n.X3DKeyDeviceSensorNode:case n.X3DLayoutNode:case n.X3DScriptNode:case n.X3DSequencerNode:case n.X3DTriggerNode:break;default:continue}break}}catch(e){}this.set_pickableObjects__(),this.set_displayNodes__(),this.set_visibles__(),this.set_bboxDisplays__()},set_cameraObjects__:function(){const e=this.cameraObjects;e.length=0;for(const t of this.maybeCameraObjects)t.getCameraObject()&&(r(n.X3DBoundedObject,t)?t.visible_.getValue()&&e.push(t):e.push(t));this.setCameraObject(Boolean(e.length))},set_pickableObjects__:function(){const e=this.pickableSensorNodes,t=this.pickableObjects;e.length=0,t.length=0;for(const t of this.maybePickableSensorNodes)t.getPickableObject()&&e.push(t);for(const e of this.childNodes)e.getPickableObject()&&t.push(e);this.set_transformSensors__()},set_transformSensors__:function(){this.setPickableObject(Boolean(this.getTransformSensors().size||this.pickableSensorNodes.length||this.pickableObjects.length))},set_displayNodes__:function(){const e=this.displayNodes;e.length=0;for(const t of this.clipPlaneNodes)e.push(t);for(const t of this.localFogNodes)e.push(t);for(const t of this.lightNodes)e.push(t);for(const t of this.textureProjectorNodes)e.push(t)},set_visibles__:function(){const e=this.childNodes,t=this.visibleNodes;t.length=0;for(const i of e)r(n.X3DBoundedObject,i)?i.visible_.getValue()&&t.push(i):t.push(i);this.set_cameraObjects__()},set_bboxDisplays__:function(){const e=this.boundedObjects;e.length=0;for(const t of this.childNodes)r(n.X3DBoundedObject,t)&&t.bboxDisplay_.getValue()&&e.push(t)},traverse:function(e,t){switch(e){case i.POINTER:{const i=this.pointingDeviceSensorNodes,n=this.clipPlaneNodes;if(i.length){const e=new Map;t.getBrowser().getSensors().push(e);for(const n of i)n.push(t,e)}for(const e of n)e.push(t);for(const i of this.childNodes)i.traverse(e,t);for(const e of n)e.pop(t);return void(i.length&&t.getBrowser().getSensors().pop())}case i.CAMERA:for(const i of this.cameraObjects)i.traverse(e,t);return;case i.PICKING:{if(this.getTransformSensors().size){const e=t.getModelViewMatrix().get();for(const t of this.getTransformSensors())t.collect(e)}for(const i of this.pickableSensorNodes)i.traverse(e,t);const i=t.getBrowser(),n=i.getPickingHierarchy();if(n.push(this),i.getPickable().at(-1))for(const i of this.childNodes)i.traverse(e,t);else for(const i of this.pickableObjects)i.traverse(e,t);return void n.pop()}case i.COLLISION:{const i=this.clipPlaneNodes;for(const e of i)e.push(t);for(const i of this.childNodes)i.traverse(e,t);for(const e of i)e.pop(t);return}case i.SHADOW:{const i=this.clipPlaneNodes;for(const e of i)e.push(t);for(const i of this.visibleNodes)i.traverse(e,t);for(const e of i)e.push(t);return}case i.DISPLAY:{const i=this.displayNodes;for(const e of i)e.push(t,this);for(const i of this.visibleNodes)i.traverse(e,t);for(const i of this.boundedObjects)i.displayBBox(e,t);for(const e of i)e.pop(t);return}}}}),a}),define("x_ite/Components/Layering/X3DViewportNode",["x_ite/Components/Grouping/X3DGroupingNode","x_ite/Base/X3DConstants"],function(e,t){"use strict";function i(i){e.call(this,i),this.addType(t.X3DViewportNode)}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i}),i}),define("x_ite/Execution/BindableStack",["x_ite/Base/X3DBaseNode"],function(e){"use strict";function t(t,i){e.call(this,t),this.array=[i],this.transitionNode=i.create(t)}t.prototype=Object.assign(Object.create(e.prototype),{constructor:t,getTypeName:function(){return"BindableStack"},get:function(){return this.array},top:function(){return this.transitionNode.transitionActive_.getValue()?this.transitionNode:this.array.at(-1)},pushOnTop:function(e){e!==this.array[0]&&(this.array.at(-1).isBound_=!1,this.array.push(e)),e.isBound_=!0,e.bindTime_=this.getBrowser().getCurrentTime(),this.addNodeEvent()},update:function(e,t,i){if(0!==t.length||0!==i.length){const n=this.top(),r=this.array.at(-1);for(const e of t){const t=this.array.indexOf(e);t>0&&this.array.splice(t,1)}r!==this.array[0]&&i.some(e=>!e.set_bind_.getValue()&&e===r)&&this.array.pop();for(const e of i)if(e.set_bind_.getValue()){const t=this.array.indexOf(e);t>-1&&this.array.splice(t,1),this.array.push(e)}const o=this.array.at(-1);o!==r&&(r.set_bind_=!1,r.isBound_=!1,o.set_bind_=!0,o.isBound_=!0,o.bindTime_=this.getBrowser().getCurrentTime(),this.transitionNode=o.create(this.getExecutionContext()),this.transitionNode.setup(),this.transitionNode.transitionStart(e,n,o),this.addNodeEvent())}}});for(const e of Reflect.ownKeys(t.prototype))Object.defineProperty(t.prototype,e,{enumerable:!1});return t}),define("x_ite/Execution/BindableList",["x_ite/Base/X3DBaseNode","x_ite/Components/Core/X3DPrototypeInstance"],function(e,t){"use strict";function i(t,i){e.call(this,t),this.collected=[i],this.array=[i],this.updateTime=0,this.removedNodes=[]}function n(e,t){if(e.length!==t.length)return!1;for(let i=0;i<e.length;++i)if(e[i]!==t[i])return!1;return!0}i.prototype=Object.assign(Object.create(e.prototype),{constructor:i,getTypeName:function(){return"BindableList"},get:function(){return this.array},getBound:function(e){if(this.array.length>1){const i=this.getMainScene();if(e&&e.length)for(let n=1,r=this.array.length;n<r;++n){const r=this.array[n],o=r.getExecutionContext().getNode(),s=o instanceof t?o.getScene():r.getScene();if(s===i&&r.getName()==e)return r}for(let e=1,n=this.array.length;e<n;++e){const n=this.array[e],r=n.getExecutionContext().getNode(),o=r instanceof t?r.getScene():n.getScene();if(o===i&&n.isBound_.getValue())return n}for(let e=1,n=this.array.length;e<n;++e){const n=this.array[e],r=n.getExecutionContext().getNode(),o=r instanceof t?r.getScene():n.getScene();if(o===i)return n}}return this.array[0]},push:function(e){return this.collected.push(e)},update:function(e,t){const i=this.collected.filter(e=>e.set_bind_.getModificationTime()>this.updateTime),r=this.removedNodes;if(!n(this.collected,this.array)){for(const e of this.array)this.collected.indexOf(e)===-1&&r.push(e);const e=this.array;this.array=this.collected,this.collected=e}this.collected.length=1,t.update(e,r,i),r.length=0,this.updateTime=performance.now()}});for(const e of Reflect.ownKeys(i.prototype))Object.defineProperty(i.prototype,e,{enumerable:!1});return i}),define("x_ite/Components/Navigation/NavigationInfo",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Core/X3DBindableNode","x_ite/Rendering/TraverseType","x_ite/Base/X3DConstants"],function(e,t,i,n,r,o){"use strict";function s(t){n.call(this,t),this.addType(o.NavigationInfo),this.addChildObjects("transitionStart",new e.SFBool,"availableViewers",new e.MFString,"viewer",new e.SFString("EXAMINE")),this.avatarSize_.setUnit("length"),this.speed_.setUnit("speed"),this.visibilityLimit_.setUnit("speed")}const a={TELEPORT:!0,LINEAR:!0,ANIMATE:!0};return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOnly,"set_bind",new e.SFBool),new t(o.inputOutput,"type",new e.MFString("EXAMINE","ANY")),new t(o.inputOutput,"avatarSize",new e.MFFloat(.25,1.6,.75)),new t(o.inputOutput,"speed",new e.SFFloat(1)),new t(o.inputOutput,"headlight",new e.SFBool(!0)),new t(o.inputOutput,"visibilityLimit",new e.SFFloat),new t(o.inputOutput,"transitionType",new e.MFString("LINEAR")),new t(o.inputOutput,"transitionTime",new e.SFTime(1)),new t(o.outputOnly,"transitionComplete",new e.SFBool),new t(o.outputOnly,"isBound",new e.SFBool),new t(o.outputOnly,"bindTime",new e.SFTime)]),getTypeName:function(){return"NavigationInfo"},getComponentName:function(){return"Navigation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.type_.addInterest("set_type__",this),this.headlight_.addInterest("set_headlight__",this),this.transitionStart_.addInterest("set_transitionStart__",this),this.transitionComplete_.addInterest("set_transitionComplete__",this),this.isBound_.addInterest("set_isBound__",this),this.set_type__(),this.set_headlight__()},getViewer:function(){return this.viewer_.getValue()},getCollisionRadius:function(){return this.avatarSize_.length>0&&this.avatarSize_[0]>0?this.avatarSize_[0]:.25},getAvatarHeight:function(){return this.avatarSize_.length>1?this.avatarSize_[1]:1.6},getStepHeight:function(){return this.avatarSize_.length>2?this.avatarSize_[2]:.75},getNearValue:function(){const e=this.getCollisionRadius();return 0===e?1e-5:e/2},getFarValue:function(e){return this.visibilityLimit_.getValue()?this.visibilityLimit_.getValue():e.getMaxFarValue()},getTransitionType:function(){for(const e of this.transitionType_){const t=a[e];if(t)return e}return"LINEAR"},set_type__:function(){this.viewer_="EXAMINE";for(const e of this.type_){switch(e){case"EXAMINE":case"WALK":case"FLY":case"LOOKAT":case"PLANE":case"NONE":this.viewer_=e;break;case"PLANE_create3000.de":this.viewer_="PLANE";break;default:continue}break}let e=!1,t=!1,i=!1,n=!1,r=!1,o=!1;if(this.type_.length)for(const s of this.type_){switch(s){case"EXAMINE":e=!0;continue;case"WALK":t=!0;continue;case"FLY":i=!0;continue;case"LOOKAT":o=!0;continue;case"PLANE":n=!0;continue;case"NONE":r=!0;continue;case"ANY":e=!0,t=!0,i=!0,n=!0,r=!0,o=!0;break;default:e=!0;continue}break}else e=!0,t=!0,i=!0,n=!0,r=!0,o=!0;this.availableViewers_.length=0,e&&this.availableViewers_.push("EXAMINE"),t&&this.availableViewers_.push("WALK"),i&&this.availableViewers_.push("FLY"),n&&this.availableViewers_.push("PLANE"),o&&this.availableViewers_.push("LOOKAT"),r&&this.availableViewers_.push("NONE")},set_headlight__:function(){this.headlight_.getValue()?delete this.enable:this.enable=Function.prototype},set_transitionStart__:function(){this.transitionActive_.getValue()||(this.transitionActive_=!0)},set_transitionComplete__:function(){this.transitionActive_.getValue()&&(this.transitionActive_=!1)},set_isBound__:function(){this.isBound_.getValue()||this.transitionActive_.getValue()&&(this.transitionActive_=!1)},enable:function(e,t){e===r.DISPLAY&&this.headlight_.getValue()&&t.getGlobalObjects().push(t.getBrowser().getHeadlight())},traverse:function(e,t){e===r.CAMERA&&t.getLayer().getNavigationInfos().push(this)}}),s}),define("standard/Utility/ObjectCache",[],function(){"use strict";return function(e){return{stack:[],last:-1,pop:function(){if(this.last>-1){const e=this.stack[this.last];return this.last--,e}return new e},push:function(e){return this.last++,this.stack[this.last]=e},clear:function(){this.stack.length=0,this.last=-1}}}}),define("x_ite/Components/EnvironmentalEffects/X3DFogObject",["x_ite/Base/X3DConstants","standard/Math/Numbers/Matrix3","standard/Utility/ObjectCache"],function(e,t,i){"use strict";function n(){this.fogMatrix=new Float32Array(9)}function r(t){this.addType(e.X3DFogObject),this.visibilityRange_.setUnit("length"),this.hidden=!1}var o=i(n);return n.prototype={constructor:n,set:function(e,i){this.fogNode=e;try{this.fogMatrix.set(i.submatrix.inverse())}catch(e){this.fogMatrix.set(t.Identity)}},setShaderUniforms:function(e,t){if(!t.hasFog(this)){var i=this.fogNode,n=Math.max(0,i.visibilityRange_.getValue());if(i.getHidden()||0===n)e.uniform1i(t.x3d_FogType,0);else{var r=i.color_.getValue();e.uniform1i(t.x3d_FogType,i.fogType),e.uniform3f(t.x3d_FogColor,r.r,r.g,r.b),e.uniform1f(t.x3d_FogVisibilityRange,n),e.uniformMatrix3fv(t.x3d_FogMatrix,!1,this.fogMatrix)}}},dispose:function(){o.push(this)}},r.prototype={constructor:r,initialize:function(){this.fogType_.addInterest("set_fogType__",this),this.set_fogType__()},set_fogType__:function(){switch(this.fogType_.getValue()){case"EXPONENTIAL":this.fogType=2;break;default:this.fogType=1}},setHidden:function(e){this.hidden=e,this.getBrowser().addBrowserEvent()},getHidden:function(){return this.hidden},getFogs:function(){return o}},r}),define("x_ite/Components/EnvironmentalEffects/Fog",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Core/X3DBindableNode","x_ite/Components/EnvironmentalEffects/X3DFogObject","x_ite/Rendering/TraverseType","x_ite/Base/X3DConstants","standard/Math/Numbers/Matrix4"],function(e,t,i,n,r,o,s,a){"use strict";function u(e){n.call(this,e),r.call(this,e),this.addType(s.Fog),this.modelMatrix=new a}return u.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:u,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOnly,"set_bind",new e.SFBool),new t(s.inputOutput,"fogType",new e.SFString("LINEAR")),new t(s.inputOutput,"color",new e.SFColor(1,1,1)),new t(s.inputOutput,"visibilityRange",new e.SFFloat),new t(s.outputOnly,"isBound",new e.SFBool),new t(s.outputOnly,"bindTime",new e.SFTime)]),getTypeName:function(){return"Fog"},getComponentName:function(){return"EnvironmentalEffects"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),r.prototype.initialize.call(this)},getModelMatrix:function(){return this.modelMatrix},traverse:function(e,t){e===o.CAMERA&&(t.getLayer().getFogs().push(this),this.modelMatrix.assign(t.getModelViewMatrix().get()))}}),u}),define("standard/Math/Numbers/Complex",[],function(){"use strict";function e(e,t){this.real=e,this.imag=t}return e.prototype={constructor:e,copy:function(){const t=Object.create(e.prototype);return t.real=this.real,t.imag=this.imag,t},assign:function(e){return this.real=e.real,this.imag=e.imag,this},equals:function(e){return this.real===e.real&&this.imag===e.imag},setRadius:function(e){return this.setPolar(e,this.getAngle())},getRadius:function(){return this.real?this.imag?Math.hypot(this.real,this.imag):Math.abs(this.real):Math.abs(this.imag)},setAngle:function(e){return this.setPolar(this.getRadius(),e)},getAngle:function(){return Math.atan2(this.imag,this.real)},setPolar:function(e,t){return this.real=e*Math.cos(t),this.imag=e*Math.sin(t),this},conjugate:function(){return this.imag=-this.imag,this},negate:function(){return this.real=-this.real,this.imag=-this.imag,this},inverse:function(){const e=this.real*this.real+this.imag*this.imag;return this.real/=e,this.imag/=-e,this},add:function(e){return this.real+=e.real,this.imag+=e.imag,this},subtract:function(e){return this.real-=e.real,this.imag-=e.imag,this},multiply:function(e){return this.real*=e,this.imag*=e,this},multComp:function(){const e=this.real,t=this.imag;return this.real=e*value.real-t*value.imag,this.imag=e*value.imag+t*value.real,this},divComp:function(e){const t=this.real,i=this.imag,n=e.real,r=e.imag,o=n*n+r*r;return this.real=(t*n+i*r)/o,this.imag=(i*n-t*r)/o,this},toString:function(){return this.imag?this.real+" "+this.imag+"i":""+this.real}},Object.assign(e,{Polar:function(t,i){const n=Object.create(e.prototype);return n.real=t*Math.cos(i),n.imag=t*Math.sin(i),n},multiply:function(e,t){return e.copy().multiply(t)},multComp:function(e,t){return e.copy().multComp(t)}}),e}),define("x_ite/Components/EnvironmentalEffects/X3DBackgroundNode",["x_ite/Components/Core/X3DBindableNode","x_ite/Rendering/TraverseType","x_ite/Base/X3DConstants","standard/Math/Geometry/ViewVolume","standard/Math/Numbers/Complex","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Algorithm"],function(e,t,i,n,r,o,s,a,u){"use strict";function l(t){e.call(this,t),this.addType(i.X3DBackgroundNode),this.skyAngle_.setUnit("angle"),this.groundAngle_.setUnit("angle"),this.hidden=!1,this.projectionMatrixArray=new Float32Array(16),this.modelMatrix=new a,this.modelViewMatrixArray=new Float32Array(16),this.localObjects=[],this.colors=[],this.sphere=[],this.textures=0}var c=Math.sqrt(.5),h=c,d=[1,1,0,1,0,1,0,1,0,0,0,1,1,1,0,1,0,0,0,1,1,0,0,1],p=[h,h,-h,1,-h,h,-h,1,-h,-h,-h,1,h,h,-h,1,-h,-h,-h,1,h,-h,-h,1],f=[-h,h,h,1,h,h,h,1,h,-h,h,1,-h,h,h,1,h,-h,h,1,-h,-h,h,1],g=[-h,h,-h,1,-h,h,h,1,-h,-h,h,1,-h,h,-h,1,-h,-h,h,1,-h,-h,-h,1],m=[h,h,h,1,h,h,-h,1,h,-h,-h,1,h,h,h,1,h,-h,-h,1,h,-h,h,1],y=[h,h,h,1,-h,h,h,1,-h,h,-h,1,h,h,h,1,-h,h,-h,1,h,h,-h,1],_=[h,-h,-h,1,-h,-h,-h,1,-h,-h,h,1,h,-h,-h,1,-h,-h,h,1,h,-h,h,1],x=new r(0,0),w=new r(0,0),b=new r(0,0),v=new r(0,0),S=new r(0,0),T=new r(0,0);return l.prototype=Object.assign(Object.create(e.prototype),{constructor:l,initialize:function(){e.prototype.initialize.call(this);var t=this.getBrowser().getContext();this.colorBuffer=t.createBuffer(),this.sphereBuffer=t.createBuffer(),this.texCoordBuffer=t.createBuffer(),this.cubeBuffer=t.createBuffer(),this.texCoordBuffers=[t.createBuffer()],this.frontBuffer=t.createBuffer(),this.backBuffer=t.createBuffer(),this.leftBuffer=t.createBuffer(),this.rightBuffer=t.createBuffer(),this.topBuffer=t.createBuffer(),this.bottomBuffer=t.createBuffer(),this.groundAngle_.addInterest("build",this),this.groundColor_.addInterest("build",this),this.skyAngle_.addInterest("build",this),this.skyColor_.addInterest("build",this),this.transparency_.addInterest("build",this),this.build(),this.transferRectangle()},set_frontTexture__:function(e){this.setTexture("frontTexture",e,0)},set_backTexture__:function(e){this.setTexture("backTexture",e,1)},set_leftTexture__:function(e){this.setTexture("leftTexture",e,2)},set_rightTexture__:function(e){this.setTexture("rightTexture",e,3)},set_topTexture__:function(e){this.setTexture("topTexture",e,4)},set_bottomTexture__:function(e){this.setTexture("bottomTexture",e,5)},setTexture:function(e,t,n){this[e]&&this[e].loadState_.removeInterest("setTextureBit",this),this[e]=t,t?(t.loadState_.addInterest("setTextureBit",this,t,n),this.setTextureBit(t.loadState_,t,n)):this.setTextureBit(i.NOT_STARTED,null,n)},setTextureBit:function(e,t,n){e.getValue()===i.COMPLETE_STATE||t&&t.getData()?this.textures|=1<<n:this.textures&=~(1<<n)},setHidden:function(e){this.hidden=e,this.getBrowser().addBrowserEvent()},getHidden:function(){return this.hidden},getTransparent:function(){return!!this.hidden||0!==this.transparency_.getValue()&&(!(this.frontTexture&&!this.frontTexture.transparent_.getValue())||(!(this.backTexture&&!this.backTexture.transparent_.getValue())||(!(this.leftTexture&&!this.leftTexture.transparent_.getValue())||(!(this.rightTexture&&!this.rightTexture.transparent_.getValue())||(!(this.topTexture&&!this.topTexture.transparent_.getValue())||!(this.bottomTexture&&!this.bottomTexture.transparent_.getValue()))))))},getColor:function(e,t,i){return t[u.upperBound(i,0,i.length,e,u.less)]},build:function(){if(this.colors.length=0,this.sphere.length=0,!(this.transparency_.getValue()>=1)){var e=1-u.clamp(this.transparency_.getValue(),0,1);if(0===this.groundColor_.length&&1==this.skyColor_.length){var t=c;this.sphere.vertices=36,this.sphere.push(t,t,-t,1,-t,t,-t,1,-t,-t,-t,1,t,t,-t,1,-t,-t,-t,1,t,-t,-t,1,-t,t,t,1,t,t,t,1,-t,-t,t,1,-t,-t,t,1,t,t,t,1,t,-t,t,1,-t,t,-t,1,-t,t,t,1,-t,-t,t,1,-t,t,-t,1,-t,-t,t,1,-t,-t,-t,1,t,t,t,1,t,t,-t,1,t,-t,t,1,t,-t,t,1,t,t,-t,1,t,-t,-t,1,t,t,t,1,-t,t,t,1,-t,t,-t,1,t,t,t,1,-t,t,-t,1,t,t,-t,1,-t,-t,t,1,t,-t,t,1,-t,-t,-t,1,-t,-t,-t,1,t,-t,t,1,t,-t,-t,1);for(var i=this.skyColor_[0],n=0,r=this.sphere.vertices;n<r;++n)this.colors.push(i.r,i.g,i.b,e)}else{if(this.skyColor_.length>this.skyAngle_.length){for(var o=[],n=0,s=this.skyAngle_.length;n<s;++n)o.push(this.skyAngle_[n]);(0===o.length||o[0]>0)&&o.unshift(0);var a=this.groundColor_.length>this.groundAngle_.length?Math.PI/2:Math.PI;o.at(-1)<a&&o.push(a),this.buildSphere(1,o,this.skyAngle_,this.skyColor_,e,!1)}if(this.groundColor_.length>this.groundAngle_.length){for(var o=[],n=0,s=this.groundAngle_.length;n<s;++n)o.push(this.groundAngle_[n]);o.reverse(),(0===o.length||o[0]<Math.PI/2)&&o.unshift(Math.PI/2),o.at(-1)>0&&o.push(0),this.buildSphere(1,o,this.groundAngle_,this.groundColor_,e,!0)}}this.transferSphere()}},buildSphere:function(e,t,i,n,r,o){for(var s=0,a=o?Math.PI/2:Math.PI,l=t.length-1,c=0;c<l;++c){var h=u.clamp(t[c],0,a),d=u.clamp(t[c+1],0,a);o&&(h=Math.PI-h,d=Math.PI-d),x.setPolar(e,h),w.setPolar(e,d);for(var p=this.getColor(t[c],n,i),f=this.getColor(t[c+1],n,i),g=0;g<20;++g){var m=g<19?g+1:0;s=2*Math.PI*(g/20),b.setPolar(-x.imag,s),v.setPolar(-w.imag,s),s=2*Math.PI*(m/20),S.setPolar(-w.imag,s),T.setPolar(-x.imag,s),this.colors.push(p.r,p.g,p.b,r,f.r,f.g,f.b,r,f.r,f.g,f.b,r,p.r,p.g,p.b,r,p.r,p.g,p.b,r,f.r,f.g,f.b,r),this.sphere.push(b.imag,x.real,b.real,1,S.imag,w.real,S.real,1,v.imag,w.real,v.real,1,b.imag,x.real,b.real,1,T.imag,x.real,T.real,1,S.imag,w.real,S.real,1)}}},transferSphere:function(){var e=this.getBrowser().getContext();e.bindBuffer(e.ARRAY_BUFFER,this.colorBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(this.colors),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.sphereBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(this.sphere),e.STATIC_DRAW),this.sphereCount=this.sphere.length/4},transferRectangle:function(){var e=this.getBrowser().getContext();e.bindBuffer(e.ARRAY_BUFFER,this.texCoordBuffers[0]),e.bufferData(e.ARRAY_BUFFER,new Float32Array(d),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.frontBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(p),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.backBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(f),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.leftBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(g),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.rightBuffer),
e.bufferData(e.ARRAY_BUFFER,new Float32Array(m),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.topBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(y),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.bottomBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(_),e.STATIC_DRAW)},traverse:function(e,i){switch(e){case t.CAMERA:return i.getLayer().getBackgrounds().push(this),void this.modelMatrix.assign(i.getModelViewMatrix().get());case t.DISPLAY:for(var n=i.getLocalObjects(),r=this.localObjects,o=0,s=n.length;o<s;++o)r[o]=n[o];return void(r.length=n.length)}},display:function(){var e=new a,t=new a,i=new s,r=new o(0,0,0),u=new o(0,0,0);return function(o,s,a){try{if(this.hidden)return;o.disable(o.DEPTH_TEST),o.depthMask(!1),o.enable(o.CULL_FACE),o.frontFace(o.CCW);var l=.8*-n.unProjectPointMatrix(0,0,1,e.assign(s.getProjectionMatrix().get()).inverse(),a,u).z;this.projectionMatrixArray.set(s.getProjectionMatrix().get()),t.assign(this.modelMatrix),t.multRight(s.getViewMatrix().get()),t.get(null,i),t.identity(),t.rotate(i),t.scale(r.set(l,l,l)),this.modelViewMatrixArray.set(t),this.drawSphere(s),this.textures&&this.drawCube(s)}catch(e){console.log(e)}}}(),drawSphere:function(e){var t=this.transparency_.getValue();if(!(t>=1)){var i=e.getBrowser(),n=i.getContext(),r=i.getBackgroundSphereShader();r.getValid()&&(r.enable(n),r.setLocalObjects(n,this.localObjects),r.enableColorAttribute(n,this.colorBuffer),r.enableVertexAttribute(n,this.sphereBuffer),n.uniformMatrix4fv(r.x3d_ProjectionMatrix,!1,this.projectionMatrixArray),n.uniformMatrix4fv(r.x3d_ModelViewMatrix,!1,this.modelViewMatrixArray),t?n.enable(n.BLEND):n.disable(n.BLEND),n.drawArrays(n.TRIANGLES,0,this.sphereCount),r.disableColorAttribute(n),r.disable(n))}},drawCube:function(){const e=new Float32Array(new a),t=new Float32Array([1,1,1]);return function(i){var n=i.getBrowser(),r=n.getContext(),o=n.getUnlitShader();o.getValid()&&(o.enable(r),o.setLocalObjects(r,this.localObjects),o.enableTexCoordAttribute(r,this.texCoordBuffers),r.uniform1i(o.x3d_FogType,0),r.uniform1i(o.x3d_FillPropertiesFilled,!0),r.uniform1i(o.x3d_FillPropertiesHatched,!1),r.uniform1i(o.x3d_ColorMaterial,!1),r.uniform3fv(o.x3d_EmissiveColor,t),r.uniform1f(o.x3d_Transparency,0),r.uniform1i(o.x3d_NumTextures,1),r.uniform1i(o.x3d_TextureType[0],2),r.uniform1i(o.x3d_TextureCoordinateGeneratorMode[0],0),r.uniform1i(o.x3d_NumProjectiveTextures,0),r.uniformMatrix4fv(o.x3d_TextureMatrix[0],!1,e),r.uniformMatrix4fv(o.x3d_ProjectionMatrix,!1,this.projectionMatrixArray),r.uniformMatrix4fv(o.x3d_ModelViewMatrix,!1,this.modelViewMatrixArray),this.drawRectangle(r,o,this.frontTexture,this.frontBuffer),this.drawRectangle(r,o,this.backTexture,this.backBuffer),this.drawRectangle(r,o,this.leftTexture,this.leftBuffer),this.drawRectangle(r,o,this.rightTexture,this.rightBuffer),this.drawRectangle(r,o,this.topTexture,this.topBuffer),this.drawRectangle(r,o,this.bottomTexture,this.bottomBuffer),o.disableTexCoordAttribute(r),o.disable(r))}}(),drawRectangle:function(e,t,n,r){n&&(n.checkLoadState()===i.COMPLETE_STATE||n.getData())&&(n.setShaderUniforms(e,t),n.transparent_.getValue()?e.enable(e.BLEND):e.disable(e.BLEND),t.enableVertexAttribute(e,r),e.drawArrays(e.TRIANGLES,0,6))}}),l}),define("x_ite/Components/Texturing/X3DTextureNode",["x_ite/Fields","x_ite/Components/Shape/X3DAppearanceChildNode","x_ite/Base/X3DConstants"],function(e,t,i){"use strict";function n(n){t.call(this,n),this.addType(i.X3DTextureNode),this.addChildObjects("transparent",new e.SFBool),this.transparent_.setAccessType(i.outputOnly)}return n.prototype=Object.assign(Object.create(t.prototype),{constructor:n,setTransparent:function(e){e!==this.transparent_.getValue()&&(this.transparent_=e)},getTransparent:function(){return this.transparent_.getValue()}}),n}),define("x_ite/Components/Texturing/X3DSingleTextureNode",["x_ite/Components/Texturing/X3DTextureNode","x_ite/Base/X3DConstants","x_ite/Base/X3DCast","x_ite/Browser/Texturing/MultiTextureModeType","x_ite/Browser/Texturing/MultiTextureSourceType","x_ite/Browser/Texturing/MultiTextureFunctionType"],function(e,t,i,n,r,o){"use strict";function s(i){e.call(this,i),this.addType(t.X3DSingleTextureNode)}return s.prototype=Object.assign(Object.create(e.prototype),{constructor:s,initialize:function(){e.prototype.initialize.call(this),this.textureProperties_.addInterest("set_textureProperties__",this);const t=this.getBrowser().getContext();this.texture=t.createTexture(),this.set_textureProperties__()},set_textureProperties__:function(){this.texturePropertiesNode&&this.texturePropertiesNode.removeInterest("updateTextureProperties",this),this.texturePropertiesNode=i(t.TextureProperties,this.textureProperties_),this.texturePropertiesNode||(this.texturePropertiesNode=this.getBrowser().getDefaultTextureProperties()),this.texturePropertiesNode.addInterest("updateTextureProperties",this),this.updateTextureProperties()},getTexture:function(){return this.texture},updateTextureProperties:function(){const e=["EXT_texture_filter_anisotropic","MOZ_EXT_texture_filter_anisotropic","WEBKIT_EXT_texture_filter_anisotropic"];return function(t,i,n,r,o,s,a,u){const l=this.getBrowser().getContext();l.bindTexture(t,this.getTexture()),Math.max(r,o)<this.getBrowser().getMinTextureSize()&&!i?(l.texParameteri(t,l.TEXTURE_MIN_FILTER,l.NEAREST),l.texParameteri(t,l.TEXTURE_MAG_FILTER,l.NEAREST)):(n.generateMipMaps_.getValue()&&l.generateMipmap(t),l.texParameteri(t,l.TEXTURE_MIN_FILTER,l[n.getMinificationFilter()]),l.texParameteri(t,l.TEXTURE_MAG_FILTER,l[n.getMagnificationFilter()])),i?(l.texParameteri(t,l.TEXTURE_WRAP_S,l[n.getBoundaryModeS()]),l.texParameteri(t,l.TEXTURE_WRAP_T,l[n.getBoundaryModeT()]),l.getVersion()>=2&&l.texParameteri(t,l.TEXTURE_WRAP_R,l[n.getBoundaryModeR()])):(l.texParameteri(t,l.TEXTURE_WRAP_S,s?l.REPEAT:l.CLAMP_TO_EDGE),l.texParameteri(t,l.TEXTURE_WRAP_T,a?l.REPEAT:l.CLAMP_TO_EDGE),l.getVersion()>=2&&l.texParameteri(t,l.TEXTURE_WRAP_R,u?l.REPEAT:l.CLAMP_TO_EDGE));for(const i of e){const e=l.getExtension(i);if(e){l.texParameterf(t,e.TEXTURE_MAX_ANISOTROPY_EXT,n.anisotropicDegree_.getValue());break}}}}(),setShaderUniforms:function(e,t,i){this.setShaderUniformsToChannel(e,t,i,0),e.uniform1i(t.x3d_NumTextures,1),e.uniform1i(t.x3d_MultiTextureMode[0],n.MODULATE),e.uniform1i(t.x3d_MultiTextureAlphaMode[0],n.MODULATE),e.uniform1i(t.x3d_MultiTextureSource[0],r.DEFAULT),e.uniform1i(t.x3d_MultiTextureFunction[0],o.DEFAULT)}}),s}),define("x_ite/Components/Texturing/X3DTexture2DNode",["x_ite/Components/Texturing/X3DSingleTextureNode","x_ite/Base/X3DConstants"],function(e,t){"use strict";function i(i){e.call(this,i),this.addType(t.X3DTexture2DNode);const n=this.getBrowser().getContext();this.target=n.TEXTURE_2D,this.width=0,this.height=0,this.flipY=!1,this.data=null}const n=new Uint8Array([255,255,255,255]);return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i,initialize:function(){e.prototype.initialize.call(this),this.repeatS_.addInterest("updateTextureProperties",this),this.repeatT_.addInterest("updateTextureProperties",this);const t=this.getBrowser().getContext();t.bindTexture(t.TEXTURE_2D,this.getTexture()),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,n)},getTarget:function(){return this.target},getWidth:function(){return this.width},getHeight:function(){return this.height},getFlipY:function(){return this.flipY},getData:function(){return this.data},clearTexture:function(){this.setTexture(1,1,!1,n,!1),this.data=null},setTexture:function(e,t,i,n,r){try{this.width=e,this.height=t,this.flipY=r,this.data=n;const o=this.getBrowser().getContext();o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,r),o.pixelStorei(o.UNPACK_ALIGNMENT,1),o.bindTexture(o.TEXTURE_2D,this.getTexture()),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,e,t,0,o.RGBA,o.UNSIGNED_BYTE,n),this.setTransparent(i),this.updateTextureProperties(),this.addNodeEvent()}catch(e){}},updateTexture:function(e,t){try{this.data=e;const i=this.getBrowser().getContext();i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,t),i.bindTexture(i.TEXTURE_2D,this.getTexture()),i.texSubImage2D(i.TEXTURE_2D,0,0,0,i.RGBA,i.UNSIGNED_BYTE,e),this.texturePropertiesNode.generateMipMaps_.getValue()&&i.generateMipmap(i.TEXTURE_2D),this.addNodeEvent()}catch(e){}},updateTextureProperties:function(){e.prototype.updateTextureProperties.call(this,this.target,this.textureProperties_.getValue(),this.texturePropertiesNode,this.width,this.height,this.repeatS_.getValue(),this.repeatT_.getValue(),!1)},setShaderUniformsToChannel:function(e,t,i,n){e.activeTexture(e.TEXTURE0+t.getBrowser().getTexture2DUnits()[n]),e.bindTexture(e.TEXTURE_2D,this.getTexture()),e.uniform1i(t.x3d_TextureType[n],2)}}),i}),define("x_ite/Components/Texturing/ImageTexture",["jquery","x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Texturing/X3DTexture2DNode","x_ite/Components/Networking/X3DUrlObject","x_ite/Base/X3DConstants","standard/Math/Algorithm","x_ite/DEBUG"],function(e,t,i,n,r,o,s,a,u){"use strict";function l(e){r.call(this,e),o.call(this,e),this.addType(s.ImageTexture),this.urlStack=new t.MFString}return l.prototype=Object.assign(Object.create(r.prototype),o.prototype,{constructor:l,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new n([new i(s.inputOutput,"metadata",new t.SFNode),new i(s.inputOutput,"description",new t.SFString),new i(s.inputOutput,"load",new t.SFBool(!0)),new i(s.inputOutput,"url",new t.MFString),new i(s.inputOutput,"autoRefresh",new t.SFTime),new i(s.inputOutput,"autoRefreshTimeLimit",new t.SFTime(3600)),new i(s.initializeOnly,"repeatS",new t.SFBool(!0)),new i(s.initializeOnly,"repeatT",new t.SFBool(!0)),new i(s.initializeOnly,"textureProperties",new t.SFNode)]),getTypeName:function(){return"ImageTexture"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"texture"},initialize:function(){r.prototype.initialize.call(this),o.prototype.initialize.call(this),this.canvas=e("<canvas></canvas>"),this.image=e("<img></img>"),this.image.on("load",this.setImage.bind(this)),this.image.on("error",this.setError.bind(this)),this.image.bind("abort",this.setError.bind(this)),this.image[0].crossOrigin="Anonymous",this.requestImmediateLoad()},unloadNow:function(){this.clearTexture()},loadNow:function(){this.urlStack.setValue(this.urlBuffer_),this.loadNext()},loadNext:function(){if(0===this.urlStack.length)return this.clearTexture(),void this.setLoadState(s.FAILED_STATE);this.URL=new URL(this.urlStack.shift(),this.getExecutionContext().getWorldURL()),this.getBrowser().getBrowserOptions().getCache()&&this.getCache()||this.URL.searchParams.set("_",Date.now()),this.image.attr("src",this.URL.href)},setError:function(){"data:"!==this.URL.protocol&&console.warn("Error loading image:",this.URL.href),this.loadNext()},setImage:function(){u&&"data:"!==this.URL.protocol&&console.info("Done loading image:",this.URL.href);try{const e=this.getBrowser().getContext(),t=this.image[0],i=this.canvas[0],n=i.getContext("2d");let r=t.width,o=t.height;e.getVersion()>=2||a.isPowerOfTwo(r)&&a.isPowerOfTwo(o)?(i.width=r,i.height=o,n.clearRect(0,0,r,o),n.save(),n.translate(0,o),n.scale(1,-1),n.drawImage(t,0,0),n.restore()):(r=a.nextPowerOfTwo(r),o=a.nextPowerOfTwo(o),i.width=r,i.height=o,n.clearRect(0,0,r,o),n.save(),n.translate(0,o),n.scale(1,-1),n.drawImage(t,0,0,t.width,t.height,0,0,r,o),n.restore());const u=n.getImageData(0,0,r,o).data;let l=!1;for(let e=3;e<u.length;e+=4)if(255!==u[e]){l=!0;break}this.setTexture(r,o,l,new Uint8Array(u),!1),this.setLoadState(s.COMPLETE_STATE)}catch(e){console.log(e.message),this.setError()}}}),l}),define("x_ite/Components/EnvironmentalEffects/Background",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/EnvironmentalEffects/X3DBackgroundNode","x_ite/Components/Texturing/ImageTexture","x_ite/Base/X3DConstants"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),this.addType(o.Background)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOnly,"set_bind",new e.SFBool),new t(o.inputOutput,"frontUrl",new e.MFString),new t(o.inputOutput,"backUrl",new e.MFString),new t(o.inputOutput,"leftUrl",new e.MFString),new t(o.inputOutput,"rightUrl",new e.MFString),new t(o.inputOutput,"topUrl",new e.MFString),new t(o.inputOutput,"bottomUrl",new e.MFString),new t(o.inputOutput,"skyAngle",new e.MFFloat),new t(o.inputOutput,"skyColor",new e.MFColor(new e.SFColor)),new t(o.inputOutput,"groundAngle",new e.MFFloat),new t(o.inputOutput,"groundColor",new e.MFColor),new t(o.inputOutput,"transparency",new e.SFFloat),new t(o.outputOnly,"isBound",new e.SFBool),new t(o.outputOnly,"bindTime",new e.SFTime)]),getTypeName:function(){return"Background"},getComponentName:function(){return"EnvironmentalEffects"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this);var e=new r(this.getExecutionContext()),t=new r(this.getExecutionContext()),i=new r(this.getExecutionContext()),o=new r(this.getExecutionContext()),s=new r(this.getExecutionContext()),a=new r(this.getExecutionContext()),u=this.getBrowser().getBackgroundTextureProperties();this.frontUrl_.addFieldInterest(e.url_),this.backUrl_.addFieldInterest(t.url_),this.leftUrl_.addFieldInterest(i.url_),this.rightUrl_.addFieldInterest(o.url_),this.topUrl_.addFieldInterest(s.url_),this.bottomUrl_.addFieldInterest(a.url_),e.url_=this.frontUrl_,t.url_=this.backUrl_,i.url_=this.leftUrl_,o.url_=this.rightUrl_,s.url_=this.topUrl_,a.url_=this.bottomUrl_,e.textureProperties_=u,t.textureProperties_=u,i.textureProperties_=u,o.textureProperties_=u,s.textureProperties_=u,a.textureProperties_=u,e.setup(),t.setup(),i.setup(),o.setup(),s.setup(),a.setup(),this.set_frontTexture__(e),this.set_backTexture__(t),this.set_leftTexture__(i),this.set_rightTexture__(o),this.set_topTexture__(s),this.set_bottomTexture__(a)}}),s}),define("x_ite/Components/Layering/X3DLayerNode",["x_ite/Components/Core/X3DNode","x_ite/Rendering/X3DRenderObject","x_ite/Components/Layering/X3DViewportNode","x_ite/Execution/BindableStack","x_ite/Execution/BindableList","x_ite/Components/Navigation/NavigationInfo","x_ite/Components/EnvironmentalEffects/Fog","x_ite/Components/EnvironmentalEffects/Background","x_ite/Base/X3DCast","x_ite/Rendering/TraverseType","x_ite/Base/X3DConstants","standard/Math/Geometry/Camera","standard/Math/Geometry/Box3","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4"],function(e,t,i,n,r,o,s,a,u,l,c,h,d,p,f){"use strict";function g(i,u,l){e.call(this,i),t.call(this,i),this.addType(c.X3DLayerNode),this.groupNode=l,this.currentViewport=null,this.defaultNavigationInfo=new o(i),this.defaultViewpoint=u,this.defaultBackground=new a(i),this.defaultFog=new s(i),this.navigationInfoStack=new n(i,this.defaultNavigationInfo),this.viewpointStack=new n(i,this.defaultViewpoint),this.backgroundStack=new n(i,this.defaultBackground),this.fogStack=new n(i,this.defaultFog),this.navigationInfos=new r(i,this.defaultNavigationInfo),this.viewpoints=new r(i,this.defaultViewpoint),this.backgrounds=new r(i,this.defaultBackground),this.fogs=new r(i,this.defaultFog),this.defaultBackground.setHidden(!0),this.defaultFog.setHidden(!0),this.collisionTime=0}var m=new f;return g.prototype=Object.assign(Object.create(e.prototype),t.prototype,{constructor:g,layer0:!1,initialize:function(){e.prototype.initialize.call(this),t.prototype.initialize.call(this),this.defaultNavigationInfo.setup(),this.defaultViewpoint.setup(),this.defaultBackground.setup(),this.defaultFog.setup(),this.navigationInfoStack.setup(),this.viewpointStack.setup(),this.backgroundStack.setup(),this.fogStack.setup(),this.navigationInfos.setup(),this.viewpoints.setup(),this.backgrounds.setup(),this.fogs.setup(),this.viewport_.addInterest("set_viewport__",this),this.set_viewport__()},isLayer0:function(e){this.layer0=e,this.defaultBackground.setHidden(!e)},getLayer:function(){return this},getGroup:function(){return this.groupNode},getViewport:function(){return this.currentViewport},getBackground:function(){return this.backgroundStack.top()},getFog:function(){return this.fogStack.top()},getNavigationInfo:function(){return this.navigationInfoStack.top()},getViewpoint:function(){return this.viewpointStack.top()},getBackgrounds:function(){return this.backgrounds},getFogs:function(){return this.fogs},getNavigationInfos:function(){return this.navigationInfos},getViewpoints:function(){return this.viewpoints},getUserViewpoints:function(){for(var e=[],t=0;t<this.viewpoints.get().length;++t){var i=this.viewpoints.get()[t];i.description_.length&&e.push(i)}return e},getBackgroundStack:function(){return this.backgroundStack},getFogStack:function(){return this.fogStack},getNavigationInfoStack:function(){return this.navigationInfoStack},getViewpointStack:function(){return this.viewpointStack},getBBox:function(e,t){return this.groupNode.getBBox(e,t)},lookAt:function(e,t){this.getViewpoint().lookAtBBox(this.getBBox(new d),e,t)},set_viewport__:function(){this.currentViewport=u(c.X3DViewportNode,this.viewport_),this.currentViewport||(this.currentViewport=this.getBrowser().getDefaultViewport())},bind:function(e){this.traverse(l.CAMERA,this);const t=this.navigationInfos.getBound(),i=this.backgrounds.getBound(),n=this.fogs.getBound(),r=this.viewpoints.getBound(e);this.navigationInfoStack.pushOnTop(t),this.viewpointStack.pushOnTop(r),this.backgroundStack.pushOnTop(i),this.fogStack.pushOnTop(n),r.resetUserOffsets()},traverse:function(e,t){t=t||this;var i=this.getViewpoint();switch(this.getProjectionMatrix().pushMatrix(i.getProjectionMatrix(this)),this.getCameraSpaceMatrix().pushMatrix(i.getCameraSpaceMatrix()),this.getViewMatrix().pushMatrix(i.getViewMatrix()),e){case l.POINTER:this.pointer(e,t);break;case l.CAMERA:this.camera(e,t);break;case l.PICKING:this.picking(e,t);break;case l.COLLISION:this.collision(e,t);break;case l.SHADOW:case l.DISPLAY:this.display(e,t)}this.getViewMatrix().pop(),this.getCameraSpaceMatrix().pop(),this.getProjectionMatrix().pop()},pointer:function(e,t){if(this.isPickable_.getValue()){var i=this.getBrowser(),n=this.currentViewport.getRectangle(i);if(i.getSelectedLayer()){if(i.getSelectedLayer()!==this)return}else if(!i.isPointerInRectangle(n))return;i.setHitRay(this.getProjectionMatrix().get(),n),this.getModelViewMatrix().pushMatrix(this.getViewMatrix().get()),this.currentViewport.push(this),this.groupNode.traverse(e,t),this.currentViewport.pop(this),this.getModelViewMatrix().pop()}},camera:function(e,t){this.getModelViewMatrix().pushMatrix(f.Identity),this.currentViewport.push(this),this.groupNode.traverse(e,t),this.currentViewport.pop(this),this.getModelViewMatrix().pop(),this.navigationInfos.update(this,this.navigationInfoStack),this.viewpoints.update(this,this.viewpointStack),this.backgrounds.update(this,this.backgroundStack),this.fogs.update(this,this.fogStack),this.getViewpoint().update()},picking:function(e,t){this.getModelViewMatrix().pushMatrix(f.Identity),this.currentViewport.push(this),this.groupNode.traverse(e,t),this.currentViewport.pop(this),this.getModelViewMatrix().pop()},collision:function(e,t){var i=this.getNavigationInfo();if(!i.transitionActive_.getValue()){var n=i.getCollisionRadius(),r=i.getAvatarHeight(),o=Math.max(2*n,2*r);this.collisionTime=0,h.ortho(-o,o,-o,o,-o,o,m),this.getProjectionMatrix().pushMatrix(m),this.getModelViewMatrix().pushMatrix(this.getViewMatrix().get()),this.currentViewport.push(this),t.render(e,this.groupNode.traverse,this.groupNode),this.currentViewport.pop(this),this.getModelViewMatrix().pop(),this.getProjectionMatrix().pop()}},display:function(e,t){this.getNavigationInfo().enable(e,t),this.getModelViewMatrix().pushMatrix(this.getViewMatrix().get()),this.currentViewport.push(this),t.render(e,this.groupNode.traverse,this.groupNode),this.currentViewport.pop(this),this.getModelViewMatrix().pop()}}),g}),define("x_ite/Components/Navigation/Viewpoint",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Navigation/X3DViewpointNode","x_ite/Components/Interpolation/ScalarInterpolator","x_ite/Base/X3DConstants","standard/Math/Geometry/Camera","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4"],function(e,t,i,n,r,o,s,a,u,l){"use strict";function c(e){n.call(this,e),this.addType(o.Viewpoint),this.position_.setUnit("length"),this.centerOfRotation_.setUnit("length"),this.fieldOfView_.setUnit("angle"),this.projectionMatrix=new l,this.fieldOfViewInterpolator=new r(this.getBrowser().getPrivateScene())}return c.prototype=Object.assign(Object.create(n.prototype),{constructor:c,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOnly,"set_bind",new e.SFBool),new t(o.inputOutput,"description",new e.SFString),new t(o.inputOutput,"position",new e.SFVec3f(0,0,10)),new t(o.inputOutput,"orientation",new e.SFRotation),new t(o.inputOutput,"centerOfRotation",new e.SFVec3f),new t(o.inputOutput,"fieldOfView",new e.SFFloat(.7854)),new t(o.inputOutput,"jump",new e.SFBool(!0)),new t(o.inputOutput,"retainUserOffsets",new e.SFBool),new t(o.outputOnly,"isBound",new e.SFBool),new t(o.outputOnly,"bindTime",new e.SFTime)]),getTypeName:function(){return"Viewpoint"},getComponentName:function(){return"Navigation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.fieldOfViewInterpolator.key_=new e.MFFloat(0,1),this.fieldOfViewInterpolator.setup(),this.getEaseInEaseOut().modifiedFraction_changed_.addFieldInterest(this.fieldOfViewInterpolator.set_fraction_),this.fieldOfViewInterpolator.value_changed_.addFieldInterest(this.fieldOfViewScale_)},setInterpolators:function(t,i){if(t.getType().indexOf(o.Viewpoint)>=0){const n=t.getFieldOfView()/i.getFieldOfView();this.fieldOfViewInterpolator.keyValue_=new e.MFFloat(n,i.fieldOfViewScale_.getValue()),this.fieldOfViewScale_=n}else this.fieldOfViewInterpolator.keyValue_=new e.MFFloat(i.fieldOfViewScale_.getValue(),i.fieldOfViewScale_.getValue()),this.fieldOfViewScale_=i.fieldOfViewScale_.getValue()},getFieldOfView:function(){var e=this.fieldOfView_.getValue()*this.fieldOfViewScale_.getValue();return e>0&&e<Math.PI?e:Math.PI/4},getScreenScale:function(){var e=new u(0,0,0);return function(t,i){var n=i[2],r=i[3],o=Math.abs(t.z)*Math.tan(this.getFieldOfView()/2)*2;return o/=n>r?r:n,e.set(o,o,o)}}(),getViewportSize:function(){var e=new a(0,0);return function(t,i){var n=t[2],r=t[3],o=i*Math.tan(this.getFieldOfView()/2)*2,s=n/r;return s>1?e.set(o*s,o):e.set(o,o/s)}}(),getLookAtDistance:function(e){return e.size.abs()/2/Math.tan(this.getFieldOfView()/2)},getProjectionMatrixWithLimits:function(e,t,i){return s.perspective(this.getFieldOfView(),e,t,i[2],i[3],this.projectionMatrix)}}),c}),define("x_ite/Components/Grouping/Group",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Base/X3DConstants"],function(e,t,i,n,r){"use strict";function o(e){n.call(this,e),this.addType(r.Group)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"visible",new e.SFBool(!0)),new t(r.inputOutput,"bboxDisplay",new e.SFBool),new t(r.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new t(r.initializeOnly,"bboxCenter",new e.SFVec3f),new t(r.inputOnly,"addChildren",new e.MFNode),new t(r.inputOnly,"removeChildren",new e.MFNode),new t(r.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"Group"},getComponentName:function(){return"Grouping"},getContainerField:function(){return"children"}}),o}),define("x_ite/Components/Layering/Layer",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Layering/X3DLayerNode","x_ite/Components/Navigation/Viewpoint","x_ite/Components/Grouping/Group","x_ite/Base/X3DConstants"],function(e,t,i,n,r,o,s){"use strict";function a(e){n.call(this,e,new r(e),new o(e)),this.addType(s.Layer)}return a.prototype=Object.assign(Object.create(n.prototype),{constructor:a,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOutput,"isPickable",new e.SFBool(!0)),new t(s.inputOutput,"viewport",new e.SFNode),new t(s.inputOnly,"addChildren",new e.MFNode),new t(s.inputOnly,"removeChildren",new e.MFNode),new t(s.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"Layer"},getComponentName:function(){return"Layering"},getContainerField:function(){return"layers"},initialize:function(){n.prototype.initialize.call(this),this.addChildren_.addFieldInterest(this.getGroup().addChildren_),this.removeChildren_.addFieldInterest(this.getGroup().removeChildren_),this.children_.addFieldInterest(this.getGroup().children_),this.getGroup().children_=this.children_,this.getGroup().setPrivate(!0),this.getGroup().setup()}}),a}),define("x_ite/Components/Layering/LayerSet",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Components/Layering/Layer","x_ite/Base/X3DCast","x_ite/Rendering/TraverseType","x_ite/Base/X3DConstants"],function(e,t,i,n,r,o,s,a){"use strict";function u(e){n.call(this,e),this.addType(a.LayerSet),this.layerNodes=[new r(e)],this.layerNode0=this.layerNodes[0],this.activeLayerNode=null}return u.prototype=Object.assign(Object.create(n.prototype),{constructor:u,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(a.inputOutput,"metadata",new e.SFNode),new t(a.inputOutput,"activeLayer",new e.SFInt32),new t(a.inputOutput,"order",new e.MFInt32(0)),new t(a.inputOutput,"layers",new e.MFNode)]),getTypeName:function(){return"LayerSet"},getComponentName:function(){return"Layering"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.layerNode0.setPrivate(!0),this.layerNode0.setup(),this.layerNode0.isLayer0(!0),this.activeLayer_.addInterest("set_activeLayer",this),this.order_.addInterest("set_layers",this),this.layers_.addInterest("set_layers",this),this.set_layers()},getActiveLayer:function(){return this.activeLayerNode},setLayer0:function(e){this.layerNode0=e,this.set_layers()},getLayer0:function(){return this.layerNode0},getLayers:function(){return this.layerNodes},set_activeLayer:function(){if(0===this.activeLayer_.getValue())this.activeLayerNode!==this.layerNode0&&(this.activeLayerNode=this.layerNode0);else{const e=this.activeLayer_-1;e>=0&&e<this.layers_.length?this.activeLayerNode!==this.layers_[e].getValue()&&(this.activeLayerNode=o(a.X3DLayerNode,this.layers_[e])):null!==this.activeLayerNode&&(this.activeLayerNode=null)}},set_layers:function(){const e=this.layers_.getValue();this.layerNodes.length=0;for(let t of this.order_)if(0===t)this.layerNodes.push(this.layerNode0);else if(--t>=0&&t<e.length){const i=o(a.X3DLayerNode,e[t]);i&&this.layerNodes.push(i)}this.set_activeLayer()},bind:function(e){const t=this.layers_.getValue();this.layerNode0.bind(e);for(let i=0,n=t.length;i<n;++i){const n=o(a.X3DLayerNode,t[i]);n&&n.bind(e)}},traverse:function(e,t){const i=this.layerNodes;if(e===s.POINTER)for(let n=0,r=i.length;n<r;++n)this.getBrowser().setLayerNumber(n),i[n].traverse(e,t);else for(const n of i)n.traverse(e,t)}}),u}),define("x_ite/Execution/X3DWorld",["x_ite/Configuration/SupportedNodes","x_ite/Fields/SFNode","x_ite/Base/X3DBaseNode","x_ite/Components/Layering/LayerSet","x_ite/Components/Layering/Layer","x_ite/Base/X3DCast","x_ite/Base/X3DConstants"],function(e,t,i,n,r,o,s){"use strict";function a(e){i.call(this,e),this.addType(s.X3DWorld),this.addChildObjects("activeLayer",new t(this.layer0)),this.defaultLayerSet=new n(e),this.layerSet=this.defaultLayerSet,this.layer0=new r(e)}e.addAbstractType("X3DWorld"),a.prototype=Object.assign(Object.create(i.prototype),{constructor:a,getTypeName:function(){return"X3DWorld"},initialize:function(){i.prototype.initialize.call(this),this.layerSet.setPrivate(!0),this.layerSet.setup(),this.layerSet.setLayer0(this.layer0),this.layerSet.activeLayer_.addInterest("set_rootNodes__",this),this.getExecutionContext().getRootNodes().addInterest("set_rootNodes__",this),this.set_rootNodes__(),this.layer0.setPrivate(!0),this.layer0.isLayer0(!0),this.layer0.setup(),this.set_activeLayer__()},getCache:function(){return!0},getLayerSet:function(){return this.layerSet},getActiveLayer:function(){return this.activeLayer_.getValue()},set_rootNodes__:function(){const e=this.layerSet,t=this.getExecutionContext().getRootNodes();this.layerSet=this.defaultLayerSet,this.layer0.children_=t;for(const e of t){const t=o(s.LayerSet,e);t&&(this.layerSet=t)}this.layerSet!==e&&(this.layerSet.setLayer0(this.layer0),e.activeLayer_.removeInterest("set_activeLayer__",this),this.layerSet.activeLayer_.addInterest("set_activeLayer__",this),this.set_activeLayer__())},set_activeLayer__:function(){this.activeLayer_=this.layerSet.getActiveLayer()},bind:function(){const e=this.getExecutionContext().getWorldURL();this.layerSet.bind(new URL(e,e).hash.substr(1))},traverse:function(e,t){this.layerSet.traverse(e,t)}});for(const e of Reflect.ownKeys(a.prototype))Object.defineProperty(a.prototype,e,{enumerable:!1});return a}),define("standard/Networking/BinaryTransport",[],function(){"use strict";return function(e){e.ajaxTransport("+binary",function(e,t,i){if(e.dataType&&"binary"==e.dataType)return{send:function(t,i){const n=e.xhr();if(n.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(const t in e.xhrFields)n[t]=e.xhrFields[t];e.mimeType&&n.overrideMimeType&&n.overrideMimeType(e.mimeType);for(const e in t)n.setRequestHeader(e,t[e]);n.onload=function(){n.onload=n.onerror=null;const t={};t[e.dataType]=n.response,i(n.status,n.statusText,t,n.getAllResponseHeaders())},n.onerror=function(){n.onload=n.onerror=null,i(n.status||404,n.statusText)},n.responseType=e.responseType||"blob",n.send(e.hasContent&&e.data||null)},abort:function(){const t=e.xhr();t.onload=t.onerror=null,t.abort()}}})}}),function(e,t){"function"==typeof define&&define.amd?define("pako_inflate/dist/pako_inflate",["exports"],t):(e="undefined"!=typeof globalThis?globalThis:e||self,t(e.pako={}))}(this,function(e){"use strict";function t(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function i(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}function n(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}function r(e){this.options=$.assign({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new re,this.strm.avail_out=0;let i=q.inflateInit2(this.strm,t.windowBits);if(i!==Z_OK)throw new Error(ne[i]);if(this.header=new oe,q.inflateGetHeader(this.strm,this.header),
t.dictionary&&("string"==typeof t.dictionary?t.dictionary=ie.string2buf(t.dictionary):"[object ArrayBuffer]"===se.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(i=q.inflateSetDictionary(this.strm,t.dictionary))!==Z_OK))throw new Error(ne[i])}function o(e,t){const i=new r(t);if(i.push(e),i.err)throw i.msg||ne[i.err];return i.result}function s(e,t){return t=t||{},t.raw=!0,o(e,t)}const a=(e,t,i,n)=>{let r=65535&e|0,o=e>>>16&65535|0,s=0;for(;0!==i;){s=i>2e3?2e3:i,i-=s;do r=r+t[n++]|0,o=o+r|0;while(--s)r%=65521,o%=65521}return r|o<<16|0};var u=a;const l=()=>{let e,t=[];for(var i=0;i<256;i++){e=i;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[i]=e}return t},c=new Uint32Array(l()),h=(e,t,i,n)=>{const r=c,o=n+i;e^=-1;for(let i=n;i<o;i++)e=e>>>8^r[255&(e^t[i])];return e^-1};var d=h;var p=function(e,t){let i,n,r,o,s,a,u,l,c,h,d,p,f,g,m,y,_,x,w,b,v,S,T,C;const F=e.state;i=e.next_in,T=e.input,n=i+(e.avail_in-5),r=e.next_out,C=e.output,o=r-(t-e.avail_out),s=r+(e.avail_out-257),a=F.dmax,u=F.wsize,l=F.whave,c=F.wnext,h=F.window,d=F.hold,p=F.bits,f=F.lencode,g=F.distcode,m=(1<<F.lenbits)-1,y=(1<<F.distbits)-1;e:do{p<15&&(d+=T[i++]<<p,p+=8,d+=T[i++]<<p,p+=8),_=f[d&m];t:for(;;){if(x=_>>>24,d>>>=x,p-=x,0===(x=_>>>16&255))C[r++]=65535&_;else{if(!(16&x)){if(0==(64&x)){_=f[(65535&_)+(d&(1<<x)-1)];continue t}if(32&x){F.mode=12;break e}e.msg="invalid literal/length code",F.mode=30;break e}w=65535&_,x&=15,x&&(p<x&&(d+=T[i++]<<p,p+=8),w+=d&(1<<x)-1,d>>>=x,p-=x),p<15&&(d+=T[i++]<<p,p+=8,d+=T[i++]<<p,p+=8),_=g[d&y];i:for(;;){if(x=_>>>24,d>>>=x,p-=x,!(16&(x=_>>>16&255))){if(0==(64&x)){_=g[(65535&_)+(d&(1<<x)-1)];continue i}e.msg="invalid distance code",F.mode=30;break e}if(b=65535&_,x&=15,p<x&&(d+=T[i++]<<p,(p+=8)<x&&(d+=T[i++]<<p,p+=8)),(b+=d&(1<<x)-1)>a){e.msg="invalid distance too far back",F.mode=30;break e}if(d>>>=x,p-=x,x=r-o,b>x){if((x=b-x)>l&&F.sane){e.msg="invalid distance too far back",F.mode=30;break e}if(v=0,S=h,0===c){if(v+=u-x,x<w){w-=x;do C[r++]=h[v++];while(--x)v=r-b,S=C}}else if(c<x){if(v+=u+c-x,(x-=c)<w){w-=x;do C[r++]=h[v++];while(--x)if(v=0,c<w){x=c,w-=x;do C[r++]=h[v++];while(--x)v=r-b,S=C}}}else if(v+=c-x,x<w){w-=x;do C[r++]=h[v++];while(--x)v=r-b,S=C}for(;w>2;)C[r++]=S[v++],C[r++]=S[v++],C[r++]=S[v++],w-=3;w&&(C[r++]=S[v++],w>1&&(C[r++]=S[v++]))}else{v=r-b;do C[r++]=C[v++],C[r++]=C[v++],C[r++]=C[v++],w-=3;while(w>2)w&&(C[r++]=C[v++],w>1&&(C[r++]=C[v++]))}break}}break}}while(i<n&&r<s)w=p>>3,i-=w,p-=w<<3,d&=(1<<p)-1,e.next_in=i,e.next_out=r,e.avail_in=i<n?n-i+5:5-(i-n),e.avail_out=r<s?s-r+257:257-(r-s),F.hold=d,F.bits=p};const f=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),g=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),m=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),y=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),_=(e,t,i,n,r,o,s,a)=>{const u=a.bits;let l,c,h,d,p,_,x=0,w=0,b=0,v=0,S=0,T=0,C=0,F=0,O=0,N=0,E=null,D=0;const M=new Uint16Array(16),V=new Uint16Array(16);let I,B,A,P=null,R=0;for(x=0;x<=15;x++)M[x]=0;for(w=0;w<n;w++)M[t[i+w]]++;for(S=u,v=15;v>=1&&0===M[v];v--);if(S>v&&(S=v),0===v)return r[o++]=20971520,r[o++]=20971520,a.bits=1,0;for(b=1;b<v&&0===M[b];b++);for(S<b&&(S=b),F=1,x=1;x<=15;x++)if(F<<=1,(F-=M[x])<0)return-1;if(F>0&&(0===e||1!==v))return-1;for(V[1]=0,x=1;x<15;x++)V[x+1]=V[x]+M[x];for(w=0;w<n;w++)0!==t[i+w]&&(s[V[t[i+w]]++]=w);if(0===e?(E=P=s,_=19):1===e?(E=f,D-=257,P=g,R-=257,_=256):(E=m,P=y,_=-1),N=0,w=0,x=b,p=o,T=S,C=0,h=-1,O=1<<S,d=O-1,1===e&&O>852||2===e&&O>592)return 1;for(;;){I=x-C,s[w]<_?(B=0,A=s[w]):s[w]>_?(B=P[R+s[w]],A=E[D+s[w]]):(B=96,A=0),l=1<<x-C,c=1<<T,b=c;do c-=l,r[p+(N>>C)+c]=I<<24|B<<16|A|0;while(0!==c)for(l=1<<x-1;N&l;)l>>=1;if(0!==l?(N&=l-1,N+=l):N=0,w++,0==--M[x]){if(x===v)break;x=t[i+s[w]]}if(x>S&&(N&d)!==h){for(0===C&&(C=S),p+=b,T=x-C,F=1<<T;T+C<v&&!((F-=M[T+C])<=0);)T++,F<<=1;if(O+=1<<T,1===e&&O>852||2===e&&O>592)return 1;h=N&d,r[h]=S<<24|T<<16|p-o|0}}return 0!==N&&(r[p+N]=x-C<<24|64<<16|0),a.bits=S,0};var x=_,w={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{Z_FINISH:Z_FINISH$1,Z_BLOCK:Z_BLOCK,Z_TREES:Z_TREES,Z_OK:Z_OK$1,Z_STREAM_END:Z_STREAM_END$1,Z_NEED_DICT:Z_NEED_DICT$1,Z_STREAM_ERROR:Z_STREAM_ERROR$1,Z_DATA_ERROR:Z_DATA_ERROR$1,Z_MEM_ERROR:Z_MEM_ERROR$1,Z_BUF_ERROR:Z_BUF_ERROR,Z_DEFLATED:Z_DEFLATED}=w,b=e=>{return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)},v=e=>{if(!e||!e.state)return Z_STREAM_ERROR$1;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,Z_OK$1},S=e=>{if(!e||!e.state)return Z_STREAM_ERROR$1;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,v(e)},T=(e,t)=>{let i;if(!e||!e.state)return Z_STREAM_ERROR$1;const n=e.state;return t<0?(i=0,t=-t):(i=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?Z_STREAM_ERROR$1:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=i,n.wbits=t,S(e))},C=(e,i)=>{if(!e)return Z_STREAM_ERROR$1;const n=new t;e.state=n,n.window=null;const r=T(e,i);return r!==Z_OK$1&&(e.state=null),r},F=e=>{return C(e,15)};let O,N,E=!0;const D=e=>{if(E){O=new Int32Array(512),N=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(x(1,e.lens,0,288,O,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;x(2,e.lens,0,32,N,0,e.work,{bits:5}),E=!1}e.lencode=O,e.lenbits=9,e.distcode=N,e.distbits=5},M=(e,t,i,n)=>{let r;const o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),n>=o.wsize?(o.window.set(t.subarray(i-o.wsize,i),0),o.wnext=0,o.whave=o.wsize):(r=o.wsize-o.wnext,r>n&&(r=n),o.window.set(t.subarray(i-n,i-n+r),o.wnext),n-=r,n?(o.window.set(t.subarray(i-n,i),0),o.wnext=n,o.whave=o.wsize):(o.wnext+=r,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=r))),0},V=(e,t)=>{let i,n,r,o,s,a,l,c,h,f,g,m,y,_,w,v,S,T,C,F,O,N,E=0;const V=new Uint8Array(4);let I,B;const A=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return Z_STREAM_ERROR$1;i=e.state,12===i.mode&&(i.mode=13),s=e.next_out,r=e.output,l=e.avail_out,o=e.next_in,n=e.input,a=e.avail_in,c=i.hold,h=i.bits,f=a,g=l,N=Z_OK$1;e:for(;;)switch(i.mode){case 1:if(0===i.wrap){i.mode=13;break}for(;h<16;){if(0===a)break e;a--,c+=n[o++]<<h,h+=8}if(2&i.wrap&&35615===c){i.check=0,V[0]=255&c,V[1]=c>>>8&255,i.check=d(i.check,V,2,0),c=0,h=0,i.mode=2;break}if(i.flags=0,i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&c)<<8)+(c>>8))%31){e.msg="incorrect header check",i.mode=30;break}if((15&c)!==Z_DEFLATED){e.msg="unknown compression method",i.mode=30;break}if(c>>>=4,h-=4,O=8+(15&c),0===i.wbits)i.wbits=O;else if(O>i.wbits){e.msg="invalid window size",i.mode=30;break}i.dmax=1<<i.wbits,e.adler=i.check=1,i.mode=512&c?10:12,c=0,h=0;break;case 2:for(;h<16;){if(0===a)break e;a--,c+=n[o++]<<h,h+=8}if(i.flags=c,(255&i.flags)!==Z_DEFLATED){e.msg="unknown compression method",i.mode=30;break}if(57344&i.flags){e.msg="unknown header flags set",i.mode=30;break}i.head&&(i.head.text=c>>8&1),512&i.flags&&(V[0]=255&c,V[1]=c>>>8&255,i.check=d(i.check,V,2,0)),c=0,h=0,i.mode=3;case 3:for(;h<32;){if(0===a)break e;a--,c+=n[o++]<<h,h+=8}i.head&&(i.head.time=c),512&i.flags&&(V[0]=255&c,V[1]=c>>>8&255,V[2]=c>>>16&255,V[3]=c>>>24&255,i.check=d(i.check,V,4,0)),c=0,h=0,i.mode=4;case 4:for(;h<16;){if(0===a)break e;a--,c+=n[o++]<<h,h+=8}i.head&&(i.head.xflags=255&c,i.head.os=c>>8),512&i.flags&&(V[0]=255&c,V[1]=c>>>8&255,i.check=d(i.check,V,2,0)),c=0,h=0,i.mode=5;case 5:if(1024&i.flags){for(;h<16;){if(0===a)break e;a--,c+=n[o++]<<h,h+=8}i.length=c,i.head&&(i.head.extra_len=c),512&i.flags&&(V[0]=255&c,V[1]=c>>>8&255,i.check=d(i.check,V,2,0)),c=0,h=0}else i.head&&(i.head.extra=null);i.mode=6;case 6:if(1024&i.flags&&(m=i.length,m>a&&(m=a),m&&(i.head&&(O=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Uint8Array(i.head.extra_len)),i.head.extra.set(n.subarray(o,o+m),O)),512&i.flags&&(i.check=d(i.check,n,m,o)),a-=m,o+=m,i.length-=m),i.length))break e;i.length=0,i.mode=7;case 7:if(2048&i.flags){if(0===a)break e;m=0;do O=n[o+m++],i.head&&O&&i.length<65536&&(i.head.name+=String.fromCharCode(O));while(O&&m<a)if(512&i.flags&&(i.check=d(i.check,n,m,o)),a-=m,o+=m,O)break e}else i.head&&(i.head.name=null);i.length=0,i.mode=8;case 8:if(4096&i.flags){if(0===a)break e;m=0;do O=n[o+m++],i.head&&O&&i.length<65536&&(i.head.comment+=String.fromCharCode(O));while(O&&m<a)if(512&i.flags&&(i.check=d(i.check,n,m,o)),a-=m,o+=m,O)break e}else i.head&&(i.head.comment=null);i.mode=9;case 9:if(512&i.flags){for(;h<16;){if(0===a)break e;a--,c+=n[o++]<<h,h+=8}if(c!==(65535&i.check)){e.msg="header crc mismatch",i.mode=30;break}c=0,h=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),e.adler=i.check=0,i.mode=12;break;case 10:for(;h<32;){if(0===a)break e;a--,c+=n[o++]<<h,h+=8}e.adler=i.check=b(c),c=0,h=0,i.mode=11;case 11:if(0===i.havedict)return e.next_out=s,e.avail_out=l,e.next_in=o,e.avail_in=a,i.hold=c,i.bits=h,Z_NEED_DICT$1;e.adler=i.check=1,i.mode=12;case 12:if(t===Z_BLOCK||t===Z_TREES)break e;case 13:if(i.last){c>>>=7&h,h-=7&h,i.mode=27;break}for(;h<3;){if(0===a)break e;a--,c+=n[o++]<<h,h+=8}switch(i.last=1&c,c>>>=1,h-=1,3&c){case 0:i.mode=14;break;case 1:if(D(i),i.mode=20,t===Z_TREES){c>>>=2,h-=2;break e}break;case 2:i.mode=17;break;case 3:e.msg="invalid block type",i.mode=30}c>>>=2,h-=2;break;case 14:for(c>>>=7&h,h-=7&h;h<32;){if(0===a)break e;a--,c+=n[o++]<<h,h+=8}if((65535&c)!=(c>>>16^65535)){e.msg="invalid stored block lengths",i.mode=30;break}if(i.length=65535&c,c=0,h=0,i.mode=15,t===Z_TREES)break e;case 15:i.mode=16;case 16:if(m=i.length){if(m>a&&(m=a),m>l&&(m=l),0===m)break e;r.set(n.subarray(o,o+m),s),a-=m,o+=m,l-=m,s+=m,i.length-=m;break}i.mode=12;break;case 17:for(;h<14;){if(0===a)break e;a--,c+=n[o++]<<h,h+=8}if(i.nlen=257+(31&c),c>>>=5,h-=5,i.ndist=1+(31&c),c>>>=5,h-=5,i.ncode=4+(15&c),c>>>=4,h-=4,i.nlen>286||i.ndist>30){e.msg="too many length or distance symbols",i.mode=30;break}i.have=0,i.mode=18;case 18:for(;i.have<i.ncode;){for(;h<3;){if(0===a)break e;a--,c+=n[o++]<<h,h+=8}i.lens[A[i.have++]]=7&c,c>>>=3,h-=3}for(;i.have<19;)i.lens[A[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,I={bits:i.lenbits},N=x(0,i.lens,0,19,i.lencode,0,i.work,I),i.lenbits=I.bits,N){e.msg="invalid code lengths set",i.mode=30;break}i.have=0,i.mode=19;case 19:for(;i.have<i.nlen+i.ndist;){for(;E=i.lencode[c&(1<<i.lenbits)-1],w=E>>>24,v=E>>>16&255,S=65535&E,!(w<=h);){if(0===a)break e;a--,c+=n[o++]<<h,h+=8}if(S<16)c>>>=w,h-=w,i.lens[i.have++]=S;else{if(16===S){for(B=w+2;h<B;){if(0===a)break e;a--,c+=n[o++]<<h,h+=8}if(c>>>=w,h-=w,0===i.have){e.msg="invalid bit length repeat",i.mode=30;break}O=i.lens[i.have-1],m=3+(3&c),c>>>=2,h-=2}else if(17===S){for(B=w+3;h<B;){if(0===a)break e;a--,c+=n[o++]<<h,h+=8}c>>>=w,h-=w,O=0,m=3+(7&c),c>>>=3,h-=3}else{for(B=w+7;h<B;){if(0===a)break e;a--,c+=n[o++]<<h,h+=8}c>>>=w,h-=w,O=0,m=11+(127&c),c>>>=7,h-=7}if(i.have+m>i.nlen+i.ndist){e.msg="invalid bit length repeat",i.mode=30;break}for(;m--;)i.lens[i.have++]=O}}if(30===i.mode)break;if(0===i.lens[256]){e.msg="invalid code -- missing end-of-block",i.mode=30;break}if(i.lenbits=9,I={bits:i.lenbits},N=x(1,i.lens,0,i.nlen,i.lencode,0,i.work,I),i.lenbits=I.bits,N){e.msg="invalid literal/lengths set",i.mode=30;break}if(i.distbits=6,i.distcode=i.distdyn,I={bits:i.distbits},N=x(2,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,I),i.distbits=I.bits,N){e.msg="invalid distances set",i.mode=30;break}if(i.mode=20,t===Z_TREES)break e;case 20:i.mode=21;case 21:if(a>=6&&l>=258){e.next_out=s,e.avail_out=l,e.next_in=o,e.avail_in=a,i.hold=c,i.bits=h,p(e,g),s=e.next_out,r=e.output,l=e.avail_out,o=e.next_in,n=e.input,a=e.avail_in,c=i.hold,h=i.bits,12===i.mode&&(i.back=-1);break}for(i.back=0;E=i.lencode[c&(1<<i.lenbits)-1],w=E>>>24,v=E>>>16&255,S=65535&E,!(w<=h);){if(0===a)break e;a--,c+=n[o++]<<h,h+=8}if(v&&0==(240&v)){for(T=w,C=v,F=S;E=i.lencode[F+((c&(1<<T+C)-1)>>T)],w=E>>>24,v=E>>>16&255,S=65535&E,!(T+w<=h);){if(0===a)break e;a--,c+=n[o++]<<h,h+=8}c>>>=T,h-=T,i.back+=T}if(c>>>=w,h-=w,i.back+=w,i.length=S,0===v){i.mode=26;break}if(32&v){i.back=-1,i.mode=12;break}if(64&v){e.msg="invalid literal/length code",i.mode=30;break}i.extra=15&v,i.mode=22;case 22:if(i.extra){for(B=i.extra;h<B;){if(0===a)break e;a--,c+=n[o++]<<h,h+=8}i.length+=c&(1<<i.extra)-1,c>>>=i.extra,h-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=23;case 23:for(;E=i.distcode[c&(1<<i.distbits)-1],w=E>>>24,v=E>>>16&255,S=65535&E,!(w<=h);){if(0===a)break e;a--,c+=n[o++]<<h,h+=8}if(0==(240&v)){for(T=w,C=v,F=S;E=i.distcode[F+((c&(1<<T+C)-1)>>T)],w=E>>>24,v=E>>>16&255,S=65535&E,!(T+w<=h);){if(0===a)break e;a--,c+=n[o++]<<h,h+=8}c>>>=T,h-=T,i.back+=T}if(c>>>=w,h-=w,i.back+=w,64&v){e.msg="invalid distance code",i.mode=30;break}i.offset=S,i.extra=15&v,i.mode=24;case 24:if(i.extra){for(B=i.extra;h<B;){if(0===a)break e;a--,c+=n[o++]<<h,h+=8}i.offset+=c&(1<<i.extra)-1,c>>>=i.extra,h-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){e.msg="invalid distance too far back",i.mode=30;break}i.mode=25;case 25:if(0===l)break e;if(m=g-l,i.offset>m){if((m=i.offset-m)>i.whave&&i.sane){e.msg="invalid distance too far back",i.mode=30;break}m>i.wnext?(m-=i.wnext,y=i.wsize-m):y=i.wnext-m,m>i.length&&(m=i.length),_=i.window}else _=r,y=s-i.offset,m=i.length;m>l&&(m=l),l-=m,i.length-=m;do r[s++]=_[y++];while(--m)0===i.length&&(i.mode=21);break;case 26:if(0===l)break e;r[s++]=i.length,l--,i.mode=21;break;case 27:if(i.wrap){for(;h<32;){if(0===a)break e;a--,c|=n[o++]<<h,h+=8}if(g-=l,e.total_out+=g,i.total+=g,g&&(e.adler=i.check=i.flags?d(i.check,r,g,s-g):u(i.check,r,g,s-g)),g=l,(i.flags?c:b(c))!==i.check){e.msg="incorrect data check",i.mode=30;break}c=0,h=0}i.mode=28;case 28:if(i.wrap&&i.flags){for(;h<32;){if(0===a)break e;a--,c+=n[o++]<<h,h+=8}if(c!==(4294967295&i.total)){e.msg="incorrect length check",i.mode=30;break}c=0,h=0}i.mode=29;case 29:N=Z_STREAM_END$1;break e;case 30:N=Z_DATA_ERROR$1;break e;case 31:return Z_MEM_ERROR$1;case 32:default:return Z_STREAM_ERROR$1}return e.next_out=s,e.avail_out=l,e.next_in=o,e.avail_in=a,i.hold=c,i.bits=h,(i.wsize||g!==e.avail_out&&i.mode<30&&(i.mode<27||t!==Z_FINISH$1))&&M(e,e.output,e.next_out,g-e.avail_out),f-=e.avail_in,g-=e.avail_out,e.total_in+=f,e.total_out+=g,i.total+=g,i.wrap&&g&&(e.adler=i.check=i.flags?d(i.check,r,g,e.next_out-g):u(i.check,r,g,e.next_out-g)),e.data_type=i.bits+(i.last?64:0)+(12===i.mode?128:0)+(20===i.mode||15===i.mode?256:0),(0===f&&0===g||t===Z_FINISH$1)&&N===Z_OK$1&&(N=Z_BUF_ERROR),N},I=e=>{if(!e||!e.state)return Z_STREAM_ERROR$1;let t=e.state;return t.window&&(t.window=null),e.state=null,Z_OK$1},B=(e,t)=>{if(!e||!e.state)return Z_STREAM_ERROR$1;const i=e.state;return 0==(2&i.wrap)?Z_STREAM_ERROR$1:(i.head=t,t.done=!1,Z_OK$1)},A=(e,t)=>{const i=t.length;let n,r;return e&&e.state?(n=e.state,0!==n.wrap&&11!==n.mode?Z_STREAM_ERROR$1:11===n.mode&&(r=1,(r=u(r,t,i,0))!==n.check)?Z_DATA_ERROR$1:M(e,t,i,i)?(n.mode=31,Z_MEM_ERROR$1):(n.havedict=1,Z_OK$1)):Z_STREAM_ERROR$1};var P=S,R=T,L=v,k=F,U=C,X=V,z=I,j=B,G=A,q={inflateReset:P,inflateReset2:R,inflateResetKeep:L,inflateInit:k,inflateInit2:U,inflate:X,inflateEnd:z,inflateGetHeader:j,inflateSetDictionary:G,inflateInfo:"pako inflate (from Nodeca project)"};const H=(e,t)=>{return Object.prototype.hasOwnProperty.call(e,t)};var W=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const i=t.shift();if(i){if("object"!=typeof i)throw new TypeError(i+"must be non-object");for(const t in i)H(i,t)&&(e[t]=i[t])}}return e},Y=e=>{let t=0;for(let i=0,n=e.length;i<n;i++)t+=e[i].length;const i=new Uint8Array(t);for(let t=0,n=0,r=e.length;t<r;t++){let r=e[t];i.set(r,n),n+=r.length}return i},$={assign:W,flattenChunks:Y};let Z=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){Z=!1}const K=new Uint8Array(256);for(let e=0;e<256;e++)K[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;K[254]=K[254]=1;var Q=e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,i,n,r,o,s=e.length,a=0;for(r=0;r<s;r++)i=e.charCodeAt(r),55296==(64512&i)&&r+1<s&&56320==(64512&(n=e.charCodeAt(r+1)))&&(i=65536+(i-55296<<10)+(n-56320),r++),a+=i<128?1:i<2048?2:i<65536?3:4;for(t=new Uint8Array(a),o=0,r=0;o<a;r++)i=e.charCodeAt(r),55296==(64512&i)&&r+1<s&&56320==(64512&(n=e.charCodeAt(r+1)))&&(i=65536+(i-55296<<10)+(n-56320),r++),i<128?t[o++]=i:i<2048?(t[o++]=192|i>>>6,t[o++]=128|63&i):i<65536?(t[o++]=224|i>>>12,t[o++]=128|i>>>6&63,t[o++]=128|63&i):(t[o++]=240|i>>>18,t[o++]=128|i>>>12&63,t[o++]=128|i>>>6&63,t[o++]=128|63&i);return t};const J=(e,t)=>{if(t<65534&&e.subarray&&Z)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let i="";for(let n=0;n<t;n++)i+=String.fromCharCode(e[n]);return i};var ee=(e,t)=>{const i=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));let n,r;const o=new Array(2*i);for(r=0,n=0;n<i;){let t=e[n++];if(t<128)o[r++]=t;else{let s=K[t];if(s>4)o[r++]=65533,n+=s-1;else{for(t&=2===s?31:3===s?15:7;s>1&&n<i;)t=t<<6|63&e[n++],s--;s>1?o[r++]=65533:t<65536?o[r++]=t:(t-=65536,o[r++]=55296|t>>10&1023,o[r++]=56320|1023&t)}}}return J(o,r)},te=(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let i=t-1;for(;i>=0&&128==(192&e[i]);)i--;return i<0?t:0===i?t:i+K[e[i]]>t?i:t},ie={string2buf:Q,buf2string:ee,utf8border:te},ne={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},re=i,oe=n;const se=Object.prototype.toString,{Z_NO_FLUSH:Z_NO_FLUSH,Z_FINISH:Z_FINISH,Z_OK:Z_OK,Z_STREAM_END:Z_STREAM_END,Z_NEED_DICT:Z_NEED_DICT,Z_STREAM_ERROR:Z_STREAM_ERROR,Z_DATA_ERROR:Z_DATA_ERROR,Z_MEM_ERROR:Z_MEM_ERROR}=w;r.prototype.push=function(e,t){const i=this.strm,n=this.options.chunkSize,r=this.options.dictionary;let o,s,a;if(this.ended)return!1;for(s=t===~~t?t:t===!0?Z_FINISH:Z_NO_FLUSH,"[object ArrayBuffer]"===se.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;;){for(0===i.avail_out&&(i.output=new Uint8Array(n),i.next_out=0,i.avail_out=n),o=q.inflate(i,s),o===Z_NEED_DICT&&r&&(o=q.inflateSetDictionary(i,r),o===Z_OK?o=q.inflate(i,s):o===Z_DATA_ERROR&&(o=Z_NEED_DICT));i.avail_in>0&&o===Z_STREAM_END&&i.state.wrap>0&&0!==e[i.next_in];)q.inflateReset(i),o=q.inflate(i,s);switch(o){case Z_STREAM_ERROR:case Z_DATA_ERROR:case Z_NEED_DICT:case Z_MEM_ERROR:return this.onEnd(o),this.ended=!0,!1}if(a=i.avail_out,i.next_out&&(0===i.avail_out||o===Z_STREAM_END))if("string"===this.options.to){let e=ie.utf8border(i.output,i.next_out),t=i.next_out-e,r=ie.buf2string(i.output,e);i.next_out=t,i.avail_out=n-t,t&&i.output.set(i.output.subarray(e,e+t),0),this.onData(r)}else this.onData(i.output.length===i.next_out?i.output:i.output.subarray(0,i.next_out));if(o!==Z_OK||0!==a){if(o===Z_STREAM_END)return o=q.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(0===i.avail_in)break}}return!0},r.prototype.onData=function(e){this.chunks.push(e)},r.prototype.onEnd=function(e){e===Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=$.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var ae=r,ue=o,le=s,ce=o,he=w,de={Inflate:ae,inflate:ue,inflateRaw:le,ungzip:ce,constants:he};e.Inflate=ae,e.constants=he,e.default=de,e.inflate=ue,e.inflateRaw=le,e.ungzip=ce,Object.defineProperty(e,"__esModule",{value:!0})}),define("pako_inflate",["pako_inflate/dist/pako_inflate"],function(e){return e}),define("x_ite/InputOutput/FileLoader",["jquery","x_ite/Base/X3DObject","x_ite/Fields","x_ite/Parser/Parser","x_ite/Parser/XMLParser","x_ite/Parser/JSONParser","x_ite/Execution/X3DWorld","standard/Networking/BinaryTransport","pako_inflate","x_ite/DEBUG"],function(e,t,i,n,r,o,s,a,u,l){"use strict";function c(e,i){t.call(this),this.node=e,this.browser=e.getBrowser(),this.external=void 0===i?this.browser.isExternal():i,this.executionContext=this.external?e.getExecutionContext():this.browser.currentScene,this.userAgent=this.browser.getName()+"/"+this.browser.getVersion()+" (X3D Browser; +"+this.browser.getProviderUrl()+")",this.target="",this.url=[],this.URL=new URL(this.getReferer(),this.getReferer()),this.fileReader=new FileReader,this.text=!0}a(e);const h=Symbol.for("X_ITE.dom"),d=/^\s*(?:vrmlscript|javascript|ecmascript)\:([^]*)$/,p=/^data:(.*?)(?:;charset=(.*?))?(?:;(base64))?,([^]*)$/,f=/^(?:(.*?);(.*?)$)/,g=new RegExp(".(?:html|xhtml)$"),m={"text/html":!0,"application/xhtml+xml":!0},y=new i.MFString;c.prototype=Object.assign(Object.create(t.prototype),{constructor:c,abort:function(){this.callback=Function.prototype,this.bindViewpoint=Function.prototype,this.foreign=Function.prototype},getWorldURL:function(){return this.URL},createX3DFromString:function(t,i,r,o){const a=this.browser.createScene();if(this.node instanceof s?a.loader=this:a.setExecutionContext(this.executionContext),a.setWorldURL(new URL(t,this.getReferer()).href),r){const s=[function(t,i,n,r){this.importDocument(t,e.parseXML(i),n,r)},function(e,t,i,n){this.importJS(e,JSON.parse(t),i,n)},function(e,t,i,r){i&&(i=this.setScene.bind(this,e,i,r)),new n(e).parseIntoScene(t,i,r)}],u=[];for(const e of s)try{return void e.call(this,a,i,r,o)}catch(e){u.push(e)}throw console.error(u),new Error("Couldn't parse X3D. No suitable file handler found for '"+t+"'.")}{const t=[function(t,i){this.importDocument(t,e.parseXML(i))},function(e,t){this.importJS(e,JSON.parse(t))},function(e,t){new n(e).parseIntoScene(t)}],r=[];for(const e of t)try{return e.call(this,a,i),a}catch(e){r.push(e)}throw console.error(r),new Error("Couldn't parse x3d syntax.")}},importDocument:function(e,t,i,n){try{i&&(i=this.setScene.bind(this,e,i,n)),new r(e).parseIntoScene(t,i,n),this.node[h]=t}catch(e){if(!n)throw e;n(e)}},importJS:function(e,t,i,n){try{i&&(i=this.setScene.bind(this,e,i,n)),this.node[h]=new o(e).parseIntoScene(t,i,n)}catch(e){if(!n)throw e;n(e)}},setScene:function(e,t,i){e.initLoadCount_.addInterest("set_initLoadCount__",this,e,t,i),e.initLoadCount_.addEvent()},set_initLoadCount__:function(e,t,i,n){if(!e.getValue()){t.initLoadCount_.removeInterest("set_initLoadCount__",this),delete t.loader;try{i(t)}catch(e){if(!n)throw e;n(e)}l&&"data:"!==this.URL.protocol&&console.info("Done loading scene "+this.URL.href)}},createX3DFromURL:function(e,t,i,n,r){return this.bindViewpoint=n,this.foreign=r,this.target=this.getTarget(t||y),i?this.loadDocument(e,this.createX3DFromURLAsync.bind(this,i)):this.createX3DFromURLSync(e)},createX3DFromURLAsync:function(e,t){null===t?e(null):this.createX3DFromString(this.URL,t,e,this.loadDocumentError.bind(this))},createX3DFromURLSync:function(t){if(0===t.length)throw new Error("No URL given.");let i=null,n=!1;for(const r of t)if(this.URL=new URL(r,this.getReferer()),e.ajax({url:this.URL.href,dataType:"text",async:!1,cache:this.browser.getBrowserOptions().getCache()&&this.node.getCache(),global:!1,context:this,success:function(e){try{i=this.createX3DFromString(this.URL,e),n=!0}catch(e){this.error(e)}},error:function(e,t,i){}}),n)return i;throw new Error("Couldn't load any url of '"+Array.prototype.join.call(t,", ")+"'.")},loadScript:function(e,t){this.script=!0,this.loadDocument(e,t)},loadDocument:function(e,t){if(this.url=e.copy(),this.callback=t,0===e.length)return this.loadDocumentError(new Error("No URL given."));this.loadDocumentAsync(this.url.shift())},loadBinaryDocument:function(e,t){if(this.url=e.copy(),this.callback=t,this.text=!1,0===e.length)return this.loadDocumentError(new Error("No URL given."));this.loadDocumentAsync(this.url.shift())},getTarget:function(e){for(const t of e){const e=t.split("=");if(2===e.length&&"target"===e[0])return e[1]}return""},loadDocumentAsync:function(t){try{if(0===t.length)return void this.loadDocumentError(new Error("URL is empty."));if(this.script){const e=d.exec(t);if(e)return void this.callback(e[1])}{const e=p.exec(t);if(e){let t=e[4];return t="base64"===e[3]?atob(t):unescape(t),void this.callback(t)}}if(this.URL=new URL(t,this.getReferer()),this.bindViewpoint&&this.URL.href.substr(0,this.getReferer().length)===this.getReferer())return void this.bindViewpoint(this.URL.hash.substr(1));if(this.foreign){if(this.target.length&&"_self"!==this.target)return this.foreign(this.URL.href,this.target);if(this.URL.href.match(g))return this.foreign(this.URL.href,this.target)}e.ajax({url:this.URL.href,dataType:"binary",async:!0,cache:this.browser.getBrowserOptions().getCache()&&this.node.getCache(),global:!1,context:this,success:function(e,t,i){if(this.foreign&&m[this.getContentType(i)])return this.foreign(this.URL.href,this.target);this.text?(this.fileReader.onload=this.readAsArrayBuffer.bind(this,e),this.fileReader.readAsArrayBuffer(e)):(this.fileReader.onload=this.readAsBinaryString.bind(this),this.fileReader.readAsBinaryString(e))},error:function(e,t,i){this.loadDocumentError(new Error(i))}})}catch(e){return void this.loadDocumentError(e)}},readAsArrayBuffer:function(e){try{this.callback(u.ungzip(this.fileReader.result,{to:"string"}))}catch(t){this.fileReader.onload=this.readAsText.bind(this,e),this.fileReader.readAsText(e)}},readAsText:function(e){try{this.callback(this.fileReader.result)}catch(e){this.loadDocumentError(e)}},readAsBinaryString:function(){try{this.callback(this.fileReader.result)}catch(e){this.loadDocumentError(e)}},loadDocumentError:function(e){this.error(e),this.url.length?this.loadDocumentAsync(this.url.shift()):this.callback(null)},error:function(e){"data:"===this.URL.protocol?console.warn("Couldn't load URL 'data':",e.message):console.warn("Couldn't load URL '"+this.URL.href+"':",e.message),l&&console.log(e)},getReferer:function(){return"X3DWorld"===this.node.getTypeName()&&this.external?this.browser.getLocation():this.executionContext.getWorldURL()},getContentType:function(e){const t=e.getResponseHeader("Content-Type"),i=f.exec(t);return i?i[1]:""}});for(const e of Reflect.ownKeys(c.prototype))Object.defineProperty(c.prototype,e,{enumerable:!1});return c}),define("x_ite/Components/Shaders/ShaderPart",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Browser/Shaders/Shader","x_ite/Components/Core/X3DNode","x_ite/Components/Networking/X3DUrlObject","x_ite/InputOutput/FileLoader","x_ite/Base/X3DConstants","x_ite/DEBUG"],function(e,t,i,n,r,o,s,a,u){"use strict";function l(e){r.call(this,e),o.call(this,e),this.addType(a.ShaderPart),this.valid=!1}return l.prototype=Object.assign(Object.create(r.prototype),o.prototype,{constructor:l,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(a.inputOutput,"metadata",new e.SFNode),new t(a.initializeOnly,"type",new e.SFString("VERTEX")),new t(a.inputOutput,"load",new e.SFBool(!0)),new t(a.inputOutput,"url",new e.MFString),new t(a.inputOutput,"autoRefresh",new e.SFTime),new t(a.inputOutput,"autoRefreshTimeLimit",new e.SFTime(3600))]),getTypeName:function(){return"ShaderPart"},getComponentName:function(){return"Shaders"},getContainerField:function(){return"parts"},initialize:function(){r.prototype.initialize.call(this),o.prototype.initialize.call(this);const e=this.getBrowser().getContext();this.shader=e.createShader(e[this.getShaderType()]),this.requestImmediateLoad()},isValid:function(){return this.valid},getShader:function(){return this.shader},getShaderType:function(){const e={VERTEX:"VERTEX_SHADER",TESS_CONTROL:"TESS_CONTROL_SHADER",TESS_EVALUATION:"TESS_EVALUATION_SHADER",GEOMETRY:"GEOMETRY_SHADER",FRAGMENT:"FRAGMENT_SHADER",COMPUTE:"COMPUTE_SHADER"};return function(){const t=e[this.type_.getValue()];return t?t:"VERTEX_SHADER"}}(),getSourceText:function(){return this.url_},setShadow:function(e){this.shadow=e},getShadow:function(){return this.shadow},unloadNow:function(){this.valid=!1},loadNow:function(){this.valid=!1,new s(this).loadDocument(this.urlBuffer_,function(e){if(null===e)this.setLoadState(a.FAILED_STATE);else{const t=this.getBrowser().getContext(),i=n.getShaderSource(this.getBrowser(),this.getName(),e,this.shadow);if(t.shaderSource(this.shader,i),t.compileShader(this.shader),this.valid=t.getShaderParameter(this.shader,t.COMPILE_STATUS),!this.valid)throw new Error(this.getTypeName()+" '"+this.getName()+"': "+t.getShaderInfoLog(this.shader));this.setLoadState(a.COMPLETE_STATE)}}.bind(this))}}),l}),define("x_ite/Browser/Shaders/ShaderTest",["x_ite/Rendering/TextureBuffer","standard/Math/Numbers/Vector4","standard/Math/Numbers/Matrix3","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Camera"],function(e,t,i,n,r){"use strict";return{verify:function(){const t=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1],o=[2,2,0,1,-2,2,0,1,-2,-2,0,1,2,2,0,1,-2,-2,0,1,2,-2,0,1];return function(s,a){const u=s.getContext(),l=new e(s,16,16),c=u.createBuffer(),h=u.createBuffer();l.bind(),a.enable(u),a.setLocalObjects(u,[]),u.bindBuffer(u.ARRAY_BUFFER,h),u.bufferData(u.ARRAY_BUFFER,new Float32Array(o),u.STATIC_DRAW),u.bindBuffer(u.ARRAY_BUFFER,c),u.bufferData(u.ARRAY_BUFFER,new Float32Array(t),u.STATIC_DRAW),u.uniformMatrix4fv(a.x3d_ProjectionMatrix,!1,new Float32Array(r.ortho(-1,1,-1,1,-1,1,new n))),u.uniformMatrix4fv(a.x3d_ModelViewMatrix,!1,new Float32Array(n.Identity)),u.uniformMatrix3fv(a.x3d_NormalMatrix,!1,new Float32Array(i.Identity)),u.uniform1i(a.x3d_FogType,0),u.uniform1f(a.x3d_AlphaCutoff,0),u.uniform1i(a.x3d_FillPropertiesFilled,!0),u.uniform1i(a.x3d_FillPropertiesHatched,!1),u.uniform1i(a.x3d_ColorMaterial,!1),u.uniform1i(a.x3d_NumLights,0),u.uniform1i(a.x3d_NumTextures,0),u.uniform1i(a.x3d_NumProjectiveTextures,0),u.uniform1i(a.x3d_NumClipPlanes,0),u.uniform1f(a.x3d_AmbientIntensity,0),u.uniform3f(a.x3d_DiffuseColor,1,0,0),u.uniform3f(a.x3d_SpecularColor,1,0,0),u.uniform3f(a.x3d_EmissiveColor,1,0,0),u.uniform1f(a.x3d_Shininess,0),u.uniform1f(a.x3d_Transparency,0),u.viewport(0,0,16,16),u.clearColor(0,0,0,0),u.clear(u.COLOR_BUFFER_BIT),u.disable(u.DEPTH_TEST),u.disable(u.BLEND),u.frontFace(u.CCW),u.enable(u.CULL_FACE),u.cullFace(u.BACK),a.enableNormalAttribute(u,c),a.enableVertexAttribute(u,h),u.drawArrays(u.TRIANGLES,0,6),a.disableNormalAttribute(u,c),a.disable(u);l.readPixels();return l.unbind(),!0}}()}}),define("x_ite/Browser/Shaders/X3DShadersContext",["x_ite/Browser/Core/Shading","x_ite/Components/Shaders/ComposedShader","x_ite/Components/Shaders/ShaderPart","x_ite/Browser/Shaders/ShaderTest","x_ite/Browser/Networking/urls"],function(e,t,i,n,r){"use strict";function o(){this[s]=new Set}const s=Symbol(),a=Symbol(),u=Symbol(),l=Symbol(),c=Symbol(),h=Symbol(),d=Symbol(),p=Symbol(),f=Symbol();return o.prototype={initialize:function(){this.setShading(this.getBrowserOptions().getShading())},getShadingLanguageVersion:function(){const e=this.getContext();return e.getParameter(e.SHADING_LANGUAGE_VERSION)},getMaxVertexUniformVectors:function(){const e=this.getContext();return e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS)},getMaxFragmentUniformVectors:function(){const e=this.getContext();return e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS)},getMaxVertexAttribs:function(){const e=this.getContext();return e.getParameter(e.MAX_VERTEX_ATTRIBS)},addShader:function(e){this[s].add(e),e.setShading(this.getBrowserOptions().getShading())},removeShader:function(e){this[s].delete(e)},getShaders:function(){return this[s]},getDefaultShader:function(){
return this[a]},hasPointShader:function(){return!!this[u]},getPointShader:function(){return this[u]=this.createShader("PointShader","PointSet"),this.getPointShader=function(){return this[u]},Object.defineProperty(this,"getPointShader",{enumerable:!1}),this[u]},hasLineShader:function(){return!!this[l]},getLineShader:function(){return this[l]=this.createShader("WireframeShader","Wireframe"),this.getLineShader=function(){return this[l]},Object.defineProperty(this,"getLineShader",{enumerable:!1}),this[l]},hasUnlitShader:function(){return!!this[c]},getUnlitShader:function(){return this[c]=this.createShader("UnlitShader","Unlit"),this[c].isValid_.addInterest("set_unlit_shader_valid__",this),this.getUnlitShader=function(){return this[c]},Object.defineProperty(this,"getUnlitShader",{enumerable:!1}),this[c]},hasGouraudShader:function(){return!!this[h]},getGouraudShader:function(){return this[h]=this.createShader("GouraudShader","Gouraud",!1),this[h].isValid_.addInterest("set_gouraud_shader_valid__",this),this.getGouraudShader=function(){return this[h]},Object.defineProperty(this,"getGouraudShader",{enumerable:!1}),this[h]},hasPhongShader:function(){return!!this[d]},getPhongShader:function(){return this[d]=this.createShader("PhongShader","Phong",!1),this[d].isValid_.addInterest("set_phong_shader_valid__",this),this.getPhongShader=function(){return this[d]},Object.defineProperty(this,"getPhongShader",{enumerable:!1}),this[d]},hasShadowShader:function(){return!!this[p]},getShadowShader:function(){return this[p]=this.createShader("ShadowShader","Phong",!0),this[p].isValid_.addInterest("set_shadow_shader_valid__",this),this.getShadowShader=function(){return this[p]},Object.defineProperty(this,"getShadowShader",{enumerable:!1}),this[p]},hasDepthShader:function(){return!!this[f]},getDepthShader:function(){return this[f]=this.createShader("DepthShader","Depth"),this.getDepthShader=function(){return this[f]},Object.defineProperty(this,"getDepthShader",{enumerable:!1}),this[f]},setShading:function(t){switch(t){case e.PHONG:this[a]=this.getPhongShader();break;default:this[a]=this.getGouraudShader()}for(const e of this.getShaders())e.setShading(t)},createShader:function(e,n,o=!1){this.getDebug()&&console.log("Initializing "+e);const s=this.getContext(),a=s.getVersion(),u=new i(this.getPrivateScene());u.setName(e+"Vertex"),u.url_.push(r.getShaderUrl("webgl"+a+"/"+n+".vs")),u.setShadow(o),u.setup();const l=new i(this.getPrivateScene());l.setName(e+"Fragment"),l.type_="FRAGMENT",l.url_.push(r.getShaderUrl("webgl"+a+"/"+n+".fs")),l.setShadow(o),l.setup();const c=new t(this.getPrivateScene());return c.setName(e),c.language_="GLSL",c.parts_.push(u),c.parts_.push(l),c.setCustom(!1),c.setShading(this.getBrowserOptions().getShading()),c.setup(),this.addShader(c),c},set_unlit_shader_valid__:function(e){this[c].isValid_.removeInterest("set_unlit_shader_valid__",this),e.getValue()&&n.verify(this,this[c])||(console.error("X_ITE: Unlit shading is not available, using fallback VRML shader."),this[c].parts_[0].url=[r.getShaderUrl("webgl1/FallbackUnlit.vs")],this[c].parts_[1].url=[r.getShaderUrl("webgl1/FallbackUnlit.fs")])},set_gouraud_shader_valid__:function(e){this[h].isValid_.removeInterest("set_gouraud_shader_valid__",this),e.getValue()&&n.verify(this,this[h])||(console.warn("X_ITE: All else fails, using fallback VRML shader."),this[h].parts_[0].url=[r.getShaderUrl("webgl1/Fallback.vs")],this[h].parts_[1].url=[r.getShaderUrl("webgl1/Fallback.fs")])},set_phong_shader_valid__:function(e){this[d].isValid_.removeInterest("set_phong_shader_valid__",this),e.getValue()&&n.verify(this,this[d])||(console.warn("X_ITE: Phong shading is not available, using Gouraud shading."),this[d]=this.getGouraudShader(),this.setShading(this.getBrowserOptions().getShading()))},set_shadow_shader_valid__:function(e){this[p].isValid_.removeInterest("set_shadow_shader_valid__",this),e.getValue()&&n.verify(this,this[p])||(console.warn("X_ITE: Shadow shading is not available, using Gouraud shading."),this[p]=this.getGouraudShader())}},o});!function(e,t){"function"==typeof define&&define.amd?define("ResizeSensor/src/ResizeSensor",t):e.ResizeSensor=t()}("undefined"!=typeof window?window:this,function(){function e(e,t){var i=Object.prototype.toString.call(e),n="[object Array]"===i||"[object NodeList]"===i||"[object HTMLCollection]"===i||"[object Object]"===i||"undefined"!=typeof jQuery&&e instanceof jQuery||"undefined"!=typeof Elements&&e instanceof Elements,r=0,o=e.length;if(n)for(;r<o;r++)t(e[r]);else t(e)}function t(e){if(!e.getBoundingClientRect)return{width:e.offsetWidth,height:e.offsetHeight};var t=e.getBoundingClientRect();return{width:Math.round(t.width),height:Math.round(t.height)}}function i(e,t){Object.keys(t).forEach(function(i){e.style[i]=t[i]})}if("undefined"==typeof window)return null;var n="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),r=n.requestAnimationFrame||n.mozRequestAnimationFrame||n.webkitRequestAnimationFrame||function(e){return n.setTimeout(e,20)},o=n.cancelAnimationFrame||n.mozCancelAnimationFrame||n.webkitCancelAnimationFrame||function(e){n.clearTimeout(e)},s=function(n,a){function u(){var e=[];this.add=function(t){e.push(t)};var t,i;this.call=function(n){for(t=0,i=e.length;t<i;t++)e[t].call(this,n)},this.remove=function(n){var r=[];for(t=0,i=e.length;t<i;t++)e[t]!==n&&r.push(e[t]);e=r},this.length=function(){return e.length}}function l(e,n){if(e){if(e.resizedAttached)return void e.resizedAttached.add(n);e.resizedAttached=new u,e.resizedAttached.add(n),e.resizeSensor=document.createElement("div"),e.resizeSensor.dir="ltr",e.resizeSensor.className="resize-sensor";var o={pointerEvents:"none",position:"absolute",left:"0px",top:"0px",right:"0px",bottom:"0px",overflow:"hidden",zIndex:"-1",visibility:"hidden",maxWidth:"100%"},s={position:"absolute",left:"0px",top:"0px",transition:"0s"};i(e.resizeSensor,o);var a=document.createElement("div");a.className="resize-sensor-expand",i(a,o);var l=document.createElement("div");i(l,s),a.appendChild(l);var h=document.createElement("div");h.className="resize-sensor-shrink",i(h,o);var d=document.createElement("div");i(d,s),i(d,{width:"200%",height:"200%"}),h.appendChild(d),e.resizeSensor.appendChild(a),e.resizeSensor.appendChild(h),e.appendChild(e.resizeSensor);var p=window.getComputedStyle(e),f=p?p.getPropertyValue("position"):null;"absolute"!==f&&"relative"!==f&&"fixed"!==f&&"sticky"!==f&&(e.style.position="relative");var g=!1,m=0,y=t(e),_=0,x=0,w=!0;c=0;var b=function(){var t=e.offsetWidth,i=e.offsetHeight;l.style.width=t+10+"px",l.style.height=i+10+"px",a.scrollLeft=t+10,a.scrollTop=i+10,h.scrollLeft=t+10,h.scrollTop=i+10},v=function(){if(w){if(0===e.offsetWidth&&0===e.offsetHeight)return void(c||(c=r(function(){c=0,v()})));w=!1}b()};e.resizeSensor.resetSensor=v;var S=function(){m=0,g&&(_=y.width,x=y.height,e.resizedAttached&&e.resizedAttached.call(y))},T=function(){y=t(e),g=y.width!==_||y.height!==x,g&&!m&&(m=r(S)),v()},C=function(e,t,i){e.attachEvent?e.attachEvent("on"+t,i):e.addEventListener(t,i)};C(a,"scroll",T),C(h,"scroll",T),c=r(function(){c=0,v()})}}var c=0;e(n,function(e){l(e,a)}),this.detach=function(e){c||(o(c),c=0),s.detach(n,e)},this.reset=function(){n.resizeSensor.resetSensor()}};if(s.reset=function(t){e(t,function(e){e.resizeSensor.resetSensor()})},s.detach=function(t,i){e(t,function(e){e&&(e.resizedAttached&&"function"==typeof i&&(e.resizedAttached.remove(i),e.resizedAttached.length())||e.resizeSensor&&(e.contains(e.resizeSensor)&&e.removeChild(e.resizeSensor),delete e.resizeSensor,delete e.resizedAttached))})},"undefined"!=typeof MutationObserver){var a=new MutationObserver(function(e){for(var t in e)if(e.hasOwnProperty(t))for(var i=e[t].addedNodes,n=0;n<i.length;n++)i[n].resizeSensor&&s.reset(i[n])});document.addEventListener("DOMContentLoaded",function(e){a.observe(document.body,{childList:!0,subtree:!0})})}return s}),define("ResizeSensor",["ResizeSensor/src/ResizeSensor"],function(e){return e}),define("x_ite/Browser/Rendering/X3DRenderingContext",["jquery","ResizeSensor"],function(e,t){"use strict";function i(){this[n]=[0,0,300,150],this[r]=[]}const n=Symbol(),r=Symbol(),o=Symbol();return i.prototype={initialize:function(){const i=this.getContext();i.enable(i.SCISSOR_TEST),i.cullFace(i.BACK),i.enable(i.DEPTH_TEST),i.depthFunc(i.LEQUAL),i.clearDepth(1),i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA),i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD),i.enable(i.BLEND),e(document).on("webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange",this.onfullscreen.bind(this)),this[o]=new t(this.getSurface(),this.reshape.bind(this)),this.reshape()},getRenderer:function(){const e=this.getContext(),t=this.getExtension("WEBGL_debug_renderer_info");return t?e.getParameter(t.UNMASKED_RENDERER_WEBGL):e.getParameter(this.getContext().RENDERER)},getVendor:function(){const e=this.getContext(),t=this.getExtension("WEBGL_debug_renderer_info");return t?e.getParameter(t.UNMASKED_VENDOR_WEBGL):e.getParameter(this.getContext().VENDOR)},getWebGLVersion:function(){const e=this.getContext();return e.getParameter(e.VERSION)},getAntialiased:function(){const e=this.getContext();return e.getParameter(e.SAMPLES)>0},getMaxClipPlanes:function(){return 6},getDepthSize:function(){const e=this.getContext();return e.getParameter(e.DEPTH_BITS)},getColorDepth:function(){const e=this.getContext();return e.getParameter(e.RED_BITS)+e.getParameter(e.BLUE_BITS)+e.getParameter(e.GREEN_BITS)+e.getParameter(e.ALPHA_BITS)},getViewport:function(){return this[n]},getLocalObjects:function(){return this[r]},reshape:function(){const e=this.getContext(),t=this.getCanvas(),i=t.width(),r=t.height(),o=t[0];o.width=i,o.height=r,this[n][2]=i,this[n][3]=r,e.viewport(0,0,i,r),e.scissor(0,0,i,r),this.addBrowserEvent()},onfullscreen:function(){const e=this.getElement();e.fullScreen()?e.addClass("x_ite-fullscreen"):e.removeClass("x_ite-fullscreen")}},i}),define("x_ite/Components/Shape/X3DAppearanceNode",["x_ite/Fields","x_ite/Components/Core/X3DNode","x_ite/Base/X3DConstants"],function(e,t,i){"use strict";function n(n){t.call(this,n),this.addType(i.X3DAppearanceNode),this.addChildObjects("transparent",new e.SFBool),this.transparent_.setAccessType(i.outputOnly)}return n.prototype=Object.assign(Object.create(t.prototype),{constructor:n,setTransparent:function(e){e!==this.transparent_.getValue()&&(this.transparent_=e)},getTransparent:function(){return this.transparent_.getValue()}}),n}),define("x_ite/Browser/Shape/AlphaMode",[],function(){"use strict";let e=0;return{AUTO:e++,OPAQUE:e++,MASK:e++,BLEND:e++}}),define("x_ite/Components/Shape/Appearance",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Shape/X3DAppearanceNode","x_ite/Base/X3DCast","x_ite/Base/X3DConstants","x_ite/Browser/Shape/AlphaMode"],function(e,t,i,n,r,o,s){"use strict";function a(e){n.call(this,e),this.addType(o.Appearance),this.stylePropertiesNode=[],this.materialNode=null,this.backMaterialNode=null,this.textureNode=null,this.textureTransformNode=null,this.shaderNodes=[],this.shaderNode=null,this.blendModeNode=null}return a.prototype=Object.assign(Object.create(n.prototype),{constructor:a,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOutput,"alphaMode",new e.SFString("AUTO")),new t(o.inputOutput,"alphaCutoff",new e.SFFloat(.5)),new t(o.inputOutput,"pointProperties",new e.SFNode),new t(o.inputOutput,"lineProperties",new e.SFNode),new t(o.inputOutput,"fillProperties",new e.SFNode),new t(o.inputOutput,"material",new e.SFNode),new t(o.inputOutput,"backMaterial",new e.SFNode),new t(o.inputOutput,"texture",new e.SFNode),new t(o.inputOutput,"textureTransform",new e.SFNode),new t(o.inputOutput,"shaders",new e.MFNode),new t(o.inputOutput,"blendMode",new e.SFNode)]),getTypeName:function(){return"Appearance"},getComponentName:function(){return"Shape"},getContainerField:function(){return"appearance"},initialize:function(){n.prototype.initialize.call(this),this.isLive().addInterest("set_live__",this),this.alphaMode_.addInterest("set_alphaMode__",this),this.alphaCutoff_.addInterest("set_alphaCutoff__",this),this.pointProperties_.addInterest("set_pointProperties__",this),this.lineProperties_.addInterest("set_lineProperties__",this),this.fillProperties_.addInterest("set_fillProperties__",this),this.material_.addInterest("set_material__",this),this.backMaterial_.addInterest("set_backMaterial__",this),this.texture_.addInterest("set_texture__",this),this.textureTransform_.addInterest("set_textureTransform__",this),this.shaders_.addInterest("set_shaders__",this),this.blendMode_.addInterest("set_blendMode__",this),this.alphaMode_.addInterest("set_transparent__",this),this.fillProperties_.addInterest("set_transparent__",this),this.material_.addInterest("set_transparent__",this),this.texture_.addInterest("set_transparent__",this),this.blendMode_.addInterest("set_transparent__",this),this.set_live__(),this.set_alphaMode__(),this.set_pointProperties__(),this.set_lineProperties__(),this.set_fillProperties__(),this.set_material__(),this.set_backMaterial__(),this.set_texture__(),this.set_textureTransform__(),this.set_shaders__(),this.set_blendMode__(),this.set_transparent__()},getAlphaMode:function(){return this.alphaMode},set_live__:function(){this.isLive().getValue()?(this.getBrowser().getBrowserOptions().Shading_.addInterest("set_shading__",this),this.shaderNode&&this.getBrowser().addShader(this.shaderNode)):(this.getBrowser().getBrowserOptions().Shading_.removeInterest("set_shading__",this),this.shaderNode&&this.getBrowser().removeShader(this.shaderNode))},set_alphaMode__:function(){this.alphaMode=s[this.alphaMode_.getValue()]||s.AUTO,this.set_alphaCutoff__()},set_alphaCutoff__:function(){this.alphaCutoff=this.alphaMode===s.MASK?this.alphaCutoff_.getValue():0},set_pointProperties__:function(){this.stylePropertiesNode[0]=r(o.PointProperties,this.pointProperties_),this.stylePropertiesNode[0]||(this.stylePropertiesNode[0]=this.getBrowser().getDefaultPointProperties())},set_lineProperties__:function(){this.stylePropertiesNode[1]=r(o.LineProperties,this.lineProperties_),this.stylePropertiesNode[1]||(this.stylePropertiesNode[1]=this.getBrowser().getDefaultLineProperties())},set_fillProperties__:function(){this.stylePropertiesNode[2]&&this.stylePropertiesNode[2].transparent_.removeInterest("set_transparent__",this),this.stylePropertiesNode[2]=r(o.FillProperties,this.fillProperties_),this.stylePropertiesNode[2]||(this.stylePropertiesNode[2]=this.getBrowser().getDefaultFillProperties()),this.stylePropertiesNode[2]&&this.stylePropertiesNode[2].transparent_.addInterest("set_transparent__",this),this.stylePropertiesNode[3]=this.stylePropertiesNode[2]},set_material__:function(){this.materialNode&&this.materialNode.transparent_.removeInterest("set_transparent__",this),this.materialNode=r(o.X3DMaterialNode,this.material_),this.materialNode||(this.materialNode=this.getBrowser().getDefaultMaterial()),this.materialNode&&this.materialNode.transparent_.addInterest("set_transparent__",this),"TwoSidedMaterial"===this.materialNode.getTypeName()&&(console.warn("TwoSidedMaterial is depreciated, please use Appearance backMaterial."),this.set_backMaterial__())},set_backMaterial__:function(){this.backMaterialNode&&this.backMaterialNode.transparent_.removeInterest("set_transparent__",this),this.backMaterialNode=r(o.X3DOneSidedMaterialNode,this.backMaterial_),this.backMaterialNode&&this.backMaterialNode.transparent_.addInterest("set_transparent__",this),this.backMaterialNode||"TwoSidedMaterial"!==this.materialNode.getTypeName()||(this.backMaterialNode=this.materialNode)},set_texture__:function(){this.textureNode&&this.textureNode.transparent_.removeInterest("set_transparent__",this),this.textureNode=r(o.X3DTextureNode,this.texture_),this.textureNode&&this.textureNode.transparent_.addInterest("set_transparent__",this)},set_textureTransform__:function(){this.textureTransformNode=r(o.X3DTextureTransformNode,this.textureTransform_),this.textureTransformNode||(this.textureTransformNode=this.getBrowser().getDefaultTextureTransform())},set_shaders__:function(){const e=this.shaderNodes;for(const t of e)t.isValid_.removeInterest("set_shader__",this),t.activationTime_.removeInterest("set_shader__",this);e.length=0;for(const t of this.shaders_){const i=r(o.X3DShaderNode,t);i&&(e.push(i),i.isValid_.addInterest("set_shader__",this),i.activationTime_.addInterest("set_shader__",this))}this.set_shader__()},set_shader__:function(){const e=this.shaderNodes;this.shaderNode&&(this.getBrowser().removeShader(this.shaderNode),this.shaderNode.deselect()),this.shaderNode=null;for(const t of e)if(t.isValid_.getValue()&&t.activationTime_.getValue()===this.getBrowser().getCurrentTime()){this.shaderNode=t;break}if(!this.shaderNode)for(const t of e)if(t.isValid_.getValue()){this.shaderNode=t;break}this.isLive().getValue()&&this.shaderNode&&(this.getBrowser().addShader(this.shaderNode),this.shaderNode.select())},set_shading__:function(){this.set_shader__()},set_blendMode__:function(){this.blendModeNode=r(o.BlendMode,this.blendMode_)},set_transparent__:function(){switch(this.alphaMode){case s.AUTO:this.setTransparent(Boolean(this.stylePropertiesNode[3].getTransparent()||this.materialNode&&this.materialNode.getTransparent()||this.backMaterialNode&&this.backMaterialNode.getTransparent()||this.textureNode&&this.textureNode.getTransparent()||this.blendModeNode));break;case s.OPAQUE:this.setTransparent(!1);break;case s.MASK:this.setTransparent(!1);break;case s.BLEND:this.setTransparent(!0)}},traverse:function(e,t){this.textureNode&&this.textureNode.traverse(e,t),this.shaderNode&&this.shaderNode.traverse(e,t)}}),a}),define("x_ite/Components/Shape/PointProperties",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Shape/X3DAppearanceChildNode","x_ite/Base/X3DConstants"],function(e,t,i,n,r){"use strict";function o(e){n.call(this,e),this.addType(r.PointProperties),this.pointSizeAttenuation=new Float32Array(3)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"pointSizeScaleFactor",new e.SFFloat(1)),new t(r.inputOutput,"pointSizeMinValue",new e.SFFloat(1)),new t(r.inputOutput,"pointSizeMaxValue",new e.SFFloat(1)),new t(r.inputOutput,"pointSizeAttenuation",new e.MFFloat(1,0,0)),new t(r.inputOutput,"colorMode",new e.SFString("TEXTURE_AND_POINT_COLOR"))]),getTypeName:function(){return"PointProperties"},getComponentName:function(){return"Shape"},getContainerField:function(){return"pointProperties"},initialize:function(){n.prototype.initialize.call(this),this.pointSizeScaleFactor_.addInterest("set_pointSizeScaleFactor__",this),this.pointSizeMinValue_.addInterest("set_pointSizeMinValue__",this),this.pointSizeMaxValue_.addInterest("set_pointSizeMaxValue__",this),this.pointSizeAttenuation_.addInterest("set_pointSizeAttenuation__",this),this.colorMode_.addInterest("set_colorMode__",this),this.set_pointSizeScaleFactor__(),this.set_pointSizeMinValue__(),this.set_pointSizeMaxValue__(),this.set_pointSizeAttenuation__(),this.set_colorMode__()},set_pointSizeScaleFactor__:function(){this.pointSizeScaleFactor=Math.max(1,this.pointSizeScaleFactor_.getValue())},set_pointSizeMinValue__:function(){this.pointSizeMinValue=Math.max(0,this.pointSizeMinValue_.getValue())},set_pointSizeMaxValue__:function(){this.pointSizeMaxValue=Math.max(0,this.pointSizeMaxValue_.getValue())},set_pointSizeAttenuation__:function(){const e=this.pointSizeAttenuation_.length;this.pointSizeAttenuation[0]=e>0?Math.max(0,this.pointSizeAttenuation_[0]):1,this.pointSizeAttenuation[1]=e>1?Math.max(0,this.pointSizeAttenuation_[1]):0,this.pointSizeAttenuation[2]=e>2?Math.max(0,this.pointSizeAttenuation_[2]):0},set_colorMode__:function(){const e=new Map([["POINT_COLOR",0],["TEXTURE_COLOR",1],["TEXTURE_AND_POINT_COLOR",2]]);return function(){const t=e.get(this.colorMode_.getValue());this.colorMode=void 0!==t?t:e.get("TEXTURE_AND_POINT_COLOR")}}(),setShaderUniforms:function(e,t){e.uniform1f(t.x3d_PointPropertiesPointSizeScaleFactor,this.pointSizeScaleFactor),e.uniform1f(t.x3d_PointPropertiesPointSizeMinValue,this.pointSizeMinValue),e.uniform1f(t.x3d_PointPropertiesPointSizeMaxValue,this.pointSizeMaxValue),e.uniform3fv(t.x3d_PointPropertiesPointSizeAttenuation,this.pointSizeAttenuation),e.uniform1i(t.x3d_PointPropertiesColorMode,this.colorMode)}}),o}),define("x_ite/Components/Shape/LineProperties",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Shape/X3DAppearanceChildNode","x_ite/Base/X3DConstants"],function(e,t,i,n,r){"use strict";function o(e){n.call(this,e),this.addType(r.LineProperties)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"applied",new e.SFBool(!0)),new t(r.inputOutput,"linetype",new e.SFInt32(1)),new t(r.inputOutput,"linewidthScaleFactor",new e.SFFloat)]),getTypeName:function(){return"LineProperties"},getComponentName:function(){return"Shape"},getContainerField:function(){return"lineProperties"},initialize:function(){n.prototype.initialize.call(this),this.applied_.addInterest("set_applied__",this),this.linewidthScaleFactor_.addInterest("set_linewidthScaleFactor__",this),this.set_applied__(),this.set_linewidthScaleFactor__()},set_applied__:function(){this.applied=this.applied_.getValue()},set_linewidthScaleFactor__:function(){this.linewidthScaleFactor=Math.max(1,this.linewidthScaleFactor_.getValue())},setShaderUniforms:function(e,t){if(this.applied){const i=t.getBrowser(),n=i.getLinetype(this.linetype_.getValue());e.lineWidth(this.linewidthScaleFactor),e.uniform1i(t.x3d_LinePropertiesApplied,!0),e.uniform1f(t.x3d_LinePropertiesLinewidthScaleFactor,this.linewidthScaleFactor),e.activeTexture(e.TEXTURE0+i.getLinetypeUnit()),e.bindTexture(e.TEXTURE_2D,n.getTexture())}else e.lineWidth(1),e.uniform1i(t.x3d_LinePropertiesApplied,!1),e.uniform1f(t.x3d_LinePropertiesLinewidthScaleFactor,1)}}),o}),define("x_ite/Components/Shape/FillProperties",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Shape/X3DAppearanceChildNode","x_ite/Base/X3DConstants"],function(e,t,i,n,r){"use strict";function o(t){n.call(this,t),this.addType(r.FillProperties),this.addChildObjects("transparent",new e.SFBool),this.transparent_.setAccessType(r.outputOnly),this.hatchColor=new Float32Array(3)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"filled",new e.SFBool(!0)),new t(r.inputOutput,"hatched",new e.SFBool(!0)),new t(r.inputOutput,"hatchColor",new e.SFColor(1,1,1)),new t(r.inputOutput,"hatchStyle",new e.SFInt32(1))]),getTypeName:function(){return"FillProperties"},getComponentName:function(){return"Shape"},getContainerField:function(){return"fillProperties"},initialize:function(){n.prototype.initialize.call(this),this.filled_.addInterest("set_filled__",this),this.hatched_.addInterest("set_hatched__",this),this.hatchColor_.addInterest("set_hatchColor__",this),this.set_filled__(),this.set_hatched__(),this.set_hatchColor__()},set_filled__:function(){this.filled=this.filled_.getValue(),this.setTransparent(!this.filled)},set_hatched__:function(){this.hatched=this.hatched_.getValue()},set_hatchColor__:function(){this.hatchColor[0]=this.hatchColor_[0],this.hatchColor[1]=this.hatchColor_[1],this.hatchColor[2]=this.hatchColor_[2]},setTransparent:function(e){e!==this.transparent_.getValue()&&(this.transparent_=e)},getTransparent:function(){return this.transparent_.getValue()},setShaderUniforms:function(e,t){const i=this.hatched;if(e.uniform1i(t.x3d_FillPropertiesFilled,this.filled),e.uniform1i(t.x3d_FillPropertiesHatched,i),i){const i=t.getBrowser(),n=i.getHatchStyle(this.hatchStyle_.getValue());e.uniform3fv(t.x3d_FillPropertiesHatchColor,this.hatchColor),e.activeTexture(e.TEXTURE0+i.getHatchStyleUnit()),e.bindTexture(e.TEXTURE_2D,n.getTexture())}}}),o}),define("x_ite/Components/Shape/X3DMaterialNode",["x_ite/Fields","x_ite/Components/Shape/X3DAppearanceChildNode","x_ite/Base/X3DConstants"],function(e,t,i){"use strict";function n(n){t.call(this,n),this.addType(i.X3DMaterialNode),this.addChildObjects("transparent",new e.SFBool),this.transparent_.setAccessType(i.outputOnly)}return n.prototype=Object.assign(Object.create(t.prototype),{constructor:n,setTransparent:function(e){e!==this.transparent_.getValue()&&(this.transparent_=e)},getTransparent:function(){return this.transparent_.getValue()}}),n}),define("x_ite/Components/Shape/X3DOneSidedMaterialNode",["x_ite/Components/Shape/X3DMaterialNode","x_ite/Base/X3DConstants","standard/Math/Algorithm"],function(e,t,i){"use strict";function n(i){e.call(this,i),this.addType(t.X3DOneSidedMaterialNode),this.emissiveColor=new Float32Array(3)}return n.prototype=Object.assign(Object.create(e.prototype),{constructor:n,initialize:function(){e.prototype.initialize.call(this),this.emissiveColor_.addInterest("set_emissiveColor__",this),this.transparency_.addInterest("set_transparency__",this),this.set_emissiveColor__(),this.set_transparency__()},set_emissiveColor__:function(){const e=this.emissiveColor,t=this.emissiveColor_.getValue();e[0]=t.r,e[1]=t.g,e[2]=t.b},set_shininess__:function(){this.shininess=i.clamp(this.shininess_.getValue(),0,1)},set_transparency__:function(){const e=i.clamp(this.transparency_.getValue(),0,1);this.transparency=e,this.setTransparent(Boolean(e))}}),n}),define("x_ite/Components/Shape/UnlitMaterial",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Shape/X3DOneSidedMaterialNode","x_ite/Base/X3DConstants"],function(e,t,i,n,r){"use strict";function o(e){n.call(this,e),this.addType(r.UnlitMaterial)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"emissiveColor",new e.SFColor(1,1,1)),new t(r.inputOutput,"emissiveTexture",new e.SFNode),new t(r.inputOutput,"emissiveTextureMapping",new e.SFString),new t(r.inputOutput,"normalScale",new e.SFFloat(1)),new t(r.inputOutput,"normalTexture",new e.SFNode),new t(r.inputOutput,"normalTextureMapping",new e.SFString),new t(r.inputOutput,"transparency",new e.SFFloat)]),getTypeName:function(){return"UnlitMaterial"},getComponentName:function(){return"Shape"},getContainerField:function(){return"material"},getShader:function(e,t){return e.getUnlitShader()},setShaderUniforms:function(e,t){e.uniform3fv(t.x3d_EmissiveColor,this.emissiveColor),e.uniform1f(t.x3d_Transparency,this.transparency)}}),o}),define("x_ite/Components/Texturing/TextureProperties",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Base/X3DConstants","standard/Math/Algorithm"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),this.addType(r.TextureProperties)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"borderColor",new e.SFColorRGBA),new t(r.inputOutput,"borderWidth",new e.SFInt32),new t(r.inputOutput,"anisotropicDegree",new e.SFFloat(1)),new t(r.initializeOnly,"generateMipMaps",new e.SFBool),new t(r.inputOutput,"minificationFilter",new e.SFString("FASTEST")),new t(r.inputOutput,"magnificationFilter",new e.SFString("FASTEST")),new t(r.inputOutput,"boundaryModeS",new e.SFString("REPEAT")),new t(r.inputOutput,"boundaryModeT",new e.SFString("REPEAT")),new t(r.inputOutput,"boundaryModeR",new e.SFString("REPEAT")),new t(r.inputOutput,"textureCompression",new e.SFString("FASTEST")),new t(r.inputOutput,"texturePriority",new e.SFFloat)]),getTypeName:function(){return"TextureProperties"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"textureProperties"},getBorderWidth:function(){return o.clamp(this.borderWidth_.getValue(),0,1)},getBoundaryMode:function(){const e=new Map([["CLAMP","CLAMP_TO_EDGE"],["CLAMP_TO_EDGE","CLAMP_TO_EDGE"],["CLAMP_TO_BOUNDARY","CLAMP_TO_EDGE"],["MIRRORED_REPEAT","MIRRORED_REPEAT"],["REPEAT","REPEAT"]]);return function(t){const i=e.get(t);return void 0!==i?i:"REPEAT"}}(),getBoundaryModeS:function(){return this.getBoundaryMode(this.boundaryModeS_.getValue())},getBoundaryModeT:function(){return this.getBoundaryMode(this.boundaryModeT_.getValue())},getBoundaryModeR:function(){return this.getBoundaryMode(this.boundaryModeR_.getValue())},getMinificationFilter:function(){const e=new Map([["AVG_PIXEL_AVG_MIPMAP","LINEAR_MIPMAP_LINEAR"],["AVG_PIXEL","LINEAR"],["AVG_PIXEL_NEAREST_MIPMAP","LINEAR_MIPMAP_NEAREST"],["NEAREST_PIXEL_AVG_MIPMAP","NEAREST_MIPMAP_LINEAR"],["NEAREST_PIXEL_NEAREST_MIPMAP","NEAREST_MIPMAP_NEAREST"],["NEAREST_PIXEL","NEAREST"],["NICEST","LINEAR_MIPMAP_LINEAR"],["FASTEST","NEAREST"]]);return function(){if(this.generateMipMaps_.getValue()){const t=e.get(this.minificationFilter_.getValue());return void 0!==t?t:this.getBrowser().getDefaultTextureProperties().getMinificationFilter()}return"LINEAR"}}(),getMagnificationFilter:function(){const e=new Map([["AVG_PIXEL","LINEAR"],["NEAREST_PIXEL","NEAREST"],["NICEST","LINEAR"],["FASTEST","NEAREST"]]);return function(){const t=e.get(this.magnificationFilter_.getValue());return void 0!==t?t:this.getBrowser().getDefaultTextureProperties().getMagnificationFilter()}}(),getTextureCompression:function(){const e=new Map([["DEFAULT","RGBA"],["NICEST","RGBA"],["FASTEST","RGBA"],["LOW","RGBA"],["MEDIUM","RGBA"],["HIGH","RGBA"]]);return function(){const t=this.getBrowser(),i=t.getContext(),n=t.getExtension("WEBGL_compressed_texture_etc"),r=n?n[e.get(this.textureCompression_.getValue())]:void 0;return void 0!==r?r:i.RGBA}}()}),s}),define("x_ite/Browser/Shape/X3DShapeContext",["x_ite/Components/Shape/Appearance","x_ite/Components/Shape/PointProperties","x_ite/Components/Shape/LineProperties","x_ite/Components/Shape/FillProperties","x_ite/Components/Shape/UnlitMaterial","x_ite/Components/Texturing/ImageTexture","x_ite/Components/Texturing/TextureProperties","x_ite/Browser/Networking/urls"],function(e,t,i,n,r,o,s,a){"use strict";function u(){this[l]=[],this[c]=[]}const l=Symbol(),c=Symbol(),h=Symbol(),d=Symbol(),p=Symbol(),f=Symbol(),g=Symbol(),m=Symbol();return u.prototype={initialize:function(){},getDefaultAppearance:function(){return this[h]=new e(this.getPrivateScene()),this[h].setup(),this.getDefaultAppearance=function(){return this[h]},Object.defineProperty(this,"getDefaultAppearance",{enumerable:!1}),this[h]},getDefaultPointProperties:function(){return this[d]=new t(this.getPrivateScene()),this[d].setup(),this.getDefaultPointProperties=function(){return this[d]},Object.defineProperty(this,"getDefaultPointProperties",{enumerable:!1}),this[d]},getDefaultLineProperties:function(){return this[p]=new i(this.getPrivateScene()),this[p].applied_=!1,this[p].setup(),this.getDefaultLineProperties=function(){return this[p]},Object.defineProperty(this,"getDefaultLineProperties",{enumerable:!1}),this[p]},getDefaultFillProperties:function(){return this[f]=new n(this.getPrivateScene()),this[f].hatched_=!1,this[f].setup(),this.getDefaultFillProperties=function(){return this[f]},Object.defineProperty(this,"getDefaultFillProperties",{enumerable:!1}),this[f]},getDefaultMaterial:function(){return this[g]=new r(this.getPrivateScene()),this[g].setup(),this.getDefaultMaterial=function(){return this[g]},Object.defineProperty(this,"getDefaultMaterial",{enumerable:!1}),this[g]},
getLinetype:function(e){(e<1||e>15)&&(e=1);let t=this[l][e];return t?t:(t=this[l][e]=new o(this.getPrivateScene()),t.url_[0]=a.getLinetypeUrl(e),t.textureProperties_=this.getLineFillTextureProperties(),t.setup(),t)},getHatchStyle:function(e){(e<1||e>19)&&(e=1);let t=this[c][e];return t?t:(t=this[c][e]=new o(this.getPrivateScene()),t.url_[0]=a.getHatchingUrl(e),t.textureProperties_=this.getLineFillTextureProperties(),t.setup(),t)},getLineFillTextureProperties:function(){return this[m]=new s(this.getPrivateScene()),this[m].setup(),this.getLineFillTextureProperties=function(){return this[m]},Object.defineProperty(this,"getLineFillTextureProperties",{enumerable:!1}),this[m]}},u}),define("x_ite/Components/Shape/X3DShapeNode",["x_ite/Components/Core/X3DChildNode","x_ite/Components/Grouping/X3DBoundedObject","x_ite/Base/X3DCast","x_ite/Base/X3DConstants","x_ite/Browser/Shape/AlphaMode","standard/Math/Geometry/Box3","standard/Math/Numbers/Vector3"],function(e,t,i,n,r,o,s){"use strict";function a(i){e.call(this,i),t.call(this,i),this.addType(n.X3DShapeNode),this.bbox=new o,this.bboxSize=new s(0,0,0),this.bboxCenter=new s(0,0,0)}return a.prototype=Object.assign(Object.create(e.prototype),t.prototype,{constructor:a,initialize:function(){e.prototype.initialize.call(this),t.prototype.initialize.call(this),this.bboxSize_.addInterest("set_bbox__",this),this.bboxCenter_.addInterest("set_bbox__",this),this.appearance_.addInterest("set_apparance__",this),this.geometry_.addInterest("set_geometry__",this),this.appearance_.addInterest("set_transparent__",this),this.geometry_.addInterest("set_transparent__",this),this.set_apparance__(),this.set_geometry__(),this.set_transparent__()},getBBox:function(e,t){return t?this.castShadow_.getValue()?e.assign(this.bbox):e.set():e.assign(this.bbox)},getBBoxSize:function(){return this.bboxSize},getBBoxCenter:function(){return this.bboxCenter},getAppearance:function(){return this.apparanceNode},getGeometry:function(){return this.geometryNode},setTransparent:function(e){this.transparent=e},getTransparent:function(){return this.transparent},set_bbox__:function(){this.bboxSize_.getValue().equals(this.getDefaultBBoxSize())?this.getGeometry()?this.bbox.assign(this.getGeometry().getBBox()):this.bbox.set():this.bbox.set(this.bboxSize_.getValue(),this.bboxCenter_.getValue()),this.bboxSize.assign(this.bbox.size),this.bboxCenter.assign(this.bbox.center)},set_apparance__:function(){this.apparanceNode&&this.apparanceNode.transparent_.removeInterest("set_transparent__",this),this.apparanceNode=i(n.X3DAppearanceNode,this.appearance_),this.apparanceNode?(this.apparanceNode.alphaMode_.addInterest("set_transparent__",this),this.apparanceNode.transparent_.addInterest("set_transparent__",this)):this.apparanceNode=this.getBrowser().getDefaultAppearance()},set_geometry__:function(){this.geometryNode&&(this.geometryNode.transparent_.addInterest("set_transparent__",this),this.geometryNode.bbox_changed_.addInterest("set_bbox__",this)),this.geometryNode=i(n.X3DGeometryNode,this.geometry_),this.geometryNode&&(this.geometryNode.transparent_.addInterest("set_transparent__",this),this.geometryNode.bbox_changed_.addInterest("set_bbox__",this)),this.set_bbox__()},set_transparent__:function(){this.apparanceNode.getAlphaMode()===r.AUTO?this.transparent=this.apparanceNode.getTransparent()||this.geometryNode&&this.geometryNode.getTransparent():this.transparent=this.apparanceNode.getTransparent()}}),a}),define("standard/Math/Geometry/Line3",["standard/Math/Numbers/Vector3"],function(e){"use strict";function t(e,t){this.point=e.copy(),this.direction=t.copy()}return t.prototype={constructor:t,copy:function(){const e=Object.create(t.prototype);return e.point=this.point.copy(),e.direction=this.direction.copy(),e},assign:function(e){return this.point.assign(e.point),this.direction.assign(e.direction),this},set:function(e,t){return this.point.assign(e),this.direction.assign(t),this},setPoints:function(e,t){return this.point.assign(e),this.direction.assign(t).subtract(e).normalize(),this},multMatrixLine:function(e){return e.multMatrixVec(this.point),e.multMatrixDir(this.direction).normalize(),this},multLineMatrix:function(e){return e.multVecMatrix(this.point),e.multDirMatrix(this.direction).normalize(),this},getClosestPointToPoint:function(e,t){const i=t.assign(e).subtract(this.point),n=i.dot(this.direction);return t.assign(this.direction).multiply(n).add(this.point)},getClosestPointToLine:function(){const t=new e(0,0,0);return function(i,n){const r=this.point,o=i.point,s=this.direction,a=i.direction;let u=e.dot(s,a);return!(Math.abs(u)>=1)&&(t.assign(o).subtract(r),u=(t.dot(s)-u*t.dot(a))/(1-u*u),n.assign(s).multiply(u).add(r),!0)}}(),getPerpendicularVector:function(t){const i=e.subtract(this.point,t);return i.subtract(this.direction.copy().multiply(e.dot(i,this.direction)))},intersectsTriangle:function(){const t=new e(0,0,0),i=new e(0,0,0);return function(e,n,r,o){const s=n.subtract(e),a=r.subtract(e);t.assign(this.direction).cross(a);const u=s.dot(t);if(0===u)return!1;const l=1/u;i.assign(this.point).subtract(e);const c=i.dot(t)*l;if(c<0||c>1)return!1;const h=i.cross(s),d=this.direction.dot(h)*l;return!(d<0||c+d>1)&&(o.u=c,o.v=d,o.t=1-c-d,!0)}}(),toString:function(){return this.point+", "+this.direction}},t.Points=function(i,n){const r=Object.create(t.prototype);return r.point=i.copy(),r.direction=e.subtract(n,i).normalize(),r},t}),define("standard/Math/Algorithms/QuickSort",[],function(){"use strict";function e(e,t){this.array=e,t&&(this.compare=t)}return e.prototype={compare:function(e,t){return e<t},sort:function(e,t){t-e>1&&this.quicksort(e,t-1)},quicksort:function(e,t){let i=e,n=t;const r=this.array,o=this.compare,s=r[e+t>>>1];for(;;){for(;o(r[i],s);)++i;for(;o(s,r[n]);)--n;if(!(i<n)){i===n&&(++i,--n);break}{const e=r[i];r[i]=r[n],r[n]=e,i++,n--}}e<n&&this.quicksort(e,n),i<t&&this.quicksort(i,t)}},e}),define("x_ite/Components/Shape/Shape",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Shape/X3DShapeNode","x_ite/Rendering/TraverseType","x_ite/Base/X3DConstants","standard/Math/Algorithm","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Box3","standard/Math/Geometry/Line3","standard/Math/Algorithms/QuickSort"],function(e,t,i,n,r,o,s,a,u,l,c,h){"use strict";function d(e){n.call(this,e),this.addType(o.Shape)}return d.prototype=Object.assign(Object.create(n.prototype),{constructor:d,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOutput,"visible",new e.SFBool(!0)),new t(o.inputOutput,"castShadow",new e.SFBool(!0)),new t(o.inputOutput,"bboxDisplay",new e.SFBool),new t(o.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new t(o.initializeOnly,"bboxCenter",new e.SFVec3f),new t(o.inputOutput,"appearance",new e.SFNode),new t(o.inputOutput,"geometry",new e.SFNode)]),getTypeName:function(){return"Shape"},getComponentName:function(){return"Shape"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.transformSensors_changed_.addInterest("set_transformSensors__",this),this.set_transformSensors__()},set_geometry__:function(){n.prototype.set_geometry__.call(this),this.getGeometry()?delete this.traverse:this.traverse=Function.prototype},set_transformSensors__:function(){this.setPickableObject(this.getTransformSensors().size)},intersectsBox:function(e,t,i){return this.getGeometry().intersectsBox(e,t,i)},traverse:function(e,t){switch(e){case r.POINTER:this.pointer(t);break;case r.PICKING:this.picking(t);break;case r.COLLISION:t.addCollisionShape(this);break;case r.SHADOW:this.castShadow_.getValue()&&t.addDepthShape(this);break;case r.DISPLAY:t.addDisplayShape(this)&&this.getAppearance().traverse(e,t)}this.getGeometry().traverse(e,t)},pointer:function(){const e=new u,t=new u,i=new c(new a(0,0,0),new a(0,0,0)),n=[],r=new h(n,function(e,t){return e.point.z>t.point.z});return function(o){try{const a=this.getGeometry();if(a.getGeometryType()<2)return;const u=o.getBrowser();if(e.assign(o.getModelViewMatrix().get()),t.assign(e).inverse(),i.assign(u.getHitRay()).multLineMatrix(t),a.intersectsLine(i,o.getLocalObjects(),e,n)){for(const t of n)e.multVecMatrix(t.point);r.sort(0,n.length);const i=s.lowerBound(n,0,n.length,-o.getNavigationInfo().getNearValue(),function(e,t){return e.point.z>t});i!==n.length&&(t.multMatrixDir(n[i].normal).normalize(),u.addHit(n[i],o.getLayer(),this,e.multRight(o.getCameraSpaceMatrix().get()))),n.length=0}}catch(e){console.log(e)}}}(),picking:function(e){if(this.getTransformSensors().size){const t=e.getModelViewMatrix().get();for(const e of this.getTransformSensors())e.collect(t)}const t=e.getBrowser(),i=t.getPickSensors(),n=t.getPickingHierarchy();n.push(this);for(const n of i.at(-1))n.collect(this.getGeometry(),e.getModelViewMatrix().get(),t.getPickingHierarchy());n.pop()},depth:function(e,t,i){this.getGeometry().depth(e,t,i)},display:function(e,t){this.getGeometry().display(e,t)}}),d}),define("x_ite/Components/Rendering/X3DGeometryNode",["x_ite/Fields","x_ite/Components/Core/X3DNode","x_ite/Base/X3DConstants","x_ite/Browser/Core/Shading","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Box3","standard/Math/Geometry/Plane3","standard/Math/Geometry/Triangle3","standard/Math/Algorithm"],function(e,t,i,n,r,o,s,a,u,l,c){"use strict";function h(n){t.call(this,n),this.addType(i.X3DGeometryNode),this.addChildObjects("transparent",new e.SFBool,"bbox_changed",new e.SFTime,"rebuild",new e.SFTime),this.transparent_.setAccessType(i.outputOnly),this.bbox_changed_.setAccessType(i.outputOnly),this.rebuild_.setAccessType(i.outputOnly),this.min=new o(0,0,0),this.max=new o(0,0,0),this.bbox=new a(this.min,this.max,!0),this.solid=!0,this.geometryType=3,this.flatShading=void 0,this.colorMaterial=!1,this.attribNodes=[],this.attribs=[],this.textureCoordinateNode=this.getBrowser().getDefaultTextureCoordinate(),this.multiTexCoords=[],this.texCoords=h.createArray(),this.fogDepths=h.createArray(),this.colors=h.createArray(),this.normals=h.createArray(),this.flatNormals=h.createArray(),this.vertices=h.createArray(),this.vertexCount=0,this.depth=Function.prototype,this.display=Function.prototype,this.displayParticles=Function.prototype}const d=[new o(0,0,1),new o(0,0,-1),new o(0,1,0),new o(0,-1,0),new o(1,0,0)];return h.createArray=function(){const e=[];return e.typedArray=new Float32Array,e.assign=function(e){for(var t=0,i=e.length;t<i;++t)this[t]=e[t];this.length=i},e.getValue=function(){return this.typedArray},e.shrinkToFit=function(){this.length!==this.typedArray.length?this.typedArray=new Float32Array(this):this.typedArray.set(this)},e},h.prototype=Object.assign(Object.create(t.prototype),{constructor:h,setup:function(){t.prototype.setup.call(this),this.rebuild()},initialize:function(){t.prototype.initialize.call(this),this.isLive().addInterest("set_live__",this),this.addInterest("requestRebuild",this),this.rebuild_.addInterest("rebuild",this);const e=this.getBrowser().getContext();if(this.primitiveMode=e.TRIANGLES,this.frontFace=e.CCW,this.attribBuffers=[],this.texCoordBuffers=[],this.fogDepthBuffer=e.createBuffer(),this.colorBuffer=e.createBuffer(),this.normalBuffer=e.createBuffer(),this.vertexBuffer=e.createBuffer(),this.planes=[],this.geometryType>1)for(let e=0;e<5;++e)this.planes[e]=new u(o.Zero,o.zAxis);this.set_live__()},setGeometryType:function(e){this.geometryType=e},getGeometryType:function(){return this.geometryType},setTransparent:function(e){e!==this.transparent_.getValue()&&(this.transparent_=e)},getTransparent:function(){return this.transparent_.getValue()},getBBox:function(){return this.bbox},setBBox:function(e){if(!e.equals(this.bbox)){e.getExtents(this.min,this.max),this.bbox.assign(e);for(let e=0;e<5;++e)this.planes[e].set(e%2?this.min:this.max,d[e]);this.bbox_changed_.addEvent()}},getMin:function(){return this.min},getMax:function(){return this.max},getMatrix:function(){return s.Identity},setPrimitiveMode:function(e){this.primitiveMode=e},getPrimitiveMode:function(){return this.primitiveMode},setSolid:function(e){this.solid=e},setCCW:function(e){this.frontFace=e?this.getBrowser().getContext().CCW:this.getBrowser().getContext().CW},getAttrib:function(){return this.attribNodes},getAttribs:function(){return this.attribs},setFogDepths:function(e){this.fogDepths.assign(e)},getFogDepths:function(){return this.fogDepths},setColors:function(e){this.colors.assign(e)},getColors:function(){return this.colors},setMultiTexCoords:function(e){const t=this.multiTexCoords;for(var i=0,n=e.length;i<n;++i)t[i]=e[i];t.length=n},getMultiTexCoords:function(){return this.multiTexCoords},getTexCoords:function(){return this.texCoords},setTextureCoordinate:function(e){this.textureCoordinateNode=e?e:this.getBrowser().getDefaultTextureCoordinate()},setNormals:function(e){this.normals.assign(e)},getNormals:function(){return this.normals},setVertices:function(e){this.vertices.assign(e)},getVertices:function(){return this.vertices},buildTexCoords:function(){const e=this.texCoords;if(0===e.length){const t=this.getTexCoordParams(),i=t.min,n=t.Sindex,r=t.Tindex,o=t.Ssize,s=i[n],a=i[r],u=this.vertices.getValue();for(let t=0,i=u.length;t<i;t+=4)e.push((u[t+n]-s)/o,(u[t+r]-a)/o,0,1);e.shrinkToFit()}return e},getTexCoordParams:function(){const e={min:new o(0,0,0),Ssize:0,Sindex:0,Tindex:0};return function(){const t=this.getBBox(),i=t.size,n=i.x,r=i.y,o=i.z;return e.min.assign(t.center).subtract(i.divide(2)),n>=r&&n>=o?(e.Ssize=n,e.Sindex=0,e.Tindex=r>=o?1:2):r>=n&&r>=o?(e.Ssize=r,e.Sindex=1,e.Tindex=n>=o?0:2):(e.Ssize=o,e.Sindex=2,e.Tindex=n>=r?0:1),e}}(),refineNormals:function(e,t,i){if(0===i)return t;const n=Math.cos(c.clamp(i,0,Math.PI)),r=[];for(const i in e){const s=e[i];for(const e of s){const i=t[e],a=new o(0,0,0);for(const e of s){const r=t[e];r.dot(i)>=n&&a.add(r)}r[e]=a.normalize()}}return r},isClipped:function(e,t){return t.some(function(t){return t.isClipped(e)})},transformLine:function(e){},transformMatrix:function(e){},intersectsLine:function(){const e=new s,t={u:0,v:0,t:0},i=new o(0,0,0),n=new o(0,0,0),a=new o(0,0,0),u=new o(0,0,0);return function(s,l,c,h){try{if(this.intersectsBBox(s)){this.transformLine(s),this.transformMatrix(e.assign(c));const d=this.multiTexCoords[0].getValue(),p=this.normals.getValue(),f=this.vertices.getValue();for(let c=0,g=this.vertexCount;c<g;c+=3){const g=4*c;if(i.x=f[g],i.y=f[g+1],i.z=f[g+2],n.x=f[g+4],n.y=f[g+5],n.z=f[g+6],a.x=f[g+8],a.y=f[g+9],a.z=f[g+10],s.intersectsTriangle(i,n,a,t)){const i=t.u,n=t.v,s=t.t,a=new o(s*f[g]+i*f[g+4]+n*f[g+8],s*f[g+1]+i*f[g+5]+n*f[g+9],s*f[g+2]+i*f[g+6]+n*f[g+10]);if(this.isClipped(e.multVecMatrix(u.assign(a)),l))continue;const m=new r(s*d[g]+i*d[g+4]+n*d[g+8],s*d[g+1]+i*d[g+5]+n*d[g+9]),y=3*c,_=new o(s*p[y]+i*p[y+3]+n*p[y+6],s*p[y+1]+i*p[y+4]+n*p[y+7],s*p[y+2]+i*p[y+5]+n*p[y+8]);h.push({texCoord:m,normal:_,point:this.getMatrix().multVecMatrix(a)})}}}return h.length}catch(e){return console.log(e),!1}}}(),intersectsBBox:function(){const e=new o(0,0,0);return function(t){const i=this.planes,n=this.min,r=this.max,o=n.x,s=r.x,a=n.y,u=r.y,l=n.z,c=r.z;return!!(i[0].intersectsLine(t,e)&&e.x>=o&&e.x<=s&&e.y>=a&&e.y<=u)||(!!(i[1].intersectsLine(t,e)&&e.x>=o&&e.x<=s&&e.y>=a&&e.y<=u)||(!!(i[2].intersectsLine(t,e)&&e.x>=o&&e.x<=s&&e.z>=l&&e.z<=c)||(!!(i[3].intersectsLine(t,e)&&e.x>=o&&e.x<=s&&e.z>=l&&e.z<=c)||!!(i[4].intersectsLine(t,e)&&e.y>=a&&e.y<=u&&e.z>=l&&e.z<=c))))}}(),intersectsBox:function(){const e=new o(0,0,0),t=new o(0,0,0),i=new o(0,0,0),n=new s,r=new o(0,0,0);return function(o,s,a){try{if(o.intersectsBox(this.bbox)){o.multRight(n.assign(this.getMatrix()).inverse()),this.transformMatrix(a);const u=this.vertices.getValue();for(let n=0,l=this.vertexCount;n<l;n+=3){const l=4*n;if(e.x=u[l],e.y=u[l+1],e.z=u[l+2],t.x=u[l+4],t.y=u[l+5],t.z=u[l+6],i.x=u[l+8],i.y=u[l+9],i.z=u[l+10],o.intersectsTriangle(e,t,i)){if(s.length){if(this.isClipped(a.multVecMatrix(r.assign(e)),s))continue;if(this.isClipped(a.multVecMatrix(r.assign(t)),s))continue;if(this.isClipped(a.multVecMatrix(r.assign(i)),s))continue}return!0}}}return!1}catch(e){return console.log(e),!1}}}(),set_live__:function(){this.isLive().getValue()?this.getBrowser().getBrowserOptions().Shading_.addInterest("set_shading__",this):this.getBrowser().getBrowserOptions().Shading_.removeInterest("set_shading__",this)},set_shading__:function(){const e=new o(0,0,0),t=new o(0,0,0),i=new o(0,0,0),r=new o(0,0,0);return function(o){if(!(this.geometryType<2)){const o=this.getBrowser().getBrowserOptions().getShading()===n.FLAT;if(o!==this.flatShading){this.flatShading=o;const n=this.getBrowser().getContext();if(o&&!this.flatNormals.length){const o=this.frontFace===n.CW,s=this.flatNormals,a=this.vertices.getValue();for(let n=0,u=a.length;n<u;n+=12)l.normal(e.set(a[n],a[n+1],a[n+2]),t.set(a[n+4],a[n+5],a[n+6]),i.set(a[n+8],a[n+9],a[n+10]),r),o&&r.negate(),s.push(r.x,r.y,r.z,r.x,r.y,r.z,r.x,r.y,r.z);s.shrinkToFit()}n.bindBuffer(n.ARRAY_BUFFER,this.normalBuffer),n.bufferData(n.ARRAY_BUFFER,o?this.flatNormals.getValue():this.normals.getValue(),n.STATIC_DRAW)}}}}(),requestRebuild:function(){this.rebuild_.addEvent()},rebuild:function(){const e=new o(0,0,0);return function(){this.clear(),this.build();for(const e of this.attribs)e.shrinkToFit();for(const e of this.multiTexCoords)e.shrinkToFit();this.fogDepths.shrinkToFit(),this.colors.shrinkToFit(),this.normals.shrinkToFit(),this.vertices.shrinkToFit();const t=this.min,i=this.max,n=this.vertices.getValue();if(n.length){if(t.x===Number.POSITIVE_INFINITY)for(let r=0,o=n.length;r<o;r+=4)e.set(n[r],n[r+1],n[r+2]),t.min(e),i.max(e);this.bbox.setExtents(t,i)}else this.bbox.setExtents(t.set(0,0,0),i.set(0,0,0));if(this.bbox_changed_.addEvent(),this.geometryType>1){for(let e=0;e<5;++e)this.planes[e].set(e%2?t:i,d[e]);0===this.multiTexCoords.length&&this.multiTexCoords.push(this.buildTexCoords());const e=this.multiTexCoords.length-1;for(var r=this.multiTexCoords.length,o=this.getBrowser().getMaxTextures();r<o;++r)this.multiTexCoords[r]=this.multiTexCoords[e];this.multiTexCoords.length=o}this.set_shading__(this.getBrowser().getBrowserOptions().Shading_),this.transfer()}}(),clear:function(){this.min.set(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),this.max.set(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);const e=this.attribs;for(var t=0,i=e.length;t<i;++t)e[t].length=0;for(var t=e.length,i=this.attribNodes.length;t<i;++t)e[t]=h.createArray();e.length=i,this.flatShading=void 0,this.fogDepths.length=0,this.colors.length=0,this.multiTexCoords.length=0,this.texCoords.length=0,this.normals.length=0,this.flatNormals.length=0,this.vertices.length=0},transfer:function(){const e=this.getBrowser().getContext(),t=this.vertices.length/4;for(let t=this.attribBuffers.length,i=this.attribs.length;t<i;++t)this.attribBuffers.push(e.createBuffer());for(let t=0,i=this.attribs.length;t<i;++t)e.bindBuffer(e.ARRAY_BUFFER,this.attribBuffers[t]),e.bufferData(e.ARRAY_BUFFER,this.attribs[t].getValue(),e.STATIC_DRAW);e.bindBuffer(e.ARRAY_BUFFER,this.fogDepthBuffer),e.bufferData(e.ARRAY_BUFFER,this.fogDepths.getValue(),e.STATIC_DRAW),this.fogCoords=!!this.fogDepths.length,e.bindBuffer(e.ARRAY_BUFFER,this.colorBuffer),e.bufferData(e.ARRAY_BUFFER,this.colors.getValue(),e.STATIC_DRAW),this.colorMaterial=!!this.colors.length;for(let t=this.texCoordBuffers.length,i=this.multiTexCoords.length;t<i;++t)this.texCoordBuffers.push(e.createBuffer());for(let t=0,i=this.multiTexCoords.length;t<i;++t)e.bindBuffer(e.ARRAY_BUFFER,this.texCoordBuffers[t]),e.bufferData(e.ARRAY_BUFFER,this.multiTexCoords[t].getValue(),e.STATIC_DRAW);e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,this.vertices.getValue(),e.STATIC_DRAW),this.vertexCount=t,this.vertexCount?(delete this.depth,delete this.display,delete this.displayParticles):(this.depth=Function.prototype,this.display=Function.prototype,this.displayParticles=Function.prototype)},traverse:function(e,t){},depth:function(e,t,i){i.enableVertexAttribute(e,this.vertexBuffer),e.drawArrays(this.primitiveMode,0,this.vertexCount)},display:function(e,t){try{const i=t.shapeNode.getAppearance(),n=i.materialNode,r=i.backMaterialNode,o=i.shaderNode||n.getShader(t.browser,t.shadow);if(this.solid||!r||o.wireframe)this.displayGeometry(e,t,i,o,!0,!0);else{const n=i.shaderNode||r.getShader(t.browser,t.shadow);this.displayGeometry(e,t,i,n,!0,!1),this.displayGeometry(e,t,i,o,!1,!0)}}catch(e){console.log(e)}},displayGeometry:function(e,t,i,n,r,o){if(n.getValid()){const a=i.blendModeNode,u=this.attribNodes,l=this.attribBuffers;a&&a.enable(e),n.enable(e),n.setLocalUniforms(e,t,o);for(let t=0,i=u.length;t<i;++t)u[t].enable(e,n,l[t]);if(this.fogCoords&&n.enableFogDepthAttribute(e,this.fogDepthBuffer),this.colorMaterial&&n.enableColorAttribute(e,this.colorBuffer),n.enableTexCoordAttribute(e,this.texCoordBuffers),n.enableNormalAttribute(e,this.normalBuffer),n.enableVertexAttribute(e,this.vertexBuffer),n.wireframe)if(n.primitiveMode===e.POINTS)e.drawArrays(n.primitiveMode,0,this.vertexCount);else for(let t=0,i=this.vertexCount;t<i;t+=3)e.drawArrays(n.primitiveMode,t,3);else{const i=s.prototype.determinant3.call(t.modelViewMatrix)>0;e.frontFace(i?this.frontFace:this.frontFace===e.CCW?e.CW:e.CCW),t.transparent||r!==o?(e.enable(e.CULL_FACE),r&&!this.solid&&(e.cullFace(e.FRONT),e.drawArrays(n.primitiveMode,0,this.vertexCount)),o&&(e.cullFace(e.BACK),e.drawArrays(n.primitiveMode,0,this.vertexCount))):(this.solid?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),e.drawArrays(n.primitiveMode,0,this.vertexCount))}for(const t of u)t.disable(e,n);this.fogCoords&&n.disableFogDepthAttribute(e),this.colorMaterial&&n.disableColorAttribute(e),n.disableTexCoordAttribute(e),n.disableNormalAttribute(e),n.disable(e),a&&a.disable(e)}},displayParticlesDepth:function(e,t,i,n,r){i.enableVertexAttribute(e,this.vertexBuffer);const o=t.modelViewMatrix,a=o[12],u=o[13],l=o[14];for(let t=0;t<r;++t){const r=n[t];o[12]=a,o[13]=u,o[14]=l,s.prototype.translate.call(o,r.position),i.setParticle(e,r,o),e.drawArrays(i.primitiveMode,0,this.vertexCount)}},displayParticles:function(e,t,i,n){try{const r=t.shapeNode.getAppearance(),o=r.materialNode,s=r.backMaterialNode,a=r.shaderNode||o.getShader(t.browser,t.shadow);if(this.solid||!s||a.wireframe)this.displayParticlesGeometry(e,t,r,a,!0,!0,i,n);else{const o=r.shaderNode||s.getShader(t.browser,t.shadow);this.displayParticlesGeometry(e,t,r,o,!0,!1,i,n),this.displayParticlesGeometry(e,t,r,a,!1,!0,i,n)}}catch(e){console.log(e)}},displayParticlesGeometry:function(e,t,i,n,r,o,a,u){if(n.getValid()){const l=i.blendModeNode,c=this.attribNodes,h=this.attribBuffers;l&&l.enable(e),n.enable(e),n.setLocalUniforms(e,t,o);for(let t=0,i=c.length;t<i;++t)c[t].enable(e,n,h[t]);this.fogCoords&&n.enableFogDepthAttribute(e,this.fogDepthBuffer),this.colorMaterial&&n.enableColorAttribute(e,this.colorBuffer),n.enableTexCoordAttribute(e,this.texCoordBuffers),n.enableNormalAttribute(e,this.normalBuffer),n.enableVertexAttribute(e,this.vertexBuffer);const d=t.modelViewMatrix,p=d[12],f=d[13],g=d[14];if(n.wireframe)for(let t=0;t<u;++t){const i=a[t];if(d[12]=p,d[13]=f,d[14]=g,s.prototype.translate.call(d,i.position),n.setParticle(e,i,d),n.primitiveMode===e.POINTS)e.drawArrays(n.primitiveMode,0,this.vertexCount);else for(let t=0,i=this.vertexCount;t<i;t+=3)e.drawArrays(n.primitiveMode,t,3)}else{const i=s.prototype.determinant3.call(t.modelViewMatrix)>0;if(e.frontFace(i?this.frontFace:this.frontFace===e.CCW?e.CW:e.CCW),t.transparent||r!==o)for(let t=0;t<u;++t){const i=a[t];d[12]=p,d[13]=f,d[14]=g,s.prototype.translate.call(d,i.position),n.setParticle(e,i,d),e.enable(e.CULL_FACE),r&&!this.solid&&(e.cullFace(e.FRONT),e.drawArrays(n.primitiveMode,0,this.vertexCount)),o&&(e.cullFace(e.BACK),e.drawArrays(n.primitiveMode,0,this.vertexCount))}else{this.solid?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE);for(let t=0;t<u;++t){const i=a[t];d[12]=p,d[13]=f,d[14]=g,s.prototype.translate.call(d,i.position),n.setParticle(e,i,d),e.drawArrays(n.primitiveMode,0,this.vertexCount)}}}for(const t of c)t.disable(e,n);this.fogCoords&&n.disableFogDepthAttribute(e),this.colorMaterial&&n.disableColorAttribute(e),n.disableTexCoordAttribute(e),n.disableNormalAttribute(e),n.disable(e),l&&l.disable(e)}}}),h}),define("x_ite/Components/Rendering/X3DLineGeometryNode",["x_ite/Components/Rendering/X3DGeometryNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Matrix4"],function(e,t,i){"use strict";function n(t){e.call(this,t)}return n.prototype=Object.assign(Object.create(e.prototype),{constructor:n,getShader:function(e){return e.getLineShader()},intersectsLine:function(e,t,i,n){return!1},intersectsBox:function(e,t,i){return!1},transfer:function(){if(1===this.getGeometryType()){const e=this.getTexCoords(),t=this.getVertices();this.getMultiTexCoords().push(e);for(let i=0,n=t.length;i<n;i+=8)e.push(t[i],t[i+1],t[i+2],t[i+3],t[i],t[i+1],t[i+2],t[i+3]);e.shrinkToFit()}e.prototype.transfer.call(this)},display:function(e,t){try{const i=t.browser,n=t.shapeNode.getAppearance(),r=n.shaderNode||this.getShader(i);if(r.getValid()){const i=n.blendModeNode,o=this.attribNodes,s=this.attribBuffers;i&&i.enable(e),r.enable(e),r.setLocalUniforms(e,t);for(let t=0,i=o.length;t<i;++t)o[t].enable(e,r,s[t]);this.fogCoords&&r.enableFogDepthAttribute(e,this.fogDepthBuffer),this.colorMaterial&&r.enableColorAttribute(e,this.colorBuffer),this.getMultiTexCoords().length&&r.enableTexCoordAttribute(e,this.texCoordBuffers,!0),r.enableVertexAttribute(e,this.vertexBuffer),e.drawArrays(r.primitiveMode===e.POINTS?e.POINTS:this.primitiveMode,0,this.vertexCount);for(const t of o)t.disable(e,r);this.fogCoords&&r.disableFogDepthAttribute(e),this.colorMaterial&&r.disableColorAttribute(e),this.getMultiTexCoords().length&&r.disableTexCoordAttribute(e),r.disable(e),i&&i.disable(e)}}catch(e){console.log(e)}},displayParticles:function(e,t,n,r){try{const o=t.browser,s=t.shapeNode.getAppearance(),a=s.shaderNode||this.getShader(o);if(a.getValid()){const o=s.blendModeNode,u=this.attribNodes,l=this.attribBuffers;o&&o.enable(e),a.enable(e),a.setLocalUniforms(e,t);for(let t=0,i=u.length;t<i;++t)u[t].enable(e,a,l[t]);this.fogCoords&&a.enableFogDepthAttribute(e,this.fogDepthBuffer),this.colorMaterial&&a.enableColorAttribute(e,this.colorBuffer),this.getMultiTexCoords().length&&a.enableTexCoordAttribute(e,this.texCoordBuffers),a.enableVertexAttribute(e,this.vertexBuffer);const c=t.modelViewMatrix,h=c[12],d=c[13],p=c[14],f=a.primitiveMode===e.POINTS?e.POINTS:this.primitiveMode;for(let t=0;t<r;++t){const r=n[t];c[12]=h,c[13]=d,c[14]=p,i.prototype.translate.call(c,r.position),a.setParticle(e,r,c),e.drawArrays(f,0,this.vertexCount)}for(const t of u)t.disable(e,a);this.fogCoords&&a.disableFogDepthAttribute(e),this.colorMaterial&&a.disableColorAttribute(e),a.disableTexCoordAttribute(e),a.disable(e),o&&o.disable(e)}}catch(e){console.log(e)}}}),n}),define("x_ite/Components/Rendering/IndexedLineSet",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Rendering/X3DLineGeometryNode","x_ite/Base/X3DCast","x_ite/Base/X3DConstants"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),this.addType(o.IndexedLineSet),this.setGeometryType(1),this.fogCoordNode=null,this.colorNode=null,this.coordNode=null}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOnly,"set_colorIndex",new e.MFInt32),new t(o.inputOnly,"set_coordIndex",new e.MFInt32),new t(o.initializeOnly,"colorPerVertex",new e.SFBool(!0)),new t(o.initializeOnly,"colorIndex",new e.MFInt32),new t(o.initializeOnly,"coordIndex",new e.MFInt32),new t(o.inputOutput,"attrib",new e.MFNode),new t(o.inputOutput,"fogCoord",new e.SFNode),new t(o.inputOutput,"color",new e.SFNode),new t(o.inputOutput,"coord",new e.SFNode)]),getTypeName:function(){return"IndexedLineSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},initialize:function(){n.prototype.initialize.call(this),this.set_colorIndex_.addFieldInterest(this.colorIndex_),this.set_coordIndex_.addFieldInterest(this.coordIndex_),this.attrib_.addInterest("set_attrib__",this),this.fogCoord_.addInterest("set_fogCoord__",this),this.color_.addInterest("set_color__",this),this.coord_.addInterest("set_coord__",this),this.setPrimitiveMode(this.getBrowser().getContext().LINES),this.setSolid(!1),this.set_attrib__(),this.set_fogCoord__(),this.set_color__(),this.set_coord__()},set_attrib__:function(){const e=this.getAttrib();for(var t=0,i=e.length;t<i;++t)e[t].removeInterest("requestRebuild",this);e.length=0;for(var t=0,i=this.attrib_.length;t<i;++t){const i=r(o.X3DVertexAttributeNode,this.attrib_[t]);i&&e.push(i)}for(var t=0;t<this.attribNodes.length;++t)e[t].addInterest("requestRebuild",this)},set_fogCoord__:function(){this.fogCoordNode&&this.fogCoordNode.removeInterest("requestRebuild",this),this.fogCoordNode=r(o.FogCoordinate,this.fogCoord_),this.fogCoordNode&&this.fogCoordNode.addInterest("requestRebuild",this)},set_color__:function(){this.colorNode&&(this.colorNode.removeInterest("requestRebuild",this),this.colorNode.transparent_.removeInterest("set_transparent__",this)),this.colorNode=r(o.X3DColorNode,this.color_),this.colorNode?(this.colorNode.addInterest("requestRebuild",this),this.colorNode.transparent_.addInterest("set_transparent__",this),this.set_transparent__()):this.setTransparent(!1)},set_transparent__:function(){this.setTransparent(this.colorNode.getTransparent())},set_coord__:function(){this.coordNode&&this.coordNode.removeInterest("requestRebuild",this),this.coordNode=r(o.X3DCoordinateNode,this.coord_),this.coordNode&&this.coordNode.addInterest("requestRebuild",this)},getColorPerVertexIndex:function(e){return e<this.colorIndex_.length?this.colorIndex_[e]:this.coordIndex_[e]},getColorIndex:function(e){return e<this.colorIndex_.length?this.colorIndex_[e]:e},getPolylineIndices:function(){const e=this.coordIndex_,t=[];var i=[];if(e.length){for(var n=0,r=e.length;n<r;++n){const r=e[n];r>=0?i.push(n):(t.push(i),i=[])}e[e.length-1]>=0&&t.push(i)}return t},build:function(){if(this.coordNode&&!this.coordNode.isEmpty()){const u=this.coordIndex_,l=this.getPolylineIndices(),c=this.colorPerVertex_.getValue(),h=this.getAttrib(),d=h.length,p=this.getAttribs(),f=this.fogCoordNode,g=this.colorNode,m=this.coordNode,y=this.getFogDepths(),_=this.getColors(),x=this.getVertices();for(var e=0,t=0,i=l.length;t<i;++t){const i=l[t];if(i.length>1)for(var n=0,r=i.length-1;n<r;++n)for(var o=n,s=n+2;o<s;++o){const t=i[o],n=u[t];for(var a=0;a<d;++a)h[a].addValue(n,p[a]);f&&f.addDepth(n,y),g&&(c?g.addColor(this.getColorPerVertexIndex(t),_):g.addColor(this.getColorIndex(e),_)),m.addPoint(n,x)}++e}}}}),s}),define("x_ite/Components/Rendering/X3DGeometricPropertyNode",["x_ite/Components/Core/X3DNode","x_ite/Base/X3DConstants"],function(e,t){"use strict";function i(i){e.call(this,i),this.addType(t.X3DGeometricPropertyNode)}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i}),i}),define("x_ite/Components/Rendering/X3DColorNode",["x_ite/Fields","x_ite/Components/Rendering/X3DGeometricPropertyNode","x_ite/Base/X3DConstants"],function(e,t,i){"use strict";function n(n){t.call(this,n),this.addType(i.X3DColorNode),this.addChildObjects("transparent",new e.SFBool),this.transparent_.setAccessType(i.outputOnly)}return n.prototype=Object.assign(Object.create(t.prototype),{constructor:n,setTransparent:function(e){e!==this.transparent_.getValue()&&(this.transparent_=e)},getTransparent:function(){return this.transparent_.getValue()}}),n}),
define("x_ite/Components/Rendering/Color",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Rendering/X3DColorNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector4"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),this.addType(r.Color)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"color",new e.MFColor)]),getTypeName:function(){return"Color"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"color"},initialize:function(){n.prototype.initialize.call(this),this.color_.addInterest("set_color__",this),this.set_color__()},set_color__:function(){this.color=this.color_.getValue(),this.length=this.color_.length},addColor:function(e,t){if(e>=0&&e<this.length){const i=this.color;e*=3,t.push(i[e],i[e+1],i[e+2],1)}else if(this.length){const i=this.color;e=3*(this.length-1),t.push(i[e],i[e+1],i[e+2],1)}else t.push(1,1,1,1)},addColors:function(e,t){if(this.length){const r=this.color;for(var i=0,n=3*this.length;i<n;i+=3)e.push(r[i],r[i+1],r[i+2],1);var i=3*(this.length-1);const o=r[i],s=r[i+1],a=r[i+2];for(var i=n,n=3*t;i<n;i+=3)e.push(o,s,a,1)}else for(var i=0;i<t;++i)e.push(1,1,1,1)},getVectors:function(e){const t=this.color_;for(var i=0,n=t.length;i<n;++i){var r=t[i];e[i]=new o(r.r,r.g,r.b,1)}return e.length=n,e}}),s}),define("x_ite/Components/Rendering/X3DCoordinateNode",["x_ite/Components/Rendering/X3DGeometricPropertyNode","x_ite/Base/X3DConstants","standard/Math/Geometry/Triangle3","standard/Math/Numbers/Vector3"],function(e,t,i,n){"use strict";function r(i){e.call(this,i),this.addType(t.X3DCoordinateNode)}return r.prototype=Object.assign(Object.create(e.prototype),{constructor:r,initialize:function(){e.prototype.initialize.call(this),this.point_.addInterest("set_point__",this),this.set_point__()},set_point__:function(){this.point=this.point_.getValue(),this.length=this.point_.length},isEmpty:function(){return 0===this.length},getSize:function(){return this.length},set1Point:function(e,t){this.point_[e]=t},get1Point:function(e,t){if(e<this.length){const i=this.point;return e*=3,t.set(i[e],i[e+1],i[e+2])}return t.set(0,0,0)},addPoint:function(e,t){if(e<this.length){const i=this.point;e*=3,t.push(i[e],i[e+1],i[e+2],1)}else t.push(0,0,0,1)},addPoints:function(e,t){const i=this.point;for(var n=0,r=3*this.length;n<r;n+=3)e.push(i[n],i[n+1],i[n+2],1);for(var n=r,r=3*t;n<r;n+=3)e.push(0,0,0,1)},getNormal:function(){const e=new n(0,0,0),t=new n(0,0,0),r=new n(0,0,0);return function(o,s,a){const u=this.length;return o<u&&s<u&&a<u?i.normal(this.get1Point(o,e),this.get1Point(s,t),this.get1Point(a,r),new n(0,0,0)):new n(0,0,0)}}(),getQuadNormal:function(){const e=new n(0,0,0),t=new n(0,0,0),r=new n(0,0,0),o=new n(0,0,0);return function(s,a,u,l){const c=this.length;return s<c&&a<c&&u<c&&l<c?i.quadNormal(this.get1Point(s,e),this.get1Point(a,t),this.get1Point(u,r),this.get1Point(l,o),new n(0,0,0)):new n(0,0,0)}}()}),r}),define("x_ite/Components/Rendering/Coordinate",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Rendering/X3DCoordinateNode","x_ite/Base/X3DConstants"],function(e,t,i,n,r){"use strict";function o(e){n.call(this,e),this.addType(r.Coordinate),this.point_.setUnit("length")}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"point",new e.MFVec3f)]),getTypeName:function(){return"Coordinate"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"coord"}}),o}),define("x_ite/Browser/Grouping/X3DGroupingContext",["x_ite/Fields","x_ite/Components/Shape/Shape","x_ite/Components/Rendering/IndexedLineSet","x_ite/Components/Rendering/Color","x_ite/Components/Rendering/Coordinate"],function(e,t,i,n,r){"use strict";function o(){}const s=Symbol();return o.prototype={initialize:function(){},getBBoxNode:function(){const o=new t(this.getPrivateScene()),a=new i(this.getPrivateScene()),u=new n(this.getPrivateScene()),l=new r(this.getPrivateScene());return o.geometry_=a,a.coordIndex_=new e.MFFloat(0,1,2,3,0,-1,4,5,6,7,4,-1,0,4,-1,1,5,-1,2,6,-1,3,7,-1),a.color_=u,a.coord_=l,u.color_=new e.MFColor(new e.SFColor(1,1,1)),l.point_=new e.MFVec3f(new e.SFVec3f(.5,.5,.5),new e.SFVec3f(-.5,.5,.5),new e.SFVec3f(-.5,-.5,.5),new e.SFVec3f(.5,-.5,.5),new e.SFVec3f(.5,.5,-.5),new e.SFVec3f(-.5,.5,-.5),new e.SFVec3f(-.5,-.5,-.5),new e.SFVec3f(.5,-.5,-.5)),l.setup(),u.setup(),a.setup(),o.setup(),this[s]=o,this.getBBoxNode=function(){return this[s]},Object.defineProperty(this,"getBBoxNode",{enumerable:!1}),o}},o}),define("x_ite/Components/Rendering/X3DComposedGeometryNode",["x_ite/Components/Rendering/X3DGeometryNode","x_ite/Base/X3DCast","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,i,n){"use strict";function r(t){e.call(this,t),this.addType(i.X3DComposedGeometryNode),this.fogCoordNode=null,this.colorNode=null,this.texCoordNode=null,this.normalNode=null,this.coordNode=null}return r.prototype=Object.assign(Object.create(e.prototype),{constructor:r,initialize:function(){e.prototype.initialize.call(this),this.attrib_.addInterest("set_attrib__",this),this.fogCoord_.addInterest("set_fogCoord__",this),this.color_.addInterest("set_color__",this),this.texCoord_.addInterest("set_texCoord__",this),this.normal_.addInterest("set_normal__",this),this.coord_.addInterest("set_coord__",this),this.set_attrib__(),this.set_fogCoord__(),this.set_color__(),this.set_texCoord__(),this.set_normal__(),this.set_coord__()},getFogCoord:function(){return this.fogCoordNode},getColor:function(){return this.colorNode},getTexCoord:function(){return this.texCoordNode},getNormal:function(){return this.normalNode},getCoord:function(){return this.coordNode},set_attrib__:function(){for(var e=this.getAttrib(),n=0,r=e.length;n<r;++n)e[n].removeInterest("requestRebuild",this);e.length=0;for(var n=0,r=this.attrib_.length;n<r;++n){var o=t(i.X3DVertexAttributeNode,this.attrib_[n]);o&&e.push(o)}for(var n=0;n<this.attribNodes.length;++n)e[n].addInterest("requestRebuild",this)},set_fogCoord__:function(){this.fogCoordNode&&this.fogCoordNode.removeInterest("requestRebuild",this),this.fogCoordNode=t(i.FogCoordinate,this.fogCoord_),this.fogCoordNode&&this.fogCoordNode.addInterest("requestRebuild",this)},set_color__:function(){this.colorNode&&(this.colorNode.removeInterest("requestRebuild",this),this.colorNode.transparent_.removeInterest("set_transparent__",this)),this.colorNode=t(i.X3DColorNode,this.color_),this.colorNode?(this.colorNode.addInterest("requestRebuild",this),this.colorNode.transparent_.addInterest("set_transparent__",this),this.set_transparent__()):this.setTransparent(!1)},set_transparent__:function(){this.setTransparent(this.colorNode.getTransparent())},set_texCoord__:function(){this.texCoordNode&&this.texCoordNode.removeInterest("requestRebuild",this),this.texCoordNode=t(i.X3DTextureCoordinateNode,this.texCoord_),this.texCoordNode&&this.texCoordNode.addInterest("requestRebuild",this),this.setTextureCoordinate(this.texCoordNode)},set_normal__:function(){this.normalNode&&this.normalNode.removeInterest("requestRebuild",this),this.normalNode=t(i.X3DNormalNode,this.normal_),this.normalNode&&this.normalNode.addInterest("requestRebuild",this)},set_coord__:function(){this.coordNode&&this.coordNode.removeInterest("requestRebuild",this),this.coordNode=t(i.X3DCoordinateNode,this.coord_),this.coordNode&&this.coordNode.addInterest("requestRebuild",this)},getPolygonIndex:function(e){return e},getTriangleIndex:function(e){return e},build:function(e,t,i,n){if(this.coordNode&&!this.coordNode.isEmpty()){t-=t%e,n-=n%i;const a=this.colorPerVertex_.getValue(),u=this.normalPerVertex_.getValue(),l=this.getAttrib(),c=l.length,h=this.getAttribs(),d=this.getFogCoord(),p=this.getColor(),f=this.getTexCoord(),g=this.getNormal(),m=this.getCoord(),y=this.getFogDepths(),_=this.getColors(),x=this.getMultiTexCoords(),w=this.getNormals(),b=this.getVertices();var r=0;f&&f.init(x);for(var o=0;o<n;++o){r=Math.floor(o/i);const e=this.getPolygonIndex(this.getTriangleIndex(o));for(var s=0;s<c;++s)l[s].addValue(e,h[s]);d&&d.addDepth(e,y),p&&(a?p.addColor(e,_):p.addColor(r,_)),f&&f.addTexCoord(e,x),g&&(u?g.addVector(e,w):g.addVector(r,w)),m.addPoint(e,b)}this.getNormal()||this.buildNormals(e,t,n),this.setSolid(this.solid_.getValue()),this.setCCW(this.ccw_.getValue())}},buildNormals:function(e,t,i){const n=this.createNormals(e,t),r=this.getNormals();for(var o=0;o<i;++o){const e=n[this.getTriangleIndex(o)];r.push(e.x,e.y,e.z)}},createNormals:function(e,t){const i=this.createFaceNormals(e,t);if(this.normalPerVertex_.getValue()){const e=[];for(var n=0;n<t;++n){const t=this.getPolygonIndex(n);var r=e[t];r||(r=e[t]=[]),r.push(n)}return this.refineNormals(e,i,Math.PI)}return i},createFaceNormals:function(e,t){const i=!this.ccw_.getValue(),n=this.coordNode,r=[];for(var o=0;o<t;o+=e){const t=this.getPolygonNormal(o,e,n);i&&t.negate();for(var s=0;s<e;++s)r.push(t)}return r},getPolygonNormal:function(){var e=new n(0,0,0),t=new n(0,0,0);return function(i,r,o){const s=new n(0,0,0);o.get1Point(this.getPolygonIndex(i),t);for(var a=0;a<r;++a){const n=e;e=t,t=n,o.get1Point(this.getPolygonIndex(i+(a+1)%r),t),s.x+=(e.y-t.y)*(e.z+t.z),s.y+=(e.z-t.z)*(e.x+t.x),s.z+=(e.x-t.x)*(e.y+t.y)}return s.normalize()}}()}),r}),define("x_ite/Components/Geometry3D/IndexedFaceSet",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Rendering/X3DComposedGeometryNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Triangle3"],function(e,t,i,n,r,o,s,a){"use strict";function u(e){n.call(this,e),this.addType(r.IndexedFaceSet),this.creaseAngle_.setUnit("angle")}return u.prototype=Object.assign(Object.create(n.prototype),{constructor:u,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_colorIndex",new e.MFInt32),new t(r.inputOnly,"set_texCoordIndex",new e.MFInt32),new t(r.inputOnly,"set_normalIndex",new e.MFInt32),new t(r.inputOnly,"set_coordIndex",new e.MFInt32),new t(r.initializeOnly,"solid",new e.SFBool(!0)),new t(r.initializeOnly,"ccw",new e.SFBool(!0)),new t(r.initializeOnly,"convex",new e.SFBool(!0)),new t(r.initializeOnly,"creaseAngle",new e.SFFloat),new t(r.initializeOnly,"colorPerVertex",new e.SFBool(!0)),new t(r.initializeOnly,"normalPerVertex",new e.SFBool(!0)),new t(r.initializeOnly,"colorIndex",new e.MFInt32),new t(r.initializeOnly,"texCoordIndex",new e.MFInt32),new t(r.initializeOnly,"normalIndex",new e.MFInt32),new t(r.initializeOnly,"coordIndex",new e.MFInt32),new t(r.inputOutput,"attrib",new e.MFNode),new t(r.inputOutput,"fogCoord",new e.SFNode),new t(r.inputOutput,"color",new e.SFNode),new t(r.inputOutput,"texCoord",new e.SFNode),new t(r.inputOutput,"normal",new e.SFNode),new t(r.inputOutput,"coord",new e.SFNode)]),getTypeName:function(){return"IndexedFaceSet"},getComponentName:function(){return"Geometry3D"},getContainerField:function(){return"geometry"},initialize:function(){n.prototype.initialize.call(this),this.set_colorIndex_.addFieldInterest(this.colorIndex_),this.set_texCoordIndex_.addFieldInterest(this.texCoordIndex_),this.set_normalIndex_.addFieldInterest(this.normalIndex_),this.set_coordIndex_.addFieldInterest(this.coordIndex_)},getTexCoordPerVertexIndex:function(e){return e<this.texCoordIndex_.length?this.texCoordIndex_[e]:this.coordIndex_[e]},getColorPerVertexIndex:function(e){return e<this.colorIndex_.length?this.colorIndex_[e]:this.coordIndex_[e]},getColorIndex:function(e){return e<this.colorIndex_.length?this.colorIndex_[e]:e},getNormalPerVertexIndex:function(e){return e<this.normalIndex_.length?this.normalIndex_[e]:this.coordIndex_[e]},getNormalIndex:function(e){return e<this.normalIndex_.length?this.normalIndex_[e]:e},build:function(){var e=this.triangulate();if(0!==e.length){var t=this.colorPerVertex_.getValue(),i=this.normalPerVertex_.getValue(),n=this.coordIndex_.getValue(),r=this.getAttrib(),o=r.length,s=this.getAttribs(),a=this.getFogCoord(),u=this.getColor(),l=this.getTexCoord(),c=this.getNormal(),h=this.getCoord(),d=this.getFogDepths(),p=this.getColors(),f=this.getMultiTexCoords(),g=this.getNormals(),m=this.getVertices();l&&l.init(f);for(var y=0,_=e.length;y<_;++y){for(var x=e[y],w=x.triangles,b=x.face,v=0,S=w.length;v<S;++v){for(var T=w[v],C=n[T],F=0;F<o;++F)r[F].addValue(C,s[F]);a&&a.addDepth(C,d),u&&(t?u.addColor(this.getColorPerVertexIndex(T),p):u.addColor(this.getColorIndex(b),p)),l&&l.addTexCoord(this.getTexCoordPerVertexIndex(T),f),c&&(i?c.addVector(this.getNormalPerVertexIndex(T),g):c.addVector(this.getNormalIndex(b),g)),h.addPoint(C,m)}++b}this.getNormal()||this.buildNormals(e),this.setSolid(this.solid_.getValue()),this.setCCW(this.ccw_.getValue())}},triangulate:function(){var e=this.convex_.getValue(),t=this.coordIndex_.length,i=[];if(!this.getCoord())return i;if(t){this.coordIndex_[t-1]>-1&&this.coordIndex_.push(-1);for(var n=this.coordIndex_.getValue(),t=this.coordIndex_.length,r=[],o=0,s=0;s<t;++s){if(n[s]>-1)r.push(s);else{if(r.length)switch(r.length){case 0:case 1:case 2:r.length=0;break;case 3:i.push({vertices:r,triangles:r,face:o}),r=[];break;default:var a=[],u={vertices:r,triangles:a,face:o};e?this.triangulateConvexPolygon(r,a):this.triangulatePolygon(r,a),a.length<3?r.length=0:(i.push(u),r=[])}++o}}}return i},triangulatePolygon:function(){var e=[];return function(t,i){for(var n=this.coordIndex_.getValue(),r=this.getCoord(),s=0,u=t.length;s<u;++s){var l=e[s],c=t[s];l||(l=e[s]=new o(0,0,0)),l.index=c,r.get1Point(n[c],l)}e.length=u,a.triangulatePolygon(e,i);for(var c=0,u=i.length;c<u;++c)i[c]=i[c].index}}(),triangulateConvexPolygon:function(e,t){for(var i=1,n=e.length-1;i<n;++i)t.push(e[0],e[i],e[i+1])},buildNormals:function(e){for(var t=this.createNormals(e),i=this.getNormals(),n=0,r=e.length;n<r;++n)for(var o=e[n].triangles,s=0,a=o.length;s<a;++s){var u=t[o[s]];i.push(u.x,u.y,u.z)}},createNormals:function(){var e=[],t=[];return function(i){var n=!this.ccw_.getValue(),r=this.coordIndex_.getValue(),o=this.getCoord(),s=null;e.length=0,t.length=0;for(var a=0,u=i.length;a<u;++a){var l=i[a],c=l.vertices,h=c.length;switch(h){case 3:s=o.getNormal(r[c[0]],r[c[1]],r[c[2]]);break;case 4:s=o.getQuadNormal(r[c[0]],r[c[1]],r[c[2]],r[c[3]]);break;default:s=this.getPolygonNormal(c,r,o)}for(var d=0;d<h;++d){var p=c[d],f=r[p],g=t[f];g||(g=t[f]=[]),g.push(p)}n&&s.negate();for(var d=0;d<h;++d)e[c[d]]=s}return this.refineNormals(t,e,this.creaseAngle_.getValue())}}(),getPolygonNormal:function(){var e=new o(0,0,0),t=new o(0,0,0);return function(i,n,r){var s=new o(0,0,0);r.get1Point(n[i[0]],t);for(var a=0,u=i.length;a<u;++a){var l=e;e=t,t=l,r.get1Point(n[i[(a+1)%u]],t),s.x+=(e.y-t.y)*(e.z+t.z),s.y+=(e.z-t.z)*(e.x+t.x),s.z+=(e.x-t.x)*(e.y+t.y)}return s.normalize()}}()}),u}),define("x_ite/Components/Texturing/X3DTextureCoordinateNode",["x_ite/Components/Rendering/X3DGeometricPropertyNode","x_ite/Base/X3DConstants"],function(e,t){"use strict";function i(i){e.call(this,i),this.addType(t.X3DTextureCoordinateNode)}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i,setShaderUniformsToChannel:function(e,t,i){e.uniform1i(t.x3d_TextureCoordinateGeneratorMode[i],0)}}),i}),define("x_ite/Components/Texturing/X3DSingleTextureCoordinateNode",["x_ite/Components/Texturing/X3DTextureCoordinateNode","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Base/X3DConstants"],function(e,t,i){"use strict";function n(n){e.call(this,n),this.addType(i.X3DSingleTextureCoordinateNode),this.texCoordArray=t.createArray()}return n.prototype=Object.assign(Object.create(e.prototype),{constructor:n,init:function(e){this.texCoordArray.length=0,e.push(this.texCoordArray)},addTexCoord:function(e,t){this.addTexCoordToChannel(e,t[0])},setShaderUniforms:function(e,t){for(let i=0,n=t.x3d_MaxTextures;i<n;++i)this.setShaderUniformsToChannel(e,t,i)}}),n}),define("x_ite/Components/Texturing/TextureCoordinate",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Texturing/X3DSingleTextureCoordinateNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector4"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),this.addType(r.TextureCoordinate)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"mapping",new e.SFString),new t(r.inputOutput,"point",new e.MFVec2f)]),getTypeName:function(){return"TextureCoordinate"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"texCoord"},initialize:function(){n.prototype.initialize.call(this),this.point_.addInterest("set_point__",this),this.set_point__()},set_point__:function(){this.point=this.point_.getValue(),this.length=this.point_.length},isEmpty:function(){return 0===this.length},getSize:function(){return this.length},get1Point:function(e,t){if(e>=0&&e<this.length){const i=this.point;return e*=2,t.set(i[e],i[e+1],0,1)}if(e>=0&&this.length){const i=this.point;return e%=this.length,e*=2,t.set(i[e],i[e+1],0,1)}return t.set(0,0,0,1)},addTexCoordToChannel:function(e,t){if(e>=0&&e<this.length){const i=this.point;e*=2,t.push(i[e],i[e+1],0,1)}else if(e>=0&&this.length){const i=this.point;e%=this.length,e*=2,t.push(i[e],i[e+1],0,1)}else t.push(0,0,0,1)},getTexCoord:function(e){const t=this.point;for(let i=0,n=0,r=this.length;i<r;++i,n+=2)e[i]=new o(t[n],t[n+1],0,1);return e.length=this.length,e}}),s}),define("x_ite/Browser/Geometry3D/BoxOptions",["x_ite/Fields","x_ite/Base/X3DBaseNode","x_ite/Components/Geometry3D/IndexedFaceSet","x_ite/Components/Rendering/Coordinate","x_ite/Components/Texturing/TextureCoordinate"],function(e,t,i,n,r){"use strict";function o(e){t.call(this,e)}return o.prototype=Object.assign(Object.create(t.prototype),{constructor:o,getTypeName:function(){return"BoxOptions"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"boxOptions"},initialize:function(){t.prototype.initialize.call(this)},getGeometry:function(){if(this.geometry)return this.geometry;this.geometry=new i(this.getExecutionContext()),this.geometry.texCoord_=new r(this.getExecutionContext()),this.geometry.coord_=new n(this.getExecutionContext());const t=this.geometry,o=this.geometry.texCoord_.getValue(),s=this.geometry.coord_.getValue();return t.texCoordIndex_=new e.MFInt32(0,1,2,3,-1,0,1,2,3,-1,0,1,2,3,-1,0,1,2,3,-1,0,1,2,3,-1,0,1,2,3,-1),t.coordIndex_=new e.MFInt32(0,1,2,3,-1,5,4,7,6,-1,1,5,6,2,-1,4,0,3,7,-1,4,5,1,0,-1,3,2,6,7,-1),o.point_=new e.MFVec2f(new e.SFVec2f(1,1),new e.SFVec2f(0,1),new e.SFVec2f(0,0),new e.SFVec2f(1,0)),s.point_=new e.MFVec3f(new e.SFVec3f(1,1,1),new e.SFVec3f(-1,1,1),new e.SFVec3f(-1,-1,1),new e.SFVec3f(1,-1,1),new e.SFVec3f(1,1,-1),new e.SFVec3f(-1,1,-1),new e.SFVec3f(-1,-1,-1),new e.SFVec3f(1,-1,-1)),o.setup(),s.setup(),t.setup(),this.geometry}}),o}),define("x_ite/Browser/Geometry3D/ConeOptions",["x_ite/Fields","x_ite/Base/X3DBaseNode"],function(e,t){"use strict";function i(i){t.call(this,i),this.addChildObjects("xDimension",new e.SFInt32(20),"yDimension",new e.SFInt32(1))}return i.prototype=Object.assign(Object.create(t.prototype),{constructor:i,getTypeName:function(){return"ConeOptions"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"coneOptions"}}),i}),define("x_ite/Browser/Geometry3D/CylinderOptions",["x_ite/Fields","x_ite/Base/X3DBaseNode"],function(e,t){"use strict";function i(i){t.call(this,i),this.addChildObjects("xDimension",new e.SFInt32(20),"yDimension",new e.SFInt32(1))}return i.prototype=Object.assign(Object.create(t.prototype),{constructor:i,getTypeName:function(){return"CylinderOptions"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"cylinderOptions"}}),i}),define("x_ite/Browser/Geometry3D/QuadSphereOptions",["x_ite/Fields","x_ite/Base/X3DBaseNode","x_ite/Components/Geometry3D/IndexedFaceSet","x_ite/Components/Rendering/Coordinate","x_ite/Components/Texturing/TextureCoordinate","standard/Math/Numbers/Complex","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3"],function(e,t,i,n,r,o,s,a){"use strict";function u(i){t.call(this,i),this.addChildObjects("xDimension",new e.SFInt32(32),"yDimension",new e.SFInt32(15))}return u.prototype=Object.assign(Object.create(t.prototype),{constructor:u,getTypeName:function(){return"QuadSphereOptions"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"quadSphereOptions"},initialize:function(){t.prototype.initialize.call(this),this.addInterest("eventsProcessed",this)},getGeometry:function(){return this.geometry||this.eventsProcessed(),this.geometry},createTexCoordIndex:function(){const e=this.xDimension_.getValue()+1,t=this.yDimension_.getValue(),i=this.geometry.texCoordIndex_;for(let t=0,n=e-1;t<n;++t)i.push(t),i.push(t+e-1),i.push(t+e),i.push(-1);for(let n=e-1,r=0,o=t-3;r<o;++r,++n)for(let t=0,r=e-1;t<r;++t,++n)i.push(n),i.push(n+e),i.push(n+e+1),i.push(n+1),i.push(-1);let n=(t-2)*e-1;for(let t=0,r=e-1;t<r;++t,++n)i.push(n+e),i.push(n+1),i.push(n),i.push(-1)},createTexCoord:function(){const e=this.xDimension_.getValue()+1,t=this.yDimension_.getValue(),i=this.geometry.texCoord_.getValue().point_,n=-.5/(e-1);for(let t=1;t<e;++t){const r=t/(e-1)+n;i.push(new s(r,1))}for(let n=1,r=t-1;n<r;++n){const r=1-n/(t-1);for(let t=0;t<e;++t){const n=t/(e-1);i.push(new s(n,r))}}for(let t=1;t<e;++t){const r=t/(e-1)+n;i.push(new s(r,0))}},createCoordIndex:function(){const e=this.xDimension_.getValue()+1,t=this.yDimension_.getValue(),i=this.geometry.coordIndex_;let n=1;for(const t=e-1;n<t;++n)i.push(0),i.push(n),i.push(n+1),i.push(-1);i.push(0),i.push(n),i.push(1),i.push(-1);let r=1;for(let n=0,o=t-3;n<o;++n,++r){for(let t=0,n=e-2;t<n;++t,++r)i.push(r),i.push(r+e-1),i.push(r+e),i.push(r+1),i.push(-1);i.push(r),i.push(r+e-1),i.push(r+1),i.push(r-e+2),i.push(-1)}const o=r+e-1;for(let t=0,n=e-2;t<n;++t,++r)i.push(o),i.push(r+1),i.push(r),i.push(-1);i.push(o),i.push(o-e+1),i.push(r),i.push(-1)},createPoints:function(){const e=this.xDimension_.getValue()+1,t=this.yDimension_.getValue(),i=this.geometry.coord_.getValue().point_;i.push(new a(0,1,0));for(let n=1,r=t-1;n<r;++n){const t=o.Polar(1,-Math.PI*n/r);for(let n=0,r=e-1;n<r;++n){const e=o.Polar(t.imag,2*Math.PI*n/r);i.push(new a(e.imag,t.real,e.real))}}i.push(new a(0,-1,0))},eventsProcessed:function(){this.geometry=new i(this.getExecutionContext()),this.geometry.texCoord_=new r(this.getExecutionContext()),this.geometry.coord_=new n(this.getExecutionContext()),this.createTexCoordIndex(),this.createTexCoord(),this.createCoordIndex(),this.createPoints();const e=this.geometry,t=this.geometry.texCoord_.getValue(),o=this.geometry.coord_.getValue();e.creaseAngle_=Math.PI,t.setup(),o.setup(),e.setup()}}),u}),define("x_ite/Browser/Geometry3D/X3DGeometry3DContext",["x_ite/Browser/Geometry3D/BoxOptions","x_ite/Browser/Geometry3D/ConeOptions","x_ite/Browser/Geometry3D/CylinderOptions","x_ite/Browser/Geometry3D/QuadSphereOptions"],function(e,t,i,n){"use strict";function r(){}function o(e,t){const i=new t(this.getPrivateScene());return i.setup(),this[e]=function(){return i},Object.defineProperty(this,e,{enumerable:!1}),i}return r.prototype={initialize:function(){},getBoxOptions:function(){return o.call(this,"getBoxOptions",e)},getConeOptions:function(){return o.call(this,"getConeOptions",t)},getCylinderOptions:function(){return o.call(this,"getCylinderOptions",i)},getSphereOptions:function(){return o.call(this,"getSphereOptions",n)}},r}),define("x_ite/Browser/PointingDeviceSensor/PointingDevice",["jquery","x_ite/Base/X3DBaseNode"],function(e,t){"use strict";function i(e){t.call(this,e),this.cursor="DEFAULT",this.isOver=!1,this.motionTime=0}return i.prototype=Object.assign(Object.create(t.prototype),{constructor:i,getTypeName:function(){return"PointingDevice"},initialize:function(){const e=this.getBrowser().getSurface();e.bind("mousedown.PointingDevice"+this.getId(),this.mousedown.bind(this)),e.bind("mouseup.PointingDevice"+this.getId(),this.mouseup.bind(this)),e.bind("dblclick.PointingDevice"+this.getId(),this.dblclick.bind(this)),e.bind("mousemove.PointingDevice"+this.getId(),this.mousemove.bind(this)),e.bind("mouseout.PointingDevice"+this.getId(),this.onmouseout.bind(this)),e.bind("touchstart.PointingDevice"+this.getId(),this.touchstart.bind(this)),e.bind("touchend.PointingDevice"+this.getId(),this.touchend.bind(this))},mousewheel:function(e){},mousedown:function(t){const i=this.getBrowser();if(i.getElement().focus(),!i.getContextMenu().getActive()&&!(i.getShiftKey()&&i.getControlKey()||0!==t.button)){const n=i.getSurface(),r=n.offset(),o=t.pageX-r.left-parseFloat(n.css("borderLeftWidth")),s=n.innerHeight()-(t.pageY-r.top-parseFloat(n.css("borderTopWidth")));n.unbind("mousemove.PointingDevice"+this.getId()),e(document).bind("mouseup.PointingDevice"+this.getId(),this.mouseup.bind(this)),e(document).bind("mousemove.PointingDevice"+this.getId(),this.mousemove.bind(this)),e(document).bind("touchend.PointingDevice"+this.getId(),this.touchend.bind(this)),e(document).bind("touchmove.PointingDevice"+this.getId(),this.touchmove.bind(this)),i.buttonPressEvent(o,s)&&(t.preventDefault(),t.stopImmediatePropagation(),i.setCursor("HAND"),i.finished().addInterest("onverifymotion",this,o,s))}},mouseup:function(t){if(t.preventDefault(),0===t.button){const i=this.getBrowser(),n=i.getSurface(),r=n.offset(),o=t.pageX-r.left-parseFloat(n.css("borderLeftWidth")),s=n.innerHeight()-(t.pageY-r.top-parseFloat(n.css("borderTopWidth")));e(document).unbind(".PointingDevice"+this.getId()),n.bind("mousemove.PointingDevice"+this.getId(),this.mousemove.bind(this)),i.buttonReleaseEvent(),i.setCursor(this.isOver?"HAND":"DEFAULT"),i.finished().addInterest("onverifymotion",this,o,s),i.addBrowserEvent(),this.cursor="DEFAULT"}},dblclick:function(e){this.isOver&&e.stopImmediatePropagation()},mousemove:function(e){e.preventDefault();const t=this.getBrowser();if(this.motionTime!==t.getCurrentTime()){this.motionTime=t.getCurrentTime();const i=t.getSurface(),n=i.offset(),r=e.pageX-n.left-parseFloat(i.css("borderLeftWidth")),o=i.innerHeight()-(e.pageY-n.top-parseFloat(i.css("borderTopWidth")));this.onmotion(r,o)}},touchstart:function(e){const t=e.originalEvent.touches;switch(t.length){case 1:e.button=0,e.pageX=t[0].pageX,e.pageY=t[0].pageY,this.mousedown(e);break;case 2:this.touchend(e)}},touchend:function(e){e.button=0,this.mouseup(e)},touchmove:function(e){const t=e.originalEvent.touches;switch(t.length){case 1:e.button=0,e.pageX=t[0].pageX,e.pageY=t[0].pageY,this.mousemove(e)}},onmotion:function(e,t){const i=this.getBrowser();i.motionNotifyEvent(e,t)?this.isOver||(this.isOver=!0,this.cursor=i.getCursor(),i.setCursor("HAND")):this.isOver&&(this.isOver=!1,i.setCursor(this.cursor))},onmouseout:function(e){this.getBrowser().leaveNotifyEvent()},onverifymotion:function(e,t,i){this.getBrowser().finished().removeInterest("onverifymotion",this),this.onmotion(t,i)}}),i}),define("x_ite/Browser/PointingDeviceSensor/X3DPointingDeviceSensorContext",["x_ite/Browser/PointingDeviceSensor/PointingDevice","x_ite/Rendering/TraverseType","standard/Math/Geometry/Line3","standard/Math/Geometry/ViewVolume","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4","standard/Math/Algorithms/MergeSort","standard/Math/Algorithm"],function(e,t,i,n,r,o,s,a,u){"use strict";function l(){this[c]=new e(this),this[d]=new r(0,0),this[p]=new i(o.Zero,o.Zero),this[f]=[],this[g]=[new Map],this[m]=null,this[y]=new Map,this[_]=new Map,this[x]=new a(this[f],function(e,t){return e.intersection.point.z<t.intersection.point.z}),this[b]=new a(this[f],function(e,t){return e.layerNumber<t.layerNumber}),this[v]=0}const c=Symbol(),h=Symbol(),d=Symbol(),p=Symbol(),f=Symbol(),g=Symbol(),m=Symbol(),y=Symbol(),_=Symbol(),x=Symbol(),w=Symbol(),b=Symbol(),v=Symbol(),S=new i(o.Zero,o.Zero);return l.prototype={initialize:function(){this.getElement().attr("tabindex",this.getElement().attr("tabindex")||0),this.setCursor("DEFAULT"),this[c].setup()},setCursor:function(e){const t=this.getSurface();switch(this[h]=e,e){case"HAND":t.css("cursor","pointer");break;case"MOVE":t.css("cursor","move");break;case"CROSSHAIR":t.css("cursor","crosshair");break;default:this.loadCount_.getValue()?t.css("cursor","wait"):this[c]&&this[c].isOver?t.css("cursor","pointer"):t.css("cursor","default")}},getCursor:function(){return this[h]},isPointerInRectangle:function(e){return this[d].x>e.x&&this[d].x<e.x+e.z&&this[d].y>e.y&&this[d].y<e.y+e.w},setLayerNumber:function(e){this[w]=e},getSelectedLayer:function(){return this[m]},setHitRay:function(e,t){try{n.unProjectRay(this[d].x,this[d].y,s.Identity,e,t,this[p])}catch(e){this[p].set(o.Zero,o.Zero)}},getHitRay:function(){return this[p]},getSensors:function(){return this[g]},addHit:function(e,t,i,n){this[f].push({pointer:this[d],hitRay:this[p].copy(),intersection:e,sensors:this[g].at(-1),layer:t,layerNumber:this[w],shape:i,modelViewMatrix:n.copy()})},getHits:function(){return this[f]},getNearestHit:function(){return this[f].at(-1)},buttonPressEvent:function(e,t){if(this.touch(e,t),0===this[f].length)return!1;const i=this.getNearestHit();this[m]=i.layer,this[_]=i.sensors;for(const e of this[_].values())e.set_active__(!0,i);return i.sensors.size},buttonReleaseEvent:function(){this[m]=null;for(const e of this[_].values())e.set_active__(!1,null);return this[_]=new Map,!0},motionNotifyEvent:function(e,t){return this.touch(e,t),this.motion(),this[f].length&&this[f].at(-1).sensors.size},leaveNotifyEvent:function(){},touch:function(e,i){if(this.getViewer().isActive_.getValue())return void(this[v]=0);const n=performance.now();this[d].set(e,i),this[f].length=0,this.getWorld().traverse(t.POINTER,null),this[x].sort(0,this[f].length),this[b].sort(0,this[f].length),this.addBrowserEvent(),this[v]=performance.now()-n},motion:function(){if(this[f].length)var e=this[f].at(-1);else{const e=this[m]?this[p]:S;var e={pointer:this[d],modelViewMatrix:new s,hitRay:e,intersection:null,sensors:new Map,shape:null,layer:null,layerNumber:0}}if(this[f].length)var t=u.map_difference(this[y],e.sensors,new Map);else var t=new Map(this[y]);for(const i of t.values())i.set_over__(!1,e);if(this[f].length){this[y]=e.sensors;for(const t of this[y].values())t.set_over__(!0,e)}else this[y]=new Map;for(const t of this[_].values())t.set_motion__(e)},getPointerTime:function(){return this[v]}},l}),define("x_ite/Browser/Navigation/X3DViewer",["x_ite/Base/X3DBaseNode","x_ite/Components/Navigation/OrthoViewpoint","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Box3","standard/Math/Geometry/ViewVolume"],function(e,t,i,n,r,o){"use strict";function s(t){e.call(this,t)}function a(e,t,i){const n=Math.hypot(t,i);if(n<e*Math.sqrt(.5))return Math.sqrt(e*e-n*n);const r=e/Math.sqrt(2);return r*r/n}return s.prototype=Object.assign(Object.create(e.prototype),{constructor:s,getTypeName:function(){return"X3DViewer"},initialize:function(){},initShaders:function(){},getActiveLayer:function(){return this.getBrowser().getActiveLayer()},getViewport:function(){return this.getBrowser().getActiveLayer().getViewport()},getNavigationInfo:function(){return this.getBrowser().getActiveLayer().getNavigationInfo()},getActiveViewpoint:function(){return this.getBrowser().getActiveLayer().getViewpoint()},getStraightenHorizon:function(){return this.getBrowser().getBrowserOption("StraightenHorizon")},getButton:function(e){return 0===e&&this.getBrowser().getAltKey()?1:e},getPointOnCenterPlane:function(){const e=new i(0,0,-1),r=new i(0,0,0),s=new i(0,0,0)
;return function(i,a,u){try{const l=this.getNavigationInfo(),c=this.getActiveViewpoint(),h=this.getViewport().getRectangle(this.getBrowser()),d=c.getProjectionMatrixWithLimits(l.getNearValue(),l.getFarValue(c),h);if(o.unProjectPoint(i,this.getBrowser().getViewport()[3]-a,.9,n.Identity,d,h,s),c instanceof t)return u.set(s.x,s.y,-this.getDistanceToCenter(r).abs());const p=s.normalize();return u.assign(p).multiply(this.getDistanceToCenter(r).abs()/p.dot(e))}catch(e){return console.log(e),u.set(0,0,0)}}}(),getDistanceToCenter:function(e,t){const i=this.getActiveViewpoint();return e.assign(i.getPosition()).add(t||i.positionOffset_.getValue()).subtract(i.getUserCenterOfRotation())},trackballProjectToSphere:function(e,t,i){const n=this.getViewport().getRectangle(this.getBrowser());return t=this.getBrowser().getViewport()[3]-t,e=(e-n[0])/n[2]-.5,t=(t-n[1])/n[3]-.5,i.set(e,t,a(.5,e,t))},lookAtPoint:function(e,t,i){if(this.touch(e,t)){const e=this.getBrowser().getNearestHit();this.getActiveViewpoint().lookAtPoint(this.getActiveLayer(),e.intersection.point,.381966,i)}},lookAtBBox:function(){const e=new r;return function(t,i,n){if(this.touch(t,i)){const t=this.getBrowser().getNearestHit();t.shape.getBBox(e).multRight(t.modelViewMatrix),this.getActiveViewpoint().lookAtBBox(this.getActiveLayer(),e,.381966,n)}}}(),touch:function(e,t){return this.getBrowser().touch(e,t),this.getBrowser().getHits().length},dispose:function(){}}),s}),define("x_ite/Components/Followers/X3DFollowerNode",["x_ite/Components/Core/X3DChildNode","x_ite/Base/X3DConstants"],function(e,t){"use strict";function i(i){e.call(this,i),this.addType(t.X3DFollowerNode),this.buffer=[],this.a=this.getVector(),this.vector=this.getVector()}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i,initialize:function(){e.prototype.initialize.call(this),this.isLive().addInterest("set_live__",this)},getBuffer:function(){return this.buffer},getValue:function(){return this.set_value_.getValue()},getDestination:function(){return this.set_destination_.getValue()},getInitialValue:function(){return this.initialValue_.getValue()},getInitialDestination:function(){return this.initialDestination_.getValue()},setValue:function(e){this.value_changed_=e},setDestination:function(e){this.destination.assign(e)},duplicate:function(e){return e.copy()},assign:function(e,t,i){e[t].assign(i)},equals:function(e,t,i){return this.a.assign(e).subtract(t).abs()<i},interpolate:function(e,t,i){return this.vector.assign(e).lerp(t,i)},set_live__:function(){(this.isLive().getValue()||this.getPrivate())&&this.isActive_.getValue()?(this.getBrowser().prepareEvents().addInterest("prepareEvents",this),this.getBrowser().addBrowserEvent()):this.getBrowser().prepareEvents().removeInterest("prepareEvents",this)},set_active:function(e){e!==this.isActive_.getValue()&&(this.isActive_=e,this.set_live__())}}),i}),define("x_ite/Components/Followers/X3DChaserNode",["x_ite/Components/Followers/X3DFollowerNode","x_ite/Base/X3DConstants"],function(e,t){"use strict";function i(i){e.call(this,i),this.addType(t.X3DChaserNode),this.destination=null,this.previousValue=null,this.bufferEndTime=0,this.stepTime=0,this.deltaOut=this.getVector()}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i,initialize:function(){e.prototype.initialize.call(this),this.set_value_.addInterest("set_value__",this),this.set_destination_.addInterest("set_destination__",this),this.duration_.addInterest("set_duration__",this),this.set_duration__();var t=this.getBuffer(),i=this.getInitialValue(),n=this.getInitialDestination(),r=this.getNumBuffers();this.bufferEndTime=this.getBrowser().getCurrentTime(),this.previousValue=this.duplicate(i),t[0]=this.duplicate(n);for(var o=1;o<r;++o)t[o]=this.duplicate(i);this.destination=this.duplicate(n),this.equals(n,i,this.getTolerance())?this.setValue(n):this.set_active(!0)},getNumBuffers:function(){return 60},getTolerance:function(){return 1e-8},getArray:function(){return this.getVector()},setPreviousValue:function(e){this.previousValue.assign(e)},step:function(e,t,i){this.output.add(this.deltaOut.assign(e).subtract(t).multiply(i))},stepResponse:function(e){if(e<=0)return 0;var t=this.duration_.getValue();return e>=t?1:.5-.5*Math.cos(e/t*Math.PI)},set_value__:function(){this.isActive_.getValue()||(this.bufferEndTime=this.getBrowser().getCurrentTime());for(var e=this.getBuffer(),t=this.getValue(),i=0,n=e.length;i<n;++i)this.assign(e,i,t);this.setPreviousValue(t),this.setValue(t),this.set_active(!0)},set_destination__:function(){this.setDestination(this.getDestination()),this.isActive_.getValue()||(this.bufferEndTime=this.getBrowser().getCurrentTime()),this.set_active(!0)},set_duration__:function(){this.stepTime=this.duration_.getValue()/this.getNumBuffers()},prepareEvents:function(){try{var e=this.getBuffer(),t=e.length,i=this.updateBuffer();this.output=this.interpolate(this.previousValue,e[t-1],this.stepResponse((t-1+i)*this.stepTime));for(var n=t-2;n>=0;--n)this.step(e[n],e[n+1],this.stepResponse((n+i)*this.stepTime));this.setValue(this.output),this.equals(this.output,this.destination,this.getTolerance())&&this.set_active(!1)}catch(e){}},updateBuffer:function(){var e=this.getBuffer(),t=e.length,i=(this.getBrowser().getCurrentTime()-this.bufferEndTime)/this.stepTime;if(i>=1){var n=Math.floor(i);if(i-=n,n<t){this.setPreviousValue(e[t-n]);for(var r=t-1;r>=n;--r)this.assign(e,r,e[r-n]);for(var r=0;r<n;++r)try{var o=r/n;this.assign(e,r,this.interpolate(this.destination,e[n],o))}catch(e){}}else{this.setPreviousValue(n==t?e[0]:this.destination);for(var r=0;r<t;++r)this.assign(e,r,this.destination)}this.bufferEndTime+=n*this.stepTime}return i}}),i}),define("x_ite/Components/Followers/PositionChaser",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Followers/X3DChaserNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),this.addType(r.PositionChaser)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_value",new e.SFVec3f),new t(r.inputOnly,"set_destination",new e.SFVec3f),new t(r.initializeOnly,"initialValue",new e.SFVec3f),new t(r.initializeOnly,"initialDestination",new e.SFVec3f),new t(r.initializeOnly,"duration",new e.SFTime(1)),new t(r.outputOnly,"isActive",new e.SFBool),new t(r.outputOnly,"value_changed",new e.SFVec3f)]),getTypeName:function(){return"PositionChaser"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new o(0,0,0)}}),s}),define("x_ite/Components/Followers/OrientationChaser",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Followers/X3DChaserNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Rotation4"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),this.addType(r.OrientationChaser),this.set_value_.setUnit("angle"),this.set_destination_.setUnit("angle"),this.initialValue_.setUnit("angle"),this.initialDestination_.setUnit("angle"),this.value_changed_.setUnit("angle")}var a=new o(0,0,1,0),u=new o(0,0,1,0);return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_value",new e.SFRotation),new t(r.inputOnly,"set_destination",new e.SFRotation),new t(r.initializeOnly,"initialValue",new e.SFRotation),new t(r.initializeOnly,"initialDestination",new e.SFRotation),new t(r.initializeOnly,"duration",new e.SFTime(1)),new t(r.outputOnly,"isActive",new e.SFBool),new t(r.outputOnly,"value_changed",new e.SFRotation)]),getTypeName:function(){return"OrientationChaser"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new o(0,0,1,0)},equals:function(e,t,i){return a.assign(e).inverse().multRight(t),Math.abs(a.angle)<i},interpolate:function(e,t,i){return u.assign(e).slerp(t,i)},step:function(e,t,i){this.deltaOut.assign(t).inverse().multRight(e).multLeft(this.output),this.output.slerp(this.deltaOut,i)}}),s}),function(e){"function"==typeof define&&define.amd?define("jquery-mousewheel/jquery.mousewheel",["jquery"],e):e(jQuery)}(function(e){function t(t){var s=t||window.event,a=u.call(arguments,1),l=0,h=0,d=0,p=0,f=0,g=0;if(t=e.event.fix(s),t.type="mousewheel","detail"in s&&(d=s.detail*-1),"wheelDelta"in s&&(d=s.wheelDelta),"wheelDeltaY"in s&&(d=s.wheelDeltaY),"wheelDeltaX"in s&&(h=s.wheelDeltaX*-1),"axis"in s&&s.axis===s.HORIZONTAL_AXIS&&(h=d*-1,d=0),l=0===d?h:d,"deltaY"in s&&(d=s.deltaY*-1,l=d),"deltaX"in s&&(h=s.deltaX,0===d&&(l=h*-1)),0!==d||0!==h){if(1===s.deltaMode){var m=e.data(this,"mousewheel-line-height");l*=m,d*=m,h*=m}else if(2===s.deltaMode){var y=e.data(this,"mousewheel-page-height");l*=y,d*=y,h*=y}if(p=Math.max(Math.abs(d),Math.abs(h)),(!o||p<o)&&(o=p,n(s,p)&&(o/=40)),n(s,p)&&(l/=40,h/=40,d/=40),l=Math[l>=1?"floor":"ceil"](l/o),h=Math[h>=1?"floor":"ceil"](h/o),d=Math[d>=1?"floor":"ceil"](d/o),c.settings.normalizeOffset&&this.getBoundingClientRect){var _=this.getBoundingClientRect();f=t.clientX-_.left,g=t.clientY-_.top}return t.deltaX=h,t.deltaY=d,t.deltaFactor=o,t.offsetX=f,t.offsetY=g,t.deltaMode=0,a.unshift(t,l,h,d),r&&clearTimeout(r),r=setTimeout(i,200),(e.event.dispatch||e.event.handle).apply(this,a)}}function i(){o=null}function n(e,t){return c.settings.adjustOldDeltas&&"mousewheel"===e.type&&t%120==0}var r,o,s=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],a="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],u=Array.prototype.slice;if(e.event.fixHooks)for(var l=s.length;l;)e.event.fixHooks[s[--l]]=e.event.mouseHooks;var c=e.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var i=a.length;i;)this.addEventListener(a[--i],t,!1);else this.onmousewheel=t;e.data(this,"mousewheel-line-height",c.getLineHeight(this)),e.data(this,"mousewheel-page-height",c.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var i=a.length;i;)this.removeEventListener(a[--i],t,!1);else this.onmousewheel=null;e.removeData(this,"mousewheel-line-height"),e.removeData(this,"mousewheel-page-height")},getLineHeight:function(t){var i=e(t),n=i["offsetParent"in e.fn?"offsetParent":"parent"]();return n.length||(n=e("body")),parseInt(n.css("fontSize"),10)||parseInt(i.css("fontSize"),10)||16},getPageHeight:function(t){return e(t).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}),define("jquery-mousewheel",["jquery-mousewheel/jquery.mousewheel"],function(e){return e}),define("x_ite/Browser/Navigation/ExamineViewer",["jquery","x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Base/X3DConstants","x_ite/Browser/Navigation/X3DViewer","x_ite/Components/Followers/PositionChaser","x_ite/Components/Followers/OrientationChaser","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","jquery-mousewheel"],function(e,t,i,n,r,o,s,a,u,l,c){"use strict";function h(e){o.call(this,e),this.button=-1,this.orientationOffset=new c(0,0,1,0),this.fromVector=new l(0,0,0),this.toVector=new l(0,0,0),this.fromPoint=new l(0,0,0),this.toPoint=new l(0,0,0),this.rotation=new c(0,0,1,0),this.pressTime=0,this.motionTime=0,this.touchMode=0,this.touch1=new u(0,0),this.touch2=new u(0,0),this.tapStart=0,this.dblTapInterval=.4,this.initialPositionOffset=new l(0,0,0),this.initialOrientationOffset=new c(0,0,1,0),this.positionChaser=new s(e),this.centerOfRotationChaser=new s(e),this.rotationChaser=new a(e)}var d=/Mac OS X/i.test(navigator.userAgent),p=d?1/120:.05;return h.prototype=Object.assign(Object.create(o.prototype),{constructor:h,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new n([new i(r.outputOnly,"isActive",new t.SFBool)]),initialize:function(){o.prototype.initialize.call(this);var e=this.getBrowser(),t=e.getSurface();this.getNavigationInfo().transitionStart_.addInterest("disconnect",this),e.activeViewpoint_.addInterest("set_activeViewpoint__",this),t.bind("mousedown.ExamineViewer",this.mousedown.bind(this)),t.bind("mouseup.ExamineViewer",this.mouseup.bind(this)),t.bind("dblclick.ExamineViewer",this.dblclick.bind(this)),t.bind("mousewheel.ExamineViewer",this.mousewheel.bind(this)),t.bind("touchstart.ExamineViewer",this.touchstart.bind(this)),t.bind("touchend.ExamineViewer",this.touchend.bind(this)),this.positionChaser.duration_=.2,this.positionChaser.setPrivate(!0),this.positionChaser.setup(),this.centerOfRotationChaser.duration_=.2,this.centerOfRotationChaser.setPrivate(!0),this.centerOfRotationChaser.setup(),this.rotationChaser.duration_=.2,this.rotationChaser.setPrivate(!0),this.rotationChaser.setup(),this.set_activeViewpoint__()},set_activeViewpoint__:function(){if(this.getStraightenHorizon()){var e=this.getActiveViewpoint();e&&(e.orientationOffset_=this.getOrientationOffset(c.Identity,e.orientationOffset_.getValue(),!1))}this.disconnect()},mousedown:function(t){if(!(this.getBrowser().getContextMenu().getActive()||this.button>=0)){this.pressTime=performance.now();var i=this.getBrowser().getSurface().offset(),n=t.pageX-i.left,r=t.pageY-i.top;switch(this.getButton(t.button)){case 0:t.preventDefault(),t.stopImmediatePropagation(),this.button=t.button,e(document).bind("mouseup.ExamineViewer"+this.getId(),this.mouseup.bind(this)),e(document).bind("mousemove.ExamineViewer"+this.getId(),this.mousemove.bind(this)),e(document).bind("touchend.ExamineViewer"+this.getId(),this.touchend.bind(this)),e(document).bind("touchmove.ExamineViewer"+this.getId(),this.touchmove.bind(this)),this.disconnect(),this.getActiveViewpoint().transitionStop(),this.getBrowser().setCursor("MOVE"),this.trackballProjectToSphere(n,r,this.fromVector),this.rotation.assign(c.Identity),this.motionTime=0,this.isActive_=!0;break;case 1:t.preventDefault(),t.stopImmediatePropagation(),this.button=t.button,e(document).bind("mouseup.ExamineViewer"+this.getId(),this.mouseup.bind(this)),e(document).bind("mousemove.ExamineViewer"+this.getId(),this.mousemove.bind(this)),e(document).bind("touchend.ExamineViewer"+this.getId(),this.touchend.bind(this)),e(document).bind("touchmove.ExamineViewer"+this.getId(),this.touchmove.bind(this)),this.disconnect(),this.getActiveViewpoint().transitionStop(),this.getBrowser().setCursor("MOVE"),this.getPointOnCenterPlane(n,r,this.fromPoint),this.isActive_=!0}}},mouseup:function(t){if(t.button===this.button)switch(this.button=-1,e(document).unbind(".ExamineViewer"+this.getId()),this.getButton(t.button)){case 0:t.preventDefault(),t.stopImmediatePropagation();var i=this.getActiveViewpoint();this.getBrowser().setCursor("DEFAULT"),Math.abs(this.rotation.angle)>.003&&performance.now()-this.motionTime<40&&(this.getStraightenHorizon()&&"GeoViewpoint"!==i.getTypeName()&&(this.rotation=this.getHorizonRotation(this.rotation)),this.addSpinning(this.rotation)),this.isActive_=!1;break;case 1:t.preventDefault(),t.stopImmediatePropagation(),this.getBrowser().setCursor("DEFAULT"),this.isActive_=!1}},dblclick:function(e){e.preventDefault(),e.stopImmediatePropagation();const t=this.getBrowser().getSurface(),i=t.offset(),n=e.pageX-i.left-parseFloat(t.css("borderLeftWidth")),r=t.innerHeight()-(e.pageY-i.top-parseFloat(t.css("borderTopWidth")));this.disconnect(),this.lookAtBBox(n,r,this.getStraightenHorizon())},mousemove:function(){var e=new l(0,0,0);return function(t){var i=this.getBrowser().getSurface().offset(),n=t.pageX-i.left,r=t.pageY-i.top;switch(this.getButton(this.button)){case 0:t.preventDefault(),t.stopImmediatePropagation();var o=this.trackballProjectToSphere(n,r,this.toVector);if(this.rotation.setFromToVec(o,this.fromVector),Math.abs(this.rotation.angle)<.003&&performance.now()-this.pressTime<50)return;this.addRotate(this.rotation),this.fromVector.assign(o),this.motionTime=performance.now();break;case 1:t.preventDefault(),t.stopImmediatePropagation();var s=this.getActiveViewpoint(),a=this.getPointOnCenterPlane(n,r,this.toPoint),u=s.getUserOrientation().multVecRot(e.assign(this.fromPoint).subtract(a));this.addMove(u,u),this.fromPoint.assign(a)}}}(),mousewheel:function(){var e=new l(0,0,0),t=new l(0,0,0);return function(i){i.preventDefault(),i.stopImmediatePropagation();var n=this.getBrowser(),r=this.getActiveViewpoint();n.prepareEvents().removeInterest("spin",this),r.transitionStop(),e=this.getDistanceToCenter(e).multiply(i.zoomFactor||p),t=r.getUserOrientation().multVecRot(t.set(0,0,e.abs())),i.deltaY>0?this.addMove(t.negate(),l.Zero):i.deltaY<0&&this.addMove(t,l.Zero)}}(),touchstart:function(e){var t=e.originalEvent.touches;switch(t.length){case 1:e.button=0,e.pageX=t[0].pageX,e.pageY=t[0].pageY,this.mousedown(e),this.touch1.set(t[0].pageX,t[0].pageY);break;case 2:this.touchend(e),e.button=1,e.pageX=(t[0].pageX+t[1].pageX)/2,e.pageY=(t[0].pageY+t[1].pageY)/2,this.mousedown(e),this.touch1.set(t[0].pageX,t[0].pageY),this.touch2.set(t[1].pageX,t[1].pageY);break;case 3:this.touchend(e)}},touchend:function(e){switch(this.button){case 0:e.button=0,this.mouseup(e),this.getBrowser().getCurrentTime()-this.tapStart<this.dblTapInterval&&(e.button=0,e.pageX=this.touch1.x,e.pageY=this.touch1.y,this.dblclick(e)),this.tapStart=this.getBrowser().getCurrentTime();break;case 1:this.touchMode=0,e.button=1,this.mouseup(e)}},touchmove:function(){var t=new u(0,0),i=new u(0,0);return function(n){var r=n.originalEvent.touches;switch(r.length){case 1:n.pageX=r[0].pageX,n.pageY=r[0].pageY,this.mousemove(n);break;case 2:t.set(r[0].pageX,r[0].pageY).subtract(this.touch1).normalize(),i.set(r[1].pageX,r[1].pageY).subtract(this.touch2).normalize();var o=t.dot(i)>.7,s=t.dot(i)<-.7;switch(this.touchMode||(o?1:s?2:0)){case 1:this.touchMode=1,n.pageX=(r[0].pageX+r[1].pageX)/2,n.pageY=(r[0].pageY+r[1].pageY)/2,this.mousemove(n);break;case 2:this.touchMode=2;var a=this.touch1.distance(this.touch2);this.touch1.set(r[0].pageX,r[0].pageY),this.touch2.set(r[1].pageX,r[1].pageY);var u=this.touch1.distance(this.touch2),l=u-a;n.deltaY=l,n.zoomFactor=Math.abs(l)/e(window).width(),this.mousewheel(n)}this.touch1.set(r[0].pageX,r[0].pageY),this.touch2.set(r[1].pageX,r[1].pageY)}}}(),spin:function(){var e=this.getActiveViewpoint();this.orientationOffset.assign(e.orientationOffset_.getValue()),e.orientationOffset_=this.getOrientationOffset(this.rotation,this.orientationOffset),e.positionOffset_=this.getPositionOffset(e.positionOffset_.getValue(),this.orientationOffset,e.orientationOffset_.getValue())},set_positionOffset__:function(e){this.getActiveViewpoint().positionOffset_=e},set_centerOfRotationOffset__:function(e){this.getActiveViewpoint().centerOfRotationOffset_=e},set_rotation__:function(e){var t=this.getActiveViewpoint();t.orientationOffset_=this.getOrientationOffset(e.getValue(),this.initialOrientationOffset,!1),t.positionOffset_=this.getPositionOffset(this.initialPositionOffset,this.initialOrientationOffset,t.orientationOffset_.getValue())},addRotate:function(){var e=new c;return function(t){var i=this.getActiveViewpoint();if(this.rotationChaser.isActive_.getValue()&&this.rotationChaser.value_changed_.hasInterest("set_rotation__",this))try{e.assign(this.rotationChaser.set_destination_.getValue()).multLeft(t),this.getOrientationOffset(e,this.initialOrientationOffset,!0),this.rotationChaser.set_destination_=e}catch(i){t=this.getHorizonRotation(t),e.assign(this.rotationChaser.set_destination_.getValue()).multLeft(t),this.rotationChaser.set_destination_=e}else try{this.initialOrientationOffset.assign(i.orientationOffset_.getValue()),this.initialPositionOffset.assign(i.positionOffset_.getValue()),this.getOrientationOffset(t,this.initialOrientationOffset,!0),this.rotationChaser.set_value_=c.Identity,this.rotationChaser.set_destination_=t}catch(e){this.rotationChaser.set_value_=c.Identity,this.rotationChaser.set_destination_=this.getHorizonRotation(t)}this.disconnect(),this.rotationChaser.value_changed_.addInterest("set_rotation__",this)}}(),addSpinning:function(){var e=new c(0,0,1,0);return function(t){try{this.disconnect(),this.getBrowser().prepareEvents().addInterest("spin",this),this.rotation.assign(e.assign(c.Identity).slerp(t,.6))}catch(e){console.log(e)}}}(),addMove:function(){var e=new l(0,0,0),t=new l(0,0,0);return function(i,n){var r=this.getActiveViewpoint();this.positionChaser.isActive_.getValue()&&this.positionChaser.value_changed_.hasInterest("set_positionOffset__",this)?(e.assign(this.positionChaser.set_destination_.getValue()).add(i),this.positionChaser.set_destination_=e):(e.assign(r.positionOffset_.getValue()).add(i),this.positionChaser.set_value_=r.positionOffset_,this.positionChaser.set_destination_=e),this.centerOfRotationChaser.isActive_.getValue()&&this.centerOfRotationChaser.value_changed_.hasInterest("set_centerOfRotationOffset__",this)?(t.assign(this.centerOfRotationChaser.set_destination_.getValue()).add(n),this.centerOfRotationChaser.set_destination_=t):(t.assign(r.centerOfRotationOffset_.getValue()).add(n),this.centerOfRotationChaser.set_value_=r.centerOfRotationOffset_,this.centerOfRotationChaser.set_destination_=t),this.disconnect(),this.positionChaser.value_changed_.addInterest("set_positionOffset__",this),this.centerOfRotationChaser.value_changed_.addInterest("set_centerOfRotationOffset__",this)}}(),getPositionOffset:function(){var e=new l(0,0,0),t=new l(0,0,0),i=new c(0,0,1,0);return function(n,r,o){return this.getDistanceToCenter(e,n),i.assign(r).inverse().multRight(o).multVecRot(t.assign(e)).subtract(e).add(n)}}(),getOrientationOffset:function(){var e=new c(0,0,1,0),t=new c(0,0,1,0),i=new l(0,0,0);return function(n,r,o){var s=this.getActiveViewpoint(),a=this.getStraightenHorizon();e.assign(n).multRight(s.getOrientation()).multRight(r),a&&"GeoViewpoint"!==s.getTypeName()&&s.straightenHorizon(e);var u=t.assign(s.getOrientation()).inverse().multRight(e);if(a&&"GeoViewpoint"!==s.getTypeName()){if(!o)return u;var c=e.multVecRot(i.assign(l.zAxis));if(Math.abs(s.getUpVector().dot(c))<.97)return u;throw new Error("Critical angle")}return u}}(),getHorizonRotation:function(){var e=new l(0,0,0);return function(t){var i=this.getActiveViewpoint(),n=t.multVecRot(e.assign(l.zAxis)).normalize(),r=l.cross(i.getUpVector(),n).normalize(),o=l.cross(r,i.getUpVector()).normalize();return new c(l.zAxis,o)}}(),disconnect:function(){var e=this.getBrowser();this.positionChaser.value_changed_.removeInterest("set_positionOffset__",this),this.centerOfRotationChaser.value_changed_.removeInterest("set_centerOfRotationOffset__",this),this.rotationChaser.value_changed_.removeInterest("set_rotation__",this),e.prepareEvents().removeInterest("spin",this)},dispose:function(){var t=this.getBrowser();this.disconnect(),t.activeViewpoint_.removeInterest("set_activeViewpoint__",this),t.getSurface().unbind(".ExamineViewer"),e(document).unbind(".ExamineViewer"+this.getId())}}),h}),define("x_ite/Browser/Navigation/X3DFlyViewer",["jquery","x_ite/Browser/Navigation/X3DViewer","x_ite/Components/Followers/OrientationChaser","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Camera","jquery-mousewheel"],function(e,t,i,n,r,o,s){"use strict";function a(e){t.call(this,e);var r=this.getBrowser().getContext();this.button=-1,this.fromVector=new n(0,0,0),this.toVector=new n(0,0,0),this.direction=new n(0,0,0),this.startTime=0,this.lineBuffer=r.createBuffer(),this.lineCount=2,this.lineVertices=new Array(4*this.lineCount),this.lineArray=new Float32Array(this.lineVertices),this.event=null,this.lookAround=!1,this.orientationChaser=new i(e)}var u=/Mac OS X/i.test(navigator.userAgent),l=u?Math.PI/512:Math.PI/32;return a.prototype=Object.assign(Object.create(t.prototype),{constructor:a,initialize:function(){t.prototype.initialize.call(this);const e=this.getBrowser(),i=e.getSurface();i.bind("mousedown.X3DFlyViewer",this.mousedown.bind(this)),i.bind("mouseup.X3DFlyViewer",this.mouseup.bind(this)),i.bind("mousewheel.X3DFlyViewer",this.mousewheel.bind(this)),i.bind("touchstart.X3DFlyViewer",this.touchstart.bind(this)),i.bind("touchend.X3DFlyViewer",this.touchend.bind(this)),e.controlKey_.addInterest("set_controlKey__",this),this.orientationChaser.duration_=.3,this.orientationChaser.setPrivate(!0),this.orientationChaser.setup(),this.initShaders()},initShaders:function(){const e=this.getBrowser();e.getBrowserOption("Rubberband")&&(e.getLineShader(),e.getDepthShader())},addCollision:function(){},removeCollision:function(){},set_controlKey__:function(){this.event&&0===this.event.button&&(this.button=-1,this.mousedown(this.event))},mousedown:function(t){if(!(this.getBrowser().getContextMenu().getActive()||this.button>=0)){this.event=t;var i=this.getBrowser().getSurface().offset(),n=t.pageX-i.left,r=t.pageY-i.top;switch(this.getButton(t.button)){case 0:t.preventDefault(),t.stopImmediatePropagation(),this.button=t.button,e(document).bind("mouseup.X3DFlyViewer"+this.getId(),this.mouseup.bind(this)),e(document).bind("mousemove.X3DFlyViewer"+this.getId(),this.mousemove.bind(this)),e(document).bind("touchend.X3DFlyViewer"+this.getId(),this.touchend.bind(this)),e(document).bind("touchmove.X3DFlyViewer"+this.getId(),this.touchmove.bind(this)),this.disconnect(),this.getActiveViewpoint().transitionStop(),this.getBrowser().setCursor("MOVE"),this.addCollision(),this.getBrowser().getControlKey()||this.lookAround?this.trackballProjectToSphere(n,r,this.fromVector):(this.fromVector.set(n,0,r),this.toVector.assign(this.fromVector),this.getFlyDirection(this.fromVector,this.toVector,this.direction),this.addFly(),this.getBrowser().getBrowserOption("Rubberband")&&this.getBrowser().finished().addInterest("display",this,0)),this.isActive_=!0;break;case 1:t.preventDefault(),t.stopImmediatePropagation(),this.button=t.button,e(document).bind("mouseup.X3DFlyViewer"+this.getId(),this.mouseup.bind(this)),e(document).bind("mousemove.X3DFlyViewer"+this.getId(),this.mousemove.bind(this)),this.disconnect(),this.getActiveViewpoint().transitionStop(),this.getBrowser().setCursor("MOVE"),this.addCollision(),this.fromVector.set(n,-r,0),this.toVector.assign(this.fromVector),this.direction.set(0,0,0),this.addPan(),this.getBrowser().getBrowserOption("Rubberband")&&this.getBrowser().finished().addInterest("display",this,1),this.isActive_=!0}}},mouseup:function(t){t.preventDefault(),t.button===this.button&&(this.event=null,this.button=-1,e(document).unbind(".X3DFlyViewer"+this.getId()),this.disconnect(),this.getBrowser().setCursor("DEFAULT"),this.removeCollision(),this.isActive_=!1)},mousemove:function(e){this.getBrowser().addBrowserEvent(),this.event=e;var t=this.getBrowser().getSurface().offset(),i=e.pageX-t.left,n=e.pageY-t.top;switch(this.getButton(this.button)){case 0:if(this.getBrowser().getControlKey()||this.lookAround){e.preventDefault(),e.stopImmediatePropagation();var r=this.trackballProjectToSphere(i,n,this.toVector);this.addRotation(this.fromVector,r),this.fromVector.assign(r);break}this.toVector.set(i,0,n),this.getFlyDirection(this.fromVector,this.toVector,this.direction);break;case 1:e.preventDefault(),e.stopImmediatePropagation(),this.toVector.set(i,-n,0),this.direction.assign(this.toVector).subtract(this.fromVector)}},mousewheel:function(e){e.preventDefault(),e.stopImmediatePropagation(),this.getActiveViewpoint().transitionStop(),e.deltaY>0?this.addRoll(-l):e.deltaY<0&&this.addRoll(l)},touchstart:function(e){var t=e.originalEvent.touches;switch(t.length){case 1:e.button=0,e.pageX=t[0].pageX,e.pageY=t[0].pageY,this.mousedown(e);break;case 2:this.touchend(e),this.lookAround=!0,e.button=0,e.pageX=(t[0].pageX+t[1].pageX)/2,e.pageY=(t[0].pageY+t[1].pageY)/2,this.mousedown(e);break;case 3:this.touchend(e)}},touchend:function(e){switch(this.button){case 0:this.lookAround=!1,e.button=0,this.mouseup(e)}},touchmove:function(e){var t=e.originalEvent.touches;switch(t.length){case 1:e.button=0,e.pageX=t[0].pageX,e.pageY=t[0].pageY,this.mousemove(e);break;case 2:e.button=0,e.pageX=(t[0].pageX+t[1].pageX)/2,e.pageY=(t[0].pageY+t[1].pageY)/2,this.mousemove(e)}},fly:function(){var e=new n(0,0,0),t=new n(0,0,0),i=new n(0,0,0),o=new r(0,0,1,0),s=new r(0,0,1,0),a=new r(0,0,1,0),u=new r(0,0,1,0),l=new r(0,0,1,0);return function(){var c=this.getNavigationInfo(),h=this.getActiveViewpoint(),d=performance.now(),p=(d-this.startTime)/1e3;e.assign(h.getUpVector()),u.setFromToVec(n.yAxis,e),this.direction.z>0?a.setFromToVec(u.multVecRot(t.assign(this.direction)),u.multVecRot(i.set(0,0,1))):a.setFromToVec(u.multVecRot(i.set(0,0,-1)),u.multVecRot(t.assign(this.direction)));var f=this.direction.abs(),g=1-a.angle/(Math.PI/2);g*=c.speed_.getValue(),g*=h.getSpeedFactor(),g*=this.getBrowser().getShiftKey()?.028:.007,g*=p;var m=this.getTranslationOffset(t.assign(this.direction).multiply(g));this.getActiveLayer().constrainTranslation(m,!0),h.positionOffset_=m.add(h.positionOffset_.getValue());var y=1.4*p*Math.pow(f/(f+40),2);o.assign(r.Identity).slerp(a,y).multRight(h.getUserOrientation()),"GeoViewpoint"!==h.getTypeName()&&this.getStraightenHorizon()&&h.straightenHorizon(o),s.assign(h.getOrientation()).inverse().multRight(o),h.orientationOffset_=s,l.setFromToVec(e,h.getUpVector()),h.orientationOffset_=l.multLeft(h.orientationOffset_.getValue()),this.startTime=d}}(),pan:function(){var e=new n(0,0,0),t=new n(0,0,0);return function(){var i=this.getNavigationInfo(),o=this.getActiveViewpoint(),s=performance.now(),a=(s-this.startTime)/1e3,u=o.getUpVector();this.constrainPanDirection(e.assign(this.direction));var l=1;l*=i.speed_.getValue(),l*=o.getSpeedFactor(),l*=this.getBrowser().getShiftKey()?.0098:.007,l*=a;var c=o.getUserOrientation().multRight(new r(o.getUserOrientation().multVecRot(t.assign(n.yAxis)),u)),h=c.multVecRot(e.multiply(l));this.getActiveLayer().constrainTranslation(h,!0),o.positionOffset_=h.add(o.positionOffset_.getValue()),this.startTime=s}}(),set_orientationOffset__:function(e){this.getActiveViewpoint().orientationOffset_=e},addFly:function(){this.startTime||(this.getBrowser().prepareEvents().addInterest("fly",this),this.getBrowser().addBrowserEvent(),this.startTime=performance.now())},addPan:function(){this.startTime||(this.disconnect(),this.getBrowser().prepareEvents().addInterest("pan",this),this.getBrowser().addBrowserEvent(),this.startTime=performance.now())},addRoll:function(){var e=new r(0,0,1,0),t=new r(0,0,1,0);return function(i){var n=this.getActiveViewpoint();this.orientationChaser.isActive_.getValue()&&this.orientationChaser.value_changed_.hasInterest("set_orientationOffset__",this)?(e.assign(n.getOrientation()).inverse().multRight(t.set(1,0,0,i)).multRight(n.getOrientation()).multRight(this.orientationChaser.set_destination_.getValue()),this.orientationChaser.set_destination_=e):(e.assign(n.getOrientation()).inverse().multRight(t.set(1,0,0,i)).multRight(n.getUserOrientation()),this.orientationChaser.set_value_=n.orientationOffset_,this.orientationChaser.set_destination_=e),this.disconnect(),this.orientationChaser.value_changed_.addInterest("set_orientationOffset__",this)}}(),addRotation:function(){var e=new r(0,0,1,0),t=new r(0,0,1,0);return function(i,n){var r=this.getActiveViewpoint();this.orientationChaser.isActive_.getValue()&&this.orientationChaser.value_changed_.hasInterest("set_orientationOffset__",this)?(e.setFromToVec(n,i).multRight(r.getOrientation()).multRight(this.orientationChaser.set_destination_.getValue()),"GeoViewpoint"!==r.getTypeName()&&this.getStraightenHorizon()&&r.straightenHorizon(e),t.assign(r.getOrientation()).inverse().multRight(e),this.orientationChaser.set_destination_=t):(e.setFromToVec(n,i).multRight(r.getUserOrientation()),
"GeoViewpoint"!==r.getTypeName()&&this.getStraightenHorizon()&&r.straightenHorizon(e),t.assign(r.getOrientation()).inverse().multRight(e),this.orientationChaser.set_value_=r.orientationOffset_,this.orientationChaser.set_destination_=t),this.disconnect(),this.orientationChaser.value_changed_.addInterest("set_orientationOffset__",this)}}(),display:function(){var e=new n(0,0,0),t=new n(0,0,0),i=new o,r=new Float32Array(o.Identity),a=new Float32Array(o.Identity);return function(n,o){var u=this.getBrowser(),l=u.getViewport(),c=l[2],h=l[3];s.ortho(0,c,0,h,-1,1,i),r.set(i),0===o?(e.set(this.fromVector.x,h-this.fromVector.z,0),t.set(this.toVector.x,h-this.toVector.z,0)):(e.set(this.fromVector.x,h+this.fromVector.y,0),t.set(this.toVector.x,h+this.toVector.y,0)),this.transfer(e,t);var d=u.getContext(),p=u.getLineShader(),f=d.getParameter(d.LINE_WIDTH);p.getValid()&&(p.enable(d),p.enableVertexAttribute(d,this.lineBuffer),d.uniform1i(p.x3d_NumClipPlanes,0),d.uniform1i(p.x3d_FogType,0),d.uniform1i(p.x3d_ColorMaterial,!1),d.uniform1i(p.x3d_LinePropertiesApplied,!1),d.uniformMatrix4fv(p.x3d_ProjectionMatrix,!1,r),d.uniformMatrix4fv(p.x3d_ModelViewMatrix,!1,a),d.disable(d.DEPTH_TEST),d.lineWidth(2),d.uniform3f(p.x3d_EmissiveColor,0,0,0),d.uniform1f(p.x3d_Transparency,0),d.drawArrays(d.LINES,0,this.lineCount),d.lineWidth(1),d.uniform3f(p.x3d_EmissiveColor,1,1,1),d.drawArrays(d.LINES,0,this.lineCount),d.enable(d.DEPTH_TEST),d.lineWidth(f),p.disable(d))}}(),transfer:function(e,t){var i=this.getBrowser().getContext(),n=this.lineVertices;n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=1,n[4]=t.x,n[5]=t.y,n[6]=t.z,n[7]=1,this.lineArray.set(n),i.bindBuffer(i.ARRAY_BUFFER,this.lineBuffer),i.bufferData(i.ARRAY_BUFFER,this.lineArray,i.STATIC_DRAW)},disconnect:function(){var e=this.getBrowser();e.addBrowserEvent(),e.prepareEvents().removeInterest("fly",this),e.prepareEvents().removeInterest("pan",this),e.finished().removeInterest("display",this),this.orientationChaser.value_changed_.removeInterest("set_orientationOffset__",this),this.startTime=0},dispose:function(){this.disconnect(),this.getBrowser().controlKey_.removeInterest("set_controlKey__",this),this.getBrowser().getSurface().unbind(".X3DFlyViewer"),e(document).unbind(".X3DFlyViewer"+this.getId())}}),a}),define("x_ite/Browser/Navigation/WalkViewer",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Browser/Navigation/X3DFlyViewer","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4"],function(e,t,i,n,r,o,s){"use strict";function a(e){n.call(this,e)}return a.prototype=Object.assign(Object.create(n.prototype),{constructor:a,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.outputOnly,"isActive",new e.SFBool)]),initialize:function(){n.prototype.initialize.call(this),this.getBrowser().addCollision(this)},getStraightenHorizon:function(){return!0},getFlyDirection:function(e,t,i){return i.assign(t).subtract(e)},getTranslationOffset:function(){var e=new o(0,0,0),t=new s(0,0,1,0),i=new s(0,0,1,0);return function(n){var r=this.getActiveViewpoint(),s=r.getUpVector();return t.assign(r.getUserOrientation()),t.multVecRot(e.assign(o.yAxis)),i.setFromToVec(e,s),t.multRight(i).multVecRot(n)}}(),constrainPanDirection:function(e){return e.y<0&&(e.y=0),e},dispose:function(){this.getBrowser().removeCollision(this),n.prototype.dispose.call(this)}}),a}),define("x_ite/Browser/Navigation/FlyViewer",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Base/X3DConstants","x_ite/Browser/Navigation/X3DFlyViewer","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4"],function(e,t,i,n,r,o,s){"use strict";function a(e){r.call(this,e)}return a.prototype=Object.assign(Object.create(r.prototype),{constructor:a,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(n.outputOnly,"isActive",new e.SFBool)]),addCollision:function(){this.getBrowser().addCollision(this)},removeCollision:function(){this.getBrowser().removeCollision(this)},getFlyDirection:function(e,t,i){return i.assign(t).subtract(e)},getTranslationOffset:function(e){return this.getActiveViewpoint().getUserOrientation().multVecRot(e)},constrainPanDirection:function(e){return e}}),a}),define("x_ite/Browser/Navigation/PlaneViewer",["jquery","x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Base/X3DConstants","x_ite/Browser/Navigation/X3DViewer","x_ite/Components/Navigation/Viewpoint","standard/Math/Numbers/Vector3","jquery-mousewheel"],function(e,t,i,n,r,o,s,a){"use strict";function u(e){o.call(this,e),this.button=-1,this.fromPoint=new a(0,0,0),this.toPoint=new a(0,0,0)}var l=/Mac OS X/i.test(navigator.userAgent),c=l?1/160:.05,h=new a(0,0,0),d=new a(0,0,0),p=new a(0,0,0);return u.prototype=Object.assign(Object.create(o.prototype),{constructor:u,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new n([new i(r.outputOnly,"isActive",new t.SFBool)]),initialize:function(){o.prototype.initialize.call(this);var e=this.getBrowser(),t=e.getSurface();t.bind("mousedown.PlaneViewer",this.mousedown.bind(this)),t.bind("mouseup.PlaneViewer",this.mouseup.bind(this)),t.bind("mousemove.PlaneViewer",this.mousemove.bind(this)),t.bind("mousewheel.PlaneViewer",this.mousewheel.bind(this))},mousedown:function(t){if(!(this.getBrowser().getContextMenu().getActive()||this.button>=0)){var i=this.getBrowser().getSurface().offset(),n=t.pageX-i.left,r=t.pageY-i.top;switch(this.getButton(t.button)){case 1:t.preventDefault(),t.stopImmediatePropagation(),this.button=t.button,this.getBrowser().getSurface().unbind("mousemove.PlaneViewer"),e(document).bind("mouseup.PlaneViewer"+this.getId(),this.mouseup.bind(this)),e(document).bind("mousemove.PlaneViewer"+this.getId(),this.mousemove.bind(this)),this.getActiveViewpoint().transitionStop(),this.getBrowser().setCursor("MOVE"),this.getPointOnCenterPlane(n,r,this.fromPoint),this.isActive_=!0}}},mouseup:function(t){t.preventDefault(),t.stopImmediatePropagation(),t.button===this.button&&(this.button=-1,e(document).unbind(".PlaneViewer"+this.getId()),this.getBrowser().getSurface().bind("mousemove.PlaneViewer",this.mousemove.bind(this)),this.getBrowser().setCursor("DEFAULT"),this.isActive_=!1)},mousemove:function(e){var t=this.getBrowser().getSurface().offset(),i=e.pageX-t.left,n=e.pageY-t.top;switch(this.getButton(this.button)){case 1:e.preventDefault(),e.stopImmediatePropagation();var r=this.getActiveViewpoint(),o=this.getPointOnCenterPlane(i,n,this.toPoint),s=r.getUserOrientation().multVecRot(this.fromPoint.subtract(o));r.positionOffset_=d.assign(r.positionOffset_.getValue()).add(s),r.centerOfRotationOffset_=p.assign(r.centerOfRotationOffset_.getValue()).add(s),this.fromPoint.assign(o)}},mousewheel:function(e){e.preventDefault(),e.stopImmediatePropagation();var t=this.getBrowser().getSurface().offset(),i=e.pageX-t.left,n=e.pageY-t.top,r=this.getActiveViewpoint(),o=this.getPointOnCenterPlane(i,n,this.fromPoint);r.transitionStop(),e.deltaY>0?r.fieldOfViewScale_=Math.max(1e-5,r.fieldOfViewScale_.getValue()*(1-c)):e.deltaY<0&&(r.fieldOfViewScale_=r.fieldOfViewScale_.getValue()*(1+c),this.constrainFieldOfViewScale()),r.set_fieldOfView___&&r.set_fieldOfView___();var s=this.getPointOnCenterPlane(i,n,this.toPoint),a=r.getUserOrientation().multVecRot(h.assign(o).subtract(s));r.positionOffset_=d.assign(r.positionOffset_.getValue()).add(a),r.centerOfRotationOffset_=p.assign(r.centerOfRotationOffset_.getValue()).add(a)},constrainFieldOfViewScale:function(){var e=this.getActiveViewpoint();(e instanceof s||"GeoViewpoint"===e.getTypeName())&&e.fieldOfView_.getValue()*e.fieldOfViewScale_.getValue()>=Math.PI&&(e.fieldOfViewScale_=(Math.PI-.001)/e.fieldOfView_.getValue())},dispose:function(){this.getBrowser().getSurface().unbind(".PlaneViewer"),e(document).unbind(".PlaneViewer"+this.getId())}}),u}),define("x_ite/Browser/Navigation/NoneViewer",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Base/X3DConstants","x_ite/Browser/Navigation/X3DViewer"],function(e,t,i,n,r){"use strict";function o(e){r.call(this,e)}return o.prototype=Object.assign(Object.create(r.prototype),{constructor:o,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(n.outputOnly,"isActive",new e.SFBool)])}),o}),define("x_ite/Browser/Navigation/LookAtViewer",["jquery","x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Base/X3DConstants","x_ite/Browser/Navigation/X3DViewer","x_ite/Components/Followers/PositionChaser","x_ite/Components/Followers/OrientationChaser","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4"],function(e,t,i,n,r,o,s,a,u,l,c){"use strict";function h(e){o.call(this,e),this.button=-1,this.fromVector=new l(0,0,0),this.toVector=new l(0,0,0),this.touch1=new u(0,0),this.touch2=new u(0,0),this.tapStart=0,this.dblTapInterval=.4,this.positionChaser=new s(e),this.centerOfRotationChaser=new s(e),this.orientationChaser=new a(e)}var d=/Mac OS X/i.test(navigator.userAgent),p=d?1/120:.05;return h.prototype=Object.assign(Object.create(o.prototype),{constructor:h,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new n([new i(r.outputOnly,"isActive",new t.SFBool)]),initialize:function(){o.prototype.initialize.call(this);var e=this.getBrowser(),t=e.getSurface();t.bind("mousedown.LookAtViewer",this.mousedown.bind(this)),t.bind("mouseup.LookAtViewer",this.mouseup.bind(this)),t.bind("dblclick.LookAtViewer",this.dblclick.bind(this)),t.bind("mousewheel.LookAtViewer",this.mousewheel.bind(this)),t.bind("touchstart.LookAtViewer",this.touchstart.bind(this)),t.bind("touchend.LookAtViewer",this.touchend.bind(this)),this.positionChaser.duration_=.3,this.positionChaser.setPrivate(!0),this.positionChaser.setup(),this.centerOfRotationChaser.duration_=.3,this.centerOfRotationChaser.setPrivate(!0),this.centerOfRotationChaser.setup(),this.orientationChaser.duration_=.3,this.orientationChaser.setPrivate(!0),this.orientationChaser.setup()},mousedown:function(t){if(!(this.getBrowser().getContextMenu().getActive()||this.button>=0)){var i=this.getBrowser().getSurface().offset(),n=t.pageX-i.left,r=t.pageY-i.top;switch(t.button){case 0:t.preventDefault(),t.stopImmediatePropagation(),this.button=t.button,e(document).bind("mouseup.LookAtViewer"+this.getId(),this.mouseup.bind(this)),e(document).bind("mousemove.LookAtViewer"+this.getId(),this.mousemove.bind(this)),e(document).bind("touchend.LookAtViewer"+this.getId(),this.mouseup.bind(this)),e(document).bind("touchmove.LookAtViewer"+this.getId(),this.touchmove.bind(this)),this.getActiveViewpoint().transitionStop(),this.trackballProjectToSphere(n,r,this.fromVector),this.isActive_=!0}}},mouseup:function(t){if(t.button===this.button)switch(this.button=-1,e(document).unbind(".LookAtViewer"+this.getId()),t.button){case 0:t.preventDefault(),t.stopImmediatePropagation(),this.isActive_=!1}},dblclick:function(e){e.preventDefault(),e.stopImmediatePropagation();var t=this.getBrowser().getSurface(),i=t.offset(),n=e.pageX-i.left-parseFloat(t.css("borderLeftWidth")),r=t.innerHeight()-(e.pageY-i.top-parseFloat(t.css("borderTopWidth")));this.disconnect(),this.lookAtPoint(n,r,this.getStraightenHorizon())},mousemove:function(e){this.getBrowser().addBrowserEvent(),this.event=e;var t=this.getBrowser().getSurface().offset(),i=e.pageX-t.left,n=e.pageY-t.top;switch(this.button){case 0:e.preventDefault(),e.stopImmediatePropagation();var r=this.trackballProjectToSphere(i,n,this.toVector);this.addRotation(this.fromVector,r),this.fromVector.assign(r)}},mousewheel:function(){var e=new l(0,0,0),t=new l(0,0,0);return function(i){i.preventDefault(),i.stopImmediatePropagation();var n=this.getActiveViewpoint();n.transitionStop(),e=this.getDistanceToCenter(e).multiply(i.zoomFactor||p),t=n.getUserOrientation().multVecRot(t.set(0,0,e.abs())),i.deltaY>0?this.addMove(t.negate(),l.Zero):i.deltaY<0&&this.addMove(t,l.Zero)}}(),touchstart:function(e){var t=e.originalEvent.touches;switch(t.length){case 1:this.touch1.set(t[0].pageX,t[0].pageY);break;case 2:this.touchend(e),e.button=0,e.pageX=(t[0].pageX+t[1].pageX)/2,e.pageY=(t[0].pageY+t[1].pageY)/2,this.mousedown(e),this.touch1.set(t[0].pageX,t[0].pageY),this.touch2.set(t[1].pageX,t[1].pageY);break;case 3:this.touchend(e)}},touchend:function(e){switch(this.button){case 0:this.mouseup(e)}this.getBrowser().getCurrentTime()-this.tapStart<this.dblTapInterval&&(e.button=1,e.pageX=this.touch1.x,e.pageY=this.touch1.y,this.dblclick(e)),this.tapStart=this.getBrowser().getCurrentTime()},touchmove:function(){var t=new u(0,0),i=new u(0,0);return function(n){var r=n.originalEvent.touches;switch(r.length){case 1:break;case 2:t.set(r[0].pageX,r[0].pageY).subtract(this.touch1).normalize(),i.set(r[1].pageX,r[1].pageY).subtract(this.touch2).normalize();var o=t.dot(i)>.7,s=t.dot(i)<-.7;if(o)n.button=0,n.pageX=(r[0].pageX+r[1].pageX)/2,n.pageY=(r[0].pageY+r[1].pageY)/2,this.mousemove(n);else if(s){var a=this.touch1.distance(this.touch2);this.touch1.set(r[0].pageX,r[0].pageY),this.touch2.set(r[1].pageX,r[1].pageY);var u=this.touch1.distance(this.touch2),l=u-a;n.deltaY=l,n.zoomFactor=Math.abs(l)/e(window).width(),this.mousewheel(n)}this.touch1.set(r[0].pageX,r[0].pageY),this.touch2.set(r[1].pageX,r[1].pageY)}}}(),set_positionOffset__:function(e){this.getActiveViewpoint().positionOffset_=e},set_centerOfRotationOffset__:function(e){this.getActiveViewpoint().centerOfRotationOffset_=e},set_orientationOffset__:function(e){this.getActiveViewpoint().orientationOffset_=e},addMove:function(){var e=new l(0,0,0),t=new l(0,0,0);return function(i,n){var r=this.getActiveViewpoint();this.positionChaser.isActive_.getValue()&&this.positionChaser.value_changed_.hasInterest("set_positionOffset__",this)?(e.assign(this.positionChaser.set_destination_.getValue()).add(i),this.positionChaser.set_destination_=e):(e.assign(r.positionOffset_.getValue()).add(i),this.positionChaser.set_value_=r.positionOffset_,this.positionChaser.set_destination_=e),this.centerOfRotationChaser.isActive_.getValue()&&this.centerOfRotationChaser.value_changed_.hasInterest("set_centerOfRotationOffset__",this)?(t.assign(this.centerOfRotationChaser.set_destination_.getValue()).add(n),this.centerOfRotationChaser.set_destination_=t):(t.assign(r.centerOfRotationOffset_.getValue()).add(n),this.centerOfRotationChaser.set_value_=r.centerOfRotationOffset_,this.centerOfRotationChaser.set_destination_=t),this.disconnect(),this.positionChaser.value_changed_.addInterest("set_positionOffset__",this),this.centerOfRotationChaser.value_changed_.addInterest("set_centerOfRotationOffset__",this)}}(),addRotation:function(){var e=new c(0,0,1,0),t=new c(0,0,1,0);return function(i,n){var r=this.getActiveViewpoint();this.orientationChaser.isActive_.getValue()&&this.orientationChaser.value_changed_.hasInterest("set_orientationOffset__",this)?(e.setFromToVec(n,i).multRight(r.getOrientation()).multRight(this.orientationChaser.set_destination_.getValue()),r.straightenHorizon(e),t.assign(r.getOrientation()).inverse().multRight(e),this.orientationChaser.set_destination_=t):(e.setFromToVec(n,i).multRight(r.getUserOrientation()),r.straightenHorizon(e),t.assign(r.getOrientation()).inverse().multRight(e),this.orientationChaser.set_value_=r.orientationOffset_,this.orientationChaser.set_destination_=t),this.disconnect(),this.orientationChaser.value_changed_.addInterest("set_orientationOffset__",this)}}(),disconnect:function(){this.orientationChaser.value_changed_.removeInterest("set_orientationOffset__",this),this.positionChaser.value_changed_.removeInterest("set_positionOffset__",this),this.centerOfRotationChaser.value_changed_.removeInterest("set_centerOfRotationOffset__",this)},dispose:function(){this.getBrowser().getSurface().unbind(".LookAtViewer"),e(document).unbind(".LookAtViewer"+this.getId())}}),h}),define("x_ite/Components/Lighting/X3DLightNode",["x_ite/Components/Core/X3DChildNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Matrix4","standard/Math/Algorithm"],function(e,t,i,n){"use strict";function r(i){e.call(this,i),this.addType(t.X3DLightNode)}return r.prototype=Object.assign(Object.create(e.prototype),{constructor:r,initialize:function(){e.prototype.initialize.call(this),this.on_.addInterest("set_on__",this),this.intensity_.addInterest("set_on__",this),this.set_on__()},set_on__:function(){this.on_.getValue()&&this.getIntensity()>0?(delete this.push,delete this.pop):(this.push=Function.prototype,this.pop=Function.prototype)},getGlobal:function(){return this.global_.getValue()},getColor:function(){return this.color_.getValue()},getIntensity:function(){return Math.max(this.intensity_.getValue(),0)},getAmbientIntensity:function(){return n.clamp(this.ambientIntensity_.getValue(),0,1)},getDirection:function(){return this.direction_.getValue()},getShadows:function(){return this.shadows_.getValue()},getShadowColor:function(){return this.shadowColor_.getValue()},getShadowIntensity:function(){return this.getShadows()?n.clamp(this.shadowIntensity_.getValue(),0,1):0},getShadowBias:function(){return n.clamp(this.shadowBias_.getValue(),0,1)},getShadowMapSize:function(){return Math.min(this.shadowMapSize_.getValue(),this.getBrowser().getMaxTextureSize())},getBiasMatrix:function(){const e=new i(.5,0,0,0,0,.5,0,0,0,0,.5,0,.5,.5,.5,1);return function(){return e}}(),push:function(e,t){if(e.isIndependent()){const i=this.getLights().pop();this.global_.getValue()?(i.set(e.getBrowser(),this,e.getLayer().getGroup(),e.getModelViewMatrix().get()),e.getGlobalObjects().push(i),e.getLights().push(i)):(i.set(e.getBrowser(),this,t,e.getModelViewMatrix().get()),e.getLocalObjects().push(i),e.getLights().push(i))}else{const t=e.getLightContainer();this.global_.getValue()?(t.getModelViewMatrix().pushMatrix(e.getModelViewMatrix().get()),e.getGlobalObjects().push(t),e.getLights().push(t)):(t.getModelViewMatrix().pushMatrix(e.getModelViewMatrix().get()),e.getLocalObjects().push(t),e.getLights().push(t))}e.pushShadow(this.getShadowIntensity())},pop:function(e){this.global_.getValue()||(e.isIndependent()?e.getBrowser().getLocalObjects().push(e.getLocalObjects().pop()):e.getLocalObjects().pop(),e.popShadow())}}),r}),define("x_ite/Components/Lighting/DirectionalLight",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Lighting/X3DLightNode","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Rendering/TraverseType","x_ite/Base/X3DConstants","standard/Math/Geometry/Box3","standard/Math/Geometry/Camera","standard/Math/Geometry/ViewVolume","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Utility/MatrixStack","standard/Utility/ObjectCache"],function(e,t,i,n,r,o,s,a,u,l,c,h,d,p,f,g){"use strict";function m(){this.direction=new c(0,0,0),this.shadowBuffer=null,this.bbox=new a,this.viewVolume=new l,this.viewport=new h(0,0,0,0),this.projectionMatrix=new p,this.modelViewMatrix=new f(p),this.modelMatrix=new p,this.invLightSpaceMatrix=new p,this.invLightSpaceProjectionMatrix=new p,this.shadowMatrix=new p,this.shadowMatrixArray=new Float32Array(16),this.rotation=new d,this.textureUnit=0}function y(e){n.call(this,e),this.addType(s.DirectionalLight),"2.0"===e.getSpecificationVersion()&&(this.global_=!0)}var _=g(m);return m.prototype={constructor:m,getModelViewMatrix:function(){return this.modelViewMatrix},set:function(e,t,i,n){var r=e.getContext(),o=t.getShadowMapSize();this.browser=e,this.lightNode=t,this.groupNode=i,this.modelViewMatrix.pushMatrix(n),t.getShadowIntensity()>0&&o>0&&(this.shadowBuffer=e.popShadowBuffer(o),this.shadowBuffer?e.getCombinedTextureUnits().length?(this.textureUnit=e.getCombinedTextureUnits().pop(),r.activeTexture(r.TEXTURE0+this.textureUnit),r.getVersion()>=2||e.getExtension("WEBGL_depth_texture")?r.bindTexture(r.TEXTURE_2D,this.shadowBuffer.getDepthTexture()):r.bindTexture(r.TEXTURE_2D,this.shadowBuffer.getColorTexture()),r.activeTexture(r.TEXTURE0)):console.warn("Not enough combined texture units for shadow map available."):console.warn("Couldn't create shadow buffer."))},renderShadowMap:function(e){try{if(!this.shadowBuffer)return;var t=this.lightNode,i=e.getCameraSpaceMatrix().get(),n=this.modelMatrix.assign(this.modelViewMatrix.get()).multRight(i),s=this.invLightSpaceMatrix.assign(t.getGlobal()?n:p.Identity);s.rotate(this.rotation.setFromToVec(c.zAxis,this.direction.assign(t.getDirection()).negate())),s.inverse();var a=this.groupNode.getSubBBox(this.bbox,!0),l=a.multRight(s),h=t.getShadowMapSize(),d=this.viewport.set(0,0,h,h),f=u.orthoBox(l,this.projectionMatrix);this.shadowBuffer.bind(),e.getViewVolumes().push(this.viewVolume.set(f,d,d)),e.getProjectionMatrix().pushMatrix(f),e.getModelViewMatrix().pushMatrix(s),e.render(o.SHADOW,r.prototype.traverse,this.groupNode),e.getModelViewMatrix().pop(),e.getProjectionMatrix().pop(),e.getViewVolumes().pop(),this.shadowBuffer.unbind(),t.getGlobal()||s.multLeft(n.inverse()),this.invLightSpaceProjectionMatrix.assign(s).multRight(f).multRight(t.getBiasMatrix())}catch(e){console.log(e)}},setGlobalVariables:function(e){this.modelViewMatrix.get().multDirMatrix(this.direction.assign(this.lightNode.getDirection())).normalize(),this.shadowMatrix.assign(e.getCameraSpaceMatrix().get()).multRight(this.invLightSpaceProjectionMatrix),this.shadowMatrixArray.set(this.shadowMatrix)},setShaderUniforms:function(e,t){var i=t.numLights++;if(!t.hasLight(i,this)){var n=this.lightNode,r=n.getColor(),o=this.direction;if(e.uniform1i(t.x3d_LightType[i],1),e.uniform3f(t.x3d_LightColor[i],r.r,r.g,r.b),e.uniform1f(t.x3d_LightIntensity[i],n.getIntensity()),e.uniform1f(t.x3d_LightAmbientIntensity[i],n.getAmbientIntensity()),e.uniform3f(t.x3d_LightDirection[i],o.x,o.y,o.z),this.textureUnit){var s=n.getShadowColor();e.uniform3f(t.x3d_ShadowColor[i],s.r,s.g,s.b),e.uniform1f(t.x3d_ShadowIntensity[i],n.getShadowIntensity()),e.uniform1f(t.x3d_ShadowBias[i],n.getShadowBias()),e.uniformMatrix4fv(t.x3d_ShadowMatrix[i],!1,this.shadowMatrixArray),e.uniform1i(t.x3d_ShadowMapSize[i],n.getShadowMapSize()),e.uniform1i(t.x3d_ShadowMap[i],this.textureUnit)}else e.uniform1f(t.x3d_ShadowIntensity[i],0)}},dispose:function(){this.textureUnit&&this.browser.getCombinedTextureUnits().push(this.textureUnit),this.browser.pushShadowBuffer(this.shadowBuffer),this.modelViewMatrix.clear(),this.browser=null,this.lightNode=null,this.groupNode=null,this.shadowBuffer=null,this.textureUnit=0,_.push(this)}},y.prototype=Object.assign(Object.create(n.prototype),{constructor:y,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOutput,"global",new e.SFBool(!1)),new t(s.inputOutput,"on",new e.SFBool(!0)),new t(s.inputOutput,"color",new e.SFColor(1,1,1)),new t(s.inputOutput,"intensity",new e.SFFloat(1)),new t(s.inputOutput,"ambientIntensity",new e.SFFloat),new t(s.inputOutput,"direction",new e.SFVec3f(0,0,-1)),new t(s.inputOutput,"shadows",new e.SFBool),new t(s.inputOutput,"shadowColor",new e.SFColor),new t(s.inputOutput,"shadowIntensity",new e.SFFloat(1)),new t(s.inputOutput,"shadowBias",new e.SFFloat(.005)),new t(s.initializeOnly,"shadowMapSize",new e.SFInt32(1024))]),getTypeName:function(){return"DirectionalLight"},getComponentName:function(){return"Lighting"},getContainerField:function(){return"children"},getLights:function(){return _}}),y}),define("x_ite/Browser/Navigation/X3DNavigationContext",["x_ite/Fields","x_ite/Browser/Navigation/ExamineViewer","x_ite/Browser/Navigation/WalkViewer","x_ite/Browser/Navigation/FlyViewer","x_ite/Browser/Navigation/PlaneViewer","x_ite/Browser/Navigation/NoneViewer","x_ite/Browser/Navigation/LookAtViewer","x_ite/Components/Lighting/DirectionalLight","standard/Math/Numbers/Matrix4"],function(e,t,i,n,r,o,s,a,u){"use strict";function l(e){const t=new a(e.getPrivateScene());t.setup();const i=t.getLights().pop();return i.set(e,t,null,u.Identity),i.dispose=Function.prototype,i}function c(){this.addChildObjects("activeLayer",new e.SFNode,"activeNavigationInfo",new e.SFNode,"activeViewpoint",new e.SFNode,"availableViewers",new e.MFString,"viewer",new e.SFString("EXAMINE")),this[h]=new Set,this[d]=new o(this)}const h=Symbol(),d=Symbol(),p=Symbol();return c.prototype={initialize:function(){this.viewer_.addInterest("set_viewer__",this),this.initialized().addInterest("set_world__",this),this.shutdown().addInterest("remove_world__",this),this[p]=l(this),this[d].setup()},getHeadlight:function(){return this[p]},getActiveLayer:function(){return this.activeLayer_.getValue()},getActiveNavigationInfo:function(){return this.activeNavigationInfo_.getValue()},getActiveViewpoint:function(){return this.activeViewpoint_.getValue()},getCurrentViewer:function(){return this.viewer_.getValue()},getViewer:function(){return this[d]},addCollision:function(e){this[h].add(e)},removeCollision:function(e){this[h].delete(e)},getCollisionCount:function(){return this[h].size},remove_world__:function(){this.getWorld().activeLayer_.removeInterest("set_activeLayer__",this)},set_world__:function(){this.getWorld().activeLayer_.addInterest("set_activeLayer__",this),this.set_activeLayer__()},set_activeLayer__:function(){this.activeLayer_.getValue()&&(this.activeLayer_.getValue().getNavigationInfoStack().removeInterest("set_activeNavigationInfo__",this),this.activeLayer_.getValue().getViewpointStack().removeInterest("set_activeViewpoint__",this)),this.activeLayer_=this.getWorld().getActiveLayer(),this.activeLayer_.getValue()&&(this.activeLayer_.getValue().getNavigationInfoStack().addInterest("set_activeNavigationInfo__",this),this.activeLayer_.getValue().getViewpointStack().addInterest("set_activeViewpoint__",this)),this.set_activeNavigationInfo__(),this.set_activeViewpoint__()},set_activeNavigationInfo__:function(){this.activeNavigationInfo_.getValue()&&this.activeNavigationInfo_.getValue().viewer_.removeFieldInterest(this.viewer_),this.activeLayer_.getValue()?(this.activeNavigationInfo_=this.activeLayer_.getValue().getNavigationInfo(),this.activeNavigationInfo_.getValue().viewer_.addFieldInterest(this.viewer_),this.viewer_=this.activeNavigationInfo_.getValue().viewer_):(this.activeNavigationInfo_=null,this.viewer_="NONE")},set_activeViewpoint__:function(){this.activeLayer_.getValue()?this.activeViewpoint_=this.activeLayer_.getValue().getViewpoint():this.activeViewpoint_=null},set_viewer__:function(e){switch(this.activeNavigationInfo_.getValue()?this.availableViewers_=this.activeNavigationInfo_.getValue().availableViewers_:this.availableViewers_.length=0,this[d]&&this[d].dispose(),e.getValue()){case"EXAMINE":this[d]=new t(this);break;case"WALK":this[d]=new i(this);break;case"FLY":this[d]=new n(this);break;case"PLANE":case"PLANE_create3000.de":this[d]=new r(this);break;case"NONE":this[d]=new o(this);break;case"LOOKAT":this[d]=new s(this);break;default:this[d]=new t(this)}this[d].setup()}},c}),define("x_ite/Components/Layering/Viewport",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Layering/X3DViewportNode","x_ite/Base/X3DConstants","x_ite/Rendering/TraverseType","standard/Utility/ObjectCache","standard/Math/Geometry/ViewVolume","standard/Math/Numbers/Vector4"],function(e,t,i,n,r,o,s,a,u){"use strict";function l(e){n.call(this,e),this.addType(r.Viewport),this.rectangle=new u(0,0,0,0)}const c=s(a);return l.prototype=Object.assign(Object.create(n.prototype),{constructor:l,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"clipBoundary",new e.MFFloat(0,1,0,1)),new t(r.inputOutput,"visible",new e.SFBool(!0)),new t(r.inputOutput,"bboxDisplay",new e.SFBool),new t(r.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new t(r.initializeOnly,"bboxCenter",new e.SFVec3f),new t(r.inputOnly,"addChildren",new e.MFNode),new t(r.inputOnly,"removeChildren",new e.MFNode),new t(r.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"Viewport"},getComponentName:function(){return"Layering"},getContainerField:function(){return"viewport"},getRectangle:function(e){const t=e.getViewport(),i=Math.floor(t[2]*this.getLeft()),n=Math.floor(t[2]*this.getRight()),r=Math.floor(t[3]*this.getBottom()),o=Math.floor(t[3]*this.getTop());return this.rectangle.set(i,r,Math.max(0,n-i),Math.max(0,o-r)),this.rectangle},getLeft:function(){return this.clipBoundary_.length>0?this.clipBoundary_[0]:0},getRight:function(){return this.clipBoundary_.length>1?this.clipBoundary_[1]:1},getBottom:function(){return this.clipBoundary_.length>2?this.clipBoundary_[2]:0},getTop:function(){return this.clipBoundary_.length>3?this.clipBoundary_[3]:1},traverse:function(e,t){switch(this.push(t),e){case o.POINTER:t.getBrowser().isPointerInRectangle(this.rectangle)&&n.prototype.traverse.call(this,e,t);break;default:n.prototype.traverse.call(this,e,t)}this.pop(t)},push:function(e){const t=e.getViewVolumes(),i=this.getRectangle(e.getBrowser()),n=t.length?t.at(-1).getViewport():i,r=c.pop();r.set(e.getProjectionMatrix().get(),n,i),t.push(r)},pop:function(e){c.push(e.getViewVolumes().pop())}}),l}),define("x_ite/Browser/Layering/X3DLayeringContext",["x_ite/Components/Layering/Viewport"],function(e){"use strict";function t(){this[i]=new e(this.getPrivateScene())}const i=Symbol();return t.prototype={initialize:function(){this[i].setup()},getDefaultViewport:function(){return this[i]}},t}),define("x_ite/Browser/EnvironmentalEffects/X3DEnvironmentalEffectsContext",["x_ite/Components/Texturing/TextureProperties"],function(e){"use strict";function t(){}const i=Symbol(),n=Symbol();return t.prototype={initialize:function(){},getBackgroundSphereShader:function(){return this[i]=this.createShader("BackgroundSphereShader","Background"),this.getBackgroundSphereShader=function(){return this[i]},Object.defineProperty(this,"getBackgroundSphereShader",{enumerable:!1}),this[i]},getBackgroundTextureProperties:function(){return this[n]=new e(this.getPrivateScene()),this[n].boundaryModeS_="CLAMP_TO_EDGE",this[n].boundaryModeT_="CLAMP_TO_EDGE",this[n].boundaryModeR_="CLAMP_TO_EDGE",this[n].minificationFilter_="NICEST",this[n].magnificationFilter_="NICEST",this[n].setup(),this.getBackgroundTextureProperties=function(){return this[n]},Object.defineProperty(this,"getBackgroundTextureProperties",{enumerable:!1}),this[n]}},t}),define("x_ite/Browser/Lighting/X3DLightingContext",["x_ite/Rendering/TextureBuffer"],function(e){"use strict";function t(){const e=this.getContext(),t=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS);this[i]=t>16?8:t>8?4:2,this[n]=[]}const i=Symbol(),n=Symbol();return t.prototype={initialize:function(){},getMaxLights:function(){return this[i]},popShadowBuffer:function(t){try{const i=this[n][t];if(i){if(i.length)return i.pop()}else this[n][t]=[];return new e(this,t,t)}catch(e){return console.log(e),null}},pushShadowBuffer:function(e){e&&this[n][e.getWidth()].push(e)}},t}),define("x_ite/Browser/Picking/X3DPickingContext",["x_ite/Rendering/TraverseType"],function(e){"use strict";function t(){this[i]=new Set,this[n]=[new Set],this[r]=[],this[o]=[!1],this[s]=0}const i=Symbol(),n=Symbol(),r=Symbol(),o=Symbol(),s=Symbol();return t.prototype={initialize:function(){},addTransformSensor:function(e){this[i].add(e),this.enablePicking()},removeTransformSensor:function(e){this[i].delete(e),this.enablePicking()},addPickSensor:function(e){this[n][0].add(e),this.enablePicking()},removePickSensor:function(e){this[n][0].delete(e),this.enablePicking()},getPickSensors:function(){return this[n]},getPickingHierarchy:function(){return this[r]},getPickable:function(){return this[o]},enablePicking:function(){this[i].size||this[n][0].size?this.sensorEvents_.addInterest("picking",this):this.sensorEvents_.removeInterest("picking",this)},picking:function(){const t=performance.now();this.getWorld().traverse(e.PICKING,null);for(const e of this[i])e.process();for(const e of this[n][0])e.process();this[s]=performance.now()-t},getPickingTime:function(){return this[s]}},t}),
define("x_ite/Browser/Sound/X3DSoundContext",["x_ite/Fields"],function(e){"use strict";function t(){this.addChildObjects("volume",new e.SFFloat(1),"mute",new e.SFBool)}return t.prototype={initialize:function(){}},t}),define("x_ite/Browser/Text/TextAlignment",[],function(){"use strict";let e=0;return{BEGIN:++e,FIRST:++e,MIDDLE:++e,END:++e}}),define("x_ite/Components/Text/X3DFontStyleNode",["x_ite/Fields","x_ite/Components/Core/X3DNode","x_ite/Components/Networking/X3DUrlObject","x_ite/Browser/Text/TextAlignment","x_ite/InputOutput/FileLoader","x_ite/Base/X3DConstants","x_ite/Browser/Networking/urls"],function(e,t,i,n,r,o,s){"use strict";function a(n){t.call(this,n),i.call(this,n),this.addType(o.X3DFontStyleNode),this.addChildObjects("load",new e.SFBool(!0),"autoRefresh",new e.SFTime,"autoRefreshTimeLimit",new e.SFTime(3600)),this.addAlias("url",this.family_),this.familyStack=[],this.alignments=[],this.loader=new r(this)}const u={SERIF:{PLAIN:s.getFontsUrl("DroidSerif-Regular.ttf"),ITALIC:s.getFontsUrl("DroidSerif-Italic.ttf"),BOLD:s.getFontsUrl("DroidSerif-Bold.ttf"),BOLDITALIC:s.getFontsUrl("DroidSerif-BoldItalic.ttf")},SANS:{PLAIN:s.getFontsUrl("Ubuntu-R.ttf"),ITALIC:s.getFontsUrl("Ubuntu-RI.ttf"),BOLD:s.getFontsUrl("Ubuntu-B.ttf"),BOLDITALIC:s.getFontsUrl("Ubuntu-BI.ttf")},TYPEWRITER:{PLAIN:s.getFontsUrl("UbuntuMono-R.ttf"),ITALIC:s.getFontsUrl("UbuntuMono-RI.ttf"),BOLD:s.getFontsUrl("UbuntuMono-B.ttf"),BOLDITALIC:s.getFontsUrl("UbuntuMono-BI.ttf")}};return a.prototype=Object.assign(Object.create(t.prototype),i.prototype,{constructor:a,initialize:function(){t.prototype.initialize.call(this),i.prototype.initialize.call(this),this.style_.addInterest("set_style__",this),this.justify_.addInterest("set_justify__",this),this.font=null,this.familyIndex=0,this.set_justify__(),this.set_style__(),this.requestImmediateLoad()},set_style__:function(){this.load_.getValue()&&(this.setLoadState(o.NOT_STARTED_STATE),this.requestImmediateLoad())},set_justify__:function(){const e=this.horizontal_.getValue()?this.leftToRight_.getValue():this.topToBottom_.getValue();this.alignments[0]=this.justify_.length>0?this.getAlignment(0,e):e?n.BEGIN:n.END;const t=this.horizontal_.getValue()?this.topToBottom_.getValue():this.leftToRight_.getValue();this.alignments[1]=this.justify_.length>1?this.getAlignment(1,t):t?n.FIRST:n.END},getMajorAlignment:function(){return this.alignments[0]},getMinorAlignment:function(){return this.alignments[1]},getAlignment:function(e,t){if(t)switch(this.justify_[e]){case"FIRST":return n.FIRST;case"BEGIN":return n.BEGIN;case"MIDDLE":return n.MIDDLE;case"END":return n.END}else switch(this.justify_[e]){case"FIRST":return n.END;case"BEGIN":return n.END;case"MIDDLE":return n.MIDDLE;case"END":return n.BEGIN}return e?n.FIRST:n.BEGIN},getDefaultFont:function(e){const t=u[e];if(t)return t[this.style_.getValue()]||t.PLAIN},loadNow:function(){const e=this.urlBuffer_.copy();e.push("SERIF"),this.familyStack.length=0;for(const t of e)this.familyStack.push(this.getDefaultFont(t)||t);this.loadNext()},loadNext:function(){try{if(0===this.familyStack.length)return this.setLoadState(o.FAILED_STATE),void(this.font=null);this.family=this.familyStack.shift(),this.URL=new URL(this.family,this.loader.getReferer()),this.getBrowser().getBrowserOptions().getCache()&&this.getCache()||this.URL.searchParams.set("_",Date.now()),this.getBrowser().getFont(this.URL).done(this.setFont.bind(this)).fail(this.setError.bind(this))}catch(e){this.setError(e.message)}},setError:function(e){"data:"!==this.URL.protocol&&console.warn("Error loading font '"+this.URL.toString()+"':",e),this.loadNext()},setFont:function(e){this.font=e,this.setLoadState(o.COMPLETE_STATE),this.addNodeEvent()},getFont:function(){return this.font}}),a}),define("standard/Math/Geometry/Box2",["standard/Math/Numbers/Matrix3","standard/Math/Numbers/Vector2"],function(e,t){"use strict";function i(t,i){switch(arguments.length){case 0:return void(this.matrix=new e(0,0,0,0,0,0,0,0,0));case 2:return void(this.matrix=new e(t.x/2,0,0,0,t.y/2,0,i.x,i.y,1));case 3:{const t=arguments[0],i=arguments[1],n=(i.x-t.x)/2,r=(i.y-t.y)/2,o=(i.x+t.x)/2,s=(i.y+t.y)/2;return void(this.matrix=new e(n,0,0,0,r,0,o,s,1))}}}return i.prototype={constructor:i,copy:function(){const e=Object.create(i.prototype);return e.matrix=this.matrix.copy(),e},assign:function(e){return this.matrix.assign(e.matrix),this},equals:function(e){return this.matrix.equals(e.matrix)},set:function(e,t){const i=this.matrix;switch(arguments.length){case 0:return i[0]=.5,i[1]=0,i[2]=0,i[3]=0,i[4]=.5,i[5]=0,i[6]=0,i[7]=0,i[8]=0,this;case 2:return i[0]=e.x/2,i[1]=0,i[2]=0,i[3]=0,i[4]=e.y/2,i[5]=0,i[6]=t.x,i[7]=t.y,i[8]=1,this;case 3:{const e=arguments[0],t=arguments[1],i=(t.x-e.x)/2,n=(t.y-e.y)/2,r=(t.x+e.x)/2,o=(t.y+e.y)/2;return this.matrix.set(i,0,0,0,n,0,r,o,1),this}}},setExtents:function(e,t){const i=this.matrix,n=(t.x-e.x)/2,r=(t.y-e.y)/2,o=(t.x+e.x)/2,s=(t.y+e.y)/2;return i[0]=n,i[1]=0,i[2]=0,i[3]=0,i[4]=r,i[5]=0,i[6]=o,i[7]=s,i[8]=1,this},isEmpty:function(){return 0===this.matrix[8]},add:function(){const e=new t(0,0),i=new t(0,0),n=new t(0,0),r=new t(0,0);return function(t){return this.isEmpty()?this.assign(t):t.isEmpty()?this:(this.getExtents(e,i),t.getExtents(n,r),this.set(e.min(n),i.max(r),!0))}}(),multLeft:function(e){return this.matrix.multLeft(e),this},multRight:function(e){return this.matrix.multRight(e),this},getExtents:function(e,t){this.getAbsoluteExtents(e,t),e.add(this.center),t.add(this.center)},getAbsoluteExtents:function(){const e=new t(0,0);return function(t,i){const n=this.matrix,r=n.xAxis,o=n.yAxis;e.assign(r).add(o);const s=o.subtract(r);t.assign(e).min(s),i.assign(e).max(s),e.negate(),s.negate(),t.min(e,s),i.max(e,s)}}(),containsPoint:function(){const e=new t(0,0),i=new t(0,0);return function(t){return this.getExtents(e,i),e.x<=t.x&&i.x>=t.x&&e.y<=t.y&&i.y>=t.y}}(),toString:function(){return this.size+", "+this.center}},Object.defineProperty(i.prototype,"size",{get:function(){const e=new t(0,0),i=new t(0,0);return function(){return this.getAbsoluteExtents(e,i),i.subtract(e)}}(),enumerable:!0,configurable:!1}),Object.defineProperty(i.prototype,"center",{get:function(){return this.matrix.origin},enumerable:!0,configurable:!1}),i}),define("x_ite/Browser/Text/X3DTextGeometry",["x_ite/Browser/Text/TextAlignment","standard/Math/Geometry/Box2","standard/Math/Geometry/Box3","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3"],function(e,t,i,n,r){"use strict";function o(e,t){this.text=e,this.fontStyle=t,this.glyphs=[],this.minorAlignment=new n(0,0),this.translations=[],this.charSpacings=[],this.bearing=new n(0,0),this.yPad=[],this.bbox=new i}var s=new t,a=new t,u=new n(0,0),l=new n(0,0),c=new n(0,0),h=new n(0,0),d=new r(0,0,0),p=new r(0,0,0),f=new n(0,0),g=new n(0,0),m=new n(0,0),y=new n(0,0),_=new n(0,0),x=new r(0,0,0),w=new n(0,0),b=new t,v=new n(0,0),S=new r(0,0,0);return o.prototype={constructor:o,getBrowser:function(){return this.text.getBrowser()},getText:function(){return this.text},getFontStyle:function(){return this.fontStyle},getGlyphs:function(){return this.glyphs},getMinorAlignment:function(){return this.minorAlignment},getTranslations:function(){return this.translations},getCharSpacings:function(){return this.charSpacings},getBearing:function(){return this.bearing},getBBox:function(){return this.bbox},update:function(){var e=this.text,t=this.fontStyle,i=e.string_.length;if(e.lineBounds_.length=i,this.glyphs.length=0,0===i||!t.getFont())return e.origin_.setValue(S),e.textBounds_.setValue(v),void this.bbox.set();if(t.horizontal_.getValue())this.resizeArray(this.translations,i),this.resizeArray(this.charSpacings,i),this.horizontal(e,t);else{for(var n=e.string_,r=0,o=0,s=n.length;o<s;++o)r+=n[o].length;this.resizeArray(this.translations,r),this.resizeArray(this.charSpacings,r),this.vertical(e,t)}},resizeArray:function(e,t){for(var i=e.length;i<t;++i)e.push(new n(0,0));e.length=t},horizontal:function(t,i){var n=i.getFont(),r=t.string_,o=r.length,a=Math.max(0,t.maxExtent_.getValue()),c=i.topToBottom_.getValue(),h=i.getScale(),y=i.spacing_.getValue();s.set();for(var w=c?0:o-1,v=c?o:-1,S=c?1:-1,T=w,C=0;T!==v;T+=S,++C){var F=r[T],O=this.getHorizontalLineExtents(i,F,u,l,C);f.assign(l).subtract(u);var N=0,E=t.getLength(T);switch(_.set(f.x*h,0==C?l.y-n.descender/n.unitsPerEm*h:y),a&&(E=E?Math.min(a,E):Math.min(a,f.x*h)),E&&(N=(E-_.x)/(O.length-1),_.x=E,f.x=E/h),this.charSpacings[C]=N,t.lineBounds_[T]=_,i.getMajorAlignment()){case e.BEGIN:case e.FIRST:this.translations[C].set(0,-C*y);break;case e.MIDDLE:this.translations[C].set(-u.x-f.x/2,-C*y);break;case e.END:this.translations[C].set(-u.x-f.x,-C*y)}this.translations[C].multiply(h),g.assign(u).add(m.assign(f).divide(2)),s.add(b.set(f.multiply(h),g.multiply(h).add(this.translations[C])))}switch(s.getExtents(u,l),f.assign(l).subtract(u),t.textBounds_=f,this.bearing.set(0,-l.y),i.getMinorAlignment()){case e.BEGIN:this.minorAlignment.assign(this.bearing);break;case e.FIRST:this.minorAlignment.set(0,0);break;case e.MIDDLE:this.minorAlignment.set(0,f.y/2-l.y);break;case e.END:this.minorAlignment.set(0,(o-1)*y*h)}u.add(this.minorAlignment),l.add(this.minorAlignment),t.origin_.setValue(x.set(u.x,l.y,0)),this.bbox.setExtents(d.set(u.x,u.y,0),p.set(l.x,l.y,0))},vertical:function(t,i){var r=i.getFont(),o=t.string_,h=o.length,v=Math.max(0,t.maxExtent_.getValue()),S=i.leftToRight_.getValue(),T=i.topToBottom_.getValue(),C=i.getScale(),F=i.spacing_.getValue(),O=this.yPad,N=this.getBrowser().getBrowserOptions().getPrimitiveQuality();s.set();for(var E=S?0:h-1,D=S?h:-1,M=S?1:-1,V=0,I=E;I!==D;I+=M){var B=this.stringToGlyphs(r,o[I],!0,I),A=V,P=B.length;a.set();for(var R=T?0:P-1,L=T?P:-1,k=T?1:-1,U=R;U!==L;U+=k,++V){var X=B[U];this.getGlyphExtents(r,X,N,u,l),f.assign(l).subtract(u);var z=T?U:P-U-1;this.translations[V].set((F-f.x-u.x)/2,-z),g.assign(u).add(m.assign(f).divide(2)).add(this.translations[V]),a.add(b.set(f,g))}a.getExtents(u,l),f.assign(l).subtract(u);var j=S?I:h-I-1,G=(F-f.x)/2,q=0,H=t.getLength(I);switch(_.set(0===I?F-G:F,P?f.y:0).multiply(C),v&&(H=H?Math.min(v,H):Math.min(v,f.y*C)),H&&(q=(H-_.y)/(B.length-1)/C,_.y=H,f.y=H/C,u.y=l.y-f.y),t.lineBounds_[I]=_,i.getMajorAlignment()){case e.BEGIN:case e.FIRST:y.set(j*F,-1);break;case e.MIDDLE:y.set(j*F,f.y/2-l.y);break;case e.END:P&&this.getGlyphExtents(r,B[T?P-1:0],N,c.assign(n.Zero),w),y.set(j*F,f.y-l.y+c.y)}for(var W=0,Y=A;Y<V;++Y)this.translations[Y].add(y),this.translations[Y].y-=W,this.translations[Y].multiply(C),W+=q;switch(i.getMajorAlignment()){case e.BEGIN:case e.FIRST:O[I]=l.y+y.y;break;case e.MIDDLE:O[I]=0;break;case e.END:O[I]=u.y+y.y}g.assign(u).add(m.assign(f).divide(2)),s.add(b.set(f.multiply(C),g.add(y).multiply(C)))}switch(s.getExtents(u,l),f.assign(l).subtract(u),i.getMajorAlignment()){case e.BEGIN:case e.FIRST:for(var $=t.lineBounds_,Z=0,H=$.length;Z<H;++Z)$[Z].y+=l.y-O[Z]*C;break;case e.MIDDLE:break;case e.END:for(var $=t.lineBounds_,Z=0,H=$.length;Z<H;++Z)$[Z].y+=O[Z]*C-u.y}switch(t.textBounds_=f,i.getMajorAlignment()){case e.BEGIN:case e.FIRST:this.bearing.set(-u.x,l.y);break;case e.MIDDLE:this.bearing.set(-u.x,0);break;case e.END:this.bearing.set(-u.x,u.y)}switch(i.getMinorAlignment()){case e.BEGIN:case e.FIRST:this.minorAlignment.set(-u.x,0);break;case e.MIDDLE:this.minorAlignment.set(-u.x-f.x/2,0);break;case e.END:this.minorAlignment.set(-u.x-f.x,0)}u.add(this.minorAlignment),l.add(this.minorAlignment),t.origin_.setValue(x.set(u.x,l.y,0)),this.bbox.set(d.set(u.x,u.y,0),p.set(l.x,l.y,0),!0)},stringToGlyphs:function(e,t,i,n){var r=this.glyphs[n];r||(r=this.glyphs[n]=[]),r.length=t.length;for(var o=i?0:t.length-1,s=i?t.length:-1,a=i?1:-1,u=o,l=0;u!==s;u+=a,++l)r[l]=e.charToGlyph(t[u]);return r},getHorizontalLineExtents:function(t,i,n,r,o){for(var s=t.getFont(),a=t.horizontal_.getValue()?t.leftToRight_.getValue():t.topToBottom_.getValue(),u=this.stringToGlyphs(s,i,a,o),l=this.getBrowser().getBrowserOptions().getPrimitiveQuality(),d=0,p=0,f=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY,m=0,y=u.length;m<y;++m){var _=u[m],x=m+1<y?s.getKerningValue(_,u[m+1]):0;this.getGlyphExtents(s,_,l,c,h),p+=_.advanceWidth+x,f=Math.min(f,c.y),g=Math.max(g,h.y)}switch(u.length?(this.getGlyphExtents(s,u[0],l,c,h),d=c.x):(f=0,g=0),n.set(d,f),r.set(p/s.unitsPerEm,g),t.getMajorAlignment()){case e.BEGIN:case e.FIRST:n.x=0}return u},traverse:function(e,t){}},o}),define("standard/Math/Algorithms/Bezier",["standard/Math/Algorithm"],function(e){"use strict";function t(e,t,i,n,r,o,s,a){this.x0=e,this.y0=t,this.x1=i,this.y1=n,this.x2=r,this.y2=o,this.x3=s,this.y3=a,this.order=arguments.length/2-1}function i(e,t,i,n,o,s,a){const u=r(e,i,a),l=r(t,n,a),c=r(i,o,a),h=r(n,s,a);return{x:r(u,c,a),y:r(l,h,a)}}function n(e,t,i,n,o,s,a,u,l){const c=r(e,i,l),h=r(t,n,l),d=r(i,o,l),p=r(n,s,l),f=r(o,a,l),g=r(s,u,l),m=r(c,d,l),y=r(h,p,l),_=r(d,f,l),x=r(p,g,l);return{x:r(m,_,l),y:r(y,x,l)}}const r=e.lerp;return t.prototype={getLUT:function(e){const t=this.x0,r=this.y0,o=this.x1,s=this.y1,a=this.x2,u=this.y2,l=this.x3,c=this.y3,h=[];switch(this.order){case 2:for(let n=0,l=e-1;n<e;++n)h.push(i(t,r,o,s,a,u,n/l));break;case 3:for(let i=0,d=e-1;i<e;++i)h.push(n(t,r,o,s,a,u,l,c,i/d))}return h}},t}),define("x_ite/Browser/Text/PolygonText",["x_ite/Browser/Core/PrimitiveQuality","x_ite/Browser/Text/X3DTextGeometry","x_ite/Components/Rendering/X3DGeometryNode","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Triangle3","standard/Math/Algorithms/Bezier"],function(e,t,i,n,r,o,s){"use strict";function a(e,n){t.call(this,e,n),e.transparent_=!1,this.texCoordArray=i.createArray()}return a.prototype=Object.assign(Object.create(t.prototype),{constructor:a,getTransparent:function(){return!1},getMatrix:function(){return r.Identity},build:function(){var e=new n(0,0,0),t=new n(0,0,0);return function(){var i=this.getFontStyle(),n=i.getFont();if(n){var r=this.getText(),o=this.getGlyphs(),s=this.getMinorAlignment(),a=this.getTranslations(),u=this.getCharSpacings(),l=i.getScale(),c=i.spacing_.getValue(),h=r.origin_.getValue(),d=l/n.unitsPerEm,p=this.getBrowser().getBrowserOptions().getPrimitiveQuality(),f=this.texCoordArray,g=r.getNormals(),m=r.getVertices();if(r.getMultiTexCoords().push(f),this.getBBox().getExtents(e,t),r.getMin().assign(e),r.getMax().assign(t),i.horizontal_.getValue())for(var y=0,_=o.length;y<_;++y)for(var x=o[y],w=u[y],b=a[y],v=0,S=0,T=x.length;S<T;++S){for(var C=x[S],F=this.getGlyphGeometry(n,C,p),O=s.x+b.x+v+S*w,N=s.y+b.y,E=0,D=F.length;E<D;++E){var M=F[E].x*l+O,V=F[E].y*l+N;f.push((M-h.x)/c,(V-h.y)/c,0,1),g.push(0,0,1),m.push(M,V,0,1)}var I=0;S+1<x.length&&(I=n.getKerningValue(C,x[S+1])),v+=(C.advanceWidth+I)*d}else for(var B=i.leftToRight_.getValue(),A=i.topToBottom_.getValue(),P=B?0:r.string_.length-1,R=B?r.string_.length:-1,L=B?1:-1,y=P,k=0;y!==R;y+=L)for(var x=o[y],U=x.length,X=A?0:U-1,z=A?U:-1,j=A?1:-1,S=X;S!==z;S+=j,++k)for(var b=a[k],F=this.getGlyphGeometry(n,x[S],p),E=0,D=F.length;E<D;++E){var M=F[E].x*l+s.x+b.x,V=F[E].y*l+s.y+b.y;f.push((M-h.x)/c,(V-h.y)/c,0,1),g.push(0,0,1),m.push(M,V,0,1)}}}}(),getGlyphExtents:function(e,t,i,n,r){var o=this.getBrowser().getGlyph(e,i,t.index),s=o.extents;if(s)return n.assign(s.min),void r.assign(s.max);var a=this.getGlyphGeometry(e,t,i);if(a.length){var u=a[0];n.assign(u),r.assign(u);for(var l=1,c=a.length;l<c;++l){var u=a[l];n.min(u),r.max(u)}}else n.set(0,0,0),r.set(0,0,0);var s=o.extents={};s.min=n.copy(),s.max=r.copy()},getGlyphGeometry:function(e,t,i){var n=this.getBrowser().getGlyph(e,i,t.index),r=n.geometry;return r?r:(r=n.geometry=[],this.createGlyphGeometry(t,r,i),r)},createGlyphGeometry:function(){var e=[],t=[],i=new n(0,0,0);return function(r,a,u){var l=this.getBezierDimension(u),c=r.getPath(0,0,1),h=c.commands,d=0,p=0;e.length=0,t.length=0;for(var f=0,g=h.length;f<g;++f){var m=h[f];switch(m.type){case"M":case"Z":e.length>2&&(e[0].x===e.at(-1).x&&e[0].y===e.at(-1).y&&e.pop(),t.push(e)),e=[],"M"===m.type&&e.push(new n(m.x,-m.y,0));break;case"L":e.push(new n(m.x,-m.y,0));break;case"Q":for(var y=new s(d,-p,m.x1,-m.y1,m.x,-m.y),_=y.getLUT(l),x=1,w=_.length;x<w;++x)e.push(new n(_[x].x,_[x].y,0));break;case"C":for(var y=new s(d,-p,m.x1,-m.y1,m.x2,-m.y2,m.x,-m.y),_=y.getLUT(l),x=1,w=_.length;x<w;++x)e.push(new n(_[x].x,_[x].y,0));break;default:continue}d=m.x,p=m.y}t=t.map(function(e){return o.getPolygonNormal(e,i),i.dot(n.zAxis)>0?e:e.reverse()}),t.push(a),o.triangulatePolygon.apply(o,t)}}(),getBezierDimension:function(t){switch(t){case e.LOW:return 3;case e.HIGH:return 7;default:return 5}},display:function(e,t){},transformLine:function(e){},transformMatrix:function(e){}}),a}),define("x_ite/Components/Text/FontStyle",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Text/X3DFontStyleNode","x_ite/Browser/Text/PolygonText","x_ite/Base/X3DConstants"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),this.addType(o.FontStyle),this.size_.setUnit("length")}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOutput,"language",new e.SFString),new t(o.inputOutput,"family",new e.MFString("SERIF")),new t(o.inputOutput,"style",new e.SFString("PLAIN")),new t(o.inputOutput,"size",new e.SFFloat(1)),new t(o.inputOutput,"spacing",new e.SFFloat(1)),new t(o.inputOutput,"horizontal",new e.SFBool(!0)),new t(o.inputOutput,"leftToRight",new e.SFBool(!0)),new t(o.inputOutput,"topToBottom",new e.SFBool(!0)),new t(o.inputOutput,"justify",new e.MFString("BEGIN"))]),getTypeName:function(){return"FontStyle"},getComponentName:function(){return"Text"},getContainerField:function(){return"fontStyle"},getTextGeometry:function(e){return new r(e,this)},getScale:function(){return this.size_.getValue()}}),s}),function(e,t){"function"==typeof define&&define.amd?define("opentype/dist/opentype",["exports"],t):(e=e||self,t(e.opentype={}))}(this,function(e){"use strict";function t(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}function i(e,i){this.source=e,this.sourceIndex=0,this.tag=0,this.bitcount=0,this.dest=i,this.destLen=0,this.ltree=new t,this.dtree=new t}function n(e,t,i,n){var r,o;for(r=0;r<i;++r)e[r]=0;for(r=0;r<30-i;++r)e[r+i]=r/i|0;for(o=n,r=0;r<30;++r)t[r]=o,o+=1<<e[r]}function r(e,t,i,n){var r,o;for(r=0;r<16;++r)e.table[r]=0;for(r=0;r<n;++r)e.table[t[i+r]]++;for(e.table[0]=0,o=0,r=0;r<16;++r)vo[r]=o,o+=e.table[r];for(r=0;r<n;++r)t[i+r]&&(e.trans[vo[t[i+r]]++]=r)}function o(e){e.bitcount--||(e.tag=e.source[e.sourceIndex++],e.bitcount=7);var t=1&e.tag;return e.tag>>>=1,t}function s(e,t,i){if(!t)return i;for(;e.bitcount<24;)e.tag|=e.source[e.sourceIndex++]<<e.bitcount,e.bitcount+=8;var n=e.tag&65535>>>16-t;return e.tag>>>=t,e.bitcount-=t,n+i}function a(e,t){for(;e.bitcount<24;)e.tag|=e.source[e.sourceIndex++]<<e.bitcount,e.bitcount+=8;var i=0,n=0,r=0,o=e.tag;do n=2*n+(1&o),o>>>=1,++r,i+=t.table[r],n-=t.table[r];while(n>=0)return e.tag=o,e.bitcount-=r,t.trans[i+n]}function u(e,t,i){var n,o,u,l,c,h;for(n=s(e,5,257),o=s(e,5,1),u=s(e,4,4),l=0;l<19;++l)bo[l]=0;for(l=0;l<u;++l){var d=s(e,3,0);bo[xo[l]]=d}for(r(wo,bo,0,19),c=0;c<n+o;){var p=a(e,wo);switch(p){case 16:var f=bo[c-1];for(h=s(e,2,3);h;--h)bo[c++]=f;break;case 17:for(h=s(e,3,3);h;--h)bo[c++]=0;break;case 18:for(h=s(e,7,11);h;--h)bo[c++]=0;break;default:bo[c++]=p}}r(t,bo,0,n),r(i,bo,n,o)}function l(e,t,i){for(;;){var n=a(e,t);if(256===n)return co;if(n<256)e.dest[e.destLen++]=n;else{var r,o,u,l;for(n-=257,r=s(e,go[n],mo[n]),o=a(e,i),u=e.destLen-s(e,yo[o],_o[o]),l=u;l<u+r;++l)e.dest[e.destLen++]=e.dest[l]}}}function c(e){for(var t,i,n;e.bitcount>8;)e.sourceIndex--,e.bitcount-=8;if(t=e.source[e.sourceIndex+1],t=256*t+e.source[e.sourceIndex],i=e.source[e.sourceIndex+3],i=256*i+e.source[e.sourceIndex+2],t!==(65535&~i))return ho;for(e.sourceIndex+=4,n=t;n;--n)e.dest[e.destLen++]=e.source[e.sourceIndex++];return e.bitcount=0,co}function h(e,t){var n,r,a=new i(e,t);do{switch(n=o(a),s(a,2,0)){case 0:r=c(a);break;case 1:r=l(a,po,fo);break;case 2:u(a,a.ltree,a.dtree),r=l(a,a.ltree,a.dtree);break;default:r=ho}if(r!==co)throw new Error("Data error")}while(!n)return a.destLen<a.dest.length?"function"==typeof a.dest.slice?a.dest.slice(0,a.destLen):a.dest.subarray(0,a.destLen):a.dest}function d(e,t,i,n,r){return Math.pow(1-r,3)*e+3*Math.pow(1-r,2)*r*t+3*(1-r)*Math.pow(r,2)*i+Math.pow(r,3)*n}function p(){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN}function f(){this.commands=[],this.fill="black",this.stroke=null,this.strokeWidth=1}function g(e){throw new Error(e)}function m(e,t){e||g(t)}function y(e){return function(){return e}}function _(e){return e>=-128&&e<=127}function x(e,t,i){for(var n=0,r=e.length;t<r&&n<64&&0===e[t];)++t,++n;return i.push(128|n-1),t}function w(e,t,i){for(var n=0,r=e.length,o=t;o<r&&n<64;){var s=e[o];if(!_(s))break;if(0===s&&o+1<r&&0===e[o+1])break;++o,++n}i.push(n-1);for(var a=t;a<o;++a)i.push(e[a]+256&255);return o}function b(e,t,i){for(var n=0,r=e.length,o=t;o<r&&n<64;){var s=e[o];if(0===s)break;if(_(s)&&o+1<r&&_(e[o+1]))break;++o,++n}i.push(64|n-1);for(var a=t;a<o;++a){var u=e[a];i.push(u+65536>>8&255,u+256&255)}return o}function v(e,t,i){if(t.length&&("coverageFormat"!==t[0].name||1===t[0].value))for(var n=0;n<t.length;n+=1){var r=t[n];this[r.name]=r.value}if(this.tableName=e,this.fields=t,i)for(var o=Object.keys(i),s=0;s<o.length;s+=1){var a=o[s],u=i[a];void 0!==this[a]&&(this[a]=u)}}function S(e,t,i){void 0===i&&(i=t.length);var n=new Array(t.length+1);n[0]={name:e+"Count",type:"USHORT",value:i};for(var r=0;r<t.length;r++)n[r+1]={name:e+r,type:"USHORT",value:t[r]};return n}function T(e,t,i){var n=t.length,r=new Array(n+1);r[0]={name:e+"Count",type:"USHORT",value:n};for(var o=0;o<n;o++)r[o+1]={name:e+o,type:"TABLE",value:i(t[o],o)};return r}function C(e,t,i){var n=t.length,r=[];r[0]={name:e+"Count",type:"USHORT",value:n};for(var o=0;o<n;o++)r=r.concat(i(t[o],o));return r}function F(e){1===e.format?v.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:1}].concat(S("glyph",e.glyphs))):2===e.format?v.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:2}].concat(C("rangeRecord",e.ranges,function(e){return[{name:"startGlyphID",type:"USHORT",value:e.start},{name:"endGlyphID",type:"USHORT",value:e.end},{name:"startCoverageIndex",type:"USHORT",value:e.index}]}))):To.assert(!1,"Coverage format must be 1 or 2.")}function O(e){v.call(this,"scriptListTable",C("scriptRecord",e,function(e,t){var i=e.script,n=i.defaultLangSys;return To.assert(!!n,"Unable to write GSUB: script "+e.tag+" has no default language system."),[{name:"scriptTag"+t,type:"TAG",value:e.tag},{name:"script"+t,type:"TABLE",value:new v("scriptTable",[{name:"defaultLangSys",type:"TABLE",value:new v("defaultLangSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:n.reqFeatureIndex}].concat(S("featureIndex",n.featureIndexes)))}].concat(C("langSys",i.langSysRecords,function(e,t){var i=e.langSys;return[{name:"langSysTag"+t,type:"TAG",value:e.tag},{name:"langSys"+t,type:"TABLE",value:new v("langSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:i.reqFeatureIndex}].concat(S("featureIndex",i.featureIndexes)))}]})))}]}))}function N(e){v.call(this,"featureListTable",C("featureRecord",e,function(e,t){var i=e.feature;return[{name:"featureTag"+t,type:"TAG",value:e.tag},{name:"feature"+t,type:"TABLE",value:new v("featureTable",[{name:"featureParams",type:"USHORT",value:i.featureParams}].concat(S("lookupListIndex",i.lookupListIndexes)))}]}))}function E(e,t){v.call(this,"lookupListTable",T("lookup",e,function(e){var i=t[e.lookupType];return To.assert(!!i,"Unable to write GSUB lookup type "+e.lookupType+" tables."),new v("lookupTable",[{name:"lookupType",type:"USHORT",value:e.lookupType},{name:"lookupFlag",type:"USHORT",value:e.lookupFlag}].concat(T("subtable",e.subtables,i)))}))}function D(e,t){return e.getUint8(t)}function M(e,t){return e.getUint16(t,!1)}function V(e,t){return e.getInt16(t,!1)}function I(e,t){return e.getUint32(t,!1)}function B(e,t){return e.getInt16(t,!1)+e.getUint16(t+2,!1)/65535}function A(e,t){for(var i="",n=t;n<t+4;n+=1)i+=String.fromCharCode(e.getInt8(n));return i}function P(e,t,i){for(var n=0,r=0;r<i;r+=1)n<<=8,n+=e.getUint8(t+r);return n}function R(e,t,i){for(var n=[],r=t;r<i;r+=1)n.push(e.getUint8(r));return n}function L(e){for(var t="",i=0;i<e.length;i+=1)t+=String.fromCharCode(e[i]);return t}function k(e,t){this.data=e,this.offset=t,this.relativeOffset=0}function U(e,t){t.parseUShort(),e.length=t.parseULong(),e.language=t.parseULong();var i;e.groupCount=i=t.parseULong(),e.glyphIndexMap={};for(var n=0;n<i;n+=1)for(var r=t.parseULong(),o=t.parseULong(),s=t.parseULong(),a=r;a<=o;a+=1)e.glyphIndexMap[a]=s,s++}function X(e,t,i,n,r){e.length=t.parseUShort(),e.language=t.parseUShort();var o;e.segCount=o=t.parseUShort()>>1,t.skip("uShort",3),e.glyphIndexMap={};for(var s=new Po.Parser(i,n+r+14),a=new Po.Parser(i,n+r+16+2*o),u=new Po.Parser(i,n+r+16+4*o),l=new Po.Parser(i,n+r+16+6*o),c=n+r+16+8*o,h=0;h<o-1;h+=1)for(var d=void 0,p=s.parseUShort(),f=a.parseUShort(),g=u.parseShort(),m=l.parseUShort(),y=f;y<=p;y+=1)0!==m?(c=l.offset+l.relativeOffset-2,c+=m,c+=2*(y-f),0!==(d=Po.getUShort(i,c))&&(d=d+g&65535)):d=y+g&65535,e.glyphIndexMap[y]=d}function z(e,t){var i={};i.version=Po.getUShort(e,t),To.argument(0===i.version,"cmap table version should be 0."),i.numTables=Po.getUShort(e,t+2);for(var n=-1,r=i.numTables-1;r>=0;r-=1){var o=Po.getUShort(e,t+4+8*r),s=Po.getUShort(e,t+4+8*r+2);if(3===o&&(0===s||1===s||10===s)||0===o&&(0===s||1===s||2===s||3===s||4===s)){n=Po.getULong(e,t+4+8*r+4);break}}if(n===-1)throw new Error("No valid cmap sub-tables found.");var a=new Po.Parser(e,t+n);if(i.format=a.parseUShort(),12===i.format)U(i,a);else{if(4!==i.format)throw new Error("Only format 4 and 12 cmap tables are supported (found format "+i.format+").");X(i,a,e,t,n)}return i}function j(e,t,i){e.segments.push({end:t,start:t,delta:-(t-i),offset:0,glyphIndex:i})}function G(e){e.segments.push({end:65535,start:65535,delta:1,offset:0})}function q(e){var t,i=!0;for(t=e.length-1;t>0;t-=1){if(e.get(t).unicode>65535){console.log("Adding CMAP format 12 (needed!)"),i=!1;break}}var n=[{name:"version",type:"USHORT",value:0},{name:"numTables",type:"USHORT",value:i?1:2},{name:"platformID",type:"USHORT",value:3},{name:"encodingID",type:"USHORT",value:1},{name:"offset",type:"ULONG",value:i?12:20}];i||(n=n.concat([{name:"cmap12PlatformID",type:"USHORT",value:3},{name:"cmap12EncodingID",type:"USHORT",value:10},{name:"cmap12Offset",type:"ULONG",value:0}])),n=n.concat([{name:"format",type:"USHORT",value:4},{name:"cmap4Length",type:"USHORT",value:0},{name:"language",type:"USHORT",value:0},{name:"segCountX2",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);var r=new Io.Table("cmap",n);for(r.segments=[],t=0;t<e.length;t+=1){for(var o=e.get(t),s=0;s<o.unicodes.length;s+=1)j(r,o.unicodes[s],t);r.segments=r.segments.sort(function(e,t){return e.start-t.start})}G(r);var a=r.segments.length,u=0,l=[],c=[],h=[],d=[],p=[],f=[];for(t=0;t<a;t+=1){var g=r.segments[t];g.end<=65535&&g.start<=65535?(l=l.concat({name:"end_"+t,type:"USHORT",value:g.end}),c=c.concat({name:"start_"+t,type:"USHORT",value:g.start}),h=h.concat({name:"idDelta_"+t,type:"SHORT",value:g.delta}),d=d.concat({name:"idRangeOffset_"+t,type:"USHORT",value:g.offset}),void 0!==g.glyphId&&(p=p.concat({name:"glyph_"+t,type:"USHORT",value:g.glyphId}))):u+=1,i||void 0===g.glyphIndex||(f=f.concat({name:"cmap12Start_"+t,type:"ULONG",value:g.start}),f=f.concat({name:"cmap12End_"+t,type:"ULONG",value:g.end}),f=f.concat({name:"cmap12Glyph_"+t,type:"ULONG",value:g.glyphIndex}))}if(r.segCountX2=2*(a-u),r.searchRange=2*Math.pow(2,Math.floor(Math.log(a-u)/Math.log(2))),r.entrySelector=Math.log(r.searchRange/2)/Math.log(2),r.rangeShift=r.segCountX2-r.searchRange,r.fields=r.fields.concat(l),r.fields.push({name:"reservedPad",type:"USHORT",value:0}),r.fields=r.fields.concat(c),r.fields=r.fields.concat(h),r.fields=r.fields.concat(d),r.fields=r.fields.concat(p),r.cmap4Length=14+2*l.length+2+2*c.length+2*h.length+2*d.length+2*p.length,!i){var m=16+4*f.length;r.cmap12Offset=20+r.cmap4Length,r.fields=r.fields.concat([{name:"cmap12Format",type:"USHORT",value:12},{name:"cmap12Reserved",type:"USHORT",value:0},{name:"cmap12Length",type:"ULONG",value:m},{name:"cmap12Language",type:"ULONG",value:0},{name:"cmap12nGroups",type:"ULONG",value:f.length/3}]),r.fields=r.fields.concat(f)}return r}function H(e){this.font=e}function W(e){this.cmap=e}function Y(e,t){this.encoding=e,this.charset=t}function $(e){switch(e.version){case 1:this.names=Xo.slice();break;case 2:this.names=new Array(e.numberOfGlyphs);for(var t=0;t<e.numberOfGlyphs;t++)e.glyphNameIndex[t]<Xo.length?this.names[t]=Xo[e.glyphNameIndex[t]]:this.names[t]=e.names[e.glyphNameIndex[t]-Xo.length];break;case 2.5:this.names=new Array(e.numberOfGlyphs);for(var i=0;i<e.numberOfGlyphs;i++)this.names[i]=Xo[i+e.glyphNameIndex[i]];break;case 3:this.names=[];break;default:this.names=[]}}function Z(e){for(var t,i=e.tables.cmap.glyphIndexMap,n=Object.keys(i),r=0;r<n.length;r+=1){var o=n[r],s=i[o];t=e.glyphs.get(s),t.addUnicode(parseInt(o))}for(var a=0;a<e.glyphs.length;a+=1)t=e.glyphs.get(a),e.cffEncoding?e.isCIDFont?t.name="gid"+a:t.name=e.cffEncoding.charset[a]:e.glyphNames.names&&(t.name=e.glyphNames.glyphIndexToName(a))}function K(e){e._IndexToUnicodeMap={};for(var t=e.tables.cmap.glyphIndexMap,i=Object.keys(t),n=0;n<i.length;n+=1){var r=i[n],o=t[r];void 0===e._IndexToUnicodeMap[o]?e._IndexToUnicodeMap[o]={unicodes:[parseInt(r)]}:e._IndexToUnicodeMap[o].unicodes.push(parseInt(r))}}function Q(e,t){t.lowMemory?K(e):Z(e)}function J(e,t,i,n,r){e.beginPath(),e.moveTo(t,i),e.lineTo(n,r),e.stroke()}function ee(e,t){var i=t||new f;return{configurable:!0,get:function(){return"function"==typeof i&&(i=i()),i},set:function(e){i=e}}}function te(e){this.bindConstructorValues(e)}function ie(e,t,i){Object.defineProperty(e,t,{get:function(){return e.path,e[i]},set:function(t){e[i]=t},enumerable:!0,configurable:!0})}function ne(e,t){if(this.font=e,this.glyphs={},Array.isArray(t))for(var i=0;i<t.length;i++){var n=t[i];n.path.unitsPerEm=e.unitsPerEm,this.glyphs[i]=n}this.length=t&&t.length||0}function re(e,t){return new te({index:t,font:e})}function oe(e,t,i,n,r,o){return function(){var s=new te({index:t,font:e});return s.path=function(){i(s,n,r);var t=o(e.glyphs,s);return t.unitsPerEm=e.unitsPerEm,t},ie(s,"xMin","_xMin"),ie(s,"xMax","_xMax"),ie(s,"yMin","_yMin"),ie(s,"yMax","_yMax"),s}}function se(e,t,i,n){return function(){var r=new te({index:t,font:e});return r.path=function(){var t=i(e,r,n);return t.unitsPerEm=e.unitsPerEm,t},r}}function ae(e,t){if(e===t)return!0;if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(var i=0;i<e.length;i+=1)if(!ae(e[i],t[i]))return!1;return!0}return!1}function ue(e){return e.length<1240?107:e.length<33900?1131:32768}function le(e,t,i){var n,r,o=[],s=[],a=Po.getCard16(e,t);if(0!==a){var u=Po.getByte(e,t+2);n=t+(a+1)*u+2;for(var l=t+3,c=0;c<a+1;c+=1)o.push(Po.getOffset(e,l,u)),l+=u;r=n+o[a]}else r=t+2;for(var h=0;h<o.length-1;h+=1){var d=Po.getBytes(e,n+o[h],n+o[h+1]);i&&(d=i(d)),s.push(d)}return{objects:s,startOffset:t,endOffset:r}}function ce(e,t){var i,n,r=[],o=Po.getCard16(e,t);if(0!==o){var s=Po.getByte(e,t+2);i=t+(o+1)*s+2;for(var a=t+3,u=0;u<o+1;u+=1)r.push(Po.getOffset(e,a,s)),a+=s;n=i+r[o]}else n=t+2;return{offsets:r,startOffset:t,endOffset:n}}function he(e,t,i,n,r){var o=Po.getCard16(i,n),s=0;if(0!==o){s=n+(o+1)*Po.getByte(i,n+2)+2}var a=Po.getBytes(i,s+t[e],s+t[e+1]);return r&&(a=r(a)),a}function de(e){for(var t="",i=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"];;){
var n=e.parseByte(),r=n>>4,o=15&n;if(15===r)break;if(t+=i[r],15===o)break;t+=i[o]}return parseFloat(t)}function pe(e,t){var i,n,r,o;if(28===t)return i=e.parseByte(),n=e.parseByte(),i<<8|n;if(29===t)return i=e.parseByte(),n=e.parseByte(),r=e.parseByte(),o=e.parseByte(),i<<24|n<<16|r<<8|o;if(30===t)return de(e);if(t>=32&&t<=246)return t-139;if(t>=247&&t<=250)return i=e.parseByte(),256*(t-247)+i+108;if(t>=251&&t<=254)return i=e.parseByte(),256*-(t-251)-i-108;throw new Error("Invalid b0 "+t)}function fe(e){for(var t={},i=0;i<e.length;i+=1){var n=e[i][0],r=e[i][1],o=void 0;if(o=1===r.length?r[0]:r,t.hasOwnProperty(n)&&!isNaN(t[n]))throw new Error("Object "+t+" already has key "+n);t[n]=o}return t}function ge(e,t,i){t=void 0!==t?t:0;var n=new Po.Parser(e,t),r=[],o=[];for(i=void 0!==i?i:e.length;n.relativeOffset<i;){var s=n.parseByte();s<=21?(12===s&&(s=1200+n.parseByte()),r.push([s,o]),o=[]):o.push(pe(n,s))}return fe(r)}function me(e,t){return t=t<=390?Lo[t]:e[t-391]}function ye(e,t,i){for(var n,r={},o=0;o<t.length;o+=1){var s=t[o];if(Array.isArray(s.type)){var a=[];a.length=s.type.length;for(var u=0;u<s.type.length;u++)n=void 0!==e[s.op]?e[s.op][u]:void 0,void 0===n&&(n=void 0!==s.value&&void 0!==s.value[u]?s.value[u]:null),"SID"===s.type[u]&&(n=me(i,n)),a[u]=n;r[s.name]=a}else n=e[s.op],void 0===n&&(n=void 0!==s.value?s.value:null),"SID"===s.type&&(n=me(i,n)),r[s.name]=n}return r}function _e(e,t){var i={};return i.formatMajor=Po.getCard8(e,t),i.formatMinor=Po.getCard8(e,t+1),i.size=Po.getCard8(e,t+2),i.offsetSize=Po.getCard8(e,t+3),i.startOffset=t,i.endOffset=t+4,i}function xe(e,t){return ye(ge(e,0,e.byteLength),Go,t)}function we(e,t,i,n){return ye(ge(e,t,i),qo,n)}function be(e,t,i,n){for(var r=[],o=0;o<i.length;o+=1){var s=new DataView(new Uint8Array(i[o]).buffer),a=xe(s,n);a._subrs=[],a._subrsBias=0,a._defaultWidthX=0,a._nominalWidthX=0;var u=a.private[0],l=a.private[1];if(0!==u&&0!==l){var c=we(e,l+t,u,n);if(a._defaultWidthX=c.defaultWidthX,a._nominalWidthX=c.nominalWidthX,0!==c.subrs){var h=l+c.subrs,d=le(e,h+t);a._subrs=d.objects,a._subrsBias=ue(a._subrs)}a._privateDict=c}r.push(a)}return r}function ve(e,t,i,n){var r,o,s=new Po.Parser(e,t);i-=1;var a=[".notdef"],u=s.parseCard8();if(0===u)for(var l=0;l<i;l+=1)r=s.parseSID(),a.push(me(n,r));else if(1===u)for(;a.length<=i;){r=s.parseSID(),o=s.parseCard8();for(var c=0;c<=o;c+=1)a.push(me(n,r)),r+=1}else{if(2!==u)throw new Error("Unknown charset format "+u);for(;a.length<=i;){r=s.parseSID(),o=s.parseCard16();for(var h=0;h<=o;h+=1)a.push(me(n,r)),r+=1}}return a}function Se(e,t,i){var n,r={},o=new Po.Parser(e,t),s=o.parseCard8();if(0===s)for(var a=o.parseCard8(),u=0;u<a;u+=1)n=o.parseCard8(),r[n]=u;else{if(1!==s)throw new Error("Unknown encoding format "+s);var l=o.parseCard8();n=1;for(var c=0;c<l;c+=1)for(var h=o.parseCard8(),d=o.parseCard8(),p=h;p<=h+d;p+=1)r[p]=n,n+=1}return new Y(r,i)}function Te(e,t,i){function n(e,t){x&&g.closePath(),g.moveTo(e,t),x=!0}function r(){var e;e=m.length%2!=0,e&&!_&&(T=m.shift()+p),y+=m.length>>1,m.length=0,_=!0}function o(i){for(var d,f,v,S,C,F,O,N,E,D,M,V,I=0;I<i.length;){var B=i[I];switch(I+=1,B){case 1:r();break;case 3:r();break;case 4:m.length>1&&!_&&(T=m.shift()+p,_=!0),b+=m.pop(),n(w,b);break;case 5:for(;m.length>0;)w+=m.shift(),b+=m.shift(),g.lineTo(w,b);break;case 6:for(;m.length>0&&(w+=m.shift(),g.lineTo(w,b),0!==m.length);)b+=m.shift(),g.lineTo(w,b);break;case 7:for(;m.length>0&&(b+=m.shift(),g.lineTo(w,b),0!==m.length);)w+=m.shift(),g.lineTo(w,b);break;case 8:for(;m.length>0;)s=w+m.shift(),a=b+m.shift(),u=s+m.shift(),l=a+m.shift(),w=u+m.shift(),b=l+m.shift(),g.curveTo(s,a,u,l,w,b);break;case 10:C=m.pop()+h,F=c[C],F&&o(F);break;case 11:return;case 12:switch(B=i[I],I+=1,B){case 35:s=w+m.shift(),a=b+m.shift(),u=s+m.shift(),l=a+m.shift(),O=u+m.shift(),N=l+m.shift(),E=O+m.shift(),D=N+m.shift(),M=E+m.shift(),V=D+m.shift(),w=M+m.shift(),b=V+m.shift(),m.shift(),g.curveTo(s,a,u,l,O,N),g.curveTo(E,D,M,V,w,b);break;case 34:s=w+m.shift(),a=b,u=s+m.shift(),l=a+m.shift(),O=u+m.shift(),N=l,E=O+m.shift(),D=l,M=E+m.shift(),V=b,w=M+m.shift(),g.curveTo(s,a,u,l,O,N),g.curveTo(E,D,M,V,w,b);break;case 36:s=w+m.shift(),a=b+m.shift(),u=s+m.shift(),l=a+m.shift(),O=u+m.shift(),N=l,E=O+m.shift(),D=l,M=E+m.shift(),V=D+m.shift(),w=M+m.shift(),g.curveTo(s,a,u,l,O,N),g.curveTo(E,D,M,V,w,b);break;case 37:s=w+m.shift(),a=b+m.shift(),u=s+m.shift(),l=a+m.shift(),O=u+m.shift(),N=l+m.shift(),E=O+m.shift(),D=N+m.shift(),M=E+m.shift(),V=D+m.shift(),Math.abs(M-w)>Math.abs(V-b)?w=M+m.shift():b=V+m.shift(),g.curveTo(s,a,u,l,O,N),g.curveTo(E,D,M,V,w,b);break;default:console.log("Glyph "+t.index+": unknown operator 1200"+B),m.length=0}break;case 14:m.length>0&&!_&&(T=m.shift()+p,_=!0),x&&(g.closePath(),x=!1);break;case 18:r();break;case 19:case 20:r(),I+=y+7>>3;break;case 21:m.length>2&&!_&&(T=m.shift()+p,_=!0),b+=m.pop(),w+=m.pop(),n(w,b);break;case 22:m.length>1&&!_&&(T=m.shift()+p,_=!0),w+=m.pop(),n(w,b);break;case 23:r();break;case 24:for(;m.length>2;)s=w+m.shift(),a=b+m.shift(),u=s+m.shift(),l=a+m.shift(),w=u+m.shift(),b=l+m.shift(),g.curveTo(s,a,u,l,w,b);w+=m.shift(),b+=m.shift(),g.lineTo(w,b);break;case 25:for(;m.length>6;)w+=m.shift(),b+=m.shift(),g.lineTo(w,b);s=w+m.shift(),a=b+m.shift(),u=s+m.shift(),l=a+m.shift(),w=u+m.shift(),b=l+m.shift(),g.curveTo(s,a,u,l,w,b);break;case 26:for(m.length%2&&(w+=m.shift());m.length>0;)s=w,a=b+m.shift(),u=s+m.shift(),l=a+m.shift(),w=u,b=l+m.shift(),g.curveTo(s,a,u,l,w,b);break;case 27:for(m.length%2&&(b+=m.shift());m.length>0;)s=w+m.shift(),a=b,u=s+m.shift(),l=a+m.shift(),w=u+m.shift(),b=l,g.curveTo(s,a,u,l,w,b);break;case 28:d=i[I],f=i[I+1],m.push((d<<24|f<<16)>>16),I+=2;break;case 29:C=m.pop()+e.gsubrsBias,F=e.gsubrs[C],F&&o(F);break;case 30:for(;m.length>0&&(s=w,a=b+m.shift(),u=s+m.shift(),l=a+m.shift(),w=u+m.shift(),b=l+(1===m.length?m.shift():0),g.curveTo(s,a,u,l,w,b),0!==m.length);)s=w+m.shift(),a=b,u=s+m.shift(),l=a+m.shift(),b=l+m.shift(),w=u+(1===m.length?m.shift():0),g.curveTo(s,a,u,l,w,b);break;case 31:for(;m.length>0&&(s=w+m.shift(),a=b,u=s+m.shift(),l=a+m.shift(),b=l+m.shift(),w=u+(1===m.length?m.shift():0),g.curveTo(s,a,u,l,w,b),0!==m.length);)s=w,a=b+m.shift(),u=s+m.shift(),l=a+m.shift(),w=u+m.shift(),b=l+(1===m.length?m.shift():0),g.curveTo(s,a,u,l,w,b);break;default:B<32?console.log("Glyph "+t.index+": unknown operator "+B):B<247?m.push(B-139):B<251?(d=i[I],I+=1,m.push(256*(B-247)+d+108)):B<255?(d=i[I],I+=1,m.push(256*-(B-251)-d-108)):(d=i[I],f=i[I+1],v=i[I+2],S=i[I+3],I+=4,m.push((d<<24|f<<16|v<<8|S)/65536))}}}var s,a,u,l,c,h,d,p,g=new f,m=[],y=0,_=!1,x=!1,w=0,b=0;if(e.isCIDFont){var v=e.tables.cff.topDict._fdSelect[t.index],S=e.tables.cff.topDict._fdArray[v];c=S._subrs,h=S._subrsBias,d=S._defaultWidthX,p=S._nominalWidthX}else c=e.tables.cff.topDict._subrs,h=e.tables.cff.topDict._subrsBias,d=e.tables.cff.topDict._defaultWidthX,p=e.tables.cff.topDict._nominalWidthX;var T=d;return o(i),t.advanceWidth=T,g}function Ce(e,t,i,n){var r,o=[],s=new Po.Parser(e,t),a=s.parseCard8();if(0===a)for(var u=0;u<i;u++){if((r=s.parseCard8())>=n)throw new Error("CFF table CID Font FDSelect has bad FD index value "+r+" (FD count "+n+")");o.push(r)}else{if(3!==a)throw new Error("CFF Table CID Font FDSelect table has unsupported format "+a);var l=s.parseCard16(),c=s.parseCard16();if(0!==c)throw new Error("CFF Table CID Font FDSelect format 3 range has bad initial GID "+c);for(var h,d=0;d<l;d++){if(r=s.parseCard8(),h=s.parseCard16(),r>=n)throw new Error("CFF table CID Font FDSelect has bad FD index value "+r+" (FD count "+n+")");if(h>i)throw new Error("CFF Table CID Font FDSelect format 3 range has bad GID "+h);for(;c<h;c++)o.push(r);c=h}if(h!==i)throw new Error("CFF Table CID Font FDSelect format 3 range has bad final GID "+h)}return o}function Fe(e,t,i,n){i.tables.cff={};var r=_e(e,t),o=le(e,r.endOffset,Po.bytesToString),s=le(e,o.endOffset),a=le(e,s.endOffset,Po.bytesToString),u=le(e,a.endOffset);i.gsubrs=u.objects,i.gsubrsBias=ue(i.gsubrs);var l=be(e,t,s.objects,a.objects);if(1!==l.length)throw new Error("CFF table has too many fonts in 'FontSet' - count of fonts NameIndex.length = "+l.length);var c=l[0];if(i.tables.cff.topDict=c,c._privateDict&&(i.defaultWidthX=c._privateDict.defaultWidthX,i.nominalWidthX=c._privateDict.nominalWidthX),void 0!==c.ros[0]&&void 0!==c.ros[1]&&(i.isCIDFont=!0),i.isCIDFont){var h=c.fdArray,d=c.fdSelect;if(0===h||0===d)throw new Error("Font is marked as a CID font, but FDArray and/or FDSelect information is missing");h+=t;var p=le(e,h),f=be(e,t,p.objects,a.objects);c._fdArray=f,d+=t,c._fdSelect=Ce(e,d,i.numGlyphs,f.length)}var g=t+c.private[1],m=we(e,g,c.private[0],a.objects);if(i.defaultWidthX=m.defaultWidthX,i.nominalWidthX=m.nominalWidthX,0!==m.subrs){var y=g+m.subrs,_=le(e,y);i.subrs=_.objects,i.subrsBias=ue(i.subrs)}else i.subrs=[],i.subrsBias=0;var x;n.lowMemory?(x=ce(e,t+c.charStrings),i.nGlyphs=x.offsets.length):(x=le(e,t+c.charStrings),i.nGlyphs=x.objects.length);var w=ve(e,t+c.charset,i.nGlyphs,a.objects);if(0===c.encoding?i.cffEncoding=new Y(ko,w):1===c.encoding?i.cffEncoding=new Y(Uo,w):i.cffEncoding=Se(e,t+c.encoding,w),i.encoding=i.encoding||i.cffEncoding,i.glyphs=new jo.GlyphSet(i),n.lowMemory)i._push=function(n){var r=he(n,x.offsets,e,t+c.charStrings);i.glyphs.push(n,jo.cffGlyphLoader(i,n,Te,r))};else for(var b=0;b<i.nGlyphs;b+=1){var v=x.objects[b];i.glyphs.push(b,jo.cffGlyphLoader(i,b,Te,v))}}function Oe(e,t){var i,n=Lo.indexOf(e);return n>=0&&(i=n),n=t.indexOf(e),n>=0?i=n+Lo.length:(i=Lo.length+t.length,t.push(e)),i}function Ne(){return new Io.Record("Header",[{name:"major",type:"Card8",value:1},{name:"minor",type:"Card8",value:0},{name:"hdrSize",type:"Card8",value:4},{name:"major",type:"Card8",value:1}])}function Ee(e){var t=new Io.Record("Name INDEX",[{name:"names",type:"INDEX",value:[]}]);t.names=[];for(var i=0;i<e.length;i+=1)t.names.push({name:"name_"+i,type:"NAME",value:e[i]});return t}function De(e,t,i){for(var n={},r=0;r<e.length;r+=1){var o=e[r],s=t[o.name];void 0===s||ae(s,o.value)||("SID"===o.type&&(s=Oe(s,i)),n[o.op]={name:o.name,type:o.type,value:s})}return n}function Me(e,t){var i=new Io.Record("Top DICT",[{name:"dict",type:"DICT",value:{}}]);return i.dict=De(Go,e,t),i}function Ve(e){var t=new Io.Record("Top DICT INDEX",[{name:"topDicts",type:"INDEX",value:[]}]);return t.topDicts=[{name:"topDict_0",type:"TABLE",value:e}],t}function Ie(e){var t=new Io.Record("String INDEX",[{name:"strings",type:"INDEX",value:[]}]);t.strings=[];for(var i=0;i<e.length;i+=1)t.strings.push({name:"string_"+i,type:"STRING",value:e[i]});return t}function Be(){return new Io.Record("Global Subr INDEX",[{name:"subrs",type:"INDEX",value:[]}])}function Ae(e,t){for(var i=new Io.Record("Charsets",[{name:"format",type:"Card8",value:0}]),n=0;n<e.length;n+=1){var r=e[n],o=Oe(r,t);i.fields.push({name:"glyph_"+n,type:"SID",value:o})}return i}function Pe(e){var t=[],i=e.path;t.push({name:"width",type:"NUMBER",value:e.advanceWidth});for(var n=0,r=0,o=0;o<i.commands.length;o+=1){var s=void 0,a=void 0,u=i.commands[o];if("Q"===u.type){u={type:"C",x:u.x,y:u.y,x1:Math.round(1/3*n+2/3*u.x1),y1:Math.round(1/3*r+2/3*u.y1),x2:Math.round(1/3*u.x+2/3*u.x1),y2:Math.round(1/3*u.y+2/3*u.y1)}}if("M"===u.type)s=Math.round(u.x-n),a=Math.round(u.y-r),t.push({name:"dx",type:"NUMBER",value:s}),t.push({name:"dy",type:"NUMBER",value:a}),t.push({name:"rmoveto",type:"OP",value:21}),n=Math.round(u.x),r=Math.round(u.y);else if("L"===u.type)s=Math.round(u.x-n),a=Math.round(u.y-r),t.push({name:"dx",type:"NUMBER",value:s}),t.push({name:"dy",type:"NUMBER",value:a}),t.push({name:"rlineto",type:"OP",value:5}),n=Math.round(u.x),r=Math.round(u.y);else if("C"===u.type){var l=Math.round(u.x1-n),c=Math.round(u.y1-r),h=Math.round(u.x2-u.x1),d=Math.round(u.y2-u.y1);s=Math.round(u.x-u.x2),a=Math.round(u.y-u.y2),t.push({name:"dx1",type:"NUMBER",value:l}),t.push({name:"dy1",type:"NUMBER",value:c}),t.push({name:"dx2",type:"NUMBER",value:h}),t.push({name:"dy2",type:"NUMBER",value:d}),t.push({name:"dx",type:"NUMBER",value:s}),t.push({name:"dy",type:"NUMBER",value:a}),t.push({name:"rrcurveto",type:"OP",value:8}),n=Math.round(u.x),r=Math.round(u.y)}}return t.push({name:"endchar",type:"OP",value:14}),t}function Re(e){for(var t=new Io.Record("CharStrings INDEX",[{name:"charStrings",type:"INDEX",value:[]}]),i=0;i<e.length;i+=1){var n=e.get(i),r=Pe(n);t.charStrings.push({name:n.name,type:"CHARSTRING",value:r})}return t}function Le(e,t){var i=new Io.Record("Private DICT",[{name:"dict",type:"DICT",value:{}}]);return i.dict=De(qo,e,t),i}function ke(e,t){for(var i,n=new Io.Table("CFF ",[{name:"header",type:"RECORD"},{name:"nameIndex",type:"RECORD"},{name:"topDictIndex",type:"RECORD"},{name:"stringIndex",type:"RECORD"},{name:"globalSubrIndex",type:"RECORD"},{name:"charsets",type:"RECORD"},{name:"charStringsIndex",type:"RECORD"},{name:"privateDict",type:"RECORD"}]),r=1/t.unitsPerEm,o={version:t.version,fullName:t.fullName,familyName:t.familyName,weight:t.weightName,fontBBox:t.fontBBox||[0,0,0,0],fontMatrix:[r,0,0,r,0,0],charset:999,encoding:0,charStrings:999,private:[0,999]},s={},a=[],u=1;u<e.length;u+=1)i=e.get(u),a.push(i.name);var l=[];n.header=Ne(),n.nameIndex=Ee([t.postScriptName]);var c=Me(o,l);n.topDictIndex=Ve(c),n.globalSubrIndex=Be(),n.charsets=Ae(a,l),n.charStringsIndex=Re(e),n.privateDict=Le(s,l),n.stringIndex=Ie(l);var h=n.header.sizeOf()+n.nameIndex.sizeOf()+n.topDictIndex.sizeOf()+n.stringIndex.sizeOf()+n.globalSubrIndex.sizeOf();return o.charset=h,o.encoding=0,o.charStrings=o.charset+n.charsets.sizeOf(),o.private[1]=o.charStrings+n.charStringsIndex.sizeOf(),c=Me(o,l),n.topDictIndex=Ve(c),n}function Ue(e,t){var i={},n=new Po.Parser(e,t);return i.version=n.parseVersion(),i.fontRevision=Math.round(1e3*n.parseFixed())/1e3,i.checkSumAdjustment=n.parseULong(),i.magicNumber=n.parseULong(),To.argument(1594834165===i.magicNumber,"Font header has wrong magic number."),i.flags=n.parseUShort(),i.unitsPerEm=n.parseUShort(),i.created=n.parseLongDateTime(),i.modified=n.parseLongDateTime(),i.xMin=n.parseShort(),i.yMin=n.parseShort(),i.xMax=n.parseShort(),i.yMax=n.parseShort(),i.macStyle=n.parseUShort(),i.lowestRecPPEM=n.parseUShort(),i.fontDirectionHint=n.parseShort(),i.indexToLocFormat=n.parseShort(),i.glyphDataFormat=n.parseShort(),i}function Xe(e){var t=Math.round((new Date).getTime()/1e3)+2082844800,i=t;return e.createdTimestamp&&(i=e.createdTimestamp+2082844800),new Io.Table("head",[{name:"version",type:"FIXED",value:65536},{name:"fontRevision",type:"FIXED",value:65536},{name:"checkSumAdjustment",type:"ULONG",value:0},{name:"magicNumber",type:"ULONG",value:1594834165},{name:"flags",type:"USHORT",value:0},{name:"unitsPerEm",type:"USHORT",value:1e3},{name:"created",type:"LONGDATETIME",value:i},{name:"modified",type:"LONGDATETIME",value:t},{name:"xMin",type:"SHORT",value:0},{name:"yMin",type:"SHORT",value:0},{name:"xMax",type:"SHORT",value:0},{name:"yMax",type:"SHORT",value:0},{name:"macStyle",type:"USHORT",value:0},{name:"lowestRecPPEM",type:"USHORT",value:0},{name:"fontDirectionHint",type:"SHORT",value:2},{name:"indexToLocFormat",type:"SHORT",value:0},{name:"glyphDataFormat",type:"SHORT",value:0}],e)}function ze(e,t){var i={},n=new Po.Parser(e,t);return i.version=n.parseVersion(),i.ascender=n.parseShort(),i.descender=n.parseShort(),i.lineGap=n.parseShort(),i.advanceWidthMax=n.parseUShort(),i.minLeftSideBearing=n.parseShort(),i.minRightSideBearing=n.parseShort(),i.xMaxExtent=n.parseShort(),i.caretSlopeRise=n.parseShort(),i.caretSlopeRun=n.parseShort(),i.caretOffset=n.parseShort(),n.relativeOffset+=8,i.metricDataFormat=n.parseShort(),i.numberOfHMetrics=n.parseUShort(),i}function je(e){return new Io.Table("hhea",[{name:"version",type:"FIXED",value:65536},{name:"ascender",type:"FWORD",value:0},{name:"descender",type:"FWORD",value:0},{name:"lineGap",type:"FWORD",value:0},{name:"advanceWidthMax",type:"UFWORD",value:0},{name:"minLeftSideBearing",type:"FWORD",value:0},{name:"minRightSideBearing",type:"FWORD",value:0},{name:"xMaxExtent",type:"FWORD",value:0},{name:"caretSlopeRise",type:"SHORT",value:1},{name:"caretSlopeRun",type:"SHORT",value:0},{name:"caretOffset",type:"SHORT",value:0},{name:"reserved1",type:"SHORT",value:0},{name:"reserved2",type:"SHORT",value:0},{name:"reserved3",type:"SHORT",value:0},{name:"reserved4",type:"SHORT",value:0},{name:"metricDataFormat",type:"SHORT",value:0},{name:"numberOfHMetrics",type:"USHORT",value:0}],e)}function Ge(e,t,i,n,r){for(var o,s,a=new Po.Parser(e,t),u=0;u<n;u+=1){u<i&&(o=a.parseUShort(),s=a.parseShort());var l=r.get(u);l.advanceWidth=o,l.leftSideBearing=s}}function qe(e,t,i,n,r){e._hmtxTableData={};for(var o,s,a=new Po.Parser(t,i),u=0;u<r;u+=1)u<n&&(o=a.parseUShort(),s=a.parseShort()),e._hmtxTableData[u]={advanceWidth:o,leftSideBearing:s}}function He(e,t,i,n,r,o,s){s.lowMemory?qe(e,t,i,n,r):Ge(t,i,n,r,o)}function We(e){for(var t=new Io.Table("hmtx",[]),i=0;i<e.length;i+=1){var n=e.get(i),r=n.advanceWidth||0,o=n.leftSideBearing||0;t.fields.push({name:"advanceWidth_"+i,type:"USHORT",value:r}),t.fields.push({name:"leftSideBearing_"+i,type:"SHORT",value:o})}return t}function Ye(e){for(var t=new Io.Table("ltag",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"numTags",type:"ULONG",value:e.length}]),i="",n=12+4*e.length,r=0;r<e.length;++r){var o=i.indexOf(e[r]);o<0&&(o=i.length,i+=e[r]),t.fields.push({name:"offset "+r,type:"USHORT",value:n+o}),t.fields.push({name:"length "+r,type:"USHORT",value:e[r].length})}return t.fields.push({name:"stringPool",type:"CHARARRAY",value:i}),t}function $e(e,t){var i=new Po.Parser(e,t),n=i.parseULong();To.argument(1===n,"Unsupported ltag table version."),i.skip("uLong",1);for(var r=i.parseULong(),o=[],s=0;s<r;s++){for(var a="",u=t+i.parseUShort(),l=i.parseUShort(),c=u;c<u+l;++c)a+=String.fromCharCode(e.getInt8(c));o.push(a)}return o}function Ze(e,t){var i={},n=new Po.Parser(e,t);return i.version=n.parseVersion(),i.numGlyphs=n.parseUShort(),1===i.version&&(i.maxPoints=n.parseUShort(),i.maxContours=n.parseUShort(),i.maxCompositePoints=n.parseUShort(),i.maxCompositeContours=n.parseUShort(),i.maxZones=n.parseUShort(),i.maxTwilightPoints=n.parseUShort(),i.maxStorage=n.parseUShort(),i.maxFunctionDefs=n.parseUShort(),i.maxInstructionDefs=n.parseUShort(),i.maxStackElements=n.parseUShort(),i.maxSizeOfInstructions=n.parseUShort(),i.maxComponentElements=n.parseUShort(),i.maxComponentDepth=n.parseUShort()),i}function Ke(e){return new Io.Table("maxp",[{name:"version",type:"FIXED",value:20480},{name:"numGlyphs",type:"USHORT",value:e}])}function Qe(e,t,i){switch(e){case 0:if(65535===t)return"und";if(i)return i[t];break;case 1:return Jo[t];case 3:return ts[t]}}function Je(e,t,i){switch(e){case 0:return is;case 1:return rs[i]||ns[t];case 3:if(1===t||10===t)return is}}function et(e,t,i){for(var n={},r=new Po.Parser(e,t),o=r.parseUShort(),s=r.parseUShort(),a=r.offset+r.parseUShort(),u=0;u<s;u++){var l=r.parseUShort(),c=r.parseUShort(),h=r.parseUShort(),d=r.parseUShort(),p=Qo[d]||d,f=r.parseUShort(),g=r.parseUShort(),m=Qe(l,h,i),y=Je(l,c,h);if(void 0!==y&&void 0!==m){var _=void 0;if(_=y===is?Co.UTF16(e,a+g,f):Co.MACSTRING(e,a+g,f,y)){var x=n[p];void 0===x&&(x=n[p]={}),x[m]=_}}}return 1===o&&r.parseUShort(),n}function tt(e){var t={};for(var i in e)t[e[i]]=parseInt(i);return t}function it(e,t,i,n,r,o){return new Io.Record("NameRecord",[{name:"platformID",type:"USHORT",value:e},{name:"encodingID",type:"USHORT",value:t},{name:"languageID",type:"USHORT",value:i},{name:"nameID",type:"USHORT",value:n},{name:"length",type:"USHORT",value:r},{name:"offset",type:"USHORT",value:o}])}function nt(e,t){var i=e.length,n=t.length-i+1;e:for(var r=0;r<n;r++)for(;r<n;r++){for(var o=0;o<i;o++)if(t[r+o]!==e[o])continue e;return r}return-1}function rt(e,t){var i=nt(e,t);if(i<0){i=t.length;for(var n=0,r=e.length;n<r;++n)t.push(e[n])}return i}function ot(e,t){var i,n=[],r={},o=tt(Qo);for(var s in e){var a=o[s];if(void 0===a&&(a=s),i=parseInt(a),isNaN(i))throw new Error('Name table entry "'+s+'" does not exist, see nameTableNames for complete list.');r[i]=e[s],n.push(i)}for(var u=tt(Jo),l=tt(ts),c=[],h=[],d=0;d<n.length;d++){i=n[d];var p=r[i];for(var f in p){var g=p[f],m=1,y=u[f],_=es[y],x=Je(m,_,y),w=Fo.MACSTRING(g,x);void 0===w&&(m=0,y=t.indexOf(f),y<0&&(y=t.length,t.push(f)),_=4,w=Fo.UTF16(g));var b=rt(w,h);c.push(it(m,_,y,i,w.length,b));var v=l[f];if(void 0!==v){var S=Fo.UTF16(g),T=rt(S,h);c.push(it(3,1,v,i,S.length,T))}}}c.sort(function(e,t){return e.platformID-t.platformID||e.encodingID-t.encodingID||e.languageID-t.languageID||e.nameID-t.nameID});for(var C=new Io.Table("name",[{name:"format",type:"USHORT",value:0},{name:"count",type:"USHORT",value:c.length},{name:"stringOffset",type:"USHORT",value:6+12*c.length}]),F=0;F<c.length;F++)C.fields.push({name:"record_"+F,type:"RECORD",value:c[F]});return C.fields.push({name:"strings",type:"LITERAL",value:h}),C}function st(e){for(var t=0;t<ss.length;t+=1){var i=ss[t];if(e>=i.begin&&e<i.end)return t}return-1}function at(e,t){var i={},n=new Po.Parser(e,t);i.version=n.parseUShort(),i.xAvgCharWidth=n.parseShort(),i.usWeightClass=n.parseUShort(),i.usWidthClass=n.parseUShort(),i.fsType=n.parseUShort(),i.ySubscriptXSize=n.parseShort(),i.ySubscriptYSize=n.parseShort(),i.ySubscriptXOffset=n.parseShort(),i.ySubscriptYOffset=n.parseShort(),i.ySuperscriptXSize=n.parseShort(),i.ySuperscriptYSize=n.parseShort(),i.ySuperscriptXOffset=n.parseShort(),i.ySuperscriptYOffset=n.parseShort(),i.yStrikeoutSize=n.parseShort(),i.yStrikeoutPosition=n.parseShort(),i.sFamilyClass=n.parseShort(),i.panose=[];for(var r=0;r<10;r++)i.panose[r]=n.parseByte();return i.ulUnicodeRange1=n.parseULong(),i.ulUnicodeRange2=n.parseULong(),i.ulUnicodeRange3=n.parseULong(),i.ulUnicodeRange4=n.parseULong(),i.achVendID=String.fromCharCode(n.parseByte(),n.parseByte(),n.parseByte(),n.parseByte()),i.fsSelection=n.parseUShort(),i.usFirstCharIndex=n.parseUShort(),i.usLastCharIndex=n.parseUShort(),i.sTypoAscender=n.parseShort(),i.sTypoDescender=n.parseShort(),i.sTypoLineGap=n.parseShort(),i.usWinAscent=n.parseUShort(),i.usWinDescent=n.parseUShort(),i.version>=1&&(i.ulCodePageRange1=n.parseULong(),i.ulCodePageRange2=n.parseULong()),i.version>=2&&(i.sxHeight=n.parseShort(),i.sCapHeight=n.parseShort(),i.usDefaultChar=n.parseUShort(),i.usBreakChar=n.parseUShort(),i.usMaxContent=n.parseUShort()),i}function ut(e){return new Io.Table("OS/2",[{name:"version",type:"USHORT",value:3},{name:"xAvgCharWidth",type:"SHORT",value:0},{name:"usWeightClass",type:"USHORT",value:0},{name:"usWidthClass",type:"USHORT",value:0},{name:"fsType",type:"USHORT",value:0},{name:"ySubscriptXSize",type:"SHORT",value:650},{name:"ySubscriptYSize",type:"SHORT",value:699},{name:"ySubscriptXOffset",type:"SHORT",value:0},{name:"ySubscriptYOffset",type:"SHORT",value:140},{name:"ySuperscriptXSize",type:"SHORT",value:650},{name:"ySuperscriptYSize",type:"SHORT",value:699},{name:"ySuperscriptXOffset",type:"SHORT",value:0},{name:"ySuperscriptYOffset",type:"SHORT",value:479},{name:"yStrikeoutSize",type:"SHORT",value:49},{name:"yStrikeoutPosition",type:"SHORT",value:258},{name:"sFamilyClass",type:"SHORT",value:0},{name:"bFamilyType",type:"BYTE",value:0},{name:"bSerifStyle",type:"BYTE",value:0},{name:"bWeight",type:"BYTE",value:0},{name:"bProportion",type:"BYTE",value:0},{name:"bContrast",type:"BYTE",value:0},{name:"bStrokeVariation",type:"BYTE",value:0},{name:"bArmStyle",type:"BYTE",value:0},{name:"bLetterform",type:"BYTE",value:0},{name:"bMidline",type:"BYTE",value:0},{name:"bXHeight",type:"BYTE",value:0},{name:"ulUnicodeRange1",type:"ULONG",value:0},{name:"ulUnicodeRange2",type:"ULONG",value:0},{name:"ulUnicodeRange3",type:"ULONG",value:0},{name:"ulUnicodeRange4",type:"ULONG",value:0},{name:"achVendID",type:"CHARARRAY",value:"XXXX"},{name:"fsSelection",type:"USHORT",value:0},{name:"usFirstCharIndex",type:"USHORT",value:0},{name:"usLastCharIndex",type:"USHORT",value:0},{name:"sTypoAscender",type:"SHORT",value:0},{name:"sTypoDescender",type:"SHORT",value:0},{name:"sTypoLineGap",type:"SHORT",value:0},{name:"usWinAscent",type:"USHORT",value:0},{name:"usWinDescent",type:"USHORT",value:0},{name:"ulCodePageRange1",type:"ULONG",value:0},{name:"ulCodePageRange2",type:"ULONG",value:0},{name:"sxHeight",type:"SHORT",value:0},{name:"sCapHeight",type:"SHORT",value:0},{name:"usDefaultChar",type:"USHORT",value:0},{name:"usBreakChar",type:"USHORT",value:0},{name:"usMaxContext",type:"USHORT",value:0}],e)}function lt(e,t){var i={},n=new Po.Parser(e,t);switch(i.version=n.parseVersion(),i.italicAngle=n.parseFixed(),i.underlinePosition=n.parseShort(),i.underlineThickness=n.parseShort(),i.isFixedPitch=n.parseULong(),i.minMemType42=n.parseULong(),i.maxMemType42=n.parseULong(),i.minMemType1=n.parseULong(),i.maxMemType1=n.parseULong(),i.version){case 1:i.names=Xo.slice();break;case 2:i.numberOfGlyphs=n.parseUShort(),i.glyphNameIndex=new Array(i.numberOfGlyphs);for(var r=0;r<i.numberOfGlyphs;r++)i.glyphNameIndex[r]=n.parseUShort();i.names=[];for(var o=0;o<i.numberOfGlyphs;o++)if(i.glyphNameIndex[o]>=Xo.length){var s=n.parseChar();i.names.push(n.parseString(s))}break;case 2.5:i.numberOfGlyphs=n.parseUShort(),i.offset=new Array(i.numberOfGlyphs);for(var a=0;a<i.numberOfGlyphs;a++)i.offset[a]=n.parseChar()}return i}function ct(){return new Io.Table("post",[{name:"version",type:"FIXED",value:196608},{name:"italicAngle",type:"FIXED",value:0},{name:"underlinePosition",type:"FWORD",value:0},{name:"underlineThickness",type:"FWORD",value:0},{name:"isFixedPitch",type:"ULONG",value:0},{name:"minMemType42",type:"ULONG",value:0},{name:"maxMemType42",type:"ULONG",value:0},{name:"minMemType1",type:"ULONG",value:0},{name:"maxMemType1",type:"ULONG",value:0}])}function ht(e,t){t=t||0;var i=new k(e,t),n=i.parseVersion(1);return To.argument(1===n||1.1===n,"Unsupported GSUB table version."),1===n?{version:n,scripts:i.parseScriptList(),features:i.parseFeatureList(),lookups:i.parseLookupList(ls)}:{version:n,scripts:i.parseScriptList(),features:i.parseFeatureList(),lookups:i.parseLookupList(ls),variations:i.parseFeatureVariationsList()}}function dt(e){return new Io.Table("GSUB",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new Io.ScriptList(e.scripts)},{name:"features",type:"TABLE",value:new Io.FeatureList(e.features)},{name:"lookups",type:"TABLE",value:new Io.LookupList(e.lookups,hs)}])}function pt(e,t){var i=new Po.Parser(e,t),n=i.parseULong();To.argument(1===n,"Unsupported META table version."),i.parseULong(),i.parseULong();for(var r=i.parseULong(),o={},s=0;s<r;s++){var a=i.parseTag(),u=i.parseULong(),l=i.parseULong(),c=Co.UTF8(e,t+u,l);o[a]=c}return o}function ft(e){var t=Object.keys(e).length,i="",n=16+12*t,r=new Io.Table("meta",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"offset",type:"ULONG",value:n},{name:"numTags",type:"ULONG",value:t}]);for(var o in e){var s=i.length;i+=e[o],r.fields.push({name:"tag "+o,type:"TAG",value:o}),r.fields.push({name:"offset "+o,type:"ULONG",value:n+s}),r.fields.push({name:"length "+o,type:"ULONG",value:e[o].length})}return r.fields.push({name:"stringPool",type:"CHARARRAY",value:i}),r}function gt(e){return Math.log(e)/Math.log(2)|0}function mt(e){for(;e.length%4!=0;)e.push(0);for(var t=0,i=0;i<e.length;i+=4)t+=(e[i]<<24)+(e[i+1]<<16)+(e[i+2]<<8)+e[i+3];return t%=Math.pow(2,32)}function yt(e,t,i,n){return new Io.Record("Table Record",[{name:"tag",type:"TAG",value:void 0!==e?e:""},{name:"checkSum",type:"ULONG",value:void 0!==t?t:0},{name:"offset",type:"ULONG",value:void 0!==i?i:0},{name:"length",type:"ULONG",value:void 0!==n?n:0}])}function _t(e){var t=new Io.Table("sfnt",[{name:"version",type:"TAG",value:"OTTO"},{name:"numTables",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);t.tables=e,t.numTables=e.length;var i=Math.pow(2,gt(t.numTables));t.searchRange=16*i,t.entrySelector=gt(i),t.rangeShift=16*t.numTables-t.searchRange;for(var n=[],r=[],o=t.sizeOf()+yt().sizeOf()*t.numTables;o%4!=0;)o+=1,r.push({name:"padding",type:"BYTE",value:0});for(var s=0;s<e.length;s+=1){var a=e[s];To.argument(4===a.tableName.length,"Table name"+a.tableName+" is invalid.");var u=a.sizeOf(),l=yt(a.tableName,mt(a.encode()),o,u);for(n.push({name:l.tag+" Table Record",type:"RECORD",value:l}),r.push({name:a.tableName+" table",type:"RECORD",value:a}),o+=u,To.argument(!isNaN(o),"Something went wrong calculating the offset.");o%4!=0;)o+=1,r.push({name:"padding",type:"BYTE",value:0})}return n.sort(function(e,t){return e.value.tag>t.value.tag?1:-1}),t.fields=t.fields.concat(n),t.fields=t.fields.concat(r),t}function xt(e,t,i){for(var n=0;n<t.length;n+=1){var r=e.charToGlyphIndex(t[n]);if(r>0){return e.glyphs.get(r).getMetrics()}}return i}function wt(e){for(var t=0,i=0;i<e.length;i+=1)t+=e[i];return t/e.length}function bt(e){for(var t,i=[],n=[],r=[],o=[],s=[],a=[],u=[],l=0,c=0,h=0,d=0,p=0,f=0;f<e.glyphs.length;f+=1){var g=e.glyphs.get(f),m=0|g.unicode;if(isNaN(g.advanceWidth))throw new Error("Glyph "+g.name+" ("+f+"): advanceWidth is not a number.");(t>m||void 0===t)&&m>0&&(t=m),l<m&&(l=m);var y=as.getUnicodeRange(m);if(y<32)c|=1<<y;else if(y<64)h|=1<<y-32;else if(y<96)d|=1<<y-64;else{if(!(y<123))throw new Error("Unicode ranges bits > 123 are reserved for internal usage");p|=1<<y-96}if(".notdef"!==g.name){var _=g.getMetrics();i.push(_.xMin),n.push(_.yMin),r.push(_.xMax),o.push(_.yMax),a.push(_.leftSideBearing),u.push(_.rightSideBearing),s.push(g.advanceWidth)}}var x={xMin:Math.min.apply(null,i),yMin:Math.min.apply(null,n),xMax:Math.max.apply(null,r),yMax:Math.max.apply(null,o),advanceWidthMax:Math.max.apply(null,s),advanceWidthAvg:wt(s),minLeftSideBearing:Math.min.apply(null,a),maxLeftSideBearing:Math.max.apply(null,a),minRightSideBearing:Math.min.apply(null,u)};x.ascender=e.ascender,x.descender=e.descender;var w=Wo.make({flags:3,unitsPerEm:e.unitsPerEm,xMin:x.xMin,yMin:x.yMin,xMax:x.xMax,yMax:x.yMax,lowestRecPPEM:3,createdTimestamp:e.createdTimestamp}),b=Yo.make({ascender:x.ascender,descender:x.descender,advanceWidthMax:x.advanceWidthMax,minLeftSideBearing:x.minLeftSideBearing,minRightSideBearing:x.minRightSideBearing,xMaxExtent:x.maxLeftSideBearing+(x.xMax-x.xMin),numberOfHMetrics:e.glyphs.length}),v=Ko.make(e.glyphs.length),S=as.make(Object.assign({xAvgCharWidth:Math.round(x.advanceWidthAvg),usFirstCharIndex:t,usLastCharIndex:l,ulUnicodeRange1:c,ulUnicodeRange2:h,ulUnicodeRange3:d,ulUnicodeRange4:p,sTypoAscender:x.ascender,sTypoDescender:x.descender,sTypoLineGap:0,usWinAscent:x.yMax,usWinDescent:Math.abs(x.yMin),ulCodePageRange1:1,sxHeight:xt(e,"xyvw",{yMax:Math.round(x.ascender/2)}).yMax,sCapHeight:xt(e,"HIKLEFJMNTZBDPRAGOQSUVWXY",x).yMax,usDefaultChar:e.hasChar(" ")?32:0,usBreakChar:e.hasChar(" ")?32:0},e.tables.os2)),T=$o.make(e.glyphs),C=Ro.make(e.glyphs),F=e.getEnglishName("fontFamily"),O=e.getEnglishName("fontSubfamily"),N=F+" "+O,E=e.getEnglishName("postScriptName");E||(E=F.replace(/\s/g,"")+"-"+O);var D={};for(var M in e.names)D[M]=e.names[M];D.uniqueID||(D.uniqueID={en:e.getEnglishName("manufacturer")+":"+N}),D.postScriptName||(D.postScriptName={en:E}),D.preferredFamily||(D.preferredFamily=e.names.fontFamily),D.preferredSubfamily||(D.preferredSubfamily=e.names.fontSubfamily);var V=[],I=os.make(D,V),B=V.length>0?Zo.make(V):void 0,A=us.make(),P=Ho.make(e.glyphs,{version:e.getEnglishName("version"),fullName:N,familyName:F,weightName:O,postScriptName:E,unitsPerEm:e.unitsPerEm,fontBBox:[0,x.yMin,x.ascender,x.advanceWidthMax]}),R=e.metas&&Object.keys(e.metas).length>0?ps.make(e.metas):void 0,L=[w,b,v,S,I,C,A,P,T];B&&L.push(B),e.tables.gsub&&L.push(ds.make(e.tables.gsub)),R&&L.push(R);for(var k=_t(L),U=k.encode(),X=mt(U),z=k.fields,j=!1,G=0;G<z.length;G+=1)if("head table"===z[G].name){z[G].value.checkSumAdjustment=2981146554-X,j=!0;break}if(!j)throw new Error("Could not find head table with checkSum to adjust.");return k}function vt(e,t){for(var i=0,n=e.length-1;i<=n;){var r=i+n>>>1,o=e[r].tag
;if(o===t)return r;o<t?i=r+1:n=r-1}return-i-1}function St(e,t){for(var i=0,n=e.length-1;i<=n;){var r=i+n>>>1,o=e[r];if(o===t)return r;o<t?i=r+1:n=r-1}return-i-1}function Tt(e,t){for(var i,n=0,r=e.length-1;n<=r;){var o=n+r>>>1;i=e[o];var s=i.start;if(s===t)return i;s<t?n=o+1:r=o-1}if(n>0)return i=e[n-1],t>i.end?0:i}function Ct(e,t){this.font=e,this.tableName=t}function Ft(e){Ct.call(this,e,"gpos")}function Ot(e){Ct.call(this,e,"gsub")}function Nt(e,t){var i=e.length;if(i!==t.length)return!1;for(var n=0;n<i;n++)if(e[n]!==t[n])return!1;return!0}function Et(e,t,i){for(var n=e.subtables,r=0;r<n.length;r++){var o=n[r];if(o.substFormat===t)return o}if(i)return n.push(i),i}function Dt(){return"undefined"!=typeof window}function Mt(e){for(var t=new ArrayBuffer(e.length),i=new Uint8Array(t),n=0;n<e.length;++n)i[n]=e[n];return t}function Vt(e){for(var t=new Buffer(e.byteLength),i=new Uint8Array(e),n=0;n<t.length;++n)t[n]=i[n];return t}function It(e,t){if(!e)throw t}function Bt(e,t,i,n,r){var o;return(t&n)>0?(o=e.parseByte(),0==(t&r)&&(o=-o),o=i+o):o=(t&r)>0?i:i+e.parseShort(),o}function At(e,t,i){var n=new Po.Parser(t,i);e.numberOfContours=n.parseShort(),e._xMin=n.parseShort(),e._yMin=n.parseShort(),e._xMax=n.parseShort(),e._yMax=n.parseShort();var r,o;if(e.numberOfContours>0){for(var s=e.endPointIndices=[],a=0;a<e.numberOfContours;a+=1)s.push(n.parseUShort());e.instructionLength=n.parseUShort(),e.instructions=[];for(var u=0;u<e.instructionLength;u+=1)e.instructions.push(n.parseByte());var l=s[s.length-1]+1;r=[];for(var c=0;c<l;c+=1)if(o=n.parseByte(),r.push(o),(8&o)>0)for(var h=n.parseByte(),d=0;d<h;d+=1)r.push(o),c+=1;if(To.argument(r.length===l,"Bad flags."),s.length>0){var p,f=[];if(l>0){for(var g=0;g<l;g+=1)o=r[g],p={},p.onCurve=!!(1&o),p.lastPointOfContour=s.indexOf(g)>=0,f.push(p);for(var m=0,y=0;y<l;y+=1)o=r[y],p=f[y],p.x=Bt(n,o,m,2,16),m=p.x;for(var _=0,x=0;x<l;x+=1)o=r[x],p=f[x],p.y=Bt(n,o,_,4,32),_=p.y}e.points=f}else e.points=[]}else if(0===e.numberOfContours)e.points=[];else{e.isComposite=!0,e.points=[],e.components=[];for(var w=!0;w;){r=n.parseUShort();var b={glyphIndex:n.parseUShort(),xScale:1,scale01:0,scale10:0,yScale:1,dx:0,dy:0};(1&r)>0?(2&r)>0?(b.dx=n.parseShort(),b.dy=n.parseShort()):b.matchedPoints=[n.parseUShort(),n.parseUShort()]:(2&r)>0?(b.dx=n.parseChar(),b.dy=n.parseChar()):b.matchedPoints=[n.parseByte(),n.parseByte()],(8&r)>0?b.xScale=b.yScale=n.parseF2Dot14():(64&r)>0?(b.xScale=n.parseF2Dot14(),b.yScale=n.parseF2Dot14()):(128&r)>0&&(b.xScale=n.parseF2Dot14(),b.scale01=n.parseF2Dot14(),b.scale10=n.parseF2Dot14(),b.yScale=n.parseF2Dot14()),e.components.push(b),w=!!(32&r)}if(256&r){e.instructionLength=n.parseUShort(),e.instructions=[];for(var v=0;v<e.instructionLength;v+=1)e.instructions.push(n.parseByte())}}}function Pt(e,t){for(var i=[],n=0;n<e.length;n+=1){var r=e[n],o={x:t.xScale*r.x+t.scale01*r.y+t.dx,y:t.scale10*r.x+t.yScale*r.y+t.dy,onCurve:r.onCurve,lastPointOfContour:r.lastPointOfContour};i.push(o)}return i}function Rt(e){for(var t=[],i=[],n=0;n<e.length;n+=1){var r=e[n];i.push(r),r.lastPointOfContour&&(t.push(i),i=[])}return To.argument(0===i.length,"There are still points left in the current contour."),t}function Lt(e){var t=new f;if(!e)return t;for(var i=Rt(e),n=0;n<i.length;++n){var r=i[n],o=null,s=r[r.length-1],a=r[0];if(s.onCurve)t.moveTo(s.x,s.y);else if(a.onCurve)t.moveTo(a.x,a.y);else{var u={x:.5*(s.x+a.x),y:.5*(s.y+a.y)};t.moveTo(u.x,u.y)}for(var l=0;l<r.length;++l)if(o=s,s=a,a=r[(l+1)%r.length],s.onCurve)t.lineTo(s.x,s.y);else{var c=a;o.onCurve||{x:.5*(s.x+o.x),y:.5*(s.y+o.y)},a.onCurve||(c={x:.5*(s.x+a.x),y:.5*(s.y+a.y)}),t.quadraticCurveTo(s.x,s.y,c.x,c.y)}t.closePath()}return t}function kt(e,t){if(t.isComposite)for(var i=0;i<t.components.length;i+=1){var n=t.components[i],r=e.get(n.glyphIndex);if(r.getPath(),r.points){var o=void 0;if(void 0===n.matchedPoints)o=Pt(r.points,n);else{if(n.matchedPoints[0]>t.points.length-1||n.matchedPoints[1]>r.points.length-1)throw Error("Matched points out of range in "+t.name);var s=t.points[n.matchedPoints[0]],a=r.points[n.matchedPoints[1]],u={xScale:n.xScale,scale01:n.scale01,scale10:n.scale10,yScale:n.yScale,dx:0,dy:0};a=Pt([a],u)[0],u.dx=s.x-a.x,u.dy=s.y-a.y,o=Pt(r.points,u)}t.points=t.points.concat(o)}}return Lt(t.points)}function Ut(e,t,i,n){for(var r=new jo.GlyphSet(n),o=0;o<i.length-1;o+=1){var s=i[o];s!==i[o+1]?r.push(o,jo.ttfGlyphLoader(n,o,At,e,t+s,kt)):r.push(o,jo.glyphLoader(n,o))}return r}function Xt(e,t,i,n){var r=new jo.GlyphSet(n);return n._push=function(o){var s=i[o];s!==i[o+1]?r.push(o,jo.ttfGlyphLoader(n,o,At,e,t+s,kt)):r.push(o,jo.glyphLoader(n,o))},r}function zt(e,t,i,n,r){return r.lowMemory?Xt(e,t,i,n):Ut(e,t,i,n)}function jt(e){this.font=e,this.getCommands=function(e){return xs.getPath(e).commands},this._fpgmState=this._prepState=void 0,this._errorState=0}function Gt(e){return e}function qt(e){return Math.sign(e)*Math.round(Math.abs(e))}function Ht(e){return Math.sign(e)*Math.round(Math.abs(2*e))/2}function Wt(e){return Math.sign(e)*(Math.round(Math.abs(e)+.5)-.5)}function Yt(e){return Math.sign(e)*Math.ceil(Math.abs(e))}function $t(e){return Math.sign(e)*Math.floor(Math.abs(e))}function Zt(e,t){this.x=e,this.y=t,this.axis=void 0,this.slope=t/e,this.normalSlope=-e/t,Object.freeze(this)}function Kt(e,t){var i=Math.sqrt(e*e+t*t);return e/=i,t/=i,1===e&&0===t?bs:0===e&&1===t?vs:new Zt(e,t)}function Qt(e,t,i,n){this.x=this.xo=Math.round(64*e)/64,this.y=this.yo=Math.round(64*t)/64,this.lastPointOfContour=i,this.onCurve=n,this.prevPointOnContour=void 0,this.nextPointOnContour=void 0,this.xTouched=!1,this.yTouched=!1,Object.preventExtensions(this)}function Jt(e,t){switch(this.env=e,this.stack=[],this.prog=t,e){case"glyf":this.zp0=this.zp1=this.zp2=1,this.rp0=this.rp1=this.rp2=0;case"prep":this.fv=this.pv=this.dpv=bs,this.round=qt}}function ei(e){for(var t=e.tZone=new Array(e.gZone.length),i=0;i<t.length;i++)t[i]=new Qt(0,0)}function ti(e,t){var i,n=e.prog,r=e.ip,o=1;do if(88===(i=n[++r]))o++;else if(89===i)o--;else if(64===i)r+=n[r+1]+1;else if(65===i)r+=2*n[r+1]+1;else if(i>=176&&i<=183)r+=i-176+1;else if(i>=184&&i<=191)r+=2*(i-184+1);else if(t&&1===o&&27===i)break;while(o>0)e.ip=r}function ii(t,i){e.DEBUG&&console.log(i.step,"SVTCA["+t.axis+"]"),i.fv=i.pv=i.dpv=t}function ni(t,i){e.DEBUG&&console.log(i.step,"SPVTCA["+t.axis+"]"),i.pv=i.dpv=t}function ri(t,i){e.DEBUG&&console.log(i.step,"SFVTCA["+t.axis+"]"),i.fv=t}function oi(t,i){var n=i.stack,r=n.pop(),o=n.pop(),s=i.z2[r],a=i.z1[o];e.DEBUG&&console.log("SPVTL["+t+"]",r,o);var u,l;t?(u=s.y-a.y,l=a.x-s.x):(u=a.x-s.x,l=a.y-s.y),i.pv=i.dpv=Kt(u,l)}function si(t,i){var n=i.stack,r=n.pop(),o=n.pop(),s=i.z2[r],a=i.z1[o];e.DEBUG&&console.log("SFVTL["+t+"]",r,o);var u,l;t?(u=s.y-a.y,l=a.x-s.x):(u=a.x-s.x,l=a.y-s.y),i.fv=Kt(u,l)}function ai(t){var i=t.stack,n=i.pop(),r=i.pop();e.DEBUG&&console.log(t.step,"SPVFS[]",n,r),t.pv=t.dpv=Kt(r,n)}function ui(t){var i=t.stack,n=i.pop(),r=i.pop();e.DEBUG&&console.log(t.step,"SPVFS[]",n,r),t.fv=Kt(r,n)}function li(t){var i=t.stack,n=t.pv;e.DEBUG&&console.log(t.step,"GPV[]"),i.push(16384*n.x),i.push(16384*n.y)}function ci(t){var i=t.stack,n=t.fv;e.DEBUG&&console.log(t.step,"GFV[]"),i.push(16384*n.x),i.push(16384*n.y)}function hi(t){t.fv=t.pv,e.DEBUG&&console.log(t.step,"SFVTPV[]")}function di(t){var i=t.stack,n=i.pop(),r=i.pop(),o=i.pop(),s=i.pop(),a=i.pop(),u=t.z0,l=t.z1,c=u[n],h=u[r],d=l[o],p=l[s],f=t.z2[a];e.DEBUG&&console.log("ISECT[], ",n,r,o,s,a);var g=c.x,m=c.y,y=h.x,_=h.y,x=d.x,w=d.y,b=p.x,v=p.y,S=(g-y)*(w-v)-(m-_)*(x-b),T=g*_-m*y,C=x*v-w*b;f.x=(T*(x-b)-C*(g-y))/S,f.y=(T*(w-v)-C*(m-_))/S}function pi(t){t.rp0=t.stack.pop(),e.DEBUG&&console.log(t.step,"SRP0[]",t.rp0)}function fi(t){t.rp1=t.stack.pop(),e.DEBUG&&console.log(t.step,"SRP1[]",t.rp1)}function gi(t){t.rp2=t.stack.pop(),e.DEBUG&&console.log(t.step,"SRP2[]",t.rp2)}function mi(t){var i=t.stack.pop();switch(e.DEBUG&&console.log(t.step,"SZP0[]",i),t.zp0=i,i){case 0:t.tZone||ei(t),t.z0=t.tZone;break;case 1:t.z0=t.gZone;break;default:throw new Error("Invalid zone pointer")}}function yi(t){var i=t.stack.pop();switch(e.DEBUG&&console.log(t.step,"SZP1[]",i),t.zp1=i,i){case 0:t.tZone||ei(t),t.z1=t.tZone;break;case 1:t.z1=t.gZone;break;default:throw new Error("Invalid zone pointer")}}function _i(t){var i=t.stack.pop();switch(e.DEBUG&&console.log(t.step,"SZP2[]",i),t.zp2=i,i){case 0:t.tZone||ei(t),t.z2=t.tZone;break;case 1:t.z2=t.gZone;break;default:throw new Error("Invalid zone pointer")}}function xi(t){var i=t.stack.pop();switch(e.DEBUG&&console.log(t.step,"SZPS[]",i),t.zp0=t.zp1=t.zp2=i,i){case 0:t.tZone||ei(t),t.z0=t.z1=t.z2=t.tZone;break;case 1:t.z0=t.z1=t.z2=t.gZone;break;default:throw new Error("Invalid zone pointer")}}function wi(t){t.loop=t.stack.pop(),e.DEBUG&&console.log(t.step,"SLOOP[]",t.loop)}function bi(t){e.DEBUG&&console.log(t.step,"RTG[]"),t.round=qt}function vi(t){e.DEBUG&&console.log(t.step,"RTHG[]"),t.round=Wt}function Si(t){var i=t.stack.pop();e.DEBUG&&console.log(t.step,"SMD[]",i),t.minDis=i/64}function Ti(t){e.DEBUG&&console.log(t.step,"ELSE[]"),ti(t,!1)}function Ci(t){var i=t.stack.pop();e.DEBUG&&console.log(t.step,"JMPR[]",i),t.ip+=i-1}function Fi(t){var i=t.stack.pop();e.DEBUG&&console.log(t.step,"SCVTCI[]",i),t.cvCutIn=i/64}function Oi(t){var i=t.stack;e.DEBUG&&console.log(t.step,"DUP[]"),i.push(i[i.length-1])}function Ni(t){e.DEBUG&&console.log(t.step,"POP[]"),t.stack.pop()}function Ei(t){e.DEBUG&&console.log(t.step,"CLEAR[]"),t.stack.length=0}function Di(t){var i=t.stack,n=i.pop(),r=i.pop();e.DEBUG&&console.log(t.step,"SWAP[]"),i.push(n),i.push(r)}function Mi(t){var i=t.stack;e.DEBUG&&console.log(t.step,"DEPTH[]"),i.push(i.length)}function Vi(t){var i=t.stack,n=i.pop(),r=i.pop();e.DEBUG&&console.log(t.step,"LOOPCALL[]",n,r);var o=t.ip,s=t.prog;t.prog=t.funcs[n];for(var a=0;a<r;a++)ms(t),e.DEBUG&&console.log(++t.step,a+1<r?"next loopcall":"done loopcall",a);t.ip=o,t.prog=s}function Ii(t){var i=t.stack.pop();e.DEBUG&&console.log(t.step,"CALL[]",i);var n=t.ip,r=t.prog;t.prog=t.funcs[i],ms(t),t.ip=n,t.prog=r,e.DEBUG&&console.log(++t.step,"returning from",i)}function Bi(t){var i=t.stack,n=i.pop();e.DEBUG&&console.log(t.step,"CINDEX[]",n),i.push(i[i.length-n])}function Ai(t){var i=t.stack,n=i.pop();e.DEBUG&&console.log(t.step,"MINDEX[]",n),i.push(i.splice(i.length-n,1)[0])}function Pi(t){if("fpgm"!==t.env)throw new Error("FDEF not allowed here");var i=t.stack,n=t.prog,r=t.ip,o=i.pop(),s=r;for(e.DEBUG&&console.log(t.step,"FDEF[]",o);45!==n[++r];);t.ip=r,t.funcs[o]=n.slice(s+1,r)}function Ri(t,i){var n=i.stack.pop(),r=i.z0[n],o=i.fv,s=i.pv;e.DEBUG&&console.log(i.step,"MDAP["+t+"]",n);var a=s.distance(r,Ss);t&&(a=i.round(a)),o.setRelative(r,Ss,a,s),o.touch(r),i.rp0=i.rp1=n}function Li(t,i){var n,r,o,s=i.z2,a=s.length-2;e.DEBUG&&console.log(i.step,"IUP["+t.axis+"]");for(var u=0;u<a;u++)n=s[u],t.touched(n)||(r=n.prevTouched(t))!==n&&(o=n.nextTouched(t),r===o&&t.setRelative(n,n,t.distance(r,r,!1,!0),t,!0),t.interpolate(n,r,o,t))}function ki(t,i){for(var n=i.stack,r=t?i.rp1:i.rp2,o=(t?i.z0:i.z1)[r],s=i.fv,a=i.pv,u=i.loop,l=i.z2;u--;){var c=n.pop(),h=l[c],d=a.distance(o,o,!1,!0);s.setRelative(h,h,d,a),s.touch(h),e.DEBUG&&console.log(i.step,(i.loop>1?"loop "+(i.loop-u)+": ":"")+"SHP["+(t?"rp1":"rp2")+"]",c)}i.loop=1}function Ui(t,i){var n=i.stack,r=t?i.rp1:i.rp2,o=(t?i.z0:i.z1)[r],s=i.fv,a=i.pv,u=n.pop(),l=i.z2[i.contours[u]],c=l;e.DEBUG&&console.log(i.step,"SHC["+t+"]",u);var h=a.distance(o,o,!1,!0);do c!==o&&s.setRelative(c,c,h,a),c=c.nextPointOnContour;while(c!==l)}function Xi(t,i){var n=i.stack,r=t?i.rp1:i.rp2,o=(t?i.z0:i.z1)[r],s=i.fv,a=i.pv,u=n.pop();e.DEBUG&&console.log(i.step,"SHZ["+t+"]",u);var l;switch(u){case 0:l=i.tZone;break;case 1:l=i.gZone;break;default:throw new Error("Invalid zone")}for(var c,h=a.distance(o,o,!1,!0),d=l.length-2,p=0;p<d;p++)c=l[p],s.setRelative(c,c,h,a)}function zi(t){for(var i=t.stack,n=t.loop,r=t.fv,o=i.pop()/64,s=t.z2;n--;){var a=i.pop(),u=s[a];e.DEBUG&&console.log(t.step,(t.loop>1?"loop "+(t.loop-n)+": ":"")+"SHPIX[]",a,o),r.setRelative(u,u,o),r.touch(u)}t.loop=1}function ji(t){for(var i=t.stack,n=t.rp1,r=t.rp2,o=t.loop,s=t.z0[n],a=t.z1[r],u=t.fv,l=t.dpv,c=t.z2;o--;){var h=i.pop(),d=c[h];e.DEBUG&&console.log(t.step,(t.loop>1?"loop "+(t.loop-o)+": ":"")+"IP[]",h,n,"<->",r),u.interpolate(d,s,a,l),u.touch(d)}t.loop=1}function Gi(t,i){var n=i.stack,r=n.pop()/64,o=n.pop(),s=i.z1[o],a=i.z0[i.rp0],u=i.fv,l=i.pv;u.setRelative(s,a,r,l),u.touch(s),e.DEBUG&&console.log(i.step,"MSIRP["+t+"]",r,o),i.rp1=i.rp0,i.rp2=o,t&&(i.rp0=o)}function qi(t){for(var i=t.stack,n=t.rp0,r=t.z0[n],o=t.loop,s=t.fv,a=t.pv,u=t.z1;o--;){var l=i.pop(),c=u[l];e.DEBUG&&console.log(t.step,(t.loop>1?"loop "+(t.loop-o)+": ":"")+"ALIGNRP[]",l),s.setRelative(c,r,0,a),s.touch(c)}t.loop=1}function Hi(t){e.DEBUG&&console.log(t.step,"RTDG[]"),t.round=Ht}function Wi(t,i){var n=i.stack,r=n.pop(),o=n.pop(),s=i.z0[o],a=i.fv,u=i.pv,l=i.cvt[r];e.DEBUG&&console.log(i.step,"MIAP["+t+"]",r,"(",l,")",o);var c=u.distance(s,Ss);t&&(Math.abs(c-l)<i.cvCutIn&&(c=l),c=i.round(c)),a.setRelative(s,Ss,c,u),0===i.zp0&&(s.xo=s.x,s.yo=s.y),a.touch(s),i.rp0=i.rp1=o}function Yi(t){var i=t.prog,n=t.ip,r=t.stack,o=i[++n];e.DEBUG&&console.log(t.step,"NPUSHB[]",o);for(var s=0;s<o;s++)r.push(i[++n]);t.ip=n}function $i(t){var i=t.ip,n=t.prog,r=t.stack,o=n[++i];e.DEBUG&&console.log(t.step,"NPUSHW[]",o);for(var s=0;s<o;s++){var a=n[++i]<<8|n[++i];32768&a&&(a=-(1+(65535^a))),r.push(a)}t.ip=i}function Zi(t){var i=t.stack,n=t.store;n||(n=t.store=[]);var r=i.pop(),o=i.pop();e.DEBUG&&console.log(t.step,"WS",r,o),n[o]=r}function Ki(t){var i=t.stack,n=t.store,r=i.pop();e.DEBUG&&console.log(t.step,"RS",r);var o=n&&n[r]||0;i.push(o)}function Qi(t){var i=t.stack,n=i.pop(),r=i.pop();e.DEBUG&&console.log(t.step,"WCVTP",n,r),t.cvt[r]=n/64}function Ji(t){var i=t.stack,n=i.pop();e.DEBUG&&console.log(t.step,"RCVT",n),i.push(64*t.cvt[n])}function en(t,i){var n=i.stack,r=n.pop(),o=i.z2[r];e.DEBUG&&console.log(i.step,"GC["+t+"]",r),n.push(64*i.dpv.distance(o,Ss,t,!1))}function tn(t,i){var n=i.stack,r=n.pop(),o=n.pop(),s=i.z1[r],a=i.z0[o],u=i.dpv.distance(a,s,t,t);e.DEBUG&&console.log(i.step,"MD["+t+"]",r,o,"->",u),i.stack.push(Math.round(64*u))}function nn(t){e.DEBUG&&console.log(t.step,"MPPEM[]"),t.stack.push(t.ppem)}function rn(t){e.DEBUG&&console.log(t.step,"FLIPON[]"),t.autoFlip=!0}function on(t){var i=t.stack,n=i.pop(),r=i.pop();e.DEBUG&&console.log(t.step,"LT[]",n,r),i.push(r<n?1:0)}function sn(t){var i=t.stack,n=i.pop(),r=i.pop();e.DEBUG&&console.log(t.step,"LTEQ[]",n,r),i.push(r<=n?1:0)}function an(t){var i=t.stack,n=i.pop(),r=i.pop();e.DEBUG&&console.log(t.step,"GT[]",n,r),i.push(r>n?1:0)}function un(t){var i=t.stack,n=i.pop(),r=i.pop();e.DEBUG&&console.log(t.step,"GTEQ[]",n,r),i.push(r>=n?1:0)}function ln(t){var i=t.stack,n=i.pop(),r=i.pop();e.DEBUG&&console.log(t.step,"EQ[]",n,r),i.push(n===r?1:0)}function cn(t){var i=t.stack,n=i.pop(),r=i.pop();e.DEBUG&&console.log(t.step,"NEQ[]",n,r),i.push(n!==r?1:0)}function hn(t){var i=t.stack,n=i.pop();e.DEBUG&&console.log(t.step,"ODD[]",n),i.push(Math.trunc(n)%2?1:0)}function dn(t){var i=t.stack,n=i.pop();e.DEBUG&&console.log(t.step,"EVEN[]",n),i.push(Math.trunc(n)%2?0:1)}function pn(t){var i=t.stack.pop();e.DEBUG&&console.log(t.step,"IF[]",i),i||(ti(t,!0),e.DEBUG&&console.log(t.step,"EIF[]"))}function fn(t){e.DEBUG&&console.log(t.step,"EIF[]")}function gn(t){var i=t.stack,n=i.pop(),r=i.pop();e.DEBUG&&console.log(t.step,"AND[]",n,r),i.push(n&&r?1:0)}function mn(t){var i=t.stack,n=i.pop(),r=i.pop();e.DEBUG&&console.log(t.step,"OR[]",n,r),i.push(n||r?1:0)}function yn(t){var i=t.stack,n=i.pop();e.DEBUG&&console.log(t.step,"NOT[]",n),i.push(n?0:1)}function _n(t,i){var n=i.stack,r=n.pop(),o=i.fv,s=i.pv,a=i.ppem,u=i.deltaBase+16*(t-1),l=i.deltaShift,c=i.z0;e.DEBUG&&console.log(i.step,"DELTAP["+t+"]",r,n);for(var h=0;h<r;h++){var d=n.pop(),p=n.pop();if(u+((240&p)>>4)===a){var f=(15&p)-8;f>=0&&f++,e.DEBUG&&console.log(i.step,"DELTAPFIX",d,"by",f*l);var g=c[d];o.setRelative(g,g,f*l,s)}}}function xn(t){var i=t.stack,n=i.pop();e.DEBUG&&console.log(t.step,"SDB[]",n),t.deltaBase=n}function wn(t){var i=t.stack,n=i.pop();e.DEBUG&&console.log(t.step,"SDS[]",n),t.deltaShift=Math.pow(.5,n)}function bn(t){var i=t.stack,n=i.pop(),r=i.pop();e.DEBUG&&console.log(t.step,"ADD[]",n,r),i.push(r+n)}function vn(t){var i=t.stack,n=i.pop(),r=i.pop();e.DEBUG&&console.log(t.step,"SUB[]",n,r),i.push(r-n)}function Sn(t){var i=t.stack,n=i.pop(),r=i.pop();e.DEBUG&&console.log(t.step,"DIV[]",n,r),i.push(64*r/n)}function Tn(t){var i=t.stack,n=i.pop(),r=i.pop();e.DEBUG&&console.log(t.step,"MUL[]",n,r),i.push(r*n/64)}function Cn(t){var i=t.stack,n=i.pop();e.DEBUG&&console.log(t.step,"ABS[]",n),i.push(Math.abs(n))}function Fn(t){var i=t.stack,n=i.pop();e.DEBUG&&console.log(t.step,"NEG[]",n),i.push(-n)}function On(t){var i=t.stack,n=i.pop();e.DEBUG&&console.log(t.step,"FLOOR[]",n),i.push(64*Math.floor(n/64))}function Nn(t){var i=t.stack,n=i.pop();e.DEBUG&&console.log(t.step,"CEILING[]",n),i.push(64*Math.ceil(n/64))}function En(t,i){var n=i.stack,r=n.pop();e.DEBUG&&console.log(i.step,"ROUND[]"),n.push(64*i.round(r/64))}function Dn(t){var i=t.stack,n=i.pop(),r=i.pop();e.DEBUG&&console.log(t.step,"WCVTF[]",n,r),t.cvt[r]=n*t.ppem/t.font.unitsPerEm}function Mn(t,i){var n=i.stack,r=n.pop(),o=i.ppem,s=i.deltaBase+16*(t-1),a=i.deltaShift;e.DEBUG&&console.log(i.step,"DELTAC["+t+"]",r,n);for(var u=0;u<r;u++){var l=n.pop(),c=n.pop();if(s+((240&c)>>4)===o){var h=(15&c)-8;h>=0&&h++;var d=h*a;e.DEBUG&&console.log(i.step,"DELTACFIX",l,"by",d),i.cvt[l]+=d}}}function Vn(t){var i=t.stack.pop();e.DEBUG&&console.log(t.step,"SROUND[]",i),t.round=ws;var n;switch(192&i){case 0:n=.5;break;case 64:n=1;break;case 128:n=2;break;default:throw new Error("invalid SROUND value")}switch(t.srPeriod=n,48&i){case 0:t.srPhase=0;break;case 16:t.srPhase=.25*n;break;case 32:t.srPhase=.5*n;break;case 48:t.srPhase=.75*n;break;default:throw new Error("invalid SROUND value")}i&=15,t.srThreshold=0===i?0:(i/8-.5)*n}function In(t){var i=t.stack.pop();e.DEBUG&&console.log(t.step,"S45ROUND[]",i),t.round=ws;var n;switch(192&i){case 0:n=Math.sqrt(2)/2;break;case 64:n=Math.sqrt(2);break;case 128:n=2*Math.sqrt(2);break;default:throw new Error("invalid S45ROUND value")}switch(t.srPeriod=n,48&i){case 0:t.srPhase=0;break;case 16:t.srPhase=.25*n;break;case 32:t.srPhase=.5*n;break;case 48:t.srPhase=.75*n;break;default:throw new Error("invalid S45ROUND value")}i&=15,t.srThreshold=0===i?0:(i/8-.5)*n}function Bn(t){e.DEBUG&&console.log(t.step,"ROFF[]"),t.round=Gt}function An(t){e.DEBUG&&console.log(t.step,"RUTG[]"),t.round=Yt}function Pn(t){e.DEBUG&&console.log(t.step,"RDTG[]"),t.round=$t}function Rn(t){var i=t.stack.pop();e.DEBUG&&console.log(t.step,"SCANCTRL[]",i)}function Ln(t,i){var n=i.stack,r=n.pop(),o=n.pop(),s=i.z2[r],a=i.z1[o];e.DEBUG&&console.log(i.step,"SDPVTL["+t+"]",r,o);var u,l;t?(u=s.y-a.y,l=a.x-s.x):(u=a.x-s.x,l=a.y-s.y),i.dpv=Kt(u,l)}function kn(t){var i=t.stack,n=i.pop(),r=0;e.DEBUG&&console.log(t.step,"GETINFO[]",n),1&n&&(r=35),32&n&&(r|=4096),i.push(r)}function Un(t){var i=t.stack,n=i.pop(),r=i.pop(),o=i.pop();e.DEBUG&&console.log(t.step,"ROLL[]"),i.push(r),i.push(n),i.push(o)}function Xn(t){var i=t.stack,n=i.pop(),r=i.pop();e.DEBUG&&console.log(t.step,"MAX[]",n,r),i.push(Math.max(r,n))}function zn(t){var i=t.stack,n=i.pop(),r=i.pop();e.DEBUG&&console.log(t.step,"MIN[]",n,r),i.push(Math.min(r,n))}function jn(t){var i=t.stack.pop();e.DEBUG&&console.log(t.step,"SCANTYPE[]",i)}function Gn(t){var i=t.stack.pop(),n=t.stack.pop();switch(e.DEBUG&&console.log(t.step,"INSTCTRL[]",i,n),i){case 1:return void(t.inhibitGridFit=!!n);case 2:return void(t.ignoreCvt=!!n);default:throw new Error("invalid INSTCTRL[] selector")}}function qn(t,i){var n=i.stack,r=i.prog,o=i.ip;e.DEBUG&&console.log(i.step,"PUSHB["+t+"]");for(var s=0;s<t;s++)n.push(r[++o]);i.ip=o}function Hn(t,i){var n=i.ip,r=i.prog,o=i.stack;e.DEBUG&&console.log(i.ip,"PUSHW["+t+"]");for(var s=0;s<t;s++){var a=r[++n]<<8|r[++n];32768&a&&(a=-(1+(65535^a))),o.push(a)}i.ip=n}function Wn(t,i,n,r,o,s){var a,u,l,c,h=s.stack,d=t&&h.pop(),p=h.pop(),f=s.rp0,g=s.z0[f],m=s.z1[p],y=s.minDis,_=s.fv,x=s.dpv;u=a=x.distance(m,g,!0,!0),l=u>=0?1:-1,u=Math.abs(u),t&&(c=s.cvt[d],r&&Math.abs(u-c)<s.cvCutIn&&(u=c)),n&&u<y&&(u=y),r&&(u=s.round(u)),_.setRelative(m,g,l*u,x),_.touch(m),e.DEBUG&&console.log(s.step,(t?"MIRP[":"MDRP[")+(i?"M":"m")+(n?">":"_")+(r?"R":"_")+(0===o?"Gr":1===o?"Bl":2===o?"Wh":"")+"]",t?d+"("+s.cvt[d]+","+c+")":"",p,"(d =",a,"->",l*u,")"),s.rp1=s.rp0,s.rp2=p,i&&(s.rp0=p)}function Yn(e){this.char=e,this.state={},this.activeState=null}function $n(e,t,i){this.contextName=i,this.startIndex=e,this.endOffset=t}function Zn(e,t,i){this.contextName=e,this.openRange=null,this.ranges=[],this.checkStart=t,this.checkEnd=i}function Kn(e,t){this.context=e,this.index=t,this.length=e.length,this.current=e[t],this.backtrack=e.slice(0,t),this.lookahead=e.slice(t+1)}function Qn(e){this.eventId=e,this.subscribers=[]}function Jn(e){var t=this,i=["start","end","next","newToken","contextStart","contextEnd","insertToken","removeToken","removeRange","replaceToken","replaceRange","composeRUD","updateContextsRanges"];i.forEach(function(e){Object.defineProperty(t.events,e,{value:new Qn(e)})}),e&&i.forEach(function(i){var n=e[i];"function"==typeof n&&t.events[i].subscribe(n)}),["insertToken","removeToken","removeRange","replaceToken","replaceRange","composeRUD"].forEach(function(e){t.events[e].subscribe(t.updateContextsRanges)})}function er(e){this.tokens=[],this.registeredContexts={},this.contextCheckers=[],this.events={},this.registeredModifiers=[],Jn.call(this,e)}function tr(e){return/[\u0600-\u065F\u066A-\u06D2\u06FA-\u06FF]/.test(e)}function ir(e){return/[\u0630\u0690\u0621\u0631\u0661\u0671\u0622\u0632\u0672\u0692\u06C2\u0623\u0673\u0693\u06C3\u0624\u0694\u06C4\u0625\u0675\u0695\u06C5\u06E5\u0676\u0696\u06C6\u0627\u0677\u0697\u06C7\u0648\u0688\u0698\u06C8\u0689\u0699\u06C9\u068A\u06CA\u066B\u068B\u06CB\u068C\u068D\u06CD\u06FD\u068E\u06EE\u06FE\u062F\u068F\u06CF\u06EF]/.test(e)}function nr(e){return/[\u0600-\u0605\u060C-\u060E\u0610-\u061B\u061E\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED]/.test(e)}function rr(e){return/[A-z]/.test(e)}function or(e){return/\s/.test(e)}function sr(e){this.font=e,this.features={}}function ar(e){this.id=e.id,this.tag=e.tag,this.substitution=e.substitution}function ur(e,t){if(!e)return-1;switch(t.format){case 1:return t.glyphs.indexOf(e);case 2:for(var i=t.ranges,n=0;n<i.length;n++){var r=i[n];if(e>=r.start&&e<=r.end){var o=e-r.start;return r.index+o}}break;default:return-1}return-1}function lr(e,t){return ur(e,t.coverage)===-1?null:e+t.deltaGlyphId}function cr(e,t){var i=ur(e,t.coverage);return i===-1?null:t.substitute[i]}function hr(e,t){for(var i=[],n=0;n<e.length;n++){var r=e[n],o=t.current;o=Array.isArray(o)?o[0]:o;var s=ur(o,r);s!==-1&&i.push(s)}return i.length!==e.length?-1:i}function dr(e,t){var i=t.inputCoverage.length+t.lookaheadCoverage.length+t.backtrackCoverage.length;if(e.context.length<i)return[];var n=hr(t.inputCoverage,e);if(n===-1)return[];var r=t.inputCoverage.length-1;if(e.lookahead.length<t.lookaheadCoverage.length)return[];for(var o=e.lookahead.slice(r);o.length&&nr(o[0].char);)o.shift();var s=new Kn(o,0),a=hr(t.lookaheadCoverage,s),u=[].concat(e.backtrack);for(u.reverse();u.length&&nr(u[0].char);)u.shift();if(u.length<t.backtrackCoverage.length)return[];var l=new Kn(u,0),c=hr(t.backtrackCoverage,l),h=n.length===t.inputCoverage.length&&a.length===t.lookaheadCoverage.length&&c.length===t.backtrackCoverage.length,d=[];if(h)for(var p=0;p<t.lookupRecords.length;p++)for(var f=t.lookupRecords[p],g=f.lookupListIndex,m=this.getLookupByIndex(g),y=0;y<m.subtables.length;y++){var _=m.subtables[y],x=this.getLookupMethod(m,_),w=this.getSubstitutionType(m,_);if("12"===w)for(var b=0;b<n.length;b++){var v=e.get(b),S=x(v);S&&d.push(S)}}return d}function pr(e,t){var i=e.current,n=ur(i,t.coverage);if(n===-1)return null;for(var r,o=t.ligatureSets[n],s=0;s<o.length;s++){r=o[s];for(var a=0;a<r.components.length;a++){if(e.lookahead[a]!==r.components[a])break;if(a===r.components.length-1)return r}}return null}function fr(e,t){var i=ur(e,t.coverage);return i===-1?null:t.sequences[i]}function gr(e){var t=e.current,i=e.get(-1);return null===i&&tr(t)||!tr(i)&&tr(t)}function mr(e){var t=e.get(1);return null===t||!tr(t)}function yr(e){var t=e.current,i=e.get(-1);return(tr(t)||nr(t))&&!tr(i)}function _r(e){var t=e.get(1);switch(!0){case null===t:return!0;case!tr(t)&&!nr(t):var i=or(t);if(!i)return!0;if(i){if(!e.lookahead.some(function(e){return tr(e)||nr(e)}))return!0}break;default:return!1}}function xr(e,t,i){t[i].setState(e.tag,e.substitution)}function wr(e,t,i){t[i].setState(e.tag,e.substitution)}function br(e,t,i){e.substitution.forEach(function(n,r){t[i+r].setState(e.tag,n)})}function vr(e,t,i){var n=t[i];n.setState(e.tag,e.substitution.ligGlyph);for(var r=e.substitution.components.length,o=0;o<r;o++)n=t[i+o+1],n.setState("deleted",!0)}function Sr(e,t,i){e instanceof ar&&Os[e.id]&&Os[e.id](e,t,i)}function Tr(e){for(var t=[].concat(e.backtrack),i=t.length-1;i>=0;i--){var n=t[i],r=ir(n),o=nr(n);if(!r&&!o)return!0;if(r)return!1}return!1}function Cr(e){if(ir(e.current))return!1;for(var t=0;t<e.lookahead.length;t++){if(!nr(e.lookahead[t]))return!0}return!1}function Fr(e){var t=this,i=this.featuresTags.arab,n=this.tokenizer.getRangeTokens(e);if(1!==n.length){var r=new Kn(n.map(function(e){return e.getState("glyphIndex")}),0),o=new Kn(n.map(function(e){return e.char}),0);n.forEach(function(e,s){if(!nr(e.char)){r.setCurrentIndex(s),o.setCurrentIndex(s);var a=0;Tr(o)&&(a|=1),Cr(o)&&(a|=2);var u;switch(a){case 1:u="fina";break;case 2:u="init";break;case 3:u="medi"}if(i.indexOf(u)!==-1){var l=t.query.lookupFeature({tag:u,script:"arab",contextParams:r});if(l instanceof Error)return console.info(l.message);l.forEach(function(e,t){e instanceof ar&&(Sr(e,n,t),r.context[t]=e.substitution)})}}})}}function Or(e,t){return new Kn(e.map(function(e){return e.activeState.value}),t||0)}function Nr(e){var t=this,i=this.tokenizer.getRangeTokens(e),n=Or(i);n.context.forEach(function(e,r){n.setCurrentIndex(r);var o=t.query.lookupFeature({tag:"rlig",script:"arab",contextParams:n});o.length&&(o.forEach(function(e){return Sr(e,i,r)}),n=Or(i))})}function Er(e){var t=e.current,i=e.get(-1);return null===i&&rr(t)||!rr(i)&&rr(t)}function Dr(e){var t=e.get(1);return null===t||!rr(t)}function Mr(e,t){return new Kn(e.map(function(e){return e.activeState.value}),t||0)}function Vr(e){var t=this,i=this.tokenizer.getRangeTokens(e),n=Mr(i);n.context.forEach(function(e,r){n.setCurrentIndex(r);var o=t.query.lookupFeature({tag:"liga",script:"latn",contextParams:n});o.length&&(o.forEach(function(e){return Sr(e,i,r)}),n=Mr(i))})}function Ir(e){this.baseDir=e||"ltr",this.tokenizer=new er,this.featuresTags={}}function Br(e){var t=this.contextChecks[e+"Check"];return this.tokenizer.registerContextChecker(e,t.startCheck,t.endCheck)}function Ar(){return Br.call(this,"latinWord"),Br.call(this,"arabicWord"),Br.call(this,"arabicSentence"),this.tokenizer.tokenize(this.text)}function Pr(){var e=this;this.tokenizer.getContextRanges("arabicSentence").forEach(function(t){var i=e.tokenizer.getRangeTokens(t);e.tokenizer.replaceRange(t.startIndex,t.endOffset,i.reverse())})}function Rr(){if(this.tokenizer.registeredModifiers.indexOf("glyphIndex")===-1)throw new Error("glyphIndex modifier is required to apply arabic presentation features.")}function Lr(){var e=this;if(this.featuresTags.hasOwnProperty("arab")){Rr.call(this);this.tokenizer.getContextRanges("arabicWord").forEach(function(t){Fr.call(e,t)})}}function kr(){var e=this;if(this.featuresTags.hasOwnProperty("arab")){if(this.featuresTags.arab.indexOf("rlig")!==-1){Rr.call(this);this.tokenizer.getContextRanges("arabicWord").forEach(function(t){Nr.call(e,t)})}}}function Ur(){var e=this;if(this.featuresTags.hasOwnProperty("latn")){if(this.featuresTags.latn.indexOf("liga")!==-1){Rr.call(this);this.tokenizer.getContextRanges("latinWord").forEach(function(t){Vr.call(e,t)})}}}function Xr(e){e=e||{},e.tables=e.tables||{},e.empty||(It(e.familyName,"When creating a new Font object, familyName is required."),It(e.styleName,"When creating a new Font object, styleName is required."),It(e.unitsPerEm,"When creating a new Font object, unitsPerEm is required."),It(e.ascender,"When creating a new Font object, ascender is required."),It(e.descender<=0,"When creating a new Font object, negative descender value is required."),this.names={fontFamily:{en:e.familyName||" "},fontSubfamily:{en:e.styleName||" "},fullName:{en:e.fullName||e.familyName+" "+e.styleName},postScriptName:{en:e.postScriptName||(e.familyName+e.styleName).replace(/\s/g,"")},designer:{en:e.designer||" "},designerURL:{en:e.designerURL||" "},manufacturer:{en:e.manufacturer||" "},manufacturerURL:{en:e.manufacturerURL||" "},license:{en:e.license||" "},licenseURL:{en:e.licenseURL||" "},version:{en:e.version||"Version 0.1"},description:{en:e.description||" "},copyright:{en:e.copyright||" "},trademark:{en:e.trademark||" "}},this.unitsPerEm=e.unitsPerEm||1e3,this.ascender=e.ascender,this.descender=e.descender,this.createdTimestamp=e.createdTimestamp,this.tables=Object.assign(e.tables,{os2:Object.assign({usWeightClass:e.weightClass||this.usWeightClasses.MEDIUM,usWidthClass:e.widthClass||this.usWidthClasses.MEDIUM,fsSelection:e.fsSelection||this.fsSelectionValues.REGULAR},e.tables.os2)})),this.supported=!0,this.glyphs=new jo.GlyphSet(this,e.glyphs||[]),this.encoding=new H(this),this.position=new Ft(this),this.substitution=new Ot(this),this.tables=this.tables||{},this._push=null,this._hmtxTableData={},Object.defineProperty(this,"hinting",{get:function(){return this._hinting?this._hinting:"truetype"===this.outlinesFormat?this._hinting=new jt(this):void 0}})}function zr(e,t){var i=JSON.stringify(e),n=256;for(var r in t){var o=parseInt(r);if(o&&!(o<256)){if(JSON.stringify(t[r])===i)return o;n<=o&&(n=o+1)}}return t[n]=e,n}function jr(e,t,i){var n=zr(t.name,i);return[{name:"tag_"+e,type:"TAG",value:t.tag},{name:"minValue_"+e,type:"FIXED",value:t.minValue<<16},{name:"defaultValue_"+e,type:"FIXED",value:t.defaultValue<<16},{name:"maxValue_"+e,type:"FIXED",value:t.maxValue<<16},{name:"flags_"+e,type:"USHORT",value:0},{name:"nameID_"+e,type:"USHORT",value:n}]}function Gr(e,t,i){var n={},r=new Po.Parser(e,t);return n.tag=r.parseTag(),n.minValue=r.parseFixed(),n.defaultValue=r.parseFixed(),n.maxValue=r.parseFixed(),r.skip("uShort",1),n.name=i[r.parseUShort()]||{},n}function qr(e,t,i,n){for(var r=zr(t.name,n),o=[{name:"nameID_"+e,type:"USHORT",value:r},{name:"flags_"+e,type:"USHORT",value:0}],s=0;s<i.length;++s){var a=i[s].tag;o.push({name:"axis_"+e+" "+a,type:"FIXED",value:t.coordinates[a]<<16})}return o}function Hr(e,t,i,n){var r={},o=new Po.Parser(e,t);r.name=n[o.parseUShort()]||{},o.skip("uShort",1),r.coordinates={};for(var s=0;s<i.length;++s)r.coordinates[i[s].tag]=o.parseFixed();return r}function Wr(e,t){var i=new Io.Table("fvar",[{name:"version",type:"ULONG",value:65536},{name:"offsetToData",type:"USHORT",value:0},{name:"countSizePairs",type:"USHORT",value:2},{name:"axisCount",type:"USHORT",value:e.axes.length},{name:"axisSize",type:"USHORT",value:20},{name:"instanceCount",type:"USHORT",value:e.instances.length},{name:"instanceSize",type:"USHORT",value:4+4*e.axes.length}]);i.offsetToData=i.sizeOf();for(var n=0;n<e.axes.length;n++)i.fields=i.fields.concat(jr(n,e.axes[n],t));for(var r=0;r<e.instances.length;r++)i.fields=i.fields.concat(qr(r,e.instances[r],e.axes,t));return i}function Yr(e,t,i){var n=new Po.Parser(e,t),r=n.parseULong();To.argument(65536===r,"Unsupported fvar table version.");var o=n.parseOffset16();n.skip("uShort",1);for(var s=n.parseUShort(),a=n.parseUShort(),u=n.parseUShort(),l=n.parseUShort(),c=[],h=0;h<s;h++)c.push(Gr(e,t+o+h*a,i));for(var d=[],p=t+o+s*a,f=0;f<u;f++)d.push(Hr(e,p+f*l,c,i));return{axes:c,instances:d}}
function $r(e,t){t=t||0;var i=new k(e,t),n=i.parseVersion(1);To.argument(1===n||1.2===n||1.3===n,"Unsupported GDEF table version.");var r={version:n,classDef:i.parsePointer(k.classDef),attachList:i.parsePointer(Ds),ligCaretList:i.parsePointer(Is),markAttachClassDef:i.parsePointer(k.classDef)};return n>=1.2&&(r.markGlyphSets=i.parsePointer(Bs)),r}function Zr(e,t){t=t||0;var i=new k(e,t),n=i.parseVersion(1);return To.argument(1===n||1.1===n,"Unsupported GPOS table version "+n),1===n?{version:n,scripts:i.parseScriptList(),features:i.parseFeatureList(),lookups:i.parseLookupList(Ps)}:{version:n,scripts:i.parseScriptList(),features:i.parseFeatureList(),lookups:i.parseLookupList(Ps),variations:i.parseFeatureVariationsList()}}function Kr(e){return new Io.Table("GPOS",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new Io.ScriptList(e.scripts)},{name:"features",type:"TABLE",value:new Io.FeatureList(e.features)},{name:"lookups",type:"TABLE",value:new Io.LookupList(e.lookups,Rs)}])}function Qr(e){var t={};e.skip("uShort");var i=e.parseUShort();To.argument(0===i,"Unsupported kern sub-table version."),e.skip("uShort",2);var n=e.parseUShort();e.skip("uShort",3);for(var r=0;r<n;r+=1){var o=e.parseUShort(),s=e.parseUShort(),a=e.parseShort();t[o+","+s]=a}return t}function Jr(e){var t={};e.skip("uShort"),e.parseULong()>1&&console.warn("Only the first kern subtable is supported."),e.skip("uLong");var i=e.parseUShort(),n=255&i;if(e.skip("uShort"),0===n){var r=e.parseUShort();e.skip("uShort",3);for(var o=0;o<r;o+=1){var s=e.parseUShort(),a=e.parseUShort(),u=e.parseShort();t[s+","+a]=u}}return t}function eo(e,t){var i=new Po.Parser(e,t),n=i.parseUShort();if(0===n)return Qr(i);if(1===n)return Jr(i);throw new Error("Unsupported kern table version ("+n+").")}function to(e,t,i,n){for(var r=new Po.Parser(e,t),o=n?r.parseUShort:r.parseULong,s=[],a=0;a<i+1;a+=1){var u=o.call(r);n&&(u*=2),s.push(u)}return s}function io(e,t){require("fs").readFile(e,function(e,i){if(e)return t(e.message);t(null,Mt(i))})}function no(e,t){var i=new XMLHttpRequest;i.open("get",e,!0),i.responseType="arraybuffer",i.onload=function(){return i.response?t(null,i.response):t("Font could not be loaded: "+i.statusText)},i.onerror=function(){t("Font could not be loaded")},i.send()}function ro(e,t){for(var i=[],n=12,r=0;r<t;r+=1){var o=Po.getTag(e,n),s=Po.getULong(e,n+4),a=Po.getULong(e,n+8),u=Po.getULong(e,n+12);i.push({tag:o,checksum:s,offset:a,length:u,compression:!1}),n+=16}return i}function oo(e,t){for(var i=[],n=44,r=0;r<t;r+=1){var o=Po.getTag(e,n),s=Po.getULong(e,n+4),a=Po.getULong(e,n+8),u=Po.getULong(e,n+12),l=void 0;l=a<u&&"WOFF",i.push({tag:o,offset:s,compression:l,compressedLength:a,length:u}),n+=20}return i}function so(e,t){if("WOFF"===t.compression){var i=new Uint8Array(e.buffer,t.offset+2,t.compressedLength-2),n=new Uint8Array(t.length);if(So(i,n),n.byteLength!==t.length)throw new Error("Decompression error: "+t.tag+" decompressed length doesn't match recorded length");return{data:new DataView(n.buffer,0),offset:0}}return{data:e,offset:t.offset}}function ao(e,t){t=void 0===t||null===t?{}:t;var i,n,r,o=new Xr({empty:!0}),s=new DataView(e,0),a=[],u=Po.getTag(s,0);if(u===String.fromCharCode(0,1,0,0)||"true"===u||"typ1"===u)o.outlinesFormat="truetype",r=Po.getUShort(s,4),a=ro(s,r);else if("OTTO"===u)o.outlinesFormat="cff",r=Po.getUShort(s,4),a=ro(s,r);else{if("wOFF"!==u)throw new Error("Unsupported OpenType signature "+u);var l=Po.getTag(s,4);if(l===String.fromCharCode(0,1,0,0))o.outlinesFormat="truetype";else{if("OTTO"!==l)throw new Error("Unsupported OpenType flavor "+u);o.outlinesFormat="cff"}r=Po.getUShort(s,12),a=oo(s,r)}for(var c,h,d,p,f,g,m,y,_,x,w,b,v=0;v<r;v+=1){var S=a[v],T=void 0;switch(S.tag){case"cmap":T=so(s,S),o.tables.cmap=Ro.parse(T.data,T.offset),o.encoding=new W(o.tables.cmap);break;case"cvt ":T=so(s,S),b=new Po.Parser(T.data,T.offset),o.tables.cvt=b.parseShortList(S.length/2);break;case"fvar":h=S;break;case"fpgm":T=so(s,S),b=new Po.Parser(T.data,T.offset),o.tables.fpgm=b.parseByteList(S.length);break;case"head":T=so(s,S),o.tables.head=Wo.parse(T.data,T.offset),o.unitsPerEm=o.tables.head.unitsPerEm,i=o.tables.head.indexToLocFormat;break;case"hhea":T=so(s,S),o.tables.hhea=Yo.parse(T.data,T.offset),o.ascender=o.tables.hhea.ascender,o.descender=o.tables.hhea.descender,o.numberOfHMetrics=o.tables.hhea.numberOfHMetrics;break;case"hmtx":m=S;break;case"ltag":T=so(s,S),n=Zo.parse(T.data,T.offset);break;case"maxp":T=so(s,S),o.tables.maxp=Ko.parse(T.data,T.offset),o.numGlyphs=o.tables.maxp.numGlyphs;break;case"name":x=S;break;case"OS/2":T=so(s,S),o.tables.os2=as.parse(T.data,T.offset);break;case"post":T=so(s,S),o.tables.post=us.parse(T.data,T.offset),o.glyphNames=new $(o.tables.post);break;case"prep":T=so(s,S),b=new Po.Parser(T.data,T.offset),o.tables.prep=b.parseByteList(S.length);break;case"glyf":d=S;break;case"loca":_=S;break;case"CFF ":c=S;break;case"kern":y=S;break;case"GDEF":p=S;break;case"GPOS":f=S;break;case"GSUB":g=S;break;case"meta":w=S}}var C=so(s,x);if(o.tables.name=os.parse(C.data,C.offset,n),o.names=o.tables.name,d&&_){var F=0===i,O=so(s,_),N=Us.parse(O.data,O.offset,o.numGlyphs,F),E=so(s,d);o.glyphs=xs.parse(E.data,E.offset,N,o,t)}else{if(!c)throw new Error("Font doesn't contain TrueType or CFF outlines.");var D=so(s,c);Ho.parse(D.data,D.offset,o,t)}var M=so(s,m);if($o.parse(o,M.data,M.offset,o.numberOfHMetrics,o.numGlyphs,o.glyphs,t),Q(o,t),y){var V=so(s,y);o.kerningPairs=ks.parse(V.data,V.offset)}else o.kerningPairs={};if(p){var I=so(s,p);o.tables.gdef=As.parse(I.data,I.offset)}if(f){var B=so(s,f);o.tables.gpos=Ls.parse(B.data,B.offset),o.position.init()}if(g){var A=so(s,g);o.tables.gsub=ds.parse(A.data,A.offset)}if(h){var P=so(s,h);o.tables.fvar=Es.parse(P.data,P.offset,o.names)}if(w){var R=so(s,w);o.tables.meta=ps.parse(R.data,R.offset),o.metas=o.tables.meta}return o}function uo(e,t,i){i=void 0===i||null===i?{}:i;var n="undefined"==typeof window,r=n&&!i.isUrl?io:no;return new Promise(function(n,o){r(e,function(e,r){if(e){if(t)return t(e);o(e)}var s;try{s=ao(r,i)}catch(e){if(t)return t(e,null);o(e)}if(t)return t(null,s);n(s)})})}function lo(e,t){return ao(Mt(require("fs").readFileSync(e)),t)}String.prototype.codePointAt||function(){var e=function(){try{var e={},t=Object.defineProperty,i=t(e,e,e)&&t}catch(e){}return i}(),t=function(e){if(null==this)throw TypeError();var t=String(this),i=t.length,n=e?Number(e):0;if(n!=n&&(n=0),!(n<0||n>=i)){var r,o=t.charCodeAt(n);return o>=55296&&o<=56319&&i>n+1&&(r=t.charCodeAt(n+1))>=56320&&r<=57343?1024*(o-55296)+r-56320+65536:o}};e?e(String.prototype,"codePointAt",{value:t,configurable:!0,writable:!0}):String.prototype.codePointAt=t}();var co=0,ho=-3,po=new t,fo=new t,go=new Uint8Array(30),mo=new Uint16Array(30),yo=new Uint8Array(30),_o=new Uint16Array(30),xo=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),wo=new t,bo=new Uint8Array(320),vo=new Uint16Array(16);!function(e,t){var i;for(i=0;i<7;++i)e.table[i]=0;for(e.table[7]=24,e.table[8]=152,e.table[9]=112,i=0;i<24;++i)e.trans[i]=256+i;for(i=0;i<144;++i)e.trans[24+i]=i;for(i=0;i<8;++i)e.trans[168+i]=280+i;for(i=0;i<112;++i)e.trans[176+i]=144+i;for(i=0;i<5;++i)t.table[i]=0;for(t.table[5]=32,i=0;i<32;++i)t.trans[i]=i}(po,fo),n(go,mo,4,3),n(yo,_o,2,1),go[28]=0,mo[28]=258;var So=h;p.prototype.isEmpty=function(){return isNaN(this.x1)||isNaN(this.y1)||isNaN(this.x2)||isNaN(this.y2)},p.prototype.addPoint=function(e,t){"number"==typeof e&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=e,this.x2=e),e<this.x1&&(this.x1=e),e>this.x2&&(this.x2=e)),"number"==typeof t&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=t,this.y2=t),t<this.y1&&(this.y1=t),t>this.y2&&(this.y2=t))},p.prototype.addX=function(e){this.addPoint(e,null)},p.prototype.addY=function(e){this.addPoint(null,e)},p.prototype.addBezier=function(e,t,i,n,r,o,s,a){var u=[e,t],l=[i,n],c=[r,o],h=[s,a];this.addPoint(e,t),this.addPoint(s,a);for(var p=0;p<=1;p++){var f=6*u[p]-12*l[p]+6*c[p],g=-3*u[p]+9*l[p]-9*c[p]+3*h[p],m=3*l[p]-3*u[p];if(0!==g){var y=Math.pow(f,2)-4*m*g;if(!(y<0)){var _=(-f+Math.sqrt(y))/(2*g);0<_&&_<1&&(0===p&&this.addX(d(u[p],l[p],c[p],h[p],_)),1===p&&this.addY(d(u[p],l[p],c[p],h[p],_)));var x=(-f-Math.sqrt(y))/(2*g);0<x&&x<1&&(0===p&&this.addX(d(u[p],l[p],c[p],h[p],x)),1===p&&this.addY(d(u[p],l[p],c[p],h[p],x)))}}else{if(0===f)continue;var w=-m/f;0<w&&w<1&&(0===p&&this.addX(d(u[p],l[p],c[p],h[p],w)),1===p&&this.addY(d(u[p],l[p],c[p],h[p],w)))}}},p.prototype.addQuad=function(e,t,i,n,r,o){var s=e+2/3*(i-e),a=t+2/3*(n-t),u=s+1/3*(r-e),l=a+1/3*(o-t);this.addBezier(e,t,s,a,u,l,r,o)},f.prototype.moveTo=function(e,t){this.commands.push({type:"M",x:e,y:t})},f.prototype.lineTo=function(e,t){this.commands.push({type:"L",x:e,y:t})},f.prototype.curveTo=f.prototype.bezierCurveTo=function(e,t,i,n,r,o){this.commands.push({type:"C",x1:e,y1:t,x2:i,y2:n,x:r,y:o})},f.prototype.quadTo=f.prototype.quadraticCurveTo=function(e,t,i,n){this.commands.push({type:"Q",x1:e,y1:t,x:i,y:n})},f.prototype.close=f.prototype.closePath=function(){this.commands.push({type:"Z"})},f.prototype.extend=function(e){if(e.commands)e=e.commands;else if(e instanceof p){var t=e;return this.moveTo(t.x1,t.y1),this.lineTo(t.x2,t.y1),this.lineTo(t.x2,t.y2),this.lineTo(t.x1,t.y2),void this.close()}Array.prototype.push.apply(this.commands,e)},f.prototype.getBoundingBox=function(){for(var e=new p,t=0,i=0,n=0,r=0,o=0;o<this.commands.length;o++){var s=this.commands[o];switch(s.type){case"M":e.addPoint(s.x,s.y),t=n=s.x,i=r=s.y;break;case"L":e.addPoint(s.x,s.y),n=s.x,r=s.y;break;case"Q":e.addQuad(n,r,s.x1,s.y1,s.x,s.y),n=s.x,r=s.y;break;case"C":e.addBezier(n,r,s.x1,s.y1,s.x2,s.y2,s.x,s.y),n=s.x,r=s.y;break;case"Z":n=t,r=i;break;default:throw new Error("Unexpected path command "+s.type)}}return e.isEmpty()&&e.addPoint(0,0),e},f.prototype.draw=function(e){e.beginPath();for(var t=0;t<this.commands.length;t+=1){var i=this.commands[t];"M"===i.type?e.moveTo(i.x,i.y):"L"===i.type?e.lineTo(i.x,i.y):"C"===i.type?e.bezierCurveTo(i.x1,i.y1,i.x2,i.y2,i.x,i.y):"Q"===i.type?e.quadraticCurveTo(i.x1,i.y1,i.x,i.y):"Z"===i.type&&e.closePath()}this.fill&&(e.fillStyle=this.fill,e.fill()),this.stroke&&(e.strokeStyle=this.stroke,e.lineWidth=this.strokeWidth,e.stroke())},f.prototype.toPathData=function(e){function t(t){return Math.round(t)===t?""+Math.round(t):t.toFixed(e)}function i(){for(var e=arguments,i="",n=0;n<arguments.length;n+=1){var r=e[n];r>=0&&n>0&&(i+=" "),i+=t(r)}return i}e=void 0!==e?e:2;for(var n="",r=0;r<this.commands.length;r+=1){var o=this.commands[r];"M"===o.type?n+="M"+i(o.x,o.y):"L"===o.type?n+="L"+i(o.x,o.y):"C"===o.type?n+="C"+i(o.x1,o.y1,o.x2,o.y2,o.x,o.y):"Q"===o.type?n+="Q"+i(o.x1,o.y1,o.x,o.y):"Z"===o.type&&(n+="Z")}return n},f.prototype.toSVG=function(e){var t='<path d="';return t+=this.toPathData(e),t+='"',this.fill&&"black"!==this.fill&&(t+=null===this.fill?' fill="none"':' fill="'+this.fill+'"'),this.stroke&&(t+=' stroke="'+this.stroke+'" stroke-width="'+this.strokeWidth+'"'),t+="/>"},f.prototype.toDOMElement=function(e){var t=this.toPathData(e),i=document.createElementNS("http://www.w3.org/2000/svg","path");return i.setAttribute("d",t),i};var To={fail:g,argument:m,assert:m},Co={},Fo={},Oo={};Fo.BYTE=function(e){return To.argument(e>=0&&e<=255,"Byte value should be between 0 and 255."),[e]},Oo.BYTE=y(1),Fo.CHAR=function(e){return[e.charCodeAt(0)]},Oo.CHAR=y(1),Fo.CHARARRAY=function(e){void 0===e&&(e="",console.warn("Undefined CHARARRAY encountered and treated as an empty string. This is probably caused by a missing glyph name."));for(var t=[],i=0;i<e.length;i+=1)t[i]=e.charCodeAt(i);return t},Oo.CHARARRAY=function(e){return void 0===e?0:e.length},Fo.USHORT=function(e){return[e>>8&255,255&e]},Oo.USHORT=y(2),Fo.SHORT=function(e){return e>=32768&&(e=-(65536-e)),[e>>8&255,255&e]},Oo.SHORT=y(2),Fo.UINT24=function(e){return[e>>16&255,e>>8&255,255&e]},Oo.UINT24=y(3),Fo.ULONG=function(e){return[e>>24&255,e>>16&255,e>>8&255,255&e]},Oo.ULONG=y(4),Fo.LONG=function(e){return e>=2147483648&&(e=-(4294967296-e)),[e>>24&255,e>>16&255,e>>8&255,255&e]},Oo.LONG=y(4),Fo.FIXED=Fo.ULONG,Oo.FIXED=Oo.ULONG,Fo.FWORD=Fo.SHORT,Oo.FWORD=Oo.SHORT,Fo.UFWORD=Fo.USHORT,Oo.UFWORD=Oo.USHORT,Fo.LONGDATETIME=function(e){return[0,0,0,0,e>>24&255,e>>16&255,e>>8&255,255&e]},Oo.LONGDATETIME=y(8),Fo.TAG=function(e){return To.argument(4===e.length,"Tag should be exactly 4 ASCII characters."),[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]},Oo.TAG=y(4),Fo.Card8=Fo.BYTE,Oo.Card8=Oo.BYTE,Fo.Card16=Fo.USHORT,Oo.Card16=Oo.USHORT,Fo.OffSize=Fo.BYTE,Oo.OffSize=Oo.BYTE,Fo.SID=Fo.USHORT,Oo.SID=Oo.USHORT,Fo.NUMBER=function(e){return e>=-107&&e<=107?[e+139]:e>=108&&e<=1131?(e-=108,[247+(e>>8),255&e]):e>=-1131&&e<=-108?(e=-e-108,[251+(e>>8),255&e]):e>=-32768&&e<=32767?Fo.NUMBER16(e):Fo.NUMBER32(e)},Oo.NUMBER=function(e){return Fo.NUMBER(e).length},Fo.NUMBER16=function(e){return[28,e>>8&255,255&e]},Oo.NUMBER16=y(3),Fo.NUMBER32=function(e){return[29,e>>24&255,e>>16&255,e>>8&255,255&e]},Oo.NUMBER32=y(5),Fo.REAL=function(e){var t=e.toString(),i=/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/.exec(t);if(i){var n=parseFloat("1e"+((i[2]?+i[2]:0)+i[1].length));t=(Math.round(e*n)/n).toString()}for(var r="",o=0,s=t.length;o<s;o+=1){var a=t[o];r+="e"===a?"-"===t[++o]?"c":"b":"."===a?"a":"-"===a?"e":a}r+=1&r.length?"f":"ff";for(var u=[30],l=0,c=r.length;l<c;l+=2)u.push(parseInt(r.substr(l,2),16));return u},Oo.REAL=function(e){return Fo.REAL(e).length},Fo.NAME=Fo.CHARARRAY,Oo.NAME=Oo.CHARARRAY,Fo.STRING=Fo.CHARARRAY,Oo.STRING=Oo.CHARARRAY,Co.UTF8=function(e,t,i){for(var n=[],r=i,o=0;o<r;o++,t+=1)n[o]=e.getUint8(t);return String.fromCharCode.apply(null,n)},Co.UTF16=function(e,t,i){for(var n=[],r=i/2,o=0;o<r;o++,t+=2)n[o]=e.getUint16(t);return String.fromCharCode.apply(null,n)},Fo.UTF16=function(e){for(var t=[],i=0;i<e.length;i+=1){var n=e.charCodeAt(i);t[t.length]=n>>8&255,t[t.length]=255&n}return t},Oo.UTF16=function(e){return 2*e.length};var No={"x-mac-croatian":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®Š™´¨≠ŽØ∞±≤≥∆µ∂∑∏š∫ªºΩžø¿¡¬√ƒ≈Ć«Č… ÀÃÕŒœĐ—“”‘’÷◊©⁄€‹›Æ»–·‚„‰ÂćÁčÈÍÎÏÌÓÔđÒÚÛÙıˆ˜¯πË˚¸Êæˇ","x-mac-cyrillic":"АБВГДЕЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯ†°Ґ£§•¶І®©™Ђђ≠Ѓѓ∞±≤≥іµґЈЄєЇїЉљЊњјЅ¬√ƒ≈∆«»… ЋћЌќѕ–—“”‘’÷„ЎўЏџ№Ёёяабвгдежзийклмнопрстуфхцчшщъыьэю","x-mac-gaelic":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØḂ±≤≥ḃĊċḊḋḞḟĠġṀæøṁṖṗɼƒſṠ«»… ÀÃÕŒœ–—“”‘’ṡẛÿŸṪ€‹›Ŷŷṫ·Ỳỳ⁊ÂÊÁËÈÍÎÏÌÓÔ♣ÒÚÛÙıÝýŴŵẄẅẀẁẂẃ","x-mac-greek":"Ä¹²É³ÖÜ΅àâä΄¨çéèêë£™îï•½‰ôö¦€ùûü†ΓΔΘΛΞΠß®©ΣΪ§≠°·Α±≤≥¥ΒΕΖΗΙΚΜΦΫΨΩάΝ¬ΟΡ≈Τ«»… ΥΧΆΈœ–―“”‘’÷ΉΊΌΎέήίόΏύαβψδεφγηιξκλμνοπώρστθωςχυζϊϋΐΰ­","x-mac-icelandic":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûüÝ°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€ÐðÞþý·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-inuit":"ᐃᐄᐅᐆᐊᐋᐱᐲᐳᐴᐸᐹᑉᑎᑏᑐᑑᑕᑖᑦᑭᑮᑯᑰᑲᑳᒃᒋᒌᒍᒎᒐᒑ°ᒡᒥᒦ•¶ᒧ®©™ᒨᒪᒫᒻᓂᓃᓄᓅᓇᓈᓐᓯᓰᓱᓲᓴᓵᔅᓕᓖᓗᓘᓚᓛᓪᔨᔩᔪᔫᔭ… ᔮᔾᕕᕖᕗ–—“”‘’ᕘᕙᕚᕝᕆᕇᕈᕉᕋᕌᕐᕿᖀᖁᖂᖃᖄᖅᖏᖐᖑᖒᖓᖔᖕᙱᙲᙳᙴᙵᙶᖖᖠᖡᖢᖣᖤᖥᖦᕼŁł","x-mac-ce":"ÄĀāÉĄÖÜáąČäčĆćéŹźĎíďĒēĖóėôöõúĚěü†°Ę£§•¶ß®©™ę¨≠ģĮįĪ≤≥īĶ∂∑łĻļĽľĹĺŅņŃ¬√ńŇ∆«»… ňŐÕőŌ–—“”‘’÷◊ōŔŕŘ‹›řŖŗŠ‚„šŚśÁŤťÍŽžŪÓÔūŮÚůŰűŲųÝýķŻŁżĢˇ",macintosh:"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€‹›ﬁﬂ‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-romanian":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ĂȘ∞±≤≥¥µ∂∑∏π∫ªºΩăș¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€‹›Țț‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-turkish":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸĞğİıŞş‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙˆ˜¯˘˙˚¸˝˛ˇ"};Co.MACSTRING=function(e,t,i,n){var r=No[n];if(void 0!==r){for(var o="",s=0;s<i;s++){var a=e.getUint8(t+s);o+=a<=127?String.fromCharCode(a):r[127&a]}return o}};var Eo,Do="function"==typeof WeakMap&&new WeakMap,Mo=function(e){if(!Eo){Eo={};for(var t in No)Eo[t]=new String(t)}var i=Eo[e];if(void 0!==i){if(Do){var n=Do.get(i);if(void 0!==n)return n}var r=No[e];if(void 0!==r){for(var o={},s=0;s<r.length;s++)o[r.charCodeAt(s)]=s+128;return Do&&Do.set(i,o),o}}};Fo.MACSTRING=function(e,t){var i=Mo(t);if(void 0!==i){for(var n=[],r=0;r<e.length;r++){var o=e.charCodeAt(r);if(o>=128&&void 0===(o=i[o]))return;n[r]=o}return n}},Oo.MACSTRING=function(e,t){var i=Fo.MACSTRING(e,t);return void 0!==i?i.length:0},Fo.VARDELTAS=function(e){for(var t=0,i=[];t<e.length;){var n=e[t];t=0===n?x(e,t,i):n>=-128&&n<=127?w(e,t,i):b(e,t,i)}return i},Fo.INDEX=function(e){for(var t=1,i=[t],n=[],r=0;r<e.length;r+=1){var o=Fo.OBJECT(e[r]);Array.prototype.push.apply(n,o),t+=o.length,i.push(t)}if(0===n.length)return[0,0];for(var s=[],a=1+Math.floor(Math.log(t)/Math.log(2))/8|0,u=[void 0,Fo.BYTE,Fo.USHORT,Fo.UINT24,Fo.ULONG][a],l=0;l<i.length;l+=1){var c=u(i[l]);Array.prototype.push.apply(s,c)}return Array.prototype.concat(Fo.Card16(e.length),Fo.OffSize(a),s,n)},Oo.INDEX=function(e){return Fo.INDEX(e).length},Fo.DICT=function(e){for(var t=[],i=Object.keys(e),n=i.length,r=0;r<n;r+=1){var o=parseInt(i[r],0),s=e[o];t=t.concat(Fo.OPERAND(s.value,s.type)),t=t.concat(Fo.OPERATOR(o))}return t},Oo.DICT=function(e){return Fo.DICT(e).length},Fo.OPERATOR=function(e){return e<1200?[e]:[12,e-1200]},Fo.OPERAND=function(e,t){var i=[];if(Array.isArray(t))for(var n=0;n<t.length;n+=1)To.argument(e.length===t.length,"Not enough arguments given for type"+t),i=i.concat(Fo.OPERAND(e[n],t[n]));else if("SID"===t)i=i.concat(Fo.NUMBER(e));else if("offset"===t)i=i.concat(Fo.NUMBER32(e));else if("number"===t)i=i.concat(Fo.NUMBER(e));else{if("real"!==t)throw new Error("Unknown operand type "+t);i=i.concat(Fo.REAL(e))}return i},Fo.OP=Fo.BYTE,Oo.OP=Oo.BYTE;var Vo="function"==typeof WeakMap&&new WeakMap;Fo.CHARSTRING=function(e){if(Vo){var t=Vo.get(e);if(void 0!==t)return t}for(var i=[],n=e.length,r=0;r<n;r+=1){var o=e[r];i=i.concat(Fo[o.type](o.value))}return Vo&&Vo.set(e,i),i},Oo.CHARSTRING=function(e){return Fo.CHARSTRING(e).length},Fo.OBJECT=function(e){var t=Fo[e.type];return To.argument(void 0!==t,"No encoding function for type "+e.type),t(e.value)},Oo.OBJECT=function(e){var t=Oo[e.type];return To.argument(void 0!==t,"No sizeOf function for type "+e.type),t(e.value)},Fo.TABLE=function(e){for(var t=[],i=e.fields.length,n=[],r=[],o=0;o<i;o+=1){var s=e.fields[o],a=Fo[s.type];To.argument(void 0!==a,"No encoding function for field type "+s.type+" ("+s.name+")");var u=e[s.name];void 0===u&&(u=s.value);var l=a(u);"TABLE"===s.type?(r.push(t.length),t=t.concat([0,0]),n.push(l)):t=t.concat(l)}for(var c=0;c<n.length;c+=1){var h=r[c],d=t.length;To.argument(d<65536,"Table "+e.tableName+" too big."),t[h]=d>>8,t[h+1]=255&d,t=t.concat(n[c])}return t},Oo.TABLE=function(e){for(var t=0,i=e.fields.length,n=0;n<i;n+=1){var r=e.fields[n],o=Oo[r.type];To.argument(void 0!==o,"No sizeOf function for field type "+r.type+" ("+r.name+")");var s=e[r.name];void 0===s&&(s=r.value),t+=o(s),"TABLE"===r.type&&(t+=2)}return t},Fo.RECORD=Fo.TABLE,Oo.RECORD=Oo.TABLE,Fo.LITERAL=function(e){return e},Oo.LITERAL=function(e){return e.length},v.prototype.encode=function(){return Fo.TABLE(this)},v.prototype.sizeOf=function(){return Oo.TABLE(this)},F.prototype=Object.create(v.prototype),F.prototype.constructor=F,O.prototype=Object.create(v.prototype),O.prototype.constructor=O,N.prototype=Object.create(v.prototype),N.prototype.constructor=N,E.prototype=Object.create(v.prototype),E.prototype.constructor=E;var Io={Table:v,Record:v,Coverage:F,ScriptList:O,FeatureList:N,LookupList:E,ushortList:S,tableList:T,recordList:C},Bo={byte:1,uShort:2,short:2,uLong:4,fixed:4,longDateTime:8,tag:4};k.prototype.parseByte=function(){var e=this.data.getUint8(this.offset+this.relativeOffset);return this.relativeOffset+=1,e},k.prototype.parseChar=function(){var e=this.data.getInt8(this.offset+this.relativeOffset);return this.relativeOffset+=1,e},k.prototype.parseCard8=k.prototype.parseByte,k.prototype.parseUShort=function(){var e=this.data.getUint16(this.offset+this.relativeOffset);return this.relativeOffset+=2,e},k.prototype.parseCard16=k.prototype.parseUShort,k.prototype.parseSID=k.prototype.parseUShort,k.prototype.parseOffset16=k.prototype.parseUShort,k.prototype.parseShort=function(){var e=this.data.getInt16(this.offset+this.relativeOffset);return this.relativeOffset+=2,e},k.prototype.parseF2Dot14=function(){var e=this.data.getInt16(this.offset+this.relativeOffset)/16384;return this.relativeOffset+=2,e},k.prototype.parseULong=function(){var e=I(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,e},k.prototype.parseOffset32=k.prototype.parseULong,k.prototype.parseFixed=function(){var e=B(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,e},k.prototype.parseString=function(e){var t=this.data,i=this.offset+this.relativeOffset,n="";this.relativeOffset+=e;for(var r=0;r<e;r++)n+=String.fromCharCode(t.getUint8(i+r));return n},k.prototype.parseTag=function(){return this.parseString(4)},k.prototype.parseLongDateTime=function(){var e=I(this.data,this.offset+this.relativeOffset+4);return e-=2082844800,this.relativeOffset+=8,e},k.prototype.parseVersion=function(e){var t=M(this.data,this.offset+this.relativeOffset),i=M(this.data,this.offset+this.relativeOffset+2);return this.relativeOffset+=4,void 0===e&&(e=4096),t+i/e/10},k.prototype.skip=function(e,t){void 0===t&&(t=1),this.relativeOffset+=Bo[e]*t},k.prototype.parseULongList=function(e){void 0===e&&(e=this.parseULong());for(var t=new Array(e),i=this.data,n=this.offset+this.relativeOffset,r=0;r<e;r++)t[r]=i.getUint32(n),n+=4;return this.relativeOffset+=4*e,t},k.prototype.parseOffset16List=k.prototype.parseUShortList=function(e){void 0===e&&(e=this.parseUShort());for(var t=new Array(e),i=this.data,n=this.offset+this.relativeOffset,r=0;r<e;r++)t[r]=i.getUint16(n),n+=2;return this.relativeOffset+=2*e,t},k.prototype.parseShortList=function(e){for(var t=new Array(e),i=this.data,n=this.offset+this.relativeOffset,r=0;r<e;r++)t[r]=i.getInt16(n),n+=2;return this.relativeOffset+=2*e,t},k.prototype.parseByteList=function(e){for(var t=new Array(e),i=this.data,n=this.offset+this.relativeOffset,r=0;r<e;r++)t[r]=i.getUint8(n++);return this.relativeOffset+=e,t},k.prototype.parseList=function(e,t){t||(t=e,e=this.parseUShort());for(var i=new Array(e),n=0;n<e;n++)i[n]=t.call(this);return i},k.prototype.parseList32=function(e,t){t||(t=e,e=this.parseULong());for(var i=new Array(e),n=0;n<e;n++)i[n]=t.call(this);return i},k.prototype.parseRecordList=function(e,t){t||(t=e,e=this.parseUShort());for(var i=new Array(e),n=Object.keys(t),r=0;r<e;r++){for(var o={},s=0;s<n.length;s++){var a=n[s],u=t[a];o[a]=u.call(this)}i[r]=o}return i},k.prototype.parseRecordList32=function(e,t){t||(t=e,e=this.parseULong());for(var i=new Array(e),n=Object.keys(t),r=0;r<e;r++){for(var o={},s=0;s<n.length;s++){var a=n[s],u=t[a];o[a]=u.call(this)}i[r]=o}return i},k.prototype.parseStruct=function(e){if("function"==typeof e)return e.call(this);for(var t=Object.keys(e),i={},n=0;n<t.length;n++){var r=t[n],o=e[r];i[r]=o.call(this)}return i},k.prototype.parseValueRecord=function(e){if(void 0===e&&(e=this.parseUShort()),0!==e){var t={};return 1&e&&(t.xPlacement=this.parseShort()),2&e&&(t.yPlacement=this.parseShort()),4&e&&(t.xAdvance=this.parseShort()),8&e&&(t.yAdvance=this.parseShort()),16&e&&(t.xPlaDevice=void 0,this.parseShort()),32&e&&(t.yPlaDevice=void 0,this.parseShort()),64&e&&(t.xAdvDevice=void 0,this.parseShort()),128&e&&(t.yAdvDevice=void 0,this.parseShort()),t}},k.prototype.parseValueRecordList=function(){for(var e=this.parseUShort(),t=this.parseUShort(),i=new Array(t),n=0;n<t;n++)i[n]=this.parseValueRecord(e);return i},k.prototype.parsePointer=function(e){var t=this.parseOffset16();if(t>0)return new k(this.data,this.offset+t).parseStruct(e)},k.prototype.parsePointer32=function(e){var t=this.parseOffset32();if(t>0)return new k(this.data,this.offset+t).parseStruct(e)},k.prototype.parseListOfLists=function(e){for(var t=this.parseOffset16List(),i=t.length,n=this.relativeOffset,r=new Array(i),o=0;o<i;o++){var s=t[o];if(0!==s)if(this.relativeOffset=s,e){for(var a=this.parseOffset16List(),u=new Array(a.length),l=0;l<a.length;l++)this.relativeOffset=s+a[l],u[l]=e.call(this);r[o]=u}else r[o]=this.parseUShortList();else r[o]=void 0}return this.relativeOffset=n,r},k.prototype.parseCoverage=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort(),i=this.parseUShort();if(1===t)return{format:1,glyphs:this.parseUShortList(i)};if(2===t){for(var n=new Array(i),r=0;r<i;r++)n[r]={start:this.parseUShort(),end:this.parseUShort(),index:this.parseUShort()};return{format:2,ranges:n}}throw new Error("0x"+e.toString(16)+": Coverage format must be 1 or 2.")},k.prototype.parseClassDef=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort();if(1===t)return{format:1,startGlyph:this.parseUShort(),classes:this.parseUShortList()};if(2===t)return{format:2,ranges:this.parseRecordList({start:k.uShort,end:k.uShort,classId:k.uShort})};throw new Error("0x"+e.toString(16)+": ClassDef format must be 1 or 2.")},k.list=function(e,t){return function(){return this.parseList(e,t)}},k.list32=function(e,t){return function(){return this.parseList32(e,t)}},k.recordList=function(e,t){return function(){return this.parseRecordList(e,t)}},k.recordList32=function(e,t){return function(){return this.parseRecordList32(e,t)}},k.pointer=function(e){return function(){return this.parsePointer(e)}},k.pointer32=function(e){return function(){return this.parsePointer32(e)}},k.tag=k.prototype.parseTag,k.byte=k.prototype.parseByte,k.uShort=k.offset16=k.prototype.parseUShort,k.uShortList=k.prototype.parseUShortList,k.uLong=k.offset32=k.prototype.parseULong,k.uLongList=k.prototype.parseULongList,k.struct=k.prototype.parseStruct,k.coverage=k.prototype.parseCoverage,k.classDef=k.prototype.parseClassDef;var Ao={reserved:k.uShort,reqFeatureIndex:k.uShort,featureIndexes:k.uShortList};k.prototype.parseScriptList=function(){return this.parsePointer(k.recordList({tag:k.tag,script:k.pointer({defaultLangSys:k.pointer(Ao),langSysRecords:k.recordList({tag:k.tag,langSys:k.pointer(Ao)})})}))||[]},k.prototype.parseFeatureList=function(){return this.parsePointer(k.recordList({tag:k.tag,feature:k.pointer({featureParams:k.offset16,lookupListIndexes:k.uShortList})}))||[]},k.prototype.parseLookupList=function(e){return this.parsePointer(k.list(k.pointer(function(){var t=this.parseUShort();To.argument(1<=t&&t<=9,"GPOS/GSUB lookup type "+t+" unknown.");var i=this.parseUShort(),n=16&i;return{lookupType:t,lookupFlag:i,subtables:this.parseList(k.pointer(e[t])),markFilteringSet:n?this.parseUShort():void 0}})))||[]},k.prototype.parseFeatureVariationsList=function(){return this.parsePointer32(function(){var e=this.parseUShort(),t=this.parseUShort();return To.argument(1===e&&t<1,"GPOS/GSUB feature variations table unknown."),this.parseRecordList32({conditionSetOffset:k.offset32,featureTableSubstitutionOffset:k.offset32})})||[]};var Po={getByte:D,getCard8:D,getUShort:M,getCard16:M,getShort:V,getULong:I,getFixed:B,getTag:A,getOffset:P,getBytes:R,bytesToString:L,Parser:k},Ro={parse:z,make:q
},Lo=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","266 ff","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"],ko=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls"],Uo=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],Xo=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"];H.prototype.charToGlyphIndex=function(e){var t=e.codePointAt(0),i=this.font.glyphs;if(i)for(var n=0;n<i.length;n+=1)for(var r=i.get(n),o=0;o<r.unicodes.length;o+=1)if(r.unicodes[o]===t)return n;return null},W.prototype.charToGlyphIndex=function(e){return this.cmap.glyphIndexMap[e.codePointAt(0)]||0},Y.prototype.charToGlyphIndex=function(e){var t=e.codePointAt(0),i=this.encoding[t];return this.charset.indexOf(i)},$.prototype.nameToGlyphIndex=function(e){return this.names.indexOf(e)},$.prototype.glyphIndexToName=function(e){return this.names[e]};var zo={line:J};te.prototype.bindConstructorValues=function(e){this.index=e.index||0,this.name=e.name||null,this.unicode=e.unicode||void 0,this.unicodes=e.unicodes||void 0!==e.unicode?[e.unicode]:[],"xMin"in e&&(this.xMin=e.xMin),"yMin"in e&&(this.yMin=e.yMin),"xMax"in e&&(this.xMax=e.xMax),"yMax"in e&&(this.yMax=e.yMax),"advanceWidth"in e&&(this.advanceWidth=e.advanceWidth),Object.defineProperty(this,"path",ee(this,e.path))},te.prototype.addUnicode=function(e){0===this.unicodes.length&&(this.unicode=e),this.unicodes.push(e)},te.prototype.getBoundingBox=function(){return this.path.getBoundingBox()},te.prototype.getPath=function(e,t,i,n,r){e=void 0!==e?e:0,t=void 0!==t?t:0,i=void 0!==i?i:72;var o,s;n||(n={});var a=n.xScale,u=n.yScale;if(n.hinting&&r&&r.hinting&&(s=this.path&&r.hinting.exec(this,i)),s)o=r.hinting.getCommands(s),e=Math.round(e),t=Math.round(t),a=u=1;else{o=this.path.commands;var l=1/(this.path.unitsPerEm||1e3)*i;void 0===a&&(a=l),void 0===u&&(u=l)}for(var c=new f,h=0;h<o.length;h+=1){var d=o[h];"M"===d.type?c.moveTo(e+d.x*a,t+-d.y*u):"L"===d.type?c.lineTo(e+d.x*a,t+-d.y*u):"Q"===d.type?c.quadraticCurveTo(e+d.x1*a,t+-d.y1*u,e+d.x*a,t+-d.y*u):"C"===d.type?c.curveTo(e+d.x1*a,t+-d.y1*u,e+d.x2*a,t+-d.y2*u,e+d.x*a,t+-d.y*u):"Z"===d.type&&c.closePath()}return c},te.prototype.getContours=function(){if(void 0===this.points)return[];for(var e=[],t=[],i=0;i<this.points.length;i+=1){var n=this.points[i];t.push(n),n.lastPointOfContour&&(e.push(t),t=[])}return To.argument(0===t.length,"There are still points left in the current contour."),e},te.prototype.getMetrics=function(){for(var e=this.path.commands,t=[],i=[],n=0;n<e.length;n+=1){var r=e[n];"Z"!==r.type&&(t.push(r.x),i.push(r.y)),"Q"!==r.type&&"C"!==r.type||(t.push(r.x1),i.push(r.y1)),"C"===r.type&&(t.push(r.x2),i.push(r.y2))}var o={xMin:Math.min.apply(null,t),yMin:Math.min.apply(null,i),xMax:Math.max.apply(null,t),yMax:Math.max.apply(null,i),leftSideBearing:this.leftSideBearing};return isFinite(o.xMin)||(o.xMin=0),isFinite(o.xMax)||(o.xMax=this.advanceWidth),isFinite(o.yMin)||(o.yMin=0),isFinite(o.yMax)||(o.yMax=0),o.rightSideBearing=this.advanceWidth-o.leftSideBearing-(o.xMax-o.xMin),o},te.prototype.draw=function(e,t,i,n,r){this.getPath(t,i,n,r).draw(e)},te.prototype.drawPoints=function(e,t,i,n){function r(t,i,n,r){e.beginPath();for(var o=0;o<t.length;o+=1)e.moveTo(i+t[o].x*r,n+t[o].y*r),e.arc(i+t[o].x*r,n+t[o].y*r,2,0,2*Math.PI,!1);e.closePath(),e.fill()}t=void 0!==t?t:0,i=void 0!==i?i:0,n=void 0!==n?n:24;for(var o=1/this.path.unitsPerEm*n,s=[],a=[],u=this.path,l=0;l<u.commands.length;l+=1){var c=u.commands[l];void 0!==c.x&&s.push({x:c.x,y:-c.y}),void 0!==c.x1&&a.push({x:c.x1,y:-c.y1}),void 0!==c.x2&&a.push({x:c.x2,y:-c.y2})}e.fillStyle="blue",r(s,t,i,o),e.fillStyle="red",r(a,t,i,o)},te.prototype.drawMetrics=function(e,t,i,n){var r;t=void 0!==t?t:0,i=void 0!==i?i:0,n=void 0!==n?n:24,r=1/this.path.unitsPerEm*n,e.lineWidth=1,e.strokeStyle="black",zo.line(e,t,-1e4,t,1e4),zo.line(e,-1e4,i,1e4,i);var o=this.xMin||0,s=this.yMin||0,a=this.xMax||0,u=this.yMax||0,l=this.advanceWidth||0;e.strokeStyle="blue",zo.line(e,t+o*r,-1e4,t+o*r,1e4),zo.line(e,t+a*r,-1e4,t+a*r,1e4),zo.line(e,-1e4,i+-s*r,1e4,i+-s*r),zo.line(e,-1e4,i+-u*r,1e4,i+-u*r),e.strokeStyle="green",zo.line(e,t+l*r,-1e4,t+l*r,1e4)},ne.prototype.get=function(e){if(void 0===this.glyphs[e]){this.font._push(e),"function"==typeof this.glyphs[e]&&(this.glyphs[e]=this.glyphs[e]());var t=this.glyphs[e],i=this.font._IndexToUnicodeMap[e];if(i)for(var n=0;n<i.unicodes.length;n++)t.addUnicode(i.unicodes[n]);this.font.cffEncoding?this.font.isCIDFont?t.name="gid"+e:t.name=this.font.cffEncoding.charset[e]:this.font.glyphNames.names&&(t.name=this.font.glyphNames.glyphIndexToName(e)),this.glyphs[e].advanceWidth=this.font._hmtxTableData[e].advanceWidth,this.glyphs[e].leftSideBearing=this.font._hmtxTableData[e].leftSideBearing}else"function"==typeof this.glyphs[e]&&(this.glyphs[e]=this.glyphs[e]());return this.glyphs[e]},ne.prototype.push=function(e,t){this.glyphs[e]=t,this.length++};var jo={GlyphSet:ne,glyphLoader:re,ttfGlyphLoader:oe,cffGlyphLoader:se},Go=[{name:"version",op:0,type:"SID"},{name:"notice",op:1,type:"SID"},{name:"copyright",op:1200,type:"SID"},{name:"fullName",op:2,type:"SID"},{name:"familyName",op:3,type:"SID"},{name:"weight",op:4,type:"SID"},{name:"isFixedPitch",op:1201,type:"number",value:0},{name:"italicAngle",op:1202,type:"number",value:0},{name:"underlinePosition",op:1203,type:"number",value:-100},{name:"underlineThickness",op:1204,type:"number",value:50},{name:"paintType",op:1205,type:"number",value:0},{name:"charstringType",op:1206,type:"number",value:2},{name:"fontMatrix",op:1207,type:["real","real","real","real","real","real"],value:[.001,0,0,.001,0,0]},{name:"uniqueId",op:13,type:"number"},{name:"fontBBox",op:5,type:["number","number","number","number"],value:[0,0,0,0]},{name:"strokeWidth",op:1208,type:"number",value:0},{name:"xuid",op:14,type:[],value:null},{name:"charset",op:15,type:"offset",value:0},{name:"encoding",op:16,type:"offset",value:0},{name:"charStrings",op:17,type:"offset",value:0},{name:"private",op:18,type:["number","offset"],value:[0,0]},{name:"ros",op:1230,type:["SID","SID","number"]},{name:"cidFontVersion",op:1231,type:"number",value:0},{name:"cidFontRevision",op:1232,type:"number",value:0},{name:"cidFontType",op:1233,type:"number",value:0},{name:"cidCount",op:1234,type:"number",value:8720},{name:"uidBase",op:1235,type:"number"},{name:"fdArray",op:1236,type:"offset"},{name:"fdSelect",op:1237,type:"offset"},{name:"fontName",op:1238,type:"SID"}],qo=[{name:"subrs",op:19,type:"offset",value:0},{name:"defaultWidthX",op:20,type:"number",value:0},{name:"nominalWidthX",op:21,type:"number",value:0}],Ho={parse:Fe,make:ke},Wo={parse:Ue,make:Xe},Yo={parse:ze,make:je},$o={parse:He,make:We},Zo={make:Ye,parse:$e},Ko={parse:Ze,make:Ke},Qo=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","license","licenseURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"],Jo={0:"en",1:"fr",2:"de",3:"it",4:"nl",5:"sv",6:"es",7:"da",8:"pt",9:"no",10:"he",11:"ja",12:"ar",13:"fi",14:"el",15:"is",16:"mt",17:"tr",18:"hr",19:"zh-Hant",20:"ur",21:"hi",22:"th",23:"ko",24:"lt",25:"pl",26:"hu",27:"es",28:"lv",29:"se",30:"fo",31:"fa",32:"ru",33:"zh",34:"nl-BE",35:"ga",36:"sq",37:"ro",38:"cz",39:"sk",40:"si",41:"yi",42:"sr",43:"mk",44:"bg",45:"uk",46:"be",47:"uz",48:"kk",49:"az-Cyrl",50:"az-Arab",51:"hy",52:"ka",53:"mo",54:"ky",55:"tg",56:"tk",57:"mn-CN",58:"mn",59:"ps",60:"ks",61:"ku",62:"sd",63:"bo",64:"ne",65:"sa",66:"mr",67:"bn",68:"as",69:"gu",70:"pa",71:"or",72:"ml",73:"kn",74:"ta",75:"te",76:"si",77:"my",78:"km",79:"lo",80:"vi",81:"id",82:"tl",83:"ms",84:"ms-Arab",85:"am",86:"ti",87:"om",88:"so",89:"sw",90:"rw",91:"rn",92:"ny",93:"mg",94:"eo",128:"cy",129:"eu",130:"ca",131:"la",132:"qu",133:"gn",134:"ay",135:"tt",136:"ug",137:"dz",138:"jv",139:"su",140:"gl",141:"af",142:"br",143:"iu",144:"gd",145:"gv",146:"ga",147:"to",148:"el-polyton",149:"kl",150:"az",151:"nn"},es={0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:5,11:1,12:4,13:0,14:6,15:0,16:0,17:0,18:0,19:2,20:4,21:9,22:21,23:3,24:29,25:29,26:29,27:29,28:29,29:0,30:0,31:4,32:7,33:25,34:0,35:0,36:0,37:0,38:29,39:29,40:0,41:5,42:7,43:7,44:7,45:7,46:7,47:7,48:7,49:7,50:4,51:24,52:23,53:7,54:7,55:7,56:7,57:27,58:7,59:4,60:4,61:4,62:4,63:26,64:9,65:9,66:9,67:13,68:13,69:11,70:10,71:12,72:17,73:16,74:14,75:15,76:18,77:19,78:20,79:22,80:30,81:0,82:0,83:0,84:4,85:28,86:28,87:28,88:0,89:0,90:0,91:0,92:0,93:0,94:0,128:0,129:0,130:0,131:0,132:0,133:0,134:0,135:7,136:4,137:26,138:0,139:0,140:0,141:0,142:0,143:28,144:0,145:0,146:0,147:0,148:6,149:0,150:0,151:0},ts={1078:"af",1052:"sq",1156:"gsw",1118:"am",5121:"ar-DZ",15361:"ar-BH",3073:"ar",2049:"ar-IQ",11265:"ar-JO",13313:"ar-KW",12289:"ar-LB",4097:"ar-LY",6145:"ary",8193:"ar-OM",16385:"ar-QA",1025:"ar-SA",10241:"ar-SY",7169:"aeb",14337:"ar-AE",9217:"ar-YE",1067:"hy",1101:"as",2092:"az-Cyrl",1068:"az",1133:"ba",1069:"eu",1059:"be",2117:"bn",1093:"bn-IN",8218:"bs-Cyrl",5146:"bs",1150:"br",1026:"bg",1027:"ca",3076:"zh-HK",5124:"zh-MO",2052:"zh",4100:"zh-SG",1028:"zh-TW",1155:"co",1050:"hr",4122:"hr-BA",1029:"cs",1030:"da",1164:"prs",1125:"dv",2067:"nl-BE",1043:"nl",3081:"en-AU",10249:"en-BZ",4105:"en-CA",9225:"en-029",16393:"en-IN",6153:"en-IE",8201:"en-JM",17417:"en-MY",5129:"en-NZ",13321:"en-PH",18441:"en-SG",7177:"en-ZA",11273:"en-TT",2057:"en-GB",1033:"en",12297:"en-ZW",1061:"et",1080:"fo",1124:"fil",1035:"fi",2060:"fr-BE",3084:"fr-CA",1036:"fr",5132:"fr-LU",6156:"fr-MC",4108:"fr-CH",1122:"fy",1110:"gl",1079:"ka",3079:"de-AT",1031:"de",5127:"de-LI",4103:"de-LU",2055:"de-CH",1032:"el",1135:"kl",1095:"gu",1128:"ha",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig",1057:"id",1117:"iu",2141:"iu-Latn",2108:"ga",1076:"xh",1077:"zu",1040:"it",2064:"it-CH",1041:"ja",1099:"kn",1087:"kk",1107:"km",1158:"quc",1159:"rw",1089:"sw",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1062:"lv",1063:"lt",2094:"dsb",1134:"lb",1071:"mk",2110:"ms-BN",1086:"ms",1100:"ml",1082:"mt",1153:"mi",1146:"arn",1102:"mr",1148:"moh",1104:"mn",2128:"mn-CN",1121:"ne",1044:"nb",2068:"nn",1154:"oc",1096:"or",1123:"ps",1045:"pl",1046:"pt",2070:"pt-PT",1094:"pa",1131:"qu-BO",2155:"qu-EC",3179:"qu",1048:"ro",1047:"rm",1049:"ru",9275:"smn",4155:"smj-NO",5179:"smj",3131:"se-FI",1083:"se",2107:"se-SE",8251:"sms",6203:"sma-NO",7227:"sms",1103:"sa",7194:"sr-Cyrl-BA",3098:"sr",6170:"sr-Latn-BA",2074:"sr-Latn",1132:"nso",1074:"tn",1115:"si",1051:"sk",1060:"sl",11274:"es-AR",16394:"es-BO",13322:"es-CL",9226:"es-CO",5130:"es-CR",7178:"es-DO",12298:"es-EC",17418:"es-SV",4106:"es-GT",18442:"es-HN",2058:"es-MX",19466:"es-NI",6154:"es-PA",15370:"es-PY",10250:"es-PE",20490:"es-PR",3082:"es",1034:"es",21514:"es-US",14346:"es-UY",8202:"es-VE",2077:"sv-FI",1053:"sv",1114:"syr",1064:"tg",2143:"tzm",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1055:"tr",1090:"tk",1152:"ug",1058:"uk",1070:"hsb",1056:"ur",2115:"uz-Cyrl",1091:"uz",1066:"vi",1106:"cy",1160:"wo",1157:"sah",1144:"ii",1130:"yo"},is="utf-16",ns={0:"macintosh",1:"x-mac-japanese",2:"x-mac-chinesetrad",3:"x-mac-korean",6:"x-mac-greek",7:"x-mac-cyrillic",9:"x-mac-devanagai",10:"x-mac-gurmukhi",11:"x-mac-gujarati",12:"x-mac-oriya",13:"x-mac-bengali",14:"x-mac-tamil",15:"x-mac-telugu",16:"x-mac-kannada",17:"x-mac-malayalam",18:"x-mac-sinhalese",19:"x-mac-burmese",20:"x-mac-khmer",21:"x-mac-thai",22:"x-mac-lao",23:"x-mac-georgian",24:"x-mac-armenian",25:"x-mac-chinesesimp",26:"x-mac-tibetan",27:"x-mac-mongolian",28:"x-mac-ethiopic",29:"x-mac-ce",30:"x-mac-vietnamese",31:"x-mac-extarabic"},rs={15:"x-mac-icelandic",17:"x-mac-turkish",18:"x-mac-croatian",24:"x-mac-ce",25:"x-mac-ce",26:"x-mac-ce",27:"x-mac-ce",28:"x-mac-ce",30:"x-mac-icelandic",37:"x-mac-romanian",38:"x-mac-ce",39:"x-mac-ce",40:"x-mac-ce",143:"x-mac-inuit",146:"x-mac-gaelic"},os={parse:et,make:ot},ss=[{begin:0,end:127},{begin:128,end:255},{begin:256,end:383},{begin:384,end:591},{begin:592,end:687},{begin:688,end:767},{begin:768,end:879},{begin:880,end:1023},{begin:11392,end:11519},{begin:1024,end:1279},{begin:1328,end:1423},{begin:1424,end:1535},{begin:42240,end:42559},{begin:1536,end:1791},{begin:1984,end:2047},{begin:2304,end:2431},{begin:2432,end:2559},{begin:2560,end:2687},{begin:2688,end:2815},{begin:2816,end:2943},{begin:2944,end:3071},{begin:3072,end:3199},{begin:3200,end:3327},{begin:3328,end:3455},{begin:3584,end:3711},{begin:3712,end:3839},{begin:4256,end:4351},{begin:6912,end:7039},{begin:4352,end:4607},{begin:7680,end:7935},{begin:7936,end:8191},{begin:8192,end:8303},{begin:8304,end:8351},{begin:8352,end:8399},{begin:8400,end:8447},{begin:8448,end:8527},{begin:8528,end:8591},{begin:8592,end:8703},{begin:8704,end:8959},{begin:8960,end:9215},{begin:9216,end:9279},{begin:9280,end:9311},{begin:9312,end:9471},{begin:9472,end:9599},{begin:9600,end:9631},{begin:9632,end:9727},{begin:9728,end:9983},{begin:9984,end:10175},{begin:12288,end:12351},{begin:12352,end:12447},{begin:12448,end:12543},{begin:12544,end:12591},{begin:12592,end:12687},{begin:43072,end:43135},{begin:12800,end:13055},{begin:13056,end:13311},{begin:44032,end:55215},{begin:55296,end:57343},{begin:67840,end:67871},{begin:19968,end:40959},{begin:57344,end:63743},{begin:12736,end:12783},{begin:64256,end:64335},{begin:64336,end:65023},{begin:65056,end:65071},{begin:65040,end:65055},{begin:65104,end:65135},{begin:65136,end:65279},{begin:65280,end:65519},{begin:65520,end:65535},{begin:3840,end:4095},{begin:1792,end:1871},{begin:1920,end:1983},{begin:3456,end:3583},{begin:4096,end:4255},{begin:4608,end:4991},{begin:5024,end:5119},{begin:5120,end:5759},{begin:5760,end:5791},{begin:5792,end:5887},{begin:6016,end:6143},{begin:6144,end:6319},{begin:10240,end:10495},{begin:40960,end:42127},{begin:5888,end:5919},{begin:66304,end:66351},{begin:66352,end:66383},{begin:66560,end:66639},{begin:118784,end:119039},{begin:119808,end:120831},{begin:1044480,end:1048573},{begin:65024,end:65039},{begin:917504,end:917631},{begin:6400,end:6479},{begin:6480,end:6527},{begin:6528,end:6623},{begin:6656,end:6687},{begin:11264,end:11359},{begin:11568,end:11647},{begin:19904,end:19967},{begin:43008,end:43055},{begin:65536,end:65663},{begin:65856,end:65935},{begin:66432,end:66463},{begin:66464,end:66527},{begin:66640,end:66687},{begin:66688,end:66735},{begin:67584,end:67647},{begin:68096,end:68191},{begin:119552,end:119647},{begin:73728,end:74751},{begin:119648,end:119679},{begin:7040,end:7103},{begin:7168,end:7247},{begin:7248,end:7295},{begin:43136,end:43231},{begin:43264,end:43311},{begin:43312,end:43359},{begin:43520,end:43615},{begin:65936,end:65999},{begin:66e3,end:66047},{begin:66208,end:66271},{begin:127024,end:127135}],as={parse:at,make:ut,unicodeRanges:ss,getUnicodeRange:st},us={parse:lt,make:ct},ls=new Array(9);ls[1]=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort();return 1===t?{substFormat:1,coverage:this.parsePointer(k.coverage),deltaGlyphId:this.parseUShort()}:2===t?{substFormat:2,coverage:this.parsePointer(k.coverage),substitute:this.parseOffset16List()}:void To.assert(!1,"0x"+e.toString(16)+": lookup type 1 format must be 1 or 2.")},ls[2]=function(){var e=this.parseUShort();return To.argument(1===e,"GSUB Multiple Substitution Subtable identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(k.coverage),sequences:this.parseListOfLists()}},ls[3]=function(){var e=this.parseUShort();return To.argument(1===e,"GSUB Alternate Substitution Subtable identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(k.coverage),alternateSets:this.parseListOfLists()}},ls[4]=function(){var e=this.parseUShort();return To.argument(1===e,"GSUB ligature table identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(k.coverage),ligatureSets:this.parseListOfLists(function(){return{ligGlyph:this.parseUShort(),components:this.parseUShortList(this.parseUShort()-1)}})}};var cs={sequenceIndex:k.uShort,lookupListIndex:k.uShort};ls[5]=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort();if(1===t)return{substFormat:t,coverage:this.parsePointer(k.coverage),ruleSets:this.parseListOfLists(function(){var e=this.parseUShort(),t=this.parseUShort();return{input:this.parseUShortList(e-1),lookupRecords:this.parseRecordList(t,cs)}})};if(2===t)return{substFormat:t,coverage:this.parsePointer(k.coverage),classDef:this.parsePointer(k.classDef),classSets:this.parseListOfLists(function(){var e=this.parseUShort(),t=this.parseUShort();return{classes:this.parseUShortList(e-1),lookupRecords:this.parseRecordList(t,cs)}})};if(3===t){var i=this.parseUShort(),n=this.parseUShort();return{substFormat:t,coverages:this.parseList(i,k.pointer(k.coverage)),lookupRecords:this.parseRecordList(n,cs)}}To.assert(!1,"0x"+e.toString(16)+": lookup type 5 format must be 1, 2 or 3.")},ls[6]=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort();return 1===t?{substFormat:1,coverage:this.parsePointer(k.coverage),chainRuleSets:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(cs)}})}:2===t?{substFormat:2,coverage:this.parsePointer(k.coverage),backtrackClassDef:this.parsePointer(k.classDef),inputClassDef:this.parsePointer(k.classDef),lookaheadClassDef:this.parsePointer(k.classDef),chainClassSet:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(cs)}})}:3===t?{substFormat:3,backtrackCoverage:this.parseList(k.pointer(k.coverage)),inputCoverage:this.parseList(k.pointer(k.coverage)),lookaheadCoverage:this.parseList(k.pointer(k.coverage)),lookupRecords:this.parseRecordList(cs)}:void To.assert(!1,"0x"+e.toString(16)+": lookup type 6 format must be 1, 2 or 3.")},ls[7]=function(){var e=this.parseUShort();To.argument(1===e,"GSUB Extension Substitution subtable identifier-format must be 1");var t=this.parseUShort(),i=new k(this.data,this.offset+this.parseULong());return{substFormat:1,lookupType:t,extension:ls[t].call(i)}},ls[8]=function(){var e=this.parseUShort();return To.argument(1===e,"GSUB Reverse Chaining Contextual Single Substitution Subtable identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(k.coverage),backtrackCoverage:this.parseList(k.pointer(k.coverage)),lookaheadCoverage:this.parseList(k.pointer(k.coverage)),substitutes:this.parseUShortList()}};var hs=new Array(9);hs[1]=function(e){return 1===e.substFormat?new Io.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new Io.Coverage(e.coverage)},{name:"deltaGlyphID",type:"USHORT",value:e.deltaGlyphId}]):new Io.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:2},{name:"coverage",type:"TABLE",value:new Io.Coverage(e.coverage)}].concat(Io.ushortList("substitute",e.substitute)))},hs[2]=function(e){return To.assert(1===e.substFormat,"Lookup type 2 substFormat must be 1."),new Io.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new Io.Coverage(e.coverage)}].concat(Io.tableList("seqSet",e.sequences,function(e){return new Io.Table("sequenceSetTable",Io.ushortList("sequence",e))})))},hs[3]=function(e){return To.assert(1===e.substFormat,"Lookup type 3 substFormat must be 1."),new Io.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new Io.Coverage(e.coverage)}].concat(Io.tableList("altSet",e.alternateSets,function(e){return new Io.Table("alternateSetTable",Io.ushortList("alternate",e))})))},hs[4]=function(e){return To.assert(1===e.substFormat,"Lookup type 4 substFormat must be 1."),new Io.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new Io.Coverage(e.coverage)}].concat(Io.tableList("ligSet",e.ligatureSets,function(e){return new Io.Table("ligatureSetTable",Io.tableList("ligature",e,function(e){return new Io.Table("ligatureTable",[{name:"ligGlyph",type:"USHORT",value:e.ligGlyph}].concat(Io.ushortList("component",e.components,e.components.length+1)))}))})))},hs[6]=function(e){if(1===e.substFormat){return new Io.Table("chainContextTable",[{name:"substFormat",type:"USHORT",value:e.substFormat},{name:"coverage",type:"TABLE",value:new Io.Coverage(e.coverage)}].concat(Io.tableList("chainRuleSet",e.chainRuleSets,function(e){return new Io.Table("chainRuleSetTable",Io.tableList("chainRule",e,function(e){var t=Io.ushortList("backtrackGlyph",e.backtrack,e.backtrack.length).concat(Io.ushortList("inputGlyph",e.input,e.input.length+1)).concat(Io.ushortList("lookaheadGlyph",e.lookahead,e.lookahead.length)).concat(Io.ushortList("substitution",[],e.lookupRecords.length));return e.lookupRecords.forEach(function(e,i){t=t.concat({name:"sequenceIndex"+i,type:"USHORT",value:e.sequenceIndex}).concat({name:"lookupListIndex"+i,type:"USHORT",value:e.lookupListIndex})}),new Io.Table("chainRuleTable",t)}))})))}if(2===e.substFormat)To.assert(!1,"lookup type 6 format 2 is not yet supported.");else if(3===e.substFormat){var t=[{name:"substFormat",type:"USHORT",value:e.substFormat}];t.push({name:"backtrackGlyphCount",type:"USHORT",value:e.backtrackCoverage.length}),e.backtrackCoverage.forEach(function(e,i){t.push({name:"backtrackCoverage"+i,type:"TABLE",value:new Io.Coverage(e)})}),t.push({name:"inputGlyphCount",type:"USHORT",value:e.inputCoverage.length}),e.inputCoverage.forEach(function(e,i){t.push({name:"inputCoverage"+i,type:"TABLE",value:new Io.Coverage(e)})}),t.push({
name:"lookaheadGlyphCount",type:"USHORT",value:e.lookaheadCoverage.length}),e.lookaheadCoverage.forEach(function(e,i){t.push({name:"lookaheadCoverage"+i,type:"TABLE",value:new Io.Coverage(e)})}),t.push({name:"substitutionCount",type:"USHORT",value:e.lookupRecords.length}),e.lookupRecords.forEach(function(e,i){t=t.concat({name:"sequenceIndex"+i,type:"USHORT",value:e.sequenceIndex}).concat({name:"lookupListIndex"+i,type:"USHORT",value:e.lookupListIndex})});var i=new Io.Table("chainContextTable",t);return i}To.assert(!1,"lookup type 6 format must be 1, 2 or 3.")};var ds={parse:ht,make:dt},ps={parse:pt,make:ft},fs={make:_t,fontToTable:bt,computeCheckSum:mt};Ct.prototype={searchTag:vt,binSearch:St,getTable:function(e){var t=this.font.tables[this.tableName];return!t&&e&&(t=this.font.tables[this.tableName]=this.createDefaultTable()),t},getScriptNames:function(){var e=this.getTable();return e?e.scripts.map(function(e){return e.tag}):[]},getDefaultScriptName:function(){var e=this.getTable();if(e){for(var t=!1,i=0;i<e.scripts.length;i++){var n=e.scripts[i].tag;if("DFLT"===n)return n;"latn"===n&&(t=!0)}return t?"latn":void 0}},getScriptTable:function(e,t){var i=this.getTable(t);if(i){e=e||"DFLT";var n=i.scripts,r=vt(i.scripts,e);if(r>=0)return n[r].script;if(t){var o={tag:e,script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}};return n.splice(-1-r,0,o),o.script}}},getLangSysTable:function(e,t,i){var n=this.getScriptTable(e,i);if(n){if(!t||"dflt"===t||"DFLT"===t)return n.defaultLangSys;var r=vt(n.langSysRecords,t);if(r>=0)return n.langSysRecords[r].langSys;if(i){var o={tag:t,langSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]}};return n.langSysRecords.splice(-1-r,0,o),o.langSys}}},getFeatureTable:function(e,t,i,n){var r=this.getLangSysTable(e,t,n);if(r){for(var o,s=r.featureIndexes,a=this.font.tables[this.tableName].features,u=0;u<s.length;u++)if(o=a[s[u]],o.tag===i)return o.feature;if(n){var l=a.length;return To.assert(0===l||i>=a[l-1].tag,"Features must be added in alphabetical order."),o={tag:i,feature:{params:0,lookupListIndexes:[]}},a.push(o),s.push(l),o.feature}}},getLookupTables:function(e,t,i,n,r){var o=this.getFeatureTable(e,t,i,r),s=[];if(o){for(var a,u=o.lookupListIndexes,l=this.font.tables[this.tableName].lookups,c=0;c<u.length;c++)a=l[u[c]],a.lookupType===n&&s.push(a);if(0===s.length&&r){a={lookupType:n,lookupFlag:0,subtables:[],markFilteringSet:void 0};var h=l.length;return l.push(a),u.push(h),[a]}}return s},getGlyphClass:function(e,t){switch(e.format){case 1:return e.startGlyph<=t&&t<e.startGlyph+e.classes.length?e.classes[t-e.startGlyph]:0;case 2:var i=Tt(e.ranges,t);return i?i.classId:0}},getCoverageIndex:function(e,t){switch(e.format){case 1:var i=St(e.glyphs,t);return i>=0?i:-1;case 2:var n=Tt(e.ranges,t);return n?n.index+t-n.start:-1}},expandCoverage:function(e){if(1===e.format)return e.glyphs;for(var t=[],i=e.ranges,n=0;n<i.length;n++)for(var r=i[n],o=r.start,s=r.end,a=o;a<=s;a++)t.push(a);return t}},Ft.prototype=Ct.prototype,Ft.prototype.init=function(){var e=this.getDefaultScriptName();this.defaultKerningTables=this.getKerningTables(e)},Ft.prototype.getKerningValue=function(e,t,i){for(var n=0;n<e.length;n++)for(var r=e[n].subtables,o=0;o<r.length;o++){var s=r[o],a=this.getCoverageIndex(s.coverage,t);if(!(a<0))switch(s.posFormat){case 1:for(var u=s.pairSets[a],l=0;l<u.length;l++){var c=u[l];if(c.secondGlyph===i)return c.value1&&c.value1.xAdvance||0}break;case 2:var h=this.getGlyphClass(s.classDef1,t),d=this.getGlyphClass(s.classDef2,i),p=s.classRecords[h][d];return p.value1&&p.value1.xAdvance||0}}return 0},Ft.prototype.getKerningTables=function(e,t){if(this.font.tables.gpos)return this.getLookupTables(e,t,"kern",2)},Ot.prototype=Ct.prototype,Ot.prototype.createDefaultTable=function(){return{version:1,scripts:[{tag:"DFLT",script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}}],features:[],lookups:[]}},Ot.prototype.getSingle=function(e,t,i){for(var n=[],r=this.getLookupTables(t,i,e,1),o=0;o<r.length;o++)for(var s=r[o].subtables,a=0;a<s.length;a++){var u=s[a],l=this.expandCoverage(u.coverage),c=void 0;if(1===u.substFormat){var h=u.deltaGlyphId;for(c=0;c<l.length;c++){var d=l[c];n.push({sub:d,by:d+h})}}else{var p=u.substitute;for(c=0;c<l.length;c++)n.push({sub:l[c],by:p[c]})}}return n},Ot.prototype.getMultiple=function(e,t,i){for(var n=[],r=this.getLookupTables(t,i,e,2),o=0;o<r.length;o++)for(var s=r[o].subtables,a=0;a<s.length;a++){var u=s[a],l=this.expandCoverage(u.coverage),c=void 0;for(c=0;c<l.length;c++){var h=l[c],d=u.sequences[c];n.push({sub:h,by:d})}}return n},Ot.prototype.getAlternates=function(e,t,i){for(var n=[],r=this.getLookupTables(t,i,e,3),o=0;o<r.length;o++)for(var s=r[o].subtables,a=0;a<s.length;a++)for(var u=s[a],l=this.expandCoverage(u.coverage),c=u.alternateSets,h=0;h<l.length;h++)n.push({sub:l[h],by:c[h]});return n},Ot.prototype.getLigatures=function(e,t,i){for(var n=[],r=this.getLookupTables(t,i,e,4),o=0;o<r.length;o++)for(var s=r[o].subtables,a=0;a<s.length;a++)for(var u=s[a],l=this.expandCoverage(u.coverage),c=u.ligatureSets,h=0;h<l.length;h++)for(var d=l[h],p=c[h],f=0;f<p.length;f++){var g=p[f];n.push({sub:[d].concat(g.components),by:g.ligGlyph})}return n},Ot.prototype.addSingle=function(e,t,i,n){var r=this.getLookupTables(i,n,e,1,!0)[0],o=Et(r,2,{substFormat:2,coverage:{format:1,glyphs:[]},substitute:[]});To.assert(1===o.coverage.format,"Single: unable to modify coverage table format "+o.coverage.format);var s=t.sub,a=this.binSearch(o.coverage.glyphs,s);a<0&&(a=-1-a,o.coverage.glyphs.splice(a,0,s),o.substitute.splice(a,0,0)),o.substitute[a]=t.by},Ot.prototype.addMultiple=function(e,t,i,n){To.assert(t.by instanceof Array&&t.by.length>1,'Multiple: "by" must be an array of two or more ids');var r=this.getLookupTables(i,n,e,2,!0)[0],o=Et(r,1,{substFormat:1,coverage:{format:1,glyphs:[]},sequences:[]});To.assert(1===o.coverage.format,"Multiple: unable to modify coverage table format "+o.coverage.format);var s=t.sub,a=this.binSearch(o.coverage.glyphs,s);a<0&&(a=-1-a,o.coverage.glyphs.splice(a,0,s),o.sequences.splice(a,0,0)),o.sequences[a]=t.by},Ot.prototype.addAlternate=function(e,t,i,n){var r=this.getLookupTables(i,n,e,3,!0)[0],o=Et(r,1,{substFormat:1,coverage:{format:1,glyphs:[]},alternateSets:[]});To.assert(1===o.coverage.format,"Alternate: unable to modify coverage table format "+o.coverage.format);var s=t.sub,a=this.binSearch(o.coverage.glyphs,s);a<0&&(a=-1-a,o.coverage.glyphs.splice(a,0,s),o.alternateSets.splice(a,0,0)),o.alternateSets[a]=t.by},Ot.prototype.addLigature=function(e,t,i,n){var r=this.getLookupTables(i,n,e,4,!0)[0],o=r.subtables[0];o||(o={substFormat:1,coverage:{format:1,glyphs:[]},ligatureSets:[]},r.subtables[0]=o),To.assert(1===o.coverage.format,"Ligature: unable to modify coverage table format "+o.coverage.format);var s=t.sub[0],a=t.sub.slice(1),u={ligGlyph:t.by,components:a},l=this.binSearch(o.coverage.glyphs,s);if(l>=0){for(var c=o.ligatureSets[l],h=0;h<c.length;h++)if(Nt(c[h].components,a))return;c.push(u)}else l=-1-l,o.coverage.glyphs.splice(l,0,s),o.ligatureSets.splice(l,0,[u])},Ot.prototype.getFeature=function(e,t,i){if(/ss\d\d/.test(e))return this.getSingle(e,t,i);switch(e){case"aalt":case"salt":return this.getSingle(e,t,i).concat(this.getAlternates(e,t,i));case"dlig":case"liga":case"rlig":return this.getLigatures(e,t,i);case"ccmp":return this.getMultiple(e,t,i).concat(this.getLigatures(e,t,i));case"stch":return this.getMultiple(e,t,i)}},Ot.prototype.add=function(e,t,i,n){if(/ss\d\d/.test(e))return this.addSingle(e,t,i,n);switch(e){case"aalt":case"salt":return"number"==typeof t.by?this.addSingle(e,t,i,n):this.addAlternate(e,t,i,n);case"dlig":case"liga":case"rlig":return this.addLigature(e,t,i,n);case"ccmp":return t.by instanceof Array?this.addMultiple(e,t,i,n):this.addLigature(e,t,i,n)}};var gs,ms,ys,_s,xs={getPath:Lt,parse:zt},ws=function(e){var t=this.srPeriod,i=this.srPhase,n=this.srThreshold,r=1;return e<0&&(e=-e,r=-1),e+=n-i,e=Math.trunc(e/t)*t,e+=i,e<0?i*r:e*r},bs={x:1,y:0,axis:"x",distance:function(e,t,i,n){return(i?e.xo:e.x)-(n?t.xo:t.x)},interpolate:function(e,t,i,n){var r,o,s,a,u,l,c;return n&&n!==this?(r=n.distance(e,t,!0,!0),o=n.distance(e,i,!0,!0),u=n.distance(t,t,!1,!0),l=n.distance(i,i,!1,!0),s=Math.abs(r),a=Math.abs(o),0===(c=s+a)?void bs.setRelative(e,e,(u+l)/2,n,!0):void bs.setRelative(e,e,(u*a+l*s)/c,n,!0)):(r=e.xo-t.xo,o=e.xo-i.xo,u=t.x-t.xo,l=i.x-i.xo,s=Math.abs(r),a=Math.abs(o),0===(c=s+a)?void(e.x=e.xo+(u+l)/2):void(e.x=e.xo+(u*a+l*s)/c))},normalSlope:Number.NEGATIVE_INFINITY,setRelative:function(e,t,i,n,r){if(!n||n===this)return void(e.x=(r?t.xo:t.x)+i);var o=r?t.xo:t.x,s=r?t.yo:t.y,a=o+i*n.x,u=s+i*n.y;e.x=a+(e.y-u)/n.normalSlope},slope:0,touch:function(e){e.xTouched=!0},touched:function(e){return e.xTouched},untouch:function(e){e.xTouched=!1}},vs={x:0,y:1,axis:"y",distance:function(e,t,i,n){return(i?e.yo:e.y)-(n?t.yo:t.y)},interpolate:function(e,t,i,n){var r,o,s,a,u,l,c;return n&&n!==this?(r=n.distance(e,t,!0,!0),o=n.distance(e,i,!0,!0),u=n.distance(t,t,!1,!0),l=n.distance(i,i,!1,!0),s=Math.abs(r),a=Math.abs(o),0===(c=s+a)?void vs.setRelative(e,e,(u+l)/2,n,!0):void vs.setRelative(e,e,(u*a+l*s)/c,n,!0)):(r=e.yo-t.yo,o=e.yo-i.yo,u=t.y-t.yo,l=i.y-i.yo,s=Math.abs(r),a=Math.abs(o),0===(c=s+a)?void(e.y=e.yo+(u+l)/2):void(e.y=e.yo+(u*a+l*s)/c))},normalSlope:0,setRelative:function(e,t,i,n,r){if(!n||n===this)return void(e.y=(r?t.yo:t.y)+i);var o=r?t.xo:t.x,s=r?t.yo:t.y,a=o+i*n.x,u=s+i*n.y;e.y=u+n.normalSlope*(e.x-a)},slope:Number.POSITIVE_INFINITY,touch:function(e){e.yTouched=!0},touched:function(e){return e.yTouched},untouch:function(e){e.yTouched=!1}};Object.freeze(bs),Object.freeze(vs),Zt.prototype.distance=function(e,t,i,n){return this.x*bs.distance(e,t,i,n)+this.y*vs.distance(e,t,i,n)},Zt.prototype.interpolate=function(e,t,i,n){var r,o,s,a,u,l,c;if(s=n.distance(e,t,!0,!0),a=n.distance(e,i,!0,!0),r=n.distance(t,t,!1,!0),o=n.distance(i,i,!1,!0),u=Math.abs(s),l=Math.abs(a),0===(c=u+l))return void this.setRelative(e,e,(r+o)/2,n,!0);this.setRelative(e,e,(r*l+o*u)/c,n,!0)},Zt.prototype.setRelative=function(e,t,i,n,r){n=n||this;var o=r?t.xo:t.x,s=r?t.yo:t.y,a=o+i*n.x,u=s+i*n.y,l=n.normalSlope,c=this.slope,h=e.x,d=e.y;e.x=(c*h-l*a+u-d)/(c-l),e.y=c*(e.x-h)+d},Zt.prototype.touch=function(e){e.xTouched=!0,e.yTouched=!0},Qt.prototype.nextTouched=function(e){for(var t=this.nextPointOnContour;!e.touched(t)&&t!==this;)t=t.nextPointOnContour;return t},Qt.prototype.prevTouched=function(e){for(var t=this.prevPointOnContour;!e.touched(t)&&t!==this;)t=t.prevPointOnContour;return t};var Ss=Object.freeze(new Qt(0,0)),Ts={cvCutIn:17/16,deltaBase:9,deltaShift:.125,loop:1,minDis:1,autoFlip:!0};jt.prototype.exec=function(t,i){if("number"!=typeof i)throw new Error("Point size is not a number!");if(!(this._errorState>2)){var n=this.font,r=this._prepState;if(!r||r.ppem!==i){var o=this._fpgmState;if(!o){Jt.prototype=Ts,o=this._fpgmState=new Jt("fpgm",n.tables.fpgm),o.funcs=[],o.font=n,e.DEBUG&&(console.log("---EXEC FPGM---"),o.step=-1);try{ms(o)}catch(e){return console.log("Hinting error in FPGM:"+e),void(this._errorState=3)}}Jt.prototype=o,r=this._prepState=new Jt("prep",n.tables.prep),r.ppem=i;var s=n.tables.cvt;if(s)for(var a=r.cvt=new Array(s.length),u=i/n.unitsPerEm,l=0;l<s.length;l++)a[l]=s[l]*u;else r.cvt=[];e.DEBUG&&(console.log("---EXEC PREP---"),r.step=-1);try{ms(r)}catch(e){this._errorState<2&&console.log("Hinting error in PREP:"+e),this._errorState=2}}if(!(this._errorState>1))try{return ys(t,r)}catch(e){return this._errorState<1&&(console.log("Hinting error:"+e),console.log("Note: further hinting errors are silenced")),void(this._errorState=1)}}},ys=function(t,i){var n,r,o,s=i.ppem/i.font.unitsPerEm,a=s,u=t.components;if(Jt.prototype=i,u){var l=i.font;r=[],n=[];for(var c=0;c<u.length;c++){var h=u[c],d=l.glyphs.get(h.glyphIndex);o=new Jt("glyf",d.instructions),e.DEBUG&&(console.log("---EXEC COMP "+c+"---"),o.step=-1),_s(d,o,s,a);for(var p=Math.round(h.dx*s),f=Math.round(h.dy*a),g=o.gZone,m=o.contours,y=0;y<g.length;y++){var _=g[y];_.xTouched=_.yTouched=!1,_.xo=_.x=_.x+p,_.yo=_.y=_.y+f}var x=r.length;r.push.apply(r,g);for(var w=0;w<m.length;w++)n.push(m[w]+x)}t.instructions&&!o.inhibitGridFit&&(o=new Jt("glyf",t.instructions),o.gZone=o.z0=o.z1=o.z2=r,o.contours=n,r.push(new Qt(0,0),new Qt(Math.round(t.advanceWidth*s),0)),e.DEBUG&&(console.log("---EXEC COMPOSITE---"),o.step=-1),ms(o),r.length-=2)}else o=new Jt("glyf",t.instructions),e.DEBUG&&(console.log("---EXEC GLYPH---"),o.step=-1),_s(t,o,s,a),r=o.gZone;return r},_s=function(t,i,n,r){for(var o,s=t.points||[],a=s.length,u=i.gZone=i.z0=i.z1=i.z2=[],l=i.contours=[],c=0;c<a;c++)o=s[c],u[c]=new Qt(o.x*n,o.y*r,o.lastPointOfContour,o.onCurve);for(var h,d,p=0;p<a;p++)o=u[p],h||(h=o,l.push(p)),o.lastPointOfContour?(o.nextPointOnContour=h,h.prevPointOnContour=o,h=void 0):(d=u[p+1],o.nextPointOnContour=d,d.prevPointOnContour=o);if(!i.inhibitGridFit){if(e.DEBUG){console.log("PROCESSING GLYPH",i.stack);for(var f=0;f<a;f++)console.log(f,u[f].x,u[f].y)}if(u.push(new Qt(0,0),new Qt(Math.round(t.advanceWidth*n),0)),ms(i),u.length-=2,e.DEBUG){console.log("FINISHED GLYPH",i.stack);for(var g=0;g<a;g++)console.log(g,u[g].x,u[g].y)}}},ms=function(t){var i=t.prog;if(i){var n,r=i.length;for(t.ip=0;t.ip<r;t.ip++){if(e.DEBUG&&t.step++,!(n=gs[i[t.ip]]))throw new Error("unknown instruction: 0x"+Number(i[t.ip]).toString(16));n(t)}}},gs=[ii.bind(void 0,vs),ii.bind(void 0,bs),ni.bind(void 0,vs),ni.bind(void 0,bs),ri.bind(void 0,vs),ri.bind(void 0,bs),oi.bind(void 0,0),oi.bind(void 0,1),si.bind(void 0,0),si.bind(void 0,1),ai,ui,li,ci,hi,di,pi,fi,gi,mi,yi,_i,xi,wi,bi,vi,Si,Ti,Ci,Fi,void 0,void 0,Oi,Ni,Ei,Di,Mi,Bi,Ai,void 0,void 0,void 0,Vi,Ii,Pi,void 0,Ri.bind(void 0,0),Ri.bind(void 0,1),Li.bind(void 0,vs),Li.bind(void 0,bs),ki.bind(void 0,0),ki.bind(void 0,1),Ui.bind(void 0,0),Ui.bind(void 0,1),Xi.bind(void 0,0),Xi.bind(void 0,1),zi,ji,Gi.bind(void 0,0),Gi.bind(void 0,1),qi,Hi,Wi.bind(void 0,0),Wi.bind(void 0,1),Yi,$i,Zi,Ki,Qi,Ji,en.bind(void 0,0),en.bind(void 0,1),void 0,tn.bind(void 0,0),tn.bind(void 0,1),nn,void 0,rn,void 0,void 0,on,sn,an,un,ln,cn,hn,dn,pn,fn,gn,mn,yn,_n.bind(void 0,1),xn,wn,bn,vn,Sn,Tn,Cn,Fn,On,Nn,En.bind(void 0,0),En.bind(void 0,1),En.bind(void 0,2),En.bind(void 0,3),void 0,void 0,void 0,void 0,Dn,_n.bind(void 0,2),_n.bind(void 0,3),Mn.bind(void 0,1),Mn.bind(void 0,2),Mn.bind(void 0,3),Vn,In,void 0,void 0,Bn,void 0,An,Pn,Ni,Ni,void 0,void 0,void 0,void 0,void 0,Rn,Ln.bind(void 0,0),Ln.bind(void 0,1),kn,void 0,Un,Xn,zn,jn,Gn,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,qn.bind(void 0,1),qn.bind(void 0,2),qn.bind(void 0,3),qn.bind(void 0,4),qn.bind(void 0,5),qn.bind(void 0,6),qn.bind(void 0,7),qn.bind(void 0,8),Hn.bind(void 0,1),Hn.bind(void 0,2),Hn.bind(void 0,3),Hn.bind(void 0,4),Hn.bind(void 0,5),Hn.bind(void 0,6),Hn.bind(void 0,7),Hn.bind(void 0,8),Wn.bind(void 0,0,0,0,0,0),Wn.bind(void 0,0,0,0,0,1),Wn.bind(void 0,0,0,0,0,2),Wn.bind(void 0,0,0,0,0,3),Wn.bind(void 0,0,0,0,1,0),Wn.bind(void 0,0,0,0,1,1),Wn.bind(void 0,0,0,0,1,2),Wn.bind(void 0,0,0,0,1,3),Wn.bind(void 0,0,0,1,0,0),Wn.bind(void 0,0,0,1,0,1),Wn.bind(void 0,0,0,1,0,2),Wn.bind(void 0,0,0,1,0,3),Wn.bind(void 0,0,0,1,1,0),Wn.bind(void 0,0,0,1,1,1),Wn.bind(void 0,0,0,1,1,2),Wn.bind(void 0,0,0,1,1,3),Wn.bind(void 0,0,1,0,0,0),Wn.bind(void 0,0,1,0,0,1),Wn.bind(void 0,0,1,0,0,2),Wn.bind(void 0,0,1,0,0,3),Wn.bind(void 0,0,1,0,1,0),Wn.bind(void 0,0,1,0,1,1),Wn.bind(void 0,0,1,0,1,2),Wn.bind(void 0,0,1,0,1,3),Wn.bind(void 0,0,1,1,0,0),Wn.bind(void 0,0,1,1,0,1),Wn.bind(void 0,0,1,1,0,2),Wn.bind(void 0,0,1,1,0,3),Wn.bind(void 0,0,1,1,1,0),Wn.bind(void 0,0,1,1,1,1),Wn.bind(void 0,0,1,1,1,2),Wn.bind(void 0,0,1,1,1,3),Wn.bind(void 0,1,0,0,0,0),Wn.bind(void 0,1,0,0,0,1),Wn.bind(void 0,1,0,0,0,2),Wn.bind(void 0,1,0,0,0,3),Wn.bind(void 0,1,0,0,1,0),Wn.bind(void 0,1,0,0,1,1),Wn.bind(void 0,1,0,0,1,2),Wn.bind(void 0,1,0,0,1,3),Wn.bind(void 0,1,0,1,0,0),Wn.bind(void 0,1,0,1,0,1),Wn.bind(void 0,1,0,1,0,2),Wn.bind(void 0,1,0,1,0,3),Wn.bind(void 0,1,0,1,1,0),Wn.bind(void 0,1,0,1,1,1),Wn.bind(void 0,1,0,1,1,2),Wn.bind(void 0,1,0,1,1,3),Wn.bind(void 0,1,1,0,0,0),Wn.bind(void 0,1,1,0,0,1),Wn.bind(void 0,1,1,0,0,2),Wn.bind(void 0,1,1,0,0,3),Wn.bind(void 0,1,1,0,1,0),Wn.bind(void 0,1,1,0,1,1),Wn.bind(void 0,1,1,0,1,2),Wn.bind(void 0,1,1,0,1,3),Wn.bind(void 0,1,1,1,0,0),Wn.bind(void 0,1,1,1,0,1),Wn.bind(void 0,1,1,1,0,2),Wn.bind(void 0,1,1,1,0,3),Wn.bind(void 0,1,1,1,1,0),Wn.bind(void 0,1,1,1,1,1),Wn.bind(void 0,1,1,1,1,2),Wn.bind(void 0,1,1,1,1,3)],Yn.prototype.setState=function(e,t){return this.state[e]=t,this.activeState={key:e,value:this.state[e]},this.activeState},Yn.prototype.getState=function(e){return this.state[e]||null},er.prototype.inboundIndex=function(e){return e>=0&&e<this.tokens.length},er.prototype.composeRUD=function(e){var t=this,i=e.map(function(e){return t[e[0]].apply(t,e.slice(1).concat(!0))}),n=function(e){return"object"==typeof e&&e.hasOwnProperty("FAIL")};if(i.every(n))return{FAIL:"composeRUD: one or more operations hasn't completed successfully",report:i.filter(n)};this.dispatch("composeRUD",[i.filter(function(e){return!n(e)})])},er.prototype.replaceRange=function(e,t,i,n){t=null!==t?t:this.tokens.length;var r=i.every(function(e){return e instanceof Yn});if(!isNaN(e)&&this.inboundIndex(e)&&r){var o=this.tokens.splice.apply(this.tokens,[e,t].concat(i));return n||this.dispatch("replaceToken",[e,t,i]),[o,i]}return{FAIL:"replaceRange: invalid tokens or startIndex."}},er.prototype.replaceToken=function(e,t,i){if(!isNaN(e)&&this.inboundIndex(e)&&t instanceof Yn){var n=this.tokens.splice(e,1,t);return i||this.dispatch("replaceToken",[e,t]),[n[0],t]}return{FAIL:"replaceToken: invalid token or index."}},er.prototype.removeRange=function(e,t,i){t=isNaN(t)?this.tokens.length:t;var n=this.tokens.splice(e,t);return i||this.dispatch("removeRange",[n,e,t]),n},er.prototype.removeToken=function(e,t){if(!isNaN(e)&&this.inboundIndex(e)){var i=this.tokens.splice(e,1);return t||this.dispatch("removeToken",[i,e]),i}return{FAIL:"removeToken: invalid token index."}},er.prototype.insertToken=function(e,t,i){return e.every(function(e){return e instanceof Yn})?(this.tokens.splice.apply(this.tokens,[t,0].concat(e)),i||this.dispatch("insertToken",[e,t]),e):{FAIL:"insertToken: invalid token(s)."}},er.prototype.registerModifier=function(e,t,i){this.events.newToken.subscribe(function(n,r){var o=[n,r],s=null===t||t.apply(this,o)===!0,a=[n,r];if(s){var u=i.apply(this,a);n.setState(e,u)}}),this.registeredModifiers.push(e)},Qn.prototype.subscribe=function(e){return"function"==typeof e?this.subscribers.push(e)-1:{FAIL:"invalid '"+this.eventId+"' event handler"}},Qn.prototype.unsubscribe=function(e){this.subscribers.splice(e,1)},Kn.prototype.setCurrentIndex=function(e){this.index=e,this.current=this.context[e],this.backtrack=this.context.slice(0,e),this.lookahead=this.context.slice(e+1)},Kn.prototype.get=function(e){switch(!0){case 0===e:return this.current;case e<0&&Math.abs(e)<=this.backtrack.length:return this.backtrack.slice(e)[0];case e>0&&e<=this.lookahead.length:return this.lookahead[e-1];default:return null}},er.prototype.rangeToText=function(e){if(e instanceof $n)return this.getRangeTokens(e).map(function(e){return e.char}).join("")},er.prototype.getText=function(){return this.tokens.map(function(e){return e.char}).join("")},er.prototype.getContext=function(e){var t=this.registeredContexts[e];return t?t:null},er.prototype.on=function(e,t){var i=this.events[e];return i?i.subscribe(t):null},er.prototype.dispatch=function(e,t){var i=this,n=this.events[e];n instanceof Qn&&n.subscribers.forEach(function(e){e.apply(i,t||[])})},er.prototype.registerContextChecker=function(e,t,i){if(this.getContext(e))return{FAIL:"context name '"+e+"' is already registered."};if("function"!=typeof t)return{FAIL:"missing context start check."};if("function"!=typeof i)return{FAIL:"missing context end check."};var n=new Zn(e,t,i);return this.registeredContexts[e]=n,this.contextCheckers.push(n),n},er.prototype.getRangeTokens=function(e){var t=e.startIndex+e.endOffset;return[].concat(this.tokens.slice(e.startIndex,t))},er.prototype.getContextRanges=function(e){var t=this.getContext(e);return t?t.ranges:{FAIL:"context checker '"+e+"' is not registered."}},er.prototype.resetContextsRanges=function(){var e=this.registeredContexts;for(var t in e)if(e.hasOwnProperty(t)){var i=e[t];i.ranges=[]}},er.prototype.updateContextsRanges=function(){this.resetContextsRanges();for(var e=this.tokens.map(function(e){return e.char}),t=0;t<e.length;t++){var i=new Kn(e,t);this.runContextCheck(i)}this.dispatch("updateContextsRanges",[this.registeredContexts])},er.prototype.setEndOffset=function(e,t){var i=this.getContext(t).openRange.startIndex,n=new $n(i,e,t),r=this.getContext(t).ranges;return n.rangeId=t+"."+r.length,r.push(n),this.getContext(t).openRange=null,n},er.prototype.runContextCheck=function(e){var t=this,i=e.index;this.contextCheckers.forEach(function(n){var r=n.contextName,o=t.getContext(r).openRange;if(!o&&n.checkStart(e)&&(o=new $n(i,null,r),t.getContext(r).openRange=o,t.dispatch("contextStart",[r,i])),o&&n.checkEnd(e)){var s=i-o.startIndex+1,a=t.setEndOffset(s,r);t.dispatch("contextEnd",[r,a])}})},er.prototype.tokenize=function(e){this.tokens=[],this.resetContextsRanges();var t=Array.from(e);this.dispatch("start");for(var i=0;i<t.length;i++){var n=t[i],r=new Kn(t,i);this.dispatch("next",[r]),this.runContextCheck(r);var o=new Yn(n);this.tokens.push(o),this.dispatch("newToken",[o,r])}return this.dispatch("end",[this.tokens]),this.tokens},sr.prototype.getDefaultScriptFeaturesIndexes=function(){for(var e=this.font.tables.gsub.scripts,t=0;t<e.length;t++){var i=e[t];if("DFLT"===i.tag)return i.script.defaultLangSys.featureIndexes}return[]},sr.prototype.getScriptFeaturesIndexes=function(e){if(!this.font.tables.gsub)return[];if(!e)return this.getDefaultScriptFeaturesIndexes();for(var t=this.font.tables.gsub.scripts,i=0;i<t.length;i++){var n=t[i];if(n.tag===e&&n.script.defaultLangSys)return n.script.defaultLangSys.featureIndexes;var r=n.langSysRecords;if(r)for(var o=0;o<r.length;o++){var s=r[o];if(s.tag===e){var a=s.langSys;return a.featureIndexes}}}return this.getDefaultScriptFeaturesIndexes()},sr.prototype.mapTagsToFeatures=function(e,t){for(var i={},n=0;n<e.length;n++){var r=e[n].tag,o=e[n].feature;i[r]=o}this.features[t].tags=i},sr.prototype.getScriptFeatures=function(e){var t=this.features[e];if(this.features.hasOwnProperty(e))return t;var i=this.getScriptFeaturesIndexes(e);if(!i)return null;var n=this.font.tables.gsub;return t=i.map(function(e){return n.features[e]}),this.features[e]=t,this.mapTagsToFeatures(t,e),t},sr.prototype.getSubstitutionType=function(e,t){return e.lookupType.toString()+t.substFormat.toString()},sr.prototype.getLookupMethod=function(e,t){var i=this;switch(this.getSubstitutionType(e,t)){case"11":return function(e){return lr.apply(i,[e,t])};case"12":return function(e){return cr.apply(i,[e,t])};case"63":return function(e){return dr.apply(i,[e,t])};case"41":return function(e){return pr.apply(i,[e,t])};case"21":return function(e){return fr.apply(i,[e,t])};default:throw new Error("lookupType: "+e.lookupType+" - substFormat: "+t.substFormat+" is not yet supported")}},sr.prototype.lookupFeature=function(e){var t=e.contextParams,i=t.index,n=this.getFeature({tag:e.tag,script:e.script});if(!n)return new Error("font '"+this.font.names.fullName.en+"' doesn't support feature '"+e.tag+"' for script '"+e.script+"'.");for(var r=this.getFeatureLookups(n),o=[].concat(t.context),s=0;s<r.length;s++)for(var a=r[s],u=this.getLookupSubtables(a),l=0;l<u.length;l++){var c=u[l],h=this.getSubstitutionType(a,c),d=this.getLookupMethod(a,c),p=void 0;switch(h){case"11":p=d(t.current),p&&o.splice(i,1,new ar({id:11,tag:e.tag,substitution:p}));break;case"12":p=d(t.current),p&&o.splice(i,1,new ar({id:12,tag:e.tag,substitution:p}));break;case"63":p=d(t),Array.isArray(p)&&p.length&&o.splice(i,1,new ar({id:63,tag:e.tag,substitution:p}));break;case"41":p=d(t),p&&o.splice(i,1,new ar({id:41,tag:e.tag,substitution:p}));break;case"21":p=d(t.current),p&&o.splice(i,1,new ar({id:21,tag:e.tag,substitution:p}))}t=new Kn(o,i),Array.isArray(p)&&!p.length||(p=null)}return o.length?o:null},sr.prototype.supports=function(e){if(!e.script)return!1;this.getScriptFeatures(e.script);var t=this.features.hasOwnProperty(e.script);if(!e.tag)return t;var i=this.features[e.script].some(function(t){return t.tag===e.tag});return t&&i},sr.prototype.getLookupSubtables=function(e){return e.subtables||null},sr.prototype.getLookupByIndex=function(e){return this.font.tables.gsub.lookups[e]||null},sr.prototype.getFeatureLookups=function(e){return e.lookupListIndexes.map(this.getLookupByIndex.bind(this))},sr.prototype.getFeature=function(e){if(!this.font)return{FAIL:"No font was found"};this.features.hasOwnProperty(e.script)||this.getScriptFeatures(e.script);var t=this.features[e.script];return t?t.tags[e.tag]?this.features[e.script].tags[e.tag]:null:{FAIL:"No feature for script "+e.script}};var Cs={startCheck:gr,endCheck:mr},Fs={startCheck:yr,endCheck:_r},Os={11:xr,12:wr,63:br,41:vr},Ns={startCheck:Er,endCheck:Dr};Ir.prototype.setText=function(e){this.text=e},Ir.prototype.contextChecks={latinWordCheck:Ns,arabicWordCheck:Cs,arabicSentenceCheck:Fs},Ir.prototype.registerFeatures=function(e,t){var i=this,n=t.filter(function(t){return i.query.supports({script:e,tag:t})});this.featuresTags.hasOwnProperty(e)?this.featuresTags[e]=this.featuresTags[e].concat(n):this.featuresTags[e]=n},Ir.prototype.applyFeatures=function(e,t){if(!e)throw new Error("No valid font was provided to apply features");this.query||(this.query=new sr(e));for(var i=0;i<t.length;i++){var n=t[i];this.query.supports({script:n.script})&&this.registerFeatures(n.script,n.tags)}},Ir.prototype.registerModifier=function(e,t,i){this.tokenizer.registerModifier(e,t,i)},Ir.prototype.checkContextReady=function(e){return!!this.tokenizer.getContext(e)},Ir.prototype.applyFeaturesToContexts=function(){this.checkContextReady("arabicWord")&&(Lr.call(this),kr.call(this)),this.checkContextReady("latinWord")&&Ur.call(this),this.checkContextReady("arabicSentence")&&Pr.call(this)},Ir.prototype.processText=function(e){this.text&&this.text===e||(this.setText(e),Ar.call(this),this.applyFeaturesToContexts())},Ir.prototype.getBidiText=function(e){return this.processText(e),this.tokenizer.getText()},Ir.prototype.getTextGlyphs=function(e){this.processText(e);for(var t=[],i=0;i<this.tokenizer.tokens.length;i++){var n=this.tokenizer.tokens[i];if(!n.state.deleted){var r=n.activeState.value;t.push(Array.isArray(r)?r[0]:r)}}return t},Xr.prototype.hasChar=function(e){return null!==this.encoding.charToGlyphIndex(e)},Xr.prototype.charToGlyphIndex=function(e){return this.encoding.charToGlyphIndex(e)},Xr.prototype.charToGlyph=function(e){var t=this.charToGlyphIndex(e),i=this.glyphs.get(t);return i||(i=this.glyphs.get(0)),i},Xr.prototype.updateFeatures=function(e){return this.defaultRenderOptions.features.map(function(t){return"latn"===t.script?{script:"latn",tags:t.tags.filter(function(t){return e[t]})}:t})},Xr.prototype.stringToGlyphs=function(e,t){var i=this,n=new Ir,r=function(e){return i.charToGlyphIndex(e.char)};n.registerModifier("glyphIndex",null,r);var o=t?this.updateFeatures(t.features):this.defaultRenderOptions.features;n.applyFeatures(this,o);for(var s=n.getTextGlyphs(e),a=s.length,u=new Array(a),l=this.glyphs.get(0),c=0;c<a;c+=1)u[c]=this.glyphs.get(s[c])||l;return u},Xr.prototype.nameToGlyphIndex=function(e){return this.glyphNames.nameToGlyphIndex(e)},Xr.prototype.nameToGlyph=function(e){var t=this.nameToGlyphIndex(e),i=this.glyphs.get(t);return i||(i=this.glyphs.get(0)),i},Xr.prototype.glyphIndexToName=function(e){return this.glyphNames.glyphIndexToName?this.glyphNames.glyphIndexToName(e):""},Xr.prototype.getKerningValue=function(e,t){e=e.index||e,t=t.index||t;var i=this.position.defaultKerningTables;return i?this.position.getKerningValue(i,e,t):this.kerningPairs[e+","+t]||0},Xr.prototype.defaultRenderOptions={kerning:!0,features:[{script:"arab",tags:["init","medi","fina","rlig"]},{script:"latn",tags:["liga","rlig"]}]},Xr.prototype.forEachGlyph=function(e,t,i,n,r,o){t=void 0!==t?t:0,i=void 0!==i?i:0,n=void 0!==n?n:72,r=Object.assign({},this.defaultRenderOptions,r);var s,a=1/this.unitsPerEm*n,u=this.stringToGlyphs(e,r);if(r.kerning){var l=r.script||this.position.getDefaultScriptName();s=this.position.getKerningTables(l,r.language)}for(var c=0;c<u.length;c+=1){var h=u[c];if(o.call(this,h,t,i,n,r),h.advanceWidth&&(t+=h.advanceWidth*a),r.kerning&&c<u.length-1){t+=(s?this.position.getKerningValue(s,h.index,u[c+1].index):this.getKerningValue(h,u[c+1]))*a}r.letterSpacing?t+=r.letterSpacing*n:r.tracking&&(t+=r.tracking/1e3*n)}return t},Xr.prototype.getPath=function(e,t,i,n,r){var o=new f;return this.forEachGlyph(e,t,i,n,r,function(e,t,i,n){var s=e.getPath(t,i,n,r,this);o.extend(s)}),o},Xr.prototype.getPaths=function(e,t,i,n,r){var o=[];return this.forEachGlyph(e,t,i,n,r,function(e,t,i,n){var s=e.getPath(t,i,n,r,this);o.push(s)}),o},Xr.prototype.getAdvanceWidth=function(e,t,i){return this.forEachGlyph(e,0,0,t,i,function(){})},Xr.prototype.draw=function(e,t,i,n,r,o){this.getPath(t,i,n,r,o).draw(e)},Xr.prototype.drawPoints=function(e,t,i,n,r,o){this.forEachGlyph(t,i,n,r,o,function(t,i,n,r){t.drawPoints(e,i,n,r)})},Xr.prototype.drawMetrics=function(e,t,i,n,r,o){this.forEachGlyph(t,i,n,r,o,function(t,i,n,r){t.drawMetrics(e,i,n,r)})},Xr.prototype.getEnglishName=function(e){var t=this.names[e];if(t)return t.en},Xr.prototype.validate=function(){function e(e,t){}function t(t){var n=i.getEnglishName(t);e(n&&n.trim().length>0)}var i=this;t("fontFamily"),t("weightName"),t("manufacturer"),t("copyright"),t("version"),e(this.unitsPerEm>0)},Xr.prototype.toTables=function(){return fs.fontToTable(this)},Xr.prototype.toBuffer=function(){return console.warn("Font.toBuffer is deprecated. Use Font.toArrayBuffer instead."),this.toArrayBuffer()},Xr.prototype.toArrayBuffer=function(){for(var e=this.toTables(),t=e.encode(),i=new ArrayBuffer(t.length),n=new Uint8Array(i),r=0;r<t.length;r++)n[r]=t[r];return i},Xr.prototype.download=function(e){var t=this.getEnglishName("fontFamily"),i=this.getEnglishName("fontSubfamily");e=e||t.replace(/\s/g,"")+"-"+i+".otf";var n=this.toArrayBuffer();if(Dt())if(window.URL=window.URL||window.webkitURL,window.URL){var r=new DataView(n),o=new Blob([r],{type:"font/opentype"}),s=document.createElement("a");s.href=window.URL.createObjectURL(o),s.download=e;var a=document.createEvent("MouseEvents");a.initEvent("click",!0,!1),s.dispatchEvent(a)}else console.warn("Font file could not be downloaded. Try using a different browser.");else{var u=require("fs"),l=Vt(n);u.writeFileSync(e,l)}},Xr.prototype.fsSelectionValues={ITALIC:1,UNDERSCORE:2,NEGATIVE:4,OUTLINED:8,STRIKEOUT:16,BOLD:32,REGULAR:64,USER_TYPO_METRICS:128,WWS:256,OBLIQUE:512},Xr.prototype.usWidthClasses={ULTRA_CONDENSED:1,EXTRA_CONDENSED:2,CONDENSED:3,SEMI_CONDENSED:4,MEDIUM:5,SEMI_EXPANDED:6,EXPANDED:7,EXTRA_EXPANDED:8,ULTRA_EXPANDED:9},Xr.prototype.usWeightClasses={THIN:100,EXTRA_LIGHT:200,LIGHT:300,NORMAL:400,MEDIUM:500,SEMI_BOLD:600,BOLD:700,EXTRA_BOLD:800,BLACK:900};var Es={make:Wr,parse:Yr},Ds=function(){return{coverage:this.parsePointer(k.coverage),attachPoints:this.parseList(k.pointer(k.uShortList))}},Ms=function(){var e=this.parseUShort();return To.argument(1===e||2===e||3===e,"Unsupported CaretValue table version."),1===e?{coordinate:this.parseShort()}:2===e?{pointindex:this.parseShort()}:3===e?{coordinate:this.parseShort()}:void 0},Vs=function(){return this.parseList(k.pointer(Ms))},Is=function(){return{coverage:this.parsePointer(k.coverage),
ligGlyphs:this.parseList(k.pointer(Vs))}},Bs=function(){return this.parseUShort(),this.parseList(k.pointer(k.coverage))},As={parse:$r},Ps=new Array(10);Ps[1]=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort();return 1===t?{posFormat:1,coverage:this.parsePointer(k.coverage),value:this.parseValueRecord()}:2===t?{posFormat:2,coverage:this.parsePointer(k.coverage),values:this.parseValueRecordList()}:void To.assert(!1,"0x"+e.toString(16)+": GPOS lookup type 1 format must be 1 or 2.")},Ps[2]=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort();To.assert(1===t||2===t,"0x"+e.toString(16)+": GPOS lookup type 2 format must be 1 or 2.");var i=this.parsePointer(k.coverage),n=this.parseUShort(),r=this.parseUShort();if(1===t)return{posFormat:t,coverage:i,valueFormat1:n,valueFormat2:r,pairSets:this.parseList(k.pointer(k.list(function(){return{secondGlyph:this.parseUShort(),value1:this.parseValueRecord(n),value2:this.parseValueRecord(r)}})))};if(2===t){var o=this.parsePointer(k.classDef),s=this.parsePointer(k.classDef),a=this.parseUShort(),u=this.parseUShort();return{posFormat:t,coverage:i,valueFormat1:n,valueFormat2:r,classDef1:o,classDef2:s,class1Count:a,class2Count:u,classRecords:this.parseList(a,k.list(u,function(){return{value1:this.parseValueRecord(n),value2:this.parseValueRecord(r)}}))}}},Ps[3]=function(){return{error:"GPOS Lookup 3 not supported"}},Ps[4]=function(){return{error:"GPOS Lookup 4 not supported"}},Ps[5]=function(){return{error:"GPOS Lookup 5 not supported"}},Ps[6]=function(){return{error:"GPOS Lookup 6 not supported"}},Ps[7]=function(){return{error:"GPOS Lookup 7 not supported"}},Ps[8]=function(){return{error:"GPOS Lookup 8 not supported"}},Ps[9]=function(){return{error:"GPOS Lookup 9 not supported"}};var Rs=new Array(10),Ls={parse:Zr,make:Kr},ks={parse:eo},Us={parse:to},Xs=Object.freeze({__proto__:null,Font:Xr,Glyph:te,Path:f,BoundingBox:p,_parse:Po,parse:ao,load:uo,loadSync:lo});e.BoundingBox=p,e.Font=Xr,e.Glyph=te,e.Path=f,e._parse=Po,e.default=Xs,e.load=uo,e.loadSync=lo,e.parse=ao,Object.defineProperty(e,"__esModule",{value:!0})}),define("opentype",["opentype/dist/opentype"],function(e){return e}),define("x_ite/Browser/Text/X3DTextContext",["jquery","x_ite/Components/Text/FontStyle","opentype"],function(e,t,i){"use strict";function n(){this[o]=new Map,this[s]=new Map}const r=Symbol(),o=Symbol(),s=Symbol();return n.prototype={initialize:function(){},getDefaultFontStyle:function(){return this[r]=new t(this.getPrivateScene()),this[r].setup(),this.getDefaultFontStyle=function(){return this[r]},Object.defineProperty(this,"getDefaultFontStyle",{enumerable:!1}),this[r]},getFont:function(t){t=t.toString();let n=this[o].get(t);return void 0===n&&(this[o].set(t,n=e.Deferred()),i.load(t,this.setFont.bind(this,n))),n},setFont:function(e,t,i){t?e.reject(t):e.resolve(i)},getGlyph:function(e,t,i){let n=this[s].get(e);n||this[s].set(e,n=[]);let r=n[t];r||(r=n[t]=[]);let o=r[i];return o||(o=r[i]={}),o}},n}),define("x_ite/Components/Texturing/X3DTextureTransformNode",["x_ite/Components/Shape/X3DAppearanceChildNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Matrix4"],function(e,t,i){"use strict";function n(n){e.call(this,n),this.addType(t.X3DTextureTransformNode),this.matrixArray=new Float32Array(i.Identity)}return n.prototype=Object.assign(Object.create(e.prototype),{constructor:n,setMatrix:function(e){this.matrixArray.set(e)},setShaderUniformsToChannel:function(e,t,i){e.uniformMatrix4fv(t.x3d_TextureMatrix[i],!1,this.matrixArray)}}),n}),define("x_ite/Components/Texturing/X3DSingleTextureTransformNode",["x_ite/Components/Texturing/X3DTextureTransformNode","x_ite/Base/X3DConstants"],function(e,t){"use strict";function i(i){e.call(this,i),this.addType(t.X3DSingleTextureTransformNode)}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i,setShaderUniforms:function(e,t){for(let i=0,n=t.x3d_MaxTextures;i<n;++i)this.setShaderUniformsToChannel(e,t,i)}}),i}),define("x_ite/Components/Texturing/TextureTransform",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Texturing/X3DSingleTextureTransformNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector2","standard/Math/Numbers/Matrix3","standard/Math/Numbers/Matrix4"],function(e,t,i,n,r,o,s,a){"use strict";function u(e){n.call(this,e),this.addType(r.TextureTransform),this.rotation_.setUnit("angle"),this.matrix=new a}return u.prototype=Object.assign(Object.create(n.prototype),{constructor:u,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"mapping",new e.SFString),new t(r.inputOutput,"translation",new e.SFVec2f),new t(r.inputOutput,"rotation",new e.SFFloat),new t(r.inputOutput,"scale",new e.SFVec2f(1,1)),new t(r.inputOutput,"center",new e.SFVec2f)]),getTypeName:function(){return"TextureTransform"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"textureTransform"},initialize:function(){n.prototype.initialize.call(this),this.addInterest("eventsProcessed",this),this.eventsProcessed()},getMatrix:function(){return this.matrix},eventsProcessed:function(){const e=new o(0,0),t=new s;return function(){const i=this.translation_.getValue(),n=this.rotation_.getValue(),r=this.scale_.getValue(),s=this.center_.getValue(),a=this.matrix;t.identity(),s.equals(o.Zero)||t.translate(e.assign(s).negate()),r.equals(o.One)||t.scale(r),0!==n&&t.rotate(n),s.equals(o.Zero)||t.translate(s),i.equals(o.Zero)||t.translate(i),a[0]=t[0],a[1]=t[1],a[4]=t[3],a[5]=t[4],a[12]=t[6],a[13]=t[7],this.setMatrix(a)}}()}),u}),define("x_ite/Browser/Texturing/X3DTexturingContext",["x_ite/Components/Texturing/TextureProperties","x_ite/Components/Texturing/TextureTransform","x_ite/Components/Texturing/TextureCoordinate"],function(e,t,i){"use strict";function n(){const e=this.getContext(),t=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS);this[r]=t>8?2:1,this[o]=t>8,this[s]=t>8,this[a]=[]}const r=Symbol(),o=Symbol(),s=Symbol(),a=Symbol(),u=Symbol(),l=Symbol(),c=Symbol(),h=Symbol(),d=Symbol(),p=Symbol(),f=Symbol(),g=Symbol(),m=Symbol(),y=Symbol(),_=Symbol(),x=Symbol(),w=Symbol(),b=Symbol(),v=Symbol(),S=Symbol();return n.prototype={initialize:function(){const e=this.getContext();this[u]=e.getParameter(e.MAX_TEXTURE_SIZE),this[l]=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS),this[c]=NaN;const t=this[a];for(let e=1,i=this[l];e<i;++e)t.push(e);this[h]=this.getCombinedTextureUnits().pop(),this[d]=this.getCombinedTextureUnits().pop(),this[p]=this.getCombinedTextureUnits().pop(),this[f]=new Int32Array(this.getMaxTextures()),this[y]=new Int32Array(this.getMaxTextures());for(let e=0,t=this.getMaxTextures();e<t;++e)this[f][e]=this.getCombinedTextureUnits().pop();if(this.getProjectiveTextureMapping())for(let e=0,t=this.getMaxTextures();e<t;++e)this[y][e]=this.getCombinedTextureUnits().pop();const i=new Uint8Array([255,255,255,255]);this[_]=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this[_]),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,i),e.activeTexture(e.TEXTURE0+this[h]),e.bindTexture(e.TEXTURE_2D,this[_]),e.activeTexture(e.TEXTURE0+this[d]),e.bindTexture(e.TEXTURE_2D,this[_]),e.activeTexture(e.TEXTURE0+this[p]),e.bindTexture(e.TEXTURE_2D,this[_]);for(const t of this[f])e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,this[_]);for(const t of this[y])e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,this[_]);if(e.getVersion()>=2){this[g]=new Int32Array(this.getMaxTextures());for(let e=0,t=this.getMaxTextures();e<t;++e)this[g][e]=this.getCombinedTextureUnits().pop();this[x]=e.createTexture(),e.bindTexture(e.TEXTURE_3D,this[x]),e.texImage3D(e.TEXTURE_3D,0,e.RGBA,1,1,1,0,e.RGBA,e.UNSIGNED_BYTE,i);for(const t of this[g])e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_3D,this[x]);e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_3D,this[x])}this[m]=new Int32Array(this.getMaxTextures());for(let e=0,t=this.getMaxTextures();e<t;++e)this[m][e]=this.getCombinedTextureUnits().pop();this[w]=e.createTexture(),e.bindTexture(e.TEXTURE_CUBE_MAP,this[w]),e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_Z,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,i),e.texImage2D(e.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,i),e.texImage2D(e.TEXTURE_CUBE_MAP_NEGATIVE_X,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,i),e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,i),e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_Y,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,i),e.texImage2D(e.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,i);for(const t of this[m])e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_CUBE_MAP,this[w]);e.activeTexture(e.TEXTURE0)},getMaxTextures:function(){return this[r]},getMinTextureSize:function(){return 16},getMaxTextureSize:function(){return this[u]},getMaxCombinedTextureUnits:function(){return this[l]},getCombinedTextureUnits:function(){return this[a]},getTexture2DUnits:function(){return this[f]},getTexture3DUnits:function(){return this[g]},getCubeMapTextureUnits:function(){return this[m]},getProjectiveTextureUnits:function(){return this[y]},getShadowTextureUnit:function(){return this[h]},getLinetypeUnit:function(){return this[d]},getHatchStyleUnit:function(){return this[p]},getTextureMemory:function(){return this[c]},getMultiTexturing:function(){return this[o]},getProjectiveTextureMapping:function(){return this[s]},getDefaultTextureProperties:function(){return this[b]=new e(this.getPrivateScene()),this[b].magnificationFilter_="NICEST",this[b].minificationFilter_="AVG_PIXEL_AVG_MIPMAP",this[b].textureCompression_="NICEST",this[b].generateMipMaps_=!0,this[b].setup(),this.getDefaultTextureProperties=function(){return this[b]},Object.defineProperty(this,"getDefaultTextureProperties",{enumerable:!1}),this[b]},getDefaultTextureTransform:function(){return this[v]=new t(this.getPrivateScene()),this[v].setup(),this.getDefaultTextureTransform=function(){return this[v]},Object.defineProperty(this,"getDefaultTextureTransform",{enumerable:!1}),this[v]},getDefaultTextureCoordinate:function(){return this[S]=new i(this.getPrivateScene()),this[S].setup(),this.getDefaultTextureCoordinate=function(){return this[S]},Object.defineProperty(this,"getDefaultTextureCoordinate",{enumerable:!1}),this[S]}},n}),define("x_ite/Browser/Time/X3DTimeContext",["standard/Math/Numbers/Vector3"],function(e){"use strict";function t(){this[i]=0,this[n]=60,this[r]=new e(0,0,0),this[o]=0}const i=Symbol(),n=Symbol(),r=Symbol(),o=Symbol();return t.prototype={initialize:function(){this.advanceTime(performance.now())},getCurrentTime:function(){return this[i]},getCurrentFrameRate:function(){return this[n]},getCurrentSpeed:function(){return this[o]},advanceTime:function(){const t=new e(0,0,0);return function(e){const s=(e+performance.timeOrigin)/1e3,a=s-this[i];if(this[i]=s,this[n]=a?1/a:60,this.getWorld()&&this.getActiveLayer()){const e=this.getActiveLayer().getViewpoint().getCameraSpaceMatrix();t.assign(this[r]),this[r].set(e[12],e[13],e[14]),this[o]=t.subtract(this[r]).abs()*this[n]}else this[o]=0}}()},t}),define("x_ite/Browser/X3DBrowserContext",["jquery","x_ite/Fields/SFTime","x_ite/Base/X3DBaseNode","x_ite/Browser/Core/X3DCoreContext","x_ite/Routing/X3DRoutingContext","x_ite/Browser/Scripting/X3DScriptingContext","x_ite/Browser/Networking/X3DNetworkingContext","x_ite/Browser/Shaders/X3DShadersContext","x_ite/Browser/Rendering/X3DRenderingContext","x_ite/Browser/Shape/X3DShapeContext","x_ite/Browser/Grouping/X3DGroupingContext","x_ite/Browser/Geometry3D/X3DGeometry3DContext","x_ite/Browser/PointingDeviceSensor/X3DPointingDeviceSensorContext","x_ite/Browser/Navigation/X3DNavigationContext","x_ite/Browser/Layering/X3DLayeringContext","x_ite/Browser/EnvironmentalEffects/X3DEnvironmentalEffectsContext","x_ite/Browser/Lighting/X3DLightingContext","x_ite/Browser/Picking/X3DPickingContext","x_ite/Browser/Sound/X3DSoundContext","x_ite/Browser/Text/X3DTextContext","x_ite/Browser/Texturing/X3DTexturingContext","x_ite/Browser/Time/X3DTimeContext","x_ite/Execution/X3DWorld","x_ite/Rendering/TraverseType"],function(e,t,i,n,r,o,s,a,u,l,c,h,d,p,f,g,m,y,_,x,w,b,v,S){"use strict";function T(e){i.call(this,this),r.call(this),n.call(this,e),o.call(this),s.call(this),a.call(this),u.call(this),l.call(this),c.call(this),h.call(this),d.call(this),p.call(this),f.call(this),g.call(this),m.call(this),y.call(this),_.call(this),x.call(this),w.call(this),b.call(this);for(const e of B)e.call(this);this.addChildObjects("initialized",new t,"shutdown",new t,"prepareEvents",new t,"timeEvents",new t,"sensorEvents",new t,"finished",new t),this[F]=0,this[O]=this.traverse.bind(this),this[N]=0,this[E]=0,this[D]=0,this[M]=0,this[V]=0,this[I]=0}const C=Symbol(),F=Symbol(),O=Symbol(),N=Symbol(),E=Symbol(),D=Symbol(),M=Symbol(),V=Symbol(),I=Symbol(),B=[];T.prototype=Object.assign(Object.create(i.prototype),r.prototype,n.prototype,o.prototype,s.prototype,a.prototype,u.prototype,l.prototype,c.prototype,h.prototype,d.prototype,p.prototype,f.prototype,g.prototype,m.prototype,y.prototype,_.prototype,x.prototype,w.prototype,b.prototype,{constructor:T,initialize:function(){i.prototype.initialize.call(this),r.prototype.initialize.call(this),n.prototype.initialize.call(this),o.prototype.initialize.call(this),s.prototype.initialize.call(this),a.prototype.initialize.call(this),u.prototype.initialize.call(this),l.prototype.initialize.call(this),c.prototype.initialize.call(this),h.prototype.initialize.call(this),d.prototype.initialize.call(this),p.prototype.initialize.call(this),f.prototype.initialize.call(this),g.prototype.initialize.call(this),m.prototype.initialize.call(this),y.prototype.initialize.call(this),_.prototype.initialize.call(this),x.prototype.initialize.call(this),w.prototype.initialize.call(this),b.prototype.initialize.call(this);for(const e of B)e.prototype.initialize&&e.prototype.initialize.call(this)},initialized:function(){return this.initialized_},shutdown:function(){return this.shutdown_},prepareEvents:function(){return this.prepareEvents_},timeEvents:function(){return this.timeEvents_},sensorEvents:function(){return this.sensorEvents_},finished:function(){return this.finished_},getBrowser:function(){return this},getWorld:function(){return this[C]},setExecutionContext:function(e){this[C]=new v(e),this[C].setup()},getExecutionContext:function(){return this[C].getExecutionContext()},addBrowserEvent:function(){this[F]!==this.getCurrentTime()&&(this[F]=this.getCurrentTime(),this.requestAnimationFrame())},requestAnimationFrame:function(){window.requestAnimationFrame(this[O])},traverse:function(e){const t=this.getContext(),i=performance.now();this[N]=i-this[E],this.advanceTime(e),this.prepareEvents_.processInterests(),this.processEvents(),this.timeEvents_.processInterests(),this.processEvents();const n=performance.now();this[C].traverse(S.CAMERA,null),this[M]=performance.now()-n;const r=performance.now();this.getCollisionCount()&&this[C].traverse(S.COLLISION,null),this[V]=performance.now()-r,this.sensorEvents_.processInterests(),this.processEvents();const o=performance.now();t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT),this[C].traverse(S.DISPLAY,null),this[I]=performance.now()-o,this[D]=performance.now()-i,this[E]=performance.now(),this.finished_.processInterests()},getSystemTime:function(){return this[N]},getBrowserTime:function(){return this[D]},getCameraTime:function(){return this[M]},getCollisionTime:function(){return this[V]},getDisplayTime:function(){return this[I]}});for(const e of Reflect.ownKeys(T.prototype))Object.defineProperty(T.prototype,e,{enumerable:!1});return Object.assign(T,{addContext:function(t){const i=require("x_ite/X3D");B.push(t),Object.assign(T.prototype,t.prototype);for(const e of Reflect.ownKeys(t.prototype))Object.defineProperty(T.prototype,e,{enumerable:!1});e("X3DCanvas").each(function(e,n){const r=i.getBrowser(n);t.call(r),t.prototype.initialize&&t.prototype.initialize.call(r)})}}),T}),define("x_ite/Components/Core/X3DMetadataObject",["x_ite/Base/X3DConstants"],function(e){"use strict";function t(t){this.addType(e.X3DMetadataObject)}return t.prototype={constructor:t,initialize:function(){}},t}),define("x_ite/Components/Core/MetadataBoolean",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Components/Core/X3DMetadataObject","x_ite/Base/X3DConstants"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),r.call(this,e),this.addType(o.MetadataBoolean)}return s.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOutput,"name",new e.SFString),new t(o.inputOutput,"reference",new e.SFString),new t(o.inputOutput,"value",new e.MFBool)]),getTypeName:function(){return"MetadataBoolean"},getComponentName:function(){return"Core"},getContainerField:function(){return"metadata"}}),s}),define("x_ite/Components/Core/MetadataDouble",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Components/Core/X3DMetadataObject","x_ite/Base/X3DConstants"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),r.call(this,e),this.addType(o.MetadataDouble)}return s.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOutput,"name",new e.SFString),new t(o.inputOutput,"reference",new e.SFString),new t(o.inputOutput,"value",new e.MFDouble)]),getTypeName:function(){return"MetadataDouble"},getComponentName:function(){return"Core"},getContainerField:function(){return"metadata"}}),s}),define("x_ite/Components/Core/MetadataFloat",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Components/Core/X3DMetadataObject","x_ite/Base/X3DConstants"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),r.call(this,e),this.addType(o.MetadataFloat)}return s.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOutput,"name",new e.SFString),new t(o.inputOutput,"reference",new e.SFString),new t(o.inputOutput,"value",new e.MFFloat)]),getTypeName:function(){return"MetadataFloat"},getComponentName:function(){return"Core"},getContainerField:function(){return"metadata"}}),s}),define("x_ite/Components/Core/MetadataInteger",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Components/Core/X3DMetadataObject","x_ite/Base/X3DConstants"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),r.call(this,e),this.addType(o.MetadataInteger)}return s.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOutput,"name",new e.SFString),new t(o.inputOutput,"reference",new e.SFString),new t(o.inputOutput,"value",new e.MFInt32)]),getTypeName:function(){return"MetadataInteger"},getComponentName:function(){return"Core"},getContainerField:function(){return"metadata"}}),s}),define("x_ite/Components/Core/MetadataSet",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Components/Core/X3DMetadataObject","x_ite/Base/X3DConstants"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),r.call(this,e),this.addType(o.MetadataSet)}return s.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOutput,"name",new e.SFString),new t(o.inputOutput,"reference",new e.SFString),new t(o.inputOutput,"value",new e.MFNode)]),getTypeName:function(){return"MetadataSet"},getComponentName:function(){return"Core"},getContainerField:function(){return"metadata"}}),s}),define("x_ite/Components/Core/MetadataString",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Components/Core/X3DMetadataObject","x_ite/Base/X3DConstants"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),r.call(this,e),this.addType(o.MetadataString)}return s.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOutput,"name",new e.SFString),new t(o.inputOutput,"reference",new e.SFString),new t(o.inputOutput,"value",new e.MFString)]),getTypeName:function(){return"MetadataString"},getComponentName:function(){return"Core"},getContainerField:function(){return"metadata"}}),s}),define("x_ite/Components/Core/X3DInfoNode",["x_ite/Components/Core/X3DChildNode","x_ite/Base/X3DConstants"],function(e,t){"use strict";function i(i){e.call(this,i),this.addType(t.X3DInfoNode)}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i}),i}),define("x_ite/Components/Core/WorldInfo",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Core/X3DInfoNode","x_ite/Base/X3DConstants"],function(e,t,i,n,r){"use strict";function o(e){n.call(this,e),this.addType(r.WorldInfo)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"title",new e.SFString),new t(r.inputOutput,"info",new e.MFString)]),getTypeName:function(){return"WorldInfo"},getComponentName:function(){return"Core"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.getExecutionContext().addWorldInfo(this)},dispose:function(){this.getExecutionContext().removeWorldInfo(this),n.prototype.dispose.call(this)}}),o}),define("x_ite/Components/Core",["x_ite/Configuration/SupportedNodes","x_ite/Components/Core/MetadataBoolean","x_ite/Components/Core/MetadataDouble","x_ite/Components/Core/MetadataFloat","x_ite/Components/Core/MetadataInteger","x_ite/Components/Core/MetadataSet","x_ite/Components/Core/MetadataString","x_ite/Components/Core/WorldInfo","x_ite/Components/Core/X3DBindableNode","x_ite/Components/Core/X3DChildNode","x_ite/Components/Core/X3DInfoNode","x_ite/Components/Core/X3DMetadataObject","x_ite/Components/Core/X3DNode","x_ite/Components/Core/X3DPrototypeInstance","x_ite/Components/Core/X3DSensorNode"],function(e,t,i,n,r,o,s,a,u,l,c,h,d,p,f){"use strict";const g={MetadataBoolean:t,MetadataDouble:i,MetadataFloat:n,MetadataInteger:r,MetadataSet:o,MetadataString:s,WorldInfo:a},m={X3DBindableNode:u,X3DChildNode:l,X3DInfoNode:c,X3DMetadataObject:h,X3DNode:d,X3DPrototypeInstance:p,X3DSensorNode:f};for(const t in g)e.addType(t,g[t]);for(const t in m)e.addAbstractType(t,m[t])}),define("x_ite/Components/EnvironmentalEffects/FogCoordinate",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometricPropertyNode","x_ite/Base/X3DConstants"],function(e,t,i,n,r){"use strict";function o(e){n.call(this,e),this.addType(r.FogCoordinate),this.depth_.setUnit("length")}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"depth",new e.MFFloat)]),getTypeName:function(){return"FogCoordinate"},getComponentName:function(){return"EnvironmentalEffects"},getContainerField:function(){return"fogCoord"},initialize:function(){n.prototype.initialize.call(this),this.depth_.addInterest("set_depth__",this),this.set_depth__()},set_depth__:function(){this.depth=this.depth_.getValue(),this.length=this.depth_.length},isEmpty:function(){return 0===this.length},getSize:function(){return this.length},addDepth:function(e,t){e<this.length?t.push(this.depth[e]):this.length?t.push(this.depth[this.length-1]):t.push(0)},addDepths:function(e,t){var i=this.length;if(i){const o=this.depth;for(var n=0;n<i;++n)e.push(o[n]);for(var r=o[i-1],n=i;n<t;++n)e.push(r)}else for(var n=0;n<t;++n)e.push(0)}}),o}),define("x_ite/Components/EnvironmentalEffects/LocalFog",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Core/X3DChildNode","x_ite/Components/EnvironmentalEffects/X3DFogObject","x_ite/Base/X3DConstants"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),r.call(this,e),this.addType(o.LocalFog)}return s.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOutput,"enabled",new e.SFBool(!0)),new t(o.inputOutput,"fogType",new e.SFString("LINEAR")),new t(o.inputOutput,"color",new e.SFColor(1,1,1)),new t(o.inputOutput,"visibilityRange",new e.SFFloat)]),getTypeName:function(){return"LocalFog"},getComponentName:function(){return"EnvironmentalEffects"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),r.prototype.initialize.call(this)},push:function(e){if(this.enabled_.getValue()){var t=this.getFogs().pop();t.set(this,e.getModelViewMatrix().get()),e.pushLocalFog(t)}},pop:function(e){this.enabled_.getValue()&&e.getBrowser().getLocalObjects().push(e.popLocalFog())}}),s}),define("x_ite/Components/EnvironmentalEffects/TextureBackground",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/EnvironmentalEffects/X3DBackgroundNode","x_ite/Base/X3DCast","x_ite/Base/X3DConstants"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),this.addType(o.TextureBackground)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOnly,"set_bind",new e.SFBool),new t(o.inputOutput,"skyAngle",new e.MFFloat),new t(o.inputOutput,"skyColor",new e.MFColor(0,0,0)),new t(o.inputOutput,"groundAngle",new e.MFFloat),new t(o.inputOutput,"groundColor",new e.MFColor),new t(o.inputOutput,"transparency",new e.SFFloat),new t(o.outputOnly,"isBound",new e.SFBool),new t(o.outputOnly,"bindTime",new e.SFTime),new t(o.inputOutput,"frontTexture",new e.SFNode),new t(o.inputOutput,"backTexture",new e.SFNode),new t(o.inputOutput,"leftTexture",new e.SFNode),new t(o.inputOutput,"rightTexture",new e.SFNode),new t(o.inputOutput,"topTexture",new e.SFNode),new t(o.inputOutput,"bottomTexture",new e.SFNode)]),getTypeName:function(){return"TextureBackground"},getComponentName:function(){return"EnvironmentalEffects"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.frontTexture_.addInterest("set_frontTexture__",this),this.backTexture_.addInterest("set_backTexture__",this),this.leftTexture_.addInterest("set_leftTexture__",this),this.rightTexture_.addInterest("set_rightTexture__",this),this.topTexture_.addInterest("set_topTexture__",this),this.bottomTexture_.addInterest("set_bottomTexture__",this),this.set_frontTexture__(this.frontTexture_),this.set_backTexture__(this.backTexture_),this.set_leftTexture__(this.leftTexture_),this.set_rightTexture__(this.rightTexture_),this.set_topTexture__(this.topTexture_),this.set_bottomTexture__(this.bottomTexture_)},set_frontTexture__:function(){n.prototype.set_frontTexture__.call(this,r(o.X3DTextureNode,this.frontTexture_))},set_backTexture__:function(){n.prototype.set_backTexture__.call(this,r(o.X3DTextureNode,this.backTexture_))},set_leftTexture__:function(){n.prototype.set_leftTexture__.call(this,r(o.X3DTextureNode,this.leftTexture_))},set_rightTexture__:function(){n.prototype.set_rightTexture__.call(this,r(o.X3DTextureNode,this.rightTexture_))},set_topTexture__:function(){n.prototype.set_topTexture__.call(this,r(o.X3DTextureNode,this.topTexture_))},set_bottomTexture__:function(){n.prototype.set_bottomTexture__.call(this,r(o.X3DTextureNode,this.bottomTexture_))}}),s}),define("x_ite/Components/EnvironmentalEffects",["x_ite/Configuration/SupportedNodes","x_ite/Components/EnvironmentalEffects/Background","x_ite/Components/EnvironmentalEffects/Fog","x_ite/Components/EnvironmentalEffects/FogCoordinate","x_ite/Components/EnvironmentalEffects/LocalFog","x_ite/Components/EnvironmentalEffects/TextureBackground","x_ite/Components/EnvironmentalEffects/X3DBackgroundNode","x_ite/Components/EnvironmentalEffects/X3DFogObject"],function(e,t,i,n,r,o,s,a){"use strict";const u={Background:t,Fog:i,FogCoordinate:n,LocalFog:r,TextureBackground:o},l={X3DBackgroundNode:s,X3DFogObject:a};for(const t in u)e.addType(t,u[t]);for(const t in l)e.addAbstractType(t,l[t])}),define("x_ite/Components/EnvironmentalSensor/X3DEnvironmentalSensorNode",["x_ite/Fields","x_ite/Components/Core/X3DSensorNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,i,n){"use strict";function r(n){t.call(this,n),this.addType(i.X3DEnvironmentalSensorNode),this.addChildObjects("traversed",new e.SFBool(!0)),this.size_.setUnit("length"),this.center_.setUnit("length"),this.zeroTest=!1,this.currentTraversed=!0}return r.prototype=Object.assign(Object.create(t.prototype),{constructor:r,initialize:function(){t.prototype.initialize.call(this),this.isLive().addInterest("set_live__",this),this.enabled_.addInterest("set_live__",this),this.size_.addInterest("set_live__",this),this.traversed_.addInterest("set_live__",this),this.set_live__()},set_live__:function(){!(this.traversed_.getValue()&&this.isLive().getValue()&&this.enabled_.getValue())||this.zeroTest&&this.size_.getValue().equals(n.Zero)?(this.getBrowser().sensorEvents().removeInterest("update",this),this.isActive_.getValue()&&(this.isActive_=!1,this.exitTime_=this.getBrowser().getCurrentTime())):this.getBrowser().sensorEvents().addInterest("update",this)},setZeroTest:function(e){this.zeroTest=e},getZeroTest:function(){return this.zeroTest},setTraversed:function(e){e?this.traversed_.getValue()===!1&&(this.traversed_=!0):this.currentTraversed!==this.traversed_.getValue()&&(this.traversed_=this.currentTraversed),this.currentTraversed=e},getTraversed:function(){return this.currentTraversed},update:function(){}}),r}),define("x_ite/Components/EnvironmentalSensor/ProximitySensor",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/EnvironmentalSensor/X3DEnvironmentalSensorNode","x_ite/Rendering/TraverseType","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4"],function(e,t,i,n,r,o,s,a,u){"use strict";function l(e){n.call(this,e),this.addType(o.ProximitySensor),this.setCameraObject(!0),this.centerOfRotation_changed_.setUnit("length"),this.position_changed_.setUnit("length"),this.setZeroTest(!0),this.min=new s(0,0,0),this.max=new s(0,0,0),this.viewpointNode=null,this.modelMatrix=new u,this.inside=!1}return l.prototype=Object.assign(Object.create(n.prototype),{constructor:l,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOutput,"enabled",new e.SFBool(!0)),new t(o.inputOutput,"size",new e.SFVec3f),new t(o.inputOutput,"center",new e.SFVec3f),new t(o.outputOnly,"enterTime",new e.SFTime),new t(o.outputOnly,"exitTime",new e.SFTime),new t(o.outputOnly,"isActive",new e.SFBool),new t(o.outputOnly,"position_changed",new e.SFVec3f),new t(o.outputOnly,"orientation_changed",new e.SFRotation),new t(o.outputOnly,"centerOfRotation_changed",new e.SFVec3f)]),getTypeName:function(){return"ProximitySensor"},getComponentName:function(){return"EnvironmentalSensor"},
getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.enabled_.addInterest("set_enabled__",this),this.size_.addInterest("set_extents__",this),this.center_.addInterest("set_extents__",this),this.traversed_.addFieldInterest(this.isCameraObject_),this.set_enabled__(),this.set_extents__()},set_enabled__:function(){this.setCameraObject(this.enabled_.getValue()),this.enabled_.getValue()?delete this.traverse:this.traverse=Function.prototype},set_extents__:function(){const e=this.size_.getValue(),t=this.center_.getValue(),i=e.x/2,n=e.y/2,r=e.z/2,o=t.x,s=t.y,a=t.z;this.min.set(o-i,s-n,a-r),this.max.set(o+i,s+n,a+r)},update:function(){const e=new u,t=new u,i=new s(0,0,0),n=new a(0,0,1,0),r=new s(0,0,0);return function(){try{if(this.inside&&this.getTraversed()){if(this.viewpointNode){const o=this.modelMatrix;t.assign(this.viewpointNode.getModelMatrix()),t.translate(this.viewpointNode.getUserCenterOfRotation()),t.multRight(e.assign(o).inverse()),o.multRight(this.viewpointNode.getViewMatrix()),o.get(null,n),o.inverse(),i.set(o[12],o[13],o[14]),n.inverse(),r.set(t[12],t[13],t[14]),this.isActive_.getValue()?(this.position_changed_.getValue().equals(i)||(this.position_changed_=i),this.orientation_changed_.getValue().equals(n)||(this.orientation_changed_=n),this.centerOfRotation_changed_.getValue().equals(r)||(this.centerOfRotation_changed_=r)):(this.isActive_=!0,this.enterTime_=this.getBrowser().getCurrentTime(),this.position_changed_=i,this.orientation_changed_=n,this.centerOfRotation_changed_=r)}}else this.isActive_.getValue()&&(this.isActive_=!1,this.exitTime_=this.getBrowser().getCurrentTime())}catch(e){}this.inside=!1,this.viewpointNode=null,this.setTraversed(!1)}}(),traverse:function(){const e=new u,t=new s(-1,-1,-1);return function(i,n){try{switch(i){case r.CAMERA:return this.viewpointNode=n.getViewpoint(),void this.modelMatrix.assign(n.getModelViewMatrix().get());case r.DISPLAY:if(this.setTraversed(!0),this.inside)return;return void(this.size_.getValue().equals(t)?this.inside=!0:(e.assign(n.getModelViewMatrix().get()).inverse(),this.inside=this.containsPoint(e.origin)))}}catch(e){console.log(e)}}}(),containsPoint:function(e){const t=this.min,i=this.max;return t.x<=e.x&&i.x>=e.x&&t.y<=e.y&&i.y>=e.y&&t.z<=e.z&&i.z>=e.z}}),l}),define("x_ite/Components/EnvironmentalSensor/TransformSensor",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/EnvironmentalSensor/X3DEnvironmentalSensorNode","x_ite/Rendering/TraverseType","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Utility/ObjectCache"],function(e,t,i,n,r,o,s,a,u,l){"use strict";function c(e){n.call(this,e),this.addType(o.TransformSensor),this.position_changed_.setUnit("length"),this.setZeroTest(!0),this.min=new s,this.max=new s,this.targetObjectNode=null,this.modelMatrices=[],this.targetMatrices=[]}const h=l(u),d=l(u);return c.prototype=Object.assign(Object.create(n.prototype),{constructor:c,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOutput,"enabled",new e.SFBool(!0)),new t(o.inputOutput,"size",new e.SFVec3f),new t(o.inputOutput,"center",new e.SFVec3f),new t(o.outputOnly,"enterTime",new e.SFTime),new t(o.outputOnly,"exitTime",new e.SFTime),new t(o.outputOnly,"isActive",new e.SFBool),new t(o.outputOnly,"position_changed",new e.SFVec3f),new t(o.outputOnly,"orientation_changed",new e.SFRotation),new t(o.inputOutput,"targetObject",new e.SFNode)]),getTypeName:function(){return"TransformSensor"},getComponentName:function(){return"EnvironmentalSensor"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.isLive().addInterest("set_enabled__",this),this.enabled_.addInterest("set_enabled__",this),this.size_.addInterest("set_enabled__",this),this.size_.addInterest("set_extents__",this),this.center_.addInterest("set_extents__",this),this.targetObject_.addInterest("set_targetObject__",this),this.set_extents__(),this.set_targetObject__()},set_live__:function(){},set_enabled__:function(){this.isLive().getValue()&&this.targetObjectNode&&this.enabled_.getValue()&&!this.size_.getValue().equals(s.Zero)?(this.setPickableObject(!0),this.getBrowser().addTransformSensor(this),this.targetObjectNode.addTransformSensor(this)):(this.setPickableObject(!1),this.getBrowser().removeTransformSensor(this),this.targetObjectNode&&this.targetObjectNode.removeTransformSensor(this),this.isActive_.getValue()&&(this.isActive_=!1,this.exitTime_=this.getBrowser().getCurrentTime()))},set_extents__:function(){const e=this.size_.getValue(),t=this.center_.getValue(),i=e.x/2,n=e.y/2,r=e.z/2,o=t.x,s=t.y,a=t.z;this.min.set(o-i,s-n,a-r),this.max.set(o+i,s+n,a+r)},set_targetObject__:function(){this.targetObjectNode=null;try{const e=this.targetObject_.getValue().getInnerNode(),t=e.getType();for(let i=t.length-1;i>=0;--i){switch(t[i]){case o.X3DGroupingNode:case o.X3DShapeNode:this.targetObjectNode=e;break;default:continue}break}}catch(e){}this.set_enabled__()},traverse:function(e,t){e===r.PICKING&&this.getPickableObject()&&this.modelMatrices.push(h.pop().assign(t.getModelViewMatrix().get()))},collect:function(e){this.targetMatrices.push(d.pop().assign(e))},process:function(){const e=new s(0,0,0),t=new a(0,0,1,0);return function(){const i=this.modelMatrices,n=this.targetMatrices,r=this.intersects();r?(r.get(e,t),this.isActive_.getValue()?(this.position_changed_.getValue().equals(e)||(this.position_changed_=e),this.orientation_changed_.getValue().equals(t)||(this.orientation_changed_=t)):(this.isActive_=!0,this.enterTime_=this.getBrowser().getCurrentTime(),this.position_changed_=e,this.orientation_changed_=t)):this.isActive_.getValue()&&(this.isActive_=!1,this.exitTime_=this.getBrowser().getCurrentTime());for(const e of i)h.push(e);for(const e of n)d.push(e);i.length=0,n.length=0}}(),intersects:function(){const e=new s(-1,-1,-1);return function(){const t=this.modelMatrices,i=this.targetMatrices,n=this.size_.getValue().equals(e);for(const e of t){const t=e.inverse();for(const e of i){const i=e.multRight(t);if(n||this.containsPoint(i.origin))return i}}return null}}(),containsPoint:function(e){const t=this.min,i=this.max;return t.x<=e.x&&i.x>=e.x&&t.y<=e.y&&i.y>=e.y&&t.z<=e.z&&i.z>=e.z}}),c}),define("x_ite/Components/EnvironmentalSensor/VisibilitySensor",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/EnvironmentalSensor/X3DEnvironmentalSensorNode","x_ite/Rendering/TraverseType","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Geometry/Box3"],function(e,t,i,n,r,o,s,a){"use strict";function u(e){n.call(this,e),this.addType(o.VisibilitySensor),this.setZeroTest(!1),this.visible=!1}return u.prototype=Object.assign(Object.create(n.prototype),{constructor:u,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOutput,"enabled",new e.SFBool(!0)),new t(o.inputOutput,"size",new e.SFVec3f),new t(o.inputOutput,"center",new e.SFVec3f),new t(o.outputOnly,"enterTime",new e.SFTime),new t(o.outputOnly,"exitTime",new e.SFTime),new t(o.outputOnly,"isActive",new e.SFBool)]),getTypeName:function(){return"VisibilitySensor"},getComponentName:function(){return"EnvironmentalSensor"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.enabled_.addInterest("set_enabled__",this),this.set_enabled__()},set_enabled__:function(){this.enabled_.getValue()?delete this.traverse:this.traverse=Function.prototype},update:function(){this.visible&&this.getTraversed()?(this.isActive_.getValue()||(this.isActive_=!0,this.enterTime_=this.getBrowser().getCurrentTime()),this.visible=!1):this.isActive_.getValue()&&(this.isActive_=!1,this.exitTime_=this.getBrowser().getCurrentTime()),this.setTraversed(!1)},traverse:function(){const e=new a,t=new s(-1,-1,-1);return function(i,n){i===r.DISPLAY&&(this.setTraversed(!0),this.visible||(this.size_.getValue().equals(t)?this.visible=!0:(e.set(this.size_.getValue(),this.center_.getValue()).multRight(n.getModelViewMatrix().get()),this.visible=n.getViewVolume().intersectsBox(e))))}}()}),u}),define("x_ite/Components/EnvironmentalSensor",["x_ite/Configuration/SupportedNodes","x_ite/Components/EnvironmentalSensor/ProximitySensor","x_ite/Components/EnvironmentalSensor/TransformSensor","x_ite/Components/EnvironmentalSensor/VisibilitySensor","x_ite/Components/EnvironmentalSensor/X3DEnvironmentalSensorNode"],function(e,t,i,n,r){"use strict";const o={ProximitySensor:t,TransformSensor:i,VisibilitySensor:n},s={X3DEnvironmentalSensorNode:r};for(const t in o)e.addType(t,o[t]);for(const t in s)e.addAbstractType(t,s[t])}),define("x_ite/Components/Followers/ColorChaser",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Followers/X3DChaserNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Color3","standard/Math/Numbers/Vector3"],function(e,t,i,n,r,o,s){"use strict";function a(e){n.call(this,e),this.addType(r.ColorChaser)}var u=new s(0,0,0),l=new s(0,0,0),c=new s(0,0,0),h=new s(0,0,0);return a.prototype=Object.assign(Object.create(n.prototype),{constructor:a,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_value",new e.SFColor),new t(r.inputOnly,"set_destination",new e.SFColor),new t(r.initializeOnly,"initialValue",new e.SFColor(.8,.8,.8)),new t(r.initializeOnly,"initialDestination",new e.SFColor(.8,.8,.8)),new t(r.initializeOnly,"duration",new e.SFTime(1)),new t(r.outputOnly,"isActive",new e.SFBool),new t(r.outputOnly,"value_changed",new e.SFColor)]),getTypeName:function(){return"ColorChaser"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new s(0,0,0)},getValue:function(){return this.set_value_.getValue().getHSV(h)},getDestination:function(){return this.set_destination_.getValue().getHSV(h)},getInitialValue:function(){return this.initialValue_.getValue().getHSV(u)},getInitialDestination:function(){return this.initialDestination_.getValue().getHSV(l)},setValue:function(e){this.value_changed_.setHSV(e.x,e.y,e.z)},interpolate:function(e,t,i){return o.lerp(e,t,i,h)},step:function(e,t,i){c.assign(this.output).add(e).subtract(t),o.lerp(this.output,c,i,this.output)}}),a}),define("x_ite/Components/Followers/X3DDamperNode",["x_ite/Components/Followers/X3DFollowerNode","x_ite/Base/X3DConstants","standard/Math/Algorithm"],function(e,t,i){"use strict";function n(i){e.call(this,i),this.addType(t.X3DDamperNode)}return n.prototype=Object.assign(Object.create(e.prototype),{constructor:n,initialize:function(){e.prototype.initialize.call(this),this.order_.addInterest("set_order__",this),this.set_value_.addInterest("set_value__",this),this.set_destination_.addInterest("set_destination__",this);var t=this.getBuffer(),i=this.getInitialValue(),n=this.getInitialDestination();t[0]=this.duplicate(n);for(var r=1,o=this.getOrder()+1;r<o;++r)t[r]=this.duplicate(i);this.equals(n,i,this.getTolerance())?this.setValue(n):this.set_active(!0)},getOrder:function(){return i.clamp(this.order_.getValue(),0,5)},getTolerance:function(){return this.tolerance_.getValue()<0?1e-4:this.tolerance_.getValue()},prepareEvents:function(){var e=this.getBuffer(),t=e.length-1;if(this.tau_.getValue()){for(var i=1/this.getBrowser().currentFrameRate,n=Math.exp(-i/this.tau_.getValue()),r=0;r<t;++r)try{this.assign(e,r+1,this.interpolate(e[r],e[r+1],n))}catch(e){}if(this.setValue(e[t]),!this.equals(e[t],e[0],this.getTolerance()))return}else this.setValue(e[0]),t=0;for(var r=1,o=e.length;r<o;++r)this.assign(e,r,e[t]);this.set_active(!1)},set_value__:function(){for(var e=this.getBuffer(),t=this.getValue(),i=1,n=e.length;i<n;++i)this.assign(e,i,t);this.setValue(t),this.set_active(!0)},set_destination__:function(){this.assign(this.getBuffer(),0,this.getDestination()),this.set_active(!0)},set_order__:function(){for(var e=this.getBuffer(),t=e[e.length-1],i=e.length,n=this.getOrder()+1;i<n;++i)e[i]=this.duplicate(t);e.length=n}}),n}),define("x_ite/Components/Followers/ColorDamper",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Followers/X3DDamperNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Color3","standard/Math/Numbers/Vector3"],function(e,t,i,n,r,o,s){"use strict";function a(e){n.call(this,e),this.addType(r.ColorDamper)}var u=new s(0,0,0),l=new s(0,0,0),c=new s(0,0,0),h=new s(0,0,0);return a.prototype=Object.assign(Object.create(n.prototype),{constructor:a,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_value",new e.SFColor),new t(r.inputOnly,"set_destination",new e.SFColor),new t(r.initializeOnly,"initialValue",new e.SFColor(.8,.8,.8)),new t(r.initializeOnly,"initialDestination",new e.SFColor(.8,.8,.8)),new t(r.initializeOnly,"order",new e.SFInt32(3)),new t(r.inputOutput,"tau",new e.SFTime(.3)),new t(r.inputOutput,"tolerance",new e.SFFloat(-1)),new t(r.outputOnly,"isActive",new e.SFBool),new t(r.outputOnly,"value_changed",new e.SFColor)]),getTypeName:function(){return"ColorDamper"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new s(0,0,0)},getValue:function(){return this.set_value_.getValue().getHSV(h)},getDestination:function(){return this.set_destination_.getValue().getHSV(h)},getInitialValue:function(){return this.initialValue_.getValue().getHSV(l)},getInitialDestination:function(){return this.initialDestination_.getValue().getHSV(c)},setValue:function(e){this.value_changed_.setHSV(e.x,e.y,e.z)},equals:function(e,t,i){return u.assign(e).subtract(t).abs()<i},interpolate:function(e,t,i){return o.lerp(e,t,i,h)}}),a}),define("x_ite/Browser/Followers/X3DArrayFollowerTemplate",[],function(){"use strict";return function(e){function t(){this.array=this.getArray(),this.zero=this.getVector()}return t.prototype={getArray:function(){const e=[];return e.assign=function(e){if(Array.isArray(e)){for(var t=0,i=Math.min(this.length,e.length);t<i;++t)this[t].assign(e[t]);for(var t=i,i=e.length;t<i;++t)this[t]=e[t].copy();this.length=i}else{for(var t=0,i=Math.min(this.length,e.length);t<i;++t)this[t].assign(e[t].getValue());for(var t=i,i=e.length;t<i;++t)this[t]=e[t].getValue().copy();this.length=i}},e},getValue:function(){return this.set_value_},getDestination:function(){return this.set_destination_},getInitialValue:function(){return this.initialValue_},getInitialDestination:function(){return this.initialDestination_},setValue:function(e){if(Array.isArray(e)){const n=this.value_changed_;for(var t=0,i=e.length;t<i;++t)n[t]=e[t];n.length=i}else this.value_changed_=e},duplicate:function(e){const t=this.getArray();return t.assign(e),t},equals:function(e,t,i){if(e.length!==t.length)return!1;const n=this.a;let r=0;for(let i=0,o=e.length;i<o;++i)r=Math.max(n.assign(e[i]).subtract(t[i]).abs());return r<i},interpolate:function(e,t,i){const n=this.array;n.assign(e);for(let e=0,r=n.length;e<r;++e)n[e].lerp(t[e]||this.zero,i);return n},set_destination__:function(){const t=this.getBuffer(),i=this.set_destination_.length;for(let e=0,n=t.length;e<n;++e){const n=t[e];for(let e=n.length;e<i;++e)n[e]=this.getVector();n.length=i}e.prototype.set_destination__.call(this)}},t}}),define("x_ite/Browser/Followers/X3DArrayChaserTemplate",["x_ite/Browser/Followers/X3DArrayFollowerTemplate"],function(e){"use strict";return function(t){function i(){n.call(this),this.array=this.getArray()}const n=e(t);return Object.assign(i.prototype,n.prototype,{step:function(e,t,i){const n=this.output,r=this.deltaOut;for(let o=0,s=n.length;o<s;++o)n[o].add(r.assign(e[o]||this.zero).subtract(t[o]||this.zero).multiply(i))}}),i}}),define("x_ite/Components/Followers/CoordinateChaser",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Followers/X3DChaserNode","x_ite/Browser/Followers/X3DArrayChaserTemplate","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,i,n,r,o,s){"use strict";function a(e){n.call(this,e),u.call(this,e),this.addType(o.CoordinateChaser)}var u=r(n);return a.prototype=Object.assign(Object.create(n.prototype),u.prototype,{constructor:a,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOnly,"set_value",new e.MFVec3f),new t(o.inputOnly,"set_destination",new e.MFVec3f),new t(o.initializeOnly,"initialValue",new e.MFVec3f(new s(0,0,0))),new t(o.initializeOnly,"initialDestination",new e.MFVec3f(new s(0,0,0))),new t(o.initializeOnly,"duration",new e.SFTime(1)),new t(o.outputOnly,"isActive",new e.SFBool),new t(o.outputOnly,"value_changed",new e.MFVec3f)]),getTypeName:function(){return"CoordinateChaser"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new s(0,0,0)}}),a}),define("x_ite/Components/Followers/CoordinateDamper",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Followers/X3DDamperNode","x_ite/Browser/Followers/X3DArrayFollowerTemplate","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,i,n,r,o,s){"use strict";function a(e){n.call(this,e),u.call(this,e),this.addType(o.CoordinateDamper)}var u=r(n);return a.prototype=Object.assign(Object.create(n.prototype),u.prototype,{constructor:a,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOnly,"set_value",new e.MFVec3f),new t(o.inputOnly,"set_destination",new e.MFVec3f),new t(o.initializeOnly,"initialValue",new e.MFVec3f(new s(0,0,0))),new t(o.initializeOnly,"initialDestination",new e.MFVec3f(new s(0,0,0))),new t(o.initializeOnly,"order",new e.SFInt32(3)),new t(o.inputOutput,"tau",new e.SFTime(.3)),new t(o.inputOutput,"tolerance",new e.SFFloat(-1)),new t(o.outputOnly,"isActive",new e.SFBool),new t(o.outputOnly,"value_changed",new e.MFVec3f)]),getTypeName:function(){return"CoordinateDamper"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new s(0,0,0)}}),a}),define("x_ite/Components/Followers/OrientationDamper",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Followers/X3DDamperNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Rotation4"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),this.addType(r.OrientationDamper),this.set_value_.setUnit("angle"),this.set_destination_.setUnit("angle"),this.initialValue_.setUnit("angle"),this.initialDestination_.setUnit("angle"),this.value_changed_.setUnit("angle")}var a=new o(0,0,1,0),u=new o(0,0,1,0);return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_value",new e.SFRotation),new t(r.inputOnly,"set_destination",new e.SFRotation),new t(r.initializeOnly,"initialValue",new e.SFRotation),new t(r.initializeOnly,"initialDestination",new e.SFRotation),new t(r.initializeOnly,"order",new e.SFInt32(3)),new t(r.inputOutput,"tau",new e.SFTime(.3)),new t(r.inputOutput,"tolerance",new e.SFFloat(-1)),new t(r.outputOnly,"isActive",new e.SFBool),new t(r.outputOnly,"value_changed",new e.SFRotation)]),getTypeName:function(){return"OrientationDamper"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new o(0,0,1,0)},equals:function(e,t,i){return a.assign(e).inverse().multRight(t),Math.abs(a.angle)<i},interpolate:function(e,t,i){return u.assign(e).slerp(t,i)}}),s}),define("x_ite/Components/Followers/PositionChaser2D",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Followers/X3DChaserNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector2"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),this.addType(r.PositionChaser2D)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_value",new e.SFVec2f),new t(r.inputOnly,"set_destination",new e.SFVec2f),new t(r.initializeOnly,"initialValue",new e.SFVec2f),new t(r.initializeOnly,"initialDestination",new e.SFVec2f),new t(r.initializeOnly,"duration",new e.SFTime(1)),new t(r.outputOnly,"isActive",new e.SFBool),new t(r.outputOnly,"value_changed",new e.SFVec2f)]),getTypeName:function(){return"PositionChaser2D"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new o(0,0)}}),s}),define("x_ite/Components/Followers/PositionDamper",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Followers/X3DDamperNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),this.addType(r.PositionDamper)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_value",new e.SFVec3f),new t(r.inputOnly,"set_destination",new e.SFVec3f),new t(r.initializeOnly,"initialValue",new e.SFVec3f),new t(r.initializeOnly,"initialDestination",new e.SFVec3f),new t(r.initializeOnly,"order",new e.SFInt32(3)),new t(r.inputOutput,"tolerance",new e.SFFloat(-1)),new t(r.inputOutput,"tau",new e.SFTime(.3)),new t(r.outputOnly,"value_changed",new e.SFVec3f),new t(r.outputOnly,"isActive",new e.SFBool)]),getTypeName:function(){return"PositionDamper"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new o(0,0,0)}}),s}),define("x_ite/Components/Followers/PositionDamper2D",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Followers/X3DDamperNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector2"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),this.addType(r.PositionDamper2D)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_value",new e.SFVec2f),new t(r.inputOnly,"set_destination",new e.SFVec2f),new t(r.initializeOnly,"initialValue",new e.SFVec2f),new t(r.initializeOnly,"initialDestination",new e.SFVec2f),new t(r.initializeOnly,"order",new e.SFInt32(3)),new t(r.inputOutput,"tau",new e.SFTime(.3)),new t(r.inputOutput,"tolerance",new e.SFFloat(-1)),new t(r.outputOnly,"isActive",new e.SFBool),new t(r.outputOnly,"value_changed",new e.SFVec2f)]),getTypeName:function(){return"PositionDamper2D"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new o(0,0)}}),s}),define("x_ite/Components/Followers/ScalarChaser",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Followers/X3DChaserNode","x_ite/Base/X3DConstants","standard/Math/Algorithm"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),this.addType(r.ScalarChaser)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_value",new e.SFFloat),new t(r.inputOnly,"set_destination",new e.SFFloat),new t(r.initializeOnly,"initialValue",new e.SFFloat),new t(r.initializeOnly,"initialDestination",new e.SFFloat),new t(r.initializeOnly,"duration",new e.SFTime(1)),new t(r.outputOnly,"isActive",new e.SFBool),new t(r.outputOnly,"value_changed",new e.SFFloat)]),getTypeName:function(){return"ScalarChaser"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return 0},setPreviousValue:function(e){this.previousValue=e},setDestination:function(e){this.destination=e},duplicate:function(e){return e},assign:function(e,t,i){e[t]=i},equals:function(e,t,i){return Math.abs(e-t)<i},interpolate:function(e,t,i){return o.lerp(e,t,i)},step:function(e,t,i){this.output+=(e-t)*i}}),s}),define("x_ite/Components/Followers/ScalarDamper",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Followers/X3DDamperNode","x_ite/Base/X3DConstants","standard/Math/Algorithm"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),this.addType(r.ScalarDamper)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_value",new e.SFFloat),new t(r.inputOnly,"set_destination",new e.SFFloat),new t(r.initializeOnly,"initialValue",new e.SFFloat),new t(r.initializeOnly,"initialDestination",new e.SFFloat),new t(r.initializeOnly,"order",new e.SFInt32(3)),new t(r.inputOutput,"tau",new e.SFTime(.3)),new t(r.inputOutput,"tolerance",new e.SFFloat(-1)),new t(r.outputOnly,"isActive",new e.SFBool),new t(r.outputOnly,"value_changed",new e.SFFloat)]),getTypeName:function(){return"ScalarDamper"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return 0},duplicate:function(e){return e},assign:function(e,t,i){e[t]=i},equals:function(e,t,i){return Math.abs(e-t)<i},interpolate:function(e,t,i){return o.lerp(e,t,i)}}),s}),define("x_ite/Components/Followers/TexCoordChaser2D",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Followers/X3DChaserNode","x_ite/Browser/Followers/X3DArrayChaserTemplate","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector2"],function(e,t,i,n,r,o,s){"use strict";function a(e){n.call(this,e),u.call(this,e),this.addType(o.TexCoordChaser2D)}var u=r(n);return a.prototype=Object.assign(Object.create(n.prototype),u.prototype,{constructor:a,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOnly,"set_value",new e.MFVec2f),new t(o.inputOnly,"set_destination",new e.MFVec2f),new t(o.initializeOnly,"initialValue",new e.MFVec2f),new t(o.initializeOnly,"initialDestination",new e.MFVec2f),new t(o.initializeOnly,"duration",new e.SFTime(1)),new t(o.outputOnly,"isActive",new e.SFBool),new t(o.outputOnly,"value_changed",new e.MFVec2f)]),getTypeName:function(){return"TexCoordChaser2D"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new s(0,0)}}),a}),define("x_ite/Components/Followers/TexCoordDamper2D",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Followers/X3DDamperNode","x_ite/Browser/Followers/X3DArrayFollowerTemplate","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector2"],function(e,t,i,n,r,o,s){"use strict";function a(e){n.call(this,e),u.call(this,e),this.addType(o.TexCoordDamper2D)}var u=r(n);return a.prototype=Object.assign(Object.create(n.prototype),u.prototype,{constructor:a,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOnly,"set_value",new e.MFVec2f),new t(o.inputOnly,"set_destination",new e.MFVec2f),new t(o.initializeOnly,"initialValue",new e.MFVec2f),new t(o.initializeOnly,"initialDestination",new e.MFVec2f),new t(o.initializeOnly,"order",new e.SFInt32(3)),new t(o.inputOutput,"tau",new e.SFTime(.3)),new t(o.inputOutput,"tolerance",new e.SFFloat(-1)),new t(o.outputOnly,"isActive",new e.SFBool),new t(o.outputOnly,"value_changed",new e.MFVec2f)]),getTypeName:function(){return"TexCoordDamper2D"},getComponentName:function(){return"Followers"},getContainerField:function(){return"children"},getVector:function(){return new s(0,0,0)}}),a}),define("x_ite/Components/Followers",["x_ite/Configuration/SupportedNodes","x_ite/Components/Followers/ColorChaser","x_ite/Components/Followers/ColorDamper","x_ite/Components/Followers/CoordinateChaser","x_ite/Components/Followers/CoordinateDamper","x_ite/Components/Followers/OrientationChaser","x_ite/Components/Followers/OrientationDamper","x_ite/Components/Followers/PositionChaser","x_ite/Components/Followers/PositionChaser2D","x_ite/Components/Followers/PositionDamper","x_ite/Components/Followers/PositionDamper2D","x_ite/Components/Followers/ScalarChaser","x_ite/Components/Followers/ScalarDamper","x_ite/Components/Followers/TexCoordChaser2D","x_ite/Components/Followers/TexCoordDamper2D","x_ite/Components/Followers/X3DChaserNode","x_ite/Components/Followers/X3DDamperNode","x_ite/Components/Followers/X3DFollowerNode"],function(e,t,i,n,r,o,s,a,u,l,c,h,d,p,f,g,m,y){"use strict";const _={ColorChaser:t,ColorDamper:i,CoordinateChaser:n,CoordinateDamper:r,OrientationChaser:o,OrientationDamper:s,PositionChaser:a,PositionChaser2D:u,PositionDamper:l,PositionDamper2D:c,ScalarChaser:h,ScalarDamper:d,TexCoordChaser2D:p,TexCoordDamper2D:f},x={X3DChaserNode:g,X3DDamperNode:m,X3DFollowerNode:y};for(const t in _)e.addType(t,_[t]);for(const t in x)e.addAbstractType(t,x[t])}),define("x_ite/Components/Geometry3D/Box",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),this.addType(r.Box),this.size_.setUnit("length")}var a=new o(2,2,2);return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.initializeOnly,"size",new e.SFVec3f(2,2,2)),new t(r.initializeOnly,"solid",new e.SFBool(!0))]),getTypeName:function(){return"Box"},getComponentName:function(){return"Geometry3D"},getContainerField:function(){return"geometry"},build:function(){var e=this.getBrowser().getBoxOptions(),t=e.getGeometry(),i=this.size_.getValue();if(this.setMultiTexCoords(t.getMultiTexCoords()),this.setNormals(t.getNormals()),i.equals(a))this.setVertices(t.getVertices()),this.getMin().assign(t.getMin()),this.getMax().assign(t.getMax());else{for(var n=o.divide(i,2),r=n.x,s=n.y,u=n.z,l=t.getVertices().getValue(),c=this.getVertices(),h=0;h<l.length;h+=4)c.push(r*l[h],s*l[h+1],u*l[h+2],1);r=Math.abs(r),s=Math.abs(s),u=Math.abs(u),this.getMin().set(-r,-s,-u),this.getMax().set(r,s,u)}this.setSolid(this.solid_.getValue())}}),s}),define("x_ite/Components/Geometry3D/Cone",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Complex","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3"],function(e,t,i,n,r,o,s,a){"use strict";function u(e){n.call(this,e),this.addType(r.Cone),this.height_.setUnit("length"),this.bottomRadius_.setUnit("length")}return u.prototype=Object.assign(Object.create(n.prototype),{constructor:u,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.initializeOnly,"side",new e.SFBool(!0)),new t(r.initializeOnly,"bottom",new e.SFBool(!0)),new t(r.initializeOnly,"height",new e.SFFloat(2)),new t(r.initializeOnly,"bottomRadius",new e.SFFloat(1)),new t(r.initializeOnly,"solid",new e.SFBool(!0))]),getTypeName:function(){return"Cone"},getComponentName:function(){return"Geometry3D"},getContainerField:function(){return"geometry"},set_live__:function(){n.prototype.set_live__.call(this),
this.isLive().getValue()?this.getBrowser().getConeOptions().addInterest("requestRebuild",this):this.getBrowser().getConeOptions().removeInterest("requestRebuild",this)},build:function(){var e=this.getBrowser().getConeOptions(),t=e.xDimension_.getValue(),i=this.height_.getValue(),n=this.bottomRadius_.getValue(),r=this.getTexCoords(),u=this.getNormals(),l=this.getVertices();this.getMultiTexCoords().push(r);var c=i/2,h=-c,d=o.Polar(1,-Math.PI/2+Math.atan(n/i));if(this.side_.getValue())for(var p=0;p<t;++p){var f=(p+.5)/t,g=2*Math.PI*f,m=o.Polar(d.imag,g),y=p/t,_=2*Math.PI*y,x=o.Polar(-n,_),w=o.Polar(d.imag,_),b=(p+1)/t,v=2*Math.PI*b,S=o.Polar(-n,v),T=o.Polar(d.imag,v);r.push(f,1,0,1),u.push(m.imag,d.real,m.real),l.push(0,c,0,1),r.push(y,0,0,1),u.push(w.imag,d.real,w.real),l.push(x.imag,h,x.real,1),r.push(b,0,0,1),u.push(T.imag,d.real,T.real),l.push(S.imag,h,S.real,1)}if(this.bottom_.getValue()){for(var C=[],F=[],p=t-1;p>-1;--p){var O=p/t,N=2*Math.PI*O,E=o.Polar(-1,N),D=o.multiply(E,n);C.push(new s((E.imag+1)/2,(E.real+1)/2)),F.push(new a(D.imag,h,D.real))}for(var M=C[0],V=F[0],p=1,I=F.length-1;p<I;++p){var B=C[p],A=C[p+1],P=F[p],x=F[p+1];r.push(M.x,M.y,0,1),u.push(0,-1,0),l.push(V.x,V.y,V.z,1),r.push(B.x,B.y,0,1),u.push(0,-1,0),l.push(P.x,P.y,P.z,1),r.push(A.x,A.y,0,1),u.push(0,-1,0),l.push(x.x,x.y,x.z,1)}}this.setSolid(this.solid_.getValue()),this.setExtents()},setExtents:function(){var e=this.bottomRadius_.getValue(),t=this.height_.getValue()/2,i=-t;this.side_.getValue()||this.bottom_.getValue()?this.side_.getValue()?(this.getMin().set(-e,i,-e),this.getMax().set(e,t,e)):(this.getMin().set(-e,i,-e),this.getMax().set(e,i,e)):(this.getMin().set(0,0,0),this.getMax().set(0,0,0))}}),u}),define("x_ite/Components/Geometry3D/Cylinder",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Complex","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3"],function(e,t,i,n,r,o,s,a){"use strict";function u(e){n.call(this,e),this.addType(r.Cylinder),this.height_.setUnit("length"),this.radius_.setUnit("length")}return u.prototype=Object.assign(Object.create(n.prototype),{constructor:u,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.initializeOnly,"top",new e.SFBool(!0)),new t(r.initializeOnly,"side",new e.SFBool(!0)),new t(r.initializeOnly,"bottom",new e.SFBool(!0)),new t(r.initializeOnly,"height",new e.SFFloat(2)),new t(r.initializeOnly,"radius",new e.SFFloat(1)),new t(r.initializeOnly,"solid",new e.SFBool(!0))]),getTypeName:function(){return"Cylinder"},getComponentName:function(){return"Geometry3D"},getContainerField:function(){return"geometry"},set_live__:function(){n.prototype.set_live__.call(this),this.isLive().getValue()?this.getBrowser().getCylinderOptions().addInterest("requestRebuild",this):this.getBrowser().getCylinderOptions().removeInterest("requestRebuild",this)},build:function(){var e=this.getBrowser().getCylinderOptions(),t=e.xDimension_.getValue(),i=this.getTexCoords(),n=this.getNormals(),r=this.getVertices();this.getMultiTexCoords().push(i);var u=this.radius_.getValue(),l=this.height_.getValue()/2,c=-l;if(this.side_.getValue())for(var h=0;h<t;++h){var d=h/t,p=2*Math.PI*d,f=o.Polar(-1,p),g=o.multiply(f,u),m=(h+1)/t,y=2*Math.PI*m,_=o.Polar(-1,y),x=o.multiply(_,u);i.push(d,1,0,1),n.push(f.imag,0,f.real),r.push(g.imag,l,g.real,1),i.push(d,0,0,1),n.push(f.imag,0,f.real),r.push(g.imag,c,g.real,1),i.push(m,0,0,1),n.push(_.imag,0,_.real),r.push(x.imag,c,x.real,1),i.push(d,1,0,1),n.push(f.imag,0,f.real),r.push(g.imag,l,g.real,1),i.push(m,0,0,1),n.push(_.imag,0,_.real),r.push(x.imag,c,x.real,1),i.push(m,1,0,1),n.push(_.imag,0,_.real),r.push(x.imag,l,x.real,1)}if(this.top_.getValue()){for(var w=[],b=[],h=0;h<t;++h){var v=h/t,S=2*Math.PI*v,T=o.Polar(-1,S);w.push(new s((T.imag+1)/2,-(T.real-1)/2)),b.push(new a(T.imag*u,l,T.real*u))}for(var C=w[0],F=b[0],h=1,O=b.length-1;h<O;++h){var N=w[h],E=w[h+1],g=b[h],x=b[h+1];i.push(C.x,C.y,0,1),n.push(0,1,0),r.push(F.x,F.y,F.z,1),i.push(N.x,N.y,0,1),n.push(0,1,0),r.push(g.x,g.y,g.z,1),i.push(E.x,E.y,0,1),n.push(0,1,0),r.push(x.x,x.y,x.z,1)}}if(this.bottom_.getValue()){for(var w=[],b=[],h=t-1;h>-1;--h){var v=h/t,S=2*Math.PI*v,T=o.Polar(-1,S);w.push(new s((T.imag+1)/2,(T.real+1)/2)),b.push(new a(T.imag*u,c,T.real*u))}for(var C=w[0],F=b[0],h=1,O=b.length-1;h<O;++h){var N=w[h],E=w[h+1],g=b[h],x=b[h+1];i.push(C.x,C.y,0,1),n.push(0,-1,0),r.push(F.x,F.y,F.z,1),i.push(N.x,N.y,0,1),n.push(0,-1,0),r.push(g.x,g.y,g.z,1),i.push(E.x,E.y,0,1),n.push(0,-1,0),r.push(x.x,x.y,x.z,1)}}this.setSolid(this.solid_.getValue()),this.setExtents()},setExtents:function(){var e=this.radius_.getValue(),t=this.height_.getValue()/2,i=-t;this.top_.getValue()||this.side_.getValue()||this.bottom_.getValue()?this.top_.getValue()||this.side_.getValue()?this.bottom_.getValue()||this.side_.getValue()?(this.getMin().set(-e,i,-e),this.getMax().set(e,t,e)):(this.getMin().set(-e,t,-e),this.getMax().set(e,t,e)):(this.getMin().set(-e,i,-e),this.getMax().set(e,i,e)):(this.getMin().set(0,0,0),this.getMax().set(0,0,0))}}),u}),define("x_ite/Components/Geometry3D/ElevationGrid",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Base/X3DCast","x_ite/Base/X3DConstants","standard/Math/Geometry/Triangle3","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3"],function(e,t,i,n,r,o,s,a,u){"use strict";function l(e){n.call(this,e),this.addType(o.ElevationGrid),this.xSpacing_.setUnit("length"),this.zSpacing_.setUnit("length"),this.creaseAngle_.setUnit("angle"),this.height_.setUnit("length"),this.fogCoordNode=null,this.colorNode=null,this.texCoordNode=null,this.normalNode=null,this.coordNode=null}return l.prototype=Object.assign(Object.create(n.prototype),{constructor:l,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOnly,"set_height",new e.MFFloat),new t(o.initializeOnly,"xDimension",new e.SFInt32),new t(o.initializeOnly,"zDimension",new e.SFInt32),new t(o.initializeOnly,"xSpacing",new e.SFFloat(1)),new t(o.initializeOnly,"zSpacing",new e.SFFloat(1)),new t(o.initializeOnly,"solid",new e.SFBool(!0)),new t(o.initializeOnly,"ccw",new e.SFBool(!0)),new t(o.initializeOnly,"creaseAngle",new e.SFFloat),new t(o.initializeOnly,"colorPerVertex",new e.SFBool(!0)),new t(o.initializeOnly,"normalPerVertex",new e.SFBool(!0)),new t(o.inputOutput,"attrib",new e.MFNode),new t(o.inputOutput,"fogCoord",new e.SFNode),new t(o.inputOutput,"color",new e.SFNode),new t(o.inputOutput,"texCoord",new e.SFNode),new t(o.inputOutput,"normal",new e.SFNode),new t(o.initializeOnly,"height",new e.MFFloat)]),getTypeName:function(){return"ElevationGrid"},getComponentName:function(){return"Geometry3D"},getContainerField:function(){return"geometry"},initialize:function(){n.prototype.initialize.call(this),this.set_height_.addFieldInterest(this.height_),this.attrib_.addInterest("set_attrib__",this),this.fogCoord_.addInterest("set_fogCoord__",this),this.color_.addInterest("set_color__",this),this.texCoord_.addInterest("set_texCoord__",this),this.normal_.addInterest("set_normal__",this),this.set_attrib__(),this.set_fogCoord__(),this.set_color__(),this.set_texCoord__(),this.set_normal__()},set_attrib__:function(){for(var e=this.getAttrib(),t=0,i=e.length;t<i;++t)e[t].removeInterest("requestRebuild",this);e.length=0;for(var t=0,i=this.attrib_.length;t<i;++t){var n=r(o.X3DVertexAttributeNode,this.attrib_[t]);n&&e.push(n)}for(var t=0;t<this.attribNodes.length;++t)e[t].addInterest("requestRebuild",this)},set_fogCoord__:function(){this.fogCoordNode&&this.fogCoordNode.removeInterest("requestRebuild",this),this.fogCoordNode=r(o.FogCoordinate,this.fogCoord_),this.fogCoordNode&&this.fogCoordNode.addInterest("requestRebuild",this)},set_color__:function(){this.colorNode&&(this.colorNode.removeInterest("requestRebuild",this),this.colorNode.transparent_.removeInterest("set_transparent__",this)),this.colorNode=r(o.X3DColorNode,this.color_),this.colorNode?(this.colorNode.addInterest("requestRebuild",this),this.colorNode.transparent_.addInterest("set_transparent__",this),this.set_transparent__()):this.setTransparent(!1)},set_transparent__:function(){this.setTransparent(this.colorNode.getTransparent())},set_texCoord__:function(){this.texCoordNode&&this.texCoordNode.removeInterest("requestRebuild",this),this.texCoordNode=r(o.X3DTextureCoordinateNode,this.texCoord_),this.texCoordNode&&this.texCoordNode.addInterest("requestRebuild",this),this.setTextureCoordinate(this.texCoordNode)},set_normal__:function(){this.normalNode&&this.normalNode.removeInterest("requestRebuild",this),this.normalNode=r(o.X3DNormalNode,this.normal_),this.normalNode&&this.normalNode.addInterest("requestRebuild",this)},getColor:function(){return this.colorNode},getTexCoord:function(){return this.texCoordNode},getNormal:function(){return this.normalNode},getHeight:function(e){return e<this.height_.length?this.height_[e]:0},createTexCoords:function(){for(var e=[],t=this.xDimension_.getValue(),i=this.zDimension_.getValue(),n=t-1,r=i-1,o=0;o<i;++o)for(var s=0;s<t;++s)e.push(new a(s/n,o/r));return e},createNormals:function(e,t,i){for(var n=!this.ccw_.getValue(),r=[],o=[],a=0;a<e.length;++a)r[a]=[];for(var l=0;l<t.length;l+=3){var c=t[l],h=t[l+1],d=t[l+2];r[c].push(o.length),r[h].push(o.length+1),r[d].push(o.length+2);var p=s.normal(e[c],e[h],e[d],new u(0,0,0));n&&p.negate(),o.push(p),o.push(p),o.push(p)}return this.refineNormals(r,o,this.creaseAngle_.getValue())},createCoordIndex:function(){for(var e=[],t=this.xDimension_.getValue(),i=this.zDimension_.getValue(),n=t-1,r=i-1,o=0;o<r;++o)for(var s=0;s<n;++s){var a=o*t+s,u=(o+1)*t+s,l=(o+1)*t+(s+1),c=o*t+(s+1);e.push(a),e.push(u),e.push(l),e.push(a),e.push(l),e.push(c)}return e},createPoints:function(){for(var e=[],t=this.xDimension_.getValue(),i=this.zDimension_.getValue(),n=this.xSpacing_.getValue(),r=this.zSpacing_.getValue(),o=0;o<i;++o)for(var s=0;s<t;++s)e.push(new u(n*s,this.getHeight(s+o*t),r*o));return e},build:function(){if(!(this.xDimension_.getValue()<2||this.zDimension_.getValue()<2)){var e=this.colorPerVertex_.getValue(),t=this.normalPerVertex_.getValue(),i=this.createCoordIndex(),n=this.getAttrib(),r=n.length,o=this.getAttribs(),s=this.fogCoordNode,a=this.getColor(),u=this.getTexCoord(),l=this.getNormal(),c=this.createPoints(),h=this.getFogDepths(),d=this.getColors(),p=this.getMultiTexCoords(),f=this.getNormals(),g=this.getVertices(),m=0;if(u)u.init(p);else{var y=this.createTexCoords(),_=this.getTexCoords();p.push(_)}for(var x=0,w=i.length;x<w;++m)for(var b=0;b<6;++b,++x){for(var v=i[x],S=c[v],T=0;T<r;++T)n[T].addValue(v,o[T]);if(s&&s.addDepth(v,h),a&&(e?a.addColor(v,d):a.addColor(m,d)),u)u.addTexCoord(v,p);else{var C=y[v];_.push(C.x,C.y,0,1)}l&&(t?l.addVector(v,f):l.addVector(m,f)),g.push(S.x,S.y,S.z,1)}if(!l)for(var F=this.createNormals(c,i),O=0;O<F.length;++O){var N=F[O];f.push(N.x,N.y,N.z)}this.setSolid(this.solid_.getValue()),this.setCCW(this.ccw_.getValue())}}}),l}),define("x_ite/Components/Geometry3D/Extrusion",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Base/X3DConstants","standard/Math/Geometry/Triangle3","standard/Math/Numbers/Vector2","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4"],function(e,t,i,n,r,o,s,a,u,l){"use strict";function c(e){n.call(this,e),this.addType(r.Extrusion),this.creaseAngle_.setUnit("angle"),this.crossSection_.setUnit("length"),this.spine_.setUnit("length")}return c.prototype=Object.assign(Object.create(n.prototype),{constructor:c,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_crossSection",new e.MFVec2f),new t(r.inputOnly,"set_orientation",new e.MFRotation),new t(r.inputOnly,"set_scale",new e.MFVec2f),new t(r.inputOnly,"set_spine",new e.MFVec3f),new t(r.initializeOnly,"beginCap",new e.SFBool(!0)),new t(r.initializeOnly,"endCap",new e.SFBool(!0)),new t(r.initializeOnly,"solid",new e.SFBool(!0)),new t(r.initializeOnly,"ccw",new e.SFBool(!0)),new t(r.initializeOnly,"convex",new e.SFBool(!0)),new t(r.initializeOnly,"creaseAngle",new e.SFFloat),new t(r.initializeOnly,"crossSection",new e.MFVec2f(new s(1,1),new s(1,-1),new s(-1,-1),new s(-1,1),new s(1,1))),new t(r.initializeOnly,"orientation",new e.MFRotation(new u)),new t(r.initializeOnly,"scale",new e.MFVec2f(new s(1,1))),new t(r.initializeOnly,"spine",new e.MFVec3f(new a(0,0,0),new a(0,1,0)))]),getTypeName:function(){return"Extrusion"},getComponentName:function(){return"Geometry3D"},getContainerField:function(){return"geometry"},initialize:function(){n.prototype.initialize.call(this),this.set_crossSection_.addFieldInterest(this.crossSection_),this.set_orientation_.addFieldInterest(this.orientation_),this.set_scale_.addFieldInterest(this.scale_),this.set_spine_.addFieldInterest(this.spine_)},getClosedOrientation:function(){var e=this.orientation_;if(e.length){var t=e[0].getValue(),i=e[e.length-1].getValue();return t.equals(i)}return!0},createPoints:function(){var e=new a(1,1,1);return function(){for(var t=this.crossSection_,i=this.orientation_,n=this.scale_,r=this.spine_,o=[],s=this.createRotations(),u=0,l=r.length;u<l;++u){var c=s[u];if(i.length&&c.rotate(i[Math.min(u,i.length-1)].getValue()),n.length){var h=n[Math.min(u,n.length-1)].getValue();c.scale(e.set(h.x,1,h.y))}for(var d=0,p=t.length;d<p;++d){var f=t[d].getValue();o.push(c.multVecMatrix(new a(f.x,0,f.y)))}}return o}}(),createRotations:function(){var e=[],t=new a(0,0,0),i=new a(0,0,0),n=new a(0,0,0),r=new a(0,0,0),o=new a(0,0,0),s=new a(0,0,0),c=new u(0,0,1,0);return function(){for(var u=this.spine_,h=u.length,d=u[0].getValue(),p=u[u.length-1].getValue(),f=d.equals(p)&&this.getClosedOrientation(),g=e.length;g<h;++g)e[g]=new l;if(e.length=h,t.set(0,0,0),i.set(0,0,0),n.set(0,0,0),f){for(var m=d,g=1,y=h-2;g<y&&(i.assign(u[g].getValue()).subtract(m).normalize().subtract(s.assign(u[y].getValue()).subtract(m).normalize()).normalize(),i.equals(a.Zero));++g);for(var g=0,y=h-2;g<y&&(n.assign(u[g+1].getValue()).subtract(u[g].getValue()).cross(s.assign(u[y].getValue()).subtract(u[g].getValue())).normalize(),n.equals(a.Zero));++g);}else{for(var g=0,y=h-1;g<y&&(i.assign(u[g+1].getValue()).subtract(u[g].getValue()).normalize(),i.equals(a.Zero));++g);for(var g=1,y=h-1;g<y&&(n.assign(u[g+1].getValue()).subtract(u[g].getValue()).cross(s.assign(u[g-1].getValue()).subtract(u[g].getValue())).normalize(),n.equals(a.Zero));++g);}i.equals(a.Zero)&&i.set(0,1,0),n.equals(a.Zero)&&c.setFromToVec(a.yAxis,i).multVecRot(n.assign(a.zAxis)),t.assign(i).cross(n);var m=d;e[0].set(t.x,t.y,t.z,0,i.x,i.y,i.z,0,n.x,n.y,n.z,0,m.x,m.y,m.z,1),r.assign(i),o.assign(n);for(var g=1,y=h-1;g<y;++g){var m=u[g].getValue();i.assign(u[g+1].getValue()).subtract(m).normalize().subtract(s.assign(u[g-1].getValue()).subtract(m).normalize()).normalize(),n.assign(u[g+1].getValue()).subtract(m).cross(s.assign(u[g-1].getValue()).subtract(m)).normalize(),o.dot(n)<0&&n.negate(),i.equals(a.Zero)?i.assign(r):r.assign(i),n.equals(a.Zero)?n.assign(o):o.assign(n),t.assign(i).cross(n),e[g].set(t.x,t.y,t.z,0,i.x,i.y,i.z,0,n.x,n.y,n.z,0,m.x,m.y,m.z,1)}if(f)e[h-1].assign(e[0]);else{var m=p;i.assign(m).subtract(u[h-2].getValue()).normalize(),h>2&&n.assign(m).subtract(u[h-2].getValue()).cross(s.assign(u[h-3].getValue()).subtract(u[h-2].getValue())).normalize(),o.dot(n)<0&&n.negate(),i.equals(a.Zero)&&i.assign(r),n.equals(a.Zero)&&n.assign(o),t.assign(i).cross(n),e[h-1].set(t.x,t.y,t.z,0,i.x,i.y,i.z,0,n.x,n.y,n.z,0,m.x,m.y,m.z,1)}return e}}(),build:function(){var e=new s(0,0,0),t=new s(0,0,0),i=new s(0,0,0);return function(){function n(e,t){return e*d+t}var r=!this.ccw_.getValue(),u=this.crossSection_,l=this.spine_,c=l.length,h=this.getTexCoords();if(!(c<2||u.length<2)){this.getMultiTexCoords().push(h);var d=u.length,p=l[0].getValue(),f=l[c-1].getValue(),g=p.equals(f)&&this.getClosedOrientation(),m=u[0].getValue(),y=u[u.length-1].getValue(),_=m.equals(y);e.assign(u[0].getValue()),t.assign(u[0].getValue());for(var x=1,w=u.length;x<w;++x)e.min(u[x].getValue()),t.max(u[x].getValue());for(var b=i.assign(t).subtract(e),v=Math.max(b.x,b.y),S=_?u.length-1:u.length,T=[],C=[],F=this.createPoints(),O=0,w=F.length;O<w;++O)T[O]=[];for(var N=this.getNormals(),E=this.getVertices(),D=u.length-1,M=c-1,V=n(0,0),I=n(0,_?0:D),B=0;B<M;++B)for(var x=0;x<D;++x){var A=g&&B===c-2?0:B+1,P=_&&x===u.length-2?0:x+1,R=n(B,x),L=n(B,P),k=n(A,P),U=n(A,x),X=F[R],z=F[L],j=F[k],G=F[U],q=z.distance(j)>=1e-7,H=G.distance(X)>=1e-7;if(r)var W=o.normal(j,z,X,new a(0,0,0)),Y=o.normal(G,j,X,new a(0,0,0));else var W=o.normal(X,z,j,new a(0,0,0)),Y=o.normal(X,j,G,new a(0,0,0));if(0==x&&(H?V=R:(R=V,X=F[R])),x==u.length-2&&(q?I=L:(k=I,j=F[k])),q){if(H)h.push(x/D,B/M,0,1);else{var $=(B/M+(B+1)/M)/2;h.push(x/D,$,0,1)}T[R].push(C.length),C.push(W),E.push(X.x,X.y,X.z,1),h.push((x+1)/D,B/M,0,1),T[L].push(C.length),C.push(W),E.push(z.x,z.y,z.z,1),h.push((x+1)/D,(B+1)/M,0,1),T[k].push(C.length),C.push(W),E.push(j.x,j.y,j.z,1)}if(H){if(h.push(x/D,B/M,0,1),T[R].push(C.length),C.push(Y),E.push(X.x,X.y,X.z,1),q)h.push((x+1)/D,(B+1)/M,0,1);else{var $=((B+1)/M+B/M)/2;h.push((x+1)/D,$,0,1)}T[k].push(C.length),C.push(Y),E.push(j.x,j.y,j.z,1),h.push(x/D,(B+1)/M,0,1),T[U].push(C.length),C.push(Y),E.push(G.x,G.y,G.z,1)}}C=this.refineNormals(T,C,this.creaseAngle_.getValue());for(var Z=0;Z<C.length;++Z){var K=C[Z];N.push(K.x,K.y,K.z)}if(v&&S>2){if(this.beginCap_.getValue()){for(var Q=0,J=[],ee=[],x=0;x<S;++x){var te=n(Q,S-1-x),ie=F[te].copy();ie.index=te,ie.texCoord=s.subtract(u[S-1-x].getValue(),e).divide(v),J.push(ie)}if(this.convex_.getValue()?o.triangulateConvexPolygon(J,ee):o.triangulatePolygon(J,ee),ee.length>=3){var K=o.normal(F[ee[0].index],F[ee[1].index],F[ee[2].index],new a(0,0,0));r&&K.negate(),this.addCap(h,K,F,ee)}}if(this.endCap_.getValue()){for(var Q=c-1,J=[],ee=[],x=0;x<S;++x){var te=n(Q,x),ie=F[te].copy();ie.index=te,ie.texCoord=s.subtract(u[x].getValue(),e).divide(v),J.push(ie)}if(this.convex_.getValue()?o.triangulateConvexPolygon(J,ee):o.triangulatePolygon(J,ee),ee.length>=3){var K=o.normal(F[ee[0].index],F[ee[1].index],F[ee[2].index],new a(0,0,0));r&&K.negate(),this.addCap(h,K,F,ee)}}}this.setSolid(this.solid_.getValue()),this.setCCW(this.ccw_.getValue())}}}(),addCap:function(e,t,i,n){for(var r=this.getNormals(),o=this.getVertices(),s=0;s<n.length;s+=3){var a=i[n[s].index],u=i[n[s+1].index],l=i[n[s+2].index],c=n[s].texCoord,h=n[s+1].texCoord,d=n[s+2].texCoord;e.push(c.x,c.y,0,1),e.push(h.x,h.y,0,1),e.push(d.x,d.y,0,1),r.push(t.x,t.y,t.z,t.x,t.y,t.z,t.x,t.y,t.z),o.push(a.x,a.y,a.z,1,u.x,u.y,u.z,1,l.x,l.y,l.z,1)}}}),c}),define("x_ite/Components/Geometry3D/Sphere",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Base/X3DConstants"],function(e,t,i,n,r){"use strict";function o(e){n.call(this,e),this.addType(r.Sphere),this.radius_.setUnit("length")}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.initializeOnly,"radius",new e.SFFloat(1)),new t(r.initializeOnly,"solid",new e.SFBool(!0))]),getTypeName:function(){return"Sphere"},getComponentName:function(){return"Geometry3D"},getContainerField:function(){return"geometry"},set_live__:function(){n.prototype.set_live__.call(this),this.isLive().getValue()?this.getBrowser().getSphereOptions().addInterest("requestRebuild",this):this.getBrowser().getSphereOptions().removeInterest("requestRebuild",this)},build:function(){var e=this.getBrowser().getSphereOptions(),t=e.getGeometry(),i=this.radius_.getValue();if(this.setMultiTexCoords(t.getMultiTexCoords()),this.setNormals(t.getNormals()),1===i)this.setVertices(t.getVertices()),this.getMin().assign(t.getMin()),this.getMax().assign(t.getMax());else{for(var n=t.getVertices().getValue(),r=this.getVertices(),o=0;o<n.length;o+=4)r.push(i*n[o],i*n[o+1],i*n[o+2],1);i=Math.abs(i),this.getMin().set(-i,-i,-i),this.getMax().set(i,i,i)}this.setSolid(this.solid_.getValue())}}),o}),define("x_ite/Components/Geometry3D",["x_ite/Configuration/SupportedNodes","x_ite/Components/Geometry3D/Box","x_ite/Components/Geometry3D/Cone","x_ite/Components/Geometry3D/Cylinder","x_ite/Components/Geometry3D/ElevationGrid","x_ite/Components/Geometry3D/Extrusion","x_ite/Components/Geometry3D/IndexedFaceSet","x_ite/Components/Geometry3D/Sphere"],function(e,t,i,n,r,o,s,a){"use strict";const u={Box:t,Cone:i,Cylinder:n,ElevationGrid:r,Extrusion:o,IndexedFaceSet:s,Sphere:a},l={};for(const t in u)e.addType(t,u[t]);for(const t in l)e.addAbstractType(t,l[t])}),define("x_ite/Components/Grouping/StaticGroup",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Core/X3DChildNode","x_ite/Components/Grouping/X3DBoundedObject","x_ite/Components/Grouping/Group","x_ite/Base/X3DConstants","x_ite/Rendering/TraverseType","standard/Math/Geometry/Box3","standard/Math/Geometry/ViewVolume"],function(e,t,i,n,r,o,s,a,u,l){"use strict";function c(e){n.call(this,e),r.call(this,e),this.addType(s.StaticGroup),this.group=new o(this.getExecutionContext()),this.collisionShapes=null,this.depthShapes=null,this.opaqueShapes=null,this.transparentShapes=null,this.bbox=new u,this.shadowBBox=new u}return c.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:c,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOutput,"visible",new e.SFBool(!0)),new t(s.inputOutput,"bboxDisplay",new e.SFBool),new t(s.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new t(s.initializeOnly,"bboxCenter",new e.SFVec3f),new t(s.initializeOnly,"children",new e.MFNode)]),getTypeName:function(){return"StaticGroup"},getComponentName:function(){return"Grouping"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),r.prototype.initialize.call(this),this.bboxSize_.addFieldInterest(this.group.bboxSize_),this.bboxCenter_.addFieldInterest(this.group.bboxCenter_),this.children_.addFieldInterest(this.group.children_),this.group.bboxSize_=this.bboxSize_,this.group.bboxCenter_=this.bboxCenter_,this.group.children_=this.children_,this.group.setPrivate(!0),this.group.setup(),this.group.isCameraObject_.addFieldInterest(this.isCameraObject_),this.group.isPickableObject_.addFieldInterest(this.isPickableObject_),this.group.children_.addInterest("set_children__",this),this.setCameraObject(this.group.getCameraObject()),this.setPickableObject(this.group.getPickableObject()),this.set_children__()},getBBox:function(e,t){return e.assign(t?this.shadowBBox:this.bbox)},set_children__:function(){this.group.getBBox(this.bbox),this.group.getBBox(this.shadowBBox,!0),this.collisionShapes=null,this.depthShapes=null,this.opaqueShapes=null,this.transparentShapes=null},traverse:function(){const e=new l;return e.intersectsSphere=function(){return!0},function(t,i){switch(t){case a.CAMERA:return;case a.POINTER:case a.COLLISION:{if(!this.collisionShapes){const n=i.getViewVolumes(),r=i.getViewport(),o=i.getProjectionMatrix(),s=i.getModelViewMatrix(),a=i.getNumCollisionShapes();n.push(e.set(o,r,r)),s.push(),s.identity(),this.group.traverse(t,i),s.pop(),n.pop();const u=i.getNumCollisionShapes();this.collisionShapes=i.getCollisionShapes().splice(a,u-a),i.setNumCollisionShapes(a)}const n=i.getModelViewMatrix();for(const e of this.collisionShapes)n.push(),n.multLeft(e.modelViewMatrix),e.shapeNode.traverse(t,i),n.pop();return}case a.SHADOW:{if(!this.depthShapes){const n=i.getViewVolumes(),r=i.getViewport(),o=i.getProjectionMatrix(),s=i.getModelViewMatrix(),a=i.getNumDepthShapes();n.push(e.set(o,r,r)),s.push(),s.identity(),this.group.traverse(t,i),s.pop(),n.pop();const u=i.getNumDepthShapes();this.depthShapes=i.getDepthShapes().splice(a,u-a),i.setNumDepthShapes(a)}const n=i.getModelViewMatrix();for(const e of this.depthShapes)n.push(),n.multLeft(e.modelViewMatrix),e.shapeNode.traverse(t,i),n.pop();return}case a.DISPLAY:{if(!this.opaqueShapes){const n=i.getViewVolumes(),r=i.getViewport(),o=i.getProjectionMatrix(),s=i.getModelViewMatrix(),a=i.getNumOpaqueShapes(),u=i.getNumTransparentShapes();n.push(e.set(o,r,r)),s.push(),s.identity(),this.group.traverse(t,i),s.pop(),n.pop();const l=i.getNumOpaqueShapes(),c=i.getNumTransparentShapes();this.opaqueShapes=i.getOpaqueShapes().splice(a,l-a),this.transparentShapes=i.getTransparentShapes().splice(u,c-u),i.setNumOpaqueShapes(a),i.setNumTransparentShapes(u)}const n=i.getModelViewMatrix();for(const e of this.opaqueShapes)n.push(),n.multLeft(e.modelViewMatrix),e.shapeNode.traverse(t,i),n.pop();for(const e of this.transparentShapes)n.push(),n.multLeft(e.modelViewMatrix),e.shapeNode.traverse(t,i),n.pop();return}}}}()}),c}),define("x_ite/Components/Grouping/Switch",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Rendering/TraverseType","x_ite/Base/X3DCast","x_ite/Base/X3DConstants"],function(e,t,i,n,r,o,s){"use strict";function a(e){n.call(this,e),this.addType(s.Switch),"2.0"===e.getSpecificationVersion()&&this.addAlias("choice",this.children_),this.childNode=null,this.visibleNode=null,this.boundedObject=null}return a.prototype=Object.assign(Object.create(n.prototype),{constructor:a,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOutput,"whichChoice",new e.SFInt32(-1)),new t(s.inputOutput,"visible",new e.SFBool(!0)),new t(s.inputOutput,"bboxDisplay",new e.SFBool),new t(s.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new t(s.initializeOnly,"bboxCenter",new e.SFVec3f),new t(s.inputOnly,"addChildren",new e.MFNode),new t(s.inputOnly,"removeChildren",new e.MFNode),new t(s.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"Switch"},getComponentName:function(){return"Grouping"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.whichChoice_.addInterest("set_child__",this),this.children_.addInterest("set_child__",this),this.set_child__()},getSubBBox:function(e,t){if(this.bboxSize_.getValue().equals(this.getDefaultBBoxSize())){const i=o(s.X3DBoundedObject,this.visibleNode);return i?i.getBBox(e,t):e.set()}return e.set(this.bboxSize_.getValue(),this.bboxCenter_.getValue())},clear:function(){},add:function(){},remove:function(){},set_child__:function(){this.childNode&&(this.childNode.isCameraObject_.removeInterest("set_cameraObject__",this),this.childNode.isPickableObject_.removeInterest("set_transformSensors__",this)),o(s.X3DBoundedObject,this.childNode)&&(this.childNode.visible_.removeInterest("set_visible__",this),this.childNode.bboxDisplay_.removeInterest("set_bboxDisplay__",this));const e=this.whichChoice_.getValue();e>=0&&e<this.children_.length?(this.childNode=o(s.X3DChildNode,this.children_[e]),this.childNode&&(this.childNode.isCameraObject_.addInterest("set_cameraObject__",this),this.childNode.isPickableObject_.addInterest("set_transformSensors__",this),o(s.X3DBoundedObject,this.childNode)&&(this.childNode.visible_.addInterest("set_visible__",this),this.childNode.bboxDisplay_.addInterest("set_bboxDisplay__",this)),delete this.traverse)):(this.childNode=null,this.traverse=Function.prototype),this.set_transformSensors__(),this.set_visible__(),this.set_bboxDisplay__()},set_cameraObject__:function(){this.childNode&&this.childNode.getCameraObject()?o(s.X3DBoundedObject,this.childNode)?this.setCameraObject(this.childNode.visible_.getValue()):this.setCameraObject(!0):this.setCameraObject(!1)},set_transformSensors__:function(){this.setPickableObject(Boolean(this.getTransformSensors().size||this.childNode&&this.childNode.getPickableObject()))},set_visible__:function(){o(s.X3DBoundedObject,this.childNode)?this.visibleNode=this.childNode.visible_.getValue()?this.childNode:null:this.visibleNode=this.childNode,this.set_cameraObject__()},set_bboxDisplay__:function(){o(s.X3DBoundedObject,this.childNode)?this.boundedObject=this.childNode.bboxDisplay_.getValue()?this.childNode:null:this.boundedObject=null},traverse:function(e,t){switch(e){case r.POINTER:case r.CAMERA:case r.SHADOW:{const i=this.visibleNode;return void(i&&i.traverse(e,t))}case r.PICKING:{if(this.getTransformSensors().size){const e=t.getModelViewMatrix().get();for(const t of this.getTransformSensors())t.collect(e)}const i=this.childNode;if(i){const n=t.getBrowser(),r=n.getPickingHierarchy();r.push(this),i.traverse(e,t),r.pop()}return}case r.COLLISION:{const i=this.childNode;return void(i&&i.traverse(e,t))}case r.DISPLAY:{const i=this.visibleNode;i&&i.traverse(e,t);const n=this.boundedObject;return void(n&&n.displayBBox(e,t))}}}}),a}),define("x_ite/Components/Grouping/X3DTransformMatrix3DNode",["x_ite/Components/Grouping/X3DGroupingNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4"],function(e,t,i,n,r){"use strict";function o(i){e.call(this,i),this.addType(t.X3DTransformMatrix3DNode),this.matrix=new r,this.getBBox=this.getGetGroupBBox(),this.traverse=this.getGroupTraverse()}return o.prototype=Object.assign(Object.create(e.prototype),{constructor:o,setMatrix:function(e){e.equals(r.Identity)?(this.matrix.identity(),this.getBBox=this.getGetGroupBBox(),this.traverse=this.getGroupTraverse()):(this.matrix.assign(e),this.getBBox=this.getGetBBox(),this.traverse=this.getTraverse())},getMatrix:function(){return this.matrix},setTransform:function(e,t,r,o,s){e.equals(i.Zero)&&t.equals(n.Identity)&&r.equals(i.One)?(this.matrix.identity(),this.getBBox=this.getGetGroupBBox(),this.traverse=this.getGroupTraverse()):(this.matrix.set(e,t,r,o,s),this.getBBox=this.getGetBBox(),this.traverse=this.getTraverse())},getGetBBox:function(){function e(e,t){return this.getSubBBox(e,t).multRight(this.matrix)}return function(){return e}}(),getGetGroupBBox:function(){return e.prototype.getBBox},getTraverse:function(){function t(t,i){const n=i.getModelViewMatrix();n.push(),n.multLeft(this.matrix),e.prototype.traverse.call(this,t,i),n.pop()}return function(){return t}}(),getGroupTraverse:function(){return e.prototype.traverse}}),o}),define("x_ite/Components/Grouping/X3DTransformNode",["x_ite/Components/Grouping/X3DTransformMatrix3DNode","x_ite/Base/X3DConstants"],function(e,t){"use strict";function i(i){e.call(this,i),this.addType(t.X3DTransformNode),this.translation_.setUnit("length"),this.center_.setUnit("length")}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i,initialize:function(){e.prototype.initialize.call(this),this.addInterest("eventsProcessed",this),this.eventsProcessed()},eventsProcessed:function(){this.setHidden(0===this.scale_.x||0===this.scale_.y||0===this.scale_.z),this.setTransform(this.translation_.getValue(),this.rotation_.getValue(),this.scale_.getValue(),this.scaleOrientation_.getValue(),this.center_.getValue())}}),i}),define("x_ite/Components/Grouping/Transform",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Grouping/X3DTransformNode","x_ite/Base/X3DConstants"],function(e,t,i,n,r){"use strict";function o(e){n.call(this,e),this.addType(r.Transform)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,
[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"translation",new e.SFVec3f),new t(r.inputOutput,"rotation",new e.SFRotation),new t(r.inputOutput,"scale",new e.SFVec3f(1,1,1)),new t(r.inputOutput,"scaleOrientation",new e.SFRotation),new t(r.inputOutput,"center",new e.SFVec3f),new t(r.inputOutput,"visible",new e.SFBool(!0)),new t(r.inputOutput,"bboxDisplay",new e.SFBool),new t(r.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new t(r.initializeOnly,"bboxCenter",new e.SFVec3f),new t(r.inputOnly,"addChildren",new e.MFNode),new t(r.inputOnly,"removeChildren",new e.MFNode),new t(r.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"Transform"},getComponentName:function(){return"Grouping"},getContainerField:function(){return"children"}}),o}),define("x_ite/Components/Grouping",["x_ite/Configuration/SupportedNodes","x_ite/Components/Grouping/Group","x_ite/Components/Grouping/StaticGroup","x_ite/Components/Grouping/Switch","x_ite/Components/Grouping/Transform","x_ite/Components/Grouping/X3DBoundedObject","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Components/Grouping/X3DTransformMatrix3DNode","x_ite/Components/Grouping/X3DTransformNode"],function(e,t,i,n,r,o,s,a,u){"use strict";const l={Group:t,StaticGroup:i,Switch:n,Transform:r},c={X3DBoundedObject:o,X3DGroupingNode:s,X3DTransformMatrix3DNode:a,X3DTransformNode:u};for(const t in l)e.addType(t,l[t]);for(const t in c)e.addAbstractType(t,c[t])}),define("x_ite/Components/Interpolation/ColorInterpolator",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Color3"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),this.addType(r.ColorInterpolator),this.hsv=[]}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_fraction",new e.SFFloat),new t(r.inputOutput,"key",new e.MFFloat),new t(r.inputOutput,"keyValue",new e.MFColor),new t(r.outputOnly,"value_changed",new e.SFColor)]),getTypeName:function(){return"ColorInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.keyValue_.addInterest("set_keyValue__",this)},set_keyValue__:function(){var t=this.keyValue_;t.length<this.key_.length&&this.keyValue_.resize(this.key_.length,t.length?t[this.keyValue_.length-1]:new e.SFColor),this.hsv.length=0;for(var i=0,n=t.length;i<n;++i)this.hsv.push(t[i].getHSV([]))},interpolate:function(){var e=[];return function(t,i,n){o.lerp(this.hsv[t],this.hsv[i],n,e),this.value_changed_.setHSV(e[0],e[1],e[2])}}()}),s}),define("x_ite/Components/Interpolation/CoordinateInterpolator",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Base/X3DConstants","standard/Math/Algorithm"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),this.addType(r.CoordinateInterpolator)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_fraction",new e.SFFloat),new t(r.inputOutput,"key",new e.MFFloat),new t(r.inputOutput,"keyValue",new e.MFVec3f),new t(r.outputOnly,"value_changed",new e.MFVec3f)]),getTypeName:function(){return"CoordinateInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},set_keyValue__:function(){},interpolate:function(e,t,i){var n=this.keyValue_.getValue(),r=this.key_.length?Math.floor(this.keyValue_.length/this.key_.length):0;this.value_changed_.length=r;var s=this.value_changed_.getValue();e*=r,t=e+(this.key_.length>1?r:0),e*=3,t*=3,r*=3;for(var a=0;a<r;a+=3){var u=a+1,l=a+2;s[a]=o.lerp(n[e+a],n[t+a],i),s[u]=o.lerp(n[e+u],n[t+u],i),s[l]=o.lerp(n[e+l],n[t+l],i)}this.value_changed_.addEvent()}}),s}),define("x_ite/Components/Interpolation/CoordinateInterpolator2D",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Base/X3DConstants","standard/Math/Algorithm"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),this.addType(r.CoordinateInterpolator2D)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_fraction",new e.SFFloat),new t(r.inputOutput,"key",new e.MFFloat),new t(r.inputOutput,"keyValue",new e.MFVec2f),new t(r.outputOnly,"value_changed",new e.MFVec2f)]),getTypeName:function(){return"CoordinateInterpolator2D"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},set_keyValue__:function(){},interpolate:function(e,t,i){var n=this.keyValue_.getValue(),r=this.key_.length?Math.floor(this.keyValue_.length/this.key_.length):0;this.value_changed_.length=r;var s=this.value_changed_.getValue();e*=r,t=e+(this.key_.length>1?r:0),e*=2,t*=2,r*=2;for(var a=0;a<r;a+=2){var u=a+1;s[a]=o.lerp(n[e+a],n[t+a],i),s[u]=o.lerp(n[e+u],n[t+u],i)}this.value_changed_.addEvent()}}),s}),define("x_ite/Components/Interpolation/NormalInterpolator",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Algorithm"],function(e,t,i,n,r,o,s){"use strict";function a(e){n.call(this,e),this.addType(r.NormalInterpolator)}var u=new o(0,0,0),l=new o(0,0,0);return a.prototype=Object.assign(Object.create(n.prototype),{constructor:a,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_fraction",new e.SFFloat),new t(r.inputOutput,"key",new e.MFFloat),new t(r.inputOutput,"keyValue",new e.MFVec3f),new t(r.outputOnly,"value_changed",new e.MFVec3f)]),getTypeName:function(){return"NormalInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.keyValue_.addInterest("set_keyValue__",this)},set_keyValue__:function(){},interpolate:function(e,t,i){var n=this.keyValue_.getValue(),r=this.key_.length>1?Math.floor(this.keyValue_.length/this.key_.length):0;this.value_changed_.length=r;var o=this.value_changed_.getValue();e*=r,t=e+r,e*=3,t*=3,r*=3;for(var a=0;a<r;a+=3)try{var c=a+1,h=a+2;u.set(n[e+a],n[e+c],n[e+h]),l.set(n[t+a],n[t+c],n[t+h]);var d=s.simpleSlerp(u,l,i);o[a]=d[0],o[c]=d[1],o[h]=d[2]}catch(e){}this.value_changed_.addEvent()}}),a}),define("x_ite/Components/Interpolation/PositionInterpolator2D",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector2"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),this.addType(r.PositionInterpolator2D)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_fraction",new e.SFFloat),new t(r.inputOutput,"key",new e.MFFloat),new t(r.inputOutput,"keyValue",new e.MFVec2f),new t(r.outputOnly,"value_changed",new e.SFVec2f)]),getTypeName:function(){return"PositionInterpolator2D"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.keyValue_.addInterest("set_keyValue__",this)},set_keyValue__:function(){var t=this.key_,i=this.keyValue_;i.length<t.length&&i.resize(t.length,i.length?i[i.length-1]:new e.SFVec2f)},interpolate:function(){var e=new o(0,0);return function(t,i,n){this.value_changed_=e.assign(this.keyValue_[t].getValue()).lerp(this.keyValue_[i].getValue(),n)}}()}),s}),define("x_ite/Browser/Interpolation/CatmullRomSplineInterpolator",["standard/Math/Numbers/Vector4","standard/Math/Numbers/Matrix4"],function(e,t){"use strict";function i(){this.T0=[],this.T1=[]}const n=[],r=[],o=[],s=new e(0,0,0,0),a=new t(2,-2,1,1,-3,3,-2,-1,0,0,1,0,1,0,0,0);return i.prototype={constructor:i,generate:function(e,t,i,s,a){const u=this.T0,l=this.T1;if(u.length=0,l.length=0,n.length=0,r.length=0,o.length=0,t.length>1){if(0===s.length){e?n.push(this.divide(this.subtract(i[1],i[i.length-2]),2)):n.push(this.create());for(let e=1,t=i.length-1;e<t;++e)n.push(this.divide(this.subtract(i[e+1],i[e-1]),2));n.push(this.copy(n[0]))}else{for(let e=0,t=s.length;e<t;++e)n.push(this.copy(s[e]));if(a){let e=0;for(let t=0,n=i.length-1;t<n;++t)e+=this.abs(this.subtract(i[t],i[t+1]));for(let t=0,i=n.length-1;t<i;++t){const i=this.abs(n[t]);i&&(n[t]=this.multiply(n[t],e/i))}}}if(e){const e=t.length-1,i=t.length-2,n=t[1]-t[0]+t[e]-t[i];o.push(2*(t[1]-t[0])/n),r.push(2*(t[e]-t[i])/n)}else o.push(1),r.push(1);for(let e=1,i=t.length-1;e<i;++e){const i=t[e+1]-t[e-1];o.push(2*(t[e+1]-t[e])/i),r.push(2*(t[e]-t[e-1])/i)}o.push(o[0]),r.push(r[0]);for(let e=0,t=n.length;e<t;++e)u.push(this.multiply(n[e],r[e])),l.push(this.multiply(n[e],o[e]))}else u.push(this.create()),l.push(this.create())},interpolate:function(e,t,i,n){return s.set(Math.pow(i,3),Math.pow(i,2),i,1),this.dot(a.multVecMatrix(s),n[e],n[t],this.T0[e],this.T1[t])}},i}),define("x_ite/Browser/Interpolation/CatmullRomSplineInterpolatorTemplate",["x_ite/Browser/Interpolation/CatmullRomSplineInterpolator"],function(e){"use strict";return function(t){function i(){this.T0=[],this.T1=[]}const n=new t(0,0,0,0),r=new t(0,0,0,0),o=new t(0,0,0,0),s=new t(0,0,0,0);return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i,create:function(){return new t(0,0,0,0)},copy:function(e){return e.copy()},subtract:function(e,i){return t.subtract(e,i)},multiply:function(e,i){return t.multiply(e,i)},divide:function(e,i){return t.divide(e,i)},abs:function(e){return e.abs()},dot:function(e,t,i,a,u){return n.assign(t).multiply(e[0]),r.assign(i).multiply(e[1]),o.assign(a).multiply(e[2]),s.assign(u).multiply(e[3]),n.add(r).add(o).add(s)}}),i}}),define("x_ite/Browser/Interpolation/CatmullRomSplineInterpolator3",["x_ite/Browser/Interpolation/CatmullRomSplineInterpolatorTemplate","standard/Math/Numbers/Vector3"],function(e,t){"use strict";return e(t)}),define("x_ite/Components/Interpolation/SplinePositionInterpolator",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Browser/Interpolation/CatmullRomSplineInterpolator3","x_ite/Base/X3DConstants"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),this.addType(o.SplinePositionInterpolator),this.spline=new r}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOnly,"set_fraction",new e.SFFloat),new t(o.inputOutput,"closed",new e.SFBool),new t(o.inputOutput,"key",new e.MFFloat),new t(o.inputOutput,"keyValue",new e.MFVec3f),new t(o.inputOutput,"keyVelocity",new e.MFVec3f),new t(o.inputOutput,"normalizeVelocity",new e.SFBool),new t(o.outputOnly,"value_changed",new e.SFVec3f)]),getTypeName:function(){return"SplinePositionInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.keyValue_.addInterest("set_keyValue__",this),this.keyVelocity_.addInterest("set_keyVelocity__",this),this.normalizeVelocity_.addInterest("set_normalizeVelocity__",this)},set_keyValue__:function(){var t=this.key_,i=this.keyValue_;i.length<t.length&&i.resize(t.length,i.length?i[i.length-1]:new e.SFVec3f),this.set_keyVelocity__()},set_keyVelocity__:function(){this.keyVelocity_.length&&this.keyVelocity_.length<this.key_.length&&this.keyVelocity_.resize(this.key_.length,new e.SFVec3f),this.set_normalizeVelocity__()},set_normalizeVelocity__:function(){this.spline.generate(this.closed_.getValue(),this.key_,this.keyValue_,this.keyVelocity_,this.normalizeVelocity_.getValue())},interpolate:function(e,t,i){this.value_changed_=this.spline.interpolate(e,t,i,this.keyValue_)}}),s}),define("x_ite/Browser/Interpolation/CatmullRomSplineInterpolator2",["x_ite/Browser/Interpolation/CatmullRomSplineInterpolatorTemplate","standard/Math/Numbers/Vector2"],function(e,t){"use strict";return e(t)}),define("x_ite/Components/Interpolation/SplinePositionInterpolator2D",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Browser/Interpolation/CatmullRomSplineInterpolator2","x_ite/Base/X3DConstants"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),this.addType(o.SplinePositionInterpolator2D),this.spline=new r}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOnly,"set_fraction",new e.SFFloat),new t(o.inputOutput,"closed",new e.SFBool),new t(o.inputOutput,"key",new e.MFFloat),new t(o.inputOutput,"keyValue",new e.MFVec2f),new t(o.inputOutput,"keyVelocity",new e.MFVec2f),new t(o.inputOutput,"normalizeVelocity",new e.SFBool),new t(o.outputOnly,"value_changed",new e.SFVec2f)]),getTypeName:function(){return"SplinePositionInterpolator2D"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.keyValue_.addInterest("set_keyValue__",this),this.keyVelocity_.addInterest("set_keyVelocity__",this),this.normalizeVelocity_.addInterest("set_normalizeVelocity__",this)},set_keyValue__:function(){var t=this.key_,i=this.keyValue_;i.length<t.length&&i.resize(t.length,i.length?i[i.length-1]:new e.SFVec2f),this.set_keyVelocity__()},set_keyVelocity__:function(){this.keyVelocity_.length&&this.keyVelocity_.length<this.key_.length&&this.keyVelocity_.resize(this.key_.length,new e.SFVec2f),this.set_normalizeVelocity__()},set_normalizeVelocity__:function(){this.spline.generate(this.closed_.getValue(),this.key_,this.keyValue_,this.keyVelocity_,this.normalizeVelocity_.getValue())},interpolate:function(e,t,i){this.value_changed_=this.spline.interpolate(e,t,i,this.keyValue_)}}),s}),define("x_ite/Browser/Interpolation/CatmullRomSplineInterpolator1",["x_ite/Browser/Interpolation/CatmullRomSplineInterpolator"],function(e){"use strict";function t(){this.T0=[],this.T1=[]}return t.prototype=Object.assign(Object.create(e.prototype),{constructor:t,create:function(){return 0},copy:function(e){return e},subtract:function(e,t){return e-t},multiply:function(e,t){return e*t},divide:function(e,t){return e/t},abs:function(e){return Math.abs(e)},dot:function(e,t,i,n,r){return t*e[0]+i*e[1]+n*e[2]+r*e[3]}}),t}),define("x_ite/Components/Interpolation/SplineScalarInterpolator",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Browser/Interpolation/CatmullRomSplineInterpolator1","x_ite/Base/X3DConstants"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),this.addType(o.SplineScalarInterpolator),this.spline=new r}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOnly,"set_fraction",new e.SFFloat),new t(o.inputOutput,"closed",new e.SFBool),new t(o.inputOutput,"key",new e.MFFloat),new t(o.inputOutput,"keyValue",new e.MFFloat),new t(o.inputOutput,"keyVelocity",new e.MFFloat),new t(o.inputOutput,"normalizeVelocity",new e.SFBool),new t(o.outputOnly,"value_changed",new e.SFFloat)]),getTypeName:function(){return"SplineScalarInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.keyValue_.addInterest("set_keyValue__",this),this.keyVelocity_.addInterest("set_keyVelocity__",this),this.normalizeVelocity_.addInterest("set_normalizeVelocity__",this)},set_keyValue__:function(){var t=this.key_,i=this.keyValue_;i.length<t.length&&i.resize(t.length,i.length?i[i.length-1]:new e.SFFloat),this.set_keyVelocity__()},set_keyVelocity__:function(){this.keyVelocity_.length&&this.keyVelocity_.length<this.key_.length&&this.keyVelocity_.resize(this.key_.length,new e.SFFloat),this.set_normalizeVelocity__()},set_normalizeVelocity__:function(){this.spline.generate(this.closed_.getValue(),this.key_,this.keyValue_,this.keyVelocity_,this.normalizeVelocity_.getValue())},interpolate:function(e,t,i){this.value_changed_=this.spline.interpolate(e,t,i,this.keyValue_)}}),s}),define("x_ite/Browser/Interpolation/SquatInterpolator",["standard/Math/Numbers/Rotation4"],function(e){"use strict";function t(){this.s=[]}const i=new e(0,0,1,0);return t.prototype={constructor:t,generate:function(t,i,n){const r=this.s;if(r.length=0,i.length>1){t?r.push(e.spline(n[i.length-2].getValue(),n[0].getValue(),n[1].getValue())):r.push(n[0].getValue());for(let t=1,o=i.length-1;t<o;++t)r.push(e.spline(n[t-1].getValue(),n[t].getValue(),n[t+1].getValue()));t?r.push(e.spline(n[i.length-2].getValue(),n[i.length-1].getValue(),n[1].getValue())):r.push(n[i.length-1].getValue())}else i.length>0&&r.push(n[0].getValue().copy())},interpolate:function(e,t,n,r){return i.assign(r[e].getValue()).squad(this.s[e],this.s[t],r[t].getValue(),n)}},t}),define("x_ite/Components/Interpolation/SquadOrientationInterpolator",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Interpolation/X3DInterpolatorNode","x_ite/Browser/Interpolation/SquatInterpolator","x_ite/Base/X3DConstants"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),this.addType(o.SquadOrientationInterpolator),this.keyValue_.setUnit("angle"),this.value_changed_.setUnit("angle"),this.squad=new r}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOnly,"set_fraction",new e.SFFloat),new t(o.inputOutput,"closed",new e.SFBool),new t(o.inputOutput,"key",new e.MFFloat),new t(o.inputOutput,"keyValue",new e.MFRotation),new t(o.outputOnly,"value_changed",new e.SFRotation)]),getTypeName:function(){return"SquadOrientationInterpolator"},getComponentName:function(){return"Interpolation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.keyValue_.addInterest("set_keyValue__",this)},set_keyValue__:function(){var t=this.key_,i=this.keyValue_;i.length<t.length&&i.resize(t.length,i.length?i[i.length-1]:new e.SFRotation),this.squad.generate(this.closed_.getValue(),this.key_,this.keyValue_)},interpolate:function(e,t,i){try{this.value_changed_=this.squad.interpolate(e,t,i,this.keyValue_)}catch(e){console.log(e)}}}),s}),define("x_ite/Components/Interpolation",["x_ite/Configuration/SupportedNodes","x_ite/Components/Interpolation/ColorInterpolator","x_ite/Components/Interpolation/CoordinateInterpolator","x_ite/Components/Interpolation/CoordinateInterpolator2D","x_ite/Components/Interpolation/EaseInEaseOut","x_ite/Components/Interpolation/NormalInterpolator","x_ite/Components/Interpolation/OrientationInterpolator","x_ite/Components/Interpolation/PositionInterpolator","x_ite/Components/Interpolation/PositionInterpolator2D","x_ite/Components/Interpolation/ScalarInterpolator","x_ite/Components/Interpolation/SplinePositionInterpolator","x_ite/Components/Interpolation/SplinePositionInterpolator2D","x_ite/Components/Interpolation/SplineScalarInterpolator","x_ite/Components/Interpolation/SquadOrientationInterpolator","x_ite/Components/Interpolation/X3DInterpolatorNode"],function(e,t,i,n,r,o,s,a,u,l,c,h,d,p,f){"use strict";const g={ColorInterpolator:t,CoordinateInterpolator:i,CoordinateInterpolator2D:n,EaseInEaseOut:r,NormalInterpolator:o,OrientationInterpolator:s,PositionInterpolator:a,PositionInterpolator2D:u,ScalarInterpolator:l,SplinePositionInterpolator:c,SplinePositionInterpolator2D:h,SplineScalarInterpolator:d,SquadOrientationInterpolator:p},m={X3DInterpolatorNode:f};for(const t in g)e.addType(t,g[t]);for(const t in m)e.addAbstractType(t,m[t])}),define("x_ite/Components/Layering",["x_ite/Configuration/SupportedNodes","x_ite/Components/Layering/Layer","x_ite/Components/Layering/LayerSet","x_ite/Components/Layering/Viewport","x_ite/Components/Layering/X3DLayerNode","x_ite/Components/Layering/X3DViewportNode"],function(e,t,i,n,r,o){"use strict";const s={Layer:t,LayerSet:i,Viewport:n},a={X3DLayerNode:r,X3DViewportNode:o};for(const t in s)e.addType(t,s[t]);for(const t in a)e.addAbstractType(t,a[t])}),define("x_ite/Components/Lighting/PointLight",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Lighting/X3DLightNode","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Rendering/TraverseType","x_ite/Base/X3DConstants","standard/Math/Geometry/Camera","standard/Math/Geometry/ViewVolume","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix3","standard/Math/Numbers/Matrix4","standard/Math/Utility/MatrixStack","standard/Math/Algorithm","standard/Utility/ObjectCache"],function(e,t,i,n,r,o,s,a,u,l,c,h,d,p,f,g,m){"use strict";function y(){this.location=new l(0,0,0),this.matrixArray=new Float32Array(9),this.shadowBuffer=null,this.viewVolume=new u,this.viewport=new c(0,0,0,0),this.projectionMatrix=new p,this.modelViewMatrix=new f(p),this.modelMatrix=new p,this.invLightSpaceMatrix=new p,this.invLightSpaceProjectionMatrix=new p,this.shadowMatrix=new p,this.shadowMatrixArray=new Float32Array(16),this.rotation=new h,this.rotationMatrix=new p,this.textureUnit=0}function _(e){n.call(this,e),this.addType(s.PointLight),this.location_.setUnit("length"),this.radius_.setUnit("length")}var x=[(new p).setRotation(new h(new l(1,0,0),l.zAxis)),(new p).setRotation(new h(new l(-1,0,0),l.zAxis)),(new p).setRotation(new h(new l(0,0,-1),l.zAxis)),(new p).setRotation(new h(new l(0,0,1),l.zAxis)),(new p).setRotation(new h(new l(0,1,0),l.zAxis)),(new p).setRotation(new h(new l(0,-1,0),l.zAxis))],w=[new c(0,.5,.25,.5),new c(.5,.5,.25,.5),new c(.75,.5,.25,.5),new c(.25,.5,.25,.5),new c(0,0,.5,.5),new c(.5,0,.5,.5)],b=m(y);return y.prototype={constructor:y,getModelViewMatrix:function(){return this.modelViewMatrix},set:function(e,t,i,n){var r=e.getContext(),o=t.getShadowMapSize();this.browser=e,this.lightNode=t,this.groupNode=i;try{this.matrixArray.set(n.submatrix.inverse())}catch(e){this.matrixArray.set(d.Identity)}this.modelViewMatrix.pushMatrix(n),t.getShadowIntensity()>0&&o>0&&(this.shadowBuffer=e.popShadowBuffer(o),this.shadowBuffer?e.getCombinedTextureUnits().length?(this.textureUnit=e.getCombinedTextureUnits().pop(),r.activeTexture(r.TEXTURE0+this.textureUnit),r.getVersion()>=2||e.getExtension("WEBGL_depth_texture")?r.bindTexture(r.TEXTURE_2D,this.shadowBuffer.getDepthTexture()):r.bindTexture(r.TEXTURE_2D,this.shadowBuffer.getColorTexture()),r.activeTexture(r.TEXTURE0)):console.warn("Not enough combined texture units for shadow map available."):console.warn("Couldn't create shadow buffer."))},renderShadowMap:function(e){try{if(!this.shadowBuffer)return;var t=this.lightNode,i=e.getCameraSpaceMatrix().get(),n=this.modelMatrix.assign(this.modelViewMatrix.get()).multRight(i),s=this.invLightSpaceMatrix.assign(t.getGlobal()?n:p.Identity);s.translate(t.getLocation()),s.inverse();var u=t.getShadowMapSize();this.shadowBuffer.bind();for(var l=0;l<6;++l){var c=w[l],h=this.viewport.set(c[0]*u,c[1]*u,c[2]*u,c[3]*u),d=a.perspective2(g.radians(90),.125,1e4,h[2],h[3],this.projectionMatrix);e.getViewVolumes().push(this.viewVolume.set(d,h,h)),e.getProjectionMatrix().pushMatrix(this.projectionMatrix),e.getModelViewMatrix().pushMatrix(x[l]),e.getModelViewMatrix().multLeft(s),e.render(o.SHADOW,r.prototype.traverse,this.groupNode),e.getModelViewMatrix().pop(),e.getProjectionMatrix().pop(),e.getViewVolumes().pop()}this.shadowBuffer.unbind(),t.getGlobal()||s.multLeft(n.inverse()),this.invLightSpaceProjectionMatrix.assign(s)}catch(e){console.log(e)}},setGlobalVariables:function(e){this.modelViewMatrix.get().multVecMatrix(this.location.assign(this.lightNode.location_.getValue())),this.shadowMatrix.assign(e.getCameraSpaceMatrix().get()).multRight(this.invLightSpaceProjectionMatrix),this.shadowMatrixArray.set(this.shadowMatrix)},setShaderUniforms:function(e,t){var i=t.numLights++;if(!t.hasLight(i,this)){var n=this.lightNode,r=n.getColor(),o=n.getAttenuation(),s=this.location;if(e.uniform1i(t.x3d_LightType[i],2),e.uniform3f(t.x3d_LightColor[i],r.r,r.g,r.b),e.uniform1f(t.x3d_LightIntensity[i],n.getIntensity()),e.uniform1f(t.x3d_LightAmbientIntensity[i],n.getAmbientIntensity()),e.uniform3f(t.x3d_LightAttenuation[i],Math.max(0,o.x),Math.max(0,o.y),Math.max(0,o.z)),e.uniform3f(t.x3d_LightLocation[i],s.x,s.y,s.z),e.uniform1f(t.x3d_LightRadius[i],n.getRadius()),e.uniformMatrix3fv(t.x3d_LightMatrix[i],!1,this.matrixArray),this.textureUnit){var a=n.getShadowColor();e.uniform3f(t.x3d_ShadowColor[i],a.r,a.g,a.b),e.uniform1f(t.x3d_ShadowIntensity[i],n.getShadowIntensity()),e.uniform1f(t.x3d_ShadowBias[i],n.getShadowBias()),e.uniformMatrix4fv(t.x3d_ShadowMatrix[i],!1,this.shadowMatrixArray),e.uniform1i(t.x3d_ShadowMapSize[i],n.getShadowMapSize()),e.uniform1i(t.x3d_ShadowMap[i],this.textureUnit)}else e.uniform1f(t.x3d_ShadowIntensity[i],0)}},dispose:function(){this.textureUnit&&this.browser.getCombinedTextureUnits().push(this.textureUnit),this.browser.pushShadowBuffer(this.shadowBuffer),this.modelViewMatrix.clear(),this.browser=null,this.lightNode=null,this.groupNode=null,this.shadowBuffer=null,this.textureUnit=0,b.push(this)}},_.prototype=Object.assign(Object.create(n.prototype),{constructor:_,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOutput,"global",new e.SFBool(!0)),new t(s.inputOutput,"on",new e.SFBool(!0)),new t(s.inputOutput,"color",new e.SFColor(1,1,1)),new t(s.inputOutput,"intensity",new e.SFFloat(1)),new t(s.inputOutput,"ambientIntensity",new e.SFFloat),new t(s.inputOutput,"attenuation",new e.SFVec3f(1,0,0)),new t(s.inputOutput,"location",new e.SFVec3f),new t(s.inputOutput,"radius",new e.SFFloat(100)),new t(s.inputOutput,"shadows",new e.SFBool),new t(s.inputOutput,"shadowColor",new e.SFColor),new t(s.inputOutput,"shadowIntensity",new e.SFFloat(1)),new t(s.inputOutput,"shadowBias",new e.SFFloat(.005)),new t(s.initializeOnly,"shadowMapSize",new e.SFInt32(1024))]),getTypeName:function(){return"PointLight"},getComponentName:function(){return"Lighting"},getContainerField:function(){return"children"},getAttenuation:function(){return this.attenuation_.getValue()},getLocation:function(){return this.location_.getValue()},getRadius:function(){return Math.max(0,this.radius_.getValue())},getLights:function(){return b}}),_}),define("x_ite/Components/Lighting/SpotLight",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Lighting/X3DLightNode","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Rendering/TraverseType","x_ite/Base/X3DConstants","standard/Math/Geometry/Box3","standard/Math/Geometry/Camera","standard/Math/Geometry/ViewVolume","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix3","standard/Math/Numbers/Matrix4","standard/Math/Utility/MatrixStack","standard/Math/Algorithm","standard/Utility/ObjectCache"],function(e,t,i,n,r,o,s,a,u,l,c,h,d,p,f,g,m,y){"use strict";function _(){this.location=new c(0,0,0),this.direction=new c(0,0,0),this.matrixArray=new Float32Array(9),this.renderShadow=!0,this.shadowBuffer=null,this.bbox=new a,this.viewVolume=new l,this.viewport=new h(0,0,0,0),this.projectionMatrix=new f,this.modelViewMatrix=new g(f),this.modelMatrix=new f,this.invLightSpaceMatrix=new f,this.invLightSpaceProjectionMatrix=new f,this.shadowMatrix=new f,this.shadowMatrixArray=new Float32Array(16),this.rotation=new d,this.lightBBoxMin=new c(0,0,0),this.lightBBoxMax=new c(0,0,0),this.textureUnit=0}function x(e){switch(n.call(this,e),this.addType(s.SpotLight),e.getSpecificationVersion()){case"2.0":case"3.0":case"3.1":case"3.2":this.beamWidth_=1.5708,this.cutOffAngle_=.785398}this.location_.setUnit("length"),this.radius_.setUnit("length"),this.beamWidth_.setUnit("angle"),this.cutOffAngle_.setUnit("angle")}var w=y(_);return _.prototype={constructor:_,getModelViewMatrix:function(){return this.modelViewMatrix},set:function(e,t,i,n){var r=e.getContext(),o=t.getShadowMapSize();this.browser=e,this.lightNode=t,this.groupNode=i;try{this.matrixArray.set(n.submatrix.inverse())}catch(e){this.matrixArray.set(p.Identity)}this.modelViewMatrix.pushMatrix(n),t.getShadowIntensity()>0&&o>0&&(this.shadowBuffer=e.popShadowBuffer(o),this.shadowBuffer?e.getCombinedTextureUnits().length?(this.textureUnit=e.getCombinedTextureUnits().pop(),r.activeTexture(r.TEXTURE0+this.textureUnit),r.getVersion()>=2||e.getExtension("WEBGL_depth_texture")?r.bindTexture(r.TEXTURE_2D,this.shadowBuffer.getDepthTexture()):r.bindTexture(r.TEXTURE_2D,this.shadowBuffer.getColorTexture()),r.activeTexture(r.TEXTURE0)):console.warn("Not enough combined texture units for shadow map available."):console.warn("Couldn't create shadow buffer."))},renderShadowMap:function(e){try{if(!this.shadowBuffer)return;var t=this.lightNode,i=e.getCameraSpaceMatrix().get(),n=this.modelMatrix.assign(this.modelViewMatrix.get()).multRight(i),s=this.invLightSpaceMatrix.assign(t.getGlobal()?n:f.Identity);s.translate(t.getLocation()),s.rotate(this.rotation.setFromToVec(c.zAxis,this.direction.assign(t.getDirection()).negate())),s.inverse();var a=this.groupNode.getSubBBox(this.bbox,!0),l=a.multRight(s),h=(l.getExtents(this.lightBBoxMin,this.lightBBoxMax),t.getShadowMapSize()),d=Math.min(t.getRadius(),-this.lightBBoxMin.z),p=this.viewport.set(0,0,h,h),g=u.perspective(2*t.getCutOffAngle(),.125,Math.max(1e4,d),h,h,this.projectionMatrix);this.renderShadow=d>0,this.shadowBuffer.bind(),e.getViewVolumes().push(this.viewVolume.set(g,p,p)),e.getProjectionMatrix().pushMatrix(g),e.getModelViewMatrix().pushMatrix(s),e.render(o.SHADOW,r.prototype.traverse,this.groupNode),e.getModelViewMatrix().pop(),e.getProjectionMatrix().pop(),e.getViewVolumes().pop(),this.shadowBuffer.unbind(),t.getGlobal()||s.multLeft(n.inverse()),this.invLightSpaceProjectionMatrix.assign(s).multRight(g).multRight(t.getBiasMatrix())}catch(e){console.log(e)}},setGlobalVariables:function(e){var t=this.lightNode,i=this.modelViewMatrix.get();i.multVecMatrix(this.location.assign(t.location_.getValue())),i.multDirMatrix(this.direction.assign(t.direction_.getValue())).normalize(),this.shadowMatrix.assign(e.getCameraSpaceMatrix().get()).multRight(this.invLightSpaceProjectionMatrix),this.shadowMatrixArray.set(this.shadowMatrix)},setShaderUniforms:function(e,t){var i=t.numLights++;if(!t.hasLight(i,this)){var n=this.lightNode,r=n.getColor(),o=n.getAttenuation(),s=this.location,a=this.direction;if(e.uniform1i(t.x3d_LightType[i],3),e.uniform3f(t.x3d_LightColor[i],r.r,r.g,r.b),e.uniform1f(t.x3d_LightIntensity[i],n.getIntensity()),e.uniform1f(t.x3d_LightAmbientIntensity[i],n.getAmbientIntensity()),e.uniform3f(t.x3d_LightAttenuation[i],Math.max(0,o.x),Math.max(0,o.y),Math.max(0,o.z)),e.uniform3f(t.x3d_LightLocation[i],s.x,s.y,s.z),e.uniform3f(t.x3d_LightDirection[i],a.x,a.y,a.z),e.uniform1f(t.x3d_LightRadius[i],n.getRadius()),
e.uniform1f(t.x3d_LightBeamWidth[i],n.getBeamWidth()),e.uniform1f(t.x3d_LightCutOffAngle[i],n.getCutOffAngle()),e.uniformMatrix3fv(t.x3d_LightMatrix[i],!1,this.matrixArray),this.renderShadow&&this.textureUnit){var u=n.getShadowColor();e.uniform3f(t.x3d_ShadowColor[i],u.r,u.g,u.b),e.uniform1f(t.x3d_ShadowIntensity[i],n.getShadowIntensity()),e.uniform1f(t.x3d_ShadowBias[i],n.getShadowBias()),e.uniformMatrix4fv(t.x3d_ShadowMatrix[i],!1,this.shadowMatrixArray),e.uniform1i(t.x3d_ShadowMapSize[i],n.getShadowMapSize()),e.uniform1i(t.x3d_ShadowMap[i],this.textureUnit)}else e.uniform1f(t.x3d_ShadowIntensity[i],0)}},dispose:function(){this.textureUnit&&this.browser.getCombinedTextureUnits().push(this.textureUnit),this.browser.pushShadowBuffer(this.shadowBuffer),this.modelViewMatrix.clear(),this.browser=null,this.lightNode=null,this.groupNode=null,this.shadowBuffer=null,this.textureUnit=0,w.push(this)}},x.prototype=Object.assign(Object.create(n.prototype),{constructor:x,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOutput,"global",new e.SFBool(!0)),new t(s.inputOutput,"on",new e.SFBool(!0)),new t(s.inputOutput,"color",new e.SFColor(1,1,1)),new t(s.inputOutput,"intensity",new e.SFFloat(1)),new t(s.inputOutput,"ambientIntensity",new e.SFFloat),new t(s.inputOutput,"attenuation",new e.SFVec3f(1,0,0)),new t(s.inputOutput,"location",new e.SFVec3f),new t(s.inputOutput,"direction",new e.SFVec3f(0,0,-1)),new t(s.inputOutput,"radius",new e.SFFloat(100)),new t(s.inputOutput,"beamWidth",new e.SFFloat(.785398)),new t(s.inputOutput,"cutOffAngle",new e.SFFloat(1.5708)),new t(s.inputOutput,"shadows",new e.SFBool),new t(s.inputOutput,"shadowColor",new e.SFColor),new t(s.inputOutput,"shadowIntensity",new e.SFFloat(1)),new t(s.inputOutput,"shadowBias",new e.SFFloat(.005)),new t(s.initializeOnly,"shadowMapSize",new e.SFInt32(1024))]),getTypeName:function(){return"SpotLight"},getComponentName:function(){return"Lighting"},getContainerField:function(){return"children"},getAttenuation:function(){return this.attenuation_.getValue()},getLocation:function(){return this.location_.getValue()},getRadius:function(){return Math.max(0,this.radius_.getValue())},getBeamWidth:function(){var e=this.beamWidth_.getValue(),t=this.getCutOffAngle();return e>t?t:m.clamp(e,0,Math.PI/2)},getCutOffAngle:function(){return m.clamp(this.cutOffAngle_.getValue(),0,Math.PI/2)},getLights:function(){return w}}),x}),define("x_ite/Components/Lighting",["x_ite/Configuration/SupportedNodes","x_ite/Components/Lighting/DirectionalLight","x_ite/Components/Lighting/PointLight","x_ite/Components/Lighting/SpotLight","x_ite/Components/Lighting/X3DLightNode"],function(e,t,i,n,r){"use strict";const o={DirectionalLight:t,PointLight:i,SpotLight:n},s={X3DLightNode:r};for(const t in o)e.addType(t,o[t]);for(const t in s)e.addAbstractType(t,s[t])}),define("x_ite/Components/Navigation/Billboard",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Base/X3DConstants","x_ite/Rendering/TraverseType","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4"],function(e,t,i,n,r,o,s,a,u){"use strict";function l(e){n.call(this,e),this.addType(r.Billboard),this.matrix=new u}const c=new u,h=new s(0,1,0),d=new s(0,0,1),p=new s(0,0,0),f=new s(0,0,0),g=new s(0,0,0),m=new s(0,0,0),y=new s(0,0,0),_=new a(0,0,1,0);return l.prototype=Object.assign(Object.create(n.prototype),{constructor:l,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"axisOfRotation",new e.SFVec3f(0,1,0)),new t(r.inputOutput,"visible",new e.SFBool(!0)),new t(r.inputOutput,"bboxDisplay",new e.SFBool),new t(r.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new t(r.initializeOnly,"bboxCenter",new e.SFVec3f),new t(r.inputOnly,"addChildren",new e.MFNode),new t(r.inputOnly,"removeChildren",new e.MFNode),new t(r.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"Billboard"},getComponentName:function(){return"Navigation"},getContainerField:function(){return"children"},getBBox:function(e,t){return n.prototype.getBBox.call(this,e,t).multRight(this.matrix)},getMatrix:function(){return this.matrix},rotate:function(e){c.assign(e).inverse();const t=c.origin.normalize();if(this.axisOfRotation_.getValue().equals(s.Zero)){c.multDirMatrix(p.assign(h)).normalize(),f.assign(p).cross(t),g.assign(t).cross(f);const e=t;f.normalize(),g.normalize(),this.matrix.set(f[0],f[1],f[2],0,g[0],g[1],g[2],0,e[0],e[1],e[2],0,0,0,0,1)}else m.assign(this.axisOfRotation_.getValue()).cross(t),y.assign(this.axisOfRotation_.getValue()).cross(d),this.matrix.setRotation(_.setFromToVec(y,m));return this.matrix},traverse:function(e,t){const i=t.getModelViewMatrix();i.push();try{switch(e){case o.CAMERA:case o.PICKING:case o.SHADOW:i.multLeft(this.matrix);break;default:i.multLeft(this.rotate(i.get()))}n.prototype.traverse.call(this,e,t)}catch(e){console.log(e)}i.pop()}}),l}),define("x_ite/Components/Navigation/Collision",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Components/Core/X3DSensorNode","x_ite/Base/X3DCast","x_ite/Rendering/TraverseType","x_ite/Base/X3DConstants"],function(e,t,i,n,r,o,s,a){"use strict";function u(e){n.call(this,e),r.call(this,e),this.addType(a.Collision),"2.0"===e.getSpecificationVersion()&&this.addAlias("collide",this.enabled_)}return u.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:u,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(a.inputOutput,"metadata",new e.SFNode),new t(a.inputOutput,"enabled",new e.SFBool(!0)),new t(a.outputOnly,"isActive",new e.SFBool),new t(a.outputOnly,"collideTime",new e.SFTime),new t(a.inputOutput,"visible",new e.SFBool(!0)),new t(a.inputOutput,"bboxDisplay",new e.SFBool),new t(a.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new t(a.initializeOnly,"bboxCenter",new e.SFVec3f),new t(a.initializeOnly,"proxy",new e.SFNode),new t(a.inputOnly,"addChildren",new e.MFNode),new t(a.inputOnly,"removeChildren",new e.MFNode),new t(a.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"Collision"},getComponentName:function(){return"Navigation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.isLive().addInterest("set_live__",this),this.enabled_.addInterest("set_live__",this),this.proxy_.addInterest("set_proxy__",this),this.set_live__(),this.set_proxy__()},set_live__:function(){this.isLive().getValue()&&this.enabled_.getValue()?this.getBrowser().addCollision(this):this.getBrowser().removeCollision(this)},set_active:function(e){this.isActive_.getValue()!==e&&(this.isActive_=e,e&&(this.collideTime_=this.getBrowser().getCurrentTime()))},set_proxy__:function(){this.proxyNode=o(a.X3DChildNode,this.proxy_)},traverse:function(e,t){switch(e){case s.COLLISION:if(this.enabled_.getValue()){const i=t.getCollisions();i.push(this),this.proxyNode?this.proxyNode.traverse(e,t):n.prototype.traverse.call(this,e,t),i.pop()}return;default:return void n.prototype.traverse.call(this,e,t)}}}),u}),define("x_ite/Components/Navigation/LOD",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Base/X3DCast","x_ite/Rendering/TraverseType","x_ite/Base/X3DConstants","standard/Math/Numbers/Matrix4","standard/Math/Algorithm"],function(e,t,i,n,r,o,s,a,u){"use strict";function l(e){n.call(this,e),this.addType(s.LOD),"2.0"===e.getSpecificationVersion()&&this.addAlias("level",this.children_),this.center_.setUnit("length"),this.range_.setUnit("length"),this.frameRate=60,this.keepCurrentLevel=!1,this.childNode=null,this.visibleNode=null,this.boundedObject=null}return l.prototype=Object.assign(Object.create(n.prototype),{constructor:l,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.initializeOnly,"forceTransitions",new e.SFBool),new t(s.initializeOnly,"center",new e.SFVec3f),new t(s.initializeOnly,"range",new e.MFFloat),new t(s.outputOnly,"level_changed",new e.SFInt32(-1)),new t(s.inputOutput,"visible",new e.SFBool(!0)),new t(s.inputOutput,"bboxDisplay",new e.SFBool),new t(s.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new t(s.initializeOnly,"bboxCenter",new e.SFVec3f),new t(s.inputOnly,"addChildren",new e.MFNode),new t(s.inputOnly,"removeChildren",new e.MFNode),new t(s.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"LOD"},getComponentName:function(){return"Navigation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.children_.addInterest("set_child__",this)},getSubBBox:function(e,t){if(this.bboxSize_.getValue().equals(this.getDefaultBBoxSize())){const i=r(s.X3DBoundedObject,this.visibleNode);return i?i.getBBox(e,t):e.set()}return e.set(this.bboxSize_.getValue(),this.bboxCenter_.getValue())},clear:function(){},add:function(){},remove:function(){},set_child__:function(){this.set_level__(Math.min(this.level_changed_.getValue(),this.children_.length-1))},set_level__:function(e){this.childNode&&(this.childNode.isCameraObject_.removeInterest("set_cameraObject__",this),this.childNode.isPickableObject_.removeInterest("set_transformSensors__",this)),r(s.X3DBoundedObject,this.childNode)&&(this.childNode.visible_.removeInterest("set_visible__",this),this.childNode.bboxDisplay_.removeInterest("set_bboxDisplay__",this)),e>=0&&e<this.children_.length?(this.childNode=r(s.X3DChildNode,this.children_[e]),this.childNode&&(this.childNode.isCameraObject_.addInterest("set_cameraObject__",this),this.childNode.isPickableObject_.addInterest("set_transformSensors__",this),r(s.X3DBoundedObject,this.childNode)&&(this.childNode.visible_.addInterest("set_visible__",this),this.childNode.bboxDisplay_.addInterest("set_bboxDisplay__",this)))):this.childNode=null,this.set_transformSensors__(),this.set_visible__(),this.set_bboxDisplay__()},set_cameraObject__:function(){this.childNode&&this.childNode.getCameraObject()?r(s.X3DBoundedObject,this.childNode)?this.setCameraObject(this.childNode.visible_.getValue()):this.setCameraObject(!0):this.setCameraObject(!1)},set_transformSensors__:function(){this.setPickableObject(Boolean(this.getTransformSensors().size||this.childNode&&this.childNode.getPickableObject()))},set_visible__:function(){r(s.X3DBoundedObject,this.childNode)?this.visibleNode=this.childNode.visible_.getValue()?this.childNode:null:this.visibleNode=this.childNode,this.set_cameraObject__()},set_bboxDisplay__:function(){r(s.X3DBoundedObject,this.childNode)?this.boundedObject=this.childNode.bboxDisplay_.getValue()?this.childNode:null:this.boundedObject=null},getLevel:function(){return function(e,t){if(0===this.range_.length){this.frameRate=(179*this.frameRate+e.currentFrameRate)/180;const t=this.children_.length;switch(t){case 0:return-1;case 1:return 0;case 2:return+(this.frameRate>55);default:{const e=1-u.clamp((this.frameRate-20)/35,0,1);return Math.min(Math.floor(e*t),t-1)}}}const i=t.translate(this.center_.getValue()).origin.abs();return u.upperBound(this.range_,0,this.range_.length,i,u.less)}}(),traverse:function(){const e=new a;return function(t,i){switch(t){case o.POINTER:case o.CAMERA:case o.SHADOW:{const e=this.visibleNode;return void(e&&e.traverse(t,i))}case o.PICKING:{if(this.getTransformSensors().size){const e=i.getModelViewMatrix().get();for(const t of this.getTransformSensors())t.collect(e)}const e=this.childNode;if(e){const n=i.getBrowser(),r=n.getPickingHierarchy();r.push(this),e.traverse(t,i),r.pop()}return}case o.COLLISION:{const e=this.childNode;return void(e&&e.traverse(t,i))}case o.DISPLAY:{if(!this.keepCurrentLevel){let t=this.getLevel(i.getBrowser(),e.assign(i.getModelViewMatrix().get())),n=this.level_changed_.getValue();this.forceTransitions_.getValue()&&(t>n?t=n+1:t<n&&(t=n-1)),t!==n&&(this.level_changed_=t,this.set_level__(Math.min(t,this.children_.length-1)))}const n=this.visibleNode;n&&n.traverse(t,i);const r=this.boundedObject;return void(r&&r.displayBBox(t,i))}}}}()}),l}),define("x_ite/Components/Navigation/ViewpointGroup",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Core/X3DChildNode","x_ite/Components/EnvironmentalSensor/ProximitySensor","x_ite/Rendering/TraverseType","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,i,n,r,o,s,a){"use strict";function u(e){n.call(this,e),this.addType(s.ViewpointGroup),this.size_.setUnit("length"),this.center_.setUnit("length"),this.proximitySensor=new r(e),this.cameraObjects=[],this.viewpointGroups=[]}function l(e,t){switch(e){case o.CAMERA:if(this.proximitySensor.traverse(e,t),this.proximitySensor.isActive_.getValue())for(var i=0,n=this.cameraObjects.length;i<n;++i)this.cameraObjects[i].traverse(e,t);return;case o.DISPLAY:if(this.proximitySensor.traverse(e,t),this.proximitySensor.isActive_.getValue())for(var i=0,n=this.viewpointGroups.length;i<n;++i)this.viewpointGroups[i].traverse(e,t);return}}function c(e,t){switch(e){case o.CAMERA:for(var i=0,n=this.cameraObjects.length;i<n;++i)this.cameraObjects[i].traverse(e,t);return;case o.DISPLAY:for(var i=0,n=this.viewpointGroups.length;i<n;++i)this.viewpointGroups[i].traverse(e,t);return}}return u.prototype=Object.assign(Object.create(n.prototype),{constructor:u,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOutput,"description",new e.SFString),new t(s.inputOutput,"displayed",new e.SFBool(!0)),new t(s.inputOutput,"retainUserOffsets",new e.SFBool),new t(s.inputOutput,"size",new e.SFVec3f),new t(s.inputOutput,"center",new e.SFVec3f),new t(s.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"ViewpointGroup"},getComponentName:function(){return"Navigation"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.proximitySensor.setup(),this.size_.addFieldInterest(this.proximitySensor.size_),this.center_.addFieldInterest(this.proximitySensor.center_),this.proximitySensor.size_=this.size_,this.proximitySensor.center_=this.center_,this.displayed_.addInterest("set_displayed__",this),this.size_.addInterest("set_displayed__",this),this.children_.addInterest("set_children__",this),this.set_displayed__(),this.set_children__()},isActive:function(){return this.proximitySensor.isActive_.getValue()},set_displayed__:function(){var e=!this.size_.getValue().equals(a.Zero),t=this.displayed_.getValue();this.proximitySensor.enabled_=t&&e,t&&e?(this.proximitySensor.isCameraObject_.addFieldInterest(this.isCameraObject_),this.proximitySensor.isPickableObject_.addFieldInterest(this.isPickableObject_),this.setCameraObject(this.proximitySensor.getCameraObject()),this.setPickableObject(this.proximitySensor.getPickableObject()),this.traverse=l):(this.proximitySensor.isCameraObject_.removeFieldInterest(this.isCameraObject_),this.proximitySensor.isPickableObject_.removeFieldInterest(this.isPickableObject_),this.setCameraObject(t),this.setPickableObject(!1),t?this.traverse=c:delete this.traverse)},set_children__:function(){this.cameraObjects.length=0,this.viewpointGroups.length=0;for(var e=this.children_,t=0,i=e.length;t<i;++t)try{for(var n=e[t].getValue().getInnerNode(),r=n.getType(),o=r.length-1;o>=0;--o)switch(r[o]){case s.X3DViewpointNode:this.cameraObjects.push(n);break;case s.ViewpointGroup:this.cameraObjects.push(n),this.viewpointGroups.push(n)}}catch(e){}},traverse:function(){}}),u}),define("x_ite/Components/Navigation",["x_ite/Configuration/SupportedNodes","x_ite/Components/Navigation/Billboard","x_ite/Components/Navigation/Collision","x_ite/Components/Navigation/LOD","x_ite/Components/Navigation/NavigationInfo","x_ite/Components/Navigation/OrthoViewpoint","x_ite/Components/Navigation/Viewpoint","x_ite/Components/Navigation/ViewpointGroup","x_ite/Components/Navigation/X3DViewpointNode"],function(e,t,i,n,r,o,s,a,u){"use strict";const l={Billboard:t,Collision:i,LOD:n,NavigationInfo:r,OrthoViewpoint:o,Viewpoint:s,ViewpointGroup:a},c={X3DViewpointNode:u};for(const t in l)e.addType(t,l[t]);for(const t in c)e.addAbstractType(t,c[t])}),define("x_ite/Browser/PointingDeviceSensor/PointingDeviceSensorContainer",["standard/Math/Numbers/Vector4","standard/Math/Numbers/Matrix4"],function(e,t){"use strict";function i(i,n,r,o){this.node=null,this.modelViewMatrix=new t,this.projectionMatrix=new t,this.viewport=new e(0,0,0,0),this.set(i,n,r,o)}return i.prototype={set:function(e,t,i,n){this.node=e,this.modelViewMatrix.assign(t),this.projectionMatrix.assign(i),this.viewport.assign(n)},set_over__:function(e,t){this.node.set_over__(e,t,this.modelViewMatrix,this.projectionMatrix,this.viewport)},set_active__:function(e,t){this.node.set_active__(e,t,this.modelViewMatrix,this.projectionMatrix,this.viewport)},set_motion__:function(e){this.node.set_motion__(e,this.modelViewMatrix,this.projectionMatrix,this.viewport)}},i}),define("x_ite/Components/PointingDeviceSensor/X3DPointingDeviceSensorNode",["x_ite/Components/Core/X3DSensorNode","x_ite/Browser/PointingDeviceSensor/PointingDeviceSensorContainer","x_ite/Base/X3DConstants"],function(e,t,i){"use strict";function n(t){e.call(this,t),this.addType(i.X3DPointingDeviceSensorNode)}return n.prototype=Object.assign(Object.create(e.prototype),{constructor:n,initialize:function(){e.prototype.initialize.call(this),this.enabled_.addInterest("set_enabled__",this)},getMatrices:function(){return this.matrices},set_enabled__:function(){this.enabled_.getValue()||(this.isActive_.getValue()&&(this.isActive_=!1),this.isOver_.getValue()&&(this.isOver_=!1))},set_over__:function(e,t){e!==this.isOver_.getValue()&&(this.isOver_=e,e&&(this.getBrowser().getNotification().string_=this.description_))},set_active__:function(e,t){e!==this.isActive_.getValue()&&(this.isActive_=e)},set_motion__:function(e){},push:function(e,i){this.enabled_.getValue()&&i.set(this,new t(this,e.getModelViewMatrix().get(),e.getProjectionMatrix().get(),e.getViewVolume().getViewport()))}}),n}),define("x_ite/Components/PointingDeviceSensor/X3DTouchSensorNode",["x_ite/Components/PointingDeviceSensor/X3DPointingDeviceSensorNode","x_ite/Base/X3DConstants"],function(e,t){"use strict";function i(i){e.call(this,i),this.addType(t.X3DTouchSensorNode)}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i,set_active__:function(t,i){e.prototype.set_active__.call(this,t,i),this.enabled_.getValue()&&this.isOver_.getValue()&&!t&&(this.touchTime_=this.getBrowser().getCurrentTime())}}),i}),define("x_ite/Components/PointingDeviceSensor/TouchSensor",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/PointingDeviceSensor/X3DTouchSensorNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Matrix4"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),this.addType(r.TouchSensor),this.hitPoint_changed_.setUnit("length")}var a=new o;return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"description",new e.SFString),new t(r.inputOutput,"enabled",new e.SFBool(!0)),new t(r.outputOnly,"hitTexCoord_changed",new e.SFVec2f),new t(r.outputOnly,"hitNormal_changed",new e.SFVec3f),new t(r.outputOnly,"hitPoint_changed",new e.SFVec3f),new t(r.outputOnly,"isOver",new e.SFBool),new t(r.outputOnly,"isActive",new e.SFBool),new t(r.outputOnly,"touchTime",new e.SFTime)]),getTypeName:function(){return"TouchSensor"},getComponentName:function(){return"PointingDeviceSensor"},getContainerField:function(){return"children"},set_over__:function(e,t,i,r,o){try{if(n.prototype.set_over__.call(this,e,t,i,r,o),this.isOver_.getValue()){var s=t.intersection;a.assign(i).inverse(),this.hitTexCoord_changed_=s.texCoord,this.hitNormal_changed_=i.multMatrixDir(s.normal.copy()).normalize(),this.hitPoint_changed_=a.multVecMatrix(s.point.copy())}}catch(e){console.log(e)}}}),s}),define("x_ite/Components/Networking/Anchor",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Components/Networking/X3DUrlObject","x_ite/Components/PointingDeviceSensor/TouchSensor","x_ite/Rendering/TraverseType","x_ite/Base/X3DConstants","x_ite/InputOutput/FileLoader"],function(e,t,i,n,r,o,s,a,u){"use strict";function l(e){n.call(this,e),r.call(this,e),this.addType(a.Anchor),this.touchSensorNode=new o(e)}return l.prototype=Object.assign(Object.create(n.prototype),r.prototype,{constructor:l,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(a.inputOutput,"metadata",new e.SFNode),new t(a.inputOutput,"description",new e.SFString),new t(a.inputOutput,"load",new e.SFBool(!0)),new t(a.inputOutput,"url",new e.MFString),new t(a.inputOutput,"parameter",new e.MFString),new t(a.inputOutput,"autoRefresh",new e.SFTime),new t(a.inputOutput,"autoRefreshTimeLimit",new e.SFTime(3600)),new t(a.inputOutput,"visible",new e.SFBool(!0)),new t(a.inputOutput,"bboxDisplay",new e.SFBool),new t(a.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new t(a.initializeOnly,"bboxCenter",new e.SFVec3f),new t(a.inputOnly,"addChildren",new e.MFNode),new t(a.inputOnly,"removeChildren",new e.MFNode),new t(a.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"Anchor"},getComponentName:function(){return"Networking"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),r.prototype.initialize.call(this),this.description_.addFieldInterest(this.touchSensorNode.description_),this.load_.addFieldInterest(this.touchSensorNode.enabled_),this.touchSensorNode.description_=this.description_,this.touchSensorNode.enabled_=this.load_,this.touchSensorNode.setup();const e=this,t=this.touchSensorNode.set_active__;this.touchSensorNode.set_active__=function(i,n){t.call(this,i,n),this.isOver_.getValue()&&!i&&e.requestImmediateLoad()}},set_load__:function(){},set_url__:function(){},requestImmediateLoad:function(e=!0){this.setCache(e),this.setLoadState(a.IN_PROGRESS_STATE,!1),new u(this).createX3DFromURL(this.url_,this.parameter_,function(e){e?(this.getBrowser().replaceWorld(e),this.setLoadState(a.COMPLETE_STATE,!1)):this.setLoadState(a.FAILED_STATE,!1)}.bind(this),function(e){this.getBrowser().changeViewpoint(e),this.setLoadState(a.COMPLETE_STATE,!1)}.bind(this),function(e,t){t?window.open(e,t):location=e,this.setLoadState(a.COMPLETE_STATE,!1)}.bind(this))},requestUnload(){},traverse:function(e,t){if(e===s.POINTER){const i=new Map;t.getBrowser().getSensors().push(i),this.touchSensorNode.push(t,i),n.prototype.traverse.call(this,e,t),t.getBrowser().getSensors().pop()}else n.prototype.traverse.call(this,e,t)}}),l}),define("x_ite/Components/Networking/Inline",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Core/X3DChildNode","x_ite/Components/Networking/X3DUrlObject","x_ite/Components/Grouping/X3DBoundedObject","x_ite/Components/Grouping/Group","x_ite/Rendering/TraverseType","x_ite/Base/X3DConstants","x_ite/InputOutput/FileLoader"],function(e,t,i,n,r,o,s,a,u,l){"use strict";function c(e){n.call(this,e),r.call(this,e),o.call(this,e),this.addType(u.Inline),this.scene=this.getBrowser().getDefaultScene(),this.group=new s(e),this.group.addParent(this)}return c.prototype=Object.assign(Object.create(n.prototype),r.prototype,o.prototype,{constructor:c,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(u.inputOutput,"metadata",new e.SFNode),new t(u.inputOutput,"load",new e.SFBool(!0)),new t(u.inputOutput,"url",new e.MFString),new t(u.inputOutput,"autoRefresh",new e.SFTime),new t(u.inputOutput,"autoRefreshTimeLimit",new e.SFTime(3600)),new t(u.inputOutput,"visible",new e.SFBool(!0)),new t(u.inputOutput,"bboxDisplay",new e.SFBool),new t(u.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new t(u.initializeOnly,"bboxCenter",new e.SFVec3f)]),getTypeName:function(){return"Inline"},getComponentName:function(){return"Networking"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),r.prototype.initialize.call(this),o.prototype.initialize.call(this),this.group.setPrivate(!0),this.group.setup(),this.group.isCameraObject_.addFieldInterest(this.isCameraObject_),this.group.isPickableObject_.addFieldInterest(this.isPickableObject_),this.requestImmediateLoad()},getBBox:function(e,t){return this.bboxSize_.getValue().equals(this.getDefaultBBoxSize())?this.group.getBBox(e,t):e.set(this.bboxSize_.getValue(),this.bboxCenter_.getValue())},set_live__:function(){r.prototype.set_live__.call(this),this.getPrivate()||this.scene.setLive(this.isLive().getValue())},unloadNow:function(){this.setInternalScene(this.getBrowser().getDefaultScene())},loadNow:function(){new l(this).createX3DFromURL(this.urlBuffer_,null,this.setInternalSceneAsync.bind(this))},setInternalSceneAsync:function(e){e?(this.setLoadState(u.COMPLETE_STATE),this.setInternalScene(e)):(this.setLoadState(u.FAILED_STATE),this.setInternalScene(this.getBrowser().getDefaultScene()))},setInternalScene:function(e){this.scene.setLive(!1),this.scene.rootNodes.removeFieldInterest(this.group.children_),this.scene=e,this.scene.setExecutionContext(this.getExecutionContext()),this.scene.setPrivate(this.getExecutionContext().getPrivate()),this.scene.rootNodes.addFieldInterest(this.group.children_),this.group.children_=this.scene.rootNodes,this.set_live__(),this.getBrowser().addBrowserEvent()},getInternalScene:function(){return this.scene},traverse:function(e,t){switch(e){case a.PICKING:{const i=t.getBrowser(),n=i.getPickingHierarchy();return n.push(this),this.group.traverse(e,t),void n.pop()}default:return void this.group.traverse(e,t)}}}),c}),define("x_ite/Components/Networking",["x_ite/Configuration/SupportedNodes","x_ite/Components/Networking/Anchor","x_ite/Components/Networking/Inline","x_ite/Components/Networking/LoadSensor","x_ite/Components/Networking/X3DNetworkSensorNode","x_ite/Components/Networking/X3DUrlObject"],function(e,t,i,n,r,o){"use strict";const s={Anchor:t,Inline:i,LoadSensor:n},a={X3DNetworkSensorNode:r,X3DUrlObject:o};for(const t in s)e.addType(t,s[t]);for(const t in a)e.addAbstractType(t,a[t])}),define("x_ite/Components/PointingDeviceSensor/X3DDragSensorNode",["x_ite/Components/PointingDeviceSensor/X3DPointingDeviceSensorNode","x_ite/Base/X3DConstants"],function(e,t){"use strict";function i(i){e.call(this,i),this.addType(t.X3DDragSensorNode),this.trackPoint_changed_.setUnit("length")}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i}),i}),define("standard/Math/Geometry/Cylinder3",["standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Line3"],function(e,t,i,n){"use strict";function r(e,t){this.axis=e.copy(),this.radius=t}return r.prototype={constructor:r,intersectsLine:function(r,o,s){const a=new t(this.axis.direction,new e(0,1,0)),u=i.Rotation(a),l=1/this.radius,c=new i;c.scale(new e(l,l,l)),c.multLeft(u);const h=e.subtract(r.point,this.axis.point),d=new n(h,r.direction),p=d.multLineMatrix(c),f=this.unitCylinderIntersectsLine(p,o,s);if(f){const e=c.inverse();e.multVecMatrix(o),o.add(this.axis.point),e.multVecMatrix(s),s.add(this.axis.point)}return f},unitCylinderIntersectsLine:function(e,t,i){let n,r;const o=e.point,s=e.direction,a=s[0]*s[0]+s[2]*s[2],u=2*(o[0]*s[0]+o[2]*s[2]),l=o[0]*o[0]+o[2]*o[2]-1,c=u*u-4*a*l;if(c<0)return!1;const h=Math.sqrt(c);return u>0?(n=-(2*l)/(h+u),r=-(h+u)/(2*a)):(n=2*l/(h-u),r=(h-u)/(2*a)),t.assign(s).multiply(n).add(o),i.assign(s).multiply(r).add(o),!0},toString:function(){return this.axis.toString()+" "+this.radius}},r}),define("x_ite/Components/PointingDeviceSensor/CylinderSensor",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/PointingDeviceSensor/X3DDragSensorNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Line3","standard/Math/Geometry/Plane3","standard/Math/Geometry/Cylinder3","standard/Math/Algorithm"],function(e,t,i,n,r,o,s,a,u,l,c,h){"use strict";function d(e){n.call(this,e),this.addType(r.CylinderSensor),this.diskAngle_.setUnit("angle"),this.minAngle_.setUnit("angle"),this.maxAngle_.setUnit("angle"),this.offset_.setUnit("angle")}return d.prototype=Object.assign(Object.create(n.prototype),{constructor:d,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"description",new e.SFString),new t(r.inputOutput,"enabled",new e.SFBool(!0)),new t(r.inputOutput,"axisRotation",new e.SFRotation),new t(r.inputOutput,"diskAngle",new e.SFFloat(.261792)),new t(r.inputOutput,"minAngle",new e.SFFloat),new t(r.inputOutput,"maxAngle",new e.SFFloat(-1)),new t(r.inputOutput,"offset",new e.SFFloat),new t(r.inputOutput,"autoOffset",new e.SFBool(!0)),new t(r.outputOnly,"trackPoint_changed",new e.SFVec3f),new t(r.outputOnly,"rotation_changed",new e.SFRotation),new t(r.outputOnly,"isOver",new e.SFBool),new t(r.outputOnly,"isActive",new e.SFBool)]),getTypeName:function(){return"CylinderSensor"},getComponentName:function(){return"PointingDeviceSensor"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.modelViewMatrix=new a,this.invModelViewMatrix=new a,this.cylinder=new c(new u(new o(0,0,0),new o(0,0,0)),0),this.disk=!1,this.yPlane=null,this.zPlane=null,this.sxPlane=null,this.szNormal=null,this.behind=!1,this.fromVector=new o(0,0,0),this.startOffset=new s(0,0,1,0)},isBehind:function(e,t){var i=new o(0,0,0),n=new o(0,0,0);return this.cylinder.intersectsLine(e,i,n),o.subtract(t,i).abs()>o.subtract(t,n).abs()},getTrackPoint:function(e,t){var i=new o(0,0,0);this.zPlane.intersectsLine(e,i);var n=o.add(i,this.cylinder.axis.getPerpendicularVector(i)),r=this.sxPlane.getDistanceToPoint(i)/this.cylinder.radius,a=Math.floor((r+1)/2),u=h.interval(r,-1,1),l=0===a?Math.asin(u):u*Math.PI/2,c=l+a*Math.PI;new s(this.cylinder.axis.direction,c).multVecRot(t.assign(this.szNormal).multiply(this.cylinder.radius)),t.add(n)},getAngle:function(e){return o.dot(e.getAxis(),this.cylinder.axis.direction)>0?e.angle:-e.angle},set_active__:function(e,t,i,r,a){n.prototype.set_active__.call(this,e,t,i,r,a);try{if(this.isActive_.getValue()){this.modelViewMatrix.assign(i),this.invModelViewMatrix.assign(i).inverse();var h=t.hitRay.copy().multLineMatrix(this.invModelViewMatrix),d=this.invModelViewMatrix.multVecMatrix(t.intersection.point.copy()),p=this.axisRotation_.getValue().multVecRot(new o(0,1,0)),f=this.invModelViewMatrix.multDirMatrix(new o(0,0,1)).normalize(),g=new u(new o(0,0,0),p),m=g.getPerpendicularVector(d).abs();this.cylinder=new c(g,m),this.disk=Math.abs(o.dot(f,p))>Math.cos(this.diskAngle_.getValue()),this.behind=this.isBehind(h,d),this.yPlane=new l(d,p),this.zPlane=new l(d,f);var y=this.invModelViewMatrix.origin,_=o.cross(p,y).normalize();this.sxPlane=new l(new o(0,0,0),_),this.szNormal=o.cross(_,p).normalize();var x=new o(0,0,0);this.disk?this.yPlane.intersectsLine(h,x):this.getTrackPoint(h,x),this.fromVector=this.cylinder.axis.getPerpendicularVector(x).negate(),this.startOffset=new s(p,this.offset_.getValue()),this.trackPoint_changed_=x,this.rotation_changed_=this.startOffset,this.angle=this.offset_.getValue(),this.startVector=this.rotation_changed_.getValue().multVecRot(this.axisRotation_.getValue().multVecRot(new o(0,0,1)))}else this.autoOffset_.getValue()&&(this.offset_=this.getAngle(this.rotation_changed_.getValue()))}catch(e){}},set_motion__:function(e){try{var t=e.hitRay.copy().multLineMatrix(this.invModelViewMatrix),i=new o(0,0,0);this.disk?this.yPlane.intersectsLine(t,i):this.getTrackPoint(t,i),
this.trackPoint_changed_=i;var n=this.cylinder.axis.getPerpendicularVector(i).negate(),r=new s(this.fromVector,n);if(this.disk){this.modelViewMatrix.multVecMatrix(i.copy()).z>0&&r.multRight(new s(this.yPlane.normal,Math.PI))}else this.behind&&r.inverse();if(r.multLeft(this.startOffset),this.minAngle_.getValue()>this.maxAngle_.getValue())this.rotation_changed_=r;else{var a=r.multVecRot(this.axisRotation_.getValue().multVecRot(new o(0,0,1))),u=new s(this.startVector,a),l=this.axisRotation_.getValue().multVecRot(new o(0,1,0)),c=l.dot(u.getAxis())>0?1:-1,h=this.minAngle_.getValue(),d=this.maxAngle_.getValue();this.angle+=c*u.angle,this.startVector.assign(a),this.angle<h?r.setAxisAngle(this.cylinder.axis.direction,h):this.angle>d?r.setAxisAngle(this.cylinder.axis.direction,d):r.setAxisAngle(this.cylinder.axis.direction,this.angle),this.rotation_changed_.getValue().equals(r)||(this.rotation_changed_=r)}}catch(e){this.trackPoint_changed_.addEvent(),this.rotation_changed_.addEvent()}}}),d}),define("x_ite/Components/PointingDeviceSensor/PlaneSensor",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/PointingDeviceSensor/X3DDragSensorNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Line3","standard/Math/Geometry/Plane3","standard/Math/Geometry/ViewVolume","standard/Math/Algorithm"],function(e,t,i,n,r,o,s,a,u,l,c,h,d){"use strict";function p(e){n.call(this,e),this.addType(r.PlaneSensor),this.offset_.setUnit("length"),this.minPosition_.setUnit("length"),this.maxPosition_.setUnit("length"),this.translation_changed_.setUnit("length")}var f=new l(s.Zero,s.Zero),g=new s(0,0,0),m=new l(s.Zero,s.Zero);return p.prototype=Object.assign(Object.create(n.prototype),{constructor:p,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"description",new e.SFString),new t(r.inputOutput,"enabled",new e.SFBool(!0)),new t(r.inputOutput,"axisRotation",new e.SFRotation),new t(r.inputOutput,"autoOffset",new e.SFBool(!0)),new t(r.inputOutput,"offset",new e.SFVec3f),new t(r.inputOutput,"minPosition",new e.SFVec2f),new t(r.inputOutput,"maxPosition",new e.SFVec2f(-1,-1)),new t(r.outputOnly,"trackPoint_changed",new e.SFVec3f),new t(r.outputOnly,"translation_changed",new e.SFVec3f),new t(r.outputOnly,"isOver",new e.SFBool),new t(r.outputOnly,"isActive",new e.SFBool)]),getTypeName:function(){return"PlaneSensor"},getComponentName:function(){return"PointingDeviceSensor"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.modelViewMatrix=new u,this.invModelViewMatrix=new u,this.projectionMatrix=new u,this.viewport=new a,this.planeSensor=!0,this.plane=null,this.line=null,this.startOffset=new s(0,0,0),this.startPoint=new s(0,0,0)},getLineTrackPoint:function(e,t,i){return h.projectLine(t,this.modelViewMatrix,this.projectionMatrix,this.viewport,f),f.getClosestPointToPoint(new s(e.pointer.x,e.pointer.y,0),g),h.unProjectRay(g.x,g.y,this.modelViewMatrix,this.projectionMatrix,this.viewport,m),t.getClosestPointToLine(m,i)},set_active__:function(e,t,i,r,o){n.prototype.set_active__.call(this,e,t,i,r,o);try{if(this.isActive_.getValue()){this.modelViewMatrix.assign(i),this.projectionMatrix.assign(r),this.viewport.assign(o),this.invModelViewMatrix.assign(i).inverse();var a=t.hitRay.copy().multLineMatrix(this.invModelViewMatrix),u=this.invModelViewMatrix.multVecMatrix(t.intersection.point.copy()),h=this.axisRotation_.getValue();if(this.minPosition_.x===this.maxPosition_.x){this.planeSensor=!1;var d=h.multVecRot(new s(0,Math.abs(this.maxPosition_.y-this.minPosition_.y),0));this.line=new l(u,d.normalize())}else if(this.minPosition_.y===this.maxPosition_.y){this.planeSensor=!1;var d=h.multVecRot(new s(Math.abs(this.maxPosition_.x-this.minPosition_.x),0,0));this.line=new l(u,d.normalize())}else this.planeSensor=!0,this.plane=new c(u,h.multVecRot(new s(0,0,1)));if(this.planeSensor)this.plane.intersectsLine(a,this.startPoint)&&this.trackStart(this.startPoint);else if(this.getLineTrackPoint(t,this.line,this.startPoint)){var p=new s(0,0,0);try{this.getLineTrackPoint(t,new l(this.line.direction,this.line.direction),p)}catch(e){p=this.startPoint}this.trackStart(p)}}else this.autoOffset_.getValue()&&(this.offset_=this.translation_changed_)}catch(e){console.log(e)}},trackStart:function(e){this.startOffset.assign(this.offset_.getValue()),this.trackPoint_changed_=e,this.translation_changed_=this.offset_.getValue()},set_motion__:function(e){try{if(this.planeSensor){var t=e.hitRay.copy().multLineMatrix(this.invModelViewMatrix),i=new s(0,0,0);if(!this.plane.intersectsLine(t,i))throw new Error("Plane and line are parallel.");this.track(i,i.copy())}else{var i=new s(0,0,0),n=new s(0,0,0);if(!this.getLineTrackPoint(e,this.line,i))throw new Error("Lines are parallel.");try{this.getLineTrackPoint(e,new l(s.Zero,this.line.direction),n)}catch(e){n.assign(i)}this.track(i,n)}}catch(e){this.trackPoint_changed_.addEvent(),this.translation_changed_.addEvent()}},track:function(e,t){var i=this.axisRotation_.getValue(),n=o.inverse(i).multVecRot(e.add(this.startOffset).subtract(this.startPoint));this.minPosition_.x>this.maxPosition_.x||(n.x=d.clamp(n.x,this.minPosition_.x,this.maxPosition_.x)),this.minPosition_.y>this.maxPosition_.y||(n.y=d.clamp(n.y,this.minPosition_.y,this.maxPosition_.y)),i.multVecRot(n),this.trackPoint_changed_.getValue().equals(t)||(this.trackPoint_changed_=t),this.translation_changed_.getValue().equals(n)||(this.translation_changed_=n)}}),p}),define("standard/Math/Geometry/Sphere3",["standard/Math/Numbers/Vector3"],function(e){"use strict";function t(e,t){this.radius=e,this.center=t.copy()}return t.prototype={constructor:t,set:function(e,t){this.radius=e,this.center.assign(t)},intersectsLine:function(e,t,i){const n=e.point,r=e.direction,o=this.center,s=this.radius,a=2*(n.dot(r)-o.dot(r)),u=n.x*n.x+n.y*n.y+n.z*n.z+(o.x*o.x+o.y*o.y+o.z*o.z)-2*n.dot(o)-s*s,l=a*a-4*u;if(l>=0){let e=(-a+Math.sqrt(l))/2,o=(-a-Math.sqrt(l))/2;if(e>o){const t=e;e=o,o=t}return t.assign(r).multiply(e).add(n),i.assign(r).multiply(o).add(n),!0}return!1},intersectsTriangle:function(){const t=new e(0,0,0),i=new e(0,0,0),n=new e(0,0,0),r=new e(0,0,0),o=new e(0,0,0),s=new e(0,0,0),a=new e(0,0,0);return function(u,l,c){const h=this.center,d=this.radius;u.subtract(h),l.subtract(h),c.subtract(h),t.assign(l).subtract(u),i.assign(c).subtract(u);const p=d*d,f=t.cross(i),g=e.dot(u,f);if(g*g>p*e.dot(f,f))return!1;const m=e.dot(u,u),y=e.dot(u,l),_=e.dot(u,c),x=e.dot(l,l),w=e.dot(l,c),b=e.dot(c,c),v=m>p&&y>m&&_>m,S=x>p&&y>x&&w>x,T=b>p&&_>b&&w>b;if(v||S||T)return!1;t.assign(l).subtract(u),n.assign(c).subtract(l),r.assign(u).subtract(c);const C=y-m,F=w-x,O=_-b,N=e.dot(t,t),E=e.dot(n,n),D=e.dot(r,r);o.assign(u).multiply(N).subtract(t.multiply(C)),s.assign(l).multiply(E).subtract(n.multiply(F)),a.assign(c).multiply(D).subtract(r.multiply(O));const M=c.multiply(N).subtract(o),V=u.multiply(E).subtract(s),I=l.multiply(D).subtract(a),B=e.dot(o,o)>p*N*N&&e.dot(o,M)>0,A=e.dot(s,s)>p*E*E&&e.dot(s,V)>0,P=e.dot(a,a)>p*D*D&&e.dot(a,I)>0;return!(B||A||P)}}(),toString:function(){return this.radius+" "+this.center.toString()}},t}),define("x_ite/Components/PointingDeviceSensor/SphereSensor",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/PointingDeviceSensor/X3DDragSensorNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Triangle3","standard/Math/Geometry/Line3","standard/Math/Geometry/Plane3","standard/Math/Geometry/Sphere3"],function(e,t,i,n,r,o,s,a,u,l,c,h){"use strict";function d(e){n.call(this,e),this.addType(r.SphereSensor)}return d.prototype=Object.assign(Object.create(n.prototype),{constructor:d,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"description",new e.SFString),new t(r.inputOutput,"enabled",new e.SFBool(!0)),new t(r.inputOutput,"autoOffset",new e.SFBool(!0)),new t(r.inputOutput,"offset",new e.SFRotation),new t(r.outputOnly,"trackPoint_changed",new e.SFVec3f),new t(r.outputOnly,"rotation_changed",new e.SFRotation),new t(r.outputOnly,"isOver",new e.SFBool),new t(r.outputOnly,"isActive",new e.SFBool)]),getTypeName:function(){return"SphereSensor"},getComponentName:function(){return"PointingDeviceSensor"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.modelViewMatrix=new a,this.invModelViewMatrix=new a,this.sphere=null,this.zPlane=null,this.behind=!1,this.fromVector=new o(0,0,0),this.startPoint=new o(0,0,0),this.startOffset=new s(0,0,1,0)},getTrackPoint:function(e,t,i){var n=new o(0,0,0);return!!this.sphere.intersectsLine(e,t,n)&&((o.subtract(e.point,n).abs()<o.subtract(e.point,t).abs())-i&&t.assign(n),!0)},set_active__:function(e,t,i,r,s){n.prototype.set_active__.call(this,e,t,i,r,s);try{if(this.isActive_.getValue()){this.modelViewMatrix.assign(i),this.invModelViewMatrix.assign(i).inverse();var a=this.invModelViewMatrix.multVecMatrix(t.intersection.point.copy()),u=new o(0,0,0);this.zPlane=new c(u,this.invModelViewMatrix.multDirMatrix(new o(0,0,1)).normalize()),this.sphere=new h(a.abs(),u),this.behind=this.zPlane.getDistanceToPoint(a)<0,this.fromVector.assign(a),this.startPoint.assign(a),this.startOffset.assign(this.offset_.getValue()),this.trackPoint_changed_=a,this.rotation_changed_=this.offset_.getValue()}else this.autoOffset_.getValue()&&(this.offset_=this.rotation_changed_)}catch(e){}},set_motion__:function(e){try{var t=e.hitRay.copy().multLineMatrix(this.invModelViewMatrix),i=new o(0,0,0);if(this.getTrackPoint(t,i,this.behind)){var n=this.invModelViewMatrix.multDirMatrix(new o(0,0,1)).normalize();this.zPlane=new c(i,n)}else{var r=new o(0,0,0);this.zPlane.intersectsLine(t,r),t=new l(r,o.subtract(this.sphere.center,r).normalize()),this.getTrackPoint(t,i,!1);var a=u.normal(this.sphere.center,i,this.startPoint,new o(0,0,0)),h=o.subtract(i,this.sphere.center).normalize(),d=o.cross(a,h).normalize(),p=o.subtract(i,d.multiply(o.subtract(r,i).abs()));t=new l(p,o.subtract(this.sphere.center,p).normalize()),this.getTrackPoint(t,i,!1)}this.trackPoint_changed_=i;var f=o.subtract(i,this.sphere.center),g=new s(this.fromVector,f);this.behind&&g.inverse(),this.rotation_changed_=s.multRight(this.startOffset,g)}catch(e){this.trackPoint_changed_.addEvent(),this.rotation_changed_.addEvent()}}}),d}),define("x_ite/Components/PointingDeviceSensor",["x_ite/Configuration/SupportedNodes","x_ite/Components/PointingDeviceSensor/CylinderSensor","x_ite/Components/PointingDeviceSensor/PlaneSensor","x_ite/Components/PointingDeviceSensor/SphereSensor","x_ite/Components/PointingDeviceSensor/TouchSensor","x_ite/Components/PointingDeviceSensor/X3DDragSensorNode","x_ite/Components/PointingDeviceSensor/X3DPointingDeviceSensorNode","x_ite/Components/PointingDeviceSensor/X3DTouchSensorNode"],function(e,t,i,n,r,o,s,a){"use strict";const u={CylinderSensor:t,PlaneSensor:i,SphereSensor:n,TouchSensor:r},l={X3DDragSensorNode:o,X3DPointingDeviceSensorNode:s,X3DTouchSensorNode:a};for(const t in u)e.addType(t,u[t]);for(const t in l)e.addAbstractType(t,l[t])}),define("x_ite/Components/Rendering/ClipPlane",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Core/X3DChildNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Vector4","standard/Math/Geometry/Plane3","standard/Utility/ObjectCache"],function(e,t,i,n,r,o,s,a,u){"use strict";function l(){this.plane=new a(o.Zero,o.Zero)}function c(e){n.call(this,e),this.addType(r.ClipPlane),this.enabled=!1,this.plane=new s(0,0,0,0)}const h=u(l);return l.prototype={constructor:l,isClipped:function(e){return this.plane.getDistanceToPoint(e)<0},set:function(e,t){const i=this.plane,n=e.plane;try{i.normal.assign(n),i.distanceFromOrigin=-n.w,i.multRight(t)}catch(e){i.normal.set(0,0,0),i.distanceFromOrigin=0}},setShaderUniforms:function(e,t){const i=this.plane,n=i.normal;e.uniform4f(t.x3d_ClipPlane[t.numClipPlanes++],n.x,n.y,n.z,i.distanceFromOrigin)},dispose:function(){h.push(this)}},c.prototype=Object.assign(Object.create(n.prototype),{constructor:c,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"enabled",new e.SFBool(!0)),new t(r.inputOutput,"plane",new e.SFVec4f(0,1,0,0))]),getTypeName:function(){return"ClipPlane"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.enabled_.addInterest("set_enabled__",this),this.plane_.addInterest("set_enabled__",this),this.set_enabled__()},set_enabled__:function(){this.plane.assign(this.plane_.getValue()),this.enabled=this.enabled_.getValue()&&!this.plane.equals(s.Zero)},push:function(e){if(this.enabled){const t=h.pop();t.set(this,e.getModelViewMatrix().get()),e.getLocalObjects().push(t)}},pop:function(e){this.enabled&&e.getBrowser().getLocalObjects().push(e.getLocalObjects().pop())}}),c}),define("x_ite/Components/Rendering/ColorRGBA",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Rendering/X3DColorNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector4"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),this.addType(r.ColorRGBA),this.setTransparent(!0)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"color",new e.MFColorRGBA)]),getTypeName:function(){return"ColorRGBA"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"color"},initialize:function(){n.prototype.initialize.call(this),this.color_.addInterest("set_color__",this),this.set_color__()},set_color__:function(){this.color=this.color_.getValue(),this.length=this.color_.length},addColor:function(e,t){if(e>=0&&e<this.length){const i=this.color;e*=4,t.push(i[e],i[e+1],i[e+2],i[e+3])}else if(this.length){const i=this.color;e=4*(this.length-1),t.push(i[e],i[e+1],i[e+2],i[e+3])}else t.push(1,1,1,1)},addColors:function(e,t){if(this.length){const r=this.color;for(var i=0,n=4*this.length;i<n;i+=4)e.push(r[i],r[i+1],r[i+2],r[i+3]);var i=4*(this.length-1);const o=r[i],s=r[i+1],a=r[i+2],u=r[i+2];for(var i=n,n=4*t;i<n;i+=4)e.push(o,s,a,u)}else for(var i=0;i<t;++i)e.push(1,1,1,1)},getVectors:function(e){const t=this.color_;for(var i=0,n=t.length;i<n;++i){const n=t[i];e[i]=new o(n.r,n.g,n.b,n.a)}return e.length=n,e}}),s}),define("x_ite/Components/Rendering/IndexedTriangleFanSet",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Rendering/X3DComposedGeometryNode","x_ite/Base/X3DConstants"],function(e,t,i,n,r){"use strict";function o(e){n.call(this,e),this.addType(r.IndexedTriangleFanSet),this.triangleIndex=[]}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_index",new e.MFInt32),new t(r.initializeOnly,"solid",new e.SFBool(!0)),new t(r.initializeOnly,"ccw",new e.SFBool(!0)),new t(r.initializeOnly,"colorPerVertex",new e.SFBool(!0)),new t(r.initializeOnly,"normalPerVertex",new e.SFBool(!0)),new t(r.initializeOnly,"index",new e.MFInt32),new t(r.inputOutput,"attrib",new e.MFNode),new t(r.inputOutput,"fogCoord",new e.SFNode),new t(r.inputOutput,"color",new e.SFNode),new t(r.inputOutput,"texCoord",new e.SFNode),new t(r.inputOutput,"normal",new e.SFNode),new t(r.inputOutput,"coord",new e.SFNode)]),getTypeName:function(){return"IndexedTriangleFanSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},initialize:function(){n.prototype.initialize.call(this),this.set_index_.addFieldInterest(this.index_),this.index_.addInterest("set_index__",this),this.set_index__()},set_index__:function(){const e=this.index_,t=this.triangleIndex;t.length=0;for(var i=0,n=e.length;i<n;++i){const o=e[i];if(!(o<0)&&++i<n){var r=e[i];if(r<0)continue;for(++i;i<n;++i){const n=e[i];if(n<0)break;t.push(o,r,n),r=n}}}},getPolygonIndex:function(e){return this.triangleIndex[e]},build:function(){n.prototype.build.call(this,3,this.triangleIndex.length,3,this.triangleIndex.length)}}),o}),define("x_ite/Components/Rendering/IndexedTriangleSet",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Rendering/X3DComposedGeometryNode","x_ite/Base/X3DConstants"],function(e,t,i,n,r){"use strict";function o(e){n.call(this,e),this.addType(r.IndexedTriangleSet)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_index",new e.MFInt32),new t(r.initializeOnly,"solid",new e.SFBool(!0)),new t(r.initializeOnly,"ccw",new e.SFBool(!0)),new t(r.initializeOnly,"colorPerVertex",new e.SFBool(!0)),new t(r.initializeOnly,"normalPerVertex",new e.SFBool(!0)),new t(r.initializeOnly,"index",new e.MFInt32),new t(r.inputOutput,"attrib",new e.MFNode),new t(r.inputOutput,"fogCoord",new e.SFNode),new t(r.inputOutput,"color",new e.SFNode),new t(r.inputOutput,"texCoord",new e.SFNode),new t(r.inputOutput,"normal",new e.SFNode),new t(r.inputOutput,"coord",new e.SFNode)]),getTypeName:function(){return"IndexedTriangleSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},getPolygonIndex:function(e){return this.index_[e]},initialize:function(){n.prototype.initialize.call(this),this.set_index_.addFieldInterest(this.index_)},build:function(){n.prototype.build.call(this,3,this.index_.length,3,this.index_.length)}}),o}),define("x_ite/Components/Rendering/IndexedTriangleStripSet",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Rendering/X3DComposedGeometryNode","x_ite/Base/X3DConstants"],function(e,t,i,n,r){"use strict";function o(e){n.call(this,e),this.addType(r.IndexedTriangleStripSet),this.triangleIndex=[]}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"set_index",new e.MFInt32),new t(r.initializeOnly,"solid",new e.SFBool(!0)),new t(r.initializeOnly,"ccw",new e.SFBool(!0)),new t(r.initializeOnly,"colorPerVertex",new e.SFBool(!0)),new t(r.initializeOnly,"normalPerVertex",new e.SFBool(!0)),new t(r.initializeOnly,"index",new e.MFInt32),new t(r.inputOutput,"attrib",new e.MFNode),new t(r.inputOutput,"fogCoord",new e.SFNode),new t(r.inputOutput,"color",new e.SFNode),new t(r.inputOutput,"texCoord",new e.SFNode),new t(r.inputOutput,"normal",new e.SFNode),new t(r.inputOutput,"coord",new e.SFNode)]),getTypeName:function(){return"IndexedTriangleStripSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},initialize:function(){n.prototype.initialize.call(this),this.set_index_.addFieldInterest(this.index_),this.index_.addInterest("set_index__",this),this.set_index__()},set_index__:function(){const e=this.index_,t=this.triangleIndex;t.length=0;for(var i=0,n=e.length;i<n;++i){var r=e[i];if(!(r<0)&&++i<n){var o=e[i];if(o<0)continue;++i;for(var s=0;i<n;++i,++s){const n=e[i];if(n<0)break;t.push(r,o,n),1&s?o=n:r=n}}}},getPolygonIndex:function(e){return this.triangleIndex[e]},build:function(){n.prototype.build.call(this,3,this.triangleIndex.length,3,this.triangleIndex.length)}}),o}),define("x_ite/Components/Rendering/LineSet",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Rendering/X3DLineGeometryNode","x_ite/Base/X3DCast","x_ite/Base/X3DConstants"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),this.addType(o.LineSet),this.setGeometryType(1),this.fogCoordNode=null,this.colorNode=null,this.coordNode=null}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOutput,"vertexCount",new e.MFInt32),new t(o.inputOutput,"attrib",new e.MFNode),new t(o.inputOutput,"fogCoord",new e.SFNode),new t(o.inputOutput,"color",new e.SFNode),new t(o.inputOutput,"coord",new e.SFNode)]),getTypeName:function(){return"LineSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},initialize:function(){n.prototype.initialize.call(this),this.attrib_.addInterest("set_attrib__",this),this.fogCoord_.addInterest("set_fogCoord__",this),this.color_.addInterest("set_color__",this),this.coord_.addInterest("set_coord__",this),this.setPrimitiveMode(this.getBrowser().getContext().LINES),this.setSolid(!1),this.set_attrib__(),this.set_fogCoord__(),this.set_color__(),this.set_coord__()},set_attrib__:function(){const e=this.getAttrib();for(var t=0,i=e.length;t<i;++t)e[t].removeInterest("requestRebuild",this);e.length=0;for(var t=0,i=this.attrib_.length;t<i;++t){const i=r(o.X3DVertexAttributeNode,this.attrib_[t]);i&&e.push(i)}for(var t=0;t<this.attribNodes.length;++t)e[t].addInterest("requestRebuild",this)},set_fogCoord__:function(){this.fogCoordNode&&this.fogCoordNode.removeInterest("requestRebuild",this),this.fogCoordNode=r(o.FogCoordinate,this.fogCoord_),this.fogCoordNode&&this.fogCoordNode.addInterest("requestRebuild",this)},set_color__:function(){this.colorNode&&(this.colorNode.removeInterest("requestRebuild",this),this.colorNode.transparent_.removeInterest("set_transparent__",this)),this.colorNode=r(o.X3DColorNode,this.color_),this.colorNode?(this.colorNode.addInterest("requestRebuild",this),this.colorNode.transparent_.addInterest("set_transparent__",this),this.set_transparent__()):this.setTransparent(!1)},set_transparent__:function(){this.setTransparent(this.colorNode.getTransparent())},set_coord__:function(){this.coordNode&&this.coordNode.removeInterest("requestRebuild",this),this.coordNode=r(o.X3DCoordinateNode,this.coord_),this.coordNode&&this.coordNode.addInterest("requestRebuild",this)},build:function(){if(this.coordNode&&!this.coordNode.isEmpty()){const s=this.vertexCount_,a=this.getAttrib(),u=a.length,l=this.getAttribs(),c=this.fogCoordNode,h=this.colorNode,d=this.coordNode,p=this.getFogDepths(),f=this.getColors(),g=this.getVertices(),m=d.getSize();for(var e=0,t=0,i=s.length;t<i;++t){var n=s[t];if(e+n>m)break;if(n>1){n=2*n-2;for(var r=0;r<n;++r,e+=1&r){for(var o=0;o<u;++o)a[o].addValue(e,l[o]);c&&c.addDepth(e,p),h&&h.addColor(e,f),d.addPoint(e,g)}++e}else e+=n}}}}),s}),define("x_ite/Components/Rendering/X3DNormalNode",["x_ite/Components/Rendering/X3DGeometricPropertyNode","x_ite/Base/X3DConstants"],function(e,t){"use strict";function i(i){e.call(this,i),this.addType(t.X3DNormalNode)}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i}),i}),define("x_ite/Components/Rendering/Normal",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Rendering/X3DNormalNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),this.addType(r.Normal)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"vector",new e.MFVec3f)]),getTypeName:function(){return"Normal"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"normal"},initialize:function(){n.prototype.initialize.call(this),this.vector_.addInterest("set_vector__",this),this.set_vector__()},set_vector__:function(){this.vector=this.vector_.getValue(),this.length=this.vector_.length},set1Vector:function(e,t){this.vector_[e]=t},get1Vector:function(e,t){if(e>=0&&e<this.length){const i=this.vector;return e*=3,t.set(i[e],i[e+1],i[e+2])}if(e>=0&&this.length){const i=this.vector;return e%=this.length,e*=3,t.set(i[e],i[e+1],i[e+2])}return t.set(0,0,0)},addVector:function(e,t){if(e>=0&&e<this.length){const i=this.vector;e*=3,t.push(i[e],i[e+1],i[e+2])}else{if(!(e>=0&&this.length))return t.push(0,0,0);{const i=this.vector;e%=this.length,e*=3,t.push(i[e],i[e+1],i[e+2])}}}}),s}),define("x_ite/Components/Rendering/PointSet",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Rendering/X3DLineGeometryNode","x_ite/Base/X3DCast","x_ite/Base/X3DConstants"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),this.addType(o.PointSet),this.setGeometryType(0),this.setTransparent(!0),this.fogCoordNode=null,this.colorNode=null,this.coordNode=null}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOutput,"attrib",new e.MFNode),new t(o.inputOutput,"fogCoord",new e.SFNode),new t(o.inputOutput,"color",new e.SFNode),new t(o.inputOutput,"coord",new e.SFNode)]),getTypeName:function(){return"PointSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},initialize:function(){n.prototype.initialize.call(this),this.attrib_.addInterest("set_attrib__",this),this.fogCoord_.addInterest("set_fogCoord__",this),this.color_.addInterest("set_color__",this),this.coord_.addInterest("set_coord__",this);const e=this.getBrowser();this.setPrimitiveMode(e.getContext().POINTS),this.setSolid(!1),this.set_attrib__(),this.set_fogCoord__(),this.set_color__(),this.set_coord__()},getShader:function(e){return e.getPointShader()},getCoord:function(){return this.coordNode},set_attrib__:function(){const e=this.getAttrib();for(var t=0,i=e.length;t<i;++t)e[t].removeInterest("requestRebuild",this);e.length=0;for(var t=0,i=this.attrib_.length;t<i;++t){const i=r(o.X3DVertexAttributeNode,this.attrib_[t]);i&&e.push(i)}for(var t=0;t<this.attribNodes.length;++t)e[t].addInterest("requestRebuild",this)},set_fogCoord__:function(){this.fogCoordNode&&this.fogCoordNode.removeInterest("requestRebuild",this),this.fogCoordNode=r(o.FogCoordinate,this.fogCoord_),this.fogCoordNode&&this.fogCoordNode.addInterest("requestRebuild",this)},set_color__:function(){this.colorNode&&this.colorNode.removeInterest("requestRebuild",this),this.colorNode=r(o.X3DColorNode,this.color_),this.colorNode&&this.colorNode.addInterest("requestRebuild",this)},set_coord__:function(){this.coordNode&&this.coordNode.removeInterest("requestRebuild",this),this.coordNode=r(o.X3DCoordinateNode,this.coord_),this.coordNode&&this.coordNode.addInterest("requestRebuild",this)},build:function(){if(this.coordNode&&!this.coordNode.isEmpty()){const i=this.getAttrib(),n=i.length,r=this.getAttribs(),o=this.fogCoordNode,s=this.getFogDepths(),a=this.colorNode,u=this.getColors(),l=this.coordNode,c=this.getVertices(),h=l.point_.length;for(var e=0;e<n;++e)for(var t=0;t<h;++t)i[e].addValue(t,r[e]);o&&o.addDepths(s,h),a&&a.addColors(u,h),l.addPoints(c,h)}}}),s}),define("x_ite/Components/Rendering/TriangleFanSet",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Rendering/X3DComposedGeometryNode","x_ite/Base/X3DConstants"],function(e,t,i,n,r){"use strict";function o(e){n.call(this,e),this.addType(r.TriangleFanSet),this.triangleIndex=[]}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.initializeOnly,"solid",new e.SFBool(!0)),new t(r.initializeOnly,"ccw",new e.SFBool(!0)),new t(r.initializeOnly,"colorPerVertex",new e.SFBool(!0)),new t(r.initializeOnly,"normalPerVertex",new e.SFBool(!0)),new t(r.inputOutput,"fanCount",new e.MFInt32),new t(r.inputOutput,"attrib",new e.MFNode),new t(r.inputOutput,"fogCoord",new e.SFNode),new t(r.inputOutput,"color",new e.SFNode),new t(r.inputOutput,"texCoord",new e.SFNode),new t(r.inputOutput,"normal",new e.SFNode),new t(r.inputOutput,"coord",new e.SFNode)]),getTypeName:function(){return"TriangleFanSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},initialize:function(){n.prototype.initialize.call(this),this.fanCount_.addInterest("set_fanCount__",this),this.set_fanCount__()},set_fanCount__:function(){const e=this.fanCount_,t=this.triangleIndex;t.length=0;for(var i=0,n=e.length,r=0;i<n;++i){const n=e[i];for(var o=1,s=n-1;o<s;++o)t.push(r,r+o,r+o+1);r+=n}},getPolygonIndex:function(e){return this.triangleIndex[e]},build:function(){n.prototype.build.call(this,3,this.triangleIndex.length,3,this.triangleIndex.length)}}),o}),define("x_ite/Components/Rendering/TriangleSet",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Rendering/X3DComposedGeometryNode","x_ite/Base/X3DConstants"],function(e,t,i,n,r){"use strict";function o(e){n.call(this,e),this.addType(r.TriangleSet)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.initializeOnly,"solid",new e.SFBool(!0)),new t(r.initializeOnly,"ccw",new e.SFBool(!0)),new t(r.initializeOnly,"colorPerVertex",new e.SFBool(!0)),new t(r.initializeOnly,"normalPerVertex",new e.SFBool(!0)),new t(r.inputOutput,"attrib",new e.MFNode),new t(r.inputOutput,"fogCoord",new e.SFNode),new t(r.inputOutput,"color",new e.SFNode),new t(r.inputOutput,"texCoord",new e.SFNode),new t(r.inputOutput,"normal",new e.SFNode),new t(r.inputOutput,"coord",new e.SFNode)]),getTypeName:function(){return"TriangleSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},build:function(){this.getCoord()&&n.prototype.build.call(this,3,this.getCoord().getSize(),3,this.getCoord().getSize())},createNormals:function(e,t){return this.createFaceNormals(e,t)}}),o}),define("x_ite/Components/Rendering/TriangleStripSet",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Rendering/X3DComposedGeometryNode","x_ite/Base/X3DConstants"],function(e,t,i,n,r){"use strict";function o(e){n.call(this,e),this.addType(r.TriangleStripSet),this.triangleIndex=[]}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.initializeOnly,"solid",new e.SFBool(!0)),new t(r.initializeOnly,"ccw",new e.SFBool(!0)),new t(r.initializeOnly,"colorPerVertex",new e.SFBool(!0)),new t(r.initializeOnly,"normalPerVertex",new e.SFBool(!0)),new t(r.inputOutput,"stripCount",new e.MFInt32),new t(r.inputOutput,"attrib",new e.MFNode),new t(r.inputOutput,"fogCoord",new e.SFNode),new t(r.inputOutput,"color",new e.SFNode),new t(r.inputOutput,"texCoord",new e.SFNode),new t(r.inputOutput,"normal",new e.SFNode),new t(r.inputOutput,"coord",new e.SFNode)]),getTypeName:function(){return"TriangleStripSet"},getComponentName:function(){return"Rendering"},getContainerField:function(){return"geometry"},initialize:function(){n.prototype.initialize.call(this),this.stripCount_.addInterest("set_stripCount__",this),this.set_stripCount__()},set_stripCount__:function(){const e=this.stripCount_,t=this.triangleIndex;t.length=0;for(var i=0,n=e.length,r=0;i<n;++i){const n=e[i];for(var o=0,s=n-2;o<s;++o){const e=1&o;t.push(r+(e?o+1:o),r+(e?o:o+1),r+(o+2))}r+=n}},getPolygonIndex:function(e){return this.triangleIndex[e]},build:function(){n.prototype.build.call(this,3,this.triangleIndex.length,3,this.triangleIndex.length)}}),o}),
define("x_ite/Components/Rendering",["x_ite/Configuration/SupportedNodes","x_ite/Components/Rendering/ClipPlane","x_ite/Components/Rendering/Color","x_ite/Components/Rendering/ColorRGBA","x_ite/Components/Rendering/Coordinate","x_ite/Components/Rendering/IndexedLineSet","x_ite/Components/Rendering/IndexedTriangleFanSet","x_ite/Components/Rendering/IndexedTriangleSet","x_ite/Components/Rendering/IndexedTriangleStripSet","x_ite/Components/Rendering/LineSet","x_ite/Components/Rendering/Normal","x_ite/Components/Rendering/PointSet","x_ite/Components/Rendering/TriangleFanSet","x_ite/Components/Rendering/TriangleSet","x_ite/Components/Rendering/TriangleStripSet","x_ite/Components/Rendering/X3DColorNode","x_ite/Components/Rendering/X3DComposedGeometryNode","x_ite/Components/Rendering/X3DCoordinateNode","x_ite/Components/Rendering/X3DGeometricPropertyNode","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Components/Rendering/X3DLineGeometryNode","x_ite/Components/Rendering/X3DNormalNode"],function(e,t,i,n,r,o,s,a,u,l,c,h,d,p,f,g,m,y,_,x,w,b){"use strict";const v={ClipPlane:t,Color:i,ColorRGBA:n,Coordinate:r,IndexedLineSet:o,IndexedTriangleFanSet:s,IndexedTriangleSet:a,IndexedTriangleStripSet:u,LineSet:l,Normal:c,PointSet:h,TriangleFanSet:d,TriangleSet:p,TriangleStripSet:f},S={X3DColorNode:g,X3DComposedGeometryNode:m,X3DCoordinateNode:y,X3DGeometricPropertyNode:_,X3DGeometryNode:x,X3DLineGeometryNode:w,X3DNormalNode:b};for(const t in v)e.addType(t,v[t]);for(const t in S)e.addAbstractType(t,S[t])}),define("x_ite/Components/Shaders/X3DVertexAttributeNode",["x_ite/Components/Rendering/X3DGeometricPropertyNode","x_ite/Base/X3DConstants"],function(e,t){"use strict";function i(i){e.call(this,i),this.addType(t.X3DVertexAttributeNode)}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i}),i}),define("x_ite/Components/Shaders/FloatVertexAttribute",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Shaders/X3DVertexAttributeNode","x_ite/Base/X3DConstants","standard/Math/Algorithm"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),this.addType(r.FloatVertexAttribute)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.initializeOnly,"name",new e.SFString),new t(r.initializeOnly,"numComponents",new e.SFInt32(4)),new t(r.inputOutput,"value",new e.MFFloat)]),getTypeName:function(){return"FloatVertexAttribute"},getComponentName:function(){return"Shaders"},getContainerField:function(){return"attrib"},initialize:function(){n.prototype.initialize.call(this),this.numComponents_.addInterest("set_numComponents",this),this.value_.addInterest("set_value",this),this.set_numComponents(),this.set_value()},set_numComponents:function(){this.numComponents=o.clamp(this.numComponents_.getValue(),1,4)},set_value:function(){this.value=this.value_.getValue(),this.length=this.value_.length},addValue:function(e,t){var i=this.value,n=e*this.numComponents,r=n+this.numComponents;if(r<=this.length)for(;n<r;++n)t.push(i[n]);else if(this.numComponents<=this.length)for(r=i.length,n=r-this.numComponents;n<r;++n)t.push(i[n]);else for(;n<r;++n)t.push(0)},enable:function(e,t,i){t.enableFloatAttrib(e,this.name_.getValue(),i,this.numComponents)},disable:function(e,t){t.disableFloatAttrib(e,this.name_.getValue())}}),s}),define("x_ite/Components/Shaders/Matrix3VertexAttribute",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Shaders/X3DVertexAttributeNode","x_ite/Base/X3DConstants","standard/Math/Numbers/Matrix3"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),this.addType(r.Matrix3VertexAttribute)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.initializeOnly,"name",new e.SFString),new t(r.inputOutput,"value",new e.MFMatrix3f)]),getTypeName:function(){return"Matrix3VertexAttribute"},getComponentName:function(){return"Shaders"},getContainerField:function(){return"attrib"},initialize:function(){n.prototype.initialize.call(this),this.value_.addInterest("set_value",this),this.set_value()},set_value:function(){this.value=this.value_.getValue(),this.length=this.value_.length},addValue:function(e,t){if(e<this.length)for(var i=this.value,n=9*e,r=n+9;n<r;++n)t.push(i[n]);else if(this.length){var i=this.value;e=this.length-1;for(var n=9*e,r=n+9;n<r;++n)t.push(i[n])}else for(var i=o.Identity,n=0;n<9;++n)t.push(i[n])},enable:function(e,t,i){t.enableMatrix3Attrib(e,this.name_.getValue(),i)},disable:function(e,t){t.disableMatrix3Attrib(e,this.name_.getValue())}}),s}),define("x_ite/Components/Shaders/Matrix4VertexAttribute",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Shaders/X3DVertexAttributeNode","x_ite/Base/X3DConstants"],function(e,t,i,n,r){"use strict";function o(e){n.call(this,e),this.addType(r.Matrix4VertexAttribute)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.initializeOnly,"name",new e.SFString),new t(r.inputOutput,"value",new e.MFMatrix4f)]),getTypeName:function(){return"Matrix4VertexAttribute"},getComponentName:function(){return"Shaders"},getContainerField:function(){return"attrib"},initialize:function(){n.prototype.initialize.call(this),this.value_.addInterest("set_value",this),this.set_value()},set_value:function(){this.value=this.value_.getValue(),this.length=this.value_.length},addValue:function(e,t){if(e<this.length)for(var i=this.value,n=16*e,r=n+16;n<r;++n)t.push(i[n]);else if(this.length){var i=this.value;e=this.length-1;for(var n=16*e,r=n+16;n<r;++n)t.push(i[n])}else for(var i=Matrix4.Identity,n=0;n<16;++n)t.push(i[n])},enable:function(e,t,i){t.enableMatrix4Attrib(e,this.name_.getValue(),i)},disable:function(e,t){t.disableMatrix4Attrib(e,this.name_.getValue())}}),o}),define("x_ite/Components/Shaders/PackagedShader",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Shaders/X3DShaderNode","x_ite/Components/Networking/X3DUrlObject","x_ite/Components/Shaders/X3DProgrammableShaderObject","x_ite/Base/X3DConstants"],function(e,t,i,n,r,o,s){"use strict";function a(e){n.call(this,e),r.call(this,e),o.call(this,e),this.addType(s.PackagedShader)}return a.prototype=Object.assign(Object.create(n.prototype),r.prototype,o.prototype,{constructor:a,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOnly,"activate",new e.SFBool),new t(s.outputOnly,"isSelected",new e.SFBool),new t(s.outputOnly,"isValid",new e.SFBool),new t(s.initializeOnly,"language",new e.SFString),new t(s.inputOutput,"load",new e.SFBool(!0)),new t(s.inputOutput,"url",new e.MFString),new t(s.inputOutput,"autoRefresh",new e.SFTime),new t(s.inputOutput,"autoRefreshTimeLimit",new e.SFTime(3600))]),getTypeName:function(){return"PackagedShader"},getComponentName:function(){return"Shaders"},getContainerField:function(){return"shaders"},getSourceText:function(){return this.url_},requestImmediateLoad:function(e=!0){},requestUnload:function(){}}),a}),define("x_ite/Components/Shaders/ProgramShader",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Shaders/X3DShaderNode","x_ite/Base/X3DConstants"],function(e,t,i,n,r){"use strict";function o(e){n.call(this,e),this.addType(r.ProgramShader)}return o.prototype=Object.assign(Object.create(n.prototype),{constructor:o,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOnly,"activate",new e.SFBool),new t(r.outputOnly,"isSelected",new e.SFBool),new t(r.outputOnly,"isValid",new e.SFBool),new t(r.initializeOnly,"language",new e.SFString),new t(r.inputOutput,"programs",new e.MFNode)]),getTypeName:function(){return"ProgramShader"},getComponentName:function(){return"Shaders"},getContainerField:function(){return"shaders"}}),o}),define("x_ite/Components/Shaders/ShaderProgram",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Core/X3DNode","x_ite/Components/Networking/X3DUrlObject","x_ite/Components/Shaders/X3DProgrammableShaderObject","x_ite/Base/X3DConstants"],function(e,t,i,n,r,o,s){"use strict";function a(e){n.call(this,e),r.call(this,e),o.call(this,e),this.addType(s.ShaderProgram)}return a.prototype=Object.assign(Object.create(n.prototype),r.prototype,o.prototype,{constructor:a,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.initializeOnly,"type",new e.SFString("VERTEX")),new t(s.inputOutput,"load",new e.SFBool(!0)),new t(s.inputOutput,"url",new e.MFString),new t(s.inputOutput,"autoRefresh",new e.SFTime),new t(s.inputOutput,"autoRefreshTimeLimit",new e.SFTime(3600))]),getTypeName:function(){return"ShaderProgram"},getComponentName:function(){return"Shaders"},getContainerField:function(){return"programs"},getSourceText:function(){return this.url_},requestImmediateLoad:function(e=!0){},requestUnload:function(){}}),a}),define("x_ite/Components/Shaders",["x_ite/Configuration/SupportedNodes","x_ite/Components/Shaders/ComposedShader","x_ite/Components/Shaders/FloatVertexAttribute","x_ite/Components/Shaders/Matrix3VertexAttribute","x_ite/Components/Shaders/Matrix4VertexAttribute","x_ite/Components/Shaders/PackagedShader","x_ite/Components/Shaders/ProgramShader","x_ite/Components/Shaders/ShaderPart","x_ite/Components/Shaders/ShaderProgram","x_ite/Components/Shaders/X3DProgrammableShaderObject","x_ite/Components/Shaders/X3DShaderNode","x_ite/Components/Shaders/X3DVertexAttributeNode"],function(e,t,i,n,r,o,s,a,u,l,c,h){"use strict";const d={ComposedShader:t,FloatVertexAttribute:i,Matrix3VertexAttribute:n,Matrix4VertexAttribute:r,PackagedShader:o,ProgramShader:s,ShaderPart:a,ShaderProgram:u},p={X3DProgrammableShaderObject:l,X3DShaderNode:c,X3DVertexAttributeNode:h};for(const t in d)e.addType(t,d[t]);for(const t in p)e.addAbstractType(t,p[t])}),define("x_ite/Components/Shape/Material",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Shape/X3DOneSidedMaterialNode","x_ite/Base/X3DConstants","standard/Math/Algorithm"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),this.addType(r.Material),this.diffuseColor=new Float32Array(3),this.specularColor=new Float32Array(3)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"ambientIntensity",new e.SFFloat(.2)),new t(r.inputOutput,"ambientTexture",new e.SFNode),new t(r.inputOutput,"ambientTextureMapping",new e.SFString),new t(r.inputOutput,"diffuseColor",new e.SFColor(.8,.8,.8)),new t(r.inputOutput,"diffuseTexture",new e.SFNode),new t(r.inputOutput,"diffuseTextureMapping",new e.SFString),new t(r.inputOutput,"specularColor",new e.SFColor),new t(r.inputOutput,"specularTexture",new e.SFNode),new t(r.inputOutput,"specularTextureMapping",new e.SFString),new t(r.inputOutput,"emissiveColor",new e.SFColor),new t(r.inputOutput,"emissiveTexture",new e.SFNode),new t(r.inputOutput,"emissiveTextureMapping",new e.SFString),new t(r.inputOutput,"shininess",new e.SFFloat(.2)),new t(r.inputOutput,"shininessTexture",new e.SFNode),new t(r.inputOutput,"shininessTextureMapping",new e.SFString),new t(r.inputOutput,"occlusionStrength",new e.SFFloat(1)),new t(r.inputOutput,"occlusionTexture",new e.SFNode),new t(r.inputOutput,"occlusionTextureMapping",new e.SFString),new t(r.inputOutput,"normalScale",new e.SFFloat(1)),new t(r.inputOutput,"normalTexture",new e.SFNode),new t(r.inputOutput,"normalTextureMapping",new e.SFString),new t(r.inputOutput,"transparency",new e.SFFloat)]),getTypeName:function(){return"Material"},getComponentName:function(){return"Shape"},getContainerField:function(){return"material"},initialize:function(){n.prototype.initialize.call(this),this.ambientIntensity_.addInterest("set_ambientIntensity__",this),this.diffuseColor_.addInterest("set_diffuseColor__",this),this.specularColor_.addInterest("set_specularColor__",this),this.shininess_.addInterest("set_shininess__",this),this.set_ambientIntensity__(),this.set_diffuseColor__(),this.set_specularColor__(),this.set_shininess__()},set_ambientIntensity__:function(){this.ambientIntensity=Math.max(this.ambientIntensity_.getValue(),0)},set_diffuseColor__:function(){const e=this.diffuseColor,t=this.diffuseColor_.getValue();e[0]=t.r,e[1]=t.g,e[2]=t.b},set_specularColor__:function(){const e=this.specularColor,t=this.specularColor_.getValue();e[0]=t.r,e[1]=t.g,e[2]=t.b},set_shininess__:function(){this.shininess=o.clamp(this.shininess_.getValue(),0,1)},getShader:function(e,t){return t?e.getShadowShader():e.getDefaultShader()},setShaderUniforms:function(e,t){e.uniform1f(t.x3d_AmbientIntensity,this.ambientIntensity),e.uniform3fv(t.x3d_DiffuseColor,this.diffuseColor),e.uniform3fv(t.x3d_SpecularColor,this.specularColor),e.uniform3fv(t.x3d_EmissiveColor,this.emissiveColor),e.uniform1f(t.x3d_Shininess,this.shininess),e.uniform1f(t.x3d_Transparency,this.transparency)}}),s}),define("x_ite/Components/Shape/TwoSidedMaterial",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Shape/X3DMaterialNode","x_ite/Base/X3DConstants","standard/Math/Algorithm"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),this.addType(r.TwoSidedMaterial),this.diffuseColor=new Float32Array(3),this.specularColor=new Float32Array(3),this.emissiveColor=new Float32Array(3),this.backDiffuseColor=new Float32Array(3),this.backSpecularColor=new Float32Array(3),this.backEmissiveColor=new Float32Array(3)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"separateBackColor",new e.SFBool),new t(r.inputOutput,"ambientIntensity",new e.SFFloat(.2)),new t(r.inputOutput,"diffuseColor",new e.SFColor(.8,.8,.8)),new t(r.inputOutput,"specularColor",new e.SFColor),new t(r.inputOutput,"emissiveColor",new e.SFColor),new t(r.inputOutput,"shininess",new e.SFFloat(.2)),new t(r.inputOutput,"transparency",new e.SFFloat),new t(r.inputOutput,"backAmbientIntensity",new e.SFFloat(.2)),new t(r.inputOutput,"backDiffuseColor",new e.SFColor(.8,.8,.8)),new t(r.inputOutput,"backSpecularColor",new e.SFColor),new t(r.inputOutput,"backEmissiveColor",new e.SFColor),new t(r.inputOutput,"backShininess",new e.SFFloat(.2)),new t(r.inputOutput,"backTransparency",new e.SFFloat)]),getTypeName:function(){return"TwoSidedMaterial"},getComponentName:function(){return"Shape"},getContainerField:function(){return"material"},initialize:function(){n.prototype.initialize.call(this),this.separateBackColor_.addInterest("set_transparent__",this),this.ambientIntensity_.addInterest("set_ambientIntensity__",this),this.diffuseColor_.addInterest("set_diffuseColor__",this),this.specularColor_.addInterest("set_specularColor__",this),this.emissiveColor_.addInterest("set_emissiveColor__",this),this.shininess_.addInterest("set_shininess__",this),this.transparency_.addInterest("set_transparency__",this),this.backAmbientIntensity_.addInterest("set_backAmbientIntensity__",this),this.backDiffuseColor_.addInterest("set_backDiffuseColor__",this),this.backSpecularColor_.addInterest("set_backSpecularColor__",this),this.backEmissiveColor_.addInterest("set_backEmissiveColor__",this),this.backShininess_.addInterest("set_backShininess__",this),this.backTransparency_.addInterest("set_backTransparency__",this),this.set_ambientIntensity__(),this.set_diffuseColor__(),this.set_specularColor__(),this.set_emissiveColor__(),this.set_shininess__(),this.set_transparency__(),this.set_backAmbientIntensity__(),this.set_backDiffuseColor__(),this.set_backSpecularColor__(),this.set_backEmissiveColor__(),this.set_backShininess__(),this.set_backTransparency__()},set_ambientIntensity__:function(){this.ambientIntensity=Math.max(this.ambientIntensity_.getValue(),0)},set_diffuseColor__:function(){const e=this.diffuseColor,t=this.diffuseColor_.getValue();e[0]=t.r,e[1]=t.g,e[2]=t.b},set_specularColor__:function(){const e=this.specularColor,t=this.specularColor_.getValue();e[0]=t.r,e[1]=t.g,e[2]=t.b},set_emissiveColor__:function(){const e=this.emissiveColor,t=this.emissiveColor_.getValue();e[0]=t.r,e[1]=t.g,e[2]=t.b},set_shininess__:function(){this.shininess=o.clamp(this.shininess_.getValue(),0,1)},set_transparency__:function(){this.transparency=o.clamp(this.transparency_.getValue(),0,1),this.set_transparent__()},set_backAmbientIntensity__:function(){this.backAmbientIntensity=Math.max(this.backAmbientIntensity_.getValue(),0)},set_backDiffuseColor__:function(){const e=this.backDiffuseColor,t=this.backDiffuseColor_.getValue();e[0]=t.r,e[1]=t.g,e[2]=t.b},set_backSpecularColor__:function(){const e=this.backSpecularColor,t=this.backSpecularColor_.getValue();e[0]=t.r,e[1]=t.g,e[2]=t.b},set_backEmissiveColor__:function(){const e=this.backEmissiveColor,t=this.backEmissiveColor_.getValue();e[0]=t.r,e[1]=t.g,e[2]=t.b},set_backShininess__:function(){this.backShininess=o.clamp(this.backShininess_.getValue(),0,1)},set_backTransparency__:function(){this.backTransparency=o.clamp(this.backTransparency_.getValue(),0,1),this.set_transparent__()},set_transparent__:function(){this.setTransparent(Boolean(this.transparency_.getValue()||this.separateBackColor_.getValue()&&this.backTransparency_.getValue()))},getShader:function(e,t){return t?e.getShadowShader():e.getDefaultShader()},setShaderUniforms:function(e,t,i){!i&&this.separateBackColor_.getValue()?(e.uniform1f(t.x3d_AmbientIntensity,this.backAmbientIntensity),e.uniform3fv(t.x3d_DiffuseColor,this.backDiffuseColor),e.uniform3fv(t.x3d_SpecularColor,this.backSpecularColor),e.uniform3fv(t.x3d_EmissiveColor,this.backEmissiveColor),e.uniform1f(t.x3d_Shininess,this.backShininess),e.uniform1f(t.x3d_Transparency,this.backTransparency)):(e.uniform1f(t.x3d_AmbientIntensity,this.ambientIntensity),e.uniform3fv(t.x3d_DiffuseColor,this.diffuseColor),e.uniform3fv(t.x3d_SpecularColor,this.specularColor),e.uniform3fv(t.x3d_EmissiveColor,this.emissiveColor),e.uniform1f(t.x3d_Shininess,this.shininess),e.uniform1f(t.x3d_Transparency,this.transparency))}}),s}),define("x_ite/Components/Shape",["x_ite/Configuration/SupportedNodes","x_ite/Components/Shape/Appearance","x_ite/Components/Shape/FillProperties","x_ite/Components/Shape/LineProperties","x_ite/Components/Shape/Material","x_ite/Components/Shape/PointProperties","x_ite/Components/Shape/Shape","x_ite/Components/Shape/TwoSidedMaterial","x_ite/Components/Shape/UnlitMaterial","x_ite/Components/Shape/X3DAppearanceChildNode","x_ite/Components/Shape/X3DAppearanceNode","x_ite/Components/Shape/X3DMaterialNode","x_ite/Components/Shape/X3DOneSidedMaterialNode","x_ite/Components/Shape/X3DShapeNode"],function(e,t,i,n,r,o,s,a,u,l,c,h,d,p){"use strict";const f={Appearance:t,FillProperties:i,LineProperties:n,Material:r,PointProperties:o,Shape:s,TwoSidedMaterial:a,UnlitMaterial:u},g={X3DAppearanceChildNode:l,X3DAppearanceNode:c,X3DMaterialNode:h,X3DOneSidedMaterialNode:d,X3DShapeNode:p};for(const t in f)e.addType(t,f[t]);for(const t in g)e.addAbstractType(t,g[t])}),define("x_ite/Components/Sound/X3DSoundSourceNode",["x_ite/Fields","x_ite/Components/Core/X3DChildNode","x_ite/Components/Time/X3DTimeDependentNode","x_ite/Base/X3DConstants","standard/Math/Algorithm"],function(e,t,i,n,r){"use strict";function o(e){t.call(this,e),i.call(this,e),this.addType(n.X3DSoundSourceNode),this.volume=0,this.media=null}return o.prototype=Object.assign(Object.create(t.prototype),i.prototype,{constructor:o,initialize:function(){t.prototype.initialize.call(this),i.prototype.initialize.call(this)},set_live__:function(){i.prototype.set_live__.call(this),this.getDisabled()?(this.getBrowser().volume_.removeInterest("set_volume__",this),this.getBrowser().mute_.removeInterest("set_volume__",this)):(this.getBrowser().volume_.addInterest("set_volume__",this),this.getBrowser().mute_.addInterest("set_volume__",this),this.set_volume__())},setMedia:function(e){if(this.media&&(this.media[0].volume=0,this.media[0].pause()),this.media=e,e){const t=e[0];t.loop=this.loop_.getValue(),this.setVolume(0),this.duration_changed_=t.duration,this.resetElapsedTime(),this.isActive_.getValue()?this.isPaused_.getValue()?this.set_pause():this.getLiveState()?this.set_start():this.set_pause():this.set_stop()}},getMedia:function(){return this.media},setVolume:function(e){this.volume=r.clamp(e,0,1),this.set_volume__()},set_loop:function(){this.media&&(this.media[0].loop=this.loop_.getValue())},set_volume__:function(){if(this.media){const e=this.getBrowser().mute_.getValue(),t=r.clamp(this.getBrowser().volume_.getValue(),0,1),i=!e*t*this.volume;this.media[0].volume=i}},set_speed:function(){},set_pitch:function(){},set_start:function(){this.media&&this.speed_.getValue()&&(this.media[0].currentTime=0,this.media[0].play())},set_pause:function(){this.media&&this.media[0].pause()},set_resume:function(){this.media&&this.speed_.getValue()&&this.media[0].play()},set_stop:function(){this.media&&this.media[0].pause()},set_ended:function(){if(this.media){const e=this.media[0];if(e.currentTime<e.duration)return;this.loop_.getValue()||this.stop()}},set_time:function(){this.media&&(this.elapsedTime_=this.getElapsedTime()),this.set_ended()}}),o}),define("x_ite/Components/Sound/AudioClip",["jquery","x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Sound/X3DSoundSourceNode","x_ite/Components/Networking/X3DUrlObject","x_ite/Base/X3DConstants","x_ite/DEBUG"],function(e,t,i,n,r,o,s,a){"use strict";function u(i){r.call(this,i),o.call(this,i),this.addType(s.AudioClip),this.addChildObjects("speed",new t.SFFloat(1)),this.audio=e("<audio></audio>"),this.urlStack=new t.MFString}return u.prototype=Object.assign(Object.create(r.prototype),o.prototype,{constructor:u,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new n([new i(s.inputOutput,"metadata",new t.SFNode),new i(s.inputOutput,"description",new t.SFString),new i(s.inputOutput,"enabled",new t.SFBool(!0)),new i(s.inputOutput,"load",new t.SFBool(!0)),new i(s.inputOutput,"url",new t.MFString),new i(s.inputOutput,"autoRefresh",new t.SFTime),new i(s.inputOutput,"autoRefreshTimeLimit",new t.SFTime(3600)),new i(s.inputOutput,"gain",new t.SFFloat(1)),new i(s.inputOutput,"pitch",new t.SFFloat(1)),new i(s.inputOutput,"loop",new t.SFBool),new i(s.inputOutput,"startTime",new t.SFTime),new i(s.inputOutput,"resumeTime",new t.SFTime),new i(s.inputOutput,"pauseTime",new t.SFTime),new i(s.inputOutput,"stopTime",new t.SFTime),new i(s.outputOnly,"isPaused",new t.SFBool),new i(s.outputOnly,"isActive",new t.SFBool),new i(s.outputOnly,"elapsedTime",new t.SFTime),new i(s.outputOnly,"duration_changed",new t.SFTime(-1))]),getTypeName:function(){return"AudioClip"},getComponentName:function(){return"Sound"},getContainerField:function(){return"source"},initialize:function(){r.prototype.initialize.call(this),o.prototype.initialize.call(this),this.audio.on("error",this.setError.bind(this)),this.audio[0].preload="auto",this.audio[0].volume=0,this.audio[0].crossOrigin="Anonymous",this.requestImmediateLoad()},getElement:function(){return this.audio[0]},set_live__:function(){r.prototype.set_live__.call(this),o.prototype.set_live__.call(this)},unloadNow:function(){this.setMedia(null)},loadNow:function(){this.setMedia(null),this.urlStack.setValue(this.urlBuffer_),this.audio.bind("canplaythrough",this.setAudio.bind(this)),this.loadNext()},loadNext:function(){if(0===this.urlStack.length)return this.audio.unbind("canplaythrough"),this.duration_changed_=-1,void this.setLoadState(s.FAILED_STATE);this.URL=new URL(this.urlStack.shift(),this.getExecutionContext().getWorldURL()),this.getBrowser().getBrowserOptions().getCache()&&this.getCache()||this.URL.searchParams.set("_",Date.now()),this.audio.attr("src",this.URL.href),this.audio.get(0).load()},setError:function(){"data:"!==this.URL.protocol&&console.warn("Error loading audio:",this.URL.href),this.loadNext()},setAudio:function(){a&&"data:"!==this.URL.protocol&&console.info("Done loading audio:",this.URL.href),this.audio.unbind("canplaythrough"),this.setMedia(this.audio),this.setLoadState(s.COMPLETE_STATE)}}),u}),define("x_ite/Components/Sound/X3DSoundNode",["x_ite/Components/Core/X3DChildNode","x_ite/Base/X3DConstants"],function(e,t){"use strict";function i(i){e.call(this,i),this.addType(t.X3DSoundNode)}return i.prototype=Object.assign(Object.create(e.prototype),{constructor:i}),i}),define("x_ite/Components/Sound/Sound",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Sound/X3DSoundNode","x_ite/Base/X3DCast","x_ite/Rendering/TraverseType","x_ite/Base/X3DConstants","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Line3","standard/Math/Geometry/Sphere3","standard/Math/Algorithm"],function(e,t,i,n,r,o,s,a,u,l,c,h,d){"use strict";function p(t){n.call(this,t),this.addType(s.Sound),this.addChildObjects("traversed",new e.SFBool(!0)),this.location_.setUnit("length"),this.minBack_.setUnit("length"),this.minFront_.setUnit("length"),this.maxBack_.setUnit("length"),this.maxFront_.setUnit("length"),this.currentTraversed=!0}return p.prototype=Object.assign(Object.create(n.prototype),{constructor:p,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOutput,"intensity",new e.SFFloat(1)),new t(s.initializeOnly,"spatialize",new e.SFBool(!0)),new t(s.inputOutput,"location",new e.SFVec3f),new t(s.inputOutput,"direction",new e.SFVec3f(0,0,1)),new t(s.inputOutput,"minBack",new e.SFFloat(1)),new t(s.inputOutput,"minFront",new e.SFFloat(1)),new t(s.inputOutput,"maxBack",new e.SFFloat(10)),new t(s.inputOutput,"maxFront",new e.SFFloat(10)),new t(s.inputOutput,"priority",new e.SFFloat),new t(s.inputOutput,"source",new e.SFNode)]),getTypeName:function(){return"Sound"},getComponentName:function(){return"Sound"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.isLive().addInterest("set_live__",this),this.traversed_.addInterest("set_live__",this),this.source_.addInterest("set_source__",this),this.set_live__(),this.set_source__()},setTraversed:function(e){e?this.traversed_.getValue()===!1&&(this.traversed_=!0):this.currentTraversed!==this.traversed_.getValue()&&(this.traversed_=this.currentTraversed),this.currentTraversed=e},getTraversed:function(){return this.currentTraversed},set_live__:function(){this.isLive().getValue()&&this.traversed_.getValue()?this.getBrowser().sensorEvents().addInterest("update",this):this.getBrowser().sensorEvents().removeInterest("update",this)},set_source__:function(){this.sourceNode&&this.sourceNode.setVolume(0),this.sourceNode=r(s.X3DSoundSourceNode,this.source_)},update:function(){this.getTraversed()||this.sourceNode&&this.sourceNode.setVolume(0),this.setTraversed(!1)},traverse:function(){const e={distance:0,intersection:new a(0,0,0)},t={distance:0,intersection:new a(0,0,0)};return function(i,n){try{if(i!==o.DISPLAY)return;if(!this.sourceNode)return;if(!this.sourceNode.isActive_.getValue()||this.sourceNode.isPaused_.getValue())return;this.setTraversed(!0);const r=n.getModelViewMatrix().get();if(this.getEllipsoidParameter(r,Math.max(this.maxBack_.getValue(),0),Math.max(this.maxFront_.getValue(),0),t),t.distance<1)if(this.getEllipsoidParameter(r,Math.max(this.minBack_.getValue(),0),Math.max(this.minFront_.getValue(),0),e),e.distance<1)this.sourceNode.setVolume(this.intensity_.getValue());else{const i=t.intersection.abs(),n=t.intersection.distance(e.intersection),r=Math.min(i/n,1),o=d.clamp(this.intensity_.getValue(),0,1),s=o*r;this.sourceNode.setVolume(s)}else this.sourceNode.setVolume(0)}catch(e){this.sourceNode&&this.sourceNode.setVolume(0)}}}(),getEllipsoidParameter:function(){const e=new a(0,0,0),t=new l,i=new l,n=new u,r=new a(1,1,1),o=new h(1,a.Zero),s=new a(0,0,0),d=new c(a.Zero,a.zAxis),p=new a(0,0,0),f=new a(0,0,0);return function(u,l,c,h){if(0==l||0==c)return t.multVecMatrix(h.intersection.assign(this.location_.getValue())),void(h.distance=1);const g=(l+c)/2,m=g-l,y=Math.sqrt(g*g-m*m);e.set(0,0,m),r.set(y,y,g),n.setFromToVec(a.zAxis,this.direction_.getValue()),t.assign(u).translate(this.location_.getValue()).rotate(n).translate(e).scale(r),i.assign(t).inverse();const _=i.origin;e.negate().divVec(r),s.assign(e).subtract(_).normalize(),d.set(_,s),o.intersectsLine(d,p,f),h.intersection.assign(t.multVecMatrix(p)),h.distance=_.abs()}}()}),p}),define("x_ite/Components/Sound",["x_ite/Configuration/SupportedNodes","x_ite/Components/Sound/AudioClip","x_ite/Components/Sound/Sound","x_ite/Components/Sound/X3DSoundNode","x_ite/Components/Sound/X3DSoundSourceNode"],function(e,t,i,n,r){"use strict";const o={AudioClip:t,Sound:i},s={X3DSoundNode:n,X3DSoundSourceNode:r};for(const t in o)e.addType(t,o[t]);for(const t in s)e.addAbstractType(t,s[t])}),define("x_ite/Components/Text/Text",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Rendering/X3DGeometryNode","x_ite/Base/X3DCast","x_ite/Base/X3DConstants"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),this.addType(o.Text),this.length_.setUnit("length"),this.maxExtent_.setUnit("length"),this.origin_.setUnit("length"),this.textBounds_.setUnit("length"),this.lineBounds_.setUnit("length")}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOutput,"string",new e.MFString),new t(o.inputOutput,"length",new e.MFFloat),new t(o.inputOutput,"maxExtent",new e.SFFloat),new t(o.initializeOnly,"solid",new e.SFBool),new t(o.outputOnly,"origin",new e.SFVec3f),new t(o.outputOnly,"textBounds",new e.SFVec2f),new t(o.outputOnly,"lineBounds",new e.MFVec2f),new t(o.inputOutput,"fontStyle",new e.SFNode)]),getTypeName:function(){return"Text"},getComponentName:function(){return"Text"},getContainerField:function(){return"geometry"},initialize:function(){n.prototype.initialize.call(this),this.fontStyle_.addInterest("set_fontStyle__",this),this.set_fontStyle__()},getMatrix:function(){return this.textGeometry.getMatrix()},getLength:function(e){return e<this.length_.length?Math.max(0,this.length_[e]):0},set_live__:function(){n.prototype.set_live__.call(this),this.isLive().getValue()?this.getBrowser().getBrowserOptions().PrimitiveQuality_.addInterest("requestRebuild",this):this.getBrowser().getBrowserOptions().PrimitiveQuality_.removeInterest("requestRebuild",this)},set_fontStyle__:function(){this.fontStyleNode&&this.fontStyleNode.removeInterest("requestRebuild",this),this.fontStyleNode=r(o.X3DFontStyleNode,this.fontStyle_),this.fontStyleNode||(this.fontStyleNode=this.getBrowser().getDefaultFontStyle()),this.fontStyleNode.addInterest("requestRebuild",this),this.textGeometry=this.fontStyleNode.getTextGeometry(this),this.setTransparent(this.textGeometry.getTransparent())},build:function(){this.textGeometry.update(),this.textGeometry.build(),this.setSolid(this.solid_.getValue())},traverse:function(e,t){try{this.textGeometry.traverse(e,t),n.prototype.traverse.call(this,e,t)}catch(e){console.log(e)}},display:function(e,t){try{this.textGeometry.display(e,t),n.prototype.display.call(this,e,t)}catch(e){console.log(e)}},transformLine:function(e){return this.textGeometry.transformLine(e)},transformMatrix:function(e){return this.textGeometry.transformMatrix(e)}}),s}),
define("x_ite/Components/Text",["x_ite/Configuration/SupportedNodes","x_ite/Components/Text/FontStyle","x_ite/Components/Text/Text","x_ite/Components/Text/X3DFontStyleNode"],function(e,t,i,n){"use strict";const r={FontStyle:t,Text:i},o={X3DFontStyleNode:n};for(const t in r)e.addType(t,r[t]);for(const t in o)e.addAbstractType(t,o[t])}),define("x_ite/Components/Texturing/MovieTexture",["jquery","x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Texturing/X3DTexture2DNode","x_ite/Components/Sound/X3DSoundSourceNode","x_ite/Components/Networking/X3DUrlObject","x_ite/Base/X3DConstants","standard/Math/Algorithm","x_ite/DEBUG"],function(e,t,i,n,r,o,s,a,u,l){"use strict";function c(i){r.call(this,i),o.call(this,i),s.call(this,i),this.addType(a.MovieTexture),this.canvas=e("<canvas></canvas>"),this.video=e("<video></video>"),this.urlStack=new t.MFString}return c.prototype=Object.assign(Object.create(r.prototype),o.prototype,s.prototype,{constructor:c,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new n([new i(a.inputOutput,"metadata",new t.SFNode),new i(a.inputOutput,"description",new t.SFString),new i(a.inputOutput,"enabled",new t.SFBool(!0)),new i(a.inputOutput,"load",new t.SFBool(!0)),new i(a.inputOutput,"url",new t.MFString),new i(a.inputOutput,"autoRefresh",new t.SFTime),new i(a.inputOutput,"autoRefreshTimeLimit",new t.SFTime(3600)),new i(a.inputOutput,"gain",new t.SFFloat(1)),new i(a.inputOutput,"speed",new t.SFFloat(1)),new i(a.inputOutput,"pitch",new t.SFFloat(1)),new i(a.inputOutput,"loop",new t.SFBool),new i(a.inputOutput,"startTime",new t.SFTime),new i(a.inputOutput,"resumeTime",new t.SFTime),new i(a.inputOutput,"pauseTime",new t.SFTime),new i(a.inputOutput,"stopTime",new t.SFTime),new i(a.outputOnly,"isPaused",new t.SFBool),new i(a.outputOnly,"isActive",new t.SFBool),new i(a.outputOnly,"elapsedTime",new t.SFTime),new i(a.outputOnly,"duration_changed",new t.SFTime(-1)),new i(a.initializeOnly,"repeatS",new t.SFBool(!0)),new i(a.initializeOnly,"repeatT",new t.SFBool(!0)),new i(a.initializeOnly,"textureProperties",new t.SFNode)]),getTypeName:function(){return"MovieTexture"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"texture"},initialize:function(){r.prototype.initialize.call(this),o.prototype.initialize.call(this),s.prototype.initialize.call(this),this.video.on("error",this.setError.bind(this)),this.video[0].preload="auto",this.video[0].volume=0,this.video[0].crossOrigin="Anonymous",this.requestImmediateLoad()},getElement:function(){return this.video[0]},set_live__:function(){o.prototype.set_live__.call(this),s.prototype.set_live__.call(this)},unloadNow:function(){this.clearTexture()},loadNow:function(){this.setMedia(null),this.urlStack.setValue(this.urlBuffer_),this.video.bind("canplaythrough",this.setVideo.bind(this)),this.loadNext()},loadNext:function(){if(0===this.urlStack.length)return this.video.unbind("canplaythrough"),this.duration_changed_=-1,this.clearTexture(),void this.setLoadState(a.FAILED_STATE);this.URL=new URL(this.urlStack.shift(),this.getExecutionContext().getWorldURL()),this.getBrowser().getBrowserOptions().getCache()&&this.getCache()||this.URL.searchParams.set("_",Date.now()),this.video.attr("src",this.URL.href),this.video.get(0).load()},setError:function(){"data:"!==this.URL.protocol&&console.warn("Error loading movie:",this.URL.href),this.loadNext()},setVideo:function(){l&&"data:"!==this.URL.protocol&&console.info("Done loading movie:",this.URL.href);try{this.video.unbind("canplaythrough");const e=this.video[0],t=e.videoWidth,i=e.videoHeight,n=this.canvas[0],r=n.getContext("2d");if(!u.isPowerOfTwo(t)||!u.isPowerOfTwo(i))throw new Error("The movie texture is a non power-of-two texture.");n.width=t,n.height=i,r.drawImage(e,0,0);const o=r.getImageData(0,0,t,i).data;setTimeout(function(){this.setMedia(this.video),this.setTexture(t,i,!1,new Uint8Array(o),!0),this.setLoadState(a.COMPLETE_STATE)}.bind(this),16)}catch(e){console.log(e.message),this.setError()}},set_time:function(){o.prototype.set_time.call(this),this.checkLoadState()===a.COMPLETE_STATE&&this.updateTexture(this.getMedia()[0],!0)},traverse:r.prototype.traverse}),c}),define("x_ite/Components/Texturing/MultiTexture",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Texturing/X3DTextureNode","x_ite/Base/X3DConstants","x_ite/Base/X3DCast","x_ite/Browser/Texturing/MultiTextureModeType","x_ite/Browser/Texturing/MultiTextureSourceType","x_ite/Browser/Texturing/MultiTextureFunctionType"],function(e,t,i,n,r,o,s,a,u){"use strict";function l(t){n.call(this,t),this.addType(r.MultiTexture),this.addChildObjects("loadState",new e.SFInt32(r.NOT_STARTED_STATE)),this.color=new Float32Array(4),this.modes=[],this.alphaModes=[],this.sources=[],this.functions=[],this.textureNodes=[]}return l.prototype=Object.assign(Object.create(n.prototype),{constructor:l,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"description",new e.SFString),new t(r.inputOutput,"color",new e.SFColor(1,1,1)),new t(r.inputOutput,"alpha",new e.SFFloat(1)),new t(r.inputOutput,"mode",new e.MFString),new t(r.inputOutput,"source",new e.MFString),new t(r.inputOutput,"function",new e.MFString),new t(r.inputOutput,"texture",new e.MFNode)]),getTypeName:function(){return"MultiTexture"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"texture"},initialize:function(){n.prototype.initialize.call(this),this.color_.addInterest("set_color__",this),this.alpha_.addInterest("set_alpha__",this),this.mode_.addInterest("set_mode__",this),this.source_.addInterest("set_source__",this),this.function_.addInterest("set_function__",this),this.texture_.addInterest("set_texture__",this),this.set_color__(),this.set_alpha__(),this.set_mode__(),this.set_source__(),this.set_function__(),this.set_texture__(),this.loadState_=r.COMPLETE_STATE},getMode:function(e){return e<this.modes.length?this.modes[e]:s.MODULATE},getAlphaMode:function(e){return e<this.alphaModes.length?this.alphaModes[e]:s.MODULATE},getSource:function(e){return e<this.sources.length?this.sources[e]:a.DEFAULT},getFunction:function(e){return e<this.functions.length?this.functions[e]:u.DEFAULT},set_color__:function(){this.color[0]=this.color_.r,this.color[1]=this.color_.g,this.color[2]=this.color_.b},set_alpha__:function(){this.color[3]=this.alpha_},set_mode__:function(){const e=new Map([["REPLACE",s.REPLACE],["MODULATE",s.MODULATE],["MODULATE2X",s.MODULATE2X],["MODULATE4X",s.MODULATE4X],["ADD",s.ADD],["ADDSIGNED",s.ADDSIGNED],["ADDSIGNED2X",s.ADDSIGNED2X],["ADDSMOOTH",s.ADDSMOOTH],["SUBTRACT",s.SUBTRACT],["BLENDDIFFUSEALPHA",s.BLENDDIFFUSEALPHA],["BLENDTEXTUREALPHA",s.BLENDTEXTUREALPHA],["BLENDFACTORALPHA",s.BLENDFACTORALPHA],["BLENDCURRENTALPHA",s.BLENDCURRENTALPHA],["MODULATEALPHA_ADDCOLOR",s.MODULATEALPHA_ADDCOLOR],["MODULATEINVALPHA_ADDCOLOR",s.MODULATEINVALPHA_ADDCOLOR],["MODULATEINVCOLOR_ADDALPHA",s.MODULATEINVCOLOR_ADDALPHA],["DOTPRODUCT3",s.DOTPRODUCT3],["SELECTARG1",s.SELECTARG1],["SELECTARG2",s.SELECTARG2],["OFF",s.OFF]]);return function(){this.modes.length=0,this.alphaModes.length=0;for(const t of this.mode_){const i=t.split(",");for(let e=0,t=i.length;e<t;++e)i[e]=i[e].trim();0===i.length&&i.push("MODULATE"),i.length<2&&i.push(i[0]);const n=e.get(i[0]);void 0!==n?this.modes.push(n):this.modes.push(s.MODULATE);const r=e.get(i[1]);void 0!==r?this.alphaModes.push(r):this.alphaModes.push(s.MODULATE)}}}(),set_source__:function(){const e=new Map([["DIFFUSE",a.DIFFUSE],["SPECULAR",a.SPECULAR],["FACTOR",a.FACTOR]]);return function(){this.sources.length=0;for(const t of this.source_){const i=e.get(t);void 0!==i?this.sources.push(i):this.sources.push(a.DEFAULT)}}}(),set_function__:function(){const e=new Map([["COMPLEMENT",u.COMPLEMENT],["ALPHAREPLICATE",u.ALPHAREPLICATE]]);return function(){this.functions.length=0;for(const t of this.function_){const i=e.get(t);void 0!==i?this.functions.push(i):this.functions.push(u.DEFAULT)}}}(),set_texture__:function(){this.textureNodes.length=0;for(const e of this.texture_){const t=o(r.X3DSingleTextureNode,e);t&&this.textureNodes.push(t)}},traverse:function(e,t){for(const i of this.textureNodes)i.traverse(e,t)},setShaderUniforms:function(e,t,i){const n=this.textureNodes,r=Math.min(t.getBrowser().getMaxTextures(),n.length);e.uniform1i(t.x3d_NumTextures,r),e.uniform4fv(t.x3d_MultiTextureColor,this.color);for(let o=0;o<r;++o)n[o].setShaderUniformsToChannel(e,t,i,o),e.uniform1i(t.x3d_MultiTextureMode[o],this.getMode(o)),e.uniform1i(t.x3d_MultiTextureAlphaMode[o],this.getAlphaMode(o)),e.uniform1i(t.x3d_MultiTextureSource[o],this.getSource(o)),e.uniform1i(t.x3d_MultiTextureFunction[o],this.getFunction(o))}}),l}),define("x_ite/Components/Texturing/MultiTextureCoordinate",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Texturing/X3DTextureCoordinateNode","x_ite/Base/X3DConstants","x_ite/Base/X3DCast"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),this.addType(r.MultiTextureCoordinate),this.textureCoordinateNodes=[]}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"texCoord",new e.MFNode)]),getTypeName:function(){return"MultiTextureCoordinate"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"texCoord"},initialize:function(){n.prototype.initialize.call(this),this.texCoord_.addInterest("set_texCoord__",this),this.set_texCoord__()},set_texCoord__:function(){const e=this.textureCoordinateNodes;for(const t of e)t.removeInterest("addNodeEvent",this);e.length=0;for(const t of this.texCoord_){const i=o(r.X3DSingleTextureCoordinateNode,t);i&&e.push(i)}for(const t of e)t.addInterest("addNodeEvent",this)},isEmpty:function(){return!0},getSize:function(){return 0},get1Point:function(e,t){for(const i of this.textureCoordinateNodes)return i.get1Point(e,t);return t.set(0,0,0,1)},init:function(e){for(const t of this.textureCoordinateNodes)t.init(e)},addTexCoord:function(e,t){const i=this.textureCoordinateNodes;for(let n=0,r=i.length;n<r;++n)i[n].addTexCoordToChannel(e,t[n])},addTexCoordToChannel:function(e,t){},getTexCoord:function(e){for(const t of this.textureCoordinateNodes)return t.getTexCoord(e);return e},setShaderUniforms:function(e,t){const i=this.textureCoordinateNodes,n=Math.min(t.x3d_MaxTextures,i.length);for(let r=0;r<n;++r)i[r].setShaderUniformsToChannel(e,t,r);const r=n?i.at(-1):this;for(let o=n,s=t.x3d_MaxTextures;o<s;++o)i[r].setShaderUniformsToChannel(e,t,o)}}),s}),define("x_ite/Components/Texturing/MultiTextureTransform",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Texturing/X3DTextureTransformNode","x_ite/Base/X3DConstants","x_ite/Base/X3DCast"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),this.addType(r.MultiTextureTransform),this.textureTransformNodes=[]}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"textureTransform",new e.MFNode)]),getTypeName:function(){return"MultiTextureTransform"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"textureTransform"},initialize:function(){n.prototype.initialize.call(this),this.textureTransform_.addInterest("set_textureTransform__",this),this.set_textureTransform__()},set_textureTransform__:function(){const e=this.textureTransformNodes;e.length=0;for(const t of this.textureTransform_){const i=o(r.X3DSingleTextureTransformNode,t);i&&e.push(i)}},setShaderUniforms:function(e,t){const i=this.textureTransformNodes,n=Math.min(t.x3d_MaxTextures,i.length);for(let r=0;r<n;++r)i[r].setShaderUniformsToChannel(e,t,r);const r=n?i.at(-1):this;for(let i=n,o=t.x3d_MaxTextures;i<o;++i)r.setShaderUniformsToChannel(e,t,i)}}),s});define("x_ite/Components/Texturing/PixelTexture",["jquery","x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Texturing/X3DTexture2DNode","x_ite/Base/X3DConstants","standard/Math/Algorithm","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix3"],function(e,t,i,n,r,o,s){"use strict";function a(e){r.call(this,e),this.addType(o.PixelTexture),this.addChildObjects("loadState",new t.SFInt32(o.NOT_STARTED_STATE))}return a.prototype=Object.assign(Object.create(r.prototype),{constructor:a,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new n([new i(o.inputOutput,"metadata",new t.SFNode),new i(o.inputOutput,"description",new t.SFString),new i(o.inputOutput,"image",new t.SFImage(0,0,0,new t.MFInt32)),new i(o.initializeOnly,"repeatS",new t.SFBool(!0)),new i(o.initializeOnly,"repeatT",new t.SFBool(!0)),new i(o.initializeOnly,"textureProperties",new t.SFNode)]),getTypeName:function(){return"PixelTexture"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"texture"},initialize:function(){r.prototype.initialize.call(this),this.image_.addInterest("set_image__",this),this.canvas1=e("<canvas></canvas>"),this.canvas2=e("<canvas></canvas>"),this.set_image__()},checkLoadState:function(){return this.loadState_.getValue()},convert:function(e,t,i,n){switch(t){case 1:for(let t=0,r=0;t<n;++t,r+=4){const n=i[t];e[r]=e[r+1]=e[r+2]=255&n,e[r+3]=255}break;case 2:for(let t=0,r=0;t<n;++t,r+=4){const n=i[t];e[r]=e[r+1]=e[r+2]=n>>>8&255,e[r+3]=255&n}break;case 3:for(let t=0,r=0;t<n;++t,r+=4){const n=i[t];e[r]=n>>>16&255,e[r+1]=n>>>8&255,e[r+2]=255&n,e[r+3]=255}break;case 4:for(let t=0,r=0;t<n;++t,r+=4){const n=i[t];e[r]=n>>>24,e[r+1]=n>>>16&255,e[r+2]=n>>>8&255,e[r+3]=255&n}}},resize:function(e,t,i,n,r){const o=new Uint8Array(n*r*4),s=n/t,a=r/i;for(let i=0;i<r;++i){const r=Math.floor(i/a)*t,u=i*n;for(let t=0;t<n;++t){const i=4*(r+Math.floor(t/s)),n=4*(u+t);o[n]=e[i],o[n+1]=e[i+1],o[n+2]=e[i+2],o[n+3]=e[i+3]}}return o},set_image__:function(){const e=this.getBrowser().getContext(),t=this.image_.comp,i=this.image_.array,n=!(t%2);let r=this.image_.width,a=this.image_.height,u=null;if(r>0&&a>0&&t>0&&t<5){if(e.getVersion()>=2||s.isPowerOfTwo(r)&&s.isPowerOfTwo(a))u=new Uint8Array(r*a*4),this.convert(u,t,i.getValue(),i.length);else if(Math.max(r,a)<this.getBrowser().getMinTextureSize()&&!this.textureProperties_.getValue()){u=new Uint8Array(r*a*4),this.convert(u,t,i.getValue(),i.length);const e=r,n=a;r=4*s.nextPowerOfTwo(e),a=4*s.nextPowerOfTwo(n),u=this.resize(u,e,n,r,a)}else{const e=this.canvas1[0],n=this.canvas2[0],o=e.getContext("2d"),l=n.getContext("2d"),c=o.createImageData(r,a);e.width=r,e.height=a,this.convert(c.data,t,i,i.length),o.putImageData(c,0,0),r=s.nextPowerOfTwo(r),a=s.nextPowerOfTwo(a),n.width=r,n.height=a,l.clearRect(0,0,r,a),l.drawImage(e,0,0,e.width,e.height,0,0,r,a),u=l.getImageData(0,0,r,a).data}this.setTexture(r,a,n,new Uint8Array(u),!1),this.loadState_=o.COMPLETE_STATE}else this.clearTexture(),this.loadState_=o.FAILED_STATE}}),a}),define("x_ite/Components/Texturing/TextureCoordinateGenerator",["x_ite/Fields","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Components/Texturing/X3DSingleTextureCoordinateNode","x_ite/Base/X3DConstants","x_ite/Browser/Texturing/TextureCoordinateGeneratorModeType"],function(e,t,i,n,r,o){"use strict";function s(e){n.call(this,e),this.addType(r.TextureCoordinateGenerator),this.mode=o.SPHERE,this.parameter=new Float32Array(6)}return s.prototype=Object.assign(Object.create(n.prototype),{constructor:s,[Symbol.for("X3DBaseNode.fieldDefinitions")]:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"mapping",new e.SFString),new t(r.inputOutput,"mode",new e.SFString("SPHERE")),new t(r.inputOutput,"parameter",new e.MFFloat)]),getTypeName:function(){return"TextureCoordinateGenerator"},getComponentName:function(){return"Texturing"},getContainerField:function(){return"texCoord"},initialize:function(){n.prototype.initialize.call(this),this.mode_.addInterest("set_mode__",this),this.parameter_.addInterest("set_parameter__",this),this.set_mode__(),this.set_parameter__()},set_mode__:function(){const e=new Map([["SPHERE",o.SPHERE],["CAMERASPACENORMAL",o.CAMERASPACENORMAL],["CAMERASPACEPOSITION",o.CAMERASPACEPOSITION],["CAMERASPACEREFLECTIONVECTOR",o.CAMERASPACEREFLECTIONVECTOR],["SPHERE-LOCAL",o.SPHERE_LOCAL],["COORD",o.COORD],["COORD-EYE",o.COORD_EYE],["NOISE",o.NOISE],["NOISE-EYE",o.NOISE_EYE],["SPHERE-REFLECT",o.SPHERE_REFLECT],["SPHERE-REFLECT-LOCAL",o.SPHERE_REFLECT_LOCAL]]);return function(){this.mode=e.get(this.mode_.getValue()),void 0===this.mode&&(this.mode=o.SPHERE)}}(),set_parameter__:function(){const e=Math.min(this.parameter.length,this.parameter_.length);for(let t=0;t<e;++t)this.parameter[t]=this.parameter_[t];this.parameter.fill(0,e)},get1Point:function(e,t){return t},addTexCoordToChannel:function(e,t){t.push(0,0,0,1)},getTexCoord:function(e){return arrray},setShaderUniformsToChannel:function(e,t,i){e.uniform1i(t.x3d_TextureCoordinateGeneratorMode[i],this.mode),e.uniform1fv(t.x3d_TextureCoordinateGeneratorParameter[i],this.parameter)}}),s}),define("x_ite/Components/Texturing",["x_ite/Configuration/SupportedNodes","x_ite/Components/Texturing/ImageTexture","x_ite/Components/Texturing/MovieTexture","x_ite/Components/Texturing/MultiTexture","x_ite/Components/Texturing/MultiTextureCoordinate","x_ite/Components/Texturing/MultiTextureTransform","x_ite/Components/Texturing/PixelTexture","x_ite/Components/Texturing/TextureCoordinate","x_ite/Components/Texturing/TextureCoordinateGenerator","x_ite/Components/Texturing/TextureProperties","x_ite/Components/Texturing/TextureTransform","x_ite/Components/Texturing/X3DSingleTextureCoordinateNode","x_ite/Components/Texturing/X3DSingleTextureNode","x_ite/Components/Texturing/X3DSingleTextureTransformNode","x_ite/Components/Texturing/X3DTexture2DNode","x_ite/Components/Texturing/X3DTextureCoordinateNode","x_ite/Components/Texturing/X3DTextureNode","x_ite/Components/Texturing/X3DTextureTransformNode"],function(e,t,i,n,r,o,s,a,u,l,c,h,d,p,f,g,m,y){"use strict";const _={ImageTexture:t,MovieTexture:i,MultiTexture:n,MultiTextureCoordinate:r,MultiTextureTransform:o,PixelTexture:s,TextureCoordinate:a,TextureCoordinateGenerator:u,TextureProperties:l,TextureTransform:c},x={X3DSingleTextureCoordinateNode:h,X3DSingleTextureNode:d,X3DSingleTextureTransformNode:p,X3DTexture2DNode:f,X3DTextureCoordinateNode:g,X3DTextureNode:m,X3DTextureTransformNode:y};for(const t in _)e.addType(t,_[t]);for(const t in x)e.addAbstractType(t,x[t])}),define("x_ite/Components/Time",["x_ite/Configuration/SupportedNodes","x_ite/Components/Time/TimeSensor","x_ite/Components/Time/X3DTimeDependentNode"],function(e,t,i){"use strict";const n={TimeSensor:t},r={X3DTimeDependentNode:i};for(const t in n)e.addType(t,n[t]);for(const t in r)e.addAbstractType(t,r[t])}),define("x_ite/Components",["x_ite/DEBUG","x_ite/Browser/X3DBrowserContext","x_ite/Configuration/SupportedNodes","x_ite/Components/Core","x_ite/Components/EnvironmentalEffects","x_ite/Components/EnvironmentalSensor","x_ite/Components/Followers","x_ite/Components/Geometry3D","x_ite/Components/Grouping","x_ite/Components/Interpolation","x_ite/Components/Layering","x_ite/Components/Lighting","x_ite/Components/Navigation","x_ite/Components/Networking","x_ite/Components/PointingDeviceSensor","x_ite/Components/Rendering","x_ite/Components/Shaders","x_ite/Components/Shape","x_ite/Components/Sound","x_ite/Components/Text","x_ite/Components/Texturing","x_ite/Components/Time"],function(e,t,i){"use strict";function n(){}return n.prototype={addComponent:function(n){if(n.types)for(const e in n.types)i.addType(e,n.types[e]);if(n.abstractTypes)for(const e in n.abstractTypes)i.addAbstractType(e,n.abstractTypes[e]);n.browser&&t.addContext(n.browser),n.name&&e&&console.log("Done loading external component '"+n.name+"'.")}},new n}),define("x_ite/Configuration/ProfileInfo",["x_ite/Base/X3DObject"],function(e){"use strict";function t(e,t,i,n){this.name=e,this.title=t,this.providerUrl=i,this.components=n}t.prototype=Object.assign(Object.create(e.prototype),{constructor:t,getTypeName:function(){return"ProfileInfo"},toVRMLStream:function(e){e.string+="PROFILE",e.string+=" ",e.string+=this.name},toXMLStream:function(e){e.string+=this.name}});for(const e of Reflect.ownKeys(t.prototype))Object.defineProperty(t.prototype,e,{enumerable:!1});return t}),define("x_ite/Configuration/ProfileInfoArray",["x_ite/Configuration/ComponentInfoArray","x_ite/Configuration/ProfileInfo","x_ite/Base/X3DInfoArray"],function(e,t,i){"use strict";function n(){return i.call(this)}n.prototype=Object.assign(Object.create(i.prototype),{constructor:n,getTypeName:function(){return"ProfileInfoArray"},addProfile:function(i){this.add(i.name,new t(i.name,i.title,i.providerUrl,new e(i.components)))}});for(const e of Reflect.ownKeys(n.prototype))Object.defineProperty(n.prototype,e,{enumerable:!1});return n}),define("x_ite/Configuration/SupportedComponents",["x_ite/Configuration/ComponentInfoArray","x_ite/Browser/Networking/urls"],function(e,t){"use strict";const i=new e([]);return i.addComponent({title:"Annotation",name:"Annotation",level:2,providerUrl:t.getProviderUrl("annotation")}),i.addComponent({title:"Computer-Aided Design (CAD) model geometry",name:"CADGeometry",level:2,providerUrl:t.getProviderUrl("cad-geometry")}),i.addComponent({title:"Core",name:"Core",level:2,providerUrl:t.getProviderUrl()}),i.addComponent({title:"Cube map environmental texturing",name:"CubeMapTexturing",level:3,providerUrl:t.getProviderUrl("cube-map-texturing")}),i.addComponent({title:"Distributed interactive simulation (DIS)",name:"DIS",level:2,providerUrl:t.getProviderUrl("dis")}),i.addComponent({title:"Environmental effects",name:"EnvironmentalEffects",level:4,providerUrl:t.getProviderUrl()}),i.addComponent({title:"Environmental sensor",name:"EnvironmentalSensor",level:4,providerUrl:t.getProviderUrl()}),i.addComponent({title:"Event utilities",name:"EventUtilities",level:4,providerUrl:t.getProviderUrl("event-utilities")}),i.addComponent({title:"Followers",name:"Followers",level:4,providerUrl:t.getProviderUrl()}),i.addComponent({title:"Geometry2D",name:"Geometry2D",level:2,providerUrl:t.getProviderUrl("geometry2d")}),i.addComponent({title:"Geometry3D",name:"Geometry3D",level:4,providerUrl:t.getProviderUrl()}),i.addComponent({title:"Geospatial",name:"Geospatial",level:2,providerUrl:t.getProviderUrl("geospatial")}),i.addComponent({title:"Grouping",name:"Grouping",level:3,providerUrl:t.getProviderUrl()}),i.addComponent({title:"Humanoid animation (HAnim)",name:"HAnim",level:3,providerUrl:t.getProviderUrl("h-anim")}),i.addAlias("H-Anim","HAnim"),i.addComponent({title:"Interpolation",name:"Interpolation",level:5,providerUrl:t.getProviderUrl()}),i.addComponent({title:"Key device sensor",name:"KeyDeviceSensor",level:2,providerUrl:t.getProviderUrl("key-device-sensor")}),i.addComponent({title:"Layering",name:"Layering",level:1,providerUrl:t.getProviderUrl()}),i.addComponent({title:"Layout",name:"Layout",level:2,providerUrl:t.getProviderUrl("layout")}),i.addComponent({title:"Lighting",name:"Lighting",level:3,providerUrl:t.getProviderUrl()}),i.addComponent({title:"Navigation",name:"Navigation",level:3,providerUrl:t.getProviderUrl()}),i.addComponent({title:"Networking",name:"Networking",level:4,providerUrl:t.getProviderUrl()}),i.addComponent({title:"Non-uniform Rational B-Spline (NURBS)",name:"NURBS",level:4,providerUrl:t.getProviderUrl("nurbs")}),i.addComponent({title:"Particle systems",name:"ParticleSystems",level:3,providerUrl:t.getProviderUrl("particle-systems")}),i.addComponent({title:"Picking sensor",name:"Picking",level:3,providerUrl:t.getProviderUrl("picking")}),i.addComponent({title:"Pointing device sensor",name:"PointingDeviceSensor",level:1,providerUrl:t.getProviderUrl()}),i.addComponent({title:"Projective Texture Mapping",name:"ProjectiveTextureMapping",level:2,providerUrl:t.getProviderUrl("projective-texture-mapping")}),i.addComponent({title:"Programmable shaders",name:"Shaders",level:1,providerUrl:t.getProviderUrl()}),i.addComponent({title:"Rendering",name:"Rendering",level:5,providerUrl:t.getProviderUrl()}),i.addComponent({title:"Rigid body physics",name:"RigidBodyPhysics",level:5,providerUrl:t.getProviderUrl("rigid-body-physics")}),i.addComponent({title:"Scripting",name:"Scripting",level:1,providerUrl:t.getProviderUrl("scripting")}),i.addComponent({title:"Shape",name:"Shape",level:5,providerUrl:t.getProviderUrl()}),i.addComponent({title:"Sound",name:"Sound",level:1,providerUrl:t.getProviderUrl()}),i.addComponent({title:"Text",name:"Text",level:1,providerUrl:t.getProviderUrl()}),i.addComponent({title:"Texturing",name:"Texturing",level:3,providerUrl:t.getProviderUrl()}),i.addComponent({title:"Texturing3D",name:"Texturing3D",level:3,providerUrl:t.getProviderUrl("texturing-3d")}),i.addComponent({title:"Time",name:"Time",level:2,providerUrl:t.getProviderUrl()}),i.addComponent({title:"Volume rendering",name:"VolumeRendering",level:2,providerUrl:t.getProviderUrl("volume-rendering")}),i.addComponent({title:"X_ITE",name:"X_ITE",level:1,providerUrl:t.getProviderUrl("x_ite")}),i}),define("x_ite/Configuration/SupportedProfiles",["x_ite/Configuration/ProfileInfo","x_ite/Configuration/ProfileInfoArray","x_ite/Configuration/ComponentInfoArray","x_ite/Configuration/SupportedComponents","x_ite/Browser/Networking/urls"],function(e,t,i,n,r){"use strict";const o=new t;return o.addProfile({title:"Computer-Aided Design (CAD) interchange",name:"CADInterchange",providerUrl:r.getProviderUrl(),components:[n.get("CADGeometry"),n.get("Core"),n.get("Grouping"),n.get("Lighting"),n.get("Navigation"),n.get("Networking"),n.get("Rendering"),n.get("Shaders"),n.get("Shape"),n.get("Texturing")]}),o.addProfile({title:"Core",name:"Core",providerUrl:r.getProviderUrl(),components:[n.get("Core")]}),o.addProfile({title:"Full",name:"Full",providerUrl:r.getProviderUrl(),components:[n.get("CADGeometry"),n.get("Core"),n.get("CubeMapTexturing"),n.get("DIS"),n.get("EnvironmentalEffects"),n.get("EnvironmentalSensor"),n.get("EventUtilities"),n.get("Followers"),n.get("Geometry2D"),n.get("Geometry3D"),n.get("Geospatial"),n.get("Grouping"),n.get("HAnim"),n.get("Interpolation"),n.get("KeyDeviceSensor"),n.get("Layering"),n.get("Layout"),n.get("Lighting"),n.get("Navigation"),n.get("Networking"),n.get("NURBS"),n.get("ParticleSystems"),n.get("Picking"),n.get("PointingDeviceSensor"),n.get("ProjectiveTextureMapping"),n.get("Rendering"),n.get("RigidBodyPhysics"),n.get("Scripting"),n.get("Shaders"),n.get("Shape"),n.get("Sound"),n.get("Text"),n.get("Texturing"),n.get("Texturing3D"),n.get("Time"),n.get("VolumeRendering")]}),o.addProfile({title:"Immersive",name:"Immersive",providerUrl:r.getProviderUrl(),components:[n.get("Core"),n.get("EnvironmentalEffects"),n.get("EnvironmentalSensor"),n.get("EventUtilities"),n.get("Geometry2D"),n.get("Geometry3D"),n.get("Grouping"),n.get("Interpolation"),n.get("KeyDeviceSensor"),n.get("Lighting"),n.get("Navigation"),n.get("Networking"),n.get("PointingDeviceSensor"),n.get("Rendering"),n.get("Scripting"),n.get("Shape"),n.get("Sound"),n.get("Text"),n.get("Texturing"),n.get("Time")]}),o.addProfile({title:"Interactive",name:"Interactive",providerUrl:r.getProviderUrl(),components:[n.get("Core"),n.get("EnvironmentalEffects"),n.get("EnvironmentalSensor"),n.get("EventUtilities"),n.get("Geometry3D"),n.get("Grouping"),n.get("Interpolation"),n.get("KeyDeviceSensor"),n.get("Lighting"),n.get("Navigation"),n.get("Networking"),n.get("PointingDeviceSensor"),n.get("Rendering"),n.get("Shape"),n.get("Texturing"),n.get("Time")]}),o.addProfile({title:"Interchange",name:"Interchange",providerUrl:r.getProviderUrl(),components:[n.get("Core"),n.get("EnvironmentalEffects"),n.get("Geometry3D"),n.get("Grouping"),n.get("Interpolation"),n.get("Lighting"),n.get("Navigation"),n.get("Networking"),n.get("Rendering"),n.get("Shape"),n.get("Texturing"),n.get("Time")]}),o.addProfile({title:"Medical interchange",name:"MedicalInterchange",providerUrl:r.getProviderUrl(),components:[n.get("Core"),n.get("EnvironmentalEffects"),n.get("EventUtilities"),n.get("Geometry2D"),n.get("Geometry3D"),n.get("Grouping"),n.get("Interpolation"),n.get("Lighting"),n.get("Navigation"),n.get("Networking"),n.get("Rendering"),n.get("Shape"),n.get("Text"),n.get("Texturing"),n.get("Texturing3D"),n.get("Time"),n.get("VolumeRendering")]}),o.addProfile({title:"MPEG-4 interactive",name:"MPEG-4",providerUrl:r.getProviderUrl(),components:[n.get("Core"),n.get("EnvironmentalEffects"),n.get("EnvironmentalSensor"),n.get("Geometry3D"),n.get("Grouping"),n.get("Interpolation"),n.get("Lighting"),n.get("Navigation"),n.get("Networking"),n.get("PointingDeviceSensor"),n.get("Rendering"),n.get("Shape"),n.get("Texturing"),n.get("Time")]}),o}),define("x_ite/Browser/X3DBrowser",["jquery","x_ite/Browser/VERSION","x_ite/Fields","x_ite/Components","x_ite/Components/Layering/X3DLayerNode","x_ite/Browser/X3DBrowserContext","x_ite/Configuration/ComponentInfo","x_ite/Configuration/SupportedProfiles","x_ite/Configuration/SupportedComponents","x_ite/Configuration/SupportedNodes","x_ite/Execution/Scene","x_ite/Execution/X3DScene","x_ite/InputOutput/FileLoader","x_ite/Parser/XMLParser","x_ite/Parser/JSONParser","x_ite/Base/X3DConstants","standard/Utility/MapUtilities","locale/gettext"],function(e,t,i,n,r,o,s,a,u,l,c,h,d,p,f,g,m,y){"use strict";function _(e){o.call(this,e),this[w]=new Map,this.replaceWorld(this.createScene())}const x=Symbol(),w=Symbol();_.prototype=Object.assign(Object.create(o.prototype),{constructor:_,getTypeName:function(){return"X3DBrowser"},getComponentName:function(){return"X_ITE"},getContainerField:function(){return"browser"},initialize:function(){o.prototype.initialize.call(this);let e=this.getElement().attr("src");e=e?'"'+e+'"':this.getElement().attr("url"),e?(this.initialized().set(this.getCurrentTime()),this.load(e)):(this.initialized().setValue(this.getCurrentTime()),this.callBrowserCallbacks(g.INITIALIZED_EVENT),this.callBrowserEventHandler("onload")),this.getNumber()>1||this.print("Welcome to "+this.name+" X3D Browser "+this.version+":\n   Current Graphics Renderer\n      Name: "+this.getVendor()+" "+this.getRenderer()+"\n      WebGL version: "+this.getWebGLVersion()+"\n      Shading language: "+this.getShadingLanguageVersion()+"\n   Rendering Properties\n      Antialiased: "+this.getAntialiased()+"\n      Depth size: "+this.getDepthSize()+" bits\n      Color depth: "+this.getColorDepth()+" bits\n      Max clip planes: "+this.getMaxClipPlanes()+"\n      Max global lights: "+this.getMaxLights()+"\n      Max textures: "+this.getMaxTextures()+"\n      Texture units: "+this.getMaxCombinedTextureUnits()+"\n      Max texture size: "+this.getMaxTextureSize()+" × "+this.getMaxTextureSize()+" pixel\n      Texture memory: "+this.getTextureMemory()+"\n      Max vertex uniform vectors: "+this.getMaxVertexUniformVectors()+"\n      Max fragment uniform vectors: "+this.getMaxFragmentUniformVectors()+"\n      Max vertex attribs: "+this.getMaxVertexAttribs()+"\n")},getName:function(){return"X_ITE"},getVersion:function(){return t},getDescription:function(){return this.getNotification().string_.getValue()},setDescription:function(e){this.getNotification().string_=e},getWorldURL:function(){return this.currentScene.worldURL},getProfile:function(e){const t=a.get(e);if(t)return t;throw Error("Profile '"+e+"' is not supported.")},getComponent:function(e,t){const i=u.get(e);if(i&&(i.level,!0))return new s(e,t,i.title,i.providerUrl);throw Error("Component '"+e+"' at level '"+t+"' is not supported.")},getSupportedNode:function(e){return l.getType(e)},createScene:function(e,t){const i=new c(this);if(arguments.length){i.setProfile(e);for(let e=1,t=arguments.length;e<t;++e)i.addComponent(arguments[e])}return i.setup(),i},
replaceWorld:function(e){if(this.loadCount_.removeInterest("set_loadCount__",this),this.prepareEvents().removeInterest("bind",this),this[x]&&this[x].abort(),this.getWorld()&&(this.getExecutionContext().setLive(!1),this.shutdown().processInterests(),this.callBrowserCallbacks(g.SHUTDOWN_EVENT),this.callBrowserEventHandler("onshutdown")),e instanceof i.MFNode){const t=e;e=this.createScene();for(const i of t)e.isLive().addInterest(i.getValue().getExecutionContext().isLive());e.setRootNodes(t)}e instanceof h||(e=this.createScene()),e.getExecutionContext().isLive().removeInterest("setLive",e),e.setExecutionContext(e),this.description="",this.getBrowserOptions().configure(),this.setBrowserLoading(!0),this.loadCount_.addInterest("set_loadCount__",this),this.prepareEvents().removeInterest("bind",this);for(const t of e.getLoadingObjects())this.addLoadCount(t);this.setExecutionContext(e),this.getWorld().bind(),e.setLive(this.isLive().getValue())},set_loadCount__:function(e){e.getValue()||(this.loadCount_.removeInterest("set_loadCount__",this),this.prepareEvents().addInterest("bind",this),this.addBrowserEvent())},bind:function(){this.prepareEvents().removeInterest("bind",this),this.setBrowserLoading(!1),this.initialized().getValue()&&(this.initialized().setValue(this.getCurrentTime()),this.callBrowserCallbacks(g.INITIALIZED_EVENT),this.callBrowserEventHandler("onload"))},createVrmlFromString:function(e){return this.createX3DFromString(e).rootNodes},createX3DFromString:function(e){const t=this.currentScene,i=this.isExternal(),n=new d(this.getWorld()),r=n.createX3DFromString(t.getWorldURL(),e);return i||(t.isLive().addInterest("setLive",r),r.setExecutionContext(t),r.setLive(t.getLive())),r},createVrmlFromURL:function(e,t,n){if(!(t instanceof i.SFNode))throw new Error("Browser.createVrmlFromURL: node must be of type SFNode.");if(!t.getValue())throw new Error("Browser.createVrmlFromURL: node IS NULL.");const r=t.getValue().getField(n);if(!r.isInput())throw new Error("Browser.createVrmlFromURL: event named '"+n+"' must be a input field.");if(r.getType()!==g.MFNode)throw new Error("Browser.createVrmlFromURL: event named '"+n+"' must be of type MFNode.");const o=this.currentScene,s=this.isExternal(),a=new d(this.getWorld());this.addLoadCount(a),a.createX3DFromURL(e,null,function(e){this.removeLoadCount(a),e&&(s||(o.isLive().addInterest("setLive",e),e.setExecutionContext(o),e.setLive(o.getLive())),r.setValue(e.rootNodes))}.bind(this))},createX3DFromURL:function(e,t,i){if(3===arguments.length)return this.createVrmlFromURL(e,t,i);const n=this.currentScene,r=this.isExternal(),o=new d(this.getWorld()),s=o.createX3DFromURL(e,null);return r||(n.isLive().addInterest("setLive",s),s.setExecutionContext(n),s.setLive(n.getLive())),s},loadURL:function(e,t){return new Promise(function(i,n){this.loadCount_.removeInterest("set_loadCount__",this),this.prepareEvents().removeInterest("bind",this),this[x]&&this[x].abort(),this.setBrowserLoading(!0),this.addLoadCount(this);const r=this[x]=new d(this.getWorld());r.createX3DFromURL(e,t,function(e){if(r!==this[x])return void n();this.getBrowserOptions().getSplashScreen()||this.getCanvas().fadeIn(0),e?(this.replaceWorld(e),this.removeLoadCount(this),i()):(this.callBrowserCallbacks(g.CONNECTION_ERROR),this.callBrowserEventHandler("onerror"),setTimeout(function(){this.getSplashScreen().find(".x_ite-private-spinner-text").text(y("Failed loading world."))}.bind(this),31),n())}.bind(this),function(e){if(r!==this[x])return void n();this.changeViewpoint(e),this.removeLoadCount(this),this.setBrowserLoading(!1),i()}.bind(this),function(e,t){if(r!==this[x])return void n();t?window.open(e,t):location=e,this.removeLoadCount(this),this.setBrowserLoading(!1),i()}.bind(this))}.bind(this))},addBrowserListener:function(e,t){},removeBrowserListener:function(e){},addBrowserCallback:function(e,t){this[w].set(e,t)},removeBrowserCallback:function(e){this[w].delete(e)},getBrowserCallbacks:function(){return this[w]},callBrowserCallbacks:function(){const e=[];return function(t){if(this[w].size)for(const i of m.values(e,this[w]))i(t)}}(),importDocument:function(e,t,i){const n=this.currentScene,r=this.createScene();if(this.isExternal()||(n.isLive().addInterest("setLive",r),r.setExecutionContext(n),r.setLive(n.getLive())),new p(r).parseIntoScene(e,t,i),1===arguments.length)return r},importJS:function(e,t,i){const n=this.currentScene,r=this.createScene();if(this.isExternal()||(n.isLive().addInterest("setLive",r),r.setExecutionContext(n),r.setLive(n.getLive())),new f(r).parseIntoScene(e,t,i),1===arguments.length)return r},getBrowserProperty:function(e){return this.getBrowserProperties().getField(e).getValue()},setBrowserOption:function(e,t){this.getBrowserOptions().getField(e).setValue(t)},getBrowserOption:function(e){return this.getBrowserOptions().getField(e).getValue()},getRenderingProperty:function(e){return this.getRenderingProperties().getField(e).getValue()},firstViewpoint:function(e){if(e instanceof i.SFNode&&(e=e.getValue()),e||(e=this.getActiveLayer()),e instanceof r){const t=e.getUserViewpoints();t.length&&this.bindViewpoint(e,t[0])}},previousViewpoint:function(e){if(e instanceof i.SFNode&&(e=e.getValue()),e||(e=this.getActiveLayer()),e instanceof r){const i=e.getUserViewpoints();if(0===i.length)return;for(var t=0,n=i.length;t<n&&!i[t].isBound_.getValue();++t);t<i.length?0===t?this.bindViewpoint(e,i.at(-1)):this.bindViewpoint(e,i[t-1]):this.bindViewpoint(e,i.at(-1))}},nextViewpoint:function(e){if(e instanceof i.SFNode&&(e=e.getValue()),e||(e=this.getActiveLayer()),e instanceof r){const i=e.getUserViewpoints();if(0===i.length)return;for(var t=0,n=i.length;t<n&&!i[t].isBound_.getValue();++t);t<i.length?t===i.length-1?this.bindViewpoint(e,i[0]):this.bindViewpoint(e,i[t+1]):this.bindViewpoint(e,i[0])}},lastViewpoint:function(e){if(e instanceof i.SFNode&&(e=e.getValue()),e||(e=this.getActiveLayer()),e instanceof r){const t=e.getUserViewpoints();t.length&&this.bindViewpoint(e,t.at(-1))}},changeViewpoint:function(e,t){if(e instanceof i.SFNode&&(e=e.getValue()),1===arguments.length&&(t=e,e=this.getActiveLayer()),e instanceof r)for(const i of e.getViewpoints().get())if(i.getName()===t){this.bindViewpoint(e,i);break}},bindViewpoint:function(e,t){t.setVRMLTransition(!0),t.isBound_.getValue()?t.transitionStart(e,t,t):t.set_bind_=!0},addRoute:function(e,t,i,n){this.currentScene.addRoute(e,t,i,n)},deleteRoute:function(e,t,i,n){try{const r=this.currentScene.getRoute(e,t,i,n);r&&this.currentScene.deleteRoute(r)}catch(e){console.log(e)}},beginUpdate:function(){this.setLive(!0),this.getExecutionContext().setLive(!0),this.advanceTime(performance.now())},endUpdate:function(){this.setLive(!1),this.getExecutionContext().setLive(!1)},print:function(){let t="";for(const e of arguments)t+=e;console.log(t);const i=e(".x_ite-console");i.length&&i.append(document.createTextNode(t))},println:function(){let t="";for(const e of arguments)t+=e;console.log(t),t+="\n";const i=e(".x_ite-console");i.length&&i.append(document.createTextNode(t))},toVRMLStream:function(e){this.currentScene.toVRMLStream(e)},toXMLStream:function(e){this.currentScene.toXMLStream(e)},toJSONStream:function(e){this.currentScene.toJSONStream(e)}});for(const e of Reflect.ownKeys(_.prototype))Object.defineProperty(_.prototype,e,{enumerable:!1});return Object.defineProperty(_.prototype,"name",{get:function(){return this.getName()},enumerable:!0,configurable:!1}),Object.defineProperty(_.prototype,"version",{get:function(){return this.getVersion()},enumerable:!0,configurable:!1}),Object.defineProperty(_.prototype,"currentFrameRate",{get:function(){return this.getCurrentFrameRate()},enumerable:!0,configurable:!1}),Object.defineProperty(_.prototype,"currentSpeed",{get:function(){return this.getCurrentSpeed()},enumerable:!0,configurable:!1}),Object.defineProperty(_.prototype,"description",{get:function(){return this.getDescription()},set:function(e){this.setDescription(e)},enumerable:!0,configurable:!1}),Object.defineProperty(_.prototype,"currentScene",{get:function(){return this.getScriptStack().at(-1).getExecutionContext()},enumerable:!0,configurable:!1}),Object.defineProperty(_.prototype,"supportedProfiles",{get:function(){return a},enumerable:!0,configurable:!1}),Object.defineProperty(_.prototype,"supportedComponents",{get:function(){return u},enumerable:!0,configurable:!1}),_}),define("standard/Time/MicroTime",[],function(){"use strict";performance.now=function(){const e=performance.now;let t=0,i=0;return function(){const n=e.call(this);return n>i?(t=0,i=n,n):i=n+ ++t/1e3}}()}),define("x_ite/X3D",["jquery","x_ite/Base/X3DBaseNode","x_ite/Base/X3DFieldDefinition","x_ite/Base/FieldDefinitionArray","x_ite/Base/X3DField","x_ite/Base/X3DArrayField","x_ite/Fields","x_ite/Browser/X3DBrowser","x_ite/Configuration/ComponentInfo","x_ite/Configuration/ComponentInfoArray","x_ite/Configuration/ProfileInfo","x_ite/Configuration/ProfileInfoArray","x_ite/Configuration/UnitInfo","x_ite/Configuration/UnitInfoArray","x_ite/Execution/X3DExecutionContext","x_ite/Execution/X3DScene","x_ite/Prototype/ExternProtoDeclarationArray","x_ite/Prototype/ProtoDeclarationArray","x_ite/Prototype/X3DExternProtoDeclaration","x_ite/Prototype/X3DProtoDeclaration","x_ite/Routing/RouteArray","x_ite/Routing/X3DRoute","x_ite/Base/X3DConstants","x_ite/Browser/Networking/urls","x_ite/Fallback","standard/Time/MicroTime"],function(e,t,i,n,r,o,s,a,u,l,c,h,d,p,f,g,m,y,_,x,w,b,v,S,T,C){"use strict";function F(e){const t=S.getProviderUrl(e);return"function"==typeof globalRequire&&"string"==typeof __filename&&globalRequire(globalRequire("url").fileURLToPath(t)),t}function O(t,i){const n=e("<X3DCanvas></X3DCanvas>");return t instanceof s.MFString&&n.attr("url",t.toString()),E(n),n[0]}function N(t){return e(t||"X3DCanvas").data("browser")}function E(t){if(t=e(t),!t.find(".x_ite-private-browser").length){const e=new a(t);return t.data("browser",e),e.setup(),e}}function D(t,i){"function"==typeof t&&M.done(t),"function"==typeof i&&V.done(i),I||(I=!0,e(function(){const t=e("X3DCanvas");t.children().hide();try{e.map(t,E),M.resolve()}catch(e){T.show(t,e),V.resolve(e)}}))}const M=e.Deferred(),V=e.Deferred();let I=!1;return require.getComponentUrl=F,Object.assign(D,{require:require,define:define,getBrowser:N,createBrowser:O,X3DConstants:v,X3DBrowser:a,X3DExecutionContext:f,X3DScene:g,ComponentInfo:u,ComponentInfoArray:l,ProfileInfo:c,ProfileInfoArray:h,UnitInfo:d,UnitInfoArray:p,ExternProtoDeclarationArray:m,ProtoDeclarationArray:y,X3DExterProtonDeclaration:_,X3DProtoDeclaration:x,RouteArray:w,X3DRoute:b,X3DBaseNode:t,X3DFieldDefinition:i,FieldDefinitionArray:n,X3DField:r,X3DArrayField:o,SFColor:s.SFColor,SFColorRGBA:s.SFColorRGBA,SFImage:s.SFImage,SFMatrix3d:s.SFMatrix3d,SFMatrix3f:s.SFMatrix3f,SFMatrix4d:s.SFMatrix4d,SFMatrix4f:s.SFMatrix4f,SFNode:s.SFNode,SFRotation:s.SFRotation,SFVec2d:s.SFVec2d,SFVec2f:s.SFVec2f,SFVec3d:s.SFVec3d,SFVec3f:s.SFVec3f,SFVec4d:s.SFVec4d,SFVec4f:s.SFVec4f,VrmlMatrix:s.VrmlMatrix,MFBool:s.MFBool,MFColor:s.MFColor,MFColorRGBA:s.MFColorRGBA,MFDouble:s.MFDouble,MFFloat:s.MFFloat,MFImage:s.MFImage,MFInt32:s.MFInt32,MFMatrix3d:s.MFMatrix3d,MFMatrix3f:s.MFMatrix3f,MFMatrix4d:s.MFMatrix4d,MFMatrix4f:s.MFMatrix4f,MFNode:s.MFNode,MFRotation:s.MFRotation,MFString:s.MFString,MFTime:s.MFTime,MFVec2d:s.MFVec2d,MFVec2f:s.MFVec2f,MFVec3d:s.MFVec3d,MFVec3f:s.MFVec3f,MFVec4d:s.MFVec4d,MFVec4f:s.MFVec4f}),D}),require.config({waitSeconds:0}),define.show=function(){this.define=window.define,window.define=this},define.hide=function(){void 0===this.define?delete window.define:window.define=this.define,delete this.define};const getScriptURL=function(){if(document.currentScript)var e=document.currentScript.src;else if("function"==typeof globalRequire&&"string"==typeof __filename)var e=globalRequire("url").pathToFileURL(__filename).href;return function(){return e}}();!function(){"use strict";function e(e,t){return new Promise(function(i,n){r?(r(i,n),r(e,t)):(o.push(i,e),s.push(n,t))})}function t(e){require(["x_ite/Fallback"],function(t){t.error(e,s)})}function i(){return window.X3D===e&&(void 0===n?delete window.X3D:window.X3D=n),e}const n=window.X3D;let r=null;if(e.noConflict=i,e.require=require,e.define=define,window.X3D=e,"object"==typeof globalModule&&"object"==typeof globalModule.exports&&(globalModule.exports=e),document.createElement("X3DCanvas"),void 0===window.Proxy)return t("Proxy is not defined");const o=[],s=[];require(["jquery","x_ite/X3D"],function(t,i){t.noConflict(!0),r=i,Object.assign(e,i),i();for(let e=0;e<o.length;++e)i(o[e],s[e])},t)}(),function(){function e(e){if(e=Math.trunc(e)||0,e<0&&(e+=this.length),!(e<0||e>=this.length))return this[e]}const t=Reflect.getPrototypeOf(Int8Array);for(const i of[Array,String,t])void 0===i.prototype.at&&Object.defineProperty(i.prototype,"at",{value:e,writable:!0,enumerable:!1,configurable:!0})}(),define("x_ite",function(){}),define("x_ite/Browser/Shaders/ShaderSource",[],function(){"use strict";return{get:function(e,t){return t}}})}("object"==typeof module?module:void 0,"function"==typeof require?require:void 0);
