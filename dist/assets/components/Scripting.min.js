/* X_ITE v8.7.8 */(()=>{"use strict";var e={355:e=>{e.exports=window[Symbol.for("X_ITE.X3D-8.7.8")].require("lib/jquery")}},t={};function o(i){var n=t[i];if(void 0!==n)return n.exports;var r=t[i]={exports:{}};return e[i](r,r.exports,o),r.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var i in t)o.o(t,i)&&!o.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{const e=window[Symbol.for("X_ITE.X3D-8.7.8")].require("x_ite/Components");var t=o.n(e);const i=window[Symbol.for("X_ITE.X3D-8.7.8")].require("x_ite/Base/X3DFieldDefinition");var n=o.n(i);const r=window[Symbol.for("X_ITE.X3D-8.7.8")].require("x_ite/Base/FieldDefinitionArray");var a=o.n(r);const s=window[Symbol.for("X_ITE.X3D-8.7.8")].require("x_ite/Base/X3DField");var l=o.n(s);const c=window[Symbol.for("X_ITE.X3D-8.7.8")].require("x_ite/Base/X3DArrayField");var u=o.n(c);const d=window[Symbol.for("X_ITE.X3D-8.7.8")].require("x_ite/Fields");var f=o.n(d);const p=window[Symbol.for("X_ITE.X3D-8.7.8")].require("x_ite/Browser/X3DBrowser");var v=o.n(p);const F=window[Symbol.for("X_ITE.X3D-8.7.8")].require("x_ite/Configuration/ComponentInfo");var S=o.n(F);const _=window[Symbol.for("X_ITE.X3D-8.7.8")].require("x_ite/Configuration/ComponentInfoArray");var h=o.n(_);const w=window[Symbol.for("X_ITE.X3D-8.7.8")].require("x_ite/Configuration/ProfileInfo");var g=o.n(w);const y=window[Symbol.for("X_ITE.X3D-8.7.8")].require("x_ite/Configuration/ProfileInfoArray");var m=o.n(y);const D=window[Symbol.for("X_ITE.X3D-8.7.8")].require("x_ite/Configuration/UnitInfo");var X=o.n(D);const x=window[Symbol.for("X_ITE.X3D-8.7.8")].require("x_ite/Configuration/UnitInfoArray");var I=o.n(x);const M=window[Symbol.for("X_ITE.X3D-8.7.8")].require("x_ite/Execution/X3DExecutionContext");var E=o.n(M);const b=window[Symbol.for("X_ITE.X3D-8.7.8")].require("x_ite/Execution/X3DScene");var T=o.n(b);const C=window[Symbol.for("X_ITE.X3D-8.7.8")].require("x_ite/Prototype/ExternProtoDeclarationArray");var O=o.n(C);const A=window[Symbol.for("X_ITE.X3D-8.7.8")].require("x_ite/Prototype/ProtoDeclarationArray");var q=o.n(A);const V=window[Symbol.for("X_ITE.X3D-8.7.8")].require("x_ite/Prototype/X3DExternProtoDeclaration");var N=o.n(V);const B=window[Symbol.for("X_ITE.X3D-8.7.8")].require("x_ite/Prototype/X3DProtoDeclaration");var P=o.n(B);const R=window[Symbol.for("X_ITE.X3D-8.7.8")].require("x_ite/Routing/RouteArray");var L=o.n(R);const U=window[Symbol.for("X_ITE.X3D-8.7.8")].require("x_ite/Routing/X3DRoute");var j=o.n(U);const z=window[Symbol.for("X_ITE.X3D-8.7.8")].require("x_ite/Namespace");var k=o.n(z);const G=function(e,t){return Function(`with (arguments [0])\n   {\n      delete arguments [0];\n      arguments .length = 0;\n      ${t}\n   }`)(e)};k().set("x_ite/Browser/Scripting/evaluate",G);const $=G,H=window[Symbol.for("X_ITE.X3D-8.7.8")].require("x_ite/Components/Core/X3DChildNode");var J=o.n(H);const W=window[Symbol.for("X_ITE.X3D-8.7.8")].require("x_ite/Components/Networking/X3DUrlObject");var K=o.n(W);const Q=window[Symbol.for("X_ITE.X3D-8.7.8")].require("x_ite/Base/X3DConstants");var Y=o.n(Q);function Z(e){J().call(this,e),K().call(this,e),this.addType(Y().X3DScriptNode)}Z.prototype=Object.assign(Object.create(J().prototype),K().prototype,{constructor:Z,initialize:function(){J().prototype.initialize.call(this),K().prototype.initialize.call(this)},dispose:function(){K().prototype.dispose.call(this),J().prototype.dispose.call(this)}});const ee=Z;k().set("x_ite/Components/Scripting/X3DScriptNode",ee);const te=ee,oe=window[Symbol.for("X_ITE.X3D-8.7.8")].require("x_ite/InputOutput/FileLoader");var ie=o.n(oe),ne=o(355);function re(e){te.call(this,e),this.addType(Y().Script)}re.prototype=Object.assign(Object.create(te.prototype),{constructor:re,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new(a())([new(n())(Y().inputOutput,"metadata",new(f().SFNode)),new(n())(Y().inputOutput,"description",new(f().SFString)),new(n())(Y().inputOutput,"load",new(f().SFBool)(!0)),new(n())(Y().inputOutput,"url",new(f().MFString)),new(n())(Y().inputOutput,"autoRefresh",new(f().SFTime)),new(n())(Y().inputOutput,"autoRefreshTimeLimit",new(f().SFTime)(3600)),new(n())(Y().initializeOnly,"directOutput",new(f().SFBool)),new(n())(Y().initializeOnly,"mustEvaluate",new(f().SFBool))]),getTypeName:function(){return"Script"},getComponentName:function(){return"Scripting"},getContainerField:function(){return"children"},getSpecificationRange:function(){return["2.0","Infinity"]},initialize:function(){te.prototype.initialize.call(this),this.requestImmediateLoad().catch(Function.prototype)},getExtendedEventHandling:function(){return!1},canUserDefinedFields:function(){return!0},addUserDefinedField:function(e,t,o){te.prototype.addUserDefinedField.call(this,e,t,o),this.isInitialized()&&(this.setLoadState(Y().NOT_STARTED_STATE),this.requestImmediateLoad().catch(Function.prototype))},removeUserDefinedField:function(e){this.getUserDefinedFields().get(e)?.removeInterest("set_field__",this),te.prototype.removeUserDefinedField.call(this,e),this.isInitialized()&&(this.setLoadState(Y().NOT_STARTED_STATE),this.requestImmediateLoad().catch(Function.prototype))},getSourceText:function(){return this._url},unloadData:function(){this.initialize__("")},loadData:function(){new(ie())(this).loadDocument(this._url,(e=>{null===e?this.setLoadState(Y().FAILED_STATE):(this.initialize__(ne.decodeText(e)),this.setLoadState(Y().COMPLETE_STATE))}))},getContext:function(e){try{const t=["initialize","prepareEvents","eventsProcessed","shutdown"];for(const e of this.getUserDefinedFields())switch(e.getAccessType()){case Y().inputOnly:t.push(e.getName());break;case Y().inputOutput:t.push("set_"+e.getName())}e+="\nreturn ["+t.map((function(e){return`typeof ${e} !== "undefined" ? ${e} : undefined`})).join(",")+"];",this.globalObject=this.getGlobalObject();const o=$(this.globalObject,e),i=new Map;for(let e=0;e<t.length;++e)i.set(t[e],o[e]);return i}catch(e){return this.setError("while evaluating script source",e),new Map}},evaluate:function(e){return $(this.globalObject,`return (${e})`)},getGlobalObject:function(){const e=this.getBrowser(),t=this.getExecutionContext(),o=this.getLive();function i(i){const n=e.createX3DFromString(String(i)),r=n.getRootNodes();if(o.addFieldInterest(n.getLive()),n.setLive(o.getValue()),n.setPrivate(t.isPrivate()),n.setExecutionContext(t),r.length&&r[0])return r[0];throw new Error("SFNode.new: invalid argument, must be 'string' is 'undefined'.")}i.prototype=f().SFNode.prototype;const r={NULL:{value:null},FALSE:{value:!1},TRUE:{value:!0},print:{value:e.println.bind(e)},trace:{value:e.println.bind(e)},Browser:{value:e},X3DConstants:{value:Y()},X3DBrowser:{value:v()},X3DExecutionContext:{value:E()},X3DScene:{value:T()},ComponentInfo:{value:S()},ComponentInfoArray:{value:h()},ProfileInfo:{value:g()},ProfileInfoArray:{value:m()},UnitInfo:{value:X()},UnitInfoArray:{value:I()},ExternProtoDeclarationArray:{value:O()},ProtoDeclarationArray:{value:q()},X3DExternProtoDeclaration:{value:N()},X3DProtoDeclaration:{value:P()},RouteArray:{value:L()},X3DRoute:{value:j()},X3DFieldDefinition:{value:n()},FieldDefinitionArray:{value:a()},X3DField:{value:l()},X3DArrayField:{value:u()},SFColor:{value:f().SFColor},SFColorRGBA:{value:f().SFColorRGBA},SFImage:{value:f().SFImage},SFMatrix3d:{value:f().SFMatrix3d},SFMatrix3f:{value:f().SFMatrix3f},SFMatrix4d:{value:f().SFMatrix4d},SFMatrix4f:{value:f().SFMatrix4f},SFNode:{value:i},SFRotation:{value:f().SFRotation},SFVec2d:{value:f().SFVec2d},SFVec2f:{value:f().SFVec2f},SFVec3d:{value:f().SFVec3d},SFVec3f:{value:f().SFVec3f},SFVec4d:{value:f().SFVec4d},SFVec4f:{value:f().SFVec4f},VrmlMatrix:{value:f().VrmlMatrix},MFBool:{value:f().MFBool},MFColor:{value:f().MFColor},MFColorRGBA:{value:f().MFColorRGBA},MFDouble:{value:f().MFDouble},MFFloat:{value:f().MFFloat},MFImage:{value:f().MFImage},MFInt32:{value:f().MFInt32},MFMatrix3d:{value:f().MFMatrix3d},MFMatrix3f:{value:f().MFMatrix3f},MFMatrix4d:{value:f().MFMatrix4d},MFMatrix4f:{value:f().MFMatrix4f},MFNode:{value:f().MFNode},MFRotation:{value:f().MFRotation},MFString:{value:f().MFString},MFTime:{value:f().MFTime},MFVec2d:{value:f().MFVec2d},MFVec2f:{value:f().MFVec2f},MFVec3d:{value:f().MFVec3d},MFVec3f:{value:f().MFVec3f},MFVec4d:{value:f().MFVec4d},MFVec4f:{value:f().MFVec4f}};for(const e of this.getUserDefinedFields()){const t=e.getName();e.getAccessType()!==Y().inputOnly&&(t in r||(r[t]={get:e.valueOf.bind(e),set:e.setValue.bind(e)}),e.getAccessType()===Y().inputOutput&&(r[t+"_changed"]={get:e.valueOf.bind(e),set:e.setValue.bind(e)}))}return Object.create(Object.prototype,r)},initialize__:function(e){this.disconnect();const t=this.getBrowser();this.context=this.getContext(e);const o=this.context.get("initialize");"function"==typeof o&&this.call__(o,"initialize");const i=this.context.get("shutdown");"function"==typeof i&&ne(window).on("unload.Script"+this.getId(),this.call__.bind(this,i,"shutdown"));const n=this.context.get("prepareEvents");"function"==typeof n&&t.prepareEvents().addInterest("call__",this,n,"prepareEvents");const r=this.context.get("eventsProcessed");"function"==typeof r&&this.addInterest("call__",this,r,"eventsProcessed");for(const e of this.getUserDefinedFields())switch(e.getAccessType()){case Y().inputOnly:{const t=this.context.get(e.getName());"function"==typeof t&&e.addInterest("set_field__",this,t);break}case Y().inputOutput:{const t=this.context.get("set_"+e.getName());"function"==typeof t&&e.addInterest("set_field__",this,t);break}}},call__:function(e,t){const o=this.getBrowser();o.getScriptStack().push(this);try{e(o.getCurrentTime())}catch(e){this.setError(`in function '${t}'`,e)}o.getScriptStack().pop()},set_field__:function(e,t){const o=this.getBrowser();t.setTainted(!0),o.getScriptStack().push(this);try{e(t.valueOf(),o.getCurrentTime())}catch(e){this.setError("in function '"+t.getName()+"'",e)}o.getScriptStack().pop(),t.setTainted(!1)},setError:function(e,t){console.error("JavaScript Error in Script '"+this.getName()+"', "+e+"\nworld url is '"+this.getExecutionContext().getWorldURL()+"':"),console.error(t)},disconnect:function(){const e=this.context?.get("shutdown");"function"==typeof e&&this.call__(e,"shutdown"),ne(window).off(".Script"+this.getId()),this.getBrowser().prepareEvents().removeInterest("call__",this),this.removeInterest("call__",this);for(const e of this.getUserDefinedFields())e.removeInterest("set_field__",this)},dispose:function(){this.disconnect(),te.prototype.dispose.call(this)}});const ae=re;k().set("x_ite/Components/Scripting/Script",ae);const se=ae;t().addComponent({name:"Scripting",types:{Script:se},abstractTypes:{X3DScriptNode:te}});const le=void 0;k().set("assets/components/Scripting",le)})()})();