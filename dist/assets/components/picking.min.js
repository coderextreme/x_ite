!function(e,t,i){var n=X3D.define;X3D.require;void 0===i&&(void 0,t=void 0),n("x_ite/Browser/Picking/MatchCriterion",[],function(){"use strict";var e=0;return{MATCH_ANY:e++,MATCH_EVERY:e++,MATCH_ONLY_ONE:e++}}),n("x_ite/Browser/Picking/IntersectionType",[],function(){"use strict";var e=0;return{BOUNDS:e++,GEOMETRY:e++}}),n("x_ite/Browser/Picking/SortOrder",[],function(){"use strict";var e=0;return{ANY:e++,CLOSEST:e++,ALL:e++,ALL_SORTED:e++}}),n("x_ite/Components/Picking/X3DPickSensorNode",["x_ite/Fields","x_ite/Components/Core/X3DSensorNode","x_ite/Bits/TraverseType","x_ite/Bits/X3DConstants","x_ite/Browser/Picking/MatchCriterion","x_ite/Browser/Picking/IntersectionType","x_ite/Browser/Picking/SortOrder","standard/Math/Numbers/Matrix4","standard/Math/Algorithms/QuickSort","standard/Utility/ObjectCache"],function(e,t,i,n,o,s,r,c,a,h){"use strict";function p(e,t){return e.distance<t.distance}function d(i){t.call(this,i),this.addType(n.X3DPickSensorNode),this.objectType=new Set,this.intersectionType=s.BOUNDS,this.sortOrder=r.CLOSEST,this.pickTargetNodes=new Set,this.modelMatrices=[],this.targets=[],this.targets.size=0,this.pickedTargets=[],this.pickedTargetsSorter=new a(this.pickedTargets,p),this.pickedGeometries=new e.MFNode}var u=h(c);return d.prototype=Object.assign(Object.create(t.prototype),{constructor:d,initialize:function(){this.isLive().addInterest("set_live__",this),this.enabled_.addInterest("set_live__",this),this.objectType_.addInterest("set_objectType__",this),this.matchCriterion_.addInterest("set_matchCriterion__",this),this.intersectionType_.addInterest("set_intersectionType__",this),this.sortOrder_.addInterest("set_sortOrder__",this),this.pickTarget_.addInterest("set_pickTarget__",this),this.set_objectType__(),this.set_matchCriterion__(),this.set_intersectionType__(),this.set_sortOrder__(),this.set_pickTarget__()},getObjectType:function(){return this.objectType},getMatchCriterion:function(){return this.matchCriterion},getIntersectionType:function(){return this.intersectionType},getSortOrder:function(){return this.sortOrder},getModelMatrices:function(){return this.modelMatrices},getTargets:function(){return this.targets},getPickShape:function(){var e=new WeakMap;return function(t){var i=e.get(t);if(void 0!==i)return i;var n=this.getExecutionContext().createNode("Shape",!1),o=this.getExecutionContext().createNode("CollidableShape",!1);return n.setPrivate(!0),o.setPrivate(!0),o.setConvex(!0),n.geometry_=t,o.shape_=n,n.setup(),o.setup(),e.set(t,o),o}}(),getPickedGeometries:function(){return function(){var e=this.targets,t=e.size,i=this.pickedTargets,n=this.pickedGeometries;i.length=0;for(var o=0;o<t;++o){var s=e[o];s.intersected&&i.push(s)}if(0===i.length)return n.length=0,n;switch(this.sortOrder){case r.ANY:i.length=1,n[0]=this.getPickedGeometry(i[0]),n.length=1;break;case r.CLOSEST:this.pickedTargetsSorter.sort(0,i.length),i.length=1,n[0]=this.getPickedGeometry(i[0]),n.length=1;break;case r.ALL:for(var o=0,c=i.length;o<c;++o)n[o]=this.getPickedGeometry(i[o]);n.length=c;break;case r.ALL_SORTED:this.pickedTargetsSorter.sort(0,i.length);for(var o=0,c=i.length;o<c;++o)n[o]=this.getPickedGeometry(i[o]);n.length=c}return n}}(),getPickedGeometry:function(e){var t=this.getExecutionContext(),i=e.geometryNode;if(i.getExecutionContext()===t)return i;var o=i.getExecutionContext();if(o.getType().indexOf(n.X3DPrototypeInstance)!==-1&&o.getExecutionContext()===t)return o;for(var s=e.pickingHierarchy,r=s.length-1;r>=0;--r){var c=s[r];if(c.getExecutionContext()===t)return c;var o=c.getExecutionContext();if(o.getType().indexOf(n.X3DPrototypeInstance)!==-1&&o.getExecutionContext()===t)return o}return null},getPickedTargets:function(){return this.pickedTargets},set_live__:function(){this.isLive().getValue()&&this.enabled_.getValue()&&!this.objectType.has("NONE")?(this.getBrowser().addPickSensor(this),this.setPickableObject(!0)):(this.getBrowser().removePickSensor(this),this.setPickableObject(!1))},set_objectType__:function(){this.objectType.clear();for(var e=0,t=this.objectType_.length;e<t;++e)this.objectType.add(this.objectType_[e]);this.set_live__()},set_matchCriterion__:function(){var e=new Map([["MATCH_ANY",o.MATCH_ANY],["MATCH_EVERY",o.MATCH_EVERY],["MATCH_ONLY_ONE",o.MATCH_ONLY_ONE]]);return function(){this.matchCriterion=e.get(this.matchCriterion_.getValue()),void 0===this.matchCriterion&&(this.matchCriterion=MatchCriterionType.MATCH_ANY)}}(),set_intersectionType__:function(){var e=new Map([["BOUNDS",s.BOUNDS],["GEOMETRY",s.GEOMETRY]]);return function(){this.intersectionType=e.get(this.intersectionType_.getValue()),void 0===this.intersectionType&&(this.intersectionType=s.BOUNDS)}}(),set_sortOrder__:function(){var e=new Map([["ANY",r.ANY],["CLOSEST",r.CLOSEST],["ALL",r.ALL],["ALL_SORTED",r.ALL_SORTED]]);return function(){this.sortOrder=e.get(this.sortOrder_.getValue()),void 0===this.sortOrder&&(this.sortOrder=r.CLOSEST)}}(),set_pickTarget__:function(){this.pickTargetNodes.clear();for(var e=0,t=this.pickTarget_.length;e<t;++e)try{for(var i=this.pickTarget_[e].getValue().getInnerNode(),o=i.getType(),s=o.length-1;s>=0;--s)switch(o[s]){case n.Inline:case n.Shape:case n.X3DGroupingNode:this.pickTargetNodes.add(i);break;default:continue}}catch(e){}},traverse:function(e,t){e===i.PICKING&&this.getPickableObject()&&this.modelMatrices.push(u.pop().assign(t.getModelViewMatrix().get()))},collect:function(e,t,i){var n=this.pickTargetNodes;if(i.some(function(e){return n.has(e)})){var o=this.targets;if(o.size<o.length)var s=o[o.size];else{var s={modelMatrix:new c,pickingHierarchy:[],pickedPoint:[],intersections:[]};o.push(s)}++o.size,s.intersected=!1,s.geometryNode=e,s.pickedPoint.length=0,s.intersections.length=0,s.modelMatrix.assign(t);for(var r=s.pickingHierarchy,a=0,h=i.length;a<h;++a)r[a]=i[a];r.length=h}},process:function(){for(var e=this.modelMatrices,t=0,i=e.length;t<i;++t)u.push(e[t]);this.modelMatrices.length=0,this.targets.size=0}}),d}),n("x_ite/Components/Picking/LinePickSensor",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Picking/X3DPickSensorNode","x_ite/Bits/X3DConstants","x_ite/Browser/Picking/IntersectionType","standard/Math/Numbers/Vector3","standard/Math/Numbers/Matrix4","standard/Math/Geometry/Box3","standard/Math/Geometry/Line3"],function(e,t,i,n,o,s,r,c,a,h){"use strict";function p(e){n.call(this,e),this.addType(o.LinePickSensor),this.pickingGeometryNode=null}return p.prototype=Object.assign(Object.create(n.prototype),{constructor:p,fieldDefinitions:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOutput,"enabled",new e.SFBool(!0)),new t(o.inputOutput,"objectType",new e.MFString("ALL")),new t(o.inputOutput,"matchCriterion",new e.SFString("MATCH_ANY")),new t(o.initializeOnly,"intersectionType",new e.SFString("BOUNDS")),new t(o.initializeOnly,"sortOrder",new e.SFString("CLOSEST")),new t(o.outputOnly,"isActive",new e.SFBool),new t(o.outputOnly,"pickedTextureCoordinate",new e.MFVec3f),new t(o.outputOnly,"pickedNormal",new e.MFVec3f),new t(o.outputOnly,"pickedPoint",new e.MFVec3f),new t(o.inputOutput,"pickingGeometry",new e.SFNode),new t(o.inputOutput,"pickTarget",new e.MFNode),new t(o.outputOnly,"pickedGeometry",new e.MFNode)]),getTypeName:function(){return"LinePickSensor"},getComponentName:function(){return"Picking"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.pickingGeometry_.addInterest("set_pickingGeometry__",this),this.set_pickingGeometry__()},set_pickingGeometry__:function(){this.pickingGeometryNode=null;try{for(var e=this.pickingGeometry_.getValue().getInnerNode(),t=e.getType(),i=t.length-1;i>=0;--i)switch(t[i]){case o.IndexedLineSet:case o.LineSet:this.pickingGeometryNode=e;break;default:continue}}catch(e){}},process:function(){var t=new a,i=new a,o=new r(0,0,0),p=new r(0,0,0),d=new c,u=new r(0,0,0),g=new r(0,0,0),l=new h(r.Zero,r.zAxis),m=new r(0,0,0),_=new r(0,0,0),y=[],k=[],f=new r(0,0,0),w=new e.MFVec3f,S=new e.MFVec3f,v=new e.MFVec3f;return function(){if(this.pickingGeometryNode){var e=this.getModelMatrices(),r=this.getTargets();switch(this.getIntersectionType()){case s.BOUNDS:for(var c=0,a=e.length;c<a;++c){var h=e[c];t.assign(this.pickingGeometryNode.getBBox()).multRight(h);for(var C=0,T=r.size;C<T;++C){var b=r[C];i.assign(b.geometryNode.getBBox()).multRight(b.modelMatrix),t.intersectsBox(i)&&(o.assign(t.center),p.assign(i.center),b.intersected=!0,b.distance=o.distance(p))}}var N=this.getPickedGeometries(),O=Boolean(N.length);N.remove(0,N.length,null),O!==this.isActive_.getValue()&&(this.isActive_=O),this.pickedGeometry_.equals(N)||(this.pickedGeometry_=N);break;case s.GEOMETRY:for(var c=0,a=e.length;c<a;++c){var h=e[c];t.assign(this.pickingGeometryNode.getBBox()).multRight(h);for(var C=0,T=r.size;C<T;++C)try{var b=r[C],x=b.geometryNode,P=this.pickingGeometryNode.getVertices();i.assign(x.getBBox()).multRight(b.modelMatrix),d.assign(b.modelMatrix).inverse().multLeft(h);for(var B=0,M=P.length;B<M;B+=8)if(d.multVecMatrix(u.set(P[B+0],P[B+1],P[B+2])),d.multVecMatrix(g.set(P[B+4],P[B+5],P[B+6])),l.setPoints(u,g),k.length=0,x.intersectsLine(l,y,b.modelMatrix,k))for(var G=0,D=k.length;G<D;++G){var F=k[G];m.assign(F.point).subtract(u),_.assign(F.point).subtract(g);var A=m.add(_).abs(),V=u.distance(g);A<=V&&b.intersections.push(F)}b.intersections.length&&(o.assign(t.center),p.assign(i.center),b.intersected=!0,b.distance=o.distance(p))}catch(e){console.log(e)}}var N=this.getPickedGeometries(),O=Boolean(N.length);N.remove(0,N.length,null),O!==this.isActive_.getValue()&&(this.isActive_=O),this.pickedGeometry_.equals(N)||(this.pickedGeometry_=N);var L=this.getPickedTargets();w.length=0,S.length=0,v.length=0;for(var C=0,T=L.length;C<T;++C)for(var j=L[C].intersections,G=0,D=j.length;G<D;++G){var F=j[G],C=F.texCoord;f.set(C.x,C.y,C.z),w.push(f),S.push(F.normal),v.push(F.point)}this.pickedTextureCoordinate_.equals(w)||(this.pickedTextureCoordinate_=w),this.pickedNormal_.equals(S)||(this.pickedNormal_=S),this.pickedPoint_.equals(v)||(this.pickedPoint_=v)}}n.prototype.process.call(this)}}()}),p}),n("x_ite/Components/Picking/X3DPickableObject",["x_ite/Bits/X3DConstants"],function(e){"use strict";function t(t){this.addType(e.X3DPickableObject),this.objectType=new Set}return t.prototype={constructor:t,initialize:function(){this.objectType_.addInterest("set_objectType__",this),this.set_objectType__()},getObjectType:function(){return this.objectType},set_objectType__:function(){this.objectType.clear();for(var e=0,t=this.objectType_.length;e<t;++e)this.objectType.add(this.objectType_[e])}},t}),n("x_ite/Components/Picking/PickableGroup",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Grouping/X3DGroupingNode","x_ite/Components/Picking/X3DPickableObject","x_ite/Browser/Picking/MatchCriterion","x_ite/Bits/X3DConstants","x_ite/Bits/TraverseType"],function(e,t,i,n,o,s,r,c){"use strict";function a(e){n.call(this,e),o.call(this,e),this.addType(r.PickableGroup)}return a.prototype=Object.assign(Object.create(n.prototype),o.prototype,{constructor:a,fieldDefinitions:new i([new t(r.inputOutput,"metadata",new e.SFNode),new t(r.inputOutput,"pickable",new e.SFBool(!0)),new t(r.inputOutput,"objectType",new e.MFString("ALL")),new t(r.inputOutput,"visible",new e.SFBool(!0)),new t(r.inputOutput,"bboxDisplay",new e.SFBool),new t(r.initializeOnly,"bboxSize",new e.SFVec3f(-1,-1,-1)),new t(r.initializeOnly,"bboxCenter",new e.SFVec3f),new t(r.inputOnly,"addChildren",new e.MFNode),new t(r.inputOnly,"removeChildren",new e.MFNode),new t(r.inputOutput,"children",new e.MFNode)]),getTypeName:function(){return"PickableGroup"},getComponentName:function(){return"Picking"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),o.prototype.initialize.call(this),this.pickable_.addInterest("set_pickable__",this),this.set_pickable__()},set_pickableObjects__:function(){this.set_pickable__()},set_pickable__:function(){this.setPickableObject(Boolean(this.pickable_.getValue()||this.getTransformSensors().size))},traverse:function(){const e=new Set;return function(t,i){if(t===c.PICKING){if(this.pickable_.getValue()){if(this.getObjectType().has("NONE"))return;const o=i.getBrowser(),r=o.getPickable();if(this.getObjectType().has("ALL"))r.push(!0),n.prototype.traverse.call(this,t,i),r.pop();else{const c=o.getPickSensors();for(const t of c.at(-1)){if(!t.getObjectType().has("ALL")){let e=0;for(const i of this.getObjectType())if(t.getObjectType().has(i)){++e;break}switch(t.getMatchCriterion()){case s.MATCH_ANY:if(0===e)continue;break;case s.MATCH_EVERY:if(e!==pickSensor.getObjectType().size)continue;break;case s.MATCH_ONLY_ONE:if(1!==e)continue}}e.add(t)}r.push(!0),c.push(e),n.prototype.traverse.call(this,t,i),c.pop(),r.pop(),e.clear()}}}else n.prototype.traverse.call(this,t,i)}}()}),a}),n("x_ite/Browser/Picking/VolumePicker",["standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Numbers/Matrix4",X3D.getComponentUrl("rigid-body-physics")],function(e,t,i,n){"use strict";function o(){this.broadphase=new s.btDbvtBroadphase,this.collisionConfiguration=new s.btDefaultCollisionConfiguration,this.dispatcher=new s.btCollisionDispatcher(this.collisionConfiguration),this.collisionWorld=new s.btCollisionWorld(this.dispatcher,this.broadphase,this.collisionConfiguration),this.compoundShape1=new s.btCompoundShape,this.motionState1=new s.btDefaultMotionState,this.constructionInfo1=new s.btRigidBodyConstructionInfo(0,this.motionState1,this.compoundShape1),this.rigidBody1=new s.btRigidBody(this.constructionInfo1),this.compoundShape2=new s.btCompoundShape,this.motionState2=new s.btDefaultMotionState,this.constructionInfo2=new s.btRigidBodyConstructionInfo(0,this.motionState2,this.compoundShape2),this.rigidBody2=new s.btRigidBody(this.constructionInfo2),this.collisionWorld.addCollisionObject(this.rigidBody1),this.collisionWorld.addCollisionObject(this.rigidBody2)}var s=n.Ammo;return o.prototype={constuctor:o,setChildShape1:function(e,t){this.setChildShape(this.compoundShape1,e,t)},setChildShape2:function(e,t){this.setChildShape(this.compoundShape2,e,t)},setChildShape1Components:function(e,t,i){this.setChildShapeComponents(this.compoundShape1,e,t,i)},setChildShape2Components:function(e,t,i){this.setChildShapeComponents(this.compoundShape2,e,t,i)},setChildShape:function(){var i=new e(0,0,0),n=new t(0,0,1,0),o=new e(1,1,1),r=new s.btVector3(0,0,0);return function(e,t,s){try{e.getNumChildShapes()&&e.removeChildShapeByIndex(0),s.getNumChildShapes()&&(t.get(i,n,o),r.setValue(o.x,o.y,o.z),s.setLocalScaling(r),e.addChildShape(this.getTransform(i,n),s))}catch(e){}}}(),setChildShapeComponents:function(e,t,i,n){e.getNumChildShapes()&&e.removeChildShapeByIndex(0),n.getNumChildShapes()&&(n.setLocalScaling(i),e.addChildShape(t,n))},contactTest:function(){this.collisionWorld.performDiscreteCollisionDetection();for(var e=this.dispatcher.getNumManifolds(),t=0;t<e;++t)for(var i=this.dispatcher.getManifoldByIndexInternal(t),n=i.getNumContacts(),o=0;o<n;++o){var s=i.getContactPoint(o);if(s.getDistance()<=0)return!0}return!1},getTransform:function(){var e=new s.btTransform,t=new s.btVector3(0,0,0),n=new i;return function(i,o,s){var r=s||e;return n.set(i,o),t.setValue(n[12],n[13],n[14]),r.getBasis().setValue(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),r.setOrigin(t),r}}()},o}),n("x_ite/Components/Picking/PointPickSensor",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Picking/X3DPickSensorNode","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants","x_ite/Browser/Picking/IntersectionType","x_ite/Browser/Picking/VolumePicker","standard/Math/Numbers/Vector3","standard/Math/Numbers/Rotation4","standard/Math/Geometry/Box3",X3D.getComponentUrl("rigid-body-physics")],function(e,t,i,n,o,s,r,c,a,h,p,d){"use strict";function u(e){n.call(this,e),this.addType(s.PointPickSensor),this.pickingGeometryNode=null,this.picker=new c,this.compoundShapes=[]}var g=d.Ammo;return u.prototype=Object.assign(Object.create(n.prototype),{constructor:u,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOutput,"enabled",new e.SFBool(!0)),new t(s.inputOutput,"objectType",new e.MFString("ALL")),new t(s.inputOutput,"matchCriterion",new e.SFString("MATCH_ANY")),new t(s.initializeOnly,"intersectionType",new e.SFString("BOUNDS")),new t(s.initializeOnly,"sortOrder",new e.SFString("CLOSEST")),new t(s.outputOnly,"isActive",new e.SFBool),new t(s.outputOnly,"pickedPoint",new e.MFVec3f),new t(s.inputOutput,"pickingGeometry",new e.SFNode),new t(s.inputOutput,"pickTarget",new e.MFNode),new t(s.outputOnly,"pickedGeometry",new e.MFNode)]),getTypeName:function(){return"PointPickSensor"},getComponentName:function(){return"Picking"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.pickingGeometry_.addInterest("set_pickingGeometry__",this),this.set_pickingGeometry__()},set_pickingGeometry__:function(){this.pickingGeometryNode&&this.pickingGeometryNode.rebuild_.removeInterest("set_geometry__",this),this.pickingGeometryNode=o(s.PointSet,this.pickingGeometry_),this.pickingGeometryNode&&this.pickingGeometryNode.rebuild_.addInterest("set_geometry__",this),this.set_geometry__()},set_geometry__:function(){var e=new g.btVector3(1,1,1),t=new g.btVector3,i=new g.btTransform;return function(){var n=this.compoundShapes;if(this.pickingGeometryNode){var o=this.pickingGeometryNode.getCoord();if(o){for(var s=0,r=o.getSize();s<r;++s)if(s<n.length){var c=n[s],h=o.get1Point(s,c.point);t.setValue(h.x,h.y,h.z),i.setOrigin(t),c.setLocalScaling(e),c.updateChildTransform(0,i)}else{var c=new g.btCompoundShape,p=new g.btSphereShape(0),h=o.get1Point(s,new a(0,0,0));c.point=h,t.setValue(h.x,h.y,h.z),i.setOrigin(t),c.addChildShape(i,p),n.push(c)}n.length=r}else n.length=0}else n.length=0}}(),process:function(){var t=new p,i=new p,o=new a(0,0,0),s=new a(0,0,0),c=new g.btTransform,d=new g.btVector3,u=new a(0,0,0),l=new h(0,0,1,0),m=new a(1,1,1),_=new e.MFVec3f;return function(){if(this.pickingGeometryNode){var e=this.getModelMatrices(),a=this.getTargets();switch(this.getIntersectionType()){case r.BOUNDS:for(var h=0,p=e.length;h<p;++h){var g=e[h];t.assign(this.pickingGeometryNode.getBBox()).multRight(g);for(var y=0,k=a.size;y<k;++y){var f=a[y];i.assign(f.geometryNode.getBBox()).multRight(f.modelMatrix),t.intersectsBox(i)&&(o.assign(t.center),s.assign(i.center),f.intersected=!0,f.distance=o.distance(s))}}var w=this.getPickedGeometries(),S=Boolean(w.length);w.remove(0,w.length,null),S!==this.isActive_.getValue()&&(this.isActive_=S),this.pickedGeometry_.equals(w)||(this.pickedGeometry_=w);break;case r.GEOMETRY:for(var v=this.picker,C=this.compoundShapes,h=0,p=e.length;h<p;++h){var g=e[h];t.assign(this.pickingGeometryNode.getBBox()).multRight(g),g.get(u,l,m),v.getTransform(u,l,c),d.setValue(m.x,m.y,m.z);for(var T=0,b=C.length;T<b;++T){var N=C[T];v.setChildShape1Components(c,d,N);for(var y=0,k=a.size;y<k;++y){var f=a[y],O=this.getPickShape(f.geometryNode);i.assign(f.geometryNode.getBBox()).multRight(f.modelMatrix),v.setChildShape2(f.modelMatrix,O.getCompoundShape()),v.contactTest()&&(o.assign(t.center),s.assign(i.center),f.intersected=!0,f.distance=o.distance(s),f.pickedPoint.push(N.point))}}}var w=this.getPickedGeometries(),S=Boolean(w.length);w.remove(0,w.length,null),S!==this.isActive_.getValue()&&(this.isActive_=S),this.pickedGeometry_.equals(w)||(this.pickedGeometry_=w);var x=this.getPickedTargets();_.length=0;for(var y=0,k=x.length;y<k;++y)for(var P=x[y].pickedPoint,B=0,M=P.length;B<M;++B)_.push(P[B]);this.pickedPoint_.equals(_)||(this.pickedPoint_=_)}}n.prototype.process.call(this)}}()}),u}),n("x_ite/Components/Picking/PrimitivePickSensor",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Picking/X3DPickSensorNode","x_ite/Bits/X3DConstants","x_ite/Browser/Picking/IntersectionType","x_ite/Browser/Picking/VolumePicker","standard/Math/Numbers/Vector3","standard/Math/Geometry/Box3"],function(e,t,i,n,o,s,r,c,a){"use strict";function h(e){n.call(this,e),this.addType(o.PrimitivePickSensor),this.pickingGeometryNode=null,this.picker=new r}return h.prototype=Object.assign(Object.create(n.prototype),{constructor:h,fieldDefinitions:new i([new t(o.inputOutput,"metadata",new e.SFNode),new t(o.inputOutput,"enabled",new e.SFBool(!0)),new t(o.inputOutput,"objectType",new e.MFString("ALL")),new t(o.inputOutput,"matchCriterion",new e.SFString("MATCH_ANY")),new t(o.initializeOnly,"intersectionType",new e.SFString("BOUNDS")),new t(o.initializeOnly,"sortOrder",new e.SFString("CLOSEST")),new t(o.outputOnly,"isActive",new e.SFBool),new t(o.inputOutput,"pickingGeometry",new e.SFNode),new t(o.inputOutput,"pickTarget",new e.MFNode),new t(o.outputOnly,"pickedGeometry",new e.MFNode)]),getTypeName:function(){return"PrimitivePickSensor"},getComponentName:function(){return"Picking"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.pickingGeometry_.addInterest("set_pickingGeometry__",this),this.set_pickingGeometry__()},set_pickingGeometry__:function(){this.pickingGeometryNode=null;try{for(var e=this.pickingGeometry_.getValue().getInnerNode(),t=e.getType(),i=t.length-1;i>=0;--i)switch(t[i]){case o.Box:case o.Cone:case o.Cylinder:case o.Sphere:this.pickingGeometryNode=e;break;default:continue}}catch(e){}},process:function(){var e=new a,t=new a,i=new c(0,0,0),o=new c(0,0,0);return function(){if(this.pickingGeometryNode){var r=this.getModelMatrices(),c=this.getTargets();switch(this.getIntersectionType()){case s.BOUNDS:for(var a=0,h=r.length;a<h;++a){var p=r[a];e.assign(this.pickingGeometryNode.getBBox()).multRight(p);for(var d=0,u=c.size;d<u;++d){var g=c[d];t.assign(g.geometryNode.getBBox()).multRight(g.modelMatrix),e.intersectsBox(t)&&(i.assign(e.center),o.assign(t.center),g.intersected=!0,g.distance=i.distance(o))}}var l=this.getPickedGeometries(),m=Boolean(l.length);l.remove(0,l.length,null),m!==this.isActive_.getValue()&&(this.isActive_=m),this.pickedGeometry_.equals(l)||(this.pickedGeometry_=l);break;case s.GEOMETRY:for(var _=this.picker,a=0,h=r.length;a<h;++a){var p=r[a],y=this.getPickShape(this.pickingGeometryNode);e.assign(this.pickingGeometryNode.getBBox()).multRight(p),_.setChildShape1(p,y.getCompoundShape());for(var d=0,u=c.size;d<u;++d){var g=c[d],k=this.getPickShape(g.geometryNode);t.assign(g.geometryNode.getBBox()).multRight(g.modelMatrix),_.setChildShape2(g.modelMatrix,k.getCompoundShape()),_.contactTest()&&(i.assign(e.center),o.assign(t.center),g.intersected=!0,g.distance=i.distance(o))}}var l=this.getPickedGeometries(),m=Boolean(l.length);l.remove(0,l.length,null),m!==this.isActive_.getValue()&&(this.isActive_=m),this.pickedGeometry_.equals(l)||(this.pickedGeometry_=l)}}n.prototype.process.call(this)}}()}),h}),n("x_ite/Components/Picking/VolumePickSensor",["x_ite/Fields","x_ite/Basic/X3DFieldDefinition","x_ite/Basic/FieldDefinitionArray","x_ite/Components/Picking/X3DPickSensorNode","x_ite/Bits/X3DCast","x_ite/Bits/X3DConstants","x_ite/Browser/Picking/IntersectionType","x_ite/Browser/Picking/VolumePicker","standard/Math/Numbers/Vector3","standard/Math/Geometry/Box3"],function(e,t,i,n,o,s,r,c,a,h){"use strict";function p(e){n.call(this,e),this.addType(s.VolumePickSensor),this.pickingGeometryNode=null,this.picker=new c}return p.prototype=Object.assign(Object.create(n.prototype),{constructor:p,fieldDefinitions:new i([new t(s.inputOutput,"metadata",new e.SFNode),new t(s.inputOutput,"enabled",new e.SFBool(!0)),new t(s.inputOutput,"objectType",new e.MFString("ALL")),new t(s.inputOutput,"matchCriterion",new e.SFString("MATCH_ANY")),new t(s.initializeOnly,"intersectionType",new e.SFString("BOUNDS")),new t(s.initializeOnly,"sortOrder",new e.SFString("CLOSEST")),new t(s.outputOnly,"isActive",new e.SFBool),new t(s.inputOutput,"pickingGeometry",new e.SFNode),new t(s.inputOutput,"pickTarget",new e.MFNode),new t(s.outputOnly,"pickedGeometry",new e.MFNode)]),getTypeName:function(){return"VolumePickSensor"},getComponentName:function(){return"Picking"},getContainerField:function(){return"children"},initialize:function(){n.prototype.initialize.call(this),this.pickingGeometry_.addInterest("set_pickingGeometry__",this),this.set_pickingGeometry__()},set_pickingGeometry__:function(){this.pickingGeometryNode=o(s.X3DGeometryNode,this.pickingGeometry_)},process:function(){var e=new h,t=new h,i=new a(0,0,0),o=new a(0,0,0);return function(){if(this.pickingGeometryNode){var s=this.getModelMatrices(),c=this.getTargets();switch(this.getIntersectionType()){case r.BOUNDS:for(var a=0,h=s.length;a<h;++a){var p=s[a];e.assign(this.pickingGeometryNode.getBBox()).multRight(p);for(var d=0,u=c.size;d<u;++d){var g=c[d];t.assign(g.geometryNode.getBBox()).multRight(g.modelMatrix),e.intersectsBox(t)&&(i.assign(e.center),o.assign(t.center),g.intersected=!0,g.distance=i.distance(o))}}var l=this.getPickedGeometries(),m=Boolean(l.length);l.remove(0,l.length,null),m!==this.isActive_.getValue()&&(this.isActive_=m),this.pickedGeometry_.equals(l)||(this.pickedGeometry_=l);break;case r.GEOMETRY:for(var _=this.picker,a=0,h=s.length;a<h;++a){var p=s[a],y=this.getPickShape(this.pickingGeometryNode);e.assign(this.pickingGeometryNode.getBBox()).multRight(p),_.setChildShape1(p,y.getCompoundShape());for(var d=0,u=c.size;d<u;++d){var g=c[d],k=this.getPickShape(g.geometryNode);t.assign(g.geometryNode.getBBox()).multRight(g.modelMatrix),_.setChildShape2(g.modelMatrix,k.getCompoundShape()),_.contactTest()&&(i.assign(e.center),o.assign(t.center),g.intersected=!0,g.distance=i.distance(o))}}var l=this.getPickedGeometries(),m=Boolean(l.length);l.remove(0,l.length,null),m!==this.isActive_.getValue()&&(this.isActive_=m),this.pickedGeometry_.equals(l)||(this.pickedGeometry_=l)}}n.prototype.process.call(this)}}()}),p});var t;void 0!==t&&t(new URL(X3D.getComponentUrl("rigid-body-physics")).pathname),n(X3D.getComponentUrl("picking"),["x_ite/Components","x_ite/Components/Picking/LinePickSensor","x_ite/Components/Picking/PickableGroup","x_ite/Components/Picking/PointPickSensor","x_ite/Components/Picking/PrimitivePickSensor","x_ite/Components/Picking/VolumePickSensor","x_ite/Components/Picking/X3DPickSensorNode","x_ite/Components/Picking/X3DPickableObject",X3D.getComponentUrl("rigid-body-physics")],function(e,t,i,n,o,s,r,c){"use strict";e.addComponent({name:"Picking",types:{LinePickSensor:t,PickableGroup:i,PointPickSensor:n,PrimitivePickSensor:o,VolumePickSensor:s},abstractTypes:{X3DPickSensorNode:r,X3DPickableObject:c}})})}("undefined"!=typeof module?module:void 0,"undefined"!=typeof require?require:void 0,"undefined"!=typeof __filename?__filename:void 0);
