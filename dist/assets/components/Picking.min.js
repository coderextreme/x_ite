/* X_ITE v8.2.0 */(()=>{"use strict";var e={n:t=>{var i=t&&t.__esModule?()=>t.default:()=>t;return e.d(i,{a:i}),i},d:(t,i)=>{for(var n in i)e.o(i,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:i[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window[Symbol.for("X_ITE.X3D-8.2.0")].require("x_ite/Components");var i=e.n(t);const n=window[Symbol.for("X_ITE.X3D-8.2.0")].require("x_ite/Fields");var o=e.n(n);const s=window[Symbol.for("X_ITE.X3D-8.2.0")].require("x_ite/Base/X3DFieldDefinition");var r=e.n(s);const c=window[Symbol.for("X_ITE.X3D-8.2.0")].require("x_ite/Base/FieldDefinitionArray");var a=e.n(c);const h=window[Symbol.for("X_ITE.X3D-8.2.0")].require("x_ite/Components/Core/X3DSensorNode");var p=e.n(h);const l=window[Symbol.for("X_ITE.X3D-8.2.0")].require("x_ite/Rendering/TraverseType");var d=e.n(l);const g=window[Symbol.for("X_ITE.X3D-8.2.0")].require("x_ite/Base/X3DConstants");var u=e.n(g);const m=window[Symbol.for("X_ITE.X3D-8.2.0")].require("x_ite/Namespace");var y=e.n(m);let _=0;const w={MATCH_ANY:_++,MATCH_EVERY:_++,MATCH_ONLY_ONE:_++};y().set("x_ite/Browser/Picking/MatchCriterion",w);const f=w;let k=0;const S={BOUNDS:k++,GEOMETRY:k++};y().set("x_ite/Browser/Picking/IntersectionType",S);const T=S;let b=0;const O={ANY:b++,CLOSEST:b++,ALL:b++,ALL_SORTED:b++};y().set("x_ite/Browser/Picking/SortOrder",O);const v=O,N=window[Symbol.for("X_ITE.X3D-8.2.0")].require("standard/Math/Numbers/Matrix4");var C=e.n(N);const G=window[Symbol.for("X_ITE.X3D-8.2.0")].require("standard/Math/Algorithms/QuickSort");var P=e.n(G);const M=window[Symbol.for("X_ITE.X3D-8.2.0")].require("standard/Utility/ObjectCache");var x,B,E,D,A=e.n(M)()(C());function F(e,t){return e.distance<t.distance}function I(e){p().call(this,e),this.addType(u().X3DPickSensorNode),this.objectType=new Set,this.intersectionType=T.BOUNDS,this.sortOrder=v.CLOSEST,this.pickTargetNodes=new Set,this.modelMatrices=[],this.targets=[],this.targets.size=0,this.pickedTargets=[],this.pickedTargetsSorter=new(P())(this.pickedTargets,F),this.pickedGeometries=new(o().MFNode)}I.prototype=Object.assign(Object.create(p().prototype),{constructor:I,initialize:function(){this.isLive().addInterest("set_live__",this),this._enabled.addInterest("set_live__",this),this._objectType.addInterest("set_objectType__",this),this._matchCriterion.addInterest("set_matchCriterion__",this),this._intersectionType.addInterest("set_intersectionType__",this),this._sortOrder.addInterest("set_sortOrder__",this),this._pickTarget.addInterest("set_pickTarget__",this),this.set_objectType__(),this.set_matchCriterion__(),this.set_intersectionType__(),this.set_sortOrder__(),this.set_pickTarget__()},getObjectType:function(){return this.objectType},getMatchCriterion:function(){return this.matchCriterion},getIntersectionType:function(){return this.intersectionType},getSortOrder:function(){return this.sortOrder},getModelMatrices:function(){return this.modelMatrices},getTargets:function(){return this.targets},getPickShape:(D=new WeakMap,function(e){var t=D.get(e);if(void 0!==t)return t;var i=this.getExecutionContext().createNode("Shape",!1),n=this.getExecutionContext().createNode("CollidableShape",!1);return i.setPrivate(!0),n.setPrivate(!0),n.setConvex(!0),i._geometry=e,n._shape=i,i.setup(),n.setup(),D.set(e,n),n}),getPickedGeometries:function(){var e=this.targets,t=e.size,i=this.pickedTargets,n=this.pickedGeometries;i.length=0;for(var o=0;o<t;++o){var s=e[o];s.intersected&&i.push(s)}if(0===i.length)return n.length=0,n;switch(this.sortOrder){case v.ANY:i.length=1,n[0]=this.getPickedGeometry(i[0]),n.length=1;break;case v.CLOSEST:this.pickedTargetsSorter.sort(0,i.length),i.length=1,n[0]=this.getPickedGeometry(i[0]),n.length=1;break;case v.ALL:o=0;for(var r=i.length;o<r;++o)n[o]=this.getPickedGeometry(i[o]);n.length=r;break;case v.ALL_SORTED:for(this.pickedTargetsSorter.sort(0,i.length),o=0,r=i.length;o<r;++o)n[o]=this.getPickedGeometry(i[o]);n.length=r}return n},getPickedGeometry:function(e){var t=this.getExecutionContext(),i=e.geometryNode;if(i.getExecutionContext()===t)return i;if(-1!==(s=i.getExecutionContext()).getType().indexOf(u().X3DPrototypeInstance)&&s.getExecutionContext()===t)return s;for(var n=e.pickingHierarchy,o=n.length-1;o>=0;--o){var s,r=n[o];if(r.getExecutionContext()===t)return r;if(-1!==(s=r.getExecutionContext()).getType().indexOf(u().X3DPrototypeInstance)&&s.getExecutionContext()===t)return s}return null},getPickedTargets:function(){return this.pickedTargets},set_live__:function(){this.isLive().getValue()&&this._enabled.getValue()&&!this.objectType.has("NONE")?(this.getBrowser().addPickSensor(this),this.setPickableObject(!0)):(this.getBrowser().removePickSensor(this),this.setPickableObject(!1))},set_objectType__:function(){this.objectType.clear();for(var e=0,t=this._objectType.length;e<t;++e)this.objectType.add(this._objectType[e]);this.set_live__()},set_matchCriterion__:(E=new Map([["MATCH_ANY",f.MATCH_ANY],["MATCH_EVERY",f.MATCH_EVERY],["MATCH_ONLY_ONE",f.MATCH_ONLY_ONE]]),function(){this.matchCriterion=E.get(this._matchCriterion.getValue()),void 0===this.matchCriterion&&(this.matchCriterion=MatchCriterionType.MATCH_ANY)}),set_intersectionType__:(B=new Map([["BOUNDS",T.BOUNDS],["GEOMETRY",T.GEOMETRY]]),function(){this.intersectionType=B.get(this._intersectionType.getValue()),void 0===this.intersectionType&&(this.intersectionType=T.BOUNDS)}),set_sortOrder__:(x=new Map([["ANY",v.ANY],["CLOSEST",v.CLOSEST],["ALL",v.ALL],["ALL_SORTED",v.ALL_SORTED]]),function(){this.sortOrder=x.get(this._sortOrder.getValue()),void 0===this.sortOrder&&(this.sortOrder=v.CLOSEST)}),set_pickTarget__:function(){this.pickTargetNodes.clear();for(var e=0,t=this._pickTarget.length;e<t;++e)try{for(var i=this._pickTarget[e].getValue().getInnerNode(),n=i.getType(),o=n.length-1;o>=0;--o)switch(n[o]){case u().Inline:case u().Shape:case u().X3DGroupingNode:this.pickTargetNodes.add(i);break;default:continue}}catch(e){}},traverse:function(e,t){e===d().PICKING&&this.getPickableObject()&&this.modelMatrices.push(A.pop().assign(t.getModelViewMatrix().get()))},collect:function(e,t,i){var n=this.pickTargetNodes;if(i.some((function(e){return n.has(e)}))){var o=this.targets;if(o.size<o.length)var s=o[o.size];else{s={modelMatrix:new(C()),pickingHierarchy:[],pickedPoint:[],intersections:[]};o.push(s)}++o.size,s.intersected=!1,s.geometryNode=e,s.pickedPoint.length=0,s.intersections.length=0,s.modelMatrix.assign(t);for(var r=s.pickingHierarchy,c=0,a=i.length;c<a;++c)r[c]=i[c];r.length=a}},process:function(){for(var e=this.modelMatrices,t=0,i=e.length;t<i;++t)A.push(e[t]);this.modelMatrices.length=0,this.targets.size=0}}),y().set("x_ite/Components/Picking/X3DPickSensorNode",I);const X=I,j=window[Symbol.for("X_ITE.X3D-8.2.0")].require("standard/Math/Numbers/Vector3");var L=e.n(j);const V=window[Symbol.for("X_ITE.X3D-8.2.0")].require("standard/Math/Geometry/Box3");var z=e.n(V);const R=window[Symbol.for("X_ITE.X3D-8.2.0")].require("standard/Math/Geometry/Line3");var q,Y,H,U,W,K,Q,Z,J,$,ee,te,ie,ne,oe,se,re=e.n(R);function ce(e){X.call(this,e),this.addType(u().LinePickSensor),this.pickingGeometryNode=null}ce.prototype=Object.assign(Object.create(X.prototype),{constructor:ce,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new(a())([new(r())(u().inputOutput,"metadata",new(o().SFNode)),new(r())(u().inputOutput,"enabled",new(o().SFBool)(!0)),new(r())(u().inputOutput,"objectType",new(o().MFString)("ALL")),new(r())(u().inputOutput,"matchCriterion",new(o().SFString)("MATCH_ANY")),new(r())(u().initializeOnly,"intersectionType",new(o().SFString)("BOUNDS")),new(r())(u().initializeOnly,"sortOrder",new(o().SFString)("CLOSEST")),new(r())(u().outputOnly,"isActive",new(o().SFBool)),new(r())(u().outputOnly,"pickedTextureCoordinate",new(o().MFVec3f)),new(r())(u().outputOnly,"pickedNormal",new(o().MFVec3f)),new(r())(u().outputOnly,"pickedPoint",new(o().MFVec3f)),new(r())(u().inputOutput,"pickingGeometry",new(o().SFNode)),new(r())(u().inputOutput,"pickTarget",new(o().MFNode)),new(r())(u().outputOnly,"pickedGeometry",new(o().MFNode))]),getTypeName:function(){return"LinePickSensor"},getComponentName:function(){return"Picking"},getContainerField:function(){return"children"},initialize:function(){X.prototype.initialize.call(this),this._pickingGeometry.addInterest("set_pickingGeometry__",this),this.set_pickingGeometry__()},set_pickingGeometry__:function(){this.pickingGeometryNode=null;try{for(var e=this._pickingGeometry.getValue().getInnerNode(),t=e.getType(),i=t.length-1;i>=0;--i)switch(t[i]){case u().IndexedLineSet:case u().LineSet:this.pickingGeometryNode=e;break;default:continue}}catch(e){}},process:(q=new(z()),Y=new(z()),H=new(L())(0,0,0),U=new(L())(0,0,0),W=new(C()),K=new(L())(0,0,0),Q=new(L())(0,0,0),Z=new(re())(L().Zero,L().zAxis),J=new(L())(0,0,0),$=new(L())(0,0,0),ee=[],te=[],ie=new(L())(0,0,0),ne=new(o().MFVec3f),oe=new(o().MFVec3f),se=new(o().MFVec3f),function(){if(this.pickingGeometryNode){var e=this.getModelMatrices(),t=this.getTargets();switch(this.getIntersectionType()){case T.BOUNDS:for(var i=0,n=e.length;i<n;++i){var o=e[i];q.assign(this.pickingGeometryNode.getBBox()).multRight(o);for(var s=0,r=t.size;s<r;++s){var c=t[s];Y.assign(c.geometryNode.getBBox()).multRight(c.modelMatrix),q.intersectsBox(Y)&&(H.assign(q.center),U.assign(Y.center),c.intersected=!0,c.distance=H.distance(U))}}var a=this.getPickedGeometries(),h=Boolean(a.length);a.remove(0,a.length,null),h!==this._isActive.getValue()&&(this._isActive=h),this._pickedGeometry.equals(a)||(this._pickedGeometry=a);break;case T.GEOMETRY:for(i=0,n=e.length;i<n;++i)for(o=e[i],q.assign(this.pickingGeometryNode.getBBox()).multRight(o),s=0,r=t.size;s<r;++s){var p=(c=t[s]).geometryNode,l=this.pickingGeometryNode.getVertices();Y.assign(p.getBBox()).multRight(c.modelMatrix),W.assign(c.modelMatrix).inverse().multLeft(o);for(var d=0,g=l.length;d<g;d+=8)if(W.multVecMatrix(K.set(l[d+0],l[d+1],l[d+2])),W.multVecMatrix(Q.set(l[d+4],l[d+5],l[d+6])),Z.setPoints(K,Q),te.length=0,p.intersectsLineWithGeometry(Z,c.modelMatrix,ee,te))for(var u=0,m=te.length;u<m;++u){var y=te[u];J.assign(y.point).subtract(K),$.assign(y.point).subtract(Q),J.add($).magnitude()<=K.distance(Q)&&c.intersections.push(y)}c.intersections.length&&(H.assign(q.center),U.assign(Y.center),c.intersected=!0,c.distance=H.distance(U))}a=this.getPickedGeometries(),h=Boolean(a.length),a.remove(0,a.length,null),h!==this._isActive.getValue()&&(this._isActive=h),this._pickedGeometry.equals(a)||(this._pickedGeometry=a);var _=this.getPickedTargets();for(ne.length=0,oe.length=0,se.length=0,s=0,r=_.length;s<r;++s){var w=_[s].intersections;for(u=0,m=w.length;u<m;++u)s=(y=w[u]).texCoord,ie.set(s.x,s.y,s.z),ne.push(ie),oe.push(y.normal),se.push(y.point)}this._pickedTextureCoordinate.equals(ne)||(this._pickedTextureCoordinate=ne),this._pickedNormal.equals(oe)||(this._pickedNormal=oe),this._pickedPoint.equals(se)||(this._pickedPoint=se)}}X.prototype.process.call(this)})}),y().set("x_ite/Components/Picking/LinePickSensor",ce);const ae=ce,he=window[Symbol.for("X_ITE.X3D-8.2.0")].require("x_ite/Components/Grouping/X3DGroupingNode");var pe=e.n(he);function le(e){this.addType(u().X3DPickableObject),this.objectType=new Set}le.prototype={constructor:le,initialize:function(){this._objectType.addInterest("set_objectType__",this),this.set_objectType__()},getObjectType:function(){return this.objectType},set_objectType__:function(){this.objectType.clear();for(var e=0,t=this._objectType.length;e<t;++e)this.objectType.add(this._objectType[e])},dispose:function(){}},y().set("x_ite/Components/Picking/X3DPickableObject",le);const de=le;function ge(e){pe().call(this,e),de.call(this,e),this.addType(u().PickableGroup)}ge.prototype=Object.assign(Object.create(pe().prototype),de.prototype,{constructor:ge,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new(a())([new(r())(u().inputOutput,"metadata",new(o().SFNode)),new(r())(u().inputOutput,"pickable",new(o().SFBool)(!0)),new(r())(u().inputOutput,"objectType",new(o().MFString)("ALL")),new(r())(u().inputOutput,"visible",new(o().SFBool)(!0)),new(r())(u().inputOutput,"bboxDisplay",new(o().SFBool)),new(r())(u().initializeOnly,"bboxSize",new(o().SFVec3f)(-1,-1,-1)),new(r())(u().initializeOnly,"bboxCenter",new(o().SFVec3f)),new(r())(u().inputOnly,"addChildren",new(o().MFNode)),new(r())(u().inputOnly,"removeChildren",new(o().MFNode)),new(r())(u().inputOutput,"children",new(o().MFNode))]),getTypeName:function(){return"PickableGroup"},getComponentName:function(){return"Picking"},getContainerField:function(){return"children"},initialize:function(){pe().prototype.initialize.call(this),de.prototype.initialize.call(this),this._pickable.addInterest("set_pickable__",this),this.set_pickable__()},set_pickableObjects__:function(){this.set_pickable__()},set_pickable__:function(){this.setPickableObject(Boolean(this._pickable.getValue()||this.getTransformSensors().size))},traverse:function(){const e=new Set;return function(t,i){if(t===d().PICKING){if(this._pickable.getValue()){if(this.getObjectType().has("NONE"))return;const n=this.getBrowser(),o=n.getPickable();if(this.getObjectType().has("ALL"))o.push(!0),pe().prototype.traverse.call(this,t,i),o.pop();else{const s=n.getPickSensors();for(const t of s.at(-1)){if(!t.getObjectType().has("ALL")){let e=0;for(const i of this.getObjectType())if(t.getObjectType().has(i)){++e;break}switch(t.getMatchCriterion()){case f.MATCH_ANY:if(0===e)continue;break;case f.MATCH_EVERY:if(e!==pickSensor.getObjectType().size)continue;break;case f.MATCH_ONLY_ONE:if(1!==e)continue}}e.add(t)}o.push(!0),s.push(e),pe().prototype.traverse.call(this,t,i),s.pop(),o.pop(),e.clear()}}}else pe().prototype.traverse.call(this,t,i)}}(),dispose:function(){de.prototype.dispose.call(this),pe().prototype.dispose.call(this)}}),y().set("x_ite/Components/Picking/PickableGroup",ge);const ue=ge,me=window[Symbol.for("X_ITE.X3D-8.2.0")].require("x_ite/Base/X3DCast");var ye=e.n(me);const _e=window[Symbol.for("X_ITE.X3D-8.2.0")].require("standard/Math/Numbers/Rotation4");var we=e.n(_e);const fe=window[Symbol.for("X_ITE.X3D-8.2.0")].require("lib/ammojs/AmmoClass");var ke=e.n(fe);function Se(){this.broadphase=new(ke().btDbvtBroadphase),this.collisionConfiguration=new(ke().btDefaultCollisionConfiguration),this.dispatcher=new(ke().btCollisionDispatcher)(this.collisionConfiguration),this.collisionWorld=new(ke().btCollisionWorld)(this.dispatcher,this.broadphase,this.collisionConfiguration),this.compoundShape1=new(ke().btCompoundShape),this.motionState1=new(ke().btDefaultMotionState),this.constructionInfo1=new(ke().btRigidBodyConstructionInfo)(0,this.motionState1,this.compoundShape1),this.rigidBody1=new(ke().btRigidBody)(this.constructionInfo1),this.compoundShape2=new(ke().btCompoundShape),this.motionState2=new(ke().btDefaultMotionState),this.constructionInfo2=new(ke().btRigidBodyConstructionInfo)(0,this.motionState2,this.compoundShape2),this.rigidBody2=new(ke().btRigidBody)(this.constructionInfo2),this.collisionWorld.addCollisionObject(this.rigidBody1),this.collisionWorld.addCollisionObject(this.rigidBody2)}Se.prototype={constuctor:Se,setChildShape1:function(e,t){this.setChildShape(this.compoundShape1,e,t)},setChildShape2:function(e,t){this.setChildShape(this.compoundShape2,e,t)},setChildShape1Components:function(e,t,i){this.setChildShapeComponents(this.compoundShape1,e,t,i)},setChildShape2Components:function(e,t,i){this.setChildShapeComponents(this.compoundShape2,e,t,i)},setChildShape:function(){const e=new(L())(0,0,0),t=new(we())(0,0,1,0),i=new(L())(1,1,1),n=new(ke().btVector3)(0,0,0);return function(o,s,r){o.getNumChildShapes()&&o.removeChildShapeByIndex(0),r.getNumChildShapes()&&(s.get(e,t,i),n.setValue(i.x,i.y,i.z),r.setLocalScaling(n),o.addChildShape(this.getTransform(e,t),r))}}(),setChildShapeComponents:function(e,t,i,n){e.getNumChildShapes()&&e.removeChildShapeByIndex(0),n.getNumChildShapes()&&(n.setLocalScaling(i),e.addChildShape(t,n))},contactTest:function(){this.collisionWorld.performDiscreteCollisionDetection();const e=this.dispatcher.getNumManifolds();for(let t=0;t<e;++t){const e=this.dispatcher.getManifoldByIndexInternal(t),i=e.getNumContacts();for(let t=0;t<i;++t){if(e.getContactPoint(t).getDistance()<=0)return!0}}return!1},getTransform:function(){const e=new(ke().btTransform),t=new(ke().btVector3)(0,0,0),i=new(C());return function(n,o,s){const r=s||e;return i.set(n,o),t.setValue(i[12],i[13],i[14]),r.getBasis().setValue(i[0],i[4],i[8],i[1],i[5],i[9],i[2],i[6],i[10]),r.setOrigin(t),r}}()},y().set("x_ite/Browser/Picking/VolumePicker",Se);const Te=Se;function be(e){X.call(this,e),this.addType(u().PointPickSensor),this.pickingGeometryNode=null,this.picker=new Te,this.compoundShapes=[]}var Oe,ve,Ne;be.prototype=Object.assign(Object.create(X.prototype),{constructor:be,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new(a())([new(r())(u().inputOutput,"metadata",new(o().SFNode)),new(r())(u().inputOutput,"enabled",new(o().SFBool)(!0)),new(r())(u().inputOutput,"objectType",new(o().MFString)("ALL")),new(r())(u().inputOutput,"matchCriterion",new(o().SFString)("MATCH_ANY")),new(r())(u().initializeOnly,"intersectionType",new(o().SFString)("BOUNDS")),new(r())(u().initializeOnly,"sortOrder",new(o().SFString)("CLOSEST")),new(r())(u().outputOnly,"isActive",new(o().SFBool)),new(r())(u().outputOnly,"pickedPoint",new(o().MFVec3f)),new(r())(u().inputOutput,"pickingGeometry",new(o().SFNode)),new(r())(u().inputOutput,"pickTarget",new(o().MFNode)),new(r())(u().outputOnly,"pickedGeometry",new(o().MFNode))]),getTypeName:function(){return"PointPickSensor"},getComponentName:function(){return"Picking"},getContainerField:function(){return"children"},initialize:function(){X.prototype.initialize.call(this),this._pickingGeometry.addInterest("set_pickingGeometry__",this),this.set_pickingGeometry__()},set_pickingGeometry__:function(){this.pickingGeometryNode&&this.pickingGeometryNode._rebuild.removeInterest("set_geometry__",this),this.pickingGeometryNode=ye()(u().PointSet,this._pickingGeometry),this.pickingGeometryNode&&this.pickingGeometryNode._rebuild.addInterest("set_geometry__",this),this.set_geometry__()},set_geometry__:(Oe=new(ke().btVector3)(1,1,1),ve=new(ke().btVector3),Ne=new(ke().btTransform),function(){var e=this.compoundShapes;if(this.pickingGeometryNode){var t=this.pickingGeometryNode.getCoord();if(t){for(var i=0,n=t.getSize();i<n;++i)if(i<e.length){var o=e[i],s=t.get1Point(i,o.point);ve.setValue(s.x,s.y,s.z),Ne.setOrigin(ve),o.setLocalScaling(Oe),o.updateChildTransform(0,Ne)}else{o=new(ke().btCompoundShape);var r=new(ke().btSphereShape)(0);s=t.get1Point(i,new(L())(0,0,0)),o.point=s,ve.setValue(s.x,s.y,s.z),Ne.setOrigin(ve),o.addChildShape(Ne,r),e.push(o)}e.length=n}else e.length=0}else e.length=0}),process:function(){var e=new(z()),t=new(z()),i=new(L())(0,0,0),n=new(L())(0,0,0),s=new(ke().btTransform),r=new(ke().btVector3),c=new(L())(0,0,0),a=new(we())(0,0,1,0),h=new(L())(1,1,1),p=new(o().MFVec3f);return function(){if(this.pickingGeometryNode){var o=this.getModelMatrices(),l=this.getTargets();switch(this.getIntersectionType()){case T.BOUNDS:for(var d=0,g=o.length;d<g;++d){var u=o[d];e.assign(this.pickingGeometryNode.getBBox()).multRight(u);for(var m=0,y=l.size;m<y;++m){var _=l[m];t.assign(_.geometryNode.getBBox()).multRight(_.modelMatrix),e.intersectsBox(t)&&(i.assign(e.center),n.assign(t.center),_.intersected=!0,_.distance=i.distance(n))}}var w=this.getPickedGeometries(),f=Boolean(w.length);w.remove(0,w.length,null),f!==this._isActive.getValue()&&(this._isActive=f),this._pickedGeometry.equals(w)||(this._pickedGeometry=w);break;case T.GEOMETRY:var k=this.picker,S=this.compoundShapes;for(d=0,g=o.length;d<g;++d){u=o[d];e.assign(this.pickingGeometryNode.getBBox()).multRight(u),u.get(c,a,h),k.getTransform(c,a,s),r.setValue(h.x,h.y,h.z);for(var b=0,O=S.length;b<O;++b){var v=S[b];k.setChildShape1Components(s,r,v);for(m=0,y=l.size;m<y;++m){_=l[m];var N=this.getPickShape(_.geometryNode);t.assign(_.geometryNode.getBBox()).multRight(_.modelMatrix),k.setChildShape2(_.modelMatrix,N.getCompoundShape()),k.contactTest()&&(i.assign(e.center),n.assign(t.center),_.intersected=!0,_.distance=i.distance(n),_.pickedPoint.push(v.point))}}}w=this.getPickedGeometries(),f=Boolean(w.length);w.remove(0,w.length,null),f!==this._isActive.getValue()&&(this._isActive=f),this._pickedGeometry.equals(w)||(this._pickedGeometry=w);var C=this.getPickedTargets();p.length=0;for(m=0,y=C.length;m<y;++m)for(var G=C[m].pickedPoint,P=0,M=G.length;P<M;++P)p.push(G[P]);this._pickedPoint.equals(p)||(this._pickedPoint=p)}}X.prototype.process.call(this)}}()}),y().set("x_ite/Components/Picking/PointPickSensor",be);const Ce=be;function Ge(e){X.call(this,e),this.addType(u().PrimitivePickSensor),this.pickingGeometryNode=null,this.picker=new Te}Ge.prototype=Object.assign(Object.create(X.prototype),{constructor:Ge,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new(a())([new(r())(u().inputOutput,"metadata",new(o().SFNode)),new(r())(u().inputOutput,"enabled",new(o().SFBool)(!0)),new(r())(u().inputOutput,"objectType",new(o().MFString)("ALL")),new(r())(u().inputOutput,"matchCriterion",new(o().SFString)("MATCH_ANY")),new(r())(u().initializeOnly,"intersectionType",new(o().SFString)("BOUNDS")),new(r())(u().initializeOnly,"sortOrder",new(o().SFString)("CLOSEST")),new(r())(u().outputOnly,"isActive",new(o().SFBool)),new(r())(u().inputOutput,"pickingGeometry",new(o().SFNode)),new(r())(u().inputOutput,"pickTarget",new(o().MFNode)),new(r())(u().outputOnly,"pickedGeometry",new(o().MFNode))]),getTypeName:function(){return"PrimitivePickSensor"},getComponentName:function(){return"Picking"},getContainerField:function(){return"children"},initialize:function(){X.prototype.initialize.call(this),this._pickingGeometry.addInterest("set_pickingGeometry__",this),this.set_pickingGeometry__()},set_pickingGeometry__:function(){this.pickingGeometryNode=null;try{for(var e=this._pickingGeometry.getValue().getInnerNode(),t=e.getType(),i=t.length-1;i>=0;--i)switch(t[i]){case u().Box:case u().Cone:case u().Cylinder:case u().Sphere:this.pickingGeometryNode=e;break;default:continue}}catch(e){}},process:function(){var e=new(z()),t=new(z()),i=new(L())(0,0,0),n=new(L())(0,0,0);return function(){if(this.pickingGeometryNode){var o=this.getModelMatrices(),s=this.getTargets();switch(this.getIntersectionType()){case T.BOUNDS:for(var r=0,c=o.length;r<c;++r){var a=o[r];e.assign(this.pickingGeometryNode.getBBox()).multRight(a);for(var h=0,p=s.size;h<p;++h){var l=s[h];t.assign(l.geometryNode.getBBox()).multRight(l.modelMatrix),e.intersectsBox(t)&&(i.assign(e.center),n.assign(t.center),l.intersected=!0,l.distance=i.distance(n))}}var d=this.getPickedGeometries(),g=Boolean(d.length);d.remove(0,d.length,null),g!==this._isActive.getValue()&&(this._isActive=g),this._pickedGeometry.equals(d)||(this._pickedGeometry=d);break;case T.GEOMETRY:var u=this.picker;for(r=0,c=o.length;r<c;++r){a=o[r];var m=this.getPickShape(this.pickingGeometryNode);e.assign(this.pickingGeometryNode.getBBox()).multRight(a),u.setChildShape1(a,m.getCompoundShape());for(h=0,p=s.size;h<p;++h){l=s[h];var y=this.getPickShape(l.geometryNode);t.assign(l.geometryNode.getBBox()).multRight(l.modelMatrix),u.setChildShape2(l.modelMatrix,y.getCompoundShape()),u.contactTest()&&(i.assign(e.center),n.assign(t.center),l.intersected=!0,l.distance=i.distance(n))}}d=this.getPickedGeometries(),g=Boolean(d.length);d.remove(0,d.length,null),g!==this._isActive.getValue()&&(this._isActive=g),this._pickedGeometry.equals(d)||(this._pickedGeometry=d)}}X.prototype.process.call(this)}}()}),y().set("x_ite/Components/Picking/PrimitivePickSensor",Ge);const Pe=Ge;function Me(e){X.call(this,e),this.addType(u().VolumePickSensor),this.pickingGeometryNode=null,this.picker=new Te}Me.prototype=Object.assign(Object.create(X.prototype),{constructor:Me,[Symbol.for("X_ITE.X3DBaseNode.fieldDefinitions")]:new(a())([new(r())(u().inputOutput,"metadata",new(o().SFNode)),new(r())(u().inputOutput,"enabled",new(o().SFBool)(!0)),new(r())(u().inputOutput,"objectType",new(o().MFString)("ALL")),new(r())(u().inputOutput,"matchCriterion",new(o().SFString)("MATCH_ANY")),new(r())(u().initializeOnly,"intersectionType",new(o().SFString)("BOUNDS")),new(r())(u().initializeOnly,"sortOrder",new(o().SFString)("CLOSEST")),new(r())(u().outputOnly,"isActive",new(o().SFBool)),new(r())(u().inputOutput,"pickingGeometry",new(o().SFNode)),new(r())(u().inputOutput,"pickTarget",new(o().MFNode)),new(r())(u().outputOnly,"pickedGeometry",new(o().MFNode))]),getTypeName:function(){return"VolumePickSensor"},getComponentName:function(){return"Picking"},getContainerField:function(){return"children"},initialize:function(){X.prototype.initialize.call(this),this._pickingGeometry.addInterest("set_pickingGeometry__",this),this.set_pickingGeometry__()},set_pickingGeometry__:function(){this.pickingGeometryNode=ye()(u().X3DGeometryNode,this._pickingGeometry)},process:function(){var e=new(z()),t=new(z()),i=new(L())(0,0,0),n=new(L())(0,0,0);return function(){if(this.pickingGeometryNode){var o=this.getModelMatrices(),s=this.getTargets();switch(this.getIntersectionType()){case T.BOUNDS:for(var r=0,c=o.length;r<c;++r){var a=o[r];e.assign(this.pickingGeometryNode.getBBox()).multRight(a);for(var h=0,p=s.size;h<p;++h){var l=s[h];t.assign(l.geometryNode.getBBox()).multRight(l.modelMatrix),e.intersectsBox(t)&&(i.assign(e.center),n.assign(t.center),l.intersected=!0,l.distance=i.distance(n))}}var d=this.getPickedGeometries(),g=Boolean(d.length);d.remove(0,d.length,null),g!==this._isActive.getValue()&&(this._isActive=g),this._pickedGeometry.equals(d)||(this._pickedGeometry=d);break;case T.GEOMETRY:var u=this.picker;for(r=0,c=o.length;r<c;++r){a=o[r];var m=this.getPickShape(this.pickingGeometryNode);e.assign(this.pickingGeometryNode.getBBox()).multRight(a),u.setChildShape1(a,m.getCompoundShape());for(h=0,p=s.size;h<p;++h){l=s[h];var y=this.getPickShape(l.geometryNode);t.assign(l.geometryNode.getBBox()).multRight(l.modelMatrix),u.setChildShape2(l.modelMatrix,y.getCompoundShape()),u.contactTest()&&(i.assign(e.center),n.assign(t.center),l.intersected=!0,l.distance=i.distance(n))}}d=this.getPickedGeometries(),g=Boolean(d.length);d.remove(0,d.length,null),g!==this._isActive.getValue()&&(this._isActive=g),this._pickedGeometry.equals(d)||(this._pickedGeometry=d)}}X.prototype.process.call(this)}}()}),y().set("x_ite/Components/Picking/VolumePickSensor",Me);const xe=Me;i().addComponent({name:"Picking",types:{LinePickSensor:ae,PickableGroup:ue,PointPickSensor:Ce,PrimitivePickSensor:Pe,VolumePickSensor:xe},abstractTypes:{X3DPickSensorNode:X,X3DPickableObject:de}}),y().set("assets/components/Picking",void 0)})();