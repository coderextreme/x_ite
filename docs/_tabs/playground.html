---
title: Playground
layout: wide
order: 4
icon: fas fa-rocket
---
<style>
.post, .post-content {
   height: 100%;
}

.dynamic-title {
   display: none;
}

/* Table */

.viewer-row {
   display: flex;
   height: calc(100vh - 180px);
}

.viewer-column {
   flex: 50%;
   width: 50%;
   height: 100%;
}

/* Editor */

#editor, .console {
   outline: none;
   background: var(--playground-editor-background);
   border: none;
   width: 100%;
   height: 100%;
   resize: none;
   font-family: monospace;
   font-size: 0.8rem;
   line-height: 1.4;
   white-space: pre;
}

.monaco-editor,
.monaco-editor .margin,
.monaco-editor-background,
canvas.minimap-decorations-layer {
   background-color: var(--playground-editor-background);
}

.console {
   padding: 0.5rem;
   height: 50%;
}

.post x3d-canvas, x3d-canvas {
   display: block;
   width: 100%;
   height: 50%;
   aspect-ratio: unset;
}

/* Console */

.console {
   overflow: scroll;
}

span.info {
   color: var(--system-blue);
}

span.warn {
   color: var(--system-yellow);
}

span.error {
   color: var(--system-red);
}
</style>

<pre style="display:none">
Online X3D and VRML viewer.
<script defer src="https://cdn.jsdelivr.net/npm/monaco-editor@latest/min/vs/loader.js"></script>
<script>
$(function ()
{
   console .info (X3D .getBrowser () .getWelcomeMessage ());

   const box = `<X3D profile='Full' version='4.0'>
  <Scene>
    <Viewpoint
        description='Initial View'
        position='4.737889 4.718629 7.435519'
        orientation='-0.640652763184828 0.744770464531058 0.186764536745701 0.746185800293648'/>
    <ParticleSystem
        geometryType='GEOMETRY'
        maxParticles='10'>
      <PointEmitter
          direction='0 0 0'
          speed='1'/>
      <Appearance>
        <Material
            diffuseColor='0 0.5 1'/>
      </Appearance>
      <Box/>
    </ParticleSystem>
  </Scene>
</X3D>
`;

   require .config ({ paths: { "vs": "https://cdn.jsdelivr.net/npm/monaco-editor@latest/min/vs" }});
   require (["vs/editor/editor.main"], async () =>
   {
      const darkMode = (window .matchMedia ?.("(prefers-color-scheme: dark)") .matches || $("html") .attr ("data-mode") === "dark") && ($("html") .attr ("data-mode") !== "light");

      const editor = monaco .editor .create (document .getElementById ("editor"),
      {
         language: "xml",
         theme: darkMode ? "vs-dark" : "vs-light",
         contextmenu: true,
         automaticLayout: true,
         tabSize: 2,
         wordWrap: "on",
         wrappingIndent: "indent",
         minimap: { enabled: false },
      });

      const url = new URL (document .location .href) .searchParams .get ("url");

      if (url)
      {
         const Browser = X3D .getBrowser ();

         Browser .baseURL = url;

         await Browser .loadURL (new X3D .MFString (url)) .catch (Function .prototype);

         const encoding = { XML: "XML", JSON: "JSON", VRML: "VRML" } [Browser .currentScene .encoding] ?? "XML";

         monaco .editor .setModelLanguage (editor .getModel (), encoding .toLowerCase ());

         editor .setValue (Browser .currentScene [`to${encoding}String`] ());
      }

      editor .getModel () .onDidChangeContent (async (event) =>
      {
         const
            Browser = X3D .getBrowser (),
            text    = editor .getValue (),
            url     = `data:,${encodeURIComponent (text)}`;

         if (Browser .getActiveViewpoint ())
         {
            var
               positionOffset    = Browser .getActiveViewpoint () ._positionOffset    .copy (),
               orientationOffset = Browser .getActiveViewpoint () ._orientationOffset .copy ();
         }

         await Browser .loadURL (new X3D .MFString (url)) .catch (Function .prototype);

         if (Browser .getActiveViewpoint ())
         {
            Browser .getActiveViewpoint () ._positionOffset    = positionOffset;
            Browser .getActiveViewpoint () ._orientationOffset = orientationOffset;
         }

         monaco .editor .setModelLanguage (editor .getModel (), Browser .currentScene .encoding .toLowerCase ());
      });

      if (!url)
         editor .setValue (box .replace (/ {3}/g, "  "));
   });
})
</script>
</pre>

<script>
(function ()
{
   function output (log, classes)
   {
      return function (... args)
      {
         $(function ()
         {
            const
               text    = args .join ("") + "\n",
               element = $("<span></span>") .addClass (classes) .text (text);

            if (text .match (/No suitable|of an UNKNOWN touch/))
               return;

            log .apply (this, args);

            $(".console") .append (element);
            element [0] .scrollIntoView (false);
         });
      }
   }

   console .log   = output (console .log,   "log");
   console .info  = output (console .info,  "info");
   console .warn  = output (console .warn,  "warn");
   console .error = output (console .error, "error");
   console .debug = output (console .debug, "debug");
})();
</script>

<div class="viewer-row">
   <div class="viewer-column">
      <x3d-canvas splashScreen="false"></x3d-canvas>
      <div class="console"></div>
   </div>
   <div class="viewer-column"><div id="editor"></div></div>
</div>
